[
  {
    "function_name": "updateDisplayUnit",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "618-622",
    "snippet": "void TransactionTableModel::updateDisplayUnit()\n{\n    // emit dataChanged to update Amount column with the current unit\n    emit dataChanged(index(0, Amount), index(priv->size()-1, Amount));\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "index",
          "args": [
            "priv->size()-1",
            "Amount"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "priv->size",
          "args": [],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "0",
            "Amount"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  void TransactionTableModel::updateDisplayUnit()\n  {\n      // emit dataChanged to update Amount column with the current unit\n      emit dataChanged(index(0, Amount), index(priv->size()-1, Amount));\n  }\n}"
  },
  {
    "function_name": "index",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "604-616",
    "snippet": "QModelIndex TransactionTableModel::index(int row, int column, const QModelIndex &parent) const\n{\n    Q_UNUSED(parent);\n    TransactionRecord *data = priv->index(row);\n    if(data)\n    {\n        return createIndex(row, column, priv->index(row));\n    }\n    else\n    {\n        return QModelIndex();\n    }\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QModelIndex",
          "args": [],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "createIndex",
          "args": [
            "row",
            "column",
            "priv->index(row)"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "priv->index",
          "args": [
            "row"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "priv->index",
          "args": [
            "row"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_UNUSED",
          "args": [
            "parent"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QModelIndex TransactionTableModel::index(int row, int column, const QModelIndex &parent) const\n  {\n      Q_UNUSED(parent);\n      TransactionRecord *data = priv->index(row);\n      if(data)\n      {\n          return createIndex(row, column, priv->index(row));\n      }\n      else\n      {\n          return QModelIndex();\n      }\n  }\n}"
  },
  {
    "function_name": "headerData",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "573-602",
    "snippet": "QVariant TransactionTableModel::headerData(int section, Qt::Orientation orientation, int role) const\n{\n    if(orientation == Qt::Horizontal)\n    {\n        if(role == Qt::DisplayRole)\n        {\n            return columns[section];\n        }\n        else if (role == Qt::TextAlignmentRole)\n        {\n            return column_alignments[section];\n        } else if (role == Qt::ToolTipRole)\n        {\n            switch(section)\n            {\n            case Status:\n                return tr(\"Transaction status. Hover over this field to show number of confirmations.\");\n            case Date:\n                return tr(\"Date and time that the transaction was received.\");\n            case Type:\n                return tr(\"Type of transaction.\");\n            case ToAddress:\n                return tr(\"Destination address of transaction.\");\n            case Amount:\n                return tr(\"Amount removed from or added to balance.\");\n            }\n        }\n    }\n    return QVariant();\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int column_alignments[] = {\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignRight|Qt::AlignVCenter\n    };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "QVariant",
          "args": [],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Amount removed from or added to balance.\""
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nstatic int column_alignments[] = {\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignRight|Qt::AlignVCenter\n    };\n\nTransactionTableModel {\n  QVariant TransactionTableModel::headerData(int section, Qt::Orientation orientation, int role) const\n  {\n      if(orientation == Qt::Horizontal)\n      {\n          if(role == Qt::DisplayRole)\n          {\n              return columns[section];\n          }\n          else if (role == Qt::TextAlignmentRole)\n          {\n              return column_alignments[section];\n          } else if (role == Qt::ToolTipRole)\n          {\n              switch(section)\n              {\n              case Status:\n                  return tr(\"Transaction status. Hover over this field to show number of confirmations.\");\n              case Date:\n                  return tr(\"Date and time that the transaction was received.\");\n              case Type:\n                  return tr(\"Type of transaction.\");\n              case ToAddress:\n                  return tr(\"Destination address of transaction.\");\n              case Amount:\n                  return tr(\"Amount removed from or added to balance.\");\n              }\n          }\n      }\n      return QVariant();\n  }\n}"
  },
  {
    "function_name": "data",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "484-571",
    "snippet": "QVariant TransactionTableModel::data(const QModelIndex &index, int role) const\n{\n    if(!index.isValid())\n        return QVariant();\n    TransactionRecord *rec = static_cast<TransactionRecord*>(index.internalPointer());\n\n    switch(role)\n    {\n    case Qt::DecorationRole:\n        switch(index.column())\n        {\n        case Status:\n            return txStatusDecoration(rec);\n        case ToAddress:\n            return txAddressDecoration(rec);\n        }\n        break;\n    case Qt::DisplayRole:\n        switch(index.column())\n        {\n        case Date:\n            return formatTxDate(rec);\n        case Type:\n            return formatTxType(rec);\n        case ToAddress:\n            return formatTxToAddress(rec, false);\n        case Amount:\n            return formatTxAmount(rec);\n        }\n        break;\n    case Qt::EditRole:\n        // Edit role is used for sorting, so return the unformatted values\n        switch(index.column())\n        {\n        case Status:\n            return QString::fromStdString(rec->status.sortKey);\n        case Date:\n            return rec->time;\n        case Type:\n            return formatTxType(rec);\n        case ToAddress:\n            return formatTxToAddress(rec, true);\n        case Amount:\n            return rec->credit + rec->debit;\n        }\n        break;\n    case Qt::ToolTipRole:\n        return formatTooltip(rec);\n    case Qt::TextAlignmentRole:\n        return column_alignments[index.column()];\n    case Qt::ForegroundRole:\n        // Non-confirmed (but not immature) as transactions are grey\n        if(!rec->status.countsForBalance && rec->status.status != TransactionStatus::Immature)\n        {\n            return COLOR_UNCONFIRMED;\n        }\n        if(index.column() == Amount && (rec->credit+rec->debit) < 0)\n        {\n            return COLOR_NEGATIVE;\n        }\n        if(index.column() == ToAddress)\n        {\n            return addressColor(rec);\n        }\n        break;\n    case TypeRole:\n        return rec->type;\n    case DateRole:\n        return QDateTime::fromTime_t(static_cast<uint>(rec->time));\n    case LongDescriptionRole:\n        return priv->describe(rec);\n    case AddressRole:\n        return QString::fromStdString(rec->address);\n    case LabelRole:\n        return walletModel->getAddressTableModel()->labelForAddress(QString::fromStdString(rec->address));\n    case AmountRole:\n        return rec->credit + rec->debit;\n    case TxIDRole:\n        return QString::fromStdString(rec->getTxID());\n    case ConfirmedRole:\n        return rec->status.countsForBalance;\n    case FormattedAmountRole:\n        return formatTxAmount(rec, false);\n    case StatusRole:\n        return rec->status.status;\n    }\n    return QVariant();\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int column_alignments[] = {\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignRight|Qt::AlignVCenter\n    };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "QVariant",
          "args": [],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "formatTxAmount",
          "args": [
            "rec",
            "false"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "formatTxAmount",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "424-435",
          "snippet": "QString TransactionTableModel::formatTxAmount(const TransactionRecord *wtx, bool showUnconfirmed) const\n{\n    QString str = BitcoinUnits::format(walletModel->getOptionsModel()->getDisplayUnit(), wtx->credit + wtx->debit);\n    if(showUnconfirmed)\n    {\n        if(!wtx->status.countsForBalance)\n        {\n            str = QString(\"[\") + str + QString(\"]\");\n        }\n    }\n    return QString(str);\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTxAmount(const TransactionRecord *wtx, bool showUnconfirmed) const\n  {\n      QString str = BitcoinUnits::format(walletModel->getOptionsModel()->getDisplayUnit(), wtx->credit + wtx->debit);\n      if(showUnconfirmed)\n      {\n          if(!wtx->status.countsForBalance)\n          {\n              str = QString(\"[\") + str + QString(\"]\");\n          }\n      }\n      return QString(str);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "rec->getTxID()"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rec->getTxID",
          "args": [],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "getTxID",
          "container": "TransactionRecord",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionrecord.cpp",
          "lines": "245-248",
          "snippet": "std::string TransactionRecord::getTxID()\n{\n    return hash.ToString() + strprintf(\"-%03d\", idx);\n}",
          "includes": [
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"transactionrecord.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"wallet.h\"\n#include \"transactionrecord.h\"\n\nTransactionRecord {\n  std::string TransactionRecord::getTxID()\n  {\n      return hash.ToString() + strprintf(\"-%03d\", idx);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "walletModel->getAddressTableModel",
          "args": [
            "QString::fromStdString(rec->address)"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "rec->address"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "walletModel->getAddressTableModel",
          "args": [],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "rec->address"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "priv->describe",
          "args": [
            "rec"
          ],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "describe",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "204-215",
          "snippet": "QString describe(TransactionRecord *rec)\n    {\n        {\n            LOCK(wallet->cs_wallet);\n            std::map<uint256, CWalletTx>::iterator mi = wallet->mapWallet.find(rec->hash);\n            if(mi != wallet->mapWallet.end())\n            {\n                return TransactionDesc::toHTML(wallet, mi->second);\n            }\n        }\n        return QString(\"\");\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  QString describe(TransactionRecord *rec)\n      {\n          {\n              LOCK(wallet->cs_wallet);\n              std::map<uint256, CWalletTx>::iterator mi = wallet->mapWallet.find(rec->hash);\n              if(mi != wallet->mapWallet.end())\n              {\n                  return TransactionDesc::toHTML(wallet, mi->second);\n              }\n          }\n          return QString(\"\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QDateTime::fromTime_t",
          "args": [
            "static_cast<uint>(rec->time)"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<uint>",
          "args": [
            "rec->time"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addressColor",
          "args": [
            "rec"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "addressColor",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "403-422",
          "snippet": "QVariant TransactionTableModel::addressColor(const TransactionRecord *wtx) const\n{\n    // Show addresses without label in a less visible color\n    switch(wtx->type)\n    {\n    case TransactionRecord::RecvWithAddress:\n    case TransactionRecord::SendToAddress:\n    case TransactionRecord::Generated:\n        {\n        QString label = walletModel->getAddressTableModel()->labelForAddress(QString::fromStdString(wtx->address));\n        if(label.isEmpty())\n            return COLOR_BAREADDRESS;\n        } break;\n    case TransactionRecord::SendToSelf:\n        return COLOR_BAREADDRESS;\n    default:\n        break;\n    }\n    return QVariant();\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QVariant TransactionTableModel::addressColor(const TransactionRecord *wtx) const\n  {\n      // Show addresses without label in a less visible color\n      switch(wtx->type)\n      {\n      case TransactionRecord::RecvWithAddress:\n      case TransactionRecord::SendToAddress:\n      case TransactionRecord::Generated:\n          {\n          QString label = walletModel->getAddressTableModel()->labelForAddress(QString::fromStdString(wtx->address));\n          if(label.isEmpty())\n              return COLOR_BAREADDRESS;\n          } break;\n      case TransactionRecord::SendToSelf:\n          return COLOR_BAREADDRESS;\n      default:\n          break;\n      }\n      return QVariant();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "index.column",
          "args": [],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.column",
          "args": [],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.column",
          "args": [],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "formatTooltip",
          "args": [
            "rec"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "formatTooltip",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "473-482",
          "snippet": "QString TransactionTableModel::formatTooltip(const TransactionRecord *rec) const\n{\n    QString tooltip = formatTxStatus(rec) + QString(\"\\n\") + formatTxType(rec);\n    if(rec->type==TransactionRecord::RecvFromOther || rec->type==TransactionRecord::SendToOther ||\n       rec->type==TransactionRecord::SendToAddress || rec->type==TransactionRecord::RecvWithAddress)\n    {\n        tooltip += QString(\" \") + formatTxToAddress(rec, true);\n    }\n    return tooltip;\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTooltip(const TransactionRecord *rec) const\n  {\n      QString tooltip = formatTxStatus(rec) + QString(\"\\n\") + formatTxType(rec);\n      if(rec->type==TransactionRecord::RecvFromOther || rec->type==TransactionRecord::SendToOther ||\n         rec->type==TransactionRecord::SendToAddress || rec->type==TransactionRecord::RecvWithAddress)\n      {\n          tooltip += QString(\" \") + formatTxToAddress(rec, true);\n      }\n      return tooltip;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "formatTxToAddress",
          "args": [
            "rec",
            "true"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "formatTxToAddress",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "385-401",
          "snippet": "QString TransactionTableModel::formatTxToAddress(const TransactionRecord *wtx, bool tooltip) const\n{\n    switch(wtx->type)\n    {\n    case TransactionRecord::RecvFromOther:\n        return QString::fromStdString(wtx->address);\n    case TransactionRecord::RecvWithAddress:\n    case TransactionRecord::SendToAddress:\n    case TransactionRecord::Generated:\n        return lookupAddress(wtx->address, tooltip);\n    case TransactionRecord::SendToOther:\n        return QString::fromStdString(wtx->address);\n    case TransactionRecord::SendToSelf:\n    default:\n        return tr(\"(n/a)\");\n    }\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTxToAddress(const TransactionRecord *wtx, bool tooltip) const\n  {\n      switch(wtx->type)\n      {\n      case TransactionRecord::RecvFromOther:\n          return QString::fromStdString(wtx->address);\n      case TransactionRecord::RecvWithAddress:\n      case TransactionRecord::SendToAddress:\n      case TransactionRecord::Generated:\n          return lookupAddress(wtx->address, tooltip);\n      case TransactionRecord::SendToOther:\n          return QString::fromStdString(wtx->address);\n      case TransactionRecord::SendToSelf:\n      default:\n          return tr(\"(n/a)\");\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "formatTxType",
          "args": [
            "rec"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "formatTxType",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "347-365",
          "snippet": "QString TransactionTableModel::formatTxType(const TransactionRecord *wtx) const\n{\n    switch(wtx->type)\n    {\n    case TransactionRecord::RecvWithAddress:\n        return tr(\"Received with\");\n    case TransactionRecord::RecvFromOther:\n        return tr(\"Received from\");\n    case TransactionRecord::SendToAddress:\n    case TransactionRecord::SendToOther:\n        return tr(\"Sent to\");\n    case TransactionRecord::SendToSelf:\n        return tr(\"Payment to yourself\");\n    case TransactionRecord::Generated:\n        return tr(\"Mined\");\n    default:\n        return QString();\n    }\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTxType(const TransactionRecord *wtx) const\n  {\n      switch(wtx->type)\n      {\n      case TransactionRecord::RecvWithAddress:\n          return tr(\"Received with\");\n      case TransactionRecord::RecvFromOther:\n          return tr(\"Received from\");\n      case TransactionRecord::SendToAddress:\n      case TransactionRecord::SendToOther:\n          return tr(\"Sent to\");\n      case TransactionRecord::SendToSelf:\n          return tr(\"Payment to yourself\");\n      case TransactionRecord::Generated:\n          return tr(\"Mined\");\n      default:\n          return QString();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "rec->status.sortKey"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.column",
          "args": [],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "formatTxAmount",
          "args": [
            "rec"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "formatTxDate",
          "args": [
            "rec"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "formatTxDate",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "317-327",
          "snippet": "QString TransactionTableModel::formatTxDate(const TransactionRecord *wtx) const\n{\n    if(wtx->time)\n    {\n        return GUIUtil::dateTimeStr(wtx->time);\n    }\n    else\n    {\n        return QString();\n    }\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTxDate(const TransactionRecord *wtx) const\n  {\n      if(wtx->time)\n      {\n          return GUIUtil::dateTimeStr(wtx->time);\n      }\n      else\n      {\n          return QString();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "index.column",
          "args": [],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "txAddressDecoration",
          "args": [
            "rec"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "txAddressDecoration",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "367-383",
          "snippet": "QVariant TransactionTableModel::txAddressDecoration(const TransactionRecord *wtx) const\n{\n    switch(wtx->type)\n    {\n    case TransactionRecord::Generated:\n        return QIcon(\":/icons/tx_mined\");\n    case TransactionRecord::RecvWithAddress:\n    case TransactionRecord::RecvFromOther:\n        return QIcon(\":/icons/tx_input\");\n    case TransactionRecord::SendToAddress:\n    case TransactionRecord::SendToOther:\n        return QIcon(\":/icons/tx_output\");\n    default:\n        return QIcon(\":/icons/tx_inout\");\n    }\n    return QVariant();\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QVariant TransactionTableModel::txAddressDecoration(const TransactionRecord *wtx) const\n  {\n      switch(wtx->type)\n      {\n      case TransactionRecord::Generated:\n          return QIcon(\":/icons/tx_mined\");\n      case TransactionRecord::RecvWithAddress:\n      case TransactionRecord::RecvFromOther:\n          return QIcon(\":/icons/tx_input\");\n      case TransactionRecord::SendToAddress:\n      case TransactionRecord::SendToOther:\n          return QIcon(\":/icons/tx_output\");\n      default:\n          return QIcon(\":/icons/tx_inout\");\n      }\n      return QVariant();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "txStatusDecoration",
          "args": [
            "rec"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "txStatusDecoration",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "437-471",
          "snippet": "QVariant TransactionTableModel::txStatusDecoration(const TransactionRecord *wtx) const\n{\n    switch(wtx->status.status)\n    {\n    case TransactionStatus::OpenUntilBlock:\n    case TransactionStatus::OpenUntilDate:\n        return QColor(64,64,255);\n    case TransactionStatus::Offline:\n        return QColor(192,192,192);\n    case TransactionStatus::Unconfirmed:\n        return QIcon(\":/icons/transaction_0\");\n    case TransactionStatus::Confirming:\n        switch(wtx->status.depth)\n        {\n        case 1: return QIcon(\":/icons/transaction_1\");\n        case 2: return QIcon(\":/icons/transaction_2\");\n        case 3: return QIcon(\":/icons/transaction_3\");\n        case 4: return QIcon(\":/icons/transaction_4\");\n        default: return QIcon(\":/icons/transaction_5\");\n        };\n    case TransactionStatus::Confirmed:\n        return QIcon(\":/icons/transaction_confirmed\");\n    case TransactionStatus::Conflicted:\n        return QIcon(\":/icons/transaction_conflicted\");\n    case TransactionStatus::Immature: {\n        int total = wtx->status.depth + wtx->status.matures_in;\n        int part = (wtx->status.depth * 4 / total) + 1;\n        return QIcon(QString(\":/icons/transaction_%1\").arg(part));\n        }\n    case TransactionStatus::MaturesWarning:\n    case TransactionStatus::NotAccepted:\n        return QIcon(\":/icons/transaction_0\");\n    }\n    return QColor(0,0,0);\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QVariant TransactionTableModel::txStatusDecoration(const TransactionRecord *wtx) const\n  {\n      switch(wtx->status.status)\n      {\n      case TransactionStatus::OpenUntilBlock:\n      case TransactionStatus::OpenUntilDate:\n          return QColor(64,64,255);\n      case TransactionStatus::Offline:\n          return QColor(192,192,192);\n      case TransactionStatus::Unconfirmed:\n          return QIcon(\":/icons/transaction_0\");\n      case TransactionStatus::Confirming:\n          switch(wtx->status.depth)\n          {\n          case 1: return QIcon(\":/icons/transaction_1\");\n          case 2: return QIcon(\":/icons/transaction_2\");\n          case 3: return QIcon(\":/icons/transaction_3\");\n          case 4: return QIcon(\":/icons/transaction_4\");\n          default: return QIcon(\":/icons/transaction_5\");\n          };\n      case TransactionStatus::Confirmed:\n          return QIcon(\":/icons/transaction_confirmed\");\n      case TransactionStatus::Conflicted:\n          return QIcon(\":/icons/transaction_conflicted\");\n      case TransactionStatus::Immature: {\n          int total = wtx->status.depth + wtx->status.matures_in;\n          int part = (wtx->status.depth * 4 / total) + 1;\n          return QIcon(QString(\":/icons/transaction_%1\").arg(part));\n          }\n      case TransactionStatus::MaturesWarning:\n      case TransactionStatus::NotAccepted:\n          return QIcon(\":/icons/transaction_0\");\n      }\n      return QColor(0,0,0);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "index.column",
          "args": [],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<TransactionRecord*>",
          "args": [
            "index.internalPointer()"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.internalPointer",
          "args": [],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.isValid",
          "args": [],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "WalletModel::UnlockContext",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.h",
          "lines": "106-106",
          "snippet": "bool isValid() const { return valid; }",
          "includes": [
            "#include \"allocators.h\" /* for SecureString */",
            "#include <map>",
            "#include <vector>",
            "#include <QObject>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"allocators.h\" /* for SecureString */\n#include <map>\n#include <vector>\n#include <QObject>\n\nWalletModel {\n  UnlockContext {\n    bool isValid() const { return valid; }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nstatic int column_alignments[] = {\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignLeft|Qt::AlignVCenter,\n        Qt::AlignRight|Qt::AlignVCenter\n    };\n\nTransactionTableModel {\n  QVariant TransactionTableModel::data(const QModelIndex &index, int role) const\n  {\n      if(!index.isValid())\n          return QVariant();\n      TransactionRecord *rec = static_cast<TransactionRecord*>(index.internalPointer());\n  \n      switch(role)\n      {\n      case Qt::DecorationRole:\n          switch(index.column())\n          {\n          case Status:\n              return txStatusDecoration(rec);\n          case ToAddress:\n              return txAddressDecoration(rec);\n          }\n          break;\n      case Qt::DisplayRole:\n          switch(index.column())\n          {\n          case Date:\n              return formatTxDate(rec);\n          case Type:\n              return formatTxType(rec);\n          case ToAddress:\n              return formatTxToAddress(rec, false);\n          case Amount:\n              return formatTxAmount(rec);\n          }\n          break;\n      case Qt::EditRole:\n          // Edit role is used for sorting, so return the unformatted values\n          switch(index.column())\n          {\n          case Status:\n              return QString::fromStdString(rec->status.sortKey);\n          case Date:\n              return rec->time;\n          case Type:\n              return formatTxType(rec);\n          case ToAddress:\n              return formatTxToAddress(rec, true);\n          case Amount:\n              return rec->credit + rec->debit;\n          }\n          break;\n      case Qt::ToolTipRole:\n          return formatTooltip(rec);\n      case Qt::TextAlignmentRole:\n          return column_alignments[index.column()];\n      case Qt::ForegroundRole:\n          // Non-confirmed (but not immature) as transactions are grey\n          if(!rec->status.countsForBalance && rec->status.status != TransactionStatus::Immature)\n          {\n              return COLOR_UNCONFIRMED;\n          }\n          if(index.column() == Amount && (rec->credit+rec->debit) < 0)\n          {\n              return COLOR_NEGATIVE;\n          }\n          if(index.column() == ToAddress)\n          {\n              return addressColor(rec);\n          }\n          break;\n      case TypeRole:\n          return rec->type;\n      case DateRole:\n          return QDateTime::fromTime_t(static_cast<uint>(rec->time));\n      case LongDescriptionRole:\n          return priv->describe(rec);\n      case AddressRole:\n          return QString::fromStdString(rec->address);\n      case LabelRole:\n          return walletModel->getAddressTableModel()->labelForAddress(QString::fromStdString(rec->address));\n      case AmountRole:\n          return rec->credit + rec->debit;\n      case TxIDRole:\n          return QString::fromStdString(rec->getTxID());\n      case ConfirmedRole:\n          return rec->status.countsForBalance;\n      case FormattedAmountRole:\n          return formatTxAmount(rec, false);\n      case StatusRole:\n          return rec->status.status;\n      }\n      return QVariant();\n  }\n}"
  },
  {
    "function_name": "formatTooltip",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "473-482",
    "snippet": "QString TransactionTableModel::formatTooltip(const TransactionRecord *rec) const\n{\n    QString tooltip = formatTxStatus(rec) + QString(\"\\n\") + formatTxType(rec);\n    if(rec->type==TransactionRecord::RecvFromOther || rec->type==TransactionRecord::SendToOther ||\n       rec->type==TransactionRecord::SendToAddress || rec->type==TransactionRecord::RecvWithAddress)\n    {\n        tooltip += QString(\" \") + formatTxToAddress(rec, true);\n    }\n    return tooltip;\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "formatTxToAddress",
          "args": [
            "rec",
            "true"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "formatTxToAddress",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "385-401",
          "snippet": "QString TransactionTableModel::formatTxToAddress(const TransactionRecord *wtx, bool tooltip) const\n{\n    switch(wtx->type)\n    {\n    case TransactionRecord::RecvFromOther:\n        return QString::fromStdString(wtx->address);\n    case TransactionRecord::RecvWithAddress:\n    case TransactionRecord::SendToAddress:\n    case TransactionRecord::Generated:\n        return lookupAddress(wtx->address, tooltip);\n    case TransactionRecord::SendToOther:\n        return QString::fromStdString(wtx->address);\n    case TransactionRecord::SendToSelf:\n    default:\n        return tr(\"(n/a)\");\n    }\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTxToAddress(const TransactionRecord *wtx, bool tooltip) const\n  {\n      switch(wtx->type)\n      {\n      case TransactionRecord::RecvFromOther:\n          return QString::fromStdString(wtx->address);\n      case TransactionRecord::RecvWithAddress:\n      case TransactionRecord::SendToAddress:\n      case TransactionRecord::Generated:\n          return lookupAddress(wtx->address, tooltip);\n      case TransactionRecord::SendToOther:\n          return QString::fromStdString(wtx->address);\n      case TransactionRecord::SendToSelf:\n      default:\n          return tr(\"(n/a)\");\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" \""
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "formatTxType",
          "args": [
            "rec"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "formatTxType",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "347-365",
          "snippet": "QString TransactionTableModel::formatTxType(const TransactionRecord *wtx) const\n{\n    switch(wtx->type)\n    {\n    case TransactionRecord::RecvWithAddress:\n        return tr(\"Received with\");\n    case TransactionRecord::RecvFromOther:\n        return tr(\"Received from\");\n    case TransactionRecord::SendToAddress:\n    case TransactionRecord::SendToOther:\n        return tr(\"Sent to\");\n    case TransactionRecord::SendToSelf:\n        return tr(\"Payment to yourself\");\n    case TransactionRecord::Generated:\n        return tr(\"Mined\");\n    default:\n        return QString();\n    }\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTxType(const TransactionRecord *wtx) const\n  {\n      switch(wtx->type)\n      {\n      case TransactionRecord::RecvWithAddress:\n          return tr(\"Received with\");\n      case TransactionRecord::RecvFromOther:\n          return tr(\"Received from\");\n      case TransactionRecord::SendToAddress:\n      case TransactionRecord::SendToOther:\n          return tr(\"Sent to\");\n      case TransactionRecord::SendToSelf:\n          return tr(\"Payment to yourself\");\n      case TransactionRecord::Generated:\n          return tr(\"Mined\");\n      default:\n          return QString();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"\\n\""
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "formatTxStatus",
          "args": [
            "rec"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "formatTxStatus",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "276-315",
          "snippet": "QString TransactionTableModel::formatTxStatus(const TransactionRecord *wtx) const\n{\n    QString status;\n\n    switch(wtx->status.status)\n    {\n    case TransactionStatus::OpenUntilBlock:\n        status = tr(\"Open for %n more block(s)\",\"\",wtx->status.open_for);\n        break;\n    case TransactionStatus::OpenUntilDate:\n        status = tr(\"Open until %1\").arg(GUIUtil::dateTimeStr(wtx->status.open_for));\n        break;\n    case TransactionStatus::Offline:\n        status = tr(\"Offline\");\n        break;\n    case TransactionStatus::Unconfirmed:\n        status = tr(\"Unconfirmed\");\n        break;\n    case TransactionStatus::Confirming:\n        status = tr(\"Confirming (%1 of %2 recommended confirmations)\").arg(wtx->status.depth).arg(TransactionRecord::RecommendedNumConfirmations);\n        break;\n    case TransactionStatus::Confirmed:\n        status = tr(\"Confirmed (%1 confirmations)\").arg(wtx->status.depth);\n        break;\n    case TransactionStatus::Conflicted:\n        status = tr(\"Conflicted\");\n        break;\n    case TransactionStatus::Immature:\n        status = tr(\"Immature (%1 confirmations, will be available after %2)\").arg(wtx->status.depth).arg(wtx->status.depth + wtx->status.matures_in);\n        break;\n    case TransactionStatus::MaturesWarning:\n        status = tr(\"This block was not received by any other nodes and will probably not be accepted!\");\n        break;\n    case TransactionStatus::NotAccepted:\n        status = tr(\"Generated but not accepted\");\n        break;\n    }\n\n    return status;\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTxStatus(const TransactionRecord *wtx) const\n  {\n      QString status;\n  \n      switch(wtx->status.status)\n      {\n      case TransactionStatus::OpenUntilBlock:\n          status = tr(\"Open for %n more block(s)\",\"\",wtx->status.open_for);\n          break;\n      case TransactionStatus::OpenUntilDate:\n          status = tr(\"Open until %1\").arg(GUIUtil::dateTimeStr(wtx->status.open_for));\n          break;\n      case TransactionStatus::Offline:\n          status = tr(\"Offline\");\n          break;\n      case TransactionStatus::Unconfirmed:\n          status = tr(\"Unconfirmed\");\n          break;\n      case TransactionStatus::Confirming:\n          status = tr(\"Confirming (%1 of %2 recommended confirmations)\").arg(wtx->status.depth).arg(TransactionRecord::RecommendedNumConfirmations);\n          break;\n      case TransactionStatus::Confirmed:\n          status = tr(\"Confirmed (%1 confirmations)\").arg(wtx->status.depth);\n          break;\n      case TransactionStatus::Conflicted:\n          status = tr(\"Conflicted\");\n          break;\n      case TransactionStatus::Immature:\n          status = tr(\"Immature (%1 confirmations, will be available after %2)\").arg(wtx->status.depth).arg(wtx->status.depth + wtx->status.matures_in);\n          break;\n      case TransactionStatus::MaturesWarning:\n          status = tr(\"This block was not received by any other nodes and will probably not be accepted!\");\n          break;\n      case TransactionStatus::NotAccepted:\n          status = tr(\"Generated but not accepted\");\n          break;\n      }\n  \n      return status;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTooltip(const TransactionRecord *rec) const\n  {\n      QString tooltip = formatTxStatus(rec) + QString(\"\\n\") + formatTxType(rec);\n      if(rec->type==TransactionRecord::RecvFromOther || rec->type==TransactionRecord::SendToOther ||\n         rec->type==TransactionRecord::SendToAddress || rec->type==TransactionRecord::RecvWithAddress)\n      {\n          tooltip += QString(\" \") + formatTxToAddress(rec, true);\n      }\n      return tooltip;\n  }\n}"
  },
  {
    "function_name": "txStatusDecoration",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "437-471",
    "snippet": "QVariant TransactionTableModel::txStatusDecoration(const TransactionRecord *wtx) const\n{\n    switch(wtx->status.status)\n    {\n    case TransactionStatus::OpenUntilBlock:\n    case TransactionStatus::OpenUntilDate:\n        return QColor(64,64,255);\n    case TransactionStatus::Offline:\n        return QColor(192,192,192);\n    case TransactionStatus::Unconfirmed:\n        return QIcon(\":/icons/transaction_0\");\n    case TransactionStatus::Confirming:\n        switch(wtx->status.depth)\n        {\n        case 1: return QIcon(\":/icons/transaction_1\");\n        case 2: return QIcon(\":/icons/transaction_2\");\n        case 3: return QIcon(\":/icons/transaction_3\");\n        case 4: return QIcon(\":/icons/transaction_4\");\n        default: return QIcon(\":/icons/transaction_5\");\n        };\n    case TransactionStatus::Confirmed:\n        return QIcon(\":/icons/transaction_confirmed\");\n    case TransactionStatus::Conflicted:\n        return QIcon(\":/icons/transaction_conflicted\");\n    case TransactionStatus::Immature: {\n        int total = wtx->status.depth + wtx->status.matures_in;\n        int part = (wtx->status.depth * 4 / total) + 1;\n        return QIcon(QString(\":/icons/transaction_%1\").arg(part));\n        }\n    case TransactionStatus::MaturesWarning:\n    case TransactionStatus::NotAccepted:\n        return QIcon(\":/icons/transaction_0\");\n    }\n    return QColor(0,0,0);\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QColor",
          "args": [
            "0",
            "0",
            "0"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/transaction_0\""
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "QString(\":/icons/transaction_%1\").arg(part)"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "part"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\":/icons/transaction_%1\""
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/transaction_conflicted\""
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/transaction_confirmed\""
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/transaction_5\""
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/transaction_4\""
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/transaction_3\""
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/transaction_2\""
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/transaction_1\""
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/transaction_0\""
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QColor",
          "args": [
            "192",
            "192",
            "192"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QColor",
          "args": [
            "64",
            "64",
            "255"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QVariant TransactionTableModel::txStatusDecoration(const TransactionRecord *wtx) const\n  {\n      switch(wtx->status.status)\n      {\n      case TransactionStatus::OpenUntilBlock:\n      case TransactionStatus::OpenUntilDate:\n          return QColor(64,64,255);\n      case TransactionStatus::Offline:\n          return QColor(192,192,192);\n      case TransactionStatus::Unconfirmed:\n          return QIcon(\":/icons/transaction_0\");\n      case TransactionStatus::Confirming:\n          switch(wtx->status.depth)\n          {\n          case 1: return QIcon(\":/icons/transaction_1\");\n          case 2: return QIcon(\":/icons/transaction_2\");\n          case 3: return QIcon(\":/icons/transaction_3\");\n          case 4: return QIcon(\":/icons/transaction_4\");\n          default: return QIcon(\":/icons/transaction_5\");\n          };\n      case TransactionStatus::Confirmed:\n          return QIcon(\":/icons/transaction_confirmed\");\n      case TransactionStatus::Conflicted:\n          return QIcon(\":/icons/transaction_conflicted\");\n      case TransactionStatus::Immature: {\n          int total = wtx->status.depth + wtx->status.matures_in;\n          int part = (wtx->status.depth * 4 / total) + 1;\n          return QIcon(QString(\":/icons/transaction_%1\").arg(part));\n          }\n      case TransactionStatus::MaturesWarning:\n      case TransactionStatus::NotAccepted:\n          return QIcon(\":/icons/transaction_0\");\n      }\n      return QColor(0,0,0);\n  }\n}"
  },
  {
    "function_name": "formatTxAmount",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "424-435",
    "snippet": "QString TransactionTableModel::formatTxAmount(const TransactionRecord *wtx, bool showUnconfirmed) const\n{\n    QString str = BitcoinUnits::format(walletModel->getOptionsModel()->getDisplayUnit(), wtx->credit + wtx->debit);\n    if(showUnconfirmed)\n    {\n        if(!wtx->status.countsForBalance)\n        {\n            str = QString(\"[\") + str + QString(\"]\");\n        }\n    }\n    return QString(str);\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "str"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"]\""
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"[\""
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::format",
          "args": [
            "walletModel->getOptionsModel()->getDisplayUnit()",
            "wtx->credit + wtx->debit"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "walletModel->getOptionsModel",
          "args": [],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "walletModel->getOptionsModel",
          "args": [],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTxAmount(const TransactionRecord *wtx, bool showUnconfirmed) const\n  {\n      QString str = BitcoinUnits::format(walletModel->getOptionsModel()->getDisplayUnit(), wtx->credit + wtx->debit);\n      if(showUnconfirmed)\n      {\n          if(!wtx->status.countsForBalance)\n          {\n              str = QString(\"[\") + str + QString(\"]\");\n          }\n      }\n      return QString(str);\n  }\n}"
  },
  {
    "function_name": "addressColor",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "403-422",
    "snippet": "QVariant TransactionTableModel::addressColor(const TransactionRecord *wtx) const\n{\n    // Show addresses without label in a less visible color\n    switch(wtx->type)\n    {\n    case TransactionRecord::RecvWithAddress:\n    case TransactionRecord::SendToAddress:\n    case TransactionRecord::Generated:\n        {\n        QString label = walletModel->getAddressTableModel()->labelForAddress(QString::fromStdString(wtx->address));\n        if(label.isEmpty())\n            return COLOR_BAREADDRESS;\n        } break;\n    case TransactionRecord::SendToSelf:\n        return COLOR_BAREADDRESS;\n    default:\n        break;\n    }\n    return QVariant();\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QVariant",
          "args": [],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "label.isEmpty",
          "args": [],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "walletModel->getAddressTableModel",
          "args": [
            "QString::fromStdString(wtx->address)"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "wtx->address"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "walletModel->getAddressTableModel",
          "args": [],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QVariant TransactionTableModel::addressColor(const TransactionRecord *wtx) const\n  {\n      // Show addresses without label in a less visible color\n      switch(wtx->type)\n      {\n      case TransactionRecord::RecvWithAddress:\n      case TransactionRecord::SendToAddress:\n      case TransactionRecord::Generated:\n          {\n          QString label = walletModel->getAddressTableModel()->labelForAddress(QString::fromStdString(wtx->address));\n          if(label.isEmpty())\n              return COLOR_BAREADDRESS;\n          } break;\n      case TransactionRecord::SendToSelf:\n          return COLOR_BAREADDRESS;\n      default:\n          break;\n      }\n      return QVariant();\n  }\n}"
  },
  {
    "function_name": "formatTxToAddress",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "385-401",
    "snippet": "QString TransactionTableModel::formatTxToAddress(const TransactionRecord *wtx, bool tooltip) const\n{\n    switch(wtx->type)\n    {\n    case TransactionRecord::RecvFromOther:\n        return QString::fromStdString(wtx->address);\n    case TransactionRecord::RecvWithAddress:\n    case TransactionRecord::SendToAddress:\n    case TransactionRecord::Generated:\n        return lookupAddress(wtx->address, tooltip);\n    case TransactionRecord::SendToOther:\n        return QString::fromStdString(wtx->address);\n    case TransactionRecord::SendToSelf:\n    default:\n        return tr(\"(n/a)\");\n    }\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"(n/a)\""
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "wtx->address"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lookupAddress",
          "args": [
            "wtx->address",
            "tooltip"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "lookupAddress",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "332-345",
          "snippet": "QString TransactionTableModel::lookupAddress(const std::string &address, bool tooltip) const\n{\n    QString label = walletModel->getAddressTableModel()->labelForAddress(QString::fromStdString(address));\n    QString description;\n    if(!label.isEmpty())\n    {\n        description += label + QString(\" \");\n    }\n    if(label.isEmpty() || walletModel->getOptionsModel()->getDisplayAddresses() || tooltip)\n    {\n        description += QString(\"(\") + QString::fromStdString(address) + QString(\")\");\n    }\n    return description;\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::lookupAddress(const std::string &address, bool tooltip) const\n  {\n      QString label = walletModel->getAddressTableModel()->labelForAddress(QString::fromStdString(address));\n      QString description;\n      if(!label.isEmpty())\n      {\n          description += label + QString(\" \");\n      }\n      if(label.isEmpty() || walletModel->getOptionsModel()->getDisplayAddresses() || tooltip)\n      {\n          description += QString(\"(\") + QString::fromStdString(address) + QString(\")\");\n      }\n      return description;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "wtx->address"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTxToAddress(const TransactionRecord *wtx, bool tooltip) const\n  {\n      switch(wtx->type)\n      {\n      case TransactionRecord::RecvFromOther:\n          return QString::fromStdString(wtx->address);\n      case TransactionRecord::RecvWithAddress:\n      case TransactionRecord::SendToAddress:\n      case TransactionRecord::Generated:\n          return lookupAddress(wtx->address, tooltip);\n      case TransactionRecord::SendToOther:\n          return QString::fromStdString(wtx->address);\n      case TransactionRecord::SendToSelf:\n      default:\n          return tr(\"(n/a)\");\n      }\n  }\n}"
  },
  {
    "function_name": "txAddressDecoration",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "367-383",
    "snippet": "QVariant TransactionTableModel::txAddressDecoration(const TransactionRecord *wtx) const\n{\n    switch(wtx->type)\n    {\n    case TransactionRecord::Generated:\n        return QIcon(\":/icons/tx_mined\");\n    case TransactionRecord::RecvWithAddress:\n    case TransactionRecord::RecvFromOther:\n        return QIcon(\":/icons/tx_input\");\n    case TransactionRecord::SendToAddress:\n    case TransactionRecord::SendToOther:\n        return QIcon(\":/icons/tx_output\");\n    default:\n        return QIcon(\":/icons/tx_inout\");\n    }\n    return QVariant();\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QVariant",
          "args": [],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/tx_inout\""
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/tx_output\""
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/tx_input\""
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/tx_mined\""
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QVariant TransactionTableModel::txAddressDecoration(const TransactionRecord *wtx) const\n  {\n      switch(wtx->type)\n      {\n      case TransactionRecord::Generated:\n          return QIcon(\":/icons/tx_mined\");\n      case TransactionRecord::RecvWithAddress:\n      case TransactionRecord::RecvFromOther:\n          return QIcon(\":/icons/tx_input\");\n      case TransactionRecord::SendToAddress:\n      case TransactionRecord::SendToOther:\n          return QIcon(\":/icons/tx_output\");\n      default:\n          return QIcon(\":/icons/tx_inout\");\n      }\n      return QVariant();\n  }\n}"
  },
  {
    "function_name": "formatTxType",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "347-365",
    "snippet": "QString TransactionTableModel::formatTxType(const TransactionRecord *wtx) const\n{\n    switch(wtx->type)\n    {\n    case TransactionRecord::RecvWithAddress:\n        return tr(\"Received with\");\n    case TransactionRecord::RecvFromOther:\n        return tr(\"Received from\");\n    case TransactionRecord::SendToAddress:\n    case TransactionRecord::SendToOther:\n        return tr(\"Sent to\");\n    case TransactionRecord::SendToSelf:\n        return tr(\"Payment to yourself\");\n    case TransactionRecord::Generated:\n        return tr(\"Mined\");\n    default:\n        return QString();\n    }\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Mined\""
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTxType(const TransactionRecord *wtx) const\n  {\n      switch(wtx->type)\n      {\n      case TransactionRecord::RecvWithAddress:\n          return tr(\"Received with\");\n      case TransactionRecord::RecvFromOther:\n          return tr(\"Received from\");\n      case TransactionRecord::SendToAddress:\n      case TransactionRecord::SendToOther:\n          return tr(\"Sent to\");\n      case TransactionRecord::SendToSelf:\n          return tr(\"Payment to yourself\");\n      case TransactionRecord::Generated:\n          return tr(\"Mined\");\n      default:\n          return QString();\n      }\n  }\n}"
  },
  {
    "function_name": "lookupAddress",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "332-345",
    "snippet": "QString TransactionTableModel::lookupAddress(const std::string &address, bool tooltip) const\n{\n    QString label = walletModel->getAddressTableModel()->labelForAddress(QString::fromStdString(address));\n    QString description;\n    if(!label.isEmpty())\n    {\n        description += label + QString(\" \");\n    }\n    if(label.isEmpty() || walletModel->getOptionsModel()->getDisplayAddresses() || tooltip)\n    {\n        description += QString(\"(\") + QString::fromStdString(address) + QString(\")\");\n    }\n    return description;\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\")\""
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "address"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"(\""
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "walletModel->getOptionsModel",
          "args": [],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "walletModel->getOptionsModel",
          "args": [],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "label.isEmpty",
          "args": [],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" \""
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "label.isEmpty",
          "args": [],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "walletModel->getAddressTableModel",
          "args": [
            "QString::fromStdString(address)"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "address"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "walletModel->getAddressTableModel",
          "args": [],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::lookupAddress(const std::string &address, bool tooltip) const\n  {\n      QString label = walletModel->getAddressTableModel()->labelForAddress(QString::fromStdString(address));\n      QString description;\n      if(!label.isEmpty())\n      {\n          description += label + QString(\" \");\n      }\n      if(label.isEmpty() || walletModel->getOptionsModel()->getDisplayAddresses() || tooltip)\n      {\n          description += QString(\"(\") + QString::fromStdString(address) + QString(\")\");\n      }\n      return description;\n  }\n}"
  },
  {
    "function_name": "formatTxDate",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "317-327",
    "snippet": "QString TransactionTableModel::formatTxDate(const TransactionRecord *wtx) const\n{\n    if(wtx->time)\n    {\n        return GUIUtil::dateTimeStr(wtx->time);\n    }\n    else\n    {\n        return QString();\n    }\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::dateTimeStr",
          "args": [
            "wtx->time"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "dateTimeStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "50-53",
          "snippet": "QString dateTimeStr(qint64 nTime)\n{\n    return dateTimeStr(QDateTime::fromTime_t((qint32)nTime));\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQString dateTimeStr(qint64 nTime)\n{\n    return dateTimeStr(QDateTime::fromTime_t((qint32)nTime));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTxDate(const TransactionRecord *wtx) const\n  {\n      if(wtx->time)\n      {\n          return GUIUtil::dateTimeStr(wtx->time);\n      }\n      else\n      {\n          return QString();\n      }\n  }\n}"
  },
  {
    "function_name": "formatTxStatus",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "276-315",
    "snippet": "QString TransactionTableModel::formatTxStatus(const TransactionRecord *wtx) const\n{\n    QString status;\n\n    switch(wtx->status.status)\n    {\n    case TransactionStatus::OpenUntilBlock:\n        status = tr(\"Open for %n more block(s)\",\"\",wtx->status.open_for);\n        break;\n    case TransactionStatus::OpenUntilDate:\n        status = tr(\"Open until %1\").arg(GUIUtil::dateTimeStr(wtx->status.open_for));\n        break;\n    case TransactionStatus::Offline:\n        status = tr(\"Offline\");\n        break;\n    case TransactionStatus::Unconfirmed:\n        status = tr(\"Unconfirmed\");\n        break;\n    case TransactionStatus::Confirming:\n        status = tr(\"Confirming (%1 of %2 recommended confirmations)\").arg(wtx->status.depth).arg(TransactionRecord::RecommendedNumConfirmations);\n        break;\n    case TransactionStatus::Confirmed:\n        status = tr(\"Confirmed (%1 confirmations)\").arg(wtx->status.depth);\n        break;\n    case TransactionStatus::Conflicted:\n        status = tr(\"Conflicted\");\n        break;\n    case TransactionStatus::Immature:\n        status = tr(\"Immature (%1 confirmations, will be available after %2)\").arg(wtx->status.depth).arg(wtx->status.depth + wtx->status.matures_in);\n        break;\n    case TransactionStatus::MaturesWarning:\n        status = tr(\"This block was not received by any other nodes and will probably not be accepted!\");\n        break;\n    case TransactionStatus::NotAccepted:\n        status = tr(\"Generated but not accepted\");\n        break;\n    }\n\n    return status;\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Generated but not accepted\""
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GUIUtil::dateTimeStr",
          "args": [
            "wtx->status.open_for"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "dateTimeStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "50-53",
          "snippet": "QString dateTimeStr(qint64 nTime)\n{\n    return dateTimeStr(QDateTime::fromTime_t((qint32)nTime));\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQString dateTimeStr(qint64 nTime)\n{\n    return dateTimeStr(QDateTime::fromTime_t((qint32)nTime));\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Open for %n more block(s)\"",
            "\"\"",
            "wtx->status.open_for"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "copyEntryData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "153-164",
          "snippet": "void copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QString TransactionTableModel::formatTxStatus(const TransactionRecord *wtx) const\n  {\n      QString status;\n  \n      switch(wtx->status.status)\n      {\n      case TransactionStatus::OpenUntilBlock:\n          status = tr(\"Open for %n more block(s)\",\"\",wtx->status.open_for);\n          break;\n      case TransactionStatus::OpenUntilDate:\n          status = tr(\"Open until %1\").arg(GUIUtil::dateTimeStr(wtx->status.open_for));\n          break;\n      case TransactionStatus::Offline:\n          status = tr(\"Offline\");\n          break;\n      case TransactionStatus::Unconfirmed:\n          status = tr(\"Unconfirmed\");\n          break;\n      case TransactionStatus::Confirming:\n          status = tr(\"Confirming (%1 of %2 recommended confirmations)\").arg(wtx->status.depth).arg(TransactionRecord::RecommendedNumConfirmations);\n          break;\n      case TransactionStatus::Confirmed:\n          status = tr(\"Confirmed (%1 confirmations)\").arg(wtx->status.depth);\n          break;\n      case TransactionStatus::Conflicted:\n          status = tr(\"Conflicted\");\n          break;\n      case TransactionStatus::Immature:\n          status = tr(\"Immature (%1 confirmations, will be available after %2)\").arg(wtx->status.depth).arg(wtx->status.depth + wtx->status.matures_in);\n          break;\n      case TransactionStatus::MaturesWarning:\n          status = tr(\"This block was not received by any other nodes and will probably not be accepted!\");\n          break;\n      case TransactionStatus::NotAccepted:\n          status = tr(\"Generated but not accepted\");\n          break;\n      }\n  \n      return status;\n  }\n}"
  },
  {
    "function_name": "columnCount",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "270-274",
    "snippet": "int TransactionTableModel::columnCount(const QModelIndex &parent) const\n{\n    Q_UNUSED(parent);\n    return columns.length();\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "columns.length",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_UNUSED",
          "args": [
            "parent"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  int TransactionTableModel::columnCount(const QModelIndex &parent) const\n  {\n      Q_UNUSED(parent);\n      return columns.length();\n  }\n}"
  },
  {
    "function_name": "rowCount",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "264-268",
    "snippet": "int TransactionTableModel::rowCount(const QModelIndex &parent) const\n{\n    Q_UNUSED(parent);\n    return priv->size();\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "priv->size",
          "args": [],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Q_UNUSED",
          "args": [
            "parent"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  int TransactionTableModel::rowCount(const QModelIndex &parent) const\n  {\n      Q_UNUSED(parent);\n      return priv->size();\n  }\n}"
  },
  {
    "function_name": "updateConfirmations",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "250-262",
    "snippet": "void TransactionTableModel::updateConfirmations()\n{\n    if(nBestHeight != cachedNumBlocks)\n    {\n        cachedNumBlocks = nBestHeight;\n        // Blocks came in since last poll.\n        // Invalidate status (number of confirmations) and (possibly) description\n        //  for all rows. Qt is smart enough to only actually request the data for the\n        //  visible rows.\n        emit dataChanged(index(0, Status), index(priv->size()-1, Status));\n        emit dataChanged(index(0, ToAddress), index(priv->size()-1, ToAddress));\n    }\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "index",
          "args": [
            "priv->size()-1",
            "ToAddress"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "priv->size",
          "args": [],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "0",
            "ToAddress"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "priv->size()-1",
            "Status"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "0",
            "Status"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  void TransactionTableModel::updateConfirmations()\n  {\n      if(nBestHeight != cachedNumBlocks)\n      {\n          cachedNumBlocks = nBestHeight;\n          // Blocks came in since last poll.\n          // Invalidate status (number of confirmations) and (possibly) description\n          //  for all rows. Qt is smart enough to only actually request the data for the\n          //  visible rows.\n          emit dataChanged(index(0, Status), index(priv->size()-1, Status));\n          emit dataChanged(index(0, ToAddress), index(priv->size()-1, ToAddress));\n      }\n  }\n}"
  },
  {
    "function_name": "updateTransaction",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "242-248",
    "snippet": "void TransactionTableModel::updateTransaction(const QString &hash, int status)\n{\n    uint256 updated;\n    updated.SetHex(hash.toStdString());\n\n    priv->updateWallet(updated, status);\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "priv->updateWallet",
          "args": [
            "updated",
            "status"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "updateWallet",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "87-168",
          "snippet": "void updateWallet(const uint256 &hash, int status)\n    {\n        OutputDebugStringF(\"updateWallet %s %i\\n\", hash.ToString().c_str(), status);\n        {\n            LOCK(wallet->cs_wallet);\n\n            // Find transaction in wallet\n            std::map<uint256, CWalletTx>::iterator mi = wallet->mapWallet.find(hash);\n            bool inWallet = mi != wallet->mapWallet.end();\n\n            // Find bounds of this transaction in model\n            QList<TransactionRecord>::iterator lower = qLowerBound(\n                cachedWallet.begin(), cachedWallet.end(), hash, TxLessThan());\n            QList<TransactionRecord>::iterator upper = qUpperBound(\n                cachedWallet.begin(), cachedWallet.end(), hash, TxLessThan());\n            int lowerIndex = (lower - cachedWallet.begin());\n            int upperIndex = (upper - cachedWallet.begin());\n            bool inModel = (lower != upper);\n\n            // Determine whether to show transaction or not\n            bool showTransaction = (inWallet && TransactionRecord::showTransaction(mi->second));\n\n            if(status == CT_UPDATED)\n            {\n                if(showTransaction && !inModel)\n                    status = CT_NEW; /* Not in model, but want to show, treat as new */\n                if(!showTransaction && inModel)\n                    status = CT_DELETED; /* In model, but want to hide, treat as deleted */\n            }\n\n            OutputDebugStringF(\"   inWallet=%i inModel=%i Index=%i-%i showTransaction=%i derivedStatus=%i\\n\",\n                     inWallet, inModel, lowerIndex, upperIndex, showTransaction, status);\n\n            switch(status)\n            {\n            case CT_NEW:\n                if(inModel)\n                {\n                    OutputDebugStringF(\"Warning: updateWallet: Got CT_NEW, but transaction is already in model\\n\");\n                    break;\n                }\n                if(!inWallet)\n                {\n                    OutputDebugStringF(\"Warning: updateWallet: Got CT_NEW, but transaction is not in wallet\\n\");\n                    break;\n                }\n                if(showTransaction)\n                {\n                    // Added -- insert at the right position\n                    QList<TransactionRecord> toInsert =\n                            TransactionRecord::decomposeTransaction(wallet, mi->second);\n                    if(!toInsert.isEmpty()) /* only if something to insert */\n                    {\n                        parent->beginInsertRows(QModelIndex(), lowerIndex, lowerIndex+toInsert.size()-1);\n                        int insert_idx = lowerIndex;\n                        foreach(const TransactionRecord &rec, toInsert)\n                        {\n                            cachedWallet.insert(insert_idx, rec);\n                            insert_idx += 1;\n                        }\n                        parent->endInsertRows();\n                    }\n                }\n                break;\n            case CT_DELETED:\n                if(!inModel)\n                {\n                    OutputDebugStringF(\"Warning: updateWallet: Got CT_DELETED, but transaction is not in model\\n\");\n                    break;\n                }\n                // Removed -- remove entire transaction from table\n                parent->beginRemoveRows(QModelIndex(), lowerIndex, upperIndex-1);\n                cachedWallet.erase(lower, upper);\n                parent->endRemoveRows();\n                break;\n            case CT_UPDATED:\n                // Miscellaneous updates -- nothing to do, status update will take care of this, and is only computed for\n                // visible transactions.\n                break;\n            }\n        }\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  void updateWallet(const uint256 &hash, int status)\n      {\n          OutputDebugStringF(\"updateWallet %s %i\\n\", hash.ToString().c_str(), status);\n          {\n              LOCK(wallet->cs_wallet);\n  \n              // Find transaction in wallet\n              std::map<uint256, CWalletTx>::iterator mi = wallet->mapWallet.find(hash);\n              bool inWallet = mi != wallet->mapWallet.end();\n  \n              // Find bounds of this transaction in model\n              QList<TransactionRecord>::iterator lower = qLowerBound(\n                  cachedWallet.begin(), cachedWallet.end(), hash, TxLessThan());\n              QList<TransactionRecord>::iterator upper = qUpperBound(\n                  cachedWallet.begin(), cachedWallet.end(), hash, TxLessThan());\n              int lowerIndex = (lower - cachedWallet.begin());\n              int upperIndex = (upper - cachedWallet.begin());\n              bool inModel = (lower != upper);\n  \n              // Determine whether to show transaction or not\n              bool showTransaction = (inWallet && TransactionRecord::showTransaction(mi->second));\n  \n              if(status == CT_UPDATED)\n              {\n                  if(showTransaction && !inModel)\n                      status = CT_NEW; /* Not in model, but want to show, treat as new */\n                  if(!showTransaction && inModel)\n                      status = CT_DELETED; /* In model, but want to hide, treat as deleted */\n              }\n  \n              OutputDebugStringF(\"   inWallet=%i inModel=%i Index=%i-%i showTransaction=%i derivedStatus=%i\\n\",\n                       inWallet, inModel, lowerIndex, upperIndex, showTransaction, status);\n  \n              switch(status)\n              {\n              case CT_NEW:\n                  if(inModel)\n                  {\n                      OutputDebugStringF(\"Warning: updateWallet: Got CT_NEW, but transaction is already in model\\n\");\n                      break;\n                  }\n                  if(!inWallet)\n                  {\n                      OutputDebugStringF(\"Warning: updateWallet: Got CT_NEW, but transaction is not in wallet\\n\");\n                      break;\n                  }\n                  if(showTransaction)\n                  {\n                      // Added -- insert at the right position\n                      QList<TransactionRecord> toInsert =\n                              TransactionRecord::decomposeTransaction(wallet, mi->second);\n                      if(!toInsert.isEmpty()) /* only if something to insert */\n                      {\n                          parent->beginInsertRows(QModelIndex(), lowerIndex, lowerIndex+toInsert.size()-1);\n                          int insert_idx = lowerIndex;\n                          foreach(const TransactionRecord &rec, toInsert)\n                          {\n                              cachedWallet.insert(insert_idx, rec);\n                              insert_idx += 1;\n                          }\n                          parent->endInsertRows();\n                      }\n                  }\n                  break;\n              case CT_DELETED:\n                  if(!inModel)\n                  {\n                      OutputDebugStringF(\"Warning: updateWallet: Got CT_DELETED, but transaction is not in model\\n\");\n                      break;\n                  }\n                  // Removed -- remove entire transaction from table\n                  parent->beginRemoveRows(QModelIndex(), lowerIndex, upperIndex-1);\n                  cachedWallet.erase(lower, upper);\n                  parent->endRemoveRows();\n                  break;\n              case CT_UPDATED:\n                  // Miscellaneous updates -- nothing to do, status update will take care of this, and is only computed for\n                  // visible transactions.\n                  break;\n              }\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "updated.SetHex",
          "args": [
            "hash.toStdString()"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "SetHex",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "346-374",
          "snippet": "void SetHex(const std::string& str)\n    {\n        // skip 0x\n        const char* psz = str.c_str();\n        while (isspace(*psz))\n            psz++;\n        bool fNegative = false;\n        if (*psz == '-')\n        {\n            fNegative = true;\n            psz++;\n        }\n        if (psz[0] == '0' && tolower(psz[1]) == 'x')\n            psz += 2;\n        while (isspace(*psz))\n            psz++;\n\n        // hex string to bignum\n        static const signed char phexdigit[256] = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0 };\n        *this = 0;\n        while (isxdigit(*psz))\n        {\n            *this <<= 4;\n            int n = phexdigit[(unsigned char)*psz++];\n            *this += n;\n        }\n        if (fNegative)\n            *this = 0 - *this;\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void SetHex(const std::string& str)\n      {\n          // skip 0x\n          const char* psz = str.c_str();\n          while (isspace(*psz))\n              psz++;\n          bool fNegative = false;\n          if (*psz == '-')\n          {\n              fNegative = true;\n              psz++;\n          }\n          if (psz[0] == '0' && tolower(psz[1]) == 'x')\n              psz += 2;\n          while (isspace(*psz))\n              psz++;\n  \n          // hex string to bignum\n          static const signed char phexdigit[256] = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0 };\n          *this = 0;\n          while (isxdigit(*psz))\n          {\n              *this <<= 4;\n              int n = phexdigit[(unsigned char)*psz++];\n              *this += n;\n          }\n          if (fNegative)\n              *this = 0 - *this;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.toStdString",
          "args": [],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  void TransactionTableModel::updateTransaction(const QString &hash, int status)\n  {\n      uint256 updated;\n      updated.SetHex(hash.toStdString());\n  \n      priv->updateWallet(updated, status);\n  }\n}"
  },
  {
    "function_name": "~TransactionTableModel",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "237-240",
    "snippet": "TransactionTableModel::~TransactionTableModel()\n{\n    delete priv;\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  TransactionTableModel::~TransactionTableModel()\n  {\n      delete priv;\n  }\n}"
  },
  {
    "function_name": "TransactionTableModel",
    "container": "TransactionTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "219-235",
    "snippet": "TransactionTableModel::TransactionTableModel(CWallet* wallet, WalletModel *parent):\n        QAbstractTableModel(parent),\n        wallet(wallet),\n        walletModel(parent),\n        priv(new TransactionTablePriv(wallet, this)),\n        cachedNumBlocks(0)\n{\n    columns << QString() << tr(\"Date\") << tr(\"Type\") << tr(\"Address\") << tr(\"Amount\");\n\n    priv->refreshWallet();\n\n    QTimer *timer = new QTimer(this);\n    connect(timer, SIGNAL(timeout()), this, SLOT(updateConfirmations()));\n    timer->start(MODEL_UPDATE_DELAY);\n\n    connect(walletModel->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n}",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "walletModel->getOptionsModel()",
            "SIGNAL(displayUnitChanged(int))",
            "this",
            "SLOT(updateDisplayUnit())"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "updateDisplayUnit()"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "updateDisplayUnit",
          "args": [],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "updateDisplayUnit",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "618-622",
          "snippet": "void TransactionTableModel::updateDisplayUnit()\n{\n    // emit dataChanged to update Amount column with the current unit\n    emit dataChanged(index(0, Amount), index(priv->size()-1, Amount));\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  void TransactionTableModel::updateDisplayUnit()\n  {\n      // emit dataChanged to update Amount column with the current unit\n      emit dataChanged(index(0, Amount), index(priv->size()-1, Amount));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "displayUnitChanged(int)"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "displayUnitChanged",
          "args": [
            "int"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "walletModel->getOptionsModel",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timer->start",
          "args": [
            "MODEL_UPDATE_DELAY"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "timer",
            "SIGNAL(timeout())",
            "this",
            "SLOT(updateConfirmations())"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "updateConfirmations()"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "updateConfirmations",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "updateConfirmations",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "250-262",
          "snippet": "void TransactionTableModel::updateConfirmations()\n{\n    if(nBestHeight != cachedNumBlocks)\n    {\n        cachedNumBlocks = nBestHeight;\n        // Blocks came in since last poll.\n        // Invalidate status (number of confirmations) and (possibly) description\n        //  for all rows. Qt is smart enough to only actually request the data for the\n        //  visible rows.\n        emit dataChanged(index(0, Status), index(priv->size()-1, Status));\n        emit dataChanged(index(0, ToAddress), index(priv->size()-1, ToAddress));\n    }\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  void TransactionTableModel::updateConfirmations()\n  {\n      if(nBestHeight != cachedNumBlocks)\n      {\n          cachedNumBlocks = nBestHeight;\n          // Blocks came in since last poll.\n          // Invalidate status (number of confirmations) and (possibly) description\n          //  for all rows. Qt is smart enough to only actually request the data for the\n          //  visible rows.\n          emit dataChanged(index(0, Status), index(priv->size()-1, Status));\n          emit dataChanged(index(0, ToAddress), index(priv->size()-1, ToAddress));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "timeout()"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timeout",
          "args": [],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "priv->refreshWallet",
          "args": [],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "refreshWallet",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "68-80",
          "snippet": "void refreshWallet()\n    {\n        OutputDebugStringF(\"refreshWallet\\n\");\n        cachedWallet.clear();\n        {\n            LOCK(wallet->cs_wallet);\n            for(std::map<uint256, CWalletTx>::iterator it = wallet->mapWallet.begin(); it != wallet->mapWallet.end(); ++it)\n            {\n                if(TransactionRecord::showTransaction(it->second))\n                    cachedWallet.append(TransactionRecord::decomposeTransaction(wallet, it->second));\n            }\n        }\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  void refreshWallet()\n      {\n          OutputDebugStringF(\"refreshWallet\\n\");\n          cachedWallet.clear();\n          {\n              LOCK(wallet->cs_wallet);\n              for(std::map<uint256, CWalletTx>::iterator it = wallet->mapWallet.begin(); it != wallet->mapWallet.end(); ++it)\n              {\n                  if(TransactionRecord::showTransaction(it->second))\n                      cachedWallet.append(TransactionRecord::decomposeTransaction(wallet, it->second));\n              }\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Amount\""
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  TransactionTableModel::TransactionTableModel(CWallet* wallet, WalletModel *parent):\n          QAbstractTableModel(parent),\n          wallet(wallet),\n          walletModel(parent),\n          priv(new TransactionTablePriv(wallet, this)),\n          cachedNumBlocks(0)\n  {\n      columns << QString() << tr(\"Date\") << tr(\"Type\") << tr(\"Address\") << tr(\"Amount\");\n  \n      priv->refreshWallet();\n  \n      QTimer *timer = new QTimer(this);\n      connect(timer, SIGNAL(timeout()), this, SLOT(updateConfirmations()));\n      timer->start(MODEL_UPDATE_DELAY);\n  \n      connect(walletModel->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n  }\n}"
  },
  {
    "function_name": "describe",
    "container": "TransactionTablePriv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "204-215",
    "snippet": "QString describe(TransactionRecord *rec)\n    {\n        {\n            LOCK(wallet->cs_wallet);\n            std::map<uint256, CWalletTx>::iterator mi = wallet->mapWallet.find(rec->hash);\n            if(mi != wallet->mapWallet.end())\n            {\n                return TransactionDesc::toHTML(wallet, mi->second);\n            }\n        }\n        return QString(\"\");\n    }",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"\""
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionDesc::toHTML",
          "args": [
            "wallet",
            "mi->second"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "toHTML",
          "container": "TransactionDesc",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiondesc.cpp",
          "lines": "35-277",
          "snippet": "QString TransactionDesc::toHTML(CWallet *wallet, CWalletTx &wtx)\n{\n    QString strHTML;\n\n    {\n        LOCK(wallet->cs_wallet);\n        strHTML.reserve(4000);\n        strHTML += \"<html><font face='verdana, arial, helvetica, sans-serif'>\";\n\n        int64_t nTime = wtx.GetTxTime();\n        int64_t nCredit = wtx.GetCredit();\n        int64_t nDebit = wtx.GetDebit();\n        int64_t nNet = nCredit - nDebit;\n\n        strHTML += \"<b>\" + tr(\"Status\") + \":</b> \" + FormatTxStatus(wtx);\n        int nRequests = wtx.GetRequestCount();\n        if (nRequests != -1)\n        {\n            if (nRequests == 0)\n                strHTML += tr(\", has not been successfully broadcast yet\");\n            else if (nRequests > 0)\n                strHTML += tr(\", broadcast through %n node(s)\", \"\", nRequests);\n        }\n        strHTML += \"<br>\";\n\n        strHTML += \"<b>\" + tr(\"Date\") + \":</b> \" + (nTime ? GUIUtil::dateTimeStr(nTime) : \"\") + \"<br>\";\n\n        //\n        // From\n        //\n        if (wtx.IsCoinBase() || wtx.IsCoinStake())\n        {\n            strHTML += \"<b>\" + tr(\"Source\") + \":</b> \" + tr(\"Generated\") + \"<br>\";\n        }\n        else if (wtx.mapValue.count(\"from\") && !wtx.mapValue[\"from\"].empty())\n        {\n            // Online transaction\n            strHTML += \"<b>\" + tr(\"From\") + \":</b> \" + GUIUtil::HtmlEscape(wtx.mapValue[\"from\"]) + \"<br>\";\n        }\n        else\n        {\n            // Offline transaction\n            if (nNet > 0)\n            {\n                // Credit\n                BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n                {\n                    if (wallet->IsMine(txout))\n                    {\n                        CTxDestination address;\n                        if (ExtractDestination(txout.scriptPubKey, address) && IsMine(*wallet, address))\n                        {\n                            if (wallet->mapAddressBook.count(address))\n                            {\n                                strHTML += \"<b>\" + tr(\"From\") + \":</b> \" + tr(\"unknown\") + \"<br>\";\n                                strHTML += \"<b>\" + tr(\"To\") + \":</b> \";\n                                strHTML += GUIUtil::HtmlEscape(CBitcoinAddress(address).ToString());\n                                if (!wallet->mapAddressBook[address].empty())\n                                    strHTML += \" (\" + tr(\"own address\") + \", \" + tr(\"label\") + \": \" + GUIUtil::HtmlEscape(wallet->mapAddressBook[address]) + \")\";\n                                else\n                                    strHTML += \" (\" + tr(\"own address\") + \")\";\n                                strHTML += \"<br>\";\n                            }\n                        }\n                        break;\n                    }\n                }\n            }\n        }\n\n        //\n        // To\n        //\n        if (wtx.mapValue.count(\"to\") && !wtx.mapValue[\"to\"].empty())\n        {\n            // Online transaction\n            std::string strAddress = wtx.mapValue[\"to\"];\n            strHTML += \"<b>\" + tr(\"To\") + \":</b> \";\n            CTxDestination dest = CBitcoinAddress(strAddress).Get();\n            if (wallet->mapAddressBook.count(dest) && !wallet->mapAddressBook[dest].empty())\n                strHTML += GUIUtil::HtmlEscape(wallet->mapAddressBook[dest]) + \" \";\n            strHTML += GUIUtil::HtmlEscape(strAddress) + \"<br>\";\n        }\n\n        //\n        // Amount\n        //\n        if (wtx.IsCoinBase() && nCredit == 0)\n        {\n            //\n            // Coinbase\n            //\n            int64_t nUnmatured = 0;\n            BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n                nUnmatured += wallet->GetCredit(txout);\n            strHTML += \"<b>\" + tr(\"Credit\") + \":</b> \";\n            if (wtx.IsInMainChain())\n                strHTML += BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, nUnmatured)+ \" (\" + tr(\"matures in %n more block(s)\", \"\", wtx.GetBlocksToMaturity()) + \")\";\n            else\n                strHTML += \"(\" + tr(\"not accepted\") + \")\";\n            strHTML += \"<br>\";\n        }\n        else if (nNet > 0)\n        {\n            //\n            // Credit\n            //\n            strHTML += \"<b>\" + tr(\"Credit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, nNet) + \"<br>\";\n        }\n        else\n        {\n            bool fAllFromMe = true;\n            BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n                fAllFromMe = fAllFromMe && wallet->IsMine(txin);\n\n            bool fAllToMe = true;\n            BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n                fAllToMe = fAllToMe && wallet->IsMine(txout);\n\n            if (fAllFromMe)\n            {\n                //\n                // Debit\n                //\n                BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n                {\n                    if (wallet->IsMine(txout))\n                        continue;\n\n                    if (!wtx.mapValue.count(\"to\") || wtx.mapValue[\"to\"].empty())\n                    {\n                        // Offline transaction\n                        CTxDestination address;\n                        if (ExtractDestination(txout.scriptPubKey, address))\n                        {\n                            strHTML += \"<b>\" + tr(\"To\") + \":</b> \";\n                            if (wallet->mapAddressBook.count(address) && !wallet->mapAddressBook[address].empty())\n                                strHTML += GUIUtil::HtmlEscape(wallet->mapAddressBook[address]) + \" \";\n                            strHTML += GUIUtil::HtmlEscape(CBitcoinAddress(address).ToString());\n                            strHTML += \"<br>\";\n                        }\n                    }\n\n                    strHTML += \"<b>\" + tr(\"Debit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, -txout.nValue) + \"<br>\";\n                }\n\n                if (fAllToMe)\n                {\n                    // Payment to self\n                    int64_t nChange = wtx.GetChange();\n                    int64_t nValue = nCredit - nChange;\n                    strHTML += \"<b>\" + tr(\"Debit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, -nValue) + \"<br>\";\n                    strHTML += \"<b>\" + tr(\"Credit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, nValue) + \"<br>\";\n                }\n\n                int64_t nTxFee = nDebit - wtx.GetValueOut();\n                if (nTxFee > 0)\n                    strHTML += \"<b>\" + tr(\"Transaction fee\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, -nTxFee) + \"<br>\";\n            }\n            else\n            {\n                //\n                // Mixed debit transaction\n                //\n                BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n                    if (wallet->IsMine(txin))\n                        strHTML += \"<b>\" + tr(\"Debit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, -wallet->GetDebit(txin)) + \"<br>\";\n                BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n                    if (wallet->IsMine(txout))\n                        strHTML += \"<b>\" + tr(\"Credit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, wallet->GetCredit(txout)) + \"<br>\";\n            }\n        }\n\n        strHTML += \"<b>\" + tr(\"Net amount\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, nNet, true) + \"<br>\";\n\n        //\n        // Message\n        //\n        if (wtx.mapValue.count(\"message\") && !wtx.mapValue[\"message\"].empty())\n            strHTML += \"<br><b>\" + tr(\"Message\") + \":</b><br>\" + GUIUtil::HtmlEscape(wtx.mapValue[\"message\"], true) + \"<br>\";\n        if (wtx.mapValue.count(\"comment\") && !wtx.mapValue[\"comment\"].empty())\n            strHTML += \"<br><b>\" + tr(\"Comment\") + \":</b><br>\" + GUIUtil::HtmlEscape(wtx.mapValue[\"comment\"], true) + \"<br>\";\n\n        strHTML += \"<b>\" + tr(\"Transaction ID\") + \":</b> \" + wtx.GetHash().ToString().c_str() + \"<br>\";\n\n        if (wtx.IsCoinBase() || wtx.IsCoinStake())\n            strHTML += \"<br>\" + tr(\"Generated coins must mature 60 blocks before they can be spent. When you generated this block, it was broadcast to the network to be added to the block chain. If it fails to get into the chain, its state will change to \\\"not accepted\\\" and it won't be spendable. This may occasionally happen if another node generates a block within a few seconds of yours.\") + \"<br>\";\n\n        //\n        // Debug view\n        //\n        if (fDebug)\n        {\n            strHTML += \"<hr><br>\" + tr(\"Debug information\") + \"<br><br>\";\n            BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n                if(wallet->IsMine(txin))\n                    strHTML += \"<b>\" + tr(\"Debit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, -wallet->GetDebit(txin)) + \"<br>\";\n            BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n                if(wallet->IsMine(txout))\n                    strHTML += \"<b>\" + tr(\"Credit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, wallet->GetCredit(txout)) + \"<br>\";\n\n            strHTML += \"<br><b>\" + tr(\"Transaction\") + \":</b><br>\";\n            strHTML += GUIUtil::HtmlEscape(wtx.ToString(), true);\n\n            CTxDB txdb(\"r\"); // To fetch source txouts\n\n            strHTML += \"<br><b>\" + tr(\"Inputs\") + \":</b>\";\n            strHTML += \"<ul>\";\n\n            {\n                LOCK(wallet->cs_wallet);\n                BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n                {\n                    COutPoint prevout = txin.prevout;\n\n                    CTransaction prev;\n                    if(txdb.ReadDiskTx(prevout.hash, prev))\n                    {\n                        if (prevout.n < prev.vout.size())\n                        {\n                            strHTML += \"<li>\";\n                            const CTxOut &vout = prev.vout[prevout.n];\n                            CTxDestination address;\n                            if (ExtractDestination(vout.scriptPubKey, address))\n                            {\n                                if (wallet->mapAddressBook.count(address) && !wallet->mapAddressBook[address].empty())\n                                    strHTML += GUIUtil::HtmlEscape(wallet->mapAddressBook[address]) + \" \";\n                                strHTML += QString::fromStdString(CBitcoinAddress(address).ToString());\n                            }\n                            strHTML = strHTML + \" \" + tr(\"Amount\") + \"=\" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, vout.nValue);\n                            strHTML = strHTML + \" IsMine=\" + (wallet->IsMine(vout) ? tr(\"true\") : tr(\"false\")) + \"</li>\";\n                        }\n                    }\n                }\n            }\n\n            strHTML += \"</ul>\";\n        }\n\n        strHTML += \"</font></html>\";\n    }\n    return strHTML;\n}",
          "includes": [
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"txdb.h\"",
            "#include \"wallet.h\"",
            "#include \"main.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiondesc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"txdb.h\"\n#include \"wallet.h\"\n#include \"main.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"transactiondesc.h\"\n\nTransactionDesc {\n  QString TransactionDesc::toHTML(CWallet *wallet, CWalletTx &wtx)\n  {\n      QString strHTML;\n  \n      {\n          LOCK(wallet->cs_wallet);\n          strHTML.reserve(4000);\n          strHTML += \"<html><font face='verdana, arial, helvetica, sans-serif'>\";\n  \n          int64_t nTime = wtx.GetTxTime();\n          int64_t nCredit = wtx.GetCredit();\n          int64_t nDebit = wtx.GetDebit();\n          int64_t nNet = nCredit - nDebit;\n  \n          strHTML += \"<b>\" + tr(\"Status\") + \":</b> \" + FormatTxStatus(wtx);\n          int nRequests = wtx.GetRequestCount();\n          if (nRequests != -1)\n          {\n              if (nRequests == 0)\n                  strHTML += tr(\", has not been successfully broadcast yet\");\n              else if (nRequests > 0)\n                  strHTML += tr(\", broadcast through %n node(s)\", \"\", nRequests);\n          }\n          strHTML += \"<br>\";\n  \n          strHTML += \"<b>\" + tr(\"Date\") + \":</b> \" + (nTime ? GUIUtil::dateTimeStr(nTime) : \"\") + \"<br>\";\n  \n          //\n          // From\n          //\n          if (wtx.IsCoinBase() || wtx.IsCoinStake())\n          {\n              strHTML += \"<b>\" + tr(\"Source\") + \":</b> \" + tr(\"Generated\") + \"<br>\";\n          }\n          else if (wtx.mapValue.count(\"from\") && !wtx.mapValue[\"from\"].empty())\n          {\n              // Online transaction\n              strHTML += \"<b>\" + tr(\"From\") + \":</b> \" + GUIUtil::HtmlEscape(wtx.mapValue[\"from\"]) + \"<br>\";\n          }\n          else\n          {\n              // Offline transaction\n              if (nNet > 0)\n              {\n                  // Credit\n                  BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n                  {\n                      if (wallet->IsMine(txout))\n                      {\n                          CTxDestination address;\n                          if (ExtractDestination(txout.scriptPubKey, address) && IsMine(*wallet, address))\n                          {\n                              if (wallet->mapAddressBook.count(address))\n                              {\n                                  strHTML += \"<b>\" + tr(\"From\") + \":</b> \" + tr(\"unknown\") + \"<br>\";\n                                  strHTML += \"<b>\" + tr(\"To\") + \":</b> \";\n                                  strHTML += GUIUtil::HtmlEscape(CBitcoinAddress(address).ToString());\n                                  if (!wallet->mapAddressBook[address].empty())\n                                      strHTML += \" (\" + tr(\"own address\") + \", \" + tr(\"label\") + \": \" + GUIUtil::HtmlEscape(wallet->mapAddressBook[address]) + \")\";\n                                  else\n                                      strHTML += \" (\" + tr(\"own address\") + \")\";\n                                  strHTML += \"<br>\";\n                              }\n                          }\n                          break;\n                      }\n                  }\n              }\n          }\n  \n          //\n          // To\n          //\n          if (wtx.mapValue.count(\"to\") && !wtx.mapValue[\"to\"].empty())\n          {\n              // Online transaction\n              std::string strAddress = wtx.mapValue[\"to\"];\n              strHTML += \"<b>\" + tr(\"To\") + \":</b> \";\n              CTxDestination dest = CBitcoinAddress(strAddress).Get();\n              if (wallet->mapAddressBook.count(dest) && !wallet->mapAddressBook[dest].empty())\n                  strHTML += GUIUtil::HtmlEscape(wallet->mapAddressBook[dest]) + \" \";\n              strHTML += GUIUtil::HtmlEscape(strAddress) + \"<br>\";\n          }\n  \n          //\n          // Amount\n          //\n          if (wtx.IsCoinBase() && nCredit == 0)\n          {\n              //\n              // Coinbase\n              //\n              int64_t nUnmatured = 0;\n              BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n                  nUnmatured += wallet->GetCredit(txout);\n              strHTML += \"<b>\" + tr(\"Credit\") + \":</b> \";\n              if (wtx.IsInMainChain())\n                  strHTML += BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, nUnmatured)+ \" (\" + tr(\"matures in %n more block(s)\", \"\", wtx.GetBlocksToMaturity()) + \")\";\n              else\n                  strHTML += \"(\" + tr(\"not accepted\") + \")\";\n              strHTML += \"<br>\";\n          }\n          else if (nNet > 0)\n          {\n              //\n              // Credit\n              //\n              strHTML += \"<b>\" + tr(\"Credit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, nNet) + \"<br>\";\n          }\n          else\n          {\n              bool fAllFromMe = true;\n              BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n                  fAllFromMe = fAllFromMe && wallet->IsMine(txin);\n  \n              bool fAllToMe = true;\n              BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n                  fAllToMe = fAllToMe && wallet->IsMine(txout);\n  \n              if (fAllFromMe)\n              {\n                  //\n                  // Debit\n                  //\n                  BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n                  {\n                      if (wallet->IsMine(txout))\n                          continue;\n  \n                      if (!wtx.mapValue.count(\"to\") || wtx.mapValue[\"to\"].empty())\n                      {\n                          // Offline transaction\n                          CTxDestination address;\n                          if (ExtractDestination(txout.scriptPubKey, address))\n                          {\n                              strHTML += \"<b>\" + tr(\"To\") + \":</b> \";\n                              if (wallet->mapAddressBook.count(address) && !wallet->mapAddressBook[address].empty())\n                                  strHTML += GUIUtil::HtmlEscape(wallet->mapAddressBook[address]) + \" \";\n                              strHTML += GUIUtil::HtmlEscape(CBitcoinAddress(address).ToString());\n                              strHTML += \"<br>\";\n                          }\n                      }\n  \n                      strHTML += \"<b>\" + tr(\"Debit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, -txout.nValue) + \"<br>\";\n                  }\n  \n                  if (fAllToMe)\n                  {\n                      // Payment to self\n                      int64_t nChange = wtx.GetChange();\n                      int64_t nValue = nCredit - nChange;\n                      strHTML += \"<b>\" + tr(\"Debit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, -nValue) + \"<br>\";\n                      strHTML += \"<b>\" + tr(\"Credit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, nValue) + \"<br>\";\n                  }\n  \n                  int64_t nTxFee = nDebit - wtx.GetValueOut();\n                  if (nTxFee > 0)\n                      strHTML += \"<b>\" + tr(\"Transaction fee\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, -nTxFee) + \"<br>\";\n              }\n              else\n              {\n                  //\n                  // Mixed debit transaction\n                  //\n                  BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n                      if (wallet->IsMine(txin))\n                          strHTML += \"<b>\" + tr(\"Debit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, -wallet->GetDebit(txin)) + \"<br>\";\n                  BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n                      if (wallet->IsMine(txout))\n                          strHTML += \"<b>\" + tr(\"Credit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, wallet->GetCredit(txout)) + \"<br>\";\n              }\n          }\n  \n          strHTML += \"<b>\" + tr(\"Net amount\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, nNet, true) + \"<br>\";\n  \n          //\n          // Message\n          //\n          if (wtx.mapValue.count(\"message\") && !wtx.mapValue[\"message\"].empty())\n              strHTML += \"<br><b>\" + tr(\"Message\") + \":</b><br>\" + GUIUtil::HtmlEscape(wtx.mapValue[\"message\"], true) + \"<br>\";\n          if (wtx.mapValue.count(\"comment\") && !wtx.mapValue[\"comment\"].empty())\n              strHTML += \"<br><b>\" + tr(\"Comment\") + \":</b><br>\" + GUIUtil::HtmlEscape(wtx.mapValue[\"comment\"], true) + \"<br>\";\n  \n          strHTML += \"<b>\" + tr(\"Transaction ID\") + \":</b> \" + wtx.GetHash().ToString().c_str() + \"<br>\";\n  \n          if (wtx.IsCoinBase() || wtx.IsCoinStake())\n              strHTML += \"<br>\" + tr(\"Generated coins must mature 60 blocks before they can be spent. When you generated this block, it was broadcast to the network to be added to the block chain. If it fails to get into the chain, its state will change to \\\"not accepted\\\" and it won't be spendable. This may occasionally happen if another node generates a block within a few seconds of yours.\") + \"<br>\";\n  \n          //\n          // Debug view\n          //\n          if (fDebug)\n          {\n              strHTML += \"<hr><br>\" + tr(\"Debug information\") + \"<br><br>\";\n              BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n                  if(wallet->IsMine(txin))\n                      strHTML += \"<b>\" + tr(\"Debit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, -wallet->GetDebit(txin)) + \"<br>\";\n              BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n                  if(wallet->IsMine(txout))\n                      strHTML += \"<b>\" + tr(\"Credit\") + \":</b> \" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, wallet->GetCredit(txout)) + \"<br>\";\n  \n              strHTML += \"<br><b>\" + tr(\"Transaction\") + \":</b><br>\";\n              strHTML += GUIUtil::HtmlEscape(wtx.ToString(), true);\n  \n              CTxDB txdb(\"r\"); // To fetch source txouts\n  \n              strHTML += \"<br><b>\" + tr(\"Inputs\") + \":</b>\";\n              strHTML += \"<ul>\";\n  \n              {\n                  LOCK(wallet->cs_wallet);\n                  BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n                  {\n                      COutPoint prevout = txin.prevout;\n  \n                      CTransaction prev;\n                      if(txdb.ReadDiskTx(prevout.hash, prev))\n                      {\n                          if (prevout.n < prev.vout.size())\n                          {\n                              strHTML += \"<li>\";\n                              const CTxOut &vout = prev.vout[prevout.n];\n                              CTxDestination address;\n                              if (ExtractDestination(vout.scriptPubKey, address))\n                              {\n                                  if (wallet->mapAddressBook.count(address) && !wallet->mapAddressBook[address].empty())\n                                      strHTML += GUIUtil::HtmlEscape(wallet->mapAddressBook[address]) + \" \";\n                                  strHTML += QString::fromStdString(CBitcoinAddress(address).ToString());\n                              }\n                              strHTML = strHTML + \" \" + tr(\"Amount\") + \"=\" + BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, vout.nValue);\n                              strHTML = strHTML + \" IsMine=\" + (wallet->IsMine(vout) ? tr(\"true\") : tr(\"false\")) + \"</li>\";\n                          }\n                      }\n                  }\n              }\n  \n              strHTML += \"</ul>\";\n          }\n  \n          strHTML += \"</font></html>\";\n      }\n      return strHTML;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wallet->mapWallet.end",
          "args": [],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wallet->mapWallet.find",
          "args": [
            "rec->hash"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "wallet->cs_wallet"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  QString describe(TransactionRecord *rec)\n      {\n          {\n              LOCK(wallet->cs_wallet);\n              std::map<uint256, CWalletTx>::iterator mi = wallet->mapWallet.find(rec->hash);\n              if(mi != wallet->mapWallet.end())\n              {\n                  return TransactionDesc::toHTML(wallet, mi->second);\n              }\n          }\n          return QString(\"\");\n      }\n}"
  },
  {
    "function_name": "size",
    "container": "TransactionTablePriv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "170-173",
    "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cachedWallet.size",
          "args": [],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
  },
  {
    "function_name": "updateWallet",
    "container": "TransactionTablePriv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "87-168",
    "snippet": "void updateWallet(const uint256 &hash, int status)\n    {\n        OutputDebugStringF(\"updateWallet %s %i\\n\", hash.ToString().c_str(), status);\n        {\n            LOCK(wallet->cs_wallet);\n\n            // Find transaction in wallet\n            std::map<uint256, CWalletTx>::iterator mi = wallet->mapWallet.find(hash);\n            bool inWallet = mi != wallet->mapWallet.end();\n\n            // Find bounds of this transaction in model\n            QList<TransactionRecord>::iterator lower = qLowerBound(\n                cachedWallet.begin(), cachedWallet.end(), hash, TxLessThan());\n            QList<TransactionRecord>::iterator upper = qUpperBound(\n                cachedWallet.begin(), cachedWallet.end(), hash, TxLessThan());\n            int lowerIndex = (lower - cachedWallet.begin());\n            int upperIndex = (upper - cachedWallet.begin());\n            bool inModel = (lower != upper);\n\n            // Determine whether to show transaction or not\n            bool showTransaction = (inWallet && TransactionRecord::showTransaction(mi->second));\n\n            if(status == CT_UPDATED)\n            {\n                if(showTransaction && !inModel)\n                    status = CT_NEW; /* Not in model, but want to show, treat as new */\n                if(!showTransaction && inModel)\n                    status = CT_DELETED; /* In model, but want to hide, treat as deleted */\n            }\n\n            OutputDebugStringF(\"   inWallet=%i inModel=%i Index=%i-%i showTransaction=%i derivedStatus=%i\\n\",\n                     inWallet, inModel, lowerIndex, upperIndex, showTransaction, status);\n\n            switch(status)\n            {\n            case CT_NEW:\n                if(inModel)\n                {\n                    OutputDebugStringF(\"Warning: updateWallet: Got CT_NEW, but transaction is already in model\\n\");\n                    break;\n                }\n                if(!inWallet)\n                {\n                    OutputDebugStringF(\"Warning: updateWallet: Got CT_NEW, but transaction is not in wallet\\n\");\n                    break;\n                }\n                if(showTransaction)\n                {\n                    // Added -- insert at the right position\n                    QList<TransactionRecord> toInsert =\n                            TransactionRecord::decomposeTransaction(wallet, mi->second);\n                    if(!toInsert.isEmpty()) /* only if something to insert */\n                    {\n                        parent->beginInsertRows(QModelIndex(), lowerIndex, lowerIndex+toInsert.size()-1);\n                        int insert_idx = lowerIndex;\n                        foreach(const TransactionRecord &rec, toInsert)\n                        {\n                            cachedWallet.insert(insert_idx, rec);\n                            insert_idx += 1;\n                        }\n                        parent->endInsertRows();\n                    }\n                }\n                break;\n            case CT_DELETED:\n                if(!inModel)\n                {\n                    OutputDebugStringF(\"Warning: updateWallet: Got CT_DELETED, but transaction is not in model\\n\");\n                    break;\n                }\n                // Removed -- remove entire transaction from table\n                parent->beginRemoveRows(QModelIndex(), lowerIndex, upperIndex-1);\n                cachedWallet.erase(lower, upper);\n                parent->endRemoveRows();\n                break;\n            case CT_UPDATED:\n                // Miscellaneous updates -- nothing to do, status update will take care of this, and is only computed for\n                // visible transactions.\n                break;\n            }\n        }\n    }",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parent->endRemoveRows",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cachedWallet.erase",
          "args": [
            "lower",
            "upper"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "870-888",
          "snippet": "iterator erase(iterator first, iterator last)\n    {\n        if (first == vch.begin() + nReadPos)\n        {\n            // special case for erasing from the front\n            if (last == vch.end())\n            {\n                nReadPos = 0;\n                return vch.erase(vch.begin(), vch.end());\n            }\n            else\n            {\n                nReadPos = (last - vch.begin());\n                return last;\n            }\n        }\n        else\n            return vch.erase(first, last);\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  iterator erase(iterator first, iterator last)\n      {\n          if (first == vch.begin() + nReadPos)\n          {\n              // special case for erasing from the front\n              if (last == vch.end())\n              {\n                  nReadPos = 0;\n                  return vch.erase(vch.begin(), vch.end());\n              }\n              else\n              {\n                  nReadPos = (last - vch.begin());\n                  return last;\n              }\n          }\n          else\n              return vch.erase(first, last);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "parent->beginRemoveRows",
          "args": [
            "QModelIndex()",
            "lowerIndex",
            "upperIndex-1"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QModelIndex",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OutputDebugStringF",
          "args": [
            "\"Warning: updateWallet: Got CT_DELETED, but transaction is not in model\\n\""
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "OutputDebugStringF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "207-289",
          "snippet": "inline int OutputDebugStringF(const char* pszFormat, ...)\n{\n    int ret = 0;\n    if (fPrintToConsole)\n    {\n        // print to console\n        va_list arg_ptr;\n        va_start(arg_ptr, pszFormat);\n        ret = vprintf(pszFormat, arg_ptr);\n        va_end(arg_ptr);\n    }\n    else if (!fPrintToDebugger)\n    {\n        // print to debug.log\n\n        if (!fileout)\n        {\n            boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n            fileout = fopen(pathDebug.string().c_str(), \"a\");\n            if (fileout) setbuf(fileout, NULL); // unbuffered\n        }\n        if (fileout)\n        {\n            static bool fStartedNewLine = true;\n\n            // This routine may be called by global destructors during shutdown.\n            // Since the order of destruction of static/global objects is undefined,\n            // allocate mutexDebugLog on the heap the first time this routine\n            // is called to avoid crashes during shutdown.\n            static boost::mutex* mutexDebugLog = NULL;\n            if (mutexDebugLog == NULL) mutexDebugLog = new boost::mutex();\n            boost::mutex::scoped_lock scoped_lock(*mutexDebugLog);\n\n            // reopen the log file, if requested\n            if (fReopenDebugLog) {\n                fReopenDebugLog = false;\n                boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n                if (freopen(pathDebug.string().c_str(),\"a\",fileout) != NULL)\n                    setbuf(fileout, NULL); // unbuffered\n            }\n\n            // Debug print useful for profiling\n            if (fLogTimestamps && fStartedNewLine)\n                fprintf(fileout, \"%s \", DateTimeStrFormat(\"%x %H:%M:%S\", GetTime()).c_str());\n            if (pszFormat[strlen(pszFormat) - 1] == '\\n')\n                fStartedNewLine = true;\n            else\n                fStartedNewLine = false;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            ret = vfprintf(fileout, pszFormat, arg_ptr);\n            va_end(arg_ptr);\n        }\n    }\n\n#ifdef WIN32\n    if (fPrintToDebugger)\n    {\n        static CCriticalSection cs_OutputDebugStringF;\n\n        // accumulate and output a line at a time\n        {\n            LOCK(cs_OutputDebugStringF);\n            static std::string buffer;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            buffer += vstrprintf(pszFormat, arg_ptr);\n            va_end(arg_ptr);\n\n            int line_start = 0, line_end;\n            while((line_end = buffer.find('\\n', line_start)) != -1)\n            {\n                OutputDebugStringA(buffer.substr(line_start, line_end - line_start).c_str());\n                line_start = line_end + 1;\n            }\n            buffer.erase(0, line_start);\n        }\n    }\n#endif\n    return ret;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "bool fPrintToConsole = false;",
            "bool fPrintToDebugger = false;",
            "bool fLogTimestamps = false;",
            "bool fReopenDebugLog = false;",
            "static FILE* fileout = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool fPrintToConsole = false;\nbool fPrintToDebugger = false;\nbool fLogTimestamps = false;\nbool fReopenDebugLog = false;\nstatic FILE* fileout = NULL;\n\ninline int OutputDebugStringF(const char* pszFormat, ...)\n{\n    int ret = 0;\n    if (fPrintToConsole)\n    {\n        // print to console\n        va_list arg_ptr;\n        va_start(arg_ptr, pszFormat);\n        ret = vprintf(pszFormat, arg_ptr);\n        va_end(arg_ptr);\n    }\n    else if (!fPrintToDebugger)\n    {\n        // print to debug.log\n\n        if (!fileout)\n        {\n            boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n            fileout = fopen(pathDebug.string().c_str(), \"a\");\n            if (fileout) setbuf(fileout, NULL); // unbuffered\n        }\n        if (fileout)\n        {\n            static bool fStartedNewLine = true;\n\n            // This routine may be called by global destructors during shutdown.\n            // Since the order of destruction of static/global objects is undefined,\n            // allocate mutexDebugLog on the heap the first time this routine\n            // is called to avoid crashes during shutdown.\n            static boost::mutex* mutexDebugLog = NULL;\n            if (mutexDebugLog == NULL) mutexDebugLog = new boost::mutex();\n            boost::mutex::scoped_lock scoped_lock(*mutexDebugLog);\n\n            // reopen the log file, if requested\n            if (fReopenDebugLog) {\n                fReopenDebugLog = false;\n                boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n                if (freopen(pathDebug.string().c_str(),\"a\",fileout) != NULL)\n                    setbuf(fileout, NULL); // unbuffered\n            }\n\n            // Debug print useful for profiling\n            if (fLogTimestamps && fStartedNewLine)\n                fprintf(fileout, \"%s \", DateTimeStrFormat(\"%x %H:%M:%S\", GetTime()).c_str());\n            if (pszFormat[strlen(pszFormat) - 1] == '\\n')\n                fStartedNewLine = true;\n            else\n                fStartedNewLine = false;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            ret = vfprintf(fileout, pszFormat, arg_ptr);\n            va_end(arg_ptr);\n        }\n    }\n\n#ifdef WIN32\n    if (fPrintToDebugger)\n    {\n        static CCriticalSection cs_OutputDebugStringF;\n\n        // accumulate and output a line at a time\n        {\n            LOCK(cs_OutputDebugStringF);\n            static std::string buffer;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            buffer += vstrprintf(pszFormat, arg_ptr);\n            va_end(arg_ptr);\n\n            int line_start = 0, line_end;\n            while((line_end = buffer.find('\\n', line_start)) != -1)\n            {\n                OutputDebugStringA(buffer.substr(line_start, line_end - line_start).c_str());\n                line_start = line_end + 1;\n            }\n            buffer.erase(0, line_start);\n        }\n    }\n#endif\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "parent->endInsertRows",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cachedWallet.insert",
          "args": [
            "insert_idx",
            "rec"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parent->beginInsertRows",
          "args": [
            "QModelIndex()",
            "lowerIndex",
            "lowerIndex+toInsert.size()-1"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toInsert.size",
          "args": [],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QModelIndex",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toInsert.isEmpty",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionRecord::decomposeTransaction",
          "args": [
            "wallet",
            "mi->second"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "decomposeTransaction",
          "container": "TransactionRecord",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionrecord.cpp",
          "lines": "24-154",
          "snippet": "QList<TransactionRecord> TransactionRecord::decomposeTransaction(const CWallet *wallet, const CWalletTx &wtx)\n{\n    QList<TransactionRecord> parts;\n    int64_t nTime = wtx.GetTxTime();\n    int64_t nCredit = wtx.GetCredit(true);\n    int64_t nDebit = wtx.GetDebit();\n    int64_t nNet = nCredit - nDebit;\n    uint256 hash = wtx.GetHash(), hashPrev = 0;\n    std::map<std::string, std::string> mapValue = wtx.mapValue;\n\n    if (nNet > 0 || wtx.IsCoinBase() || wtx.IsCoinStake())\n    {\n        //\n        // Credit\n        //\n        BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n        {\n            if(wallet->IsMine(txout))\n            {\n                TransactionRecord sub(hash, nTime);\n                CTxDestination address;\n                sub.idx = parts.size(); // sequence number\n                sub.credit = txout.nValue;\n                if (ExtractDestination(txout.scriptPubKey, address) && IsMine(*wallet, address))\n                {\n                    // Received by Bitcoin Address\n                    sub.type = TransactionRecord::RecvWithAddress;\n                    sub.address = CBitcoinAddress(address).ToString();\n                }\n                else\n                {\n                    // Received by IP connection (deprecated features), or a multisignature or other non-simple transaction\n                    sub.type = TransactionRecord::RecvFromOther;\n                    sub.address = mapValue[\"from\"];\n                }\n                if (wtx.IsCoinBase())\n                {\n                    // Generated (proof-of-work)\n                    sub.type = TransactionRecord::Generated;\n                }\n                if (wtx.IsCoinStake())\n                {\n                    // Generated (proof-of-stake)\n\n                    if (hashPrev == hash)\n                        continue; // last coinstake output\n\n                    sub.type = TransactionRecord::Generated;\n                    sub.credit = nNet > 0 ? nNet : wtx.GetValueOut() - nDebit;\n                    hashPrev = hash;\n                }\n\n                parts.append(sub);\n            }\n        }\n    }\n    else\n    {\n        bool fAllFromMe = true;\n        BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n            fAllFromMe = fAllFromMe && wallet->IsMine(txin);\n\n        bool fAllToMe = true;\n        BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n            fAllToMe = fAllToMe && wallet->IsMine(txout);\n\n        if (fAllFromMe && fAllToMe)\n        {\n            // Payment to self\n            int64_t nChange = wtx.GetChange();\n\n            parts.append(TransactionRecord(hash, nTime, TransactionRecord::SendToSelf, \"\",\n                            -(nDebit - nChange), nCredit - nChange));\n        }\n        else if (fAllFromMe)\n        {\n            //\n            // Debit\n            //\n            int64_t nTxFee = nDebit - wtx.GetValueOut();\n\n            for (unsigned int nOut = 0; nOut < wtx.vout.size(); nOut++)\n            {\n                const CTxOut& txout = wtx.vout[nOut];\n                TransactionRecord sub(hash, nTime);\n                sub.idx = parts.size();\n\n                if(wallet->IsMine(txout))\n                {\n                    // Ignore parts sent to self, as this is usually the change\n                    // from a transaction sent back to our own address.\n                    continue;\n                }\n\n                CTxDestination address;\n                if (ExtractDestination(txout.scriptPubKey, address))\n                {\n                    // Sent to Bitcoin Address\n                    sub.type = TransactionRecord::SendToAddress;\n                    sub.address = CBitcoinAddress(address).ToString();\n                }\n                else\n                {\n                    // Sent to IP, or other non-address transaction like OP_EVAL\n                    sub.type = TransactionRecord::SendToOther;\n                    sub.address = mapValue[\"to\"];\n                }\n\n                int64_t nValue = txout.nValue;\n                /* Add fee to first output */\n                if (nTxFee > 0)\n                {\n                    nValue += nTxFee;\n                    nTxFee = 0;\n                }\n                sub.debit = -nValue;\n\n                parts.append(sub);\n            }\n        }\n        else\n        {\n            //\n            // Mixed debit transaction, can't break down payees\n            //\n            parts.append(TransactionRecord(hash, nTime, TransactionRecord::Other, \"\", nNet, 0));\n        }\n    }\n\n    return parts;\n}",
          "includes": [
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"transactionrecord.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"wallet.h\"\n#include \"transactionrecord.h\"\n\nTransactionRecord {\n  QList<TransactionRecord> TransactionRecord::decomposeTransaction(const CWallet *wallet, const CWalletTx &wtx)\n  {\n      QList<TransactionRecord> parts;\n      int64_t nTime = wtx.GetTxTime();\n      int64_t nCredit = wtx.GetCredit(true);\n      int64_t nDebit = wtx.GetDebit();\n      int64_t nNet = nCredit - nDebit;\n      uint256 hash = wtx.GetHash(), hashPrev = 0;\n      std::map<std::string, std::string> mapValue = wtx.mapValue;\n  \n      if (nNet > 0 || wtx.IsCoinBase() || wtx.IsCoinStake())\n      {\n          //\n          // Credit\n          //\n          BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n          {\n              if(wallet->IsMine(txout))\n              {\n                  TransactionRecord sub(hash, nTime);\n                  CTxDestination address;\n                  sub.idx = parts.size(); // sequence number\n                  sub.credit = txout.nValue;\n                  if (ExtractDestination(txout.scriptPubKey, address) && IsMine(*wallet, address))\n                  {\n                      // Received by Bitcoin Address\n                      sub.type = TransactionRecord::RecvWithAddress;\n                      sub.address = CBitcoinAddress(address).ToString();\n                  }\n                  else\n                  {\n                      // Received by IP connection (deprecated features), or a multisignature or other non-simple transaction\n                      sub.type = TransactionRecord::RecvFromOther;\n                      sub.address = mapValue[\"from\"];\n                  }\n                  if (wtx.IsCoinBase())\n                  {\n                      // Generated (proof-of-work)\n                      sub.type = TransactionRecord::Generated;\n                  }\n                  if (wtx.IsCoinStake())\n                  {\n                      // Generated (proof-of-stake)\n  \n                      if (hashPrev == hash)\n                          continue; // last coinstake output\n  \n                      sub.type = TransactionRecord::Generated;\n                      sub.credit = nNet > 0 ? nNet : wtx.GetValueOut() - nDebit;\n                      hashPrev = hash;\n                  }\n  \n                  parts.append(sub);\n              }\n          }\n      }\n      else\n      {\n          bool fAllFromMe = true;\n          BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n              fAllFromMe = fAllFromMe && wallet->IsMine(txin);\n  \n          bool fAllToMe = true;\n          BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n              fAllToMe = fAllToMe && wallet->IsMine(txout);\n  \n          if (fAllFromMe && fAllToMe)\n          {\n              // Payment to self\n              int64_t nChange = wtx.GetChange();\n  \n              parts.append(TransactionRecord(hash, nTime, TransactionRecord::SendToSelf, \"\",\n                              -(nDebit - nChange), nCredit - nChange));\n          }\n          else if (fAllFromMe)\n          {\n              //\n              // Debit\n              //\n              int64_t nTxFee = nDebit - wtx.GetValueOut();\n  \n              for (unsigned int nOut = 0; nOut < wtx.vout.size(); nOut++)\n              {\n                  const CTxOut& txout = wtx.vout[nOut];\n                  TransactionRecord sub(hash, nTime);\n                  sub.idx = parts.size();\n  \n                  if(wallet->IsMine(txout))\n                  {\n                      // Ignore parts sent to self, as this is usually the change\n                      // from a transaction sent back to our own address.\n                      continue;\n                  }\n  \n                  CTxDestination address;\n                  if (ExtractDestination(txout.scriptPubKey, address))\n                  {\n                      // Sent to Bitcoin Address\n                      sub.type = TransactionRecord::SendToAddress;\n                      sub.address = CBitcoinAddress(address).ToString();\n                  }\n                  else\n                  {\n                      // Sent to IP, or other non-address transaction like OP_EVAL\n                      sub.type = TransactionRecord::SendToOther;\n                      sub.address = mapValue[\"to\"];\n                  }\n  \n                  int64_t nValue = txout.nValue;\n                  /* Add fee to first output */\n                  if (nTxFee > 0)\n                  {\n                      nValue += nTxFee;\n                      nTxFee = 0;\n                  }\n                  sub.debit = -nValue;\n  \n                  parts.append(sub);\n              }\n          }\n          else\n          {\n              //\n              // Mixed debit transaction, can't break down payees\n              //\n              parts.append(TransactionRecord(hash, nTime, TransactionRecord::Other, \"\", nNet, 0));\n          }\n      }\n  \n      return parts;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "OutputDebugStringF",
          "args": [
            "\"   inWallet=%i inModel=%i Index=%i-%i showTransaction=%i derivedStatus=%i\\n\"",
            "inWallet",
            "inModel",
            "lowerIndex",
            "upperIndex",
            "showTransaction",
            "status"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionRecord::showTransaction",
          "args": [
            "mi->second"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "showTransaction",
          "container": "TransactionRecord",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionrecord.cpp",
          "lines": "8-19",
          "snippet": "bool TransactionRecord::showTransaction(const CWalletTx &wtx)\n{\n    if (wtx.IsCoinBase())\n    {\n        // Ensures we show generated coins / mined transactions at depth 1\n        if (!wtx.IsInMainChain())\n        {\n            return false;\n        }\n    }\n    return true;\n}",
          "includes": [
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"transactionrecord.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"wallet.h\"\n#include \"transactionrecord.h\"\n\nTransactionRecord {\n  bool TransactionRecord::showTransaction(const CWalletTx &wtx)\n  {\n      if (wtx.IsCoinBase())\n      {\n          // Ensures we show generated coins / mined transactions at depth 1\n          if (!wtx.IsInMainChain())\n          {\n              return false;\n          }\n      }\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cachedWallet.begin",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "qUpperBound",
          "args": [
            "cachedWallet.begin()",
            "cachedWallet.end()",
            "hash",
            "TxLessThan()"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TxLessThan",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cachedWallet.end",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "qLowerBound",
          "args": [
            "cachedWallet.begin()",
            "cachedWallet.end()",
            "hash",
            "TxLessThan()"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TxLessThan",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wallet->mapWallet.find",
          "args": [
            "hash"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "wallet->cs_wallet"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OutputDebugStringF",
          "args": [
            "\"updateWallet %s %i\\n\"",
            "hash.ToString().c_str()",
            "status"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.ToString",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  void updateWallet(const uint256 &hash, int status)\n      {\n          OutputDebugStringF(\"updateWallet %s %i\\n\", hash.ToString().c_str(), status);\n          {\n              LOCK(wallet->cs_wallet);\n  \n              // Find transaction in wallet\n              std::map<uint256, CWalletTx>::iterator mi = wallet->mapWallet.find(hash);\n              bool inWallet = mi != wallet->mapWallet.end();\n  \n              // Find bounds of this transaction in model\n              QList<TransactionRecord>::iterator lower = qLowerBound(\n                  cachedWallet.begin(), cachedWallet.end(), hash, TxLessThan());\n              QList<TransactionRecord>::iterator upper = qUpperBound(\n                  cachedWallet.begin(), cachedWallet.end(), hash, TxLessThan());\n              int lowerIndex = (lower - cachedWallet.begin());\n              int upperIndex = (upper - cachedWallet.begin());\n              bool inModel = (lower != upper);\n  \n              // Determine whether to show transaction or not\n              bool showTransaction = (inWallet && TransactionRecord::showTransaction(mi->second));\n  \n              if(status == CT_UPDATED)\n              {\n                  if(showTransaction && !inModel)\n                      status = CT_NEW; /* Not in model, but want to show, treat as new */\n                  if(!showTransaction && inModel)\n                      status = CT_DELETED; /* In model, but want to hide, treat as deleted */\n              }\n  \n              OutputDebugStringF(\"   inWallet=%i inModel=%i Index=%i-%i showTransaction=%i derivedStatus=%i\\n\",\n                       inWallet, inModel, lowerIndex, upperIndex, showTransaction, status);\n  \n              switch(status)\n              {\n              case CT_NEW:\n                  if(inModel)\n                  {\n                      OutputDebugStringF(\"Warning: updateWallet: Got CT_NEW, but transaction is already in model\\n\");\n                      break;\n                  }\n                  if(!inWallet)\n                  {\n                      OutputDebugStringF(\"Warning: updateWallet: Got CT_NEW, but transaction is not in wallet\\n\");\n                      break;\n                  }\n                  if(showTransaction)\n                  {\n                      // Added -- insert at the right position\n                      QList<TransactionRecord> toInsert =\n                              TransactionRecord::decomposeTransaction(wallet, mi->second);\n                      if(!toInsert.isEmpty()) /* only if something to insert */\n                      {\n                          parent->beginInsertRows(QModelIndex(), lowerIndex, lowerIndex+toInsert.size()-1);\n                          int insert_idx = lowerIndex;\n                          foreach(const TransactionRecord &rec, toInsert)\n                          {\n                              cachedWallet.insert(insert_idx, rec);\n                              insert_idx += 1;\n                          }\n                          parent->endInsertRows();\n                      }\n                  }\n                  break;\n              case CT_DELETED:\n                  if(!inModel)\n                  {\n                      OutputDebugStringF(\"Warning: updateWallet: Got CT_DELETED, but transaction is not in model\\n\");\n                      break;\n                  }\n                  // Removed -- remove entire transaction from table\n                  parent->beginRemoveRows(QModelIndex(), lowerIndex, upperIndex-1);\n                  cachedWallet.erase(lower, upper);\n                  parent->endRemoveRows();\n                  break;\n              case CT_UPDATED:\n                  // Miscellaneous updates -- nothing to do, status update will take care of this, and is only computed for\n                  // visible transactions.\n                  break;\n              }\n          }\n      }\n}"
  },
  {
    "function_name": "refreshWallet",
    "container": "TransactionTablePriv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "68-80",
    "snippet": "void refreshWallet()\n    {\n        OutputDebugStringF(\"refreshWallet\\n\");\n        cachedWallet.clear();\n        {\n            LOCK(wallet->cs_wallet);\n            for(std::map<uint256, CWalletTx>::iterator it = wallet->mapWallet.begin(); it != wallet->mapWallet.end(); ++it)\n            {\n                if(TransactionRecord::showTransaction(it->second))\n                    cachedWallet.append(TransactionRecord::decomposeTransaction(wallet, it->second));\n            }\n        }\n    }",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cachedWallet.append",
          "args": [
            "TransactionRecord::decomposeTransaction(wallet, it->second)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionRecord::decomposeTransaction",
          "args": [
            "wallet",
            "it->second"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "decomposeTransaction",
          "container": "TransactionRecord",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionrecord.cpp",
          "lines": "24-154",
          "snippet": "QList<TransactionRecord> TransactionRecord::decomposeTransaction(const CWallet *wallet, const CWalletTx &wtx)\n{\n    QList<TransactionRecord> parts;\n    int64_t nTime = wtx.GetTxTime();\n    int64_t nCredit = wtx.GetCredit(true);\n    int64_t nDebit = wtx.GetDebit();\n    int64_t nNet = nCredit - nDebit;\n    uint256 hash = wtx.GetHash(), hashPrev = 0;\n    std::map<std::string, std::string> mapValue = wtx.mapValue;\n\n    if (nNet > 0 || wtx.IsCoinBase() || wtx.IsCoinStake())\n    {\n        //\n        // Credit\n        //\n        BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n        {\n            if(wallet->IsMine(txout))\n            {\n                TransactionRecord sub(hash, nTime);\n                CTxDestination address;\n                sub.idx = parts.size(); // sequence number\n                sub.credit = txout.nValue;\n                if (ExtractDestination(txout.scriptPubKey, address) && IsMine(*wallet, address))\n                {\n                    // Received by Bitcoin Address\n                    sub.type = TransactionRecord::RecvWithAddress;\n                    sub.address = CBitcoinAddress(address).ToString();\n                }\n                else\n                {\n                    // Received by IP connection (deprecated features), or a multisignature or other non-simple transaction\n                    sub.type = TransactionRecord::RecvFromOther;\n                    sub.address = mapValue[\"from\"];\n                }\n                if (wtx.IsCoinBase())\n                {\n                    // Generated (proof-of-work)\n                    sub.type = TransactionRecord::Generated;\n                }\n                if (wtx.IsCoinStake())\n                {\n                    // Generated (proof-of-stake)\n\n                    if (hashPrev == hash)\n                        continue; // last coinstake output\n\n                    sub.type = TransactionRecord::Generated;\n                    sub.credit = nNet > 0 ? nNet : wtx.GetValueOut() - nDebit;\n                    hashPrev = hash;\n                }\n\n                parts.append(sub);\n            }\n        }\n    }\n    else\n    {\n        bool fAllFromMe = true;\n        BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n            fAllFromMe = fAllFromMe && wallet->IsMine(txin);\n\n        bool fAllToMe = true;\n        BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n            fAllToMe = fAllToMe && wallet->IsMine(txout);\n\n        if (fAllFromMe && fAllToMe)\n        {\n            // Payment to self\n            int64_t nChange = wtx.GetChange();\n\n            parts.append(TransactionRecord(hash, nTime, TransactionRecord::SendToSelf, \"\",\n                            -(nDebit - nChange), nCredit - nChange));\n        }\n        else if (fAllFromMe)\n        {\n            //\n            // Debit\n            //\n            int64_t nTxFee = nDebit - wtx.GetValueOut();\n\n            for (unsigned int nOut = 0; nOut < wtx.vout.size(); nOut++)\n            {\n                const CTxOut& txout = wtx.vout[nOut];\n                TransactionRecord sub(hash, nTime);\n                sub.idx = parts.size();\n\n                if(wallet->IsMine(txout))\n                {\n                    // Ignore parts sent to self, as this is usually the change\n                    // from a transaction sent back to our own address.\n                    continue;\n                }\n\n                CTxDestination address;\n                if (ExtractDestination(txout.scriptPubKey, address))\n                {\n                    // Sent to Bitcoin Address\n                    sub.type = TransactionRecord::SendToAddress;\n                    sub.address = CBitcoinAddress(address).ToString();\n                }\n                else\n                {\n                    // Sent to IP, or other non-address transaction like OP_EVAL\n                    sub.type = TransactionRecord::SendToOther;\n                    sub.address = mapValue[\"to\"];\n                }\n\n                int64_t nValue = txout.nValue;\n                /* Add fee to first output */\n                if (nTxFee > 0)\n                {\n                    nValue += nTxFee;\n                    nTxFee = 0;\n                }\n                sub.debit = -nValue;\n\n                parts.append(sub);\n            }\n        }\n        else\n        {\n            //\n            // Mixed debit transaction, can't break down payees\n            //\n            parts.append(TransactionRecord(hash, nTime, TransactionRecord::Other, \"\", nNet, 0));\n        }\n    }\n\n    return parts;\n}",
          "includes": [
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"transactionrecord.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"wallet.h\"\n#include \"transactionrecord.h\"\n\nTransactionRecord {\n  QList<TransactionRecord> TransactionRecord::decomposeTransaction(const CWallet *wallet, const CWalletTx &wtx)\n  {\n      QList<TransactionRecord> parts;\n      int64_t nTime = wtx.GetTxTime();\n      int64_t nCredit = wtx.GetCredit(true);\n      int64_t nDebit = wtx.GetDebit();\n      int64_t nNet = nCredit - nDebit;\n      uint256 hash = wtx.GetHash(), hashPrev = 0;\n      std::map<std::string, std::string> mapValue = wtx.mapValue;\n  \n      if (nNet > 0 || wtx.IsCoinBase() || wtx.IsCoinStake())\n      {\n          //\n          // Credit\n          //\n          BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n          {\n              if(wallet->IsMine(txout))\n              {\n                  TransactionRecord sub(hash, nTime);\n                  CTxDestination address;\n                  sub.idx = parts.size(); // sequence number\n                  sub.credit = txout.nValue;\n                  if (ExtractDestination(txout.scriptPubKey, address) && IsMine(*wallet, address))\n                  {\n                      // Received by Bitcoin Address\n                      sub.type = TransactionRecord::RecvWithAddress;\n                      sub.address = CBitcoinAddress(address).ToString();\n                  }\n                  else\n                  {\n                      // Received by IP connection (deprecated features), or a multisignature or other non-simple transaction\n                      sub.type = TransactionRecord::RecvFromOther;\n                      sub.address = mapValue[\"from\"];\n                  }\n                  if (wtx.IsCoinBase())\n                  {\n                      // Generated (proof-of-work)\n                      sub.type = TransactionRecord::Generated;\n                  }\n                  if (wtx.IsCoinStake())\n                  {\n                      // Generated (proof-of-stake)\n  \n                      if (hashPrev == hash)\n                          continue; // last coinstake output\n  \n                      sub.type = TransactionRecord::Generated;\n                      sub.credit = nNet > 0 ? nNet : wtx.GetValueOut() - nDebit;\n                      hashPrev = hash;\n                  }\n  \n                  parts.append(sub);\n              }\n          }\n      }\n      else\n      {\n          bool fAllFromMe = true;\n          BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n              fAllFromMe = fAllFromMe && wallet->IsMine(txin);\n  \n          bool fAllToMe = true;\n          BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n              fAllToMe = fAllToMe && wallet->IsMine(txout);\n  \n          if (fAllFromMe && fAllToMe)\n          {\n              // Payment to self\n              int64_t nChange = wtx.GetChange();\n  \n              parts.append(TransactionRecord(hash, nTime, TransactionRecord::SendToSelf, \"\",\n                              -(nDebit - nChange), nCredit - nChange));\n          }\n          else if (fAllFromMe)\n          {\n              //\n              // Debit\n              //\n              int64_t nTxFee = nDebit - wtx.GetValueOut();\n  \n              for (unsigned int nOut = 0; nOut < wtx.vout.size(); nOut++)\n              {\n                  const CTxOut& txout = wtx.vout[nOut];\n                  TransactionRecord sub(hash, nTime);\n                  sub.idx = parts.size();\n  \n                  if(wallet->IsMine(txout))\n                  {\n                      // Ignore parts sent to self, as this is usually the change\n                      // from a transaction sent back to our own address.\n                      continue;\n                  }\n  \n                  CTxDestination address;\n                  if (ExtractDestination(txout.scriptPubKey, address))\n                  {\n                      // Sent to Bitcoin Address\n                      sub.type = TransactionRecord::SendToAddress;\n                      sub.address = CBitcoinAddress(address).ToString();\n                  }\n                  else\n                  {\n                      // Sent to IP, or other non-address transaction like OP_EVAL\n                      sub.type = TransactionRecord::SendToOther;\n                      sub.address = mapValue[\"to\"];\n                  }\n  \n                  int64_t nValue = txout.nValue;\n                  /* Add fee to first output */\n                  if (nTxFee > 0)\n                  {\n                      nValue += nTxFee;\n                      nTxFee = 0;\n                  }\n                  sub.debit = -nValue;\n  \n                  parts.append(sub);\n              }\n          }\n          else\n          {\n              //\n              // Mixed debit transaction, can't break down payees\n              //\n              parts.append(TransactionRecord(hash, nTime, TransactionRecord::Other, \"\", nNet, 0));\n          }\n      }\n  \n      return parts;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TransactionRecord::showTransaction",
          "args": [
            "it->second"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "showTransaction",
          "container": "TransactionRecord",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionrecord.cpp",
          "lines": "8-19",
          "snippet": "bool TransactionRecord::showTransaction(const CWalletTx &wtx)\n{\n    if (wtx.IsCoinBase())\n    {\n        // Ensures we show generated coins / mined transactions at depth 1\n        if (!wtx.IsInMainChain())\n        {\n            return false;\n        }\n    }\n    return true;\n}",
          "includes": [
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"transactionrecord.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"wallet.h\"\n#include \"transactionrecord.h\"\n\nTransactionRecord {\n  bool TransactionRecord::showTransaction(const CWalletTx &wtx)\n  {\n      if (wtx.IsCoinBase())\n      {\n          // Ensures we show generated coins / mined transactions at depth 1\n          if (!wtx.IsInMainChain())\n          {\n              return false;\n          }\n      }\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wallet->mapWallet.end",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wallet->mapWallet.begin",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "wallet->cs_wallet"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cachedWallet.clear",
          "args": [],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "OutputDebugStringF",
          "args": [
            "\"refreshWallet\\n\""
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "OutputDebugStringF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "207-289",
          "snippet": "inline int OutputDebugStringF(const char* pszFormat, ...)\n{\n    int ret = 0;\n    if (fPrintToConsole)\n    {\n        // print to console\n        va_list arg_ptr;\n        va_start(arg_ptr, pszFormat);\n        ret = vprintf(pszFormat, arg_ptr);\n        va_end(arg_ptr);\n    }\n    else if (!fPrintToDebugger)\n    {\n        // print to debug.log\n\n        if (!fileout)\n        {\n            boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n            fileout = fopen(pathDebug.string().c_str(), \"a\");\n            if (fileout) setbuf(fileout, NULL); // unbuffered\n        }\n        if (fileout)\n        {\n            static bool fStartedNewLine = true;\n\n            // This routine may be called by global destructors during shutdown.\n            // Since the order of destruction of static/global objects is undefined,\n            // allocate mutexDebugLog on the heap the first time this routine\n            // is called to avoid crashes during shutdown.\n            static boost::mutex* mutexDebugLog = NULL;\n            if (mutexDebugLog == NULL) mutexDebugLog = new boost::mutex();\n            boost::mutex::scoped_lock scoped_lock(*mutexDebugLog);\n\n            // reopen the log file, if requested\n            if (fReopenDebugLog) {\n                fReopenDebugLog = false;\n                boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n                if (freopen(pathDebug.string().c_str(),\"a\",fileout) != NULL)\n                    setbuf(fileout, NULL); // unbuffered\n            }\n\n            // Debug print useful for profiling\n            if (fLogTimestamps && fStartedNewLine)\n                fprintf(fileout, \"%s \", DateTimeStrFormat(\"%x %H:%M:%S\", GetTime()).c_str());\n            if (pszFormat[strlen(pszFormat) - 1] == '\\n')\n                fStartedNewLine = true;\n            else\n                fStartedNewLine = false;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            ret = vfprintf(fileout, pszFormat, arg_ptr);\n            va_end(arg_ptr);\n        }\n    }\n\n#ifdef WIN32\n    if (fPrintToDebugger)\n    {\n        static CCriticalSection cs_OutputDebugStringF;\n\n        // accumulate and output a line at a time\n        {\n            LOCK(cs_OutputDebugStringF);\n            static std::string buffer;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            buffer += vstrprintf(pszFormat, arg_ptr);\n            va_end(arg_ptr);\n\n            int line_start = 0, line_end;\n            while((line_end = buffer.find('\\n', line_start)) != -1)\n            {\n                OutputDebugStringA(buffer.substr(line_start, line_end - line_start).c_str());\n                line_start = line_end + 1;\n            }\n            buffer.erase(0, line_start);\n        }\n    }\n#endif\n    return ret;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "bool fPrintToConsole = false;",
            "bool fPrintToDebugger = false;",
            "bool fLogTimestamps = false;",
            "bool fReopenDebugLog = false;",
            "static FILE* fileout = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool fPrintToConsole = false;\nbool fPrintToDebugger = false;\nbool fLogTimestamps = false;\nbool fReopenDebugLog = false;\nstatic FILE* fileout = NULL;\n\ninline int OutputDebugStringF(const char* pszFormat, ...)\n{\n    int ret = 0;\n    if (fPrintToConsole)\n    {\n        // print to console\n        va_list arg_ptr;\n        va_start(arg_ptr, pszFormat);\n        ret = vprintf(pszFormat, arg_ptr);\n        va_end(arg_ptr);\n    }\n    else if (!fPrintToDebugger)\n    {\n        // print to debug.log\n\n        if (!fileout)\n        {\n            boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n            fileout = fopen(pathDebug.string().c_str(), \"a\");\n            if (fileout) setbuf(fileout, NULL); // unbuffered\n        }\n        if (fileout)\n        {\n            static bool fStartedNewLine = true;\n\n            // This routine may be called by global destructors during shutdown.\n            // Since the order of destruction of static/global objects is undefined,\n            // allocate mutexDebugLog on the heap the first time this routine\n            // is called to avoid crashes during shutdown.\n            static boost::mutex* mutexDebugLog = NULL;\n            if (mutexDebugLog == NULL) mutexDebugLog = new boost::mutex();\n            boost::mutex::scoped_lock scoped_lock(*mutexDebugLog);\n\n            // reopen the log file, if requested\n            if (fReopenDebugLog) {\n                fReopenDebugLog = false;\n                boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n                if (freopen(pathDebug.string().c_str(),\"a\",fileout) != NULL)\n                    setbuf(fileout, NULL); // unbuffered\n            }\n\n            // Debug print useful for profiling\n            if (fLogTimestamps && fStartedNewLine)\n                fprintf(fileout, \"%s \", DateTimeStrFormat(\"%x %H:%M:%S\", GetTime()).c_str());\n            if (pszFormat[strlen(pszFormat) - 1] == '\\n')\n                fStartedNewLine = true;\n            else\n                fStartedNewLine = false;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            ret = vfprintf(fileout, pszFormat, arg_ptr);\n            va_end(arg_ptr);\n        }\n    }\n\n#ifdef WIN32\n    if (fPrintToDebugger)\n    {\n        static CCriticalSection cs_OutputDebugStringF;\n\n        // accumulate and output a line at a time\n        {\n            LOCK(cs_OutputDebugStringF);\n            static std::string buffer;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            buffer += vstrprintf(pszFormat, arg_ptr);\n            va_end(arg_ptr);\n\n            int line_start = 0, line_end;\n            while((line_end = buffer.find('\\n', line_start)) != -1)\n            {\n                OutputDebugStringA(buffer.substr(line_start, line_end - line_start).c_str());\n                line_start = line_end + 1;\n            }\n            buffer.erase(0, line_start);\n        }\n    }\n#endif\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  void refreshWallet()\n      {\n          OutputDebugStringF(\"refreshWallet\\n\");\n          cachedWallet.clear();\n          {\n              LOCK(wallet->cs_wallet);\n              for(std::map<uint256, CWalletTx>::iterator it = wallet->mapWallet.begin(); it != wallet->mapWallet.end(); ++it)\n              {\n                  if(TransactionRecord::showTransaction(it->second))\n                      cachedWallet.append(TransactionRecord::decomposeTransaction(wallet, it->second));\n              }\n          }\n      }\n}"
  },
  {
    "function_name": "TransactionTablePriv",
    "container": "TransactionTablePriv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
    "lines": "52-56",
    "snippet": "TransactionTablePriv(CWallet *wallet, TransactionTableModel *parent):\n            wallet(wallet),\n            parent(parent)\n    {\n    }",
    "includes": [
      "#include <QtAlgorithms>",
      "#include <QDateTime>",
      "#include <QIcon>",
      "#include <QTimer>",
      "#include <QColor>",
      "#include <QList>",
      "#include <QLocale>",
      "#include \"ui_interface.h\"",
      "#include \"wallet.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactiondesc.h\"",
      "#include \"guiconstants.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactiontablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  TransactionTablePriv(CWallet *wallet, TransactionTableModel *parent):\n              wallet(wallet),\n              parent(parent)\n      {\n      }\n}"
  }
]