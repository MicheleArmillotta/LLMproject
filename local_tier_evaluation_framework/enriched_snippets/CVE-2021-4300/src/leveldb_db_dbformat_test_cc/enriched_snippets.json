[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
    "lines": "110-112",
    "snippet": "int main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/dbformat.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "leveldb::test::RunAllTests",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "RunAllTests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "36-58",
          "snippet": "int RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nint main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
    "lines": "101-106",
    "snippet": "TEST(FormatTest, InternalKeyShortestSuccessor) {\n  ASSERT_EQ(IKey(\"g\", kMaxSequenceNumber, kValueTypeForSeek),\n            ShortSuccessor(IKey(\"foo\", 100, kTypeValue)));\n  ASSERT_EQ(IKey(\"\\xff\\xff\", 100, kTypeValue),\n            ShortSuccessor(IKey(\"\\xff\\xff\", 100, kTypeValue)));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/dbformat.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IKey(\"\\xff\\xff\", 100, kTypeValue)",
            "ShortSuccessor(IKey(\"\\xff\\xff\", 100, kTypeValue))"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ShortSuccessor",
          "args": [
            "IKey(\"\\xff\\xff\", 100, kTypeValue)"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "ShortSuccessor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
          "lines": "25-29",
          "snippet": "static std::string ShortSuccessor(const std::string& s) {\n  std::string result = s;\n  InternalKeyComparator(BytewiseComparator()).FindShortSuccessor(&result);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/dbformat.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nstatic std::string ShortSuccessor(const std::string& s) {\n  std::string result = s;\n  InternalKeyComparator(BytewiseComparator()).FindShortSuccessor(&result);\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IKey",
          "args": [
            "\"\\xff\\xff\"",
            "100",
            "kTypeValue"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "IKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
          "lines": "11-17",
          "snippet": "static std::string IKey(const std::string& user_key,\n                        uint64_t seq,\n                        ValueType vt) {\n  std::string encoded;\n  AppendInternalKey(&encoded, ParsedInternalKey(user_key, seq, vt));\n  return encoded;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/dbformat.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nstatic std::string IKey(const std::string& user_key,\n                        uint64_t seq,\n                        ValueType vt) {\n  std::string encoded;\n  AppendInternalKey(&encoded, ParsedInternalKey(user_key, seq, vt));\n  return encoded;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IKey(\"g\", kMaxSequenceNumber, kValueTypeForSeek)",
            "ShortSuccessor(IKey(\"foo\", 100, kTypeValue))"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nTEST(FormatTest, InternalKeyShortestSuccessor) {\n  ASSERT_EQ(IKey(\"g\", kMaxSequenceNumber, kValueTypeForSeek),\n            ShortSuccessor(IKey(\"foo\", 100, kTypeValue)));\n  ASSERT_EQ(IKey(\"\\xff\\xff\", 100, kTypeValue),\n            ShortSuccessor(IKey(\"\\xff\\xff\", 100, kTypeValue)));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
    "lines": "65-99",
    "snippet": "TEST(FormatTest, InternalKeyShortSeparator) {\n  // When user keys are same\n  ASSERT_EQ(IKey(\"foo\", 100, kTypeValue),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foo\", 99, kTypeValue)));\n  ASSERT_EQ(IKey(\"foo\", 100, kTypeValue),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foo\", 101, kTypeValue)));\n  ASSERT_EQ(IKey(\"foo\", 100, kTypeValue),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foo\", 100, kTypeValue)));\n  ASSERT_EQ(IKey(\"foo\", 100, kTypeValue),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foo\", 100, kTypeDeletion)));\n\n  // When user keys are misordered\n  ASSERT_EQ(IKey(\"foo\", 100, kTypeValue),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"bar\", 99, kTypeValue)));\n\n  // When user keys are different, but correctly ordered\n  ASSERT_EQ(IKey(\"g\", kMaxSequenceNumber, kValueTypeForSeek),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"hello\", 200, kTypeValue)));\n\n  // When start user key is prefix of limit user key\n  ASSERT_EQ(IKey(\"foo\", 100, kTypeValue),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foobar\", 200, kTypeValue)));\n\n  // When limit user key is prefix of start user key\n  ASSERT_EQ(IKey(\"foobar\", 100, kTypeValue),\n            Shorten(IKey(\"foobar\", 100, kTypeValue),\n                    IKey(\"foo\", 200, kTypeValue)));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/dbformat.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IKey(\"foobar\", 100, kTypeValue)",
            "Shorten(IKey(\"foobar\", 100, kTypeValue),\n                    IKey(\"foo\", 200, kTypeValue))"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Shorten",
          "args": [
            "IKey(\"foobar\", 100, kTypeValue)",
            "IKey(\"foo\", 200, kTypeValue)"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "Shorten",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
          "lines": "19-23",
          "snippet": "static std::string Shorten(const std::string& s, const std::string& l) {\n  std::string result = s;\n  InternalKeyComparator(BytewiseComparator()).FindShortestSeparator(&result, l);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/dbformat.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nstatic std::string Shorten(const std::string& s, const std::string& l) {\n  std::string result = s;\n  InternalKeyComparator(BytewiseComparator()).FindShortestSeparator(&result, l);\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IKey",
          "args": [
            "\"foo\"",
            "200",
            "kTypeValue"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "IKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
          "lines": "11-17",
          "snippet": "static std::string IKey(const std::string& user_key,\n                        uint64_t seq,\n                        ValueType vt) {\n  std::string encoded;\n  AppendInternalKey(&encoded, ParsedInternalKey(user_key, seq, vt));\n  return encoded;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/dbformat.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nstatic std::string IKey(const std::string& user_key,\n                        uint64_t seq,\n                        ValueType vt) {\n  std::string encoded;\n  AppendInternalKey(&encoded, ParsedInternalKey(user_key, seq, vt));\n  return encoded;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IKey(\"foo\", 100, kTypeValue)",
            "Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foobar\", 200, kTypeValue))"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IKey(\"g\", kMaxSequenceNumber, kValueTypeForSeek)",
            "Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"hello\", 200, kTypeValue))"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IKey(\"foo\", 100, kTypeValue)",
            "Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"bar\", 99, kTypeValue))"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IKey(\"foo\", 100, kTypeValue)",
            "Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foo\", 100, kTypeDeletion))"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IKey(\"foo\", 100, kTypeValue)",
            "Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foo\", 100, kTypeValue))"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IKey(\"foo\", 100, kTypeValue)",
            "Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foo\", 101, kTypeValue))"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IKey(\"foo\", 100, kTypeValue)",
            "Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foo\", 99, kTypeValue))"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nTEST(FormatTest, InternalKeyShortSeparator) {\n  // When user keys are same\n  ASSERT_EQ(IKey(\"foo\", 100, kTypeValue),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foo\", 99, kTypeValue)));\n  ASSERT_EQ(IKey(\"foo\", 100, kTypeValue),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foo\", 101, kTypeValue)));\n  ASSERT_EQ(IKey(\"foo\", 100, kTypeValue),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foo\", 100, kTypeValue)));\n  ASSERT_EQ(IKey(\"foo\", 100, kTypeValue),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foo\", 100, kTypeDeletion)));\n\n  // When user keys are misordered\n  ASSERT_EQ(IKey(\"foo\", 100, kTypeValue),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"bar\", 99, kTypeValue)));\n\n  // When user keys are different, but correctly ordered\n  ASSERT_EQ(IKey(\"g\", kMaxSequenceNumber, kValueTypeForSeek),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"hello\", 200, kTypeValue)));\n\n  // When start user key is prefix of limit user key\n  ASSERT_EQ(IKey(\"foo\", 100, kTypeValue),\n            Shorten(IKey(\"foo\", 100, kTypeValue),\n                    IKey(\"foobar\", 200, kTypeValue)));\n\n  // When limit user key is prefix of start user key\n  ASSERT_EQ(IKey(\"foobar\", 100, kTypeValue),\n            Shorten(IKey(\"foobar\", 100, kTypeValue),\n                    IKey(\"foo\", 200, kTypeValue)));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
    "lines": "49-63",
    "snippet": "TEST(FormatTest, InternalKey_EncodeDecode) {\n  const char* keys[] = { \"\", \"k\", \"hello\", \"longggggggggggggggggggggg\" };\n  const uint64_t seq[] = {\n    1, 2, 3,\n    (1ull << 8) - 1, 1ull << 8, (1ull << 8) + 1,\n    (1ull << 16) - 1, 1ull << 16, (1ull << 16) + 1,\n    (1ull << 32) - 1, 1ull << 32, (1ull << 32) + 1\n  };\n  for (int k = 0; k < sizeof(keys) / sizeof(keys[0]); k++) {\n    for (int s = 0; s < sizeof(seq) / sizeof(seq[0]); s++) {\n      TestKey(keys[k], seq[s], kTypeValue);\n      TestKey(\"hello\", 1, kTypeDeletion);\n    }\n  }\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/dbformat.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TestKey",
          "args": [
            "\"hello\"",
            "1",
            "kTypeDeletion"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "TestKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
          "lines": "31-45",
          "snippet": "static void TestKey(const std::string& key,\n                    uint64_t seq,\n                    ValueType vt) {\n  std::string encoded = IKey(key, seq, vt);\n\n  Slice in(encoded);\n  ParsedInternalKey decoded(\"\", 0, kTypeValue);\n\n  ASSERT_TRUE(ParseInternalKey(in, &decoded));\n  ASSERT_EQ(key, decoded.user_key.ToString());\n  ASSERT_EQ(seq, decoded.sequence);\n  ASSERT_EQ(vt, decoded.type);\n\n  ASSERT_TRUE(!ParseInternalKey(Slice(\"bar\"), &decoded));\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/dbformat.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nstatic void TestKey(const std::string& key,\n                    uint64_t seq,\n                    ValueType vt) {\n  std::string encoded = IKey(key, seq, vt);\n\n  Slice in(encoded);\n  ParsedInternalKey decoded(\"\", 0, kTypeValue);\n\n  ASSERT_TRUE(ParseInternalKey(in, &decoded));\n  ASSERT_EQ(key, decoded.user_key.ToString());\n  ASSERT_EQ(seq, decoded.sequence);\n  ASSERT_EQ(vt, decoded.type);\n\n  ASSERT_TRUE(!ParseInternalKey(Slice(\"bar\"), &decoded));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nTEST(FormatTest, InternalKey_EncodeDecode) {\n  const char* keys[] = { \"\", \"k\", \"hello\", \"longggggggggggggggggggggg\" };\n  const uint64_t seq[] = {\n    1, 2, 3,\n    (1ull << 8) - 1, 1ull << 8, (1ull << 8) + 1,\n    (1ull << 16) - 1, 1ull << 16, (1ull << 16) + 1,\n    (1ull << 32) - 1, 1ull << 32, (1ull << 32) + 1\n  };\n  for (int k = 0; k < sizeof(keys) / sizeof(keys[0]); k++) {\n    for (int s = 0; s < sizeof(seq) / sizeof(seq[0]); s++) {\n      TestKey(keys[k], seq[s], kTypeValue);\n      TestKey(\"hello\", 1, kTypeDeletion);\n    }\n  }\n}"
  },
  {
    "function_name": "TestKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
    "lines": "31-45",
    "snippet": "static void TestKey(const std::string& key,\n                    uint64_t seq,\n                    ValueType vt) {\n  std::string encoded = IKey(key, seq, vt);\n\n  Slice in(encoded);\n  ParsedInternalKey decoded(\"\", 0, kTypeValue);\n\n  ASSERT_TRUE(ParseInternalKey(in, &decoded));\n  ASSERT_EQ(key, decoded.user_key.ToString());\n  ASSERT_EQ(seq, decoded.sequence);\n  ASSERT_EQ(vt, decoded.type);\n\n  ASSERT_TRUE(!ParseInternalKey(Slice(\"bar\"), &decoded));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/dbformat.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!ParseInternalKey(Slice(\"bar\"), &decoded)"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ParseInternalKey",
          "args": [
            "Slice(\"bar\")",
            "&decoded"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "ParseInternalKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "176-186",
          "snippet": "inline bool ParseInternalKey(const Slice& internal_key,\n                             ParsedInternalKey* result) {\n  const size_t n = internal_key.size();\n  if (n < 8) return false;\n  uint64_t num = DecodeFixed64(internal_key.data() + n - 8);\n  unsigned char c = num & 0xff;\n  result->sequence = num >> 8;\n  result->type = static_cast<ValueType>(c);\n  result->user_key = Slice(internal_key.data(), n - 8);\n  return (c <= static_cast<unsigned char>(kTypeValue));\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\ninline bool ParseInternalKey(const Slice& internal_key,\n                             ParsedInternalKey* result) {\n  const size_t n = internal_key.size();\n  if (n < 8) return false;\n  uint64_t num = DecodeFixed64(internal_key.data() + n - 8);\n  unsigned char c = num & 0xff;\n  result->sequence = num >> 8;\n  result->type = static_cast<ValueType>(c);\n  result->user_key = Slice(internal_key.data(), n - 8);\n  return (c <= static_cast<unsigned char>(kTypeValue));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "\"bar\""
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/memtable.cc",
          "lines": "14-19",
          "snippet": "static Slice GetLengthPrefixedSlice(const char* data) {\n  uint32_t len;\n  const char* p = data;\n  p = GetVarint32Ptr(p, p + 5, &len);  // +5: we assume \"p\" is not corrupted\n  return Slice(p, len);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/memtable.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/comparator.h\"\n#include \"db/dbformat.h\"\n#include \"db/memtable.h\"\n\nstatic Slice GetLengthPrefixedSlice(const char* data) {\n  uint32_t len;\n  const char* p = data;\n  p = GetVarint32Ptr(p, p + 5, &len);  // +5: we assume \"p\" is not corrupted\n  return Slice(p, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "vt",
            "decoded.type"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "seq",
            "decoded.sequence"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "key",
            "decoded.user_key.ToString()"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decoded.user_key.ToString",
          "args": [],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "ParseInternalKey(in, &decoded)"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IKey",
          "args": [
            "key",
            "seq",
            "vt"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "IKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
          "lines": "11-17",
          "snippet": "static std::string IKey(const std::string& user_key,\n                        uint64_t seq,\n                        ValueType vt) {\n  std::string encoded;\n  AppendInternalKey(&encoded, ParsedInternalKey(user_key, seq, vt));\n  return encoded;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/dbformat.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nstatic std::string IKey(const std::string& user_key,\n                        uint64_t seq,\n                        ValueType vt) {\n  std::string encoded;\n  AppendInternalKey(&encoded, ParsedInternalKey(user_key, seq, vt));\n  return encoded;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nstatic void TestKey(const std::string& key,\n                    uint64_t seq,\n                    ValueType vt) {\n  std::string encoded = IKey(key, seq, vt);\n\n  Slice in(encoded);\n  ParsedInternalKey decoded(\"\", 0, kTypeValue);\n\n  ASSERT_TRUE(ParseInternalKey(in, &decoded));\n  ASSERT_EQ(key, decoded.user_key.ToString());\n  ASSERT_EQ(seq, decoded.sequence);\n  ASSERT_EQ(vt, decoded.type);\n\n  ASSERT_TRUE(!ParseInternalKey(Slice(\"bar\"), &decoded));\n}"
  },
  {
    "function_name": "ShortSuccessor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
    "lines": "25-29",
    "snippet": "static std::string ShortSuccessor(const std::string& s) {\n  std::string result = s;\n  InternalKeyComparator(BytewiseComparator()).FindShortSuccessor(&result);\n  return result;\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/dbformat.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "InternalKeyComparator",
          "args": [
            "&result"
          ],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "InternalKeyComparator",
          "container": "InternalKeyComparator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "117-117",
          "snippet": "explicit InternalKeyComparator(const Comparator* c) : user_comparator_(c) { }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\nInternalKeyComparator {\n  explicit InternalKeyComparator(const Comparator* c) : user_comparator_(c) { }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "BytewiseComparatorImpl",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "19-19",
          "snippet": "BytewiseComparatorImpl() { }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  BytewiseComparatorImpl() { }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nstatic std::string ShortSuccessor(const std::string& s) {\n  std::string result = s;\n  InternalKeyComparator(BytewiseComparator()).FindShortSuccessor(&result);\n  return result;\n}"
  },
  {
    "function_name": "Shorten",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
    "lines": "19-23",
    "snippet": "static std::string Shorten(const std::string& s, const std::string& l) {\n  std::string result = s;\n  InternalKeyComparator(BytewiseComparator()).FindShortestSeparator(&result, l);\n  return result;\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/dbformat.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "InternalKeyComparator",
          "args": [
            "&result",
            "l"
          ],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "Compare",
          "container": "InternalKeyComparator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "171-174",
          "snippet": "inline int InternalKeyComparator::Compare(\n    const InternalKey& a, const InternalKey& b) const {\n  return Compare(a.Encode(), b.Encode());\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\nInternalKeyComparator {\n  inline int InternalKeyComparator::Compare(\n      const InternalKey& a, const InternalKey& b) const {\n    return Compare(a.Encode(), b.Encode());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "InternalKeyComparator",
          "args": [
            "BytewiseComparator()"
          ],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "InternalKeyComparator",
          "container": "InternalKeyComparator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "117-117",
          "snippet": "explicit InternalKeyComparator(const Comparator* c) : user_comparator_(c) { }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\nInternalKeyComparator {\n  explicit InternalKeyComparator(const Comparator* c) : user_comparator_(c) { }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "BytewiseComparatorImpl",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "19-19",
          "snippet": "BytewiseComparatorImpl() { }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  BytewiseComparatorImpl() { }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nstatic std::string Shorten(const std::string& s, const std::string& l) {\n  std::string result = s;\n  InternalKeyComparator(BytewiseComparator()).FindShortestSeparator(&result, l);\n  return result;\n}"
  },
  {
    "function_name": "IKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat_test.cc",
    "lines": "11-17",
    "snippet": "static std::string IKey(const std::string& user_key,\n                        uint64_t seq,\n                        ValueType vt) {\n  std::string encoded;\n  AppendInternalKey(&encoded, ParsedInternalKey(user_key, seq, vt));\n  return encoded;\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/dbformat.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AppendInternalKey",
          "args": [
            "&encoded",
            "ParsedInternalKey(user_key, seq, vt)"
          ],
          "line": 15
        },
        "resolved": true,
        "details": {
          "function_name": "AppendInternalKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "18-21",
          "snippet": "void AppendInternalKey(std::string* result, const ParsedInternalKey& key) {\n  result->append(key.user_key.data(), key.user_key.size());\n  PutFixed64(result, PackSequenceAndType(key.sequence, key.type));\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"port/port.h\"",
            "#include \"db/dbformat.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nvoid AppendInternalKey(std::string* result, const ParsedInternalKey& key) {\n  result->append(key.user_key.data(), key.user_key.size());\n  PutFixed64(result, PackSequenceAndType(key.sequence, key.type));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ParsedInternalKey",
          "args": [
            "user_key",
            "seq",
            "vt"
          ],
          "line": 15
        },
        "resolved": true,
        "details": {
          "function_name": "ParsedInternalKey",
          "container": "ParsedInternalKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "76-77",
          "snippet": "ParsedInternalKey(const Slice& u, const SequenceNumber& seq, ValueType t)\n      : user_key(u), sequence(seq), type(t) { }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\nParsedInternalKey {\n  ParsedInternalKey(const Slice& u, const SequenceNumber& seq, ValueType t)\n        : user_key(u), sequence(seq), type(t) { }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/dbformat.h\"\n\nstatic std::string IKey(const std::string& user_key,\n                        uint64_t seq,\n                        ValueType vt) {\n  std::string encoded;\n  AppendInternalKey(&encoded, ParsedInternalKey(user_key, seq, vt));\n  return encoded;\n}"
  }
]