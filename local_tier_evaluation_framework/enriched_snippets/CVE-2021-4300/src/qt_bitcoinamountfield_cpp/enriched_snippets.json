[
  {
    "function_name": "setDisplayUnit",
    "container": "BitcoinAmountField",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
    "lines": "165-168",
    "snippet": "void BitcoinAmountField::setDisplayUnit(int newUnit)\n{\n    unit->setValue(newUnit);\n}",
    "includes": [
      "#include <qmath.h>",
      "#include <QApplication>",
      "#include <QComboBox>",
      "#include <QDoubleSpinBox>",
      "#include <QKeyEvent>",
      "#include <QHBoxLayout>",
      "#include <QRegExpValidator>",
      "#include <QLineEdit>",
      "#include <QLabel>",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"qvaluecombobox.h\"",
      "#include \"bitcoinamountfield.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unit->setValue",
          "args": [
            "newUnit"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "129-132",
          "snippet": "void BitcoinAmountField::setValue(qint64 value)\n{\n    setText(BitcoinUnits::format(currentUnit, value));\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setValue(qint64 value)\n  {\n      setText(BitcoinUnits::format(currentUnit, value));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setDisplayUnit(int newUnit)\n  {\n      unit->setValue(newUnit);\n  }\n}"
  },
  {
    "function_name": "unitChanged",
    "container": "BitcoinAmountField",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
    "lines": "134-163",
    "snippet": "void BitcoinAmountField::unitChanged(int idx)\n{\n    // Use description tooltip for current unit for the combobox\n    unit->setToolTip(unit->itemData(idx, Qt::ToolTipRole).toString());\n\n    // Determine new unit ID\n    int newUnit = unit->itemData(idx, BitcoinUnits::UnitRole).toInt();\n\n    // Parse current value and convert to new unit\n    bool valid = false;\n    qint64 currentValue = value(&valid);\n\n    currentUnit = newUnit;\n\n    // Set max length after retrieving the value, to prevent truncation\n    amount->setDecimals(BitcoinUnits::decimals(currentUnit));\n    amount->setMaximum(qPow(10, BitcoinUnits::amountDigits(currentUnit)) - qPow(10, -amount->decimals()));\n\n    if(valid)\n    {\n        // If value was valid, re-place it in the widget with the new unit\n        setValue(currentValue);\n    }\n    else\n    {\n        // If current value is invalid, just clear field\n        setText(\"\");\n    }\n    setValid(true);\n}",
    "includes": [
      "#include <qmath.h>",
      "#include <QApplication>",
      "#include <QComboBox>",
      "#include <QDoubleSpinBox>",
      "#include <QKeyEvent>",
      "#include <QHBoxLayout>",
      "#include <QRegExpValidator>",
      "#include <QLineEdit>",
      "#include <QLabel>",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"qvaluecombobox.h\"",
      "#include \"bitcoinamountfield.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setValid",
          "args": [
            "true"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "setValid",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "75-81",
          "snippet": "void BitcoinAmountField::setValid(bool valid)\n{\n    if (valid)\n        amount->setStyleSheet(\"\");\n    else\n        amount->setStyleSheet(STYLE_INVALID);\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setValid(bool valid)\n  {\n      if (valid)\n          amount->setStyleSheet(\"\");\n      else\n          amount->setStyleSheet(STYLE_INVALID);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setText",
          "args": [
            "\"\""
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setValue",
          "args": [
            "currentValue"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "129-132",
          "snippet": "void BitcoinAmountField::setValue(qint64 value)\n{\n    setText(BitcoinUnits::format(currentUnit, value));\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setValue(qint64 value)\n  {\n      setText(BitcoinUnits::format(currentUnit, value));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "amount->setMaximum",
          "args": [
            "qPow(10, BitcoinUnits::amountDigits(currentUnit)) - qPow(10, -amount->decimals())"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qPow",
          "args": [
            "10",
            "-amount->decimals()"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amount->decimals",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qPow",
          "args": [
            "10",
            "BitcoinUnits::amountDigits(currentUnit)"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::amountDigits",
          "args": [
            "currentUnit"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amount->setDecimals",
          "args": [
            "BitcoinUnits::decimals(currentUnit)"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::decimals",
          "args": [
            "currentUnit"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value",
          "args": [
            "&valid"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "118-127",
          "snippet": "qint64 BitcoinAmountField::value(bool *valid_out) const\n{\n    qint64 val_out = 0;\n    bool valid = BitcoinUnits::parse(currentUnit, text(), &val_out);\n    if(valid_out)\n    {\n        *valid_out = valid;\n    }\n    return val_out;\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  qint64 BitcoinAmountField::value(bool *valid_out) const\n  {\n      qint64 val_out = 0;\n      bool valid = BitcoinUnits::parse(currentUnit, text(), &val_out);\n      if(valid_out)\n      {\n          *valid_out = valid;\n      }\n      return val_out;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "unit->itemData",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unit->itemData",
          "args": [
            "idx",
            "BitcoinUnits::UnitRole"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unit->setToolTip",
          "args": [
            "unit->itemData(idx, Qt::ToolTipRole).toString()"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unit->itemData",
          "args": [],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unit->itemData",
          "args": [
            "idx",
            "Qt::ToolTipRole"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::unitChanged(int idx)\n  {\n      // Use description tooltip for current unit for the combobox\n      unit->setToolTip(unit->itemData(idx, Qt::ToolTipRole).toString());\n  \n      // Determine new unit ID\n      int newUnit = unit->itemData(idx, BitcoinUnits::UnitRole).toInt();\n  \n      // Parse current value and convert to new unit\n      bool valid = false;\n      qint64 currentValue = value(&valid);\n  \n      currentUnit = newUnit;\n  \n      // Set max length after retrieving the value, to prevent truncation\n      amount->setDecimals(BitcoinUnits::decimals(currentUnit));\n      amount->setMaximum(qPow(10, BitcoinUnits::amountDigits(currentUnit)) - qPow(10, -amount->decimals()));\n  \n      if(valid)\n      {\n          // If value was valid, re-place it in the widget with the new unit\n          setValue(currentValue);\n      }\n      else\n      {\n          // If current value is invalid, just clear field\n          setText(\"\");\n      }\n      setValid(true);\n  }\n}"
  },
  {
    "function_name": "setValue",
    "container": "BitcoinAmountField",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
    "lines": "129-132",
    "snippet": "void BitcoinAmountField::setValue(qint64 value)\n{\n    setText(BitcoinUnits::format(currentUnit, value));\n}",
    "includes": [
      "#include <qmath.h>",
      "#include <QApplication>",
      "#include <QComboBox>",
      "#include <QDoubleSpinBox>",
      "#include <QKeyEvent>",
      "#include <QHBoxLayout>",
      "#include <QRegExpValidator>",
      "#include <QLineEdit>",
      "#include <QLabel>",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"qvaluecombobox.h\"",
      "#include \"bitcoinamountfield.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setText",
          "args": [
            "BitcoinUnits::format(currentUnit, value)"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::format",
          "args": [
            "currentUnit",
            "value"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setValue(qint64 value)\n  {\n      setText(BitcoinUnits::format(currentUnit, value));\n  }\n}"
  },
  {
    "function_name": "value",
    "container": "BitcoinAmountField",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
    "lines": "118-127",
    "snippet": "qint64 BitcoinAmountField::value(bool *valid_out) const\n{\n    qint64 val_out = 0;\n    bool valid = BitcoinUnits::parse(currentUnit, text(), &val_out);\n    if(valid_out)\n    {\n        *valid_out = valid;\n    }\n    return val_out;\n}",
    "includes": [
      "#include <qmath.h>",
      "#include <QApplication>",
      "#include <QComboBox>",
      "#include <QDoubleSpinBox>",
      "#include <QKeyEvent>",
      "#include <QHBoxLayout>",
      "#include <QRegExpValidator>",
      "#include <QLineEdit>",
      "#include <QLabel>",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"qvaluecombobox.h\"",
      "#include \"bitcoinamountfield.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BitcoinUnits::parse",
          "args": [
            "currentUnit",
            "text()",
            "&val_out"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text",
          "args": [],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  qint64 BitcoinAmountField::value(bool *valid_out) const\n  {\n      qint64 val_out = 0;\n      bool valid = BitcoinUnits::parse(currentUnit, text(), &val_out);\n      if(valid_out)\n      {\n          *valid_out = valid;\n      }\n      return val_out;\n  }\n}"
  },
  {
    "function_name": "eventFilter",
    "container": "BitcoinAmountField",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
    "lines": "91-110",
    "snippet": "bool BitcoinAmountField::eventFilter(QObject *object, QEvent *event)\n{\n    if (event->type() == QEvent::FocusIn)\n    {\n        // Clear invalid flag on focus\n        setValid(true);\n    }\n    else if (event->type() == QEvent::KeyPress || event->type() == QEvent::KeyRelease)\n    {\n        QKeyEvent *keyEvent = static_cast<QKeyEvent *>(event);\n        if (keyEvent->key() == Qt::Key_Comma)\n        {\n            // Translate a comma into a period\n            QKeyEvent periodKeyEvent(event->type(), Qt::Key_Period, keyEvent->modifiers(), \".\", keyEvent->isAutoRepeat(), keyEvent->count());\n            qApp->sendEvent(object, &periodKeyEvent);\n            return true;\n        }\n    }\n    return QWidget::eventFilter(object, event);\n}",
    "includes": [
      "#include <qmath.h>",
      "#include <QApplication>",
      "#include <QComboBox>",
      "#include <QDoubleSpinBox>",
      "#include <QKeyEvent>",
      "#include <QHBoxLayout>",
      "#include <QRegExpValidator>",
      "#include <QLineEdit>",
      "#include <QLabel>",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"qvaluecombobox.h\"",
      "#include \"bitcoinamountfield.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QWidget::eventFilter",
          "args": [
            "object",
            "event"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "eventFilter",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "91-110",
          "snippet": "bool BitcoinAmountField::eventFilter(QObject *object, QEvent *event)\n{\n    if (event->type() == QEvent::FocusIn)\n    {\n        // Clear invalid flag on focus\n        setValid(true);\n    }\n    else if (event->type() == QEvent::KeyPress || event->type() == QEvent::KeyRelease)\n    {\n        QKeyEvent *keyEvent = static_cast<QKeyEvent *>(event);\n        if (keyEvent->key() == Qt::Key_Comma)\n        {\n            // Translate a comma into a period\n            QKeyEvent periodKeyEvent(event->type(), Qt::Key_Period, keyEvent->modifiers(), \".\", keyEvent->isAutoRepeat(), keyEvent->count());\n            qApp->sendEvent(object, &periodKeyEvent);\n            return true;\n        }\n    }\n    return QWidget::eventFilter(object, event);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "qApp->sendEvent",
          "args": [
            "object",
            "&periodKeyEvent"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keyEvent->count",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keyEvent->isAutoRepeat",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keyEvent->modifiers",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "event->type",
          "args": [],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "keyEvent->key",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "LRUHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "37-45",
          "snippet": "Slice key() const {\n    // For cheaper lookups, we allow a temporary Handle object\n    // to store a pointer to a key in \"value\".\n    if (next == this) {\n      return *(reinterpret_cast<Slice*>(value));\n    } else {\n      return Slice(key_data, key_length);\n    }\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nLRUHandle {\n  Slice key() const {\n      // For cheaper lookups, we allow a temporary Handle object\n      // to store a pointer to a key in \"value\".\n      if (next == this) {\n        return *(reinterpret_cast<Slice*>(value));\n      } else {\n        return Slice(key_data, key_length);\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<QKeyEvent *>",
          "args": [
            "event"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setValid",
          "args": [
            "true"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "setValid",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "75-81",
          "snippet": "void BitcoinAmountField::setValid(bool valid)\n{\n    if (valid)\n        amount->setStyleSheet(\"\");\n    else\n        amount->setStyleSheet(STYLE_INVALID);\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setValid(bool valid)\n  {\n      if (valid)\n          amount->setStyleSheet(\"\");\n      else\n          amount->setStyleSheet(STYLE_INVALID);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  bool BitcoinAmountField::eventFilter(QObject *object, QEvent *event)\n  {\n      if (event->type() == QEvent::FocusIn)\n      {\n          // Clear invalid flag on focus\n          setValid(true);\n      }\n      else if (event->type() == QEvent::KeyPress || event->type() == QEvent::KeyRelease)\n      {\n          QKeyEvent *keyEvent = static_cast<QKeyEvent *>(event);\n          if (keyEvent->key() == Qt::Key_Comma)\n          {\n              // Translate a comma into a period\n              QKeyEvent periodKeyEvent(event->type(), Qt::Key_Period, keyEvent->modifiers(), \".\", keyEvent->isAutoRepeat(), keyEvent->count());\n              qApp->sendEvent(object, &periodKeyEvent);\n              return true;\n          }\n      }\n      return QWidget::eventFilter(object, event);\n  }\n}"
  },
  {
    "function_name": "text",
    "container": "BitcoinAmountField",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
    "lines": "83-89",
    "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
    "includes": [
      "#include <qmath.h>",
      "#include <QApplication>",
      "#include <QComboBox>",
      "#include <QDoubleSpinBox>",
      "#include <QKeyEvent>",
      "#include <QHBoxLayout>",
      "#include <QRegExpValidator>",
      "#include <QLineEdit>",
      "#include <QLabel>",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"qvaluecombobox.h\"",
      "#include \"bitcoinamountfield.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "amount->text",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
  },
  {
    "function_name": "setValid",
    "container": "BitcoinAmountField",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
    "lines": "75-81",
    "snippet": "void BitcoinAmountField::setValid(bool valid)\n{\n    if (valid)\n        amount->setStyleSheet(\"\");\n    else\n        amount->setStyleSheet(STYLE_INVALID);\n}",
    "includes": [
      "#include <qmath.h>",
      "#include <QApplication>",
      "#include <QComboBox>",
      "#include <QDoubleSpinBox>",
      "#include <QKeyEvent>",
      "#include <QHBoxLayout>",
      "#include <QRegExpValidator>",
      "#include <QLineEdit>",
      "#include <QLabel>",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"qvaluecombobox.h\"",
      "#include \"bitcoinamountfield.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "amount->setStyleSheet",
          "args": [
            "STYLE_INVALID"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amount->setStyleSheet",
          "args": [
            "\"\""
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setValid(bool valid)\n  {\n      if (valid)\n          amount->setStyleSheet(\"\");\n      else\n          amount->setStyleSheet(STYLE_INVALID);\n  }\n}"
  },
  {
    "function_name": "validate",
    "container": "BitcoinAmountField",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
    "lines": "62-73",
    "snippet": "bool BitcoinAmountField::validate()\n{\n    bool valid = true;\n    if (amount->value() == 0.0)\n        valid = false;\n    if (valid && !BitcoinUnits::parse(currentUnit, text(), 0))\n        valid = false;\n\n    setValid(valid);\n\n    return valid;\n}",
    "includes": [
      "#include <qmath.h>",
      "#include <QApplication>",
      "#include <QComboBox>",
      "#include <QDoubleSpinBox>",
      "#include <QKeyEvent>",
      "#include <QHBoxLayout>",
      "#include <QRegExpValidator>",
      "#include <QLineEdit>",
      "#include <QLabel>",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"qvaluecombobox.h\"",
      "#include \"bitcoinamountfield.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setValid",
          "args": [
            "valid"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "setValid",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "75-81",
          "snippet": "void BitcoinAmountField::setValid(bool valid)\n{\n    if (valid)\n        amount->setStyleSheet(\"\");\n    else\n        amount->setStyleSheet(STYLE_INVALID);\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setValid(bool valid)\n  {\n      if (valid)\n          amount->setStyleSheet(\"\");\n      else\n          amount->setStyleSheet(STYLE_INVALID);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::parse",
          "args": [
            "currentUnit",
            "text()",
            "0"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text",
          "args": [],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "amount->value",
          "args": [],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QValueComboBox",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qvaluecombobox.cpp",
          "lines": "9-12",
          "snippet": "QVariant QValueComboBox::value() const\n{\n    return itemData(currentIndex(), role);\n}",
          "includes": [
            "#include \"qvaluecombobox.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qvaluecombobox.h\"\n\nQValueComboBox {\n  QVariant QValueComboBox::value() const\n  {\n      return itemData(currentIndex(), role);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  bool BitcoinAmountField::validate()\n  {\n      bool valid = true;\n      if (amount->value() == 0.0)\n          valid = false;\n      if (valid && !BitcoinUnits::parse(currentUnit, text(), 0))\n          valid = false;\n  \n      setValid(valid);\n  \n      return valid;\n  }\n}"
  },
  {
    "function_name": "clear",
    "container": "BitcoinAmountField",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
    "lines": "56-60",
    "snippet": "void BitcoinAmountField::clear()\n{\n    amount->clear();\n    unit->setCurrentIndex(0);\n}",
    "includes": [
      "#include <qmath.h>",
      "#include <QApplication>",
      "#include <QComboBox>",
      "#include <QDoubleSpinBox>",
      "#include <QKeyEvent>",
      "#include <QHBoxLayout>",
      "#include <QRegExpValidator>",
      "#include <QLineEdit>",
      "#include <QLabel>",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"qvaluecombobox.h\"",
      "#include \"bitcoinamountfield.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unit->setCurrentIndex",
          "args": [
            "0"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amount->clear",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "56-60",
          "snippet": "void BitcoinAmountField::clear()\n{\n    amount->clear();\n    unit->setCurrentIndex(0);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::clear()\n  {\n      amount->clear();\n      unit->setCurrentIndex(0);\n  }\n}"
  },
  {
    "function_name": "setText",
    "container": "BitcoinAmountField",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
    "lines": "48-54",
    "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
    "includes": [
      "#include <qmath.h>",
      "#include <QApplication>",
      "#include <QComboBox>",
      "#include <QDoubleSpinBox>",
      "#include <QKeyEvent>",
      "#include <QHBoxLayout>",
      "#include <QRegExpValidator>",
      "#include <QLineEdit>",
      "#include <QLabel>",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"qvaluecombobox.h\"",
      "#include \"bitcoinamountfield.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "amount->setValue",
          "args": [
            "text.toDouble()"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "129-132",
          "snippet": "void BitcoinAmountField::setValue(qint64 value)\n{\n    setText(BitcoinUnits::format(currentUnit, value));\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setValue(qint64 value)\n  {\n      setText(BitcoinUnits::format(currentUnit, value));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "text.toDouble",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amount->clear",
          "args": [],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "56-60",
          "snippet": "void BitcoinAmountField::clear()\n{\n    amount->clear();\n    unit->setCurrentIndex(0);\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::clear()\n  {\n      amount->clear();\n      unit->setCurrentIndex(0);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "text.isEmpty",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
  },
  {
    "function_name": "BitcoinAmountField",
    "container": "BitcoinAmountField",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
    "lines": "17-46",
    "snippet": "BitcoinAmountField::BitcoinAmountField(QWidget *parent):\n        QWidget(parent), amount(0), currentUnit(-1)\n{\n    amount = new QDoubleSpinBox(this);\n    amount->setLocale(QLocale::c());\n    amount->setDecimals(8);\n    amount->installEventFilter(this);\n    amount->setMaximumWidth(170);\n    amount->setSingleStep(0.001);\n\n    QHBoxLayout *layout = new QHBoxLayout(this);\n    layout->addWidget(amount);\n    unit = new QValueComboBox(this);\n    unit->setModel(new BitcoinUnits(this));\n    layout->addWidget(unit);\n    layout->addStretch(1);\n    layout->setContentsMargins(0,0,0,0);\n\n    setLayout(layout);\n\n    setFocusPolicy(Qt::TabFocus);\n    setFocusProxy(amount);\n\n    // If one if the widgets changes, the combined content changes as well\n    connect(amount, SIGNAL(valueChanged(QString)), this, SIGNAL(textChanged()));\n    connect(unit, SIGNAL(currentIndexChanged(int)), this, SLOT(unitChanged(int)));\n\n    // Set default based on configuration\n    unitChanged(unit->currentIndex());\n}",
    "includes": [
      "#include <qmath.h>",
      "#include <QApplication>",
      "#include <QComboBox>",
      "#include <QDoubleSpinBox>",
      "#include <QKeyEvent>",
      "#include <QHBoxLayout>",
      "#include <QRegExpValidator>",
      "#include <QLineEdit>",
      "#include <QLabel>",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"qvaluecombobox.h\"",
      "#include \"bitcoinamountfield.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unitChanged",
          "args": [
            "unit->currentIndex()"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "unitChanged",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "134-163",
          "snippet": "void BitcoinAmountField::unitChanged(int idx)\n{\n    // Use description tooltip for current unit for the combobox\n    unit->setToolTip(unit->itemData(idx, Qt::ToolTipRole).toString());\n\n    // Determine new unit ID\n    int newUnit = unit->itemData(idx, BitcoinUnits::UnitRole).toInt();\n\n    // Parse current value and convert to new unit\n    bool valid = false;\n    qint64 currentValue = value(&valid);\n\n    currentUnit = newUnit;\n\n    // Set max length after retrieving the value, to prevent truncation\n    amount->setDecimals(BitcoinUnits::decimals(currentUnit));\n    amount->setMaximum(qPow(10, BitcoinUnits::amountDigits(currentUnit)) - qPow(10, -amount->decimals()));\n\n    if(valid)\n    {\n        // If value was valid, re-place it in the widget with the new unit\n        setValue(currentValue);\n    }\n    else\n    {\n        // If current value is invalid, just clear field\n        setText(\"\");\n    }\n    setValid(true);\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::unitChanged(int idx)\n  {\n      // Use description tooltip for current unit for the combobox\n      unit->setToolTip(unit->itemData(idx, Qt::ToolTipRole).toString());\n  \n      // Determine new unit ID\n      int newUnit = unit->itemData(idx, BitcoinUnits::UnitRole).toInt();\n  \n      // Parse current value and convert to new unit\n      bool valid = false;\n      qint64 currentValue = value(&valid);\n  \n      currentUnit = newUnit;\n  \n      // Set max length after retrieving the value, to prevent truncation\n      amount->setDecimals(BitcoinUnits::decimals(currentUnit));\n      amount->setMaximum(qPow(10, BitcoinUnits::amountDigits(currentUnit)) - qPow(10, -amount->decimals()));\n  \n      if(valid)\n      {\n          // If value was valid, re-place it in the widget with the new unit\n          setValue(currentValue);\n      }\n      else\n      {\n          // If current value is invalid, just clear field\n          setText(\"\");\n      }\n      setValid(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "unit->currentIndex",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "amount",
            "SIGNAL(valueChanged(QString))",
            "this",
            "SIGNAL(textChanged())"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "textChanged()"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "textChanged",
          "args": [],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "on_lnMessage_textChanged",
          "container": "QRCodeDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
          "lines": "143-146",
          "snippet": "void QRCodeDialog::on_lnMessage_textChanged()\n{\n    genCode();\n}",
          "includes": [
            "#include <qrencode.h>",
            "#include <QUrl>",
            "#include <QPixmap>",
            "#include \"optionsmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_qrcodedialog.h\"",
            "#include \"qrcodedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::on_lnMessage_textChanged()\n  {\n      genCode();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "valueChanged(QString)"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "valueChanged",
          "args": [
            "QString"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setFocusProxy",
          "args": [
            "amount"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setFocusPolicy",
          "args": [
            "Qt::TabFocus"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setLayout",
          "args": [
            "layout"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layout->setContentsMargins",
          "args": [
            "0",
            "0",
            "0",
            "0"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layout->addStretch",
          "args": [
            "1"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layout->addWidget",
          "args": [
            "unit"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unit->setModel",
          "args": [
            "new BitcoinUnits(this)"
          ],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "107-148",
          "snippet": "void AddressBookPage::setModel(AddressTableModel *model)\n{\n    this->model = model;\n    if(!model)\n        return;\n\n    proxyModel = new QSortFilterProxyModel(this);\n    proxyModel->setSourceModel(model);\n    proxyModel->setDynamicSortFilter(true);\n    proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n    proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n    switch(tab)\n    {\n    case ReceivingTab:\n        // Receive filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Receive);\n        break;\n    case SendingTab:\n        // Send filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Send);\n        break;\n    }\n    ui->tableView->setModel(proxyModel);\n    ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n\n    // Set column widths\n    ui->tableView->horizontalHeader()->resizeSection(\n            AddressTableModel::Address, 320);\n    ui->tableView->horizontalHeader()->setResizeMode(\n            AddressTableModel::Label, QHeaderView::Stretch);\n\n    connect(ui->tableView->selectionModel(), SIGNAL(selectionChanged(QItemSelection,QItemSelection)),\n            this, SLOT(selectionChanged()));\n\n    // Select row for newly created address\n    connect(model, SIGNAL(rowsInserted(QModelIndex,int,int)),\n            this, SLOT(selectNewAddress(QModelIndex,int,int)));\n\n    selectionChanged();\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::setModel(AddressTableModel *model)\n  {\n      this->model = model;\n      if(!model)\n          return;\n  \n      proxyModel = new QSortFilterProxyModel(this);\n      proxyModel->setSourceModel(model);\n      proxyModel->setDynamicSortFilter(true);\n      proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n      proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n      switch(tab)\n      {\n      case ReceivingTab:\n          // Receive filter\n          proxyModel->setFilterRole(AddressTableModel::TypeRole);\n          proxyModel->setFilterFixedString(AddressTableModel::Receive);\n          break;\n      case SendingTab:\n          // Send filter\n          proxyModel->setFilterRole(AddressTableModel::TypeRole);\n          proxyModel->setFilterFixedString(AddressTableModel::Send);\n          break;\n      }\n      ui->tableView->setModel(proxyModel);\n      ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n  \n      // Set column widths\n      ui->tableView->horizontalHeader()->resizeSection(\n              AddressTableModel::Address, 320);\n      ui->tableView->horizontalHeader()->setResizeMode(\n              AddressTableModel::Label, QHeaderView::Stretch);\n  \n      connect(ui->tableView->selectionModel(), SIGNAL(selectionChanged(QItemSelection,QItemSelection)),\n              this, SLOT(selectionChanged()));\n  \n      // Select row for newly created address\n      connect(model, SIGNAL(rowsInserted(QModelIndex,int,int)),\n              this, SLOT(selectNewAddress(QModelIndex,int,int)));\n  \n      selectionChanged();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "layout->addWidget",
          "args": [
            "amount"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amount->setSingleStep",
          "args": [
            "0.001"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amount->setMaximumWidth",
          "args": [
            "170"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amount->installEventFilter",
          "args": [
            "this"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amount->setDecimals",
          "args": [
            "8"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amount->setLocale",
          "args": [
            "QLocale::c()"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLocale::c",
          "args": [],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  BitcoinAmountField::BitcoinAmountField(QWidget *parent):\n          QWidget(parent), amount(0), currentUnit(-1)\n  {\n      amount = new QDoubleSpinBox(this);\n      amount->setLocale(QLocale::c());\n      amount->setDecimals(8);\n      amount->installEventFilter(this);\n      amount->setMaximumWidth(170);\n      amount->setSingleStep(0.001);\n  \n      QHBoxLayout *layout = new QHBoxLayout(this);\n      layout->addWidget(amount);\n      unit = new QValueComboBox(this);\n      unit->setModel(new BitcoinUnits(this));\n      layout->addWidget(unit);\n      layout->addStretch(1);\n      layout->setContentsMargins(0,0,0,0);\n  \n      setLayout(layout);\n  \n      setFocusPolicy(Qt::TabFocus);\n      setFocusProxy(amount);\n  \n      // If one if the widgets changes, the combined content changes as well\n      connect(amount, SIGNAL(valueChanged(QString)), this, SIGNAL(textChanged()));\n      connect(unit, SIGNAL(currentIndexChanged(int)), this, SLOT(unitChanged(int)));\n  \n      // Set default based on configuration\n      unitChanged(unit->currentIndex());\n  }\n}"
  }
]