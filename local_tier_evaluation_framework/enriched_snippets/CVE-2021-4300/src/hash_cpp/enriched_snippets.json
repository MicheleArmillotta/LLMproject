[
  {
    "function_name": "MurmurHash3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/hash.cpp",
    "lines": "8-58",
    "snippet": "unsigned int MurmurHash3(unsigned int nHashSeed, const std::vector<unsigned char>& vDataToHash)\n{\n    // The following is MurmurHash3 (x86_32), see http://code.google.com/p/smhasher/source/browse/trunk/MurmurHash3.cpp\n    uint32_t h1 = nHashSeed;\n    const uint32_t c1 = 0xcc9e2d51;\n    const uint32_t c2 = 0x1b873593;\n\n    const int nblocks = vDataToHash.size() / 4;\n\n    //----------\n    // body\n    const uint32_t * blocks = (const uint32_t *)(&vDataToHash[0] + nblocks*4);\n\n    for(int i = -nblocks; i; i++)\n    {\n        uint32_t k1 = blocks[i];\n\n        k1 *= c1;\n        k1 = ROTL32(k1,15);\n        k1 *= c2;\n\n        h1 ^= k1;\n        h1 = ROTL32(h1,13); \n        h1 = h1*5+0xe6546b64;\n    }\n\n    //----------\n    // tail\n    const uint8_t * tail = (const uint8_t*)(&vDataToHash[0] + nblocks*4);\n\n    uint32_t k1 = 0;\n\n    switch(vDataToHash.size() & 3)\n    {\n    case 3: k1 ^= tail[2] << 16;\n    case 2: k1 ^= tail[1] << 8;\n    case 1: k1 ^= tail[0];\n            k1 *= c1; k1 = ROTL32(k1,15); k1 *= c2; h1 ^= k1;\n    };\n\n    //----------\n    // finalization\n    h1 ^= vDataToHash.size();\n    h1 ^= h1 >> 16;\n    h1 *= 0x85ebca6b;\n    h1 ^= h1 >> 13;\n    h1 *= 0xc2b2ae35;\n    h1 ^= h1 >> 16;\n\n    return h1;\n}",
    "includes": [
      "#include \"hash.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vDataToHash.size",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ROTL32",
          "args": [
            "k1",
            "15"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "ROTL32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/hash.cpp",
          "lines": "3-6",
          "snippet": "inline uint32_t ROTL32 ( uint32_t x, int8_t r )\n{\n    return (x << r) | (x >> (32 - r));\n}",
          "includes": [
            "#include \"hash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n\ninline uint32_t ROTL32 ( uint32_t x, int8_t r )\n{\n    return (x << r) | (x >> (32 - r));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hash.h\"\n\nunsigned int MurmurHash3(unsigned int nHashSeed, const std::vector<unsigned char>& vDataToHash)\n{\n    // The following is MurmurHash3 (x86_32), see http://code.google.com/p/smhasher/source/browse/trunk/MurmurHash3.cpp\n    uint32_t h1 = nHashSeed;\n    const uint32_t c1 = 0xcc9e2d51;\n    const uint32_t c2 = 0x1b873593;\n\n    const int nblocks = vDataToHash.size() / 4;\n\n    //----------\n    // body\n    const uint32_t * blocks = (const uint32_t *)(&vDataToHash[0] + nblocks*4);\n\n    for(int i = -nblocks; i; i++)\n    {\n        uint32_t k1 = blocks[i];\n\n        k1 *= c1;\n        k1 = ROTL32(k1,15);\n        k1 *= c2;\n\n        h1 ^= k1;\n        h1 = ROTL32(h1,13); \n        h1 = h1*5+0xe6546b64;\n    }\n\n    //----------\n    // tail\n    const uint8_t * tail = (const uint8_t*)(&vDataToHash[0] + nblocks*4);\n\n    uint32_t k1 = 0;\n\n    switch(vDataToHash.size() & 3)\n    {\n    case 3: k1 ^= tail[2] << 16;\n    case 2: k1 ^= tail[1] << 8;\n    case 1: k1 ^= tail[0];\n            k1 *= c1; k1 = ROTL32(k1,15); k1 *= c2; h1 ^= k1;\n    };\n\n    //----------\n    // finalization\n    h1 ^= vDataToHash.size();\n    h1 ^= h1 >> 16;\n    h1 *= 0x85ebca6b;\n    h1 ^= h1 >> 13;\n    h1 *= 0xc2b2ae35;\n    h1 ^= h1 >> 16;\n\n    return h1;\n}"
  },
  {
    "function_name": "ROTL32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/hash.cpp",
    "lines": "3-6",
    "snippet": "inline uint32_t ROTL32 ( uint32_t x, int8_t r )\n{\n    return (x << r) | (x >> (32 - r));\n}",
    "includes": [
      "#include \"hash.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"hash.h\"\n\ninline uint32_t ROTL32 ( uint32_t x, int8_t r )\n{\n    return (x << r) | (x >> (32 - r));\n}"
  }
]