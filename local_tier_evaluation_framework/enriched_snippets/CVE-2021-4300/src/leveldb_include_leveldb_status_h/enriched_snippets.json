[
  {
    "function_name": "operator=",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "95-102",
    "snippet": "inline void Status::operator=(const Status& s) {\n  // The following condition catches both aliasing (when this == &s),\n  // and the common case where both s and *this are ok.\n  if (state_ != s.state_) {\n    delete[] state_;\n    state_ = (s.state_ == NULL) ? NULL : CopyState(s.state_);\n  }\n}",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CopyState",
          "args": [
            "s.state_"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  inline void Status::operator=(const Status& s) {\n    // The following condition catches both aliasing (when this == &s),\n    // and the common case where both s and *this are ok.\n    if (state_ != s.state_) {\n      delete[] state_;\n      state_ = (s.state_ == NULL) ? NULL : CopyState(s.state_);\n    }\n  }\n}"
  },
  {
    "function_name": "Status",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "92-94",
    "snippet": "inline Status::Status(const Status& s) {\n  state_ = (s.state_ == NULL) ? NULL : CopyState(s.state_);\n}",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CopyState",
          "args": [
            "s.state_"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  inline Status::Status(const Status& s) {\n    state_ = (s.state_ == NULL) ? NULL : CopyState(s.state_);\n  }\n}"
  },
  {
    "function_name": "code",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "84-86",
    "snippet": "Code code() const {\n    return (state_ == NULL) ? kOk : static_cast<Code>(state_[4]);\n  }",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<Code>",
          "args": [
            "state_[4]"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  Code code() const {\n      return (state_ == NULL) ? kOk : static_cast<Code>(state_[4]);\n    }\n}"
  },
  {
    "function_name": "IsIOError",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "61-61",
    "snippet": "bool IsIOError() const { return code() == kIOError; }",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "code",
          "args": [],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "code",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "84-86",
          "snippet": "Code code() const {\n    return (state_ == NULL) ? kOk : static_cast<Code>(state_[4]);\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  Code code() const {\n      return (state_ == NULL) ? kOk : static_cast<Code>(state_[4]);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool IsIOError() const { return code() == kIOError; }\n}"
  },
  {
    "function_name": "IsCorruption",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "58-58",
    "snippet": "bool IsCorruption() const { return code() == kCorruption; }",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "code",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "code",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "84-86",
          "snippet": "Code code() const {\n    return (state_ == NULL) ? kOk : static_cast<Code>(state_[4]);\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  Code code() const {\n      return (state_ == NULL) ? kOk : static_cast<Code>(state_[4]);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool IsCorruption() const { return code() == kCorruption; }\n}"
  },
  {
    "function_name": "IsNotFound",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "55-55",
    "snippet": "bool IsNotFound() const { return code() == kNotFound; }",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "code",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "code",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "84-86",
          "snippet": "Code code() const {\n    return (state_ == NULL) ? kOk : static_cast<Code>(state_[4]);\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  Code code() const {\n      return (state_ == NULL) ? kOk : static_cast<Code>(state_[4]);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool IsNotFound() const { return code() == kNotFound; }\n}"
  },
  {
    "function_name": "ok",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "52-52",
    "snippet": "bool ok() const { return (state_ == NULL); }",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
  },
  {
    "function_name": "IOError",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "47-49",
    "snippet": "static Status IOError(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kIOError, msg, msg2);\n  }",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status",
          "args": [
            "kIOError",
            "msg",
            "msg2"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "Status",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/status.cc",
          "lines": "19-34",
          "snippet": "Status::Status(Code code, const Slice& msg, const Slice& msg2) {\n  assert(code != kOk);\n  const uint32_t len1 = msg.size();\n  const uint32_t len2 = msg2.size();\n  const uint32_t size = len1 + (len2 ? (2 + len2) : 0);\n  char* result = new char[size + 5];\n  memcpy(result, &size, sizeof(size));\n  result[4] = static_cast<char>(code);\n  memcpy(result + 5, msg.data(), len1);\n  if (len2) {\n    result[5 + len1] = ':';\n    result[6 + len1] = ' ';\n    memcpy(result + 7 + len1, msg2.data(), len2);\n  }\n  state_ = result;\n}",
          "includes": [
            "#include \"leveldb/status.h\"",
            "#include \"port/port.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/status.h\"\n#include \"port/port.h\"\n#include <stdio.h>\n\nStatus {\n  Status::Status(Code code, const Slice& msg, const Slice& msg2) {\n    assert(code != kOk);\n    const uint32_t len1 = msg.size();\n    const uint32_t len2 = msg2.size();\n    const uint32_t size = len1 + (len2 ? (2 + len2) : 0);\n    char* result = new char[size + 5];\n    memcpy(result, &size, sizeof(size));\n    result[4] = static_cast<char>(code);\n    memcpy(result + 5, msg.data(), len1);\n    if (len2) {\n      result[5 + len1] = ':';\n      result[6 + len1] = ' ';\n      memcpy(result + 7 + len1, msg2.data(), len2);\n    }\n    state_ = result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "66-66",
          "snippet": "std::string ToString() const { return std::string(data_, size_); }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  std::string ToString() const { return std::string(data_, size_); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status IOError(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kIOError, msg, msg2);\n    }\n}"
  },
  {
    "function_name": "InvalidArgument",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "44-46",
    "snippet": "static Status InvalidArgument(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kInvalidArgument, msg, msg2);\n  }",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status",
          "args": [
            "kInvalidArgument",
            "msg",
            "msg2"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "Status",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/status.cc",
          "lines": "19-34",
          "snippet": "Status::Status(Code code, const Slice& msg, const Slice& msg2) {\n  assert(code != kOk);\n  const uint32_t len1 = msg.size();\n  const uint32_t len2 = msg2.size();\n  const uint32_t size = len1 + (len2 ? (2 + len2) : 0);\n  char* result = new char[size + 5];\n  memcpy(result, &size, sizeof(size));\n  result[4] = static_cast<char>(code);\n  memcpy(result + 5, msg.data(), len1);\n  if (len2) {\n    result[5 + len1] = ':';\n    result[6 + len1] = ' ';\n    memcpy(result + 7 + len1, msg2.data(), len2);\n  }\n  state_ = result;\n}",
          "includes": [
            "#include \"leveldb/status.h\"",
            "#include \"port/port.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/status.h\"\n#include \"port/port.h\"\n#include <stdio.h>\n\nStatus {\n  Status::Status(Code code, const Slice& msg, const Slice& msg2) {\n    assert(code != kOk);\n    const uint32_t len1 = msg.size();\n    const uint32_t len2 = msg2.size();\n    const uint32_t size = len1 + (len2 ? (2 + len2) : 0);\n    char* result = new char[size + 5];\n    memcpy(result, &size, sizeof(size));\n    result[4] = static_cast<char>(code);\n    memcpy(result + 5, msg.data(), len1);\n    if (len2) {\n      result[5 + len1] = ':';\n      result[6 + len1] = ' ';\n      memcpy(result + 7 + len1, msg2.data(), len2);\n    }\n    state_ = result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "66-66",
          "snippet": "std::string ToString() const { return std::string(data_, size_); }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  std::string ToString() const { return std::string(data_, size_); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status InvalidArgument(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kInvalidArgument, msg, msg2);\n    }\n}"
  },
  {
    "function_name": "NotSupported",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "41-43",
    "snippet": "static Status NotSupported(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kNotSupported, msg, msg2);\n  }",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status",
          "args": [
            "kNotSupported",
            "msg",
            "msg2"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "Status",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/status.cc",
          "lines": "19-34",
          "snippet": "Status::Status(Code code, const Slice& msg, const Slice& msg2) {\n  assert(code != kOk);\n  const uint32_t len1 = msg.size();\n  const uint32_t len2 = msg2.size();\n  const uint32_t size = len1 + (len2 ? (2 + len2) : 0);\n  char* result = new char[size + 5];\n  memcpy(result, &size, sizeof(size));\n  result[4] = static_cast<char>(code);\n  memcpy(result + 5, msg.data(), len1);\n  if (len2) {\n    result[5 + len1] = ':';\n    result[6 + len1] = ' ';\n    memcpy(result + 7 + len1, msg2.data(), len2);\n  }\n  state_ = result;\n}",
          "includes": [
            "#include \"leveldb/status.h\"",
            "#include \"port/port.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/status.h\"\n#include \"port/port.h\"\n#include <stdio.h>\n\nStatus {\n  Status::Status(Code code, const Slice& msg, const Slice& msg2) {\n    assert(code != kOk);\n    const uint32_t len1 = msg.size();\n    const uint32_t len2 = msg2.size();\n    const uint32_t size = len1 + (len2 ? (2 + len2) : 0);\n    char* result = new char[size + 5];\n    memcpy(result, &size, sizeof(size));\n    result[4] = static_cast<char>(code);\n    memcpy(result + 5, msg.data(), len1);\n    if (len2) {\n      result[5 + len1] = ':';\n      result[6 + len1] = ' ';\n      memcpy(result + 7 + len1, msg2.data(), len2);\n    }\n    state_ = result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "66-66",
          "snippet": "std::string ToString() const { return std::string(data_, size_); }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  std::string ToString() const { return std::string(data_, size_); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status NotSupported(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kNotSupported, msg, msg2);\n    }\n}"
  },
  {
    "function_name": "Corruption",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "38-40",
    "snippet": "static Status Corruption(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kCorruption, msg, msg2);\n  }",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status",
          "args": [
            "kCorruption",
            "msg",
            "msg2"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "Status",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/status.cc",
          "lines": "19-34",
          "snippet": "Status::Status(Code code, const Slice& msg, const Slice& msg2) {\n  assert(code != kOk);\n  const uint32_t len1 = msg.size();\n  const uint32_t len2 = msg2.size();\n  const uint32_t size = len1 + (len2 ? (2 + len2) : 0);\n  char* result = new char[size + 5];\n  memcpy(result, &size, sizeof(size));\n  result[4] = static_cast<char>(code);\n  memcpy(result + 5, msg.data(), len1);\n  if (len2) {\n    result[5 + len1] = ':';\n    result[6 + len1] = ' ';\n    memcpy(result + 7 + len1, msg2.data(), len2);\n  }\n  state_ = result;\n}",
          "includes": [
            "#include \"leveldb/status.h\"",
            "#include \"port/port.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/status.h\"\n#include \"port/port.h\"\n#include <stdio.h>\n\nStatus {\n  Status::Status(Code code, const Slice& msg, const Slice& msg2) {\n    assert(code != kOk);\n    const uint32_t len1 = msg.size();\n    const uint32_t len2 = msg2.size();\n    const uint32_t size = len1 + (len2 ? (2 + len2) : 0);\n    char* result = new char[size + 5];\n    memcpy(result, &size, sizeof(size));\n    result[4] = static_cast<char>(code);\n    memcpy(result + 5, msg.data(), len1);\n    if (len2) {\n      result[5 + len1] = ':';\n      result[6 + len1] = ' ';\n      memcpy(result + 7 + len1, msg2.data(), len2);\n    }\n    state_ = result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "66-66",
          "snippet": "std::string ToString() const { return std::string(data_, size_); }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  std::string ToString() const { return std::string(data_, size_); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status Corruption(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kCorruption, msg, msg2);\n    }\n}"
  },
  {
    "function_name": "NotFound",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "35-37",
    "snippet": "static Status NotFound(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kNotFound, msg, msg2);\n  }",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status",
          "args": [
            "kNotFound",
            "msg",
            "msg2"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "Status",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/status.cc",
          "lines": "19-34",
          "snippet": "Status::Status(Code code, const Slice& msg, const Slice& msg2) {\n  assert(code != kOk);\n  const uint32_t len1 = msg.size();\n  const uint32_t len2 = msg2.size();\n  const uint32_t size = len1 + (len2 ? (2 + len2) : 0);\n  char* result = new char[size + 5];\n  memcpy(result, &size, sizeof(size));\n  result[4] = static_cast<char>(code);\n  memcpy(result + 5, msg.data(), len1);\n  if (len2) {\n    result[5 + len1] = ':';\n    result[6 + len1] = ' ';\n    memcpy(result + 7 + len1, msg2.data(), len2);\n  }\n  state_ = result;\n}",
          "includes": [
            "#include \"leveldb/status.h\"",
            "#include \"port/port.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/status.h\"\n#include \"port/port.h\"\n#include <stdio.h>\n\nStatus {\n  Status::Status(Code code, const Slice& msg, const Slice& msg2) {\n    assert(code != kOk);\n    const uint32_t len1 = msg.size();\n    const uint32_t len2 = msg2.size();\n    const uint32_t size = len1 + (len2 ? (2 + len2) : 0);\n    char* result = new char[size + 5];\n    memcpy(result, &size, sizeof(size));\n    result[4] = static_cast<char>(code);\n    memcpy(result + 5, msg.data(), len1);\n    if (len2) {\n      result[5 + len1] = ':';\n      result[6 + len1] = ' ';\n      memcpy(result + 7 + len1, msg2.data(), len2);\n    }\n    state_ = result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "66-66",
          "snippet": "std::string ToString() const { return std::string(data_, size_); }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  std::string ToString() const { return std::string(data_, size_); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status NotFound(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kNotFound, msg, msg2);\n    }\n}"
  },
  {
    "function_name": "OK",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "32-32",
    "snippet": "static Status OK() { return Status(); }",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status",
          "args": [],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "code",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "84-86",
          "snippet": "Code code() const {\n    return (state_ == NULL) ? kOk : static_cast<Code>(state_[4]);\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  Code code() const {\n      return (state_ == NULL) ? kOk : static_cast<Code>(state_[4]);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
  },
  {
    "function_name": "Status",
    "container": "Status",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
    "lines": "24-24",
    "snippet": "Status() : state_(NULL) { }",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  Status() : state_(NULL) { }\n}"
  }
]