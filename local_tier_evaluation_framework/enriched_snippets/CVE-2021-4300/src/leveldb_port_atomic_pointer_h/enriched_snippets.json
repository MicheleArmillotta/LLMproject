[
  {
    "function_name": "NoBarrier_Store",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "207-207",
    "snippet": "inline void NoBarrier_Store(void* v) { rep_ = v; }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void NoBarrier_Store(void* v) { rep_ = v; }\n}"
  },
  {
    "function_name": "Release_Store",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "198-205",
    "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
  },
  {
    "function_name": "AtomicPointer",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "187-187",
    "snippet": "explicit AtomicPointer(void* v) : rep_(v) { }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  explicit AtomicPointer(void* v) : rep_(v) { }\n}"
  },
  {
    "function_name": "AtomicPointer",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "186-186",
    "snippet": "AtomicPointer() { }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  AtomicPointer() { }\n}"
  },
  {
    "function_name": "NoBarrier_Store",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "177-177",
    "snippet": "inline void NoBarrier_Store(void* v) { rep_ = v; }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void NoBarrier_Store(void* v) { rep_ = v; }\n}"
  },
  {
    "function_name": "Release_Store",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "168-175",
    "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"membar #LoadStore|#StoreStore \\n\\t\"\n        \"stx %[v], [%[rep_]] \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\");\n  }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"membar #LoadStore|#StoreStore \\n\\t\"\n          \"stx %[v], [%[rep_]] \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\");\n    }\n}"
  },
  {
    "function_name": "AtomicPointer",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "157-157",
    "snippet": "explicit AtomicPointer(void* v) : rep_(v) { }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  explicit AtomicPointer(void* v) : rep_(v) { }\n}"
  },
  {
    "function_name": "AtomicPointer",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "156-156",
    "snippet": "AtomicPointer() { }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  AtomicPointer() { }\n}"
  },
  {
    "function_name": "NoBarrier_Store",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "145-147",
    "snippet": "inline void NoBarrier_Store(void* v) {\n    rep_.store(v, std::memory_order_relaxed);\n  }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rep_.store",
          "args": [
            "v",
            "std::memory_order_relaxed"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void NoBarrier_Store(void* v) {\n      rep_.store(v, std::memory_order_relaxed);\n    }\n}"
  },
  {
    "function_name": "Release_Store",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "139-141",
    "snippet": "inline void Release_Store(void* v) {\n    rep_.store(v, std::memory_order_release);\n  }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rep_.store",
          "args": [
            "v",
            "std::memory_order_release"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      rep_.store(v, std::memory_order_release);\n    }\n}"
  },
  {
    "function_name": "AtomicPointer",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "135-135",
    "snippet": "explicit AtomicPointer(void* v) : rep_(v) { }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  explicit AtomicPointer(void* v) : rep_(v) { }\n}"
  },
  {
    "function_name": "AtomicPointer",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "134-134",
    "snippet": "AtomicPointer() { }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  AtomicPointer() { }\n}"
  },
  {
    "function_name": "Release_Store",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "122-125",
    "snippet": "inline void Release_Store(void* v) {\n    MemoryBarrier();\n    rep_ = v;\n  }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MemoryBarrier",
          "args": [],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "MemoryBarrier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "98-102",
          "snippet": "inline void MemoryBarrier() {\n  // TODO for some powerpc expert: is there a cheaper suitable variant?\n  // Perhaps by having separate barriers for acquire and release ops.\n  asm volatile(\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\ninline void MemoryBarrier() {\n  // TODO for some powerpc expert: is there a cheaper suitable variant?\n  // Perhaps by having separate barriers for acquire and release ops.\n  asm volatile(\"sync\" : : : \"memory\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      MemoryBarrier();\n      rep_ = v;\n    }\n}"
  },
  {
    "function_name": "NoBarrier_Store",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "116-116",
    "snippet": "inline void NoBarrier_Store(void* v) { rep_ = v; }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void NoBarrier_Store(void* v) { rep_ = v; }\n}"
  },
  {
    "function_name": "AtomicPointer",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "114-114",
    "snippet": "explicit AtomicPointer(void* p) : rep_(p) {}",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  explicit AtomicPointer(void* p) : rep_(p) {}\n}"
  },
  {
    "function_name": "AtomicPointer",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "113-113",
    "snippet": "AtomicPointer() { }",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  AtomicPointer() { }\n}"
  },
  {
    "function_name": "MemoryBarrier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "98-102",
    "snippet": "inline void MemoryBarrier() {\n  // TODO for some powerpc expert: is there a cheaper suitable variant?\n  // Perhaps by having separate barriers for acquire and release ops.\n  asm volatile(\"sync\" : : : \"memory\");\n}",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\ninline void MemoryBarrier() {\n  // TODO for some powerpc expert: is there a cheaper suitable variant?\n  // Perhaps by having separate barriers for acquire and release ops.\n  asm volatile(\"sync\" : : : \"memory\");\n}"
  },
  {
    "function_name": "MemoryBarrier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "91-93",
    "snippet": "inline void MemoryBarrier() {\n  (*(LinuxKernelMemoryBarrierFunc)0xffff0fa0)();\n}",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\ninline void MemoryBarrier() {\n  (*(LinuxKernelMemoryBarrierFunc)0xffff0fa0)();\n}"
  },
  {
    "function_name": "MemoryBarrier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "71-75",
    "snippet": "inline void MemoryBarrier() {\n  // See http://gcc.gnu.org/ml/gcc/2003-04/msg01180.html for a discussion on\n  // this idiom. Also see http://en.wikipedia.org/wiki/Memory_ordering.\n  asm volatile(\"\" : : : \"memory\");\n}",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\ninline void MemoryBarrier() {\n  // See http://gcc.gnu.org/ml/gcc/2003-04/msg01180.html for a discussion on\n  // this idiom. Also see http://en.wikipedia.org/wiki/Memory_ordering.\n  asm volatile(\"\" : : : \"memory\");\n}"
  },
  {
    "function_name": "MemoryBarrier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "62-66",
    "snippet": "inline void MemoryBarrier() {\n  // See http://gcc.gnu.org/ml/gcc/2003-04/msg01180.html for a discussion on\n  // this idiom. Also see http://en.wikipedia.org/wiki/Memory_ordering.\n  __asm__ __volatile__(\"\" : : : \"memory\");\n}",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\ninline void MemoryBarrier() {\n  // See http://gcc.gnu.org/ml/gcc/2003-04/msg01180.html for a discussion on\n  // this idiom. Also see http://en.wikipedia.org/wiki/Memory_ordering.\n  __asm__ __volatile__(\"\" : : : \"memory\");\n}"
  },
  {
    "function_name": "MemoryBarrier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
    "lines": "55-57",
    "snippet": "inline void MemoryBarrier() {\n  OSMemoryBarrier();\n}",
    "includes": [
      "#include <libkern/OSAtomic.h>",
      "#include <windows.h>",
      "#include <cstdatomic>",
      "#include <stdint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OSMemoryBarrier",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\ninline void MemoryBarrier() {\n  OSMemoryBarrier();\n}"
  }
]