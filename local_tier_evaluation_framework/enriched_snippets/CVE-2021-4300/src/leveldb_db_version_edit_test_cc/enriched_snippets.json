[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit_test.cc",
    "lines": "44-46",
    "snippet": "int main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"db/version_edit.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "leveldb::test::RunAllTests",
          "args": [],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "RunAllTests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "36-58",
          "snippet": "int RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"db/version_edit.h\"\n\nint main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit_test.cc",
    "lines": "22-40",
    "snippet": "TEST(VersionEditTest, EncodeDecode) {\n  static const uint64_t kBig = 1ull << 50;\n\n  VersionEdit edit;\n  for (int i = 0; i < 4; i++) {\n    TestEncodeDecode(edit);\n    edit.AddFile(3, kBig + 300 + i, kBig + 400 + i,\n                 InternalKey(\"foo\", kBig + 500 + i, kTypeValue),\n                 InternalKey(\"zoo\", kBig + 600 + i, kTypeDeletion));\n    edit.DeleteFile(4, kBig + 700 + i);\n    edit.SetCompactPointer(i, InternalKey(\"x\", kBig + 900 + i, kTypeValue));\n  }\n\n  edit.SetComparatorName(\"foo\");\n  edit.SetLogNumber(kBig + 100);\n  edit.SetNextFile(kBig + 200);\n  edit.SetLastSequence(kBig + 1000);\n  TestEncodeDecode(edit);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"db/version_edit.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TestEncodeDecode",
          "args": [
            "edit"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "TestEncodeDecode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit_test.cc",
          "lines": "10-18",
          "snippet": "static void TestEncodeDecode(const VersionEdit& edit) {\n  std::string encoded, encoded2;\n  edit.EncodeTo(&encoded);\n  VersionEdit parsed;\n  Status s = parsed.DecodeFrom(encoded);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  parsed.EncodeTo(&encoded2);\n  ASSERT_EQ(encoded, encoded2);\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"db/version_edit.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"db/version_edit.h\"\n\nstatic void TestEncodeDecode(const VersionEdit& edit) {\n  std::string encoded, encoded2;\n  edit.EncodeTo(&encoded);\n  VersionEdit parsed;\n  Status s = parsed.DecodeFrom(encoded);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  parsed.EncodeTo(&encoded2);\n  ASSERT_EQ(encoded, encoded2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "edit.SetLastSequence",
          "args": [
            "kBig + 1000"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "SetLastSequence",
          "container": "VersionSet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set.h",
          "lines": "212-215",
          "snippet": "void SetLastSequence(uint64_t s) {\n    assert(s >= last_sequence_);\n    last_sequence_ = s;\n  }",
          "includes": [
            "#include \"port/thread_annotations.h\"",
            "#include \"port/port.h\"",
            "#include \"db/version_edit.h\"",
            "#include \"db/dbformat.h\"",
            "#include <vector>",
            "#include <set>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"port/thread_annotations.h\"\n#include \"port/port.h\"\n#include \"db/version_edit.h\"\n#include \"db/dbformat.h\"\n#include <vector>\n#include <set>\n#include <map>\n\nVersionSet {\n  void SetLastSequence(uint64_t s) {\n      assert(s >= last_sequence_);\n      last_sequence_ = s;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "edit.SetNextFile",
          "args": [
            "kBig + 200"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "SetNextFile",
          "container": "VersionEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
          "lines": "47-50",
          "snippet": "void SetNextFile(uint64_t num) {\n    has_next_file_number_ = true;\n    next_file_number_ = num;\n  }",
          "includes": [
            "#include \"db/dbformat.h\"",
            "#include <vector>",
            "#include <utility>",
            "#include <set>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void SetNextFile(uint64_t num) {\n      has_next_file_number_ = true;\n      next_file_number_ = num;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "edit.SetLogNumber",
          "args": [
            "kBig + 100"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "SetLogNumber",
          "container": "VersionEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
          "lines": "39-42",
          "snippet": "void SetLogNumber(uint64_t num) {\n    has_log_number_ = true;\n    log_number_ = num;\n  }",
          "includes": [
            "#include \"db/dbformat.h\"",
            "#include <vector>",
            "#include <utility>",
            "#include <set>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void SetLogNumber(uint64_t num) {\n      has_log_number_ = true;\n      log_number_ = num;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "edit.SetComparatorName",
          "args": [
            "\"foo\""
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "SetComparatorName",
          "container": "VersionEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
          "lines": "35-38",
          "snippet": "void SetComparatorName(const Slice& name) {\n    has_comparator_ = true;\n    comparator_ = name.ToString();\n  }",
          "includes": [
            "#include \"db/dbformat.h\"",
            "#include <vector>",
            "#include <utility>",
            "#include <set>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void SetComparatorName(const Slice& name) {\n      has_comparator_ = true;\n      comparator_ = name.ToString();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "edit.SetCompactPointer",
          "args": [
            "i",
            "InternalKey(\"x\", kBig + 900 + i, kTypeValue)"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "SetCompactPointer",
          "container": "VersionEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
          "lines": "55-57",
          "snippet": "void SetCompactPointer(int level, const InternalKey& key) {\n    compact_pointers_.push_back(std::make_pair(level, key));\n  }",
          "includes": [
            "#include \"db/dbformat.h\"",
            "#include <vector>",
            "#include <utility>",
            "#include <set>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void SetCompactPointer(int level, const InternalKey& key) {\n      compact_pointers_.push_back(std::make_pair(level, key));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "InternalKey",
          "args": [
            "\"x\"",
            "kBig + 900 + i",
            "kTypeValue"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "InternalKey",
          "container": "InternalKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "149-151",
          "snippet": "InternalKey(const Slice& user_key, SequenceNumber s, ValueType t) {\n    AppendInternalKey(&rep_, ParsedInternalKey(user_key, s, t));\n  }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\nInternalKey {\n  InternalKey(const Slice& user_key, SequenceNumber s, ValueType t) {\n      AppendInternalKey(&rep_, ParsedInternalKey(user_key, s, t));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "edit.DeleteFile",
          "args": [
            "4",
            "kBig + 700 + i"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "DeleteFile",
          "container": "VersionEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
          "lines": "75-77",
          "snippet": "void DeleteFile(int level, uint64_t file) {\n    deleted_files_.insert(std::make_pair(level, file));\n  }",
          "includes": [
            "#include \"db/dbformat.h\"",
            "#include <vector>",
            "#include <utility>",
            "#include <set>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void DeleteFile(int level, uint64_t file) {\n      deleted_files_.insert(std::make_pair(level, file));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "edit.AddFile",
          "args": [
            "3",
            "kBig + 300 + i",
            "kBig + 400 + i",
            "InternalKey(\"foo\", kBig + 500 + i, kTypeValue)",
            "InternalKey(\"zoo\", kBig + 600 + i, kTypeDeletion)"
          ],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "AddFile",
          "container": "VersionEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
          "lines": "62-72",
          "snippet": "void AddFile(int level, uint64_t file,\n               uint64_t file_size,\n               const InternalKey& smallest,\n               const InternalKey& largest) {\n    FileMetaData f;\n    f.number = file;\n    f.file_size = file_size;\n    f.smallest = smallest;\n    f.largest = largest;\n    new_files_.push_back(std::make_pair(level, f));\n  }",
          "includes": [
            "#include \"db/dbformat.h\"",
            "#include <vector>",
            "#include <utility>",
            "#include <set>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void AddFile(int level, uint64_t file,\n                 uint64_t file_size,\n                 const InternalKey& smallest,\n                 const InternalKey& largest) {\n      FileMetaData f;\n      f.number = file;\n      f.file_size = file_size;\n      f.smallest = smallest;\n      f.largest = largest;\n      new_files_.push_back(std::make_pair(level, f));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"db/version_edit.h\"\n\nTEST(VersionEditTest, EncodeDecode) {\n  static const uint64_t kBig = 1ull << 50;\n\n  VersionEdit edit;\n  for (int i = 0; i < 4; i++) {\n    TestEncodeDecode(edit);\n    edit.AddFile(3, kBig + 300 + i, kBig + 400 + i,\n                 InternalKey(\"foo\", kBig + 500 + i, kTypeValue),\n                 InternalKey(\"zoo\", kBig + 600 + i, kTypeDeletion));\n    edit.DeleteFile(4, kBig + 700 + i);\n    edit.SetCompactPointer(i, InternalKey(\"x\", kBig + 900 + i, kTypeValue));\n  }\n\n  edit.SetComparatorName(\"foo\");\n  edit.SetLogNumber(kBig + 100);\n  edit.SetNextFile(kBig + 200);\n  edit.SetLastSequence(kBig + 1000);\n  TestEncodeDecode(edit);\n}"
  },
  {
    "function_name": "TestEncodeDecode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit_test.cc",
    "lines": "10-18",
    "snippet": "static void TestEncodeDecode(const VersionEdit& edit) {\n  std::string encoded, encoded2;\n  edit.EncodeTo(&encoded);\n  VersionEdit parsed;\n  Status s = parsed.DecodeFrom(encoded);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  parsed.EncodeTo(&encoded2);\n  ASSERT_EQ(encoded, encoded2);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"db/version_edit.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "encoded",
            "encoded2"
          ],
          "line": 17
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parsed.EncodeTo",
          "args": [
            "&encoded2"
          ],
          "line": 16
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeTo",
          "container": "VersionEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.cc",
          "lines": "41-86",
          "snippet": "void VersionEdit::EncodeTo(std::string* dst) const {\n  if (has_comparator_) {\n    PutVarint32(dst, kComparator);\n    PutLengthPrefixedSlice(dst, comparator_);\n  }\n  if (has_log_number_) {\n    PutVarint32(dst, kLogNumber);\n    PutVarint64(dst, log_number_);\n  }\n  if (has_prev_log_number_) {\n    PutVarint32(dst, kPrevLogNumber);\n    PutVarint64(dst, prev_log_number_);\n  }\n  if (has_next_file_number_) {\n    PutVarint32(dst, kNextFileNumber);\n    PutVarint64(dst, next_file_number_);\n  }\n  if (has_last_sequence_) {\n    PutVarint32(dst, kLastSequence);\n    PutVarint64(dst, last_sequence_);\n  }\n\n  for (size_t i = 0; i < compact_pointers_.size(); i++) {\n    PutVarint32(dst, kCompactPointer);\n    PutVarint32(dst, compact_pointers_[i].first);  // level\n    PutLengthPrefixedSlice(dst, compact_pointers_[i].second.Encode());\n  }\n\n  for (DeletedFileSet::const_iterator iter = deleted_files_.begin();\n       iter != deleted_files_.end();\n       ++iter) {\n    PutVarint32(dst, kDeletedFile);\n    PutVarint32(dst, iter->first);   // level\n    PutVarint64(dst, iter->second);  // file number\n  }\n\n  for (size_t i = 0; i < new_files_.size(); i++) {\n    const FileMetaData& f = new_files_[i].second;\n    PutVarint32(dst, kNewFile);\n    PutVarint32(dst, new_files_[i].first);  // level\n    PutVarint64(dst, f.number);\n    PutVarint64(dst, f.file_size);\n    PutLengthPrefixedSlice(dst, f.smallest.Encode());\n    PutLengthPrefixedSlice(dst, f.largest.Encode());\n  }\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/version_edit.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/version_set.h\"\n#include \"db/version_edit.h\"\n\nVersionEdit {\n  void VersionEdit::EncodeTo(std::string* dst) const {\n    if (has_comparator_) {\n      PutVarint32(dst, kComparator);\n      PutLengthPrefixedSlice(dst, comparator_);\n    }\n    if (has_log_number_) {\n      PutVarint32(dst, kLogNumber);\n      PutVarint64(dst, log_number_);\n    }\n    if (has_prev_log_number_) {\n      PutVarint32(dst, kPrevLogNumber);\n      PutVarint64(dst, prev_log_number_);\n    }\n    if (has_next_file_number_) {\n      PutVarint32(dst, kNextFileNumber);\n      PutVarint64(dst, next_file_number_);\n    }\n    if (has_last_sequence_) {\n      PutVarint32(dst, kLastSequence);\n      PutVarint64(dst, last_sequence_);\n    }\n  \n    for (size_t i = 0; i < compact_pointers_.size(); i++) {\n      PutVarint32(dst, kCompactPointer);\n      PutVarint32(dst, compact_pointers_[i].first);  // level\n      PutLengthPrefixedSlice(dst, compact_pointers_[i].second.Encode());\n    }\n  \n    for (DeletedFileSet::const_iterator iter = deleted_files_.begin();\n         iter != deleted_files_.end();\n         ++iter) {\n      PutVarint32(dst, kDeletedFile);\n      PutVarint32(dst, iter->first);   // level\n      PutVarint64(dst, iter->second);  // file number\n    }\n  \n    for (size_t i = 0; i < new_files_.size(); i++) {\n      const FileMetaData& f = new_files_[i].second;\n      PutVarint32(dst, kNewFile);\n      PutVarint32(dst, new_files_[i].first);  // level\n      PutVarint64(dst, f.number);\n      PutVarint64(dst, f.file_size);\n      PutLengthPrefixedSlice(dst, f.smallest.Encode());\n      PutLengthPrefixedSlice(dst, f.largest.Encode());\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.ToString",
          "args": [],
          "line": 15
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CUnsignedSyncCheckpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/checkpoints.h",
          "lines": "89-98",
          "snippet": "std::string ToString() const\n    {\n        return strprintf(\n                \"CSyncCheckpoint(\\n\"\n                \"    nVersion       = %d\\n\"\n                \"    hashCheckpoint = %s\\n\"\n                \")\\n\",\n            nVersion,\n            hashCheckpoint.ToString().c_str());\n    }",
          "includes": [
            "#include \"util.h\"",
            "#include \"net.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"net.h\"\n#include <map>\n\nCUnsignedSyncCheckpoint {\n  std::string ToString() const\n      {\n          return strprintf(\n                  \"CSyncCheckpoint(\\n\"\n                  \"    nVersion       = %d\\n\"\n                  \"    hashCheckpoint = %s\\n\"\n                  \")\\n\",\n              nVersion,\n              hashCheckpoint.ToString().c_str());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "s.ok()"
          ],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 15
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "parsed.DecodeFrom",
          "args": [
            "encoded"
          ],
          "line": 14
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeFrom",
          "container": "InternalKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "153-153",
          "snippet": "void DecodeFrom(const Slice& s) { rep_.assign(s.data(), s.size()); }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\nInternalKey {\n  void DecodeFrom(const Slice& s) { rep_.assign(s.data(), s.size()); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"db/version_edit.h\"\n\nstatic void TestEncodeDecode(const VersionEdit& edit) {\n  std::string encoded, encoded2;\n  edit.EncodeTo(&encoded);\n  VersionEdit parsed;\n  Status s = parsed.DecodeFrom(encoded);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  parsed.EncodeTo(&encoded2);\n  ASSERT_EQ(encoded, encoded2);\n}"
  }
]