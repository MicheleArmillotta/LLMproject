[
  {
    "function_name": "updateDisplayUnit",
    "container": "QRCodeDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
    "lines": "164-171",
    "snippet": "void QRCodeDialog::updateDisplayUnit()\n{\n    if (model)\n    {\n        // Update lnReqAmount with the current unit\n        ui->lnReqAmount->setDisplayUnit(model->getDisplayUnit());\n    }\n}",
    "includes": [
      "#include <qrencode.h>",
      "#include <QUrl>",
      "#include <QPixmap>",
      "#include \"optionsmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_qrcodedialog.h\"",
      "#include \"qrcodedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->lnReqAmount->setDisplayUnit",
          "args": [
            "model->getDisplayUnit()"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "setDisplayUnit",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "165-168",
          "snippet": "void BitcoinAmountField::setDisplayUnit(int newUnit)\n{\n    unit->setValue(newUnit);\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setDisplayUnit(int newUnit)\n  {\n      unit->setValue(newUnit);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getDisplayUnit",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "getDisplayUnit",
          "container": "OptionsModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
          "lines": "313-316",
          "snippet": "int OptionsModel::getDisplayUnit()\n{\n    return nDisplayUnit;\n}",
          "includes": [
            "#include \"guiutil.h\"",
            "#include \"walletdb.h\"",
            "#include \"init.h\"",
            "#include <QSettings>",
            "#include \"bitcoinunits.h\"",
            "#include \"optionsmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  int OptionsModel::getDisplayUnit()\n  {\n      return nDisplayUnit;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::updateDisplayUnit()\n  {\n      if (model)\n      {\n          // Update lnReqAmount with the current unit\n          ui->lnReqAmount->setDisplayUnit(model->getDisplayUnit());\n      }\n  }\n}"
  },
  {
    "function_name": "on_chkReqPayment_toggled",
    "container": "QRCodeDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
    "lines": "155-162",
    "snippet": "void QRCodeDialog::on_chkReqPayment_toggled(bool fChecked)\n{\n    if (!fChecked)\n        // if chkReqPayment is not active, don't display lnReqAmount as invalid\n        ui->lnReqAmount->setValid(true);\n\n    genCode();\n}",
    "includes": [
      "#include <qrencode.h>",
      "#include <QUrl>",
      "#include <QPixmap>",
      "#include \"optionsmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_qrcodedialog.h\"",
      "#include \"qrcodedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "genCode",
          "args": [],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "genCode",
          "container": "QRCodeDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
          "lines": "51-82",
          "snippet": "void QRCodeDialog::genCode()\n{\n    QString uri = getURI();\n\n    if (uri != \"\")\n    {\n        ui->lblQRCode->setText(\"\");\n\n        QRcode *code = QRcode_encodeString(uri.toUtf8().constData(), 0, QR_ECLEVEL_L, QR_MODE_8, 1);\n        if (!code)\n        {\n            ui->lblQRCode->setText(tr(\"Error encoding URI into QR Code.\"));\n            return;\n        }\n        myImage = QImage(code->width + 8, code->width + 8, QImage::Format_RGB32);\n        myImage.fill(0xffffff);\n        unsigned char *p = code->data;\n        for (int y = 0; y < code->width; y++)\n        {\n            for (int x = 0; x < code->width; x++)\n            {\n                myImage.setPixel(x + 4, y + 4, ((*p & 1) ? 0x0 : 0xffffff));\n                p++;\n            }\n        }\n        QRcode_free(code);\n\n        ui->lblQRCode->setPixmap(QPixmap::fromImage(myImage).scaled(300, 300));\n\n        ui->outUri->setPlainText(uri);\n    }\n}",
          "includes": [
            "#include <qrencode.h>",
            "#include <QUrl>",
            "#include <QPixmap>",
            "#include \"optionsmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_qrcodedialog.h\"",
            "#include \"qrcodedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::genCode()\n  {\n      QString uri = getURI();\n  \n      if (uri != \"\")\n      {\n          ui->lblQRCode->setText(\"\");\n  \n          QRcode *code = QRcode_encodeString(uri.toUtf8().constData(), 0, QR_ECLEVEL_L, QR_MODE_8, 1);\n          if (!code)\n          {\n              ui->lblQRCode->setText(tr(\"Error encoding URI into QR Code.\"));\n              return;\n          }\n          myImage = QImage(code->width + 8, code->width + 8, QImage::Format_RGB32);\n          myImage.fill(0xffffff);\n          unsigned char *p = code->data;\n          for (int y = 0; y < code->width; y++)\n          {\n              for (int x = 0; x < code->width; x++)\n              {\n                  myImage.setPixel(x + 4, y + 4, ((*p & 1) ? 0x0 : 0xffffff));\n                  p++;\n              }\n          }\n          QRcode_free(code);\n  \n          ui->lblQRCode->setPixmap(QPixmap::fromImage(myImage).scaled(300, 300));\n  \n          ui->outUri->setPlainText(uri);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->lnReqAmount->setValid",
          "args": [
            "true"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "setValid",
          "container": "QValidatedLineEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qvalidatedlineedit.cpp",
          "lines": "11-27",
          "snippet": "void QValidatedLineEdit::setValid(bool valid)\n{\n    if(valid == this->valid)\n    {\n        return;\n    }\n\n    if(valid)\n    {\n        setStyleSheet(\"\");\n    }\n    else\n    {\n        setStyleSheet(STYLE_INVALID);\n    }\n    this->valid = valid;\n}",
          "includes": [
            "#include \"guiconstants.h\"",
            "#include \"qvalidatedlineedit.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"guiconstants.h\"\n#include \"qvalidatedlineedit.h\"\n\nQValidatedLineEdit {\n  void QValidatedLineEdit::setValid(bool valid)\n  {\n      if(valid == this->valid)\n      {\n          return;\n      }\n  \n      if(valid)\n      {\n          setStyleSheet(\"\");\n      }\n      else\n      {\n          setStyleSheet(STYLE_INVALID);\n      }\n      this->valid = valid;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::on_chkReqPayment_toggled(bool fChecked)\n  {\n      if (!fChecked)\n          // if chkReqPayment is not active, don't display lnReqAmount as invalid\n          ui->lnReqAmount->setValid(true);\n  \n      genCode();\n  }\n}"
  },
  {
    "function_name": "on_btnSaveAs_clicked",
    "container": "QRCodeDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
    "lines": "148-153",
    "snippet": "void QRCodeDialog::on_btnSaveAs_clicked()\n{\n    QString fn = GUIUtil::getSaveFileName(this, tr(\"Save QR Code\"), QString(), tr(\"PNG Images (*.png)\"));\n    if (!fn.isEmpty())\n        myImage.scaled(EXPORT_IMAGE_SIZE, EXPORT_IMAGE_SIZE).save(fn);\n}",
    "includes": [
      "#include <qrencode.h>",
      "#include <QUrl>",
      "#include <QPixmap>",
      "#include \"optionsmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_qrcodedialog.h\"",
      "#include \"qrcodedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "myImage.scaled",
          "args": [
            "fn"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "myImage.scaled",
          "args": [
            "EXPORT_IMAGE_SIZE",
            "EXPORT_IMAGE_SIZE"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fn.isEmpty",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::getSaveFileName",
          "args": [
            "this",
            "tr(\"Save QR Code\")",
            "QString()",
            "tr(\"PNG Images (*.png)\")"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"PNG Images (*.png)\""
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::on_btnSaveAs_clicked()\n  {\n      QString fn = GUIUtil::getSaveFileName(this, tr(\"Save QR Code\"), QString(), tr(\"PNG Images (*.png)\"));\n      if (!fn.isEmpty())\n          myImage.scaled(EXPORT_IMAGE_SIZE, EXPORT_IMAGE_SIZE).save(fn);\n  }\n}"
  },
  {
    "function_name": "on_lnMessage_textChanged",
    "container": "QRCodeDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
    "lines": "143-146",
    "snippet": "void QRCodeDialog::on_lnMessage_textChanged()\n{\n    genCode();\n}",
    "includes": [
      "#include <qrencode.h>",
      "#include <QUrl>",
      "#include <QPixmap>",
      "#include \"optionsmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_qrcodedialog.h\"",
      "#include \"qrcodedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "genCode",
          "args": [],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "genCode",
          "container": "QRCodeDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
          "lines": "51-82",
          "snippet": "void QRCodeDialog::genCode()\n{\n    QString uri = getURI();\n\n    if (uri != \"\")\n    {\n        ui->lblQRCode->setText(\"\");\n\n        QRcode *code = QRcode_encodeString(uri.toUtf8().constData(), 0, QR_ECLEVEL_L, QR_MODE_8, 1);\n        if (!code)\n        {\n            ui->lblQRCode->setText(tr(\"Error encoding URI into QR Code.\"));\n            return;\n        }\n        myImage = QImage(code->width + 8, code->width + 8, QImage::Format_RGB32);\n        myImage.fill(0xffffff);\n        unsigned char *p = code->data;\n        for (int y = 0; y < code->width; y++)\n        {\n            for (int x = 0; x < code->width; x++)\n            {\n                myImage.setPixel(x + 4, y + 4, ((*p & 1) ? 0x0 : 0xffffff));\n                p++;\n            }\n        }\n        QRcode_free(code);\n\n        ui->lblQRCode->setPixmap(QPixmap::fromImage(myImage).scaled(300, 300));\n\n        ui->outUri->setPlainText(uri);\n    }\n}",
          "includes": [
            "#include <qrencode.h>",
            "#include <QUrl>",
            "#include <QPixmap>",
            "#include \"optionsmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_qrcodedialog.h\"",
            "#include \"qrcodedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::genCode()\n  {\n      QString uri = getURI();\n  \n      if (uri != \"\")\n      {\n          ui->lblQRCode->setText(\"\");\n  \n          QRcode *code = QRcode_encodeString(uri.toUtf8().constData(), 0, QR_ECLEVEL_L, QR_MODE_8, 1);\n          if (!code)\n          {\n              ui->lblQRCode->setText(tr(\"Error encoding URI into QR Code.\"));\n              return;\n          }\n          myImage = QImage(code->width + 8, code->width + 8, QImage::Format_RGB32);\n          myImage.fill(0xffffff);\n          unsigned char *p = code->data;\n          for (int y = 0; y < code->width; y++)\n          {\n              for (int x = 0; x < code->width; x++)\n              {\n                  myImage.setPixel(x + 4, y + 4, ((*p & 1) ? 0x0 : 0xffffff));\n                  p++;\n              }\n          }\n          QRcode_free(code);\n  \n          ui->lblQRCode->setPixmap(QPixmap::fromImage(myImage).scaled(300, 300));\n  \n          ui->outUri->setPlainText(uri);\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::on_lnMessage_textChanged()\n  {\n      genCode();\n  }\n}"
  },
  {
    "function_name": "on_lnLabel_textChanged",
    "container": "QRCodeDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
    "lines": "138-141",
    "snippet": "void QRCodeDialog::on_lnLabel_textChanged()\n{\n    genCode();\n}",
    "includes": [
      "#include <qrencode.h>",
      "#include <QUrl>",
      "#include <QPixmap>",
      "#include \"optionsmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_qrcodedialog.h\"",
      "#include \"qrcodedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "genCode",
          "args": [],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "genCode",
          "container": "QRCodeDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
          "lines": "51-82",
          "snippet": "void QRCodeDialog::genCode()\n{\n    QString uri = getURI();\n\n    if (uri != \"\")\n    {\n        ui->lblQRCode->setText(\"\");\n\n        QRcode *code = QRcode_encodeString(uri.toUtf8().constData(), 0, QR_ECLEVEL_L, QR_MODE_8, 1);\n        if (!code)\n        {\n            ui->lblQRCode->setText(tr(\"Error encoding URI into QR Code.\"));\n            return;\n        }\n        myImage = QImage(code->width + 8, code->width + 8, QImage::Format_RGB32);\n        myImage.fill(0xffffff);\n        unsigned char *p = code->data;\n        for (int y = 0; y < code->width; y++)\n        {\n            for (int x = 0; x < code->width; x++)\n            {\n                myImage.setPixel(x + 4, y + 4, ((*p & 1) ? 0x0 : 0xffffff));\n                p++;\n            }\n        }\n        QRcode_free(code);\n\n        ui->lblQRCode->setPixmap(QPixmap::fromImage(myImage).scaled(300, 300));\n\n        ui->outUri->setPlainText(uri);\n    }\n}",
          "includes": [
            "#include <qrencode.h>",
            "#include <QUrl>",
            "#include <QPixmap>",
            "#include \"optionsmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_qrcodedialog.h\"",
            "#include \"qrcodedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::genCode()\n  {\n      QString uri = getURI();\n  \n      if (uri != \"\")\n      {\n          ui->lblQRCode->setText(\"\");\n  \n          QRcode *code = QRcode_encodeString(uri.toUtf8().constData(), 0, QR_ECLEVEL_L, QR_MODE_8, 1);\n          if (!code)\n          {\n              ui->lblQRCode->setText(tr(\"Error encoding URI into QR Code.\"));\n              return;\n          }\n          myImage = QImage(code->width + 8, code->width + 8, QImage::Format_RGB32);\n          myImage.fill(0xffffff);\n          unsigned char *p = code->data;\n          for (int y = 0; y < code->width; y++)\n          {\n              for (int x = 0; x < code->width; x++)\n              {\n                  myImage.setPixel(x + 4, y + 4, ((*p & 1) ? 0x0 : 0xffffff));\n                  p++;\n              }\n          }\n          QRcode_free(code);\n  \n          ui->lblQRCode->setPixmap(QPixmap::fromImage(myImage).scaled(300, 300));\n  \n          ui->outUri->setPlainText(uri);\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::on_lnLabel_textChanged()\n  {\n      genCode();\n  }\n}"
  },
  {
    "function_name": "on_lnReqAmount_textChanged",
    "container": "QRCodeDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
    "lines": "133-136",
    "snippet": "void QRCodeDialog::on_lnReqAmount_textChanged()\n{\n    genCode();\n}",
    "includes": [
      "#include <qrencode.h>",
      "#include <QUrl>",
      "#include <QPixmap>",
      "#include \"optionsmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_qrcodedialog.h\"",
      "#include \"qrcodedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "genCode",
          "args": [],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "genCode",
          "container": "QRCodeDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
          "lines": "51-82",
          "snippet": "void QRCodeDialog::genCode()\n{\n    QString uri = getURI();\n\n    if (uri != \"\")\n    {\n        ui->lblQRCode->setText(\"\");\n\n        QRcode *code = QRcode_encodeString(uri.toUtf8().constData(), 0, QR_ECLEVEL_L, QR_MODE_8, 1);\n        if (!code)\n        {\n            ui->lblQRCode->setText(tr(\"Error encoding URI into QR Code.\"));\n            return;\n        }\n        myImage = QImage(code->width + 8, code->width + 8, QImage::Format_RGB32);\n        myImage.fill(0xffffff);\n        unsigned char *p = code->data;\n        for (int y = 0; y < code->width; y++)\n        {\n            for (int x = 0; x < code->width; x++)\n            {\n                myImage.setPixel(x + 4, y + 4, ((*p & 1) ? 0x0 : 0xffffff));\n                p++;\n            }\n        }\n        QRcode_free(code);\n\n        ui->lblQRCode->setPixmap(QPixmap::fromImage(myImage).scaled(300, 300));\n\n        ui->outUri->setPlainText(uri);\n    }\n}",
          "includes": [
            "#include <qrencode.h>",
            "#include <QUrl>",
            "#include <QPixmap>",
            "#include \"optionsmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_qrcodedialog.h\"",
            "#include \"qrcodedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::genCode()\n  {\n      QString uri = getURI();\n  \n      if (uri != \"\")\n      {\n          ui->lblQRCode->setText(\"\");\n  \n          QRcode *code = QRcode_encodeString(uri.toUtf8().constData(), 0, QR_ECLEVEL_L, QR_MODE_8, 1);\n          if (!code)\n          {\n              ui->lblQRCode->setText(tr(\"Error encoding URI into QR Code.\"));\n              return;\n          }\n          myImage = QImage(code->width + 8, code->width + 8, QImage::Format_RGB32);\n          myImage.fill(0xffffff);\n          unsigned char *p = code->data;\n          for (int y = 0; y < code->width; y++)\n          {\n              for (int x = 0; x < code->width; x++)\n              {\n                  myImage.setPixel(x + 4, y + 4, ((*p & 1) ? 0x0 : 0xffffff));\n                  p++;\n              }\n          }\n          QRcode_free(code);\n  \n          ui->lblQRCode->setPixmap(QPixmap::fromImage(myImage).scaled(300, 300));\n  \n          ui->outUri->setPlainText(uri);\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::on_lnReqAmount_textChanged()\n  {\n      genCode();\n  }\n}"
  },
  {
    "function_name": "getURI",
    "container": "QRCodeDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
    "lines": "84-131",
    "snippet": "QString QRCodeDialog::getURI()\n{\n    QString ret = QString(\"halcyon:%1\").arg(address);\n    int paramCount = 0;\n\n    ui->outUri->clear();\n\n    if (ui->chkReqPayment->isChecked())\n    {\n        if (ui->lnReqAmount->validate())\n        {\n            // even if we allow a non BTC unit input in lnReqAmount, we generate the URI with BTC as unit (as defined in BIP21)\n            ret += QString(\"?amount=%1\").arg(BitcoinUnits::format(BitcoinUnits::BTC, ui->lnReqAmount->value()));\n            paramCount++;\n        }\n        else\n        {\n            ui->btnSaveAs->setEnabled(false);\n            ui->lblQRCode->setText(tr(\"The entered amount is invalid, please check.\"));\n            return QString(\"\");\n        }\n    }\n\n    if (!ui->lnLabel->text().isEmpty())\n    {\n        QString lbl(QUrl::toPercentEncoding(ui->lnLabel->text()));\n        ret += QString(\"%1label=%2\").arg(paramCount == 0 ? \"?\" : \"&\").arg(lbl);\n        paramCount++;\n    }\n\n    if (!ui->lnMessage->text().isEmpty())\n    {\n        QString msg(QUrl::toPercentEncoding(ui->lnMessage->text()));\n        ret += QString(\"%1message=%2\").arg(paramCount == 0 ? \"?\" : \"&\").arg(msg);\n        paramCount++;\n    }\n\n    // limit URI length to prevent a DoS against the QR-Code dialog\n    if (ret.length() > MAX_URI_LENGTH)\n    {\n        ui->btnSaveAs->setEnabled(false);\n        ui->lblQRCode->setText(tr(\"Resulting URI too long, try to reduce the text for label / message.\"));\n        return QString(\"\");\n    }\n\n    ui->btnSaveAs->setEnabled(true);\n    return ret;\n}",
    "includes": [
      "#include <qrencode.h>",
      "#include <QUrl>",
      "#include <QPixmap>",
      "#include \"optionsmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_qrcodedialog.h\"",
      "#include \"qrcodedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->btnSaveAs->setEnabled",
          "args": [
            "true"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"\""
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lblQRCode->setText",
          "args": [
            "tr(\"Resulting URI too long, try to reduce the text for label / message.\")"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Resulting URI too long, try to reduce the text for label / message.\""
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->btnSaveAs->setEnabled",
          "args": [
            "false"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ret.length",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "msg"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "paramCount == 0 ? \"?\" : \"&\""
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"%1message=%2\""
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QUrl::toPercentEncoding",
          "args": [
            "ui->lnMessage->text()"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lnMessage->text",
          "args": [],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "lbl"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "paramCount == 0 ? \"?\" : \"&\""
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"%1label=%2\""
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QUrl::toPercentEncoding",
          "args": [
            "ui->lnLabel->text()"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"\""
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->btnSaveAs->setEnabled",
          "args": [
            "false"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "BitcoinUnits::format(BitcoinUnits::BTC, ui->lnReqAmount->value())"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::format",
          "args": [
            "BitcoinUnits::BTC",
            "ui->lnReqAmount->value()"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lnReqAmount->value",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QValueComboBox",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qvaluecombobox.cpp",
          "lines": "9-12",
          "snippet": "QVariant QValueComboBox::value() const\n{\n    return itemData(currentIndex(), role);\n}",
          "includes": [
            "#include \"qvaluecombobox.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qvaluecombobox.h\"\n\nQValueComboBox {\n  QVariant QValueComboBox::value() const\n  {\n      return itemData(currentIndex(), role);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"?amount=%1\""
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lnReqAmount->validate",
          "args": [],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "validate",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "100-127",
          "snippet": "bool SendCoinsEntry::validate()\n{\n    // Check input validity\n    bool retval = true;\n\n    if(!ui->payAmount->validate())\n    {\n        retval = false;\n    }\n    else\n    {\n        if(ui->payAmount->value() <= 0)\n        {\n            // Cannot send 0 coins or less\n            ui->payAmount->setValid(false);\n            retval = false;\n        }\n    }\n\n    if(!ui->payTo->hasAcceptableInput() ||\n       (model && !model->validateAddress(ui->payTo->text())))\n    {\n        ui->payTo->setValid(false);\n        retval = false;\n    }\n\n    return retval;\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  bool SendCoinsEntry::validate()\n  {\n      // Check input validity\n      bool retval = true;\n  \n      if(!ui->payAmount->validate())\n      {\n          retval = false;\n      }\n      else\n      {\n          if(ui->payAmount->value() <= 0)\n          {\n              // Cannot send 0 coins or less\n              ui->payAmount->setValid(false);\n              retval = false;\n          }\n      }\n  \n      if(!ui->payTo->hasAcceptableInput() ||\n         (model && !model->validateAddress(ui->payTo->text())))\n      {\n          ui->payTo->setValid(false);\n          retval = false;\n      }\n  \n      return retval;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->chkReqPayment->isChecked",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->outUri->clear",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "address"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"halcyon:%1\""
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  QString QRCodeDialog::getURI()\n  {\n      QString ret = QString(\"halcyon:%1\").arg(address);\n      int paramCount = 0;\n  \n      ui->outUri->clear();\n  \n      if (ui->chkReqPayment->isChecked())\n      {\n          if (ui->lnReqAmount->validate())\n          {\n              // even if we allow a non BTC unit input in lnReqAmount, we generate the URI with BTC as unit (as defined in BIP21)\n              ret += QString(\"?amount=%1\").arg(BitcoinUnits::format(BitcoinUnits::BTC, ui->lnReqAmount->value()));\n              paramCount++;\n          }\n          else\n          {\n              ui->btnSaveAs->setEnabled(false);\n              ui->lblQRCode->setText(tr(\"The entered amount is invalid, please check.\"));\n              return QString(\"\");\n          }\n      }\n  \n      if (!ui->lnLabel->text().isEmpty())\n      {\n          QString lbl(QUrl::toPercentEncoding(ui->lnLabel->text()));\n          ret += QString(\"%1label=%2\").arg(paramCount == 0 ? \"?\" : \"&\").arg(lbl);\n          paramCount++;\n      }\n  \n      if (!ui->lnMessage->text().isEmpty())\n      {\n          QString msg(QUrl::toPercentEncoding(ui->lnMessage->text()));\n          ret += QString(\"%1message=%2\").arg(paramCount == 0 ? \"?\" : \"&\").arg(msg);\n          paramCount++;\n      }\n  \n      // limit URI length to prevent a DoS against the QR-Code dialog\n      if (ret.length() > MAX_URI_LENGTH)\n      {\n          ui->btnSaveAs->setEnabled(false);\n          ui->lblQRCode->setText(tr(\"Resulting URI too long, try to reduce the text for label / message.\"));\n          return QString(\"\");\n      }\n  \n      ui->btnSaveAs->setEnabled(true);\n      return ret;\n  }\n}"
  },
  {
    "function_name": "genCode",
    "container": "QRCodeDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
    "lines": "51-82",
    "snippet": "void QRCodeDialog::genCode()\n{\n    QString uri = getURI();\n\n    if (uri != \"\")\n    {\n        ui->lblQRCode->setText(\"\");\n\n        QRcode *code = QRcode_encodeString(uri.toUtf8().constData(), 0, QR_ECLEVEL_L, QR_MODE_8, 1);\n        if (!code)\n        {\n            ui->lblQRCode->setText(tr(\"Error encoding URI into QR Code.\"));\n            return;\n        }\n        myImage = QImage(code->width + 8, code->width + 8, QImage::Format_RGB32);\n        myImage.fill(0xffffff);\n        unsigned char *p = code->data;\n        for (int y = 0; y < code->width; y++)\n        {\n            for (int x = 0; x < code->width; x++)\n            {\n                myImage.setPixel(x + 4, y + 4, ((*p & 1) ? 0x0 : 0xffffff));\n                p++;\n            }\n        }\n        QRcode_free(code);\n\n        ui->lblQRCode->setPixmap(QPixmap::fromImage(myImage).scaled(300, 300));\n\n        ui->outUri->setPlainText(uri);\n    }\n}",
    "includes": [
      "#include <qrencode.h>",
      "#include <QUrl>",
      "#include <QPixmap>",
      "#include \"optionsmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_qrcodedialog.h\"",
      "#include \"qrcodedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->outUri->setPlainText",
          "args": [
            "uri"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lblQRCode->setPixmap",
          "args": [
            "QPixmap::fromImage(myImage).scaled(300, 300)"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QPixmap::fromImage",
          "args": [
            "300",
            "300"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QPixmap::fromImage",
          "args": [
            "myImage"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QRcode_free",
          "args": [
            "code"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "myImage.setPixel",
          "args": [
            "x + 4",
            "y + 4",
            "((*p & 1) ? 0x0 : 0xffffff)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "myImage.fill",
          "args": [
            "0xffffff"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QImage",
          "args": [
            "code->width + 8",
            "code->width + 8",
            "QImage::Format_RGB32"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lblQRCode->setText",
          "args": [
            "tr(\"Error encoding URI into QR Code.\")"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Error encoding URI into QR Code.\""
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QRcode_encodeString",
          "args": [
            "uri.toUtf8().constData()",
            "0",
            "QR_ECLEVEL_L",
            "QR_MODE_8",
            "1"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.toUtf8",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.toUtf8",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getURI",
          "args": [],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "getURI",
          "container": "QRCodeDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
          "lines": "84-131",
          "snippet": "QString QRCodeDialog::getURI()\n{\n    QString ret = QString(\"halcyon:%1\").arg(address);\n    int paramCount = 0;\n\n    ui->outUri->clear();\n\n    if (ui->chkReqPayment->isChecked())\n    {\n        if (ui->lnReqAmount->validate())\n        {\n            // even if we allow a non BTC unit input in lnReqAmount, we generate the URI with BTC as unit (as defined in BIP21)\n            ret += QString(\"?amount=%1\").arg(BitcoinUnits::format(BitcoinUnits::BTC, ui->lnReqAmount->value()));\n            paramCount++;\n        }\n        else\n        {\n            ui->btnSaveAs->setEnabled(false);\n            ui->lblQRCode->setText(tr(\"The entered amount is invalid, please check.\"));\n            return QString(\"\");\n        }\n    }\n\n    if (!ui->lnLabel->text().isEmpty())\n    {\n        QString lbl(QUrl::toPercentEncoding(ui->lnLabel->text()));\n        ret += QString(\"%1label=%2\").arg(paramCount == 0 ? \"?\" : \"&\").arg(lbl);\n        paramCount++;\n    }\n\n    if (!ui->lnMessage->text().isEmpty())\n    {\n        QString msg(QUrl::toPercentEncoding(ui->lnMessage->text()));\n        ret += QString(\"%1message=%2\").arg(paramCount == 0 ? \"?\" : \"&\").arg(msg);\n        paramCount++;\n    }\n\n    // limit URI length to prevent a DoS against the QR-Code dialog\n    if (ret.length() > MAX_URI_LENGTH)\n    {\n        ui->btnSaveAs->setEnabled(false);\n        ui->lblQRCode->setText(tr(\"Resulting URI too long, try to reduce the text for label / message.\"));\n        return QString(\"\");\n    }\n\n    ui->btnSaveAs->setEnabled(true);\n    return ret;\n}",
          "includes": [
            "#include <qrencode.h>",
            "#include <QUrl>",
            "#include <QPixmap>",
            "#include \"optionsmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_qrcodedialog.h\"",
            "#include \"qrcodedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  QString QRCodeDialog::getURI()\n  {\n      QString ret = QString(\"halcyon:%1\").arg(address);\n      int paramCount = 0;\n  \n      ui->outUri->clear();\n  \n      if (ui->chkReqPayment->isChecked())\n      {\n          if (ui->lnReqAmount->validate())\n          {\n              // even if we allow a non BTC unit input in lnReqAmount, we generate the URI with BTC as unit (as defined in BIP21)\n              ret += QString(\"?amount=%1\").arg(BitcoinUnits::format(BitcoinUnits::BTC, ui->lnReqAmount->value()));\n              paramCount++;\n          }\n          else\n          {\n              ui->btnSaveAs->setEnabled(false);\n              ui->lblQRCode->setText(tr(\"The entered amount is invalid, please check.\"));\n              return QString(\"\");\n          }\n      }\n  \n      if (!ui->lnLabel->text().isEmpty())\n      {\n          QString lbl(QUrl::toPercentEncoding(ui->lnLabel->text()));\n          ret += QString(\"%1label=%2\").arg(paramCount == 0 ? \"?\" : \"&\").arg(lbl);\n          paramCount++;\n      }\n  \n      if (!ui->lnMessage->text().isEmpty())\n      {\n          QString msg(QUrl::toPercentEncoding(ui->lnMessage->text()));\n          ret += QString(\"%1message=%2\").arg(paramCount == 0 ? \"?\" : \"&\").arg(msg);\n          paramCount++;\n      }\n  \n      // limit URI length to prevent a DoS against the QR-Code dialog\n      if (ret.length() > MAX_URI_LENGTH)\n      {\n          ui->btnSaveAs->setEnabled(false);\n          ui->lblQRCode->setText(tr(\"Resulting URI too long, try to reduce the text for label / message.\"));\n          return QString(\"\");\n      }\n  \n      ui->btnSaveAs->setEnabled(true);\n      return ret;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::genCode()\n  {\n      QString uri = getURI();\n  \n      if (uri != \"\")\n      {\n          ui->lblQRCode->setText(\"\");\n  \n          QRcode *code = QRcode_encodeString(uri.toUtf8().constData(), 0, QR_ECLEVEL_L, QR_MODE_8, 1);\n          if (!code)\n          {\n              ui->lblQRCode->setText(tr(\"Error encoding URI into QR Code.\"));\n              return;\n          }\n          myImage = QImage(code->width + 8, code->width + 8, QImage::Format_RGB32);\n          myImage.fill(0xffffff);\n          unsigned char *p = code->data;\n          for (int y = 0; y < code->width; y++)\n          {\n              for (int x = 0; x < code->width; x++)\n              {\n                  myImage.setPixel(x + 4, y + 4, ((*p & 1) ? 0x0 : 0xffffff));\n                  p++;\n              }\n          }\n          QRcode_free(code);\n  \n          ui->lblQRCode->setPixmap(QPixmap::fromImage(myImage).scaled(300, 300));\n  \n          ui->outUri->setPlainText(uri);\n      }\n  }\n}"
  },
  {
    "function_name": "setModel",
    "container": "QRCodeDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
    "lines": "40-49",
    "snippet": "void QRCodeDialog::setModel(OptionsModel *model)\n{\n    this->model = model;\n\n    if (model)\n        connect(model, SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n\n    // update the display unit, to not use the default (\"BTC\")\n    updateDisplayUnit();\n}",
    "includes": [
      "#include <qrencode.h>",
      "#include <QUrl>",
      "#include <QPixmap>",
      "#include \"optionsmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_qrcodedialog.h\"",
      "#include \"qrcodedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "updateDisplayUnit",
          "args": [],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "updateDisplayUnit",
          "container": "QRCodeDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
          "lines": "164-171",
          "snippet": "void QRCodeDialog::updateDisplayUnit()\n{\n    if (model)\n    {\n        // Update lnReqAmount with the current unit\n        ui->lnReqAmount->setDisplayUnit(model->getDisplayUnit());\n    }\n}",
          "includes": [
            "#include <qrencode.h>",
            "#include <QUrl>",
            "#include <QPixmap>",
            "#include \"optionsmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_qrcodedialog.h\"",
            "#include \"qrcodedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::updateDisplayUnit()\n  {\n      if (model)\n      {\n          // Update lnReqAmount with the current unit\n          ui->lnReqAmount->setDisplayUnit(model->getDisplayUnit());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "model",
            "SIGNAL(displayUnitChanged(int))",
            "this",
            "SLOT(updateDisplayUnit())"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "updateDisplayUnit()"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "displayUnitChanged(int)"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "displayUnitChanged",
          "args": [
            "int"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::setModel(OptionsModel *model)\n  {\n      this->model = model;\n  \n      if (model)\n          connect(model, SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n  \n      // update the display unit, to not use the default (\"BTC\")\n      updateDisplayUnit();\n  }\n}"
  },
  {
    "function_name": "~QRCodeDialog",
    "container": "QRCodeDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
    "lines": "35-38",
    "snippet": "QRCodeDialog::~QRCodeDialog()\n{\n    delete ui;\n}",
    "includes": [
      "#include <qrencode.h>",
      "#include <QUrl>",
      "#include <QPixmap>",
      "#include \"optionsmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_qrcodedialog.h\"",
      "#include \"qrcodedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  QRCodeDialog::~QRCodeDialog()\n  {\n      delete ui;\n  }\n}"
  },
  {
    "function_name": "QRCodeDialog",
    "container": "QRCodeDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
    "lines": "14-33",
    "snippet": "QRCodeDialog::QRCodeDialog(const QString &addr, const QString &label, bool enableReq, QWidget *parent) :\n    QDialog(parent),\n    ui(new Ui::QRCodeDialog),\n    model(0),\n    address(addr)\n{\n    ui->setupUi(this);\n\n    setWindowTitle(QString(\"%1\").arg(address));\n\n    ui->chkReqPayment->setVisible(enableReq);\n    ui->lblAmount->setVisible(enableReq);\n    ui->lnReqAmount->setVisible(enableReq);\n\n    ui->lnLabel->setText(label);\n\n    ui->btnSaveAs->setEnabled(false);\n\n    genCode();\n}",
    "includes": [
      "#include <qrencode.h>",
      "#include <QUrl>",
      "#include <QPixmap>",
      "#include \"optionsmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"guiconstants.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_qrcodedialog.h\"",
      "#include \"qrcodedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "genCode",
          "args": [],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "genCode",
          "container": "QRCodeDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
          "lines": "51-82",
          "snippet": "void QRCodeDialog::genCode()\n{\n    QString uri = getURI();\n\n    if (uri != \"\")\n    {\n        ui->lblQRCode->setText(\"\");\n\n        QRcode *code = QRcode_encodeString(uri.toUtf8().constData(), 0, QR_ECLEVEL_L, QR_MODE_8, 1);\n        if (!code)\n        {\n            ui->lblQRCode->setText(tr(\"Error encoding URI into QR Code.\"));\n            return;\n        }\n        myImage = QImage(code->width + 8, code->width + 8, QImage::Format_RGB32);\n        myImage.fill(0xffffff);\n        unsigned char *p = code->data;\n        for (int y = 0; y < code->width; y++)\n        {\n            for (int x = 0; x < code->width; x++)\n            {\n                myImage.setPixel(x + 4, y + 4, ((*p & 1) ? 0x0 : 0xffffff));\n                p++;\n            }\n        }\n        QRcode_free(code);\n\n        ui->lblQRCode->setPixmap(QPixmap::fromImage(myImage).scaled(300, 300));\n\n        ui->outUri->setPlainText(uri);\n    }\n}",
          "includes": [
            "#include <qrencode.h>",
            "#include <QUrl>",
            "#include <QPixmap>",
            "#include \"optionsmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_qrcodedialog.h\"",
            "#include \"qrcodedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::genCode()\n  {\n      QString uri = getURI();\n  \n      if (uri != \"\")\n      {\n          ui->lblQRCode->setText(\"\");\n  \n          QRcode *code = QRcode_encodeString(uri.toUtf8().constData(), 0, QR_ECLEVEL_L, QR_MODE_8, 1);\n          if (!code)\n          {\n              ui->lblQRCode->setText(tr(\"Error encoding URI into QR Code.\"));\n              return;\n          }\n          myImage = QImage(code->width + 8, code->width + 8, QImage::Format_RGB32);\n          myImage.fill(0xffffff);\n          unsigned char *p = code->data;\n          for (int y = 0; y < code->width; y++)\n          {\n              for (int x = 0; x < code->width; x++)\n              {\n                  myImage.setPixel(x + 4, y + 4, ((*p & 1) ? 0x0 : 0xffffff));\n                  p++;\n              }\n          }\n          QRcode_free(code);\n  \n          ui->lblQRCode->setPixmap(QPixmap::fromImage(myImage).scaled(300, 300));\n  \n          ui->outUri->setPlainText(uri);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->btnSaveAs->setEnabled",
          "args": [
            "false"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lnLabel->setText",
          "args": [
            "label"
          ],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->lnReqAmount->setVisible",
          "args": [
            "enableReq"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lblAmount->setVisible",
          "args": [
            "enableReq"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->chkReqPayment->setVisible",
          "args": [
            "enableReq"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setWindowTitle",
          "args": [
            "QString(\"%1\").arg(address)"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "address"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"%1\""
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->setupUi",
          "args": [
            "this"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  QRCodeDialog::QRCodeDialog(const QString &addr, const QString &label, bool enableReq, QWidget *parent) :\n      QDialog(parent),\n      ui(new Ui::QRCodeDialog),\n      model(0),\n      address(addr)\n  {\n      ui->setupUi(this);\n  \n      setWindowTitle(QString(\"%1\").arg(address));\n  \n      ui->chkReqPayment->setVisible(enableReq);\n      ui->lblAmount->setVisible(enableReq);\n      ui->lnReqAmount->setVisible(enableReq);\n  \n      ui->lnLabel->setText(label);\n  \n      ui->btnSaveAs->setEnabled(false);\n  \n      genCode();\n  }\n}"
  }
]