[
  {
    "function_name": "NewThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1350-1360",
    "snippet": "bool NewThread(void(*pfn)(void*), void* parg)\n{\n    try\n    {\n        boost::thread(pfn, parg); // thread detaches when out of scope\n    } catch(boost::thread_resource_error &e) {\n        printf(\"Error creating thread: %s\\n\", e.what());\n        return false;\n    }\n    return true;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Error creating thread: %s\\n\"",
            "e.what()"
          ],
          "line": 1356
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 1356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::thread",
          "args": [
            "pfn",
            "parg"
          ],
          "line": 1354
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool NewThread(void(*pfn)(void*), void* parg)\n{\n    try\n    {\n        boost::thread(pfn, parg); // thread detaches when out of scope\n    } catch(boost::thread_resource_error &e) {\n        printf(\"Error creating thread: %s\\n\", e.what());\n        return false;\n    }\n    return true;\n}"
  },
  {
    "function_name": "RenameThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1329-1348",
    "snippet": "void RenameThread(const char* name)\n{\n#if defined(PR_SET_NAME)\n    // Only the first 15 characters are used (16 - NUL terminator)\n    ::prctl(PR_SET_NAME, name, 0, 0, 0);\n#elif 0 && (defined(__FreeBSD__) || defined(__OpenBSD__))\n    // TODO: This is currently disabled because it needs to be verified to work\n    //       on FreeBSD or OpenBSD first. When verified the '0 &&' part can be\n    //       removed.\n    pthread_set_name_np(pthread_self(), name);\n\n// This is XCode 10.6-and-later; bring back if we drop 10.5 support:\n// #elif defined(MAC_OSX)\n//    pthread_setname_np(name);\n\n#else\n    // Prevent warnings for unused parameters...\n    (void)name;\n#endif\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_set_name_np",
          "args": [
            "pthread_self()",
            "name"
          ],
          "line": 1338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_self",
          "args": [],
          "line": 1338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::prctl",
          "args": [
            "PR_SET_NAME",
            "name",
            "0",
            "0",
            "0"
          ],
          "line": 1333
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvoid RenameThread(const char* name)\n{\n#if defined(PR_SET_NAME)\n    // Only the first 15 characters are used (16 - NUL terminator)\n    ::prctl(PR_SET_NAME, name, 0, 0, 0);\n#elif 0 && (defined(__FreeBSD__) || defined(__OpenBSD__))\n    // TODO: This is currently disabled because it needs to be verified to work\n    //       on FreeBSD or OpenBSD first. When verified the '0 &&' part can be\n    //       removed.\n    pthread_set_name_np(pthread_self(), name);\n\n// This is XCode 10.6-and-later; bring back if we drop 10.5 support:\n// #elif defined(MAC_OSX)\n//    pthread_setname_np(name);\n\n#else\n    // Prevent warnings for unused parameters...\n    (void)name;\n#endif\n}"
  },
  {
    "function_name": "runCommand",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1322-1327",
    "snippet": "void runCommand(std::string strCommand)\n{\n    int nErr = ::system(strCommand.c_str());\n    if (nErr)\n        printf(\"runCommand error: system(%s) returned %d\\n\", strCommand.c_str(), nErr);\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"runCommand error: system(%s) returned %d\\n\"",
            "strCommand.c_str()",
            "nErr"
          ],
          "line": 1326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strCommand.c_str",
          "args": [],
          "line": 1326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::system",
          "args": [
            "strCommand.c_str()"
          ],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strCommand.c_str",
          "args": [],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvoid runCommand(std::string strCommand)\n{\n    int nErr = ::system(strCommand.c_str());\n    if (nErr)\n        printf(\"runCommand error: system(%s) returned %d\\n\", strCommand.c_str(), nErr);\n}"
  },
  {
    "function_name": "GetSpecialFolderPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1306-1319",
    "snippet": "boost::filesystem::path GetSpecialFolderPath(int nFolder, bool fCreate)\n{\n    namespace fs = boost::filesystem;\n\n    char pszPath[MAX_PATH] = \"\";\n\n    if(SHGetSpecialFolderPathA(NULL, pszPath, nFolder, fCreate))\n    {\n        return fs::path(pszPath);\n    }\n\n    printf(\"SHGetSpecialFolderPathA() failed, could not obtain requested path.\\n\");\n    return fs::path(\"\");\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs::path",
          "args": [
            "\"\""
          ],
          "line": 1318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"SHGetSpecialFolderPathA() failed, could not obtain requested path.\\n\""
          ],
          "line": 1317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs::path",
          "args": [
            "pszPath"
          ],
          "line": 1314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHGetSpecialFolderPathA",
          "args": [
            "NULL",
            "pszPath",
            "nFolder",
            "fCreate"
          ],
          "line": 1312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nboost::filesystem::path GetSpecialFolderPath(int nFolder, bool fCreate)\n{\n    namespace fs = boost::filesystem;\n\n    char pszPath[MAX_PATH] = \"\";\n\n    if(SHGetSpecialFolderPathA(NULL, pszPath, nFolder, fCreate))\n    {\n        return fs::path(pszPath);\n    }\n\n    printf(\"SHGetSpecialFolderPathA() failed, could not obtain requested path.\\n\");\n    return fs::path(\"\");\n}"
  },
  {
    "function_name": "FormatSubVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1294-1303",
    "snippet": "std::string FormatSubVersion(const std::string& name, uint nClientVersion,\n  const std::vector<std::string>& comments) {\n    std::ostringstream ss;\n    ss << \"/\";\n    ss << name << \":\" << FormatVersion(nClientVersion);\n    if (!comments.empty())\n        ss << \"(\" << boost::algorithm::join(comments, \"; \") << \")\";\n    ss << \"/\";\n    return ss.str();\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ss.str",
          "args": [],
          "line": 1302
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "789-792",
          "snippet": "std::string str() const\n    {\n        return (std::string(begin(), end()));\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  std::string str() const\n      {\n          return (std::string(begin(), end()));\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "boost::algorithm::join",
          "args": [
            "comments",
            "\"; \""
          ],
          "line": 1300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "comments.empty",
          "args": [],
          "line": 1299
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FormatVersion",
          "args": [
            "nClientVersion"
          ],
          "line": 1298
        },
        "resolved": true,
        "details": {
          "function_name": "FormatVersion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1283-1286",
          "snippet": "string FormatVersion(uint nVersion) {\n    return(strprintf(\"%d.%d.%d.%d\", nVersion / 1000000, (nVersion / 10000) % 100,\n      (nVersion / 100) % 100, nVersion % 100));\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring FormatVersion(uint nVersion) {\n    return(strprintf(\"%d.%d.%d.%d\", nVersion / 1000000, (nVersion / 10000) % 100,\n      (nVersion / 100) % 100, nVersion % 100));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstd::string FormatSubVersion(const std::string& name, uint nClientVersion,\n  const std::vector<std::string>& comments) {\n    std::ostringstream ss;\n    ss << \"/\";\n    ss << name << \":\" << FormatVersion(nClientVersion);\n    if (!comments.empty())\n        ss << \"(\" << boost::algorithm::join(comments, \"; \") << \")\";\n    ss << \"/\";\n    return ss.str();\n}"
  },
  {
    "function_name": "FormatFullVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1288-1291",
    "snippet": "string FormatFullVersion()\n{\n    return CLIENT_BUILD;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring FormatFullVersion()\n{\n    return CLIENT_BUILD;\n}"
  },
  {
    "function_name": "FormatVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1283-1286",
    "snippet": "string FormatVersion(uint nVersion) {\n    return(strprintf(\"%d.%d.%d.%d\", nVersion / 1000000, (nVersion / 10000) % 100,\n      (nVersion / 100) % 100, nVersion % 100));\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"%d.%d.%d.%d\"",
            "nVersion / 1000000",
            "(nVersion / 10000) % 100",
            "(nVersion / 100) % 100",
            "nVersion % 100"
          ],
          "line": 1284
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring FormatVersion(uint nVersion) {\n    return(strprintf(\"%d.%d.%d.%d\", nVersion / 1000000, (nVersion / 10000) % 100,\n      (nVersion / 100) % 100, nVersion % 100));\n}"
  },
  {
    "function_name": "AddTimeData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1219-1274",
    "snippet": "void AddTimeData(const CNetAddr& ip, int64_t nTime)\n{\n    int64_t nOffsetSample = nTime - GetTime();\n\n    // Ignore duplicates\n    static set<CNetAddr> setKnown;\n    if (!setKnown.insert(ip).second)\n        return;\n\n    // Add data\n    vTimeOffsets.input(nOffsetSample);\n    printf(\"Added time data, samples %d, offset %+\"PRId64\" (%+\"PRId64\" minutes)\\n\", vTimeOffsets.size(), nOffsetSample, nOffsetSample/60);\n    if (vTimeOffsets.size() >= 5 && vTimeOffsets.size() % 2 == 1)\n    {\n        int64_t nMedian = vTimeOffsets.median();\n        std::vector<int64_t> vSorted = vTimeOffsets.sorted();\n\n        // Only let other nodes change our time by so much\n        if(abs64(nMedian) < 60 * 60) {\n            nPeersOffset = nMedian;\n        } else {\n            nPeersOffset = INT64_MAX;\n        }\n\n            {\n                // If nobody has a time different than ours but within 5 minutes of ours, give a warning\n                bool fMatch = false;\n                BOOST_FOREACH(int64 nOffset, vSorted)\n                    if (nOffset != 0 && abs64(nOffset) < 5 * 60)\n                        fMatch = true;\n\n                if(!fMatch && !fPeersWarning) {\n                    fPeersWarning = true;\n                    string strMessage = _(\"Warning: Please check your date and time! Halcyon will not work properly if they are incorrect.\");\n                    strMiscWarning = strMessage;\n                    printf(\"*** %s\\n\", strMessage.c_str());\n                    uiInterface.ThreadSafeMessageBox(strMessage+\" \", string(\"Halcyon\"),\n                      CClientUIInterface::OK | CClientUIInterface::ICON_EXCLAMATION);\n                }\n\n                if(fMatch && fPeersWarning) {\n                    strMiscWarning.clear();\n                    fPeersWarning = false;\n                }\n            }\n\n        if (fDebug) {\n            BOOST_FOREACH(int64 n, vSorted)\n              printf(\"%+\" PRI64d \"  \", n);\n            printf(\"|  \");\n        }\n\n        if(nPeersOffset != INT64_MAX)\n          printf(\"nPeersOffset = %+\" PRI64d \" seconds\\n\", nPeersOffset);\n    }\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "bool fDebug = false;",
      "string strMiscWarning;",
      "CMedianFilter<int64_t> vTimeOffsets(200,0);",
      "int64 nPeersOffset = INT64_MAX;",
      "bool fPeersWarning = false;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"nPeersOffset = %+\" PRI64d \" seconds\\n\"",
            "nPeersOffset"
          ],
          "line": 1272
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"|  \""
          ],
          "line": 1268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strMiscWarning.clear",
          "args": [],
          "line": 1260
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "uiInterface.ThreadSafeMessageBox",
          "args": [
            "strMessage+\" \"",
            "string(\"Halcyon\")",
            "CClientUIInterface::OK | CClientUIInterface::ICON_EXCLAMATION"
          ],
          "line": 1255
        },
        "resolved": true,
        "details": {
          "function_name": "ThreadSafeMessageBox",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoin.cpp",
          "lines": "38-56",
          "snippet": "static void ThreadSafeMessageBox(const std::string& message, const std::string& caption, int style)\n{\n    // Message from network thread\n    if(guiref)\n    {\n        bool modal = (style & CClientUIInterface::MODAL);\n        // in case of modal message, use blocking connection to wait for user to click OK\n        QMetaObject::invokeMethod(guiref, \"error\",\n                                   modal ? GUIUtil::blockingGUIThreadConnection() : Qt::QueuedConnection,\n                                   Q_ARG(QString, QString::fromStdString(caption)),\n                                   Q_ARG(QString, QString::fromStdString(message)),\n                                   Q_ARG(bool, modal));\n    }\n    else\n    {\n        printf(\"%s: %s\\n\", caption.c_str(), message.c_str());\n        fprintf(stderr, \"%s: %s\\n\", caption.c_str(), message.c_str());\n    }\n}",
          "includes": [
            "#include <QtPlugin>",
            "#include <QLibraryInfo>",
            "#include <QSplashScreen>",
            "#include <QTranslator>",
            "#include <QLocale>",
            "#include <QTextCodec>",
            "#include <QMessageBox>",
            "#include <QApplication>",
            "#include \"qtipcserver.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"guiconstants.h\"",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"clientmodel.h\"",
            "#include \"bitcoingui.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static BitcoinGUI *guiref;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <QtPlugin>\n#include <QLibraryInfo>\n#include <QSplashScreen>\n#include <QTranslator>\n#include <QLocale>\n#include <QTextCodec>\n#include <QMessageBox>\n#include <QApplication>\n#include \"qtipcserver.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"clientmodel.h\"\n#include \"bitcoingui.h\"\n\nstatic BitcoinGUI *guiref;\n\nstatic void ThreadSafeMessageBox(const std::string& message, const std::string& caption, int style)\n{\n    // Message from network thread\n    if(guiref)\n    {\n        bool modal = (style & CClientUIInterface::MODAL);\n        // in case of modal message, use blocking connection to wait for user to click OK\n        QMetaObject::invokeMethod(guiref, \"error\",\n                                   modal ? GUIUtil::blockingGUIThreadConnection() : Qt::QueuedConnection,\n                                   Q_ARG(QString, QString::fromStdString(caption)),\n                                   Q_ARG(QString, QString::fromStdString(message)),\n                                   Q_ARG(bool, modal));\n    }\n    else\n    {\n        printf(\"%s: %s\\n\", caption.c_str(), message.c_str());\n        fprintf(stderr, \"%s: %s\\n\", caption.c_str(), message.c_str());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "string",
          "args": [
            "\"Halcyon\""
          ],
          "line": 1255
        },
        "resolved": true,
        "details": {
          "function_name": "non_printable_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "29-41",
          "snippet": "String_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "strMessage.c_str",
          "args": [],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Warning: Please check your date and time! Halcyon will not work properly if they are incorrect.\""
          ],
          "line": 1252
        },
        "resolved": true,
        "details": {
          "function_name": "key_error",
          "container": "key_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "44-44",
          "snippet": "explicit key_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nkey_error {\n  explicit key_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "abs64",
          "args": [
            "nOffset"
          ],
          "line": 1247
        },
        "resolved": true,
        "details": {
          "function_name": "abs64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "307-310",
          "snippet": "inline int64_t abs64(int64_t n)\n{\n    return (n >= 0 ? n : -n);\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t abs64(int64_t n)\n{\n    return (n >= 0 ? n : -n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vTimeOffsets.sorted",
          "args": [],
          "line": 1234
        },
        "resolved": true,
        "details": {
          "function_name": "sorted",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "628-631",
          "snippet": "std::vector<T> sorted () const\n    {\n        return vSorted;\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  std::vector<T> sorted () const\n      {\n          return vSorted;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vTimeOffsets.median",
          "args": [],
          "line": 1233
        },
        "resolved": true,
        "details": {
          "function_name": "median",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "609-621",
          "snippet": "T median() const\n    {\n        int size = vSorted.size();\n        assert(size>0);\n        if(size & 1) // Odd number of elements\n        {\n            return vSorted[size/2];\n        }\n        else // Even number of elements\n        {\n            return (vSorted[size/2-1] + vSorted[size/2]) / 2;\n        }\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  T median() const\n      {\n          int size = vSorted.size();\n          assert(size>0);\n          if(size & 1) // Odd number of elements\n          {\n              return vSorted[size/2];\n          }\n          else // Even number of elements\n          {\n              return (vSorted[size/2-1] + vSorted[size/2]) / 2;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vTimeOffsets.size",
          "args": [],
          "line": 1231
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "623-626",
          "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  int size() const\n      {\n          return vValues.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Added time data, samples %d, offset %+\"PRId64\" (%+\"PRId64\" minutes)\\n\"",
            "vTimeOffsets.size()",
            "nOffsetSample",
            "nOffsetSample/60"
          ],
          "line": 1230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vTimeOffsets.input",
          "args": [
            "nOffsetSample"
          ],
          "line": 1229
        },
        "resolved": true,
        "details": {
          "function_name": "input",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "596-607",
          "snippet": "void input(T value)\n    {\n        if(vValues.size() == nSize)\n        {\n            vValues.erase(vValues.begin());\n        }\n        vValues.push_back(value);\n\n        vSorted.resize(vValues.size());\n        std::copy(vValues.begin(), vValues.end(), vSorted.begin());\n        std::sort(vSorted.begin(), vSorted.end());\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  void input(T value)\n      {\n          if(vValues.size() == nSize)\n          {\n              vValues.erase(vValues.begin());\n          }\n          vValues.push_back(value);\n  \n          vSorted.resize(vValues.size());\n          std::copy(vValues.begin(), vValues.end(), vSorted.begin());\n          std::sort(vSorted.begin(), vSorted.end());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setKnown.insert",
          "args": [
            "ip"
          ],
          "line": 1225
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "61-65",
          "snippet": "void CBloomFilter::insert(const uint256& hash)\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    insert(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  void CBloomFilter::insert(const uint256& hash)\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      insert(data);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetTime",
          "args": [],
          "line": 1221
        },
        "resolved": true,
        "details": {
          "function_name": "GetTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1182-1187",
          "snippet": "int64_t GetTime()\n{\n    if (nMockTime) return nMockTime;\n\n    return time(NULL);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int64_t nMockTime = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic int64_t nMockTime = 0;\n\nint64_t GetTime()\n{\n    if (nMockTime) return nMockTime;\n\n    return time(NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool fDebug = false;\nstring strMiscWarning;\nCMedianFilter<int64_t> vTimeOffsets(200,0);\nint64 nPeersOffset = INT64_MAX;\nbool fPeersWarning = false;\n\nvoid AddTimeData(const CNetAddr& ip, int64_t nTime)\n{\n    int64_t nOffsetSample = nTime - GetTime();\n\n    // Ignore duplicates\n    static set<CNetAddr> setKnown;\n    if (!setKnown.insert(ip).second)\n        return;\n\n    // Add data\n    vTimeOffsets.input(nOffsetSample);\n    printf(\"Added time data, samples %d, offset %+\"PRId64\" (%+\"PRId64\" minutes)\\n\", vTimeOffsets.size(), nOffsetSample, nOffsetSample/60);\n    if (vTimeOffsets.size() >= 5 && vTimeOffsets.size() % 2 == 1)\n    {\n        int64_t nMedian = vTimeOffsets.median();\n        std::vector<int64_t> vSorted = vTimeOffsets.sorted();\n\n        // Only let other nodes change our time by so much\n        if(abs64(nMedian) < 60 * 60) {\n            nPeersOffset = nMedian;\n        } else {\n            nPeersOffset = INT64_MAX;\n        }\n\n            {\n                // If nobody has a time different than ours but within 5 minutes of ours, give a warning\n                bool fMatch = false;\n                BOOST_FOREACH(int64 nOffset, vSorted)\n                    if (nOffset != 0 && abs64(nOffset) < 5 * 60)\n                        fMatch = true;\n\n                if(!fMatch && !fPeersWarning) {\n                    fPeersWarning = true;\n                    string strMessage = _(\"Warning: Please check your date and time! Halcyon will not work properly if they are incorrect.\");\n                    strMiscWarning = strMessage;\n                    printf(\"*** %s\\n\", strMessage.c_str());\n                    uiInterface.ThreadSafeMessageBox(strMessage+\" \", string(\"Halcyon\"),\n                      CClientUIInterface::OK | CClientUIInterface::ICON_EXCLAMATION);\n                }\n\n                if(fMatch && fPeersWarning) {\n                    strMiscWarning.clear();\n                    fPeersWarning = false;\n                }\n            }\n\n        if (fDebug) {\n            BOOST_FOREACH(int64 n, vSorted)\n              printf(\"%+\" PRI64d \"  \", n);\n            printf(\"|  \");\n        }\n\n        if(nPeersOffset != INT64_MAX)\n          printf(\"nPeersOffset = %+\" PRI64d \" seconds\\n\", nPeersOffset);\n    }\n}"
  },
  {
    "function_name": "GetAdjustedTime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1201-1214",
    "snippet": "int64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "extern int64 nNtpOffset;",
      "int64 nPeersOffset = INT64_MAX;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "abs64",
          "args": [
            "nPeersOffset"
          ],
          "line": 1210
        },
        "resolved": true,
        "details": {
          "function_name": "abs64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "307-310",
          "snippet": "inline int64_t abs64(int64_t n)\n{\n    return (n >= 0 ? n : -n);\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t abs64(int64_t n)\n{\n    return (n >= 0 ? n : -n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetTime",
          "args": [],
          "line": 1203
        },
        "resolved": true,
        "details": {
          "function_name": "GetTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1182-1187",
          "snippet": "int64_t GetTime()\n{\n    if (nMockTime) return nMockTime;\n\n    return time(NULL);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int64_t nMockTime = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic int64_t nMockTime = 0;\n\nint64_t GetTime()\n{\n    if (nMockTime) return nMockTime;\n\n    return time(NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nextern int64 nNtpOffset;\nint64 nPeersOffset = INT64_MAX;\n\nint64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}"
  },
  {
    "function_name": "SetMockTime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1189-1192",
    "snippet": "void SetMockTime(int64_t nMockTimeIn)\n{\n    nMockTime = nMockTimeIn;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int64_t nMockTime = 0;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic int64_t nMockTime = 0;\n\nvoid SetMockTime(int64_t nMockTimeIn)\n{\n    nMockTime = nMockTimeIn;\n}"
  },
  {
    "function_name": "GetTime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1182-1187",
    "snippet": "int64_t GetTime()\n{\n    if (nMockTime) return nMockTime;\n\n    return time(NULL);\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int64_t nMockTime = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "time",
          "args": [
            "NULL"
          ],
          "line": 1186
        },
        "resolved": true,
        "details": {
          "function_name": "pt_to_time_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/rpcdump.cpp",
          "lines": "38-43",
          "snippet": "std::time_t pt_to_time_t(const bt::ptime& pt)\n{\n    bt::ptime timet_start(boost::gregorian::date(1970,1,1));\n    bt::time_duration diff = pt - timet_start;\n    return diff.ticks()/bt::time_duration::rep_type::ticks_per_second;\n}",
          "includes": [
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/variant/get.hpp>",
            "#include <boost/date_time/posix_time/posix_time.hpp>",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"init.h\" // for pwalletMain",
            "#include <fstream>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string.hpp>\n#include <boost/variant/get.hpp>\n#include <boost/date_time/posix_time/posix_time.hpp>\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"bitcoinrpc.h\"\n#include \"init.h\" // for pwalletMain\n#include <fstream>\n#include <iostream>\n\nstd::time_t pt_to_time_t(const bt::ptime& pt)\n{\n    bt::ptime timet_start(boost::gregorian::date(1970,1,1));\n    bt::time_duration diff = pt - timet_start;\n    return diff.ticks()/bt::time_duration::rep_type::ticks_per_second;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic int64_t nMockTime = 0;\n\nint64_t GetTime()\n{\n    if (nMockTime) return nMockTime;\n\n    return time(NULL);\n}"
  },
  {
    "function_name": "ShrinkDebugFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1151-1171",
    "snippet": "void ShrinkDebugFile()\n{\n    // Scroll debug.log if it's getting too big\n    boost::filesystem::path pathLog = GetDataDir() / \"debug.log\";\n    FILE* file = fopen(pathLog.string().c_str(), \"r\");\n    if (file && boost::filesystem::file_size(pathLog) > 10 * 1000000)\n    {\n        // Restart the file with some of the end\n        char pch[200000];\n        fseek(file, -sizeof(pch), SEEK_END);\n        int nBytes = fread(pch, 1, sizeof(pch), file);\n        fclose(file);\n\n        file = fopen(pathLog.string().c_str(), \"w\");\n        if (file)\n        {\n            fwrite(pch, 1, nBytes, file);\n            fclose(file);\n        }\n    }\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "file"
          ],
          "line": 1168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fwrite",
          "args": [
            "pch",
            "1",
            "nBytes",
            "file"
          ],
          "line": 1167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "pathLog.string().c_str()",
            "\"w\""
          ],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathLog.string",
          "args": [],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathLog.string",
          "args": [],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "file"
          ],
          "line": 1162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fread",
          "args": [
            "pch",
            "1",
            "sizeof(pch)",
            "file"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fseek",
          "args": [
            "file",
            "-sizeof(pch)",
            "SEEK_END"
          ],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::filesystem::file_size",
          "args": [
            "pathLog"
          ],
          "line": 1156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "pathLog.string().c_str()",
            "\"r\""
          ],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathLog.string",
          "args": [],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathLog.string",
          "args": [],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetDataDir",
          "args": [],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvoid ShrinkDebugFile()\n{\n    // Scroll debug.log if it's getting too big\n    boost::filesystem::path pathLog = GetDataDir() / \"debug.log\";\n    FILE* file = fopen(pathLog.string().c_str(), \"r\");\n    if (file && boost::filesystem::file_size(pathLog) > 10 * 1000000)\n    {\n        // Restart the file with some of the end\n        char pch[200000];\n        fseek(file, -sizeof(pch), SEEK_END);\n        int nBytes = fread(pch, 1, sizeof(pch), file);\n        fclose(file);\n\n        file = fopen(pathLog.string().c_str(), \"w\");\n        if (file)\n        {\n            fwrite(pch, 1, nBytes, file);\n            fclose(file);\n        }\n    }\n}"
  },
  {
    "function_name": "FileCommit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1141-1149",
    "snippet": "void FileCommit(FILE *fileout)\n{\n    fflush(fileout);                // harmless if redundantly called\n#ifdef WIN32\n    _commit(_fileno(fileout));\n#else\n    fsync(fileno(fileout));\n#endif\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static FILE* fileout = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fsync",
          "args": [
            "fileno(fileout)"
          ],
          "line": 1147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fileno",
          "args": [
            "fileout"
          ],
          "line": 1147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_commit",
          "args": [
            "_fileno(fileout)"
          ],
          "line": 1145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_fileno",
          "args": [
            "fileout"
          ],
          "line": 1145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "fileout"
          ],
          "line": 1143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic FILE* fileout = NULL;\n\nvoid FileCommit(FILE *fileout)\n{\n    fflush(fileout);                // harmless if redundantly called\n#ifdef WIN32\n    _commit(_fileno(fileout));\n#else\n    fsync(fileno(fileout));\n#endif\n}"
  },
  {
    "function_name": "RenameOver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1130-1139",
    "snippet": "bool RenameOver(boost::filesystem::path src, boost::filesystem::path dest)\n{\n#ifdef WIN32\n    return MoveFileExA(src.string().c_str(), dest.string().c_str(),\n                      MOVEFILE_REPLACE_EXISTING);\n#else\n    int rc = std::rename(src.string().c_str(), dest.string().c_str());\n    return (rc == 0);\n#endif /* WIN32 */\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::rename",
          "args": [
            "src.string().c_str()",
            "dest.string().c_str()"
          ],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dest.string",
          "args": [],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dest.string",
          "args": [],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src.string",
          "args": [],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src.string",
          "args": [],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MoveFileExA",
          "args": [
            "src.string().c_str()",
            "dest.string().c_str()",
            "MOVEFILE_REPLACE_EXISTING"
          ],
          "line": 1133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dest.string",
          "args": [],
          "line": 1133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dest.string",
          "args": [],
          "line": 1133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src.string",
          "args": [],
          "line": 1133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src.string",
          "args": [],
          "line": 1133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool RenameOver(boost::filesystem::path src, boost::filesystem::path dest)\n{\n#ifdef WIN32\n    return MoveFileExA(src.string().c_str(), dest.string().c_str(),\n                      MOVEFILE_REPLACE_EXISTING);\n#else\n    int rc = std::rename(src.string().c_str(), dest.string().c_str());\n    return (rc == 0);\n#endif /* WIN32 */\n}"
  },
  {
    "function_name": "CreatePidFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1119-1127",
    "snippet": "void CreatePidFile(const boost::filesystem::path &path, pid_t pid)\n{\n    FILE* file = fopen(path.string().c_str(), \"w\");\n    if (file)\n    {\n        fprintf(file, \"%d\\n\", pid);\n        fclose(file);\n    }\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "file"
          ],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "file",
            "\"%d\\n\"",
            "pid"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "path.string().c_str()",
            "\"w\""
          ],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.string",
          "args": [],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.string",
          "args": [],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvoid CreatePidFile(const boost::filesystem::path &path, pid_t pid)\n{\n    FILE* file = fopen(path.string().c_str(), \"w\");\n    if (file)\n    {\n        fprintf(file, \"%d\\n\", pid);\n        fclose(file);\n    }\n}"
  },
  {
    "function_name": "GetPidFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1111-1116",
    "snippet": "boost::filesystem::path GetPidFile()\n{\n    boost::filesystem::path pathPidFile(GetArg(\"-pid\", \"halcyond.pid\"));\n    if (!pathPidFile.is_complete()) pathPidFile = GetDataDir() / pathPidFile;\n    return pathPidFile;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetDataDir",
          "args": [],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathPidFile.is_complete",
          "args": [],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetArg",
          "args": [
            "\"-pid\"",
            "\"halcyond.pid\""
          ],
          "line": 1113
        },
        "resolved": true,
        "details": {
          "function_name": "GetArg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "562-567",
          "snippet": "int64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "map<string, string> mapArgs;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nint64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nboost::filesystem::path GetPidFile()\n{\n    boost::filesystem::path pathPidFile(GetArg(\"-pid\", \"halcyond.pid\"));\n    if (!pathPidFile.is_complete()) pathPidFile = GetDataDir() / pathPidFile;\n    return pathPidFile;\n}"
  },
  {
    "function_name": "ReadConfigFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1087-1109",
    "snippet": "void ReadConfigFile(map<string, string>& mapSettingsRet,\n                    map<string, vector<string> >& mapMultiSettingsRet)\n{\n    boost::filesystem::ifstream streamConfig(GetConfigFile());\n    if (!streamConfig.good())\n        return; // No bitcoin.conf file is OK\n\n    set<string> setOptions;\n    setOptions.insert(\"*\");\n\n    for (boost::program_options::detail::config_file_iterator it(streamConfig, setOptions), end; it != end; ++it)\n    {\n        // Don't overwrite existing settings so command line settings override bitcoin.conf\n        string strKey = string(\"-\") + it->string_key;\n        if (mapSettingsRet.count(strKey) == 0)\n        {\n            mapSettingsRet[strKey] = it->value[0];\n            // interpret nofoo=1 as foo=0 (and nofoo=0 as foo=1) as long as foo not set)\n            InterpretNegativeSetting(strKey, mapSettingsRet);\n        }\n        mapMultiSettingsRet[strKey].push_back(it->value[0]);\n    }\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mapMultiSettingsRet[strKey].push_back",
          "args": [
            "it->value[0]"
          ],
          "line": 1107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InterpretNegativeSetting",
          "args": [
            "strKey",
            "mapSettingsRet"
          ],
          "line": 1105
        },
        "resolved": true,
        "details": {
          "function_name": "InterpretNegativeSetting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "495-508",
          "snippet": "static void InterpretNegativeSetting(string name, map<string, string>& mapSettingsRet)\n{\n    // interpret -nofoo as -foo=0 (and -nofoo=0 as -foo=1) as long as -foo not set\n    if (name.find(\"-no\") == 0)\n    {\n        std::string positive(\"-\");\n        positive.append(name.begin()+3, name.end());\n        if (mapSettingsRet.count(positive) == 0)\n        {\n            bool value = !GetBoolArg(name);\n            mapSettingsRet[positive] = (value ? \"1\" : \"0\");\n        }\n    }\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic void InterpretNegativeSetting(string name, map<string, string>& mapSettingsRet)\n{\n    // interpret -nofoo as -foo=0 (and -nofoo=0 as -foo=1) as long as -foo not set\n    if (name.find(\"-no\") == 0)\n    {\n        std::string positive(\"-\");\n        positive.append(name.begin()+3, name.end());\n        if (mapSettingsRet.count(positive) == 0)\n        {\n            bool value = !GetBoolArg(name);\n            mapSettingsRet[positive] = (value ? \"1\" : \"0\");\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapSettingsRet.count",
          "args": [
            "strKey"
          ],
          "line": 1101
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "string",
          "args": [
            "\"-\""
          ],
          "line": 1100
        },
        "resolved": true,
        "details": {
          "function_name": "non_printable_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "29-41",
          "snippet": "String_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "setOptions.insert",
          "args": [
            "\"*\""
          ],
          "line": 1095
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "61-65",
          "snippet": "void CBloomFilter::insert(const uint256& hash)\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    insert(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  void CBloomFilter::insert(const uint256& hash)\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      insert(data);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "streamConfig.good",
          "args": [],
          "line": 1091
        },
        "resolved": true,
        "details": {
          "function_name": "good",
          "container": "CAutoFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "1078-1078",
          "snippet": "bool good() const            { return state == 0; }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCAutoFile {\n  bool good() const            { return state == 0; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvoid ReadConfigFile(map<string, string>& mapSettingsRet,\n                    map<string, vector<string> >& mapMultiSettingsRet)\n{\n    boost::filesystem::ifstream streamConfig(GetConfigFile());\n    if (!streamConfig.good())\n        return; // No bitcoin.conf file is OK\n\n    set<string> setOptions;\n    setOptions.insert(\"*\");\n\n    for (boost::program_options::detail::config_file_iterator it(streamConfig, setOptions), end; it != end; ++it)\n    {\n        // Don't overwrite existing settings so command line settings override bitcoin.conf\n        string strKey = string(\"-\") + it->string_key;\n        if (mapSettingsRet.count(strKey) == 0)\n        {\n            mapSettingsRet[strKey] = it->value[0];\n            // interpret nofoo=1 as foo=0 (and nofoo=0 as foo=1) as long as foo not set)\n            InterpretNegativeSetting(strKey, mapSettingsRet);\n        }\n        mapMultiSettingsRet[strKey].push_back(it->value[0]);\n    }\n}"
  },
  {
    "function_name": "GetConfigFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1072-1085",
    "snippet": "boost::filesystem::path GetConfigFile() {\n    namespace fs = boost::filesystem;\n\n    fs::path pathConfigFile;\n    if(mapArgs.count(\"-conf\")) pathConfigFile = fs::path(mapArgs[\"-conf\"]);\n    else pathConfigFile = fs::path(\"halcyon.conf\");\n    if(!pathConfigFile.is_absolute()) {\n        if(!GetBoolArg(\"-testnet\", false)) \n          pathConfigFile = GetDataDir(false) / pathConfigFile;\n        else\n          pathConfigFile = GetDataDir(false) / \"testnet\" / pathConfigFile;\n    }\n    return(pathConfigFile);\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "map<string, string> mapArgs;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetDataDir",
          "args": [
            "false"
          ],
          "line": 1082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetDataDir",
          "args": [
            "false"
          ],
          "line": 1080
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetBoolArg",
          "args": [
            "\"-testnet\"",
            "false"
          ],
          "line": 1079
        },
        "resolved": true,
        "details": {
          "function_name": "GetBoolArg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "569-578",
          "snippet": "bool GetBoolArg(const std::string& strArg, bool fDefault)\n{\n    if (mapArgs.count(strArg))\n    {\n        if (mapArgs[strArg].empty())\n            return true;\n        return (atoi(mapArgs[strArg]) != 0);\n    }\n    return fDefault;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "map<string, string> mapArgs;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nbool GetBoolArg(const std::string& strArg, bool fDefault)\n{\n    if (mapArgs.count(strArg))\n    {\n        if (mapArgs[strArg].empty())\n            return true;\n        return (atoi(mapArgs[strArg]) != 0);\n    }\n    return fDefault;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathConfigFile.is_absolute",
          "args": [],
          "line": 1078
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs::path",
          "args": [
            "\"halcyon.conf\""
          ],
          "line": 1077
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs::path",
          "args": [
            "mapArgs[\"-conf\"]"
          ],
          "line": 1076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapArgs.count",
          "args": [
            "\"-conf\""
          ],
          "line": 1076
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nboost::filesystem::path GetConfigFile() {\n    namespace fs = boost::filesystem;\n\n    fs::path pathConfigFile;\n    if(mapArgs.count(\"-conf\")) pathConfigFile = fs::path(mapArgs[\"-conf\"]);\n    else pathConfigFile = fs::path(\"halcyon.conf\");\n    if(!pathConfigFile.is_absolute()) {\n        if(!GetBoolArg(\"-testnet\", false)) \n          pathConfigFile = GetDataDir(false) / pathConfigFile;\n        else\n          pathConfigFile = GetDataDir(false) / \"testnet\" / pathConfigFile;\n    }\n    return(pathConfigFile);\n}"
  },
  {
    "function_name": "GetDefaultDataDir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1013-1035",
    "snippet": "boost::filesystem::path GetDefaultDataDir() {\n    namespace fs = boost::filesystem;\n    fs::path path;\n\n#if (WIN32)\n    /* Windows: current directory \\ data for livenet */\n    path = boost::filesystem::current_path() / \"data\";\n#else\n    /* Linux, Mac OS X, *BSD and so on: ~/.orbitcoin */\n    char* pszHome = getenv(\"HOME\");\n    if(!pszHome || !strlen(pszHome))\n      /* Must be root if no $HOME set */\n#if (__APPLE__)\n      path = fs::path(\"/private/var/root/.halcyon\");\n#else\n      path = fs::path(\"/root/.halcyon\");\n#endif\n    else\n      path = fs::path(pszHome) / \".halcyon\";\n#endif\n\n    return(path);\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs::path",
          "args": [
            "pszHome"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs::path",
          "args": [
            "\"/root/.halcyon\""
          ],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs::path",
          "args": [
            "\"/private/var/root/.halcyon\""
          ],
          "line": 1026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pszHome"
          ],
          "line": 1023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"HOME\""
          ],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::filesystem::current_path",
          "args": [],
          "line": 1019
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nboost::filesystem::path GetDefaultDataDir() {\n    namespace fs = boost::filesystem;\n    fs::path path;\n\n#if (WIN32)\n    /* Windows: current directory \\ data for livenet */\n    path = boost::filesystem::current_path() / \"data\";\n#else\n    /* Linux, Mac OS X, *BSD and so on: ~/.orbitcoin */\n    char* pszHome = getenv(\"HOME\");\n    if(!pszHome || !strlen(pszHome))\n      /* Must be root if no $HOME set */\n#if (__APPLE__)\n      path = fs::path(\"/private/var/root/.halcyon\");\n#else\n      path = fs::path(\"/root/.halcyon\");\n#endif\n    else\n      path = fs::path(pszHome) / \".halcyon\";\n#endif\n\n    return(path);\n}"
  },
  {
    "function_name": "PrintExceptionContinue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "1005-1011",
    "snippet": "void PrintExceptionContinue(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n\\n************************\\n%s\\n\", message.c_str());\n    fprintf(stderr, \"\\n\\n************************\\n%s\\n\", message.c_str());\n    strMiscWarning = message;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "string strMiscWarning;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"\\n\\n************************\\n%s\\n\"",
            "message.c_str()"
          ],
          "line": 1009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.c_str",
          "args": [],
          "line": 1009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\\n************************\\n%s\\n\"",
            "message.c_str()"
          ],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "message.c_str",
          "args": [],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatException",
          "args": [
            "pex",
            "pszThread"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "FormatException",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "961-975",
          "snippet": "static std::string FormatException(std::exception* pex, const char* pszThread)\n{\n#ifdef WIN32\n    char pszModule[MAX_PATH] = \"\";\n    GetModuleFileNameA(NULL, pszModule, sizeof(pszModule));\n#else\n    const char* pszModule = \"halcyon\";\n#endif\n    if (pex)\n        return strprintf(\n            \"EXCEPTION: %s       \\n%s       \\n%s in %s       \\n\", typeid(*pex).name(), pex->what(), pszModule, pszThread);\n    else\n        return strprintf(\n            \"UNKNOWN EXCEPTION       \\n%s in %s       \\n\", pszModule, pszThread);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic std::string FormatException(std::exception* pex, const char* pszThread)\n{\n#ifdef WIN32\n    char pszModule[MAX_PATH] = \"\";\n    GetModuleFileNameA(NULL, pszModule, sizeof(pszModule));\n#else\n    const char* pszModule = \"halcyon\";\n#endif\n    if (pex)\n        return strprintf(\n            \"EXCEPTION: %s       \\n%s       \\n%s in %s       \\n\", typeid(*pex).name(), pex->what(), pszModule, pszThread);\n    else\n        return strprintf(\n            \"UNKNOWN EXCEPTION       \\n%s in %s       \\n\", pszModule, pszThread);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring strMiscWarning;\n\nvoid PrintExceptionContinue(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n\\n************************\\n%s\\n\", message.c_str());\n    fprintf(stderr, \"\\n\\n************************\\n%s\\n\", message.c_str());\n    strMiscWarning = message;\n}"
  },
  {
    "function_name": "LogStackTrace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "992-1003",
    "snippet": "void LogStackTrace() {\n    printf(\"\\n\\n******* exception encountered *******\\n\");\n    if (fileout)\n    {\n#ifndef WIN32\n        void* pszBuffer[32];\n        size_t size;\n        size = backtrace(pszBuffer, 32);\n        backtrace_symbols_fd(pszBuffer, size, fileno(fileout));\n#endif\n    }\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static FILE* fileout = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "backtrace_symbols_fd",
          "args": [
            "pszBuffer",
            "size",
            "fileno(fileout)"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fileno",
          "args": [
            "fileout"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backtrace",
          "args": [
            "pszBuffer",
            "32"
          ],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\\n******* exception encountered *******\\n\""
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic FILE* fileout = NULL;\n\nvoid LogStackTrace() {\n    printf(\"\\n\\n******* exception encountered *******\\n\");\n    if (fileout)\n    {\n#ifndef WIN32\n        void* pszBuffer[32];\n        size_t size;\n        size = backtrace(pszBuffer, 32);\n        backtrace_symbols_fd(pszBuffer, size, fileno(fileout));\n#endif\n    }\n}"
  },
  {
    "function_name": "PrintException",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "983-990",
    "snippet": "void PrintException(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n\\n************************\\n%s\\n\", message.c_str());\n    fprintf(stderr, \"\\n\\n************************\\n%s\\n\", message.c_str());\n    strMiscWarning = message;\n    throw;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "string strMiscWarning;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"\\n\\n************************\\n%s\\n\"",
            "message.c_str()"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.c_str",
          "args": [],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\\n************************\\n%s\\n\"",
            "message.c_str()"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "message.c_str",
          "args": [],
          "line": 986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatException",
          "args": [
            "pex",
            "pszThread"
          ],
          "line": 985
        },
        "resolved": true,
        "details": {
          "function_name": "FormatException",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "961-975",
          "snippet": "static std::string FormatException(std::exception* pex, const char* pszThread)\n{\n#ifdef WIN32\n    char pszModule[MAX_PATH] = \"\";\n    GetModuleFileNameA(NULL, pszModule, sizeof(pszModule));\n#else\n    const char* pszModule = \"halcyon\";\n#endif\n    if (pex)\n        return strprintf(\n            \"EXCEPTION: %s       \\n%s       \\n%s in %s       \\n\", typeid(*pex).name(), pex->what(), pszModule, pszThread);\n    else\n        return strprintf(\n            \"UNKNOWN EXCEPTION       \\n%s in %s       \\n\", pszModule, pszThread);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic std::string FormatException(std::exception* pex, const char* pszThread)\n{\n#ifdef WIN32\n    char pszModule[MAX_PATH] = \"\";\n    GetModuleFileNameA(NULL, pszModule, sizeof(pszModule));\n#else\n    const char* pszModule = \"halcyon\";\n#endif\n    if (pex)\n        return strprintf(\n            \"EXCEPTION: %s       \\n%s       \\n%s in %s       \\n\", typeid(*pex).name(), pex->what(), pszModule, pszThread);\n    else\n        return strprintf(\n            \"UNKNOWN EXCEPTION       \\n%s in %s       \\n\", pszModule, pszThread);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring strMiscWarning;\n\nvoid PrintException(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n\\n************************\\n%s\\n\", message.c_str());\n    fprintf(stderr, \"\\n\\n************************\\n%s\\n\", message.c_str());\n    strMiscWarning = message;\n    throw;\n}"
  },
  {
    "function_name": "LogException",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "977-981",
    "snippet": "void LogException(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n%s\", message.c_str());\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n%s\"",
            "message.c_str()"
          ],
          "line": 980
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "message.c_str",
          "args": [],
          "line": 980
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatException",
          "args": [
            "pex",
            "pszThread"
          ],
          "line": 979
        },
        "resolved": true,
        "details": {
          "function_name": "FormatException",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "961-975",
          "snippet": "static std::string FormatException(std::exception* pex, const char* pszThread)\n{\n#ifdef WIN32\n    char pszModule[MAX_PATH] = \"\";\n    GetModuleFileNameA(NULL, pszModule, sizeof(pszModule));\n#else\n    const char* pszModule = \"halcyon\";\n#endif\n    if (pex)\n        return strprintf(\n            \"EXCEPTION: %s       \\n%s       \\n%s in %s       \\n\", typeid(*pex).name(), pex->what(), pszModule, pszThread);\n    else\n        return strprintf(\n            \"UNKNOWN EXCEPTION       \\n%s in %s       \\n\", pszModule, pszThread);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic std::string FormatException(std::exception* pex, const char* pszThread)\n{\n#ifdef WIN32\n    char pszModule[MAX_PATH] = \"\";\n    GetModuleFileNameA(NULL, pszModule, sizeof(pszModule));\n#else\n    const char* pszModule = \"halcyon\";\n#endif\n    if (pex)\n        return strprintf(\n            \"EXCEPTION: %s       \\n%s       \\n%s in %s       \\n\", typeid(*pex).name(), pex->what(), pszModule, pszThread);\n    else\n        return strprintf(\n            \"UNKNOWN EXCEPTION       \\n%s in %s       \\n\", pszModule, pszThread);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvoid LogException(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n%s\", message.c_str());\n}"
  },
  {
    "function_name": "FormatException",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "961-975",
    "snippet": "static std::string FormatException(std::exception* pex, const char* pszThread)\n{\n#ifdef WIN32\n    char pszModule[MAX_PATH] = \"\";\n    GetModuleFileNameA(NULL, pszModule, sizeof(pszModule));\n#else\n    const char* pszModule = \"halcyon\";\n#endif\n    if (pex)\n        return strprintf(\n            \"EXCEPTION: %s       \\n%s       \\n%s in %s       \\n\", typeid(*pex).name(), pex->what(), pszModule, pszThread);\n    else\n        return strprintf(\n            \"UNKNOWN EXCEPTION       \\n%s in %s       \\n\", pszModule, pszThread);\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"UNKNOWN EXCEPTION       \\n%s in %s       \\n\"",
            "pszModule",
            "pszThread"
          ],
          "line": 973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"EXCEPTION: %s       \\n%s       \\n%s in %s       \\n\"",
            "typeid(*pex).name()",
            "pex->what()",
            "pszModule",
            "pszThread"
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pex->what",
          "args": [],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeid",
          "args": [],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeid",
          "args": [
            "*pex"
          ],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetModuleFileNameA",
          "args": [
            "NULL",
            "pszModule",
            "sizeof(pszModule)"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic std::string FormatException(std::exception* pex, const char* pszThread)\n{\n#ifdef WIN32\n    char pszModule[MAX_PATH] = \"\";\n    GetModuleFileNameA(NULL, pszModule, sizeof(pszModule));\n#else\n    const char* pszModule = \"halcyon\";\n#endif\n    if (pex)\n        return strprintf(\n            \"EXCEPTION: %s       \\n%s       \\n%s in %s       \\n\", typeid(*pex).name(), pex->what(), pszModule, pszThread);\n    else\n        return strprintf(\n            \"UNKNOWN EXCEPTION       \\n%s in %s       \\n\", pszModule, pszThread);\n}"
  },
  {
    "function_name": "WildcardMatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "949-952",
    "snippet": "bool WildcardMatch(const string& str, const string& mask)\n{\n    return WildcardMatch(str.c_str(), mask.c_str());\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WildcardMatch",
          "args": [
            "str.c_str()",
            "mask.c_str()"
          ],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "WildcardMatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "949-952",
          "snippet": "bool WildcardMatch(const string& str, const string& mask)\n{\n    return WildcardMatch(str.c_str(), mask.c_str());\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "mask.c_str",
          "args": [],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool WildcardMatch(const string& str, const string& mask)\n{\n    return WildcardMatch(str.c_str(), mask.c_str());\n}"
  },
  {
    "function_name": "WildcardMatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "925-947",
    "snippet": "bool WildcardMatch(const char* psz, const char* mask)\n{\n    while (true)\n    {\n        switch (*mask)\n        {\n        case '\\0':\n            return (*psz == '\\0');\n        case '*':\n            return WildcardMatch(psz, mask+1) || (*psz && WildcardMatch(psz+1, mask));\n        case '?':\n            if (*psz == '\\0')\n                return false;\n            break;\n        default:\n            if (*psz != *mask)\n                return false;\n            break;\n        }\n        psz++;\n        mask++;\n    }\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WildcardMatch",
          "args": [
            "psz+1",
            "mask"
          ],
          "line": 934
        },
        "resolved": true,
        "details": {
          "function_name": "WildcardMatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "949-952",
          "snippet": "bool WildcardMatch(const string& str, const string& mask)\n{\n    return WildcardMatch(str.c_str(), mask.c_str());\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool WildcardMatch(const char* psz, const char* mask)\n{\n    while (true)\n    {\n        switch (*mask)\n        {\n        case '\\0':\n            return (*psz == '\\0');\n        case '*':\n            return WildcardMatch(psz, mask+1) || (*psz && WildcardMatch(psz+1, mask));\n        case '?':\n            if (*psz == '\\0')\n                return false;\n            break;\n        default:\n            if (*psz != *mask)\n                return false;\n            break;\n        }\n        psz++;\n        mask++;\n    }\n}"
  },
  {
    "function_name": "DecodeBase32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "918-922",
    "snippet": "string DecodeBase32(const string& str)\n{\n    vector<unsigned char> vchRet = DecodeBase32(str.c_str());\n    return string((const char*)&vchRet[0], vchRet.size());\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "string",
          "args": [
            "(const char*)&vchRet[0]",
            "vchRet.size()"
          ],
          "line": 921
        },
        "resolved": true,
        "details": {
          "function_name": "read_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_reader_template.h",
          "lines": "586-591",
          "snippet": "bool read_string( const String_type& s, Value_type& value )\n    {\n        typename String_type::const_iterator begin = s.begin();\n\n        return read_range( begin, s.end(), value );\n    }",
          "includes": [
            "#include <boost/spirit/iterator/position_iterator.hpp>",
            "#include <boost/spirit/iterator/multi_pass.hpp>",
            "#include <boost/spirit/utility/escape_char.hpp>",
            "#include <boost/spirit/utility/confix.hpp>",
            "#include <boost/spirit/core.hpp>",
            "#include <boost/spirit/include/classic_position_iterator.hpp>",
            "#include <boost/spirit/include/classic_multi_pass.hpp>",
            "#include <boost/spirit/include/classic_escape_char.hpp>",
            "#include <boost/spirit/include/classic_confix.hpp>",
            "#include <boost/spirit/include/classic_core.hpp>",
            "#include <boost/version.hpp>",
            "#include <boost/function.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include \"json_spirit_error_position.h\"",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/spirit/iterator/position_iterator.hpp>\n#include <boost/spirit/iterator/multi_pass.hpp>\n#include <boost/spirit/utility/escape_char.hpp>\n#include <boost/spirit/utility/confix.hpp>\n#include <boost/spirit/core.hpp>\n#include <boost/spirit/include/classic_position_iterator.hpp>\n#include <boost/spirit/include/classic_multi_pass.hpp>\n#include <boost/spirit/include/classic_escape_char.hpp>\n#include <boost/spirit/include/classic_confix.hpp>\n#include <boost/spirit/include/classic_core.hpp>\n#include <boost/version.hpp>\n#include <boost/function.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include \"json_spirit_error_position.h\"\n#include \"json_spirit_value.h\"\n\nbool read_string( const String_type& s, Value_type& value )\n    {\n        typename String_type::const_iterator begin = s.begin();\n\n        return read_range( begin, s.end(), value );\n    }"
        }
      },
      {
        "call_info": {
          "callee": "vchRet.size",
          "args": [],
          "line": 921
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "623-626",
          "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  int size() const\n      {\n          return vValues.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DecodeBase32",
          "args": [
            "str.c_str()"
          ],
          "line": 920
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeBase32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "918-922",
          "snippet": "string DecodeBase32(const string& str)\n{\n    vector<unsigned char> vchRet = DecodeBase32(str.c_str());\n    return string((const char*)&vchRet[0], vchRet.size());\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring DecodeBase32(const string& str)\n{\n    vector<unsigned char> vchRet = DecodeBase32(str.c_str());\n    return string((const char*)&vchRet[0], vchRet.size());\n}"
  },
  {
    "function_name": "DecodeBase32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "801-916",
    "snippet": "vector<unsigned char> DecodeBase32(const char* p, bool* pfInvalid)\n{\n    static const int decode32_table[256] =\n    {\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14,\n        15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1,  0,  1,  2,\n         3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,\n        23, 24, 25, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1\n    };\n\n    if (pfInvalid)\n        *pfInvalid = false;\n\n    vector<unsigned char> vchRet;\n    vchRet.reserve((strlen(p))*5/8);\n\n    int mode = 0;\n    int left = 0;\n\n    while (1)\n    {\n         int dec = decode32_table[(unsigned char)*p];\n         if (dec == -1) break;\n         p++;\n         switch (mode)\n         {\n             case 0: // we have no bits and get 5\n                 left = dec;\n                 mode = 1;\n                 break;\n\n              case 1: // we have 5 bits and keep 2\n                  vchRet.push_back((left<<3) | (dec>>2));\n                  left = dec & 3;\n                  mode = 2;\n                  break;\n\n             case 2: // we have 2 bits and keep 7\n                 left = left << 5 | dec;\n                 mode = 3;\n                 break;\n\n             case 3: // we have 7 bits and keep 4\n                 vchRet.push_back((left<<1) | (dec>>4));\n                 left = dec & 15;\n                 mode = 4;\n                 break;\n\n             case 4: // we have 4 bits, and keep 1\n                 vchRet.push_back((left<<4) | (dec>>1));\n                 left = dec & 1;\n                 mode = 5;\n                 break;\n\n             case 5: // we have 1 bit, and keep 6\n                 left = left << 5 | dec;\n                 mode = 6;\n                 break;\n\n             case 6: // we have 6 bits, and keep 3\n                 vchRet.push_back((left<<2) | (dec>>3));\n                 left = dec & 7;\n                 mode = 7;\n                 break;\n\n             case 7: // we have 3 bits, and keep 0\n                 vchRet.push_back((left<<5) | dec);\n                 mode = 0;\n                 break;\n         }\n    }\n\n    if (pfInvalid)\n        switch (mode)\n        {\n            case 0: // 8n base32 characters processed: ok\n                break;\n\n            case 1: // 8n+1 base32 characters processed: impossible\n            case 3: //   +3\n            case 6: //   +6\n                *pfInvalid = true;\n                break;\n\n            case 2: // 8n+2 base32 characters processed: require '======'\n                if (left || p[0] != '=' || p[1] != '=' || p[2] != '=' || p[3] != '=' || p[4] != '=' || p[5] != '=' || decode32_table[(unsigned char)p[6]] != -1)\n                    *pfInvalid = true;\n                break;\n\n            case 4: // 8n+4 base32 characters processed: require '===='\n                if (left || p[0] != '=' || p[1] != '=' || p[2] != '=' || p[3] != '=' || decode32_table[(unsigned char)p[4]] != -1)\n                    *pfInvalid = true;\n                break;\n\n            case 5: // 8n+5 base32 characters processed: require '==='\n                if (left || p[0] != '=' || p[1] != '=' || p[2] != '=' || decode32_table[(unsigned char)p[3]] != -1)\n                    *pfInvalid = true;\n                break;\n\n            case 7: // 8n+7 base32 characters processed: require '='\n                if (left || p[0] != '=' || decode32_table[(unsigned char)p[1]] != -1)\n                    *pfInvalid = true;\n                break;\n        }\n\n    return vchRet;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vchRet.push_back",
          "args": [
            "(left<<5) | dec"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchRet.push_back",
          "args": [
            "(left<<2) | (dec>>3)"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchRet.push_back",
          "args": [
            "(left<<4) | (dec>>1)"
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchRet.push_back",
          "args": [
            "(left<<1) | (dec>>4)"
          ],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchRet.push_back",
          "args": [
            "(left<<3) | (dec>>2)"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchRet.reserve",
          "args": [
            "(strlen(p))*5/8"
          ],
          "line": 824
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "805-805",
          "snippet": "void reserve(size_type n)                        { vch.reserve(n + nReadPos); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void reserve(size_type n)                        { vch.reserve(n + nReadPos); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "p"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvector<unsigned char> DecodeBase32(const char* p, bool* pfInvalid)\n{\n    static const int decode32_table[256] =\n    {\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14,\n        15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1,  0,  1,  2,\n         3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,\n        23, 24, 25, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1\n    };\n\n    if (pfInvalid)\n        *pfInvalid = false;\n\n    vector<unsigned char> vchRet;\n    vchRet.reserve((strlen(p))*5/8);\n\n    int mode = 0;\n    int left = 0;\n\n    while (1)\n    {\n         int dec = decode32_table[(unsigned char)*p];\n         if (dec == -1) break;\n         p++;\n         switch (mode)\n         {\n             case 0: // we have no bits and get 5\n                 left = dec;\n                 mode = 1;\n                 break;\n\n              case 1: // we have 5 bits and keep 2\n                  vchRet.push_back((left<<3) | (dec>>2));\n                  left = dec & 3;\n                  mode = 2;\n                  break;\n\n             case 2: // we have 2 bits and keep 7\n                 left = left << 5 | dec;\n                 mode = 3;\n                 break;\n\n             case 3: // we have 7 bits and keep 4\n                 vchRet.push_back((left<<1) | (dec>>4));\n                 left = dec & 15;\n                 mode = 4;\n                 break;\n\n             case 4: // we have 4 bits, and keep 1\n                 vchRet.push_back((left<<4) | (dec>>1));\n                 left = dec & 1;\n                 mode = 5;\n                 break;\n\n             case 5: // we have 1 bit, and keep 6\n                 left = left << 5 | dec;\n                 mode = 6;\n                 break;\n\n             case 6: // we have 6 bits, and keep 3\n                 vchRet.push_back((left<<2) | (dec>>3));\n                 left = dec & 7;\n                 mode = 7;\n                 break;\n\n             case 7: // we have 3 bits, and keep 0\n                 vchRet.push_back((left<<5) | dec);\n                 mode = 0;\n                 break;\n         }\n    }\n\n    if (pfInvalid)\n        switch (mode)\n        {\n            case 0: // 8n base32 characters processed: ok\n                break;\n\n            case 1: // 8n+1 base32 characters processed: impossible\n            case 3: //   +3\n            case 6: //   +6\n                *pfInvalid = true;\n                break;\n\n            case 2: // 8n+2 base32 characters processed: require '======'\n                if (left || p[0] != '=' || p[1] != '=' || p[2] != '=' || p[3] != '=' || p[4] != '=' || p[5] != '=' || decode32_table[(unsigned char)p[6]] != -1)\n                    *pfInvalid = true;\n                break;\n\n            case 4: // 8n+4 base32 characters processed: require '===='\n                if (left || p[0] != '=' || p[1] != '=' || p[2] != '=' || p[3] != '=' || decode32_table[(unsigned char)p[4]] != -1)\n                    *pfInvalid = true;\n                break;\n\n            case 5: // 8n+5 base32 characters processed: require '==='\n                if (left || p[0] != '=' || p[1] != '=' || p[2] != '=' || decode32_table[(unsigned char)p[3]] != -1)\n                    *pfInvalid = true;\n                break;\n\n            case 7: // 8n+7 base32 characters processed: require '='\n                if (left || p[0] != '=' || decode32_table[(unsigned char)p[1]] != -1)\n                    *pfInvalid = true;\n                break;\n        }\n\n    return vchRet;\n}"
  },
  {
    "function_name": "EncodeBase32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "796-799",
    "snippet": "string EncodeBase32(const string& str)\n{\n    return EncodeBase32((const unsigned char*)str.c_str(), str.size());\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EncodeBase32",
          "args": [
            "(const unsigned char*)str.c_str()",
            "str.size()"
          ],
          "line": 798
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeBase32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "737-794",
          "snippet": "string EncodeBase32(const unsigned char* pch, size_t len)\n{\n    static const char *pbase32 = \"abcdefghijklmnopqrstuvwxyz234567\";\n\n    string strRet=\"\";\n    strRet.reserve((len+4)/5*8);\n\n    int mode=0, left=0;\n    const unsigned char *pchEnd = pch+len;\n\n    while (pch<pchEnd)\n    {\n        int enc = *(pch++);\n        switch (mode)\n        {\n            case 0: // we have no bits\n                strRet += pbase32[enc >> 3];\n                left = (enc & 7) << 2;\n                mode = 1;\n                break;\n\n            case 1: // we have three bits\n                strRet += pbase32[left | (enc >> 6)];\n                strRet += pbase32[(enc >> 1) & 31];\n                left = (enc & 1) << 4;\n                mode = 2;\n                break;\n\n            case 2: // we have one bit\n                strRet += pbase32[left | (enc >> 4)];\n                left = (enc & 15) << 1;\n                mode = 3;\n                break;\n\n            case 3: // we have four bits\n                strRet += pbase32[left | (enc >> 7)];\n                strRet += pbase32[(enc >> 2) & 31];\n                left = (enc & 3) << 3;\n                mode = 4;\n                break;\n\n            case 4: // we have two bits\n                strRet += pbase32[left | (enc >> 5)];\n                strRet += pbase32[enc & 31];\n                mode = 0;\n        }\n    }\n\n    static const int nPadding[5] = {0, 6, 4, 3, 1};\n    if (mode)\n    {\n        strRet += pbase32[left];\n        for (int n=0; n<nPadding[mode]; n++)\n             strRet += '=';\n    }\n\n    return strRet;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "str.size",
          "args": [],
          "line": 798
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "623-626",
          "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  int size() const\n      {\n          return vValues.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring EncodeBase32(const string& str)\n{\n    return EncodeBase32((const unsigned char*)str.c_str(), str.size());\n}"
  },
  {
    "function_name": "EncodeBase32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "737-794",
    "snippet": "string EncodeBase32(const unsigned char* pch, size_t len)\n{\n    static const char *pbase32 = \"abcdefghijklmnopqrstuvwxyz234567\";\n\n    string strRet=\"\";\n    strRet.reserve((len+4)/5*8);\n\n    int mode=0, left=0;\n    const unsigned char *pchEnd = pch+len;\n\n    while (pch<pchEnd)\n    {\n        int enc = *(pch++);\n        switch (mode)\n        {\n            case 0: // we have no bits\n                strRet += pbase32[enc >> 3];\n                left = (enc & 7) << 2;\n                mode = 1;\n                break;\n\n            case 1: // we have three bits\n                strRet += pbase32[left | (enc >> 6)];\n                strRet += pbase32[(enc >> 1) & 31];\n                left = (enc & 1) << 4;\n                mode = 2;\n                break;\n\n            case 2: // we have one bit\n                strRet += pbase32[left | (enc >> 4)];\n                left = (enc & 15) << 1;\n                mode = 3;\n                break;\n\n            case 3: // we have four bits\n                strRet += pbase32[left | (enc >> 7)];\n                strRet += pbase32[(enc >> 2) & 31];\n                left = (enc & 3) << 3;\n                mode = 4;\n                break;\n\n            case 4: // we have two bits\n                strRet += pbase32[left | (enc >> 5)];\n                strRet += pbase32[enc & 31];\n                mode = 0;\n        }\n    }\n\n    static const int nPadding[5] = {0, 6, 4, 3, 1};\n    if (mode)\n    {\n        strRet += pbase32[left];\n        for (int n=0; n<nPadding[mode]; n++)\n             strRet += '=';\n    }\n\n    return strRet;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strRet.reserve",
          "args": [
            "(len+4)/5*8"
          ],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "805-805",
          "snippet": "void reserve(size_type n)                        { vch.reserve(n + nReadPos); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void reserve(size_type n)                        { vch.reserve(n + nReadPos); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring EncodeBase32(const unsigned char* pch, size_t len)\n{\n    static const char *pbase32 = \"abcdefghijklmnopqrstuvwxyz234567\";\n\n    string strRet=\"\";\n    strRet.reserve((len+4)/5*8);\n\n    int mode=0, left=0;\n    const unsigned char *pchEnd = pch+len;\n\n    while (pch<pchEnd)\n    {\n        int enc = *(pch++);\n        switch (mode)\n        {\n            case 0: // we have no bits\n                strRet += pbase32[enc >> 3];\n                left = (enc & 7) << 2;\n                mode = 1;\n                break;\n\n            case 1: // we have three bits\n                strRet += pbase32[left | (enc >> 6)];\n                strRet += pbase32[(enc >> 1) & 31];\n                left = (enc & 1) << 4;\n                mode = 2;\n                break;\n\n            case 2: // we have one bit\n                strRet += pbase32[left | (enc >> 4)];\n                left = (enc & 15) << 1;\n                mode = 3;\n                break;\n\n            case 3: // we have four bits\n                strRet += pbase32[left | (enc >> 7)];\n                strRet += pbase32[(enc >> 2) & 31];\n                left = (enc & 3) << 3;\n                mode = 4;\n                break;\n\n            case 4: // we have two bits\n                strRet += pbase32[left | (enc >> 5)];\n                strRet += pbase32[enc & 31];\n                mode = 0;\n        }\n    }\n\n    static const int nPadding[5] = {0, 6, 4, 3, 1};\n    if (mode)\n    {\n        strRet += pbase32[left];\n        for (int n=0; n<nPadding[mode]; n++)\n             strRet += '=';\n    }\n\n    return strRet;\n}"
  },
  {
    "function_name": "DecodeBase64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "731-735",
    "snippet": "string DecodeBase64(const string& str)\n{\n    vector<unsigned char> vchRet = DecodeBase64(str.c_str());\n    return string((const char*)&vchRet[0], vchRet.size());\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "string",
          "args": [
            "(const char*)&vchRet[0]",
            "vchRet.size()"
          ],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "read_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_reader_template.h",
          "lines": "586-591",
          "snippet": "bool read_string( const String_type& s, Value_type& value )\n    {\n        typename String_type::const_iterator begin = s.begin();\n\n        return read_range( begin, s.end(), value );\n    }",
          "includes": [
            "#include <boost/spirit/iterator/position_iterator.hpp>",
            "#include <boost/spirit/iterator/multi_pass.hpp>",
            "#include <boost/spirit/utility/escape_char.hpp>",
            "#include <boost/spirit/utility/confix.hpp>",
            "#include <boost/spirit/core.hpp>",
            "#include <boost/spirit/include/classic_position_iterator.hpp>",
            "#include <boost/spirit/include/classic_multi_pass.hpp>",
            "#include <boost/spirit/include/classic_escape_char.hpp>",
            "#include <boost/spirit/include/classic_confix.hpp>",
            "#include <boost/spirit/include/classic_core.hpp>",
            "#include <boost/version.hpp>",
            "#include <boost/function.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include \"json_spirit_error_position.h\"",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/spirit/iterator/position_iterator.hpp>\n#include <boost/spirit/iterator/multi_pass.hpp>\n#include <boost/spirit/utility/escape_char.hpp>\n#include <boost/spirit/utility/confix.hpp>\n#include <boost/spirit/core.hpp>\n#include <boost/spirit/include/classic_position_iterator.hpp>\n#include <boost/spirit/include/classic_multi_pass.hpp>\n#include <boost/spirit/include/classic_escape_char.hpp>\n#include <boost/spirit/include/classic_confix.hpp>\n#include <boost/spirit/include/classic_core.hpp>\n#include <boost/version.hpp>\n#include <boost/function.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include \"json_spirit_error_position.h\"\n#include \"json_spirit_value.h\"\n\nbool read_string( const String_type& s, Value_type& value )\n    {\n        typename String_type::const_iterator begin = s.begin();\n\n        return read_range( begin, s.end(), value );\n    }"
        }
      },
      {
        "call_info": {
          "callee": "vchRet.size",
          "args": [],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "623-626",
          "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  int size() const\n      {\n          return vValues.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DecodeBase64",
          "args": [
            "str.c_str()"
          ],
          "line": 733
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeBase64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "731-735",
          "snippet": "string DecodeBase64(const string& str)\n{\n    vector<unsigned char> vchRet = DecodeBase64(str.c_str());\n    return string((const char*)&vchRet[0], vchRet.size());\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring DecodeBase64(const string& str)\n{\n    vector<unsigned char> vchRet = DecodeBase64(str.c_str());\n    return string((const char*)&vchRet[0], vchRet.size());\n}"
  },
  {
    "function_name": "DecodeBase64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "648-729",
    "snippet": "vector<unsigned char> DecodeBase64(const char* p, bool* pfInvalid)\n{\n    static const int decode64_table[256] =\n    {\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, 62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1,\n        -1, -1, -1, -1, -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14,\n        15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28,\n        29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,\n        49, 50, 51, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1\n    };\n\n    if (pfInvalid)\n        *pfInvalid = false;\n\n    vector<unsigned char> vchRet;\n    vchRet.reserve(strlen(p)*3/4);\n\n    int mode = 0;\n    int left = 0;\n\n    while (1)\n    {\n         int dec = decode64_table[(unsigned char)*p];\n         if (dec == -1) break;\n         p++;\n         switch (mode)\n         {\n             case 0: // we have no bits and get 6\n                 left = dec;\n                 mode = 1;\n                 break;\n\n              case 1: // we have 6 bits and keep 4\n                  vchRet.push_back((left<<2) | (dec>>4));\n                  left = dec & 15;\n                  mode = 2;\n                  break;\n\n             case 2: // we have 4 bits and get 6, we keep 2\n                 vchRet.push_back((left<<4) | (dec>>2));\n                 left = dec & 3;\n                 mode = 3;\n                 break;\n\n             case 3: // we have 2 bits and get 6\n                 vchRet.push_back((left<<6) | dec);\n                 mode = 0;\n                 break;\n         }\n    }\n\n    if (pfInvalid)\n        switch (mode)\n        {\n            case 0: // 4n base64 characters processed: ok\n                break;\n\n            case 1: // 4n+1 base64 character processed: impossible\n                *pfInvalid = true;\n                break;\n\n            case 2: // 4n+2 base64 characters processed: require '=='\n                if (left || p[0] != '=' || p[1] != '=' || decode64_table[(unsigned char)p[2]] != -1)\n                    *pfInvalid = true;\n                break;\n\n            case 3: // 4n+3 base64 characters processed: require '='\n                if (left || p[0] != '=' || decode64_table[(unsigned char)p[1]] != -1)\n                    *pfInvalid = true;\n                break;\n        }\n\n    return vchRet;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vchRet.push_back",
          "args": [
            "(left<<6) | dec"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchRet.push_back",
          "args": [
            "(left<<4) | (dec>>2)"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchRet.push_back",
          "args": [
            "(left<<2) | (dec>>4)"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchRet.reserve",
          "args": [
            "strlen(p)*3/4"
          ],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "805-805",
          "snippet": "void reserve(size_type n)                        { vch.reserve(n + nReadPos); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void reserve(size_type n)                        { vch.reserve(n + nReadPos); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "p"
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvector<unsigned char> DecodeBase64(const char* p, bool* pfInvalid)\n{\n    static const int decode64_table[256] =\n    {\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, 62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1,\n        -1, -1, -1, -1, -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14,\n        15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28,\n        29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,\n        49, 50, 51, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1\n    };\n\n    if (pfInvalid)\n        *pfInvalid = false;\n\n    vector<unsigned char> vchRet;\n    vchRet.reserve(strlen(p)*3/4);\n\n    int mode = 0;\n    int left = 0;\n\n    while (1)\n    {\n         int dec = decode64_table[(unsigned char)*p];\n         if (dec == -1) break;\n         p++;\n         switch (mode)\n         {\n             case 0: // we have no bits and get 6\n                 left = dec;\n                 mode = 1;\n                 break;\n\n              case 1: // we have 6 bits and keep 4\n                  vchRet.push_back((left<<2) | (dec>>4));\n                  left = dec & 15;\n                  mode = 2;\n                  break;\n\n             case 2: // we have 4 bits and get 6, we keep 2\n                 vchRet.push_back((left<<4) | (dec>>2));\n                 left = dec & 3;\n                 mode = 3;\n                 break;\n\n             case 3: // we have 2 bits and get 6\n                 vchRet.push_back((left<<6) | dec);\n                 mode = 0;\n                 break;\n         }\n    }\n\n    if (pfInvalid)\n        switch (mode)\n        {\n            case 0: // 4n base64 characters processed: ok\n                break;\n\n            case 1: // 4n+1 base64 character processed: impossible\n                *pfInvalid = true;\n                break;\n\n            case 2: // 4n+2 base64 characters processed: require '=='\n                if (left || p[0] != '=' || p[1] != '=' || decode64_table[(unsigned char)p[2]] != -1)\n                    *pfInvalid = true;\n                break;\n\n            case 3: // 4n+3 base64 characters processed: require '='\n                if (left || p[0] != '=' || decode64_table[(unsigned char)p[1]] != -1)\n                    *pfInvalid = true;\n                break;\n        }\n\n    return vchRet;\n}"
  },
  {
    "function_name": "EncodeBase64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "643-646",
    "snippet": "string EncodeBase64(const string& str)\n{\n    return EncodeBase64((const unsigned char*)str.c_str(), str.size());\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EncodeBase64",
          "args": [
            "(const unsigned char*)str.c_str()",
            "str.size()"
          ],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeBase64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "597-641",
          "snippet": "string EncodeBase64(const unsigned char* pch, size_t len)\n{\n    static const char *pbase64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\n    string strRet=\"\";\n    strRet.reserve((len+2)/3*4);\n\n    int mode=0, left=0;\n    const unsigned char *pchEnd = pch+len;\n\n    while (pch<pchEnd)\n    {\n        int enc = *(pch++);\n        switch (mode)\n        {\n            case 0: // we have no bits\n                strRet += pbase64[enc >> 2];\n                left = (enc & 3) << 4;\n                mode = 1;\n                break;\n\n            case 1: // we have two bits\n                strRet += pbase64[left | (enc >> 4)];\n                left = (enc & 15) << 2;\n                mode = 2;\n                break;\n\n            case 2: // we have four bits\n                strRet += pbase64[left | (enc >> 6)];\n                strRet += pbase64[enc & 63];\n                mode = 0;\n                break;\n        }\n    }\n\n    if (mode)\n    {\n        strRet += pbase64[left];\n        strRet += '=';\n        if (mode == 1)\n            strRet += '=';\n    }\n\n    return strRet;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "str.size",
          "args": [],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "623-626",
          "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  int size() const\n      {\n          return vValues.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring EncodeBase64(const string& str)\n{\n    return EncodeBase64((const unsigned char*)str.c_str(), str.size());\n}"
  },
  {
    "function_name": "EncodeBase64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "597-641",
    "snippet": "string EncodeBase64(const unsigned char* pch, size_t len)\n{\n    static const char *pbase64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\n    string strRet=\"\";\n    strRet.reserve((len+2)/3*4);\n\n    int mode=0, left=0;\n    const unsigned char *pchEnd = pch+len;\n\n    while (pch<pchEnd)\n    {\n        int enc = *(pch++);\n        switch (mode)\n        {\n            case 0: // we have no bits\n                strRet += pbase64[enc >> 2];\n                left = (enc & 3) << 4;\n                mode = 1;\n                break;\n\n            case 1: // we have two bits\n                strRet += pbase64[left | (enc >> 4)];\n                left = (enc & 15) << 2;\n                mode = 2;\n                break;\n\n            case 2: // we have four bits\n                strRet += pbase64[left | (enc >> 6)];\n                strRet += pbase64[enc & 63];\n                mode = 0;\n                break;\n        }\n    }\n\n    if (mode)\n    {\n        strRet += pbase64[left];\n        strRet += '=';\n        if (mode == 1)\n            strRet += '=';\n    }\n\n    return strRet;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strRet.reserve",
          "args": [
            "(len+2)/3*4"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "805-805",
          "snippet": "void reserve(size_type n)                        { vch.reserve(n + nReadPos); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void reserve(size_type n)                        { vch.reserve(n + nReadPos); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring EncodeBase64(const unsigned char* pch, size_t len)\n{\n    static const char *pbase64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\n    string strRet=\"\";\n    strRet.reserve((len+2)/3*4);\n\n    int mode=0, left=0;\n    const unsigned char *pchEnd = pch+len;\n\n    while (pch<pchEnd)\n    {\n        int enc = *(pch++);\n        switch (mode)\n        {\n            case 0: // we have no bits\n                strRet += pbase64[enc >> 2];\n                left = (enc & 3) << 4;\n                mode = 1;\n                break;\n\n            case 1: // we have two bits\n                strRet += pbase64[left | (enc >> 4)];\n                left = (enc & 15) << 2;\n                mode = 2;\n                break;\n\n            case 2: // we have four bits\n                strRet += pbase64[left | (enc >> 6)];\n                strRet += pbase64[enc & 63];\n                mode = 0;\n                break;\n        }\n    }\n\n    if (mode)\n    {\n        strRet += pbase64[left];\n        strRet += '=';\n        if (mode == 1)\n            strRet += '=';\n    }\n\n    return strRet;\n}"
  },
  {
    "function_name": "SoftSetBoolArg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "588-594",
    "snippet": "bool SoftSetBoolArg(const std::string& strArg, bool fValue)\n{\n    if (fValue)\n        return SoftSetArg(strArg, std::string(\"1\"));\n    else\n        return SoftSetArg(strArg, std::string(\"0\"));\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SoftSetArg",
          "args": [
            "strArg",
            "std::string(\"0\")"
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "SoftSetArg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "580-586",
          "snippet": "bool SoftSetArg(const std::string& strArg, const std::string& strValue)\n{\n    if (mapArgs.count(strArg))\n        return false;\n    mapArgs[strArg] = strValue;\n    return true;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "map<string, string> mapArgs;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nbool SoftSetArg(const std::string& strArg, const std::string& strValue)\n{\n    if (mapArgs.count(strArg))\n        return false;\n    mapArgs[strArg] = strValue;\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"0\""
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"1\""
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool SoftSetBoolArg(const std::string& strArg, bool fValue)\n{\n    if (fValue)\n        return SoftSetArg(strArg, std::string(\"1\"));\n    else\n        return SoftSetArg(strArg, std::string(\"0\"));\n}"
  },
  {
    "function_name": "SoftSetArg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "580-586",
    "snippet": "bool SoftSetArg(const std::string& strArg, const std::string& strValue)\n{\n    if (mapArgs.count(strArg))\n        return false;\n    mapArgs[strArg] = strValue;\n    return true;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "map<string, string> mapArgs;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mapArgs.count",
          "args": [
            "strArg"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nbool SoftSetArg(const std::string& strArg, const std::string& strValue)\n{\n    if (mapArgs.count(strArg))\n        return false;\n    mapArgs[strArg] = strValue;\n    return true;\n}"
  },
  {
    "function_name": "GetBoolArg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "569-578",
    "snippet": "bool GetBoolArg(const std::string& strArg, bool fDefault)\n{\n    if (mapArgs.count(strArg))\n    {\n        if (mapArgs[strArg].empty())\n            return true;\n        return (atoi(mapArgs[strArg]) != 0);\n    }\n    return fDefault;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "map<string, string> mapArgs;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "mapArgs[strArg]"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "atoi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "292-295",
          "snippet": "inline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapArgs[strArg].empty",
          "args": [],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapArgs.count",
          "args": [
            "strArg"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nbool GetBoolArg(const std::string& strArg, bool fDefault)\n{\n    if (mapArgs.count(strArg))\n    {\n        if (mapArgs[strArg].empty())\n            return true;\n        return (atoi(mapArgs[strArg]) != 0);\n    }\n    return fDefault;\n}"
  },
  {
    "function_name": "GetArg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "562-567",
    "snippet": "int64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "map<string, string> mapArgs;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atoi64",
          "args": [
            "mapArgs[strArg]"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "atoi64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "283-290",
          "snippet": "inline int64_t atoi64(const std::string& str)\n{\n#ifdef _MSC_VER\n    return _atoi64(str.c_str());\n#else\n    return strtoll(str.c_str(), NULL, 10);\n#endif\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t atoi64(const std::string& str)\n{\n#ifdef _MSC_VER\n    return _atoi64(str.c_str());\n#else\n    return strtoll(str.c_str(), NULL, 10);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapArgs.count",
          "args": [
            "strArg"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nint64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}"
  },
  {
    "function_name": "GetArg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "555-560",
    "snippet": "std::string GetArg(const std::string& strArg, const std::string& strDefault)\n{\n    if (mapArgs.count(strArg))\n        return mapArgs[strArg];\n    return strDefault;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "map<string, string> mapArgs;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mapArgs.count",
          "args": [
            "strArg"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nstd::string GetArg(const std::string& strArg, const std::string& strDefault)\n{\n    if (mapArgs.count(strArg))\n        return mapArgs[strArg];\n    return strDefault;\n}"
  },
  {
    "function_name": "ParseParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "510-553",
    "snippet": "void ParseParameters(int argc, const char* const argv[])\n{\n    mapArgs.clear();\n    mapMultiArgs.clear();\n    for (int i = 1; i < argc; i++)\n    {\n        char psz[10000];\n        strlcpy(psz, argv[i], sizeof(psz));\n        char* pszValue = (char*)\"\";\n        if (strchr(psz, '='))\n        {\n            pszValue = strchr(psz, '=');\n            *pszValue++ = '\\0';\n        }\n        #ifdef WIN32\n        _strlwr(psz);\n        if (psz[0] == '/')\n            psz[0] = '-';\n        #endif\n        if (psz[0] != '-')\n            break;\n\n        mapArgs[psz] = pszValue;\n        mapMultiArgs[psz].push_back(pszValue);\n    }\n\n    // New 0.6 features:\n    BOOST_FOREACH(const PAIRTYPE(string,string)& entry, mapArgs)\n    {\n        string name = entry.first;\n\n        //  interpret --foo as -foo (as long as both are not set)\n        if (name.find(\"--\") == 0)\n        {\n            std::string singleDash(name.begin()+1, name.end());\n            if (mapArgs.count(singleDash) == 0)\n                mapArgs[singleDash] = entry.second;\n            name = singleDash;\n        }\n\n        // interpret -nofoo as -foo=0 (and -nofoo=0 as -foo=1) as long as -foo not set\n        InterpretNegativeSetting(name, mapArgs);\n    }\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "map<string, string> mapArgs;",
      "map<string, vector<string> > mapMultiArgs;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "InterpretNegativeSetting",
          "args": [
            "name",
            "mapArgs"
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "InterpretNegativeSetting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "495-508",
          "snippet": "static void InterpretNegativeSetting(string name, map<string, string>& mapSettingsRet)\n{\n    // interpret -nofoo as -foo=0 (and -nofoo=0 as -foo=1) as long as -foo not set\n    if (name.find(\"-no\") == 0)\n    {\n        std::string positive(\"-\");\n        positive.append(name.begin()+3, name.end());\n        if (mapSettingsRet.count(positive) == 0)\n        {\n            bool value = !GetBoolArg(name);\n            mapSettingsRet[positive] = (value ? \"1\" : \"0\");\n        }\n    }\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic void InterpretNegativeSetting(string name, map<string, string>& mapSettingsRet)\n{\n    // interpret -nofoo as -foo=0 (and -nofoo=0 as -foo=1) as long as -foo not set\n    if (name.find(\"-no\") == 0)\n    {\n        std::string positive(\"-\");\n        positive.append(name.begin()+3, name.end());\n        if (mapSettingsRet.count(positive) == 0)\n        {\n            bool value = !GetBoolArg(name);\n            mapSettingsRet[positive] = (value ? \"1\" : \"0\");\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapArgs.count",
          "args": [
            "singleDash"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "name.end",
          "args": [],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "name.begin",
          "args": [],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "name.find",
          "args": [
            "\"--\""
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapMultiArgs[psz].push_back",
          "args": [
            "pszValue"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_strlwr",
          "args": [
            "psz"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "psz",
            "'='"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "psz",
            "'='"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "psz",
            "argv[i]",
            "sizeof(psz)"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "strlcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/strlcpy.h",
          "lines": "27-53",
          "snippet": "inline size_t strlcpy(char *dst, const char *src, size_t siz)\n{\n    char *d = dst;\n    const char *s = src;\n    size_t n = siz;\n\n    /* Copy as many bytes as will fit */\n    if (n != 0)\n    {\n        while (--n != 0)\n        {\n            if ((*d++ = *s++) == '\\0')\n                break;\n        }\n    }\n\n    /* Not enough room in dst, add NUL and traverse rest of src */\n    if (n == 0)\n    {\n        if (siz != 0)\n            *d = '\\0';  /* NUL-terminate dst */\n        while (*s++)\n            ;\n    }\n\n    return(s - src - 1); /* count does not include NUL */\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n\ninline size_t strlcpy(char *dst, const char *src, size_t siz)\n{\n    char *d = dst;\n    const char *s = src;\n    size_t n = siz;\n\n    /* Copy as many bytes as will fit */\n    if (n != 0)\n    {\n        while (--n != 0)\n        {\n            if ((*d++ = *s++) == '\\0')\n                break;\n        }\n    }\n\n    /* Not enough room in dst, add NUL and traverse rest of src */\n    if (n == 0)\n    {\n        if (siz != 0)\n            *d = '\\0';  /* NUL-terminate dst */\n        while (*s++)\n            ;\n    }\n\n    return(s - src - 1); /* count does not include NUL */\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapMultiArgs.clear",
          "args": [],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\nmap<string, vector<string> > mapMultiArgs;\n\nvoid ParseParameters(int argc, const char* const argv[])\n{\n    mapArgs.clear();\n    mapMultiArgs.clear();\n    for (int i = 1; i < argc; i++)\n    {\n        char psz[10000];\n        strlcpy(psz, argv[i], sizeof(psz));\n        char* pszValue = (char*)\"\";\n        if (strchr(psz, '='))\n        {\n            pszValue = strchr(psz, '=');\n            *pszValue++ = '\\0';\n        }\n        #ifdef WIN32\n        _strlwr(psz);\n        if (psz[0] == '/')\n            psz[0] = '-';\n        #endif\n        if (psz[0] != '-')\n            break;\n\n        mapArgs[psz] = pszValue;\n        mapMultiArgs[psz].push_back(pszValue);\n    }\n\n    // New 0.6 features:\n    BOOST_FOREACH(const PAIRTYPE(string,string)& entry, mapArgs)\n    {\n        string name = entry.first;\n\n        //  interpret --foo as -foo (as long as both are not set)\n        if (name.find(\"--\") == 0)\n        {\n            std::string singleDash(name.begin()+1, name.end());\n            if (mapArgs.count(singleDash) == 0)\n                mapArgs[singleDash] = entry.second;\n            name = singleDash;\n        }\n\n        // interpret -nofoo as -foo=0 (and -nofoo=0 as -foo=1) as long as -foo not set\n        InterpretNegativeSetting(name, mapArgs);\n    }\n}"
  },
  {
    "function_name": "InterpretNegativeSetting",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "495-508",
    "snippet": "static void InterpretNegativeSetting(string name, map<string, string>& mapSettingsRet)\n{\n    // interpret -nofoo as -foo=0 (and -nofoo=0 as -foo=1) as long as -foo not set\n    if (name.find(\"-no\") == 0)\n    {\n        std::string positive(\"-\");\n        positive.append(name.begin()+3, name.end());\n        if (mapSettingsRet.count(positive) == 0)\n        {\n            bool value = !GetBoolArg(name);\n            mapSettingsRet[positive] = (value ? \"1\" : \"0\");\n        }\n    }\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetBoolArg",
          "args": [
            "name"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapSettingsRet.count",
          "args": [
            "positive"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "positive.append",
          "args": [
            "name.begin()+3",
            "name.end()"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.end",
          "args": [],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "name.begin",
          "args": [],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "name.find",
          "args": [
            "\"-no\""
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic void InterpretNegativeSetting(string name, map<string, string>& mapSettingsRet)\n{\n    // interpret -nofoo as -foo=0 (and -nofoo=0 as -foo=1) as long as -foo not set\n    if (name.find(\"-no\") == 0)\n    {\n        std::string positive(\"-\");\n        positive.append(name.begin()+3, name.end());\n        if (mapSettingsRet.count(positive) == 0)\n        {\n            bool value = !GetBoolArg(name);\n            mapSettingsRet[positive] = (value ? \"1\" : \"0\");\n        }\n    }\n}"
  },
  {
    "function_name": "ParseHex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "490-493",
    "snippet": "vector<unsigned char> ParseHex(const string& str)\n{\n    return ParseHex(str.c_str());\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ParseHex",
          "args": [
            "str.c_str()"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "ParseHex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "490-493",
          "snippet": "vector<unsigned char> ParseHex(const string& str)\n{\n    return ParseHex(str.c_str());\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvector<unsigned char> ParseHex(const string& str)\n{\n    return ParseHex(str.c_str());\n}"
  },
  {
    "function_name": "ParseHex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "469-488",
    "snippet": "vector<unsigned char> ParseHex(const char* psz)\n{\n    // convert hex dump to vector\n    vector<unsigned char> vch;\n    while (true)\n    {\n        while (isspace(*psz))\n            psz++;\n        signed char c = phexdigit[(unsigned char)*psz++];\n        if (c == (signed char)-1)\n            break;\n        unsigned char n = (c << 4);\n        c = phexdigit[(unsigned char)*psz++];\n        if (c == (signed char)-1)\n            break;\n        n |= c;\n        vch.push_back(n);\n    }\n    return vch;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const signed char phexdigit[256] =\n{ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vch.push_back",
          "args": [
            "n"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "*psz"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic const signed char phexdigit[256] =\n{ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, };\n\nvector<unsigned char> ParseHex(const char* psz)\n{\n    // convert hex dump to vector\n    vector<unsigned char> vch;\n    while (true)\n    {\n        while (isspace(*psz))\n            psz++;\n        signed char c = phexdigit[(unsigned char)*psz++];\n        if (c == (signed char)-1)\n            break;\n        unsigned char n = (c << 4);\n        c = phexdigit[(unsigned char)*psz++];\n        if (c == (signed char)-1)\n            break;\n        n |= c;\n        vch.push_back(n);\n    }\n    return vch;\n}"
  },
  {
    "function_name": "IsHex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "459-467",
    "snippet": "bool IsHex(const string& str)\n{\n    BOOST_FOREACH(unsigned char c, str)\n    {\n        if (phexdigit[c] < 0)\n            return false;\n    }\n    return (str.size() > 0) && (str.size()%2 == 0);\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const signed char phexdigit[256] =\n{ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "str.size",
          "args": [],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "623-626",
          "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  int size() const\n      {\n          return vValues.size();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic const signed char phexdigit[256] =\n{ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, };\n\nbool IsHex(const string& str)\n{\n    BOOST_FOREACH(unsigned char c, str)\n    {\n        if (phexdigit[c] < 0)\n            return false;\n    }\n    return (str.size() > 0) && (str.size()%2 == 0);\n}"
  },
  {
    "function_name": "ParseMoney",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "400-438",
    "snippet": "bool ParseMoney(const char* pszIn, int64_t& nRet)\n{\n    string strWhole;\n    int64_t nUnits = 0;\n    const char* p = pszIn;\n    while (isspace(*p))\n        p++;\n    for (; *p; p++)\n    {\n        if (*p == '.')\n        {\n            p++;\n            int64_t nMult = CENT*10;\n            while (isdigit(*p) && (nMult > 0))\n            {\n                nUnits += nMult * (*p++ - '0');\n                nMult /= 10;\n            }\n            break;\n        }\n        if (isspace(*p))\n            break;\n        if (!isdigit(*p))\n            return false;\n        strWhole.insert(strWhole.end(), *p);\n    }\n    for (; *p; p++)\n        if (!isspace(*p))\n            return false;\n    if (strWhole.size() > 10) // guard against 63 bit overflow\n        return false;\n    if (nUnits < 0 || nUnits > COIN)\n        return false;\n    int64_t nWhole = atoi64(strWhole);\n    int64_t nValue = nWhole*COIN + nUnits;\n\n    nRet = nValue;\n    return true;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atoi64",
          "args": [
            "strWhole"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "atoi64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "283-290",
          "snippet": "inline int64_t atoi64(const std::string& str)\n{\n#ifdef _MSC_VER\n    return _atoi64(str.c_str());\n#else\n    return strtoll(str.c_str(), NULL, 10);\n#endif\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t atoi64(const std::string& str)\n{\n#ifdef _MSC_VER\n    return _atoi64(str.c_str());\n#else\n    return strtoll(str.c_str(), NULL, 10);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "strWhole.size",
          "args": [],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "623-626",
          "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  int size() const\n      {\n          return vValues.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "*p"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strWhole.insert",
          "args": [
            "strWhole.end()",
            "*p"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strWhole.end",
          "args": [],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*p"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "*p"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*p"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "*p"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool ParseMoney(const char* pszIn, int64_t& nRet)\n{\n    string strWhole;\n    int64_t nUnits = 0;\n    const char* p = pszIn;\n    while (isspace(*p))\n        p++;\n    for (; *p; p++)\n    {\n        if (*p == '.')\n        {\n            p++;\n            int64_t nMult = CENT*10;\n            while (isdigit(*p) && (nMult > 0))\n            {\n                nUnits += nMult * (*p++ - '0');\n                nMult /= 10;\n            }\n            break;\n        }\n        if (isspace(*p))\n            break;\n        if (!isdigit(*p))\n            return false;\n        strWhole.insert(strWhole.end(), *p);\n    }\n    for (; *p; p++)\n        if (!isspace(*p))\n            return false;\n    if (strWhole.size() > 10) // guard against 63 bit overflow\n        return false;\n    if (nUnits < 0 || nUnits > COIN)\n        return false;\n    int64_t nWhole = atoi64(strWhole);\n    int64_t nValue = nWhole*COIN + nUnits;\n\n    nRet = nValue;\n    return true;\n}"
  },
  {
    "function_name": "ParseMoney",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "395-398",
    "snippet": "bool ParseMoney(const string& str, int64_t& nRet)\n{\n    return ParseMoney(str.c_str(), nRet);\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ParseMoney",
          "args": [
            "str.c_str()",
            "nRet"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "ParseMoney",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "400-438",
          "snippet": "bool ParseMoney(const char* pszIn, int64_t& nRet)\n{\n    string strWhole;\n    int64_t nUnits = 0;\n    const char* p = pszIn;\n    while (isspace(*p))\n        p++;\n    for (; *p; p++)\n    {\n        if (*p == '.')\n        {\n            p++;\n            int64_t nMult = CENT*10;\n            while (isdigit(*p) && (nMult > 0))\n            {\n                nUnits += nMult * (*p++ - '0');\n                nMult /= 10;\n            }\n            break;\n        }\n        if (isspace(*p))\n            break;\n        if (!isdigit(*p))\n            return false;\n        strWhole.insert(strWhole.end(), *p);\n    }\n    for (; *p; p++)\n        if (!isspace(*p))\n            return false;\n    if (strWhole.size() > 10) // guard against 63 bit overflow\n        return false;\n    if (nUnits < 0 || nUnits > COIN)\n        return false;\n    int64_t nWhole = atoi64(strWhole);\n    int64_t nValue = nWhole*COIN + nUnits;\n\n    nRet = nValue;\n    return true;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool ParseMoney(const string& str, int64_t& nRet)\n{\n    return ParseMoney(str.c_str(), nRet);\n}"
  },
  {
    "function_name": "FormatMoney",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "371-392",
    "snippet": "string FormatMoney(int64_t n, bool fPlus)\n{\n    // Note: not using straight sprintf here because we do NOT want\n    // localized number formatting.\n    int64_t n_abs = (n > 0 ? n : -n);\n    int64_t quotient = n_abs/COIN;\n    int64_t remainder = n_abs%COIN;\n    string str = strprintf(\"%\"PRId64\".%08\"PRId64, quotient, remainder);\n\n    // Right-trim excess zeros before the decimal point:\n    int nTrim = 0;\n    for (int i = str.size()-1; (str[i] == '0' && isdigit(str[i-2])); --i)\n        ++nTrim;\n    if (nTrim)\n        str.erase(str.size()-nTrim, nTrim);\n\n    if (n < 0)\n        str.insert((unsigned int)0, 1, '-');\n    else if (fPlus && n > 0)\n        str.insert((unsigned int)0, 1, '+');\n    return str;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "str.insert",
          "args": [
            "(unsigned int)0",
            "1",
            "'+'"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "839-850",
          "snippet": "void insert(iterator it, const char* first, const char* last)\n    {\n        assert(last - first >= 0);\n        if (it == vch.begin() + nReadPos && (unsigned int)(last - first) <= nReadPos)\n        {\n            // special case for inserting at the front when there's room\n            nReadPos -= (last - first);\n            memcpy(&vch[nReadPos], &first[0], last - first);\n        }\n        else\n            vch.insert(it, first, last);\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void insert(iterator it, const char* first, const char* last)\n      {\n          assert(last - first >= 0);\n          if (it == vch.begin() + nReadPos && (unsigned int)(last - first) <= nReadPos)\n          {\n              // special case for inserting at the front when there's room\n              nReadPos -= (last - first);\n              memcpy(&vch[nReadPos], &first[0], last - first);\n          }\n          else\n              vch.insert(it, first, last);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.erase",
          "args": [
            "str.size()-nTrim",
            "nTrim"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "870-888",
          "snippet": "iterator erase(iterator first, iterator last)\n    {\n        if (first == vch.begin() + nReadPos)\n        {\n            // special case for erasing from the front\n            if (last == vch.end())\n            {\n                nReadPos = 0;\n                return vch.erase(vch.begin(), vch.end());\n            }\n            else\n            {\n                nReadPos = (last - vch.begin());\n                return last;\n            }\n        }\n        else\n            return vch.erase(first, last);\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  iterator erase(iterator first, iterator last)\n      {\n          if (first == vch.begin() + nReadPos)\n          {\n              // special case for erasing from the front\n              if (last == vch.end())\n              {\n                  nReadPos = 0;\n                  return vch.erase(vch.begin(), vch.end());\n              }\n              else\n              {\n                  nReadPos = (last - vch.begin());\n                  return last;\n              }\n          }\n          else\n              return vch.erase(first, last);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.size",
          "args": [],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "623-626",
          "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  int size() const\n      {\n          return vValues.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "str[i-2]"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"%\"PRId64\".%08\"PRId64",
            "quotient",
            "remainder"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring FormatMoney(int64_t n, bool fPlus)\n{\n    // Note: not using straight sprintf here because we do NOT want\n    // localized number formatting.\n    int64_t n_abs = (n > 0 ? n : -n);\n    int64_t quotient = n_abs/COIN;\n    int64_t remainder = n_abs%COIN;\n    string str = strprintf(\"%\"PRId64\".%08\"PRId64, quotient, remainder);\n\n    // Right-trim excess zeros before the decimal point:\n    int nTrim = 0;\n    for (int i = str.size()-1; (str[i] == '0' && isdigit(str[i-2])); --i)\n        ++nTrim;\n    if (nTrim)\n        str.erase(str.size()-nTrim, nTrim);\n\n    if (n < 0)\n        str.insert((unsigned int)0, 1, '-');\n    else if (fPlus && n > 0)\n        str.insert((unsigned int)0, 1, '+');\n    return str;\n}"
  },
  {
    "function_name": "ParseString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "351-368",
    "snippet": "void ParseString(const string& str, char c, vector<string>& v)\n{\n    if (str.empty())\n        return;\n    string::size_type i1 = 0;\n    string::size_type i2;\n    while (true)\n    {\n        i2 = str.find(c, i1);\n        if (i2 == str.npos)\n        {\n            v.push_back(str.substr(i1));\n            return;\n        }\n        v.push_back(str.substr(i1, i2-i1));\n        i1 = i2+1;\n    }\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "v.push_back",
          "args": [
            "str.substr(i1, i2-i1)"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.substr",
          "args": [
            "i1",
            "i2-i1"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.push_back",
          "args": [
            "str.substr(i1)"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.substr",
          "args": [
            "i1"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.find",
          "args": [
            "c",
            "i1"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.empty",
          "args": [],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvoid ParseString(const string& str, char c, vector<string>& v)\n{\n    if (str.empty())\n        return;\n    string::size_type i1 = 0;\n    string::size_type i2;\n    while (true)\n    {\n        i2 = str.find(c, i1);\n        if (i2 == str.npos)\n        {\n            v.push_back(str.substr(i1));\n            return;\n        }\n        v.push_back(str.substr(i1, i2-i1));\n        i1 = i2+1;\n    }\n}"
  },
  {
    "function_name": "error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "340-348",
    "snippet": "bool error(const char *format, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, format);\n    std::string str = vstrprintf(format, arg_ptr);\n    va_end(arg_ptr);\n    printf(\"ERROR: %s\\n\", str.c_str());\n    return false;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ERROR: %s\\n\"",
            "str.c_str()"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "arg_ptr"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vstrprintf",
          "args": [
            "format",
            "arg_ptr"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "vstrprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "291-320",
          "snippet": "string vstrprintf(const char *format, va_list ap)\n{\n    char buffer[50000];\n    char* p = buffer;\n    int limit = sizeof(buffer);\n    int ret;\n    while (true)\n    {\n        va_list arg_ptr;\n        va_copy(arg_ptr, ap);\n#ifdef WIN32\n        ret = _vsnprintf(p, limit, format, arg_ptr);\n#else\n        ret = vsnprintf(p, limit, format, arg_ptr);\n#endif\n        va_end(arg_ptr);\n        if (ret >= 0 && ret < limit)\n            break;\n        if (p != buffer)\n            delete[] p;\n        limit *= 2;\n        p = new char[limit];\n        if (p == NULL)\n            throw std::bad_alloc();\n    }\n    string str(p, p+ret);\n    if (p != buffer)\n        delete[] p;\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring vstrprintf(const char *format, va_list ap)\n{\n    char buffer[50000];\n    char* p = buffer;\n    int limit = sizeof(buffer);\n    int ret;\n    while (true)\n    {\n        va_list arg_ptr;\n        va_copy(arg_ptr, ap);\n#ifdef WIN32\n        ret = _vsnprintf(p, limit, format, arg_ptr);\n#else\n        ret = vsnprintf(p, limit, format, arg_ptr);\n#endif\n        va_end(arg_ptr);\n        if (ret >= 0 && ret < limit)\n            break;\n        if (p != buffer)\n            delete[] p;\n        limit *= 2;\n        p = new char[limit];\n        if (p == NULL)\n            throw std::bad_alloc();\n    }\n    string str(p, p+ret);\n    if (p != buffer)\n        delete[] p;\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "arg_ptr",
            "format"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool error(const char *format, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, format);\n    std::string str = vstrprintf(format, arg_ptr);\n    va_end(arg_ptr);\n    printf(\"ERROR: %s\\n\", str.c_str());\n    return false;\n}"
  },
  {
    "function_name": "real_strprintf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "331-338",
    "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "arg_ptr"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vstrprintf",
          "args": [
            "format.c_str()",
            "arg_ptr"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "vstrprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "291-320",
          "snippet": "string vstrprintf(const char *format, va_list ap)\n{\n    char buffer[50000];\n    char* p = buffer;\n    int limit = sizeof(buffer);\n    int ret;\n    while (true)\n    {\n        va_list arg_ptr;\n        va_copy(arg_ptr, ap);\n#ifdef WIN32\n        ret = _vsnprintf(p, limit, format, arg_ptr);\n#else\n        ret = vsnprintf(p, limit, format, arg_ptr);\n#endif\n        va_end(arg_ptr);\n        if (ret >= 0 && ret < limit)\n            break;\n        if (p != buffer)\n            delete[] p;\n        limit *= 2;\n        p = new char[limit];\n        if (p == NULL)\n            throw std::bad_alloc();\n    }\n    string str(p, p+ret);\n    if (p != buffer)\n        delete[] p;\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring vstrprintf(const char *format, va_list ap)\n{\n    char buffer[50000];\n    char* p = buffer;\n    int limit = sizeof(buffer);\n    int ret;\n    while (true)\n    {\n        va_list arg_ptr;\n        va_copy(arg_ptr, ap);\n#ifdef WIN32\n        ret = _vsnprintf(p, limit, format, arg_ptr);\n#else\n        ret = vsnprintf(p, limit, format, arg_ptr);\n#endif\n        va_end(arg_ptr);\n        if (ret >= 0 && ret < limit)\n            break;\n        if (p != buffer)\n            delete[] p;\n        limit *= 2;\n        p = new char[limit];\n        if (p == NULL)\n            throw std::bad_alloc();\n    }\n    string str(p, p+ret);\n    if (p != buffer)\n        delete[] p;\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "format.c_str",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "arg_ptr",
            "dummy"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
  },
  {
    "function_name": "real_strprintf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "322-329",
    "snippet": "string real_strprintf(const char *format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format, arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "arg_ptr"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vstrprintf",
          "args": [
            "format",
            "arg_ptr"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "vstrprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "291-320",
          "snippet": "string vstrprintf(const char *format, va_list ap)\n{\n    char buffer[50000];\n    char* p = buffer;\n    int limit = sizeof(buffer);\n    int ret;\n    while (true)\n    {\n        va_list arg_ptr;\n        va_copy(arg_ptr, ap);\n#ifdef WIN32\n        ret = _vsnprintf(p, limit, format, arg_ptr);\n#else\n        ret = vsnprintf(p, limit, format, arg_ptr);\n#endif\n        va_end(arg_ptr);\n        if (ret >= 0 && ret < limit)\n            break;\n        if (p != buffer)\n            delete[] p;\n        limit *= 2;\n        p = new char[limit];\n        if (p == NULL)\n            throw std::bad_alloc();\n    }\n    string str(p, p+ret);\n    if (p != buffer)\n        delete[] p;\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring vstrprintf(const char *format, va_list ap)\n{\n    char buffer[50000];\n    char* p = buffer;\n    int limit = sizeof(buffer);\n    int ret;\n    while (true)\n    {\n        va_list arg_ptr;\n        va_copy(arg_ptr, ap);\n#ifdef WIN32\n        ret = _vsnprintf(p, limit, format, arg_ptr);\n#else\n        ret = vsnprintf(p, limit, format, arg_ptr);\n#endif\n        va_end(arg_ptr);\n        if (ret >= 0 && ret < limit)\n            break;\n        if (p != buffer)\n            delete[] p;\n        limit *= 2;\n        p = new char[limit];\n        if (p == NULL)\n            throw std::bad_alloc();\n    }\n    string str(p, p+ret);\n    if (p != buffer)\n        delete[] p;\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "arg_ptr",
            "dummy"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const char *format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format, arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
  },
  {
    "function_name": "vstrprintf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "291-320",
    "snippet": "string vstrprintf(const char *format, va_list ap)\n{\n    char buffer[50000];\n    char* p = buffer;\n    int limit = sizeof(buffer);\n    int ret;\n    while (true)\n    {\n        va_list arg_ptr;\n        va_copy(arg_ptr, ap);\n#ifdef WIN32\n        ret = _vsnprintf(p, limit, format, arg_ptr);\n#else\n        ret = vsnprintf(p, limit, format, arg_ptr);\n#endif\n        va_end(arg_ptr);\n        if (ret >= 0 && ret < limit)\n            break;\n        if (p != buffer)\n            delete[] p;\n        limit *= 2;\n        p = new char[limit];\n        if (p == NULL)\n            throw std::bad_alloc();\n    }\n    string str(p, p+ret);\n    if (p != buffer)\n        delete[] p;\n    return str;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::bad_alloc",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "arg_ptr"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsnprintf",
          "args": [
            "p",
            "limit",
            "format",
            "arg_ptr"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_vsnprintf",
          "args": [
            "p",
            "limit",
            "format",
            "arg_ptr"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_copy",
          "args": [
            "arg_ptr",
            "ap"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring vstrprintf(const char *format, va_list ap)\n{\n    char buffer[50000];\n    char* p = buffer;\n    int limit = sizeof(buffer);\n    int ret;\n    while (true)\n    {\n        va_list arg_ptr;\n        va_copy(arg_ptr, ap);\n#ifdef WIN32\n        ret = _vsnprintf(p, limit, format, arg_ptr);\n#else\n        ret = vsnprintf(p, limit, format, arg_ptr);\n#endif\n        va_end(arg_ptr);\n        if (ret >= 0 && ret < limit)\n            break;\n        if (p != buffer)\n            delete[] p;\n        limit *= 2;\n        p = new char[limit];\n        if (p == NULL)\n            throw std::bad_alloc();\n    }\n    string str(p, p+ret);\n    if (p != buffer)\n        delete[] p;\n    return str;\n}"
  },
  {
    "function_name": "OutputDebugStringF",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "207-289",
    "snippet": "inline int OutputDebugStringF(const char* pszFormat, ...)\n{\n    int ret = 0;\n    if (fPrintToConsole)\n    {\n        // print to console\n        va_list arg_ptr;\n        va_start(arg_ptr, pszFormat);\n        ret = vprintf(pszFormat, arg_ptr);\n        va_end(arg_ptr);\n    }\n    else if (!fPrintToDebugger)\n    {\n        // print to debug.log\n\n        if (!fileout)\n        {\n            boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n            fileout = fopen(pathDebug.string().c_str(), \"a\");\n            if (fileout) setbuf(fileout, NULL); // unbuffered\n        }\n        if (fileout)\n        {\n            static bool fStartedNewLine = true;\n\n            // This routine may be called by global destructors during shutdown.\n            // Since the order of destruction of static/global objects is undefined,\n            // allocate mutexDebugLog on the heap the first time this routine\n            // is called to avoid crashes during shutdown.\n            static boost::mutex* mutexDebugLog = NULL;\n            if (mutexDebugLog == NULL) mutexDebugLog = new boost::mutex();\n            boost::mutex::scoped_lock scoped_lock(*mutexDebugLog);\n\n            // reopen the log file, if requested\n            if (fReopenDebugLog) {\n                fReopenDebugLog = false;\n                boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n                if (freopen(pathDebug.string().c_str(),\"a\",fileout) != NULL)\n                    setbuf(fileout, NULL); // unbuffered\n            }\n\n            // Debug print useful for profiling\n            if (fLogTimestamps && fStartedNewLine)\n                fprintf(fileout, \"%s \", DateTimeStrFormat(\"%x %H:%M:%S\", GetTime()).c_str());\n            if (pszFormat[strlen(pszFormat) - 1] == '\\n')\n                fStartedNewLine = true;\n            else\n                fStartedNewLine = false;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            ret = vfprintf(fileout, pszFormat, arg_ptr);\n            va_end(arg_ptr);\n        }\n    }\n\n#ifdef WIN32\n    if (fPrintToDebugger)\n    {\n        static CCriticalSection cs_OutputDebugStringF;\n\n        // accumulate and output a line at a time\n        {\n            LOCK(cs_OutputDebugStringF);\n            static std::string buffer;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            buffer += vstrprintf(pszFormat, arg_ptr);\n            va_end(arg_ptr);\n\n            int line_start = 0, line_end;\n            while((line_end = buffer.find('\\n', line_start)) != -1)\n            {\n                OutputDebugStringA(buffer.substr(line_start, line_end - line_start).c_str());\n                line_start = line_end + 1;\n            }\n            buffer.erase(0, line_start);\n        }\n    }\n#endif\n    return ret;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "bool fPrintToConsole = false;",
      "bool fPrintToDebugger = false;",
      "bool fLogTimestamps = false;",
      "bool fReopenDebugLog = false;",
      "static FILE* fileout = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "buffer.erase",
          "args": [
            "0",
            "line_start"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "870-888",
          "snippet": "iterator erase(iterator first, iterator last)\n    {\n        if (first == vch.begin() + nReadPos)\n        {\n            // special case for erasing from the front\n            if (last == vch.end())\n            {\n                nReadPos = 0;\n                return vch.erase(vch.begin(), vch.end());\n            }\n            else\n            {\n                nReadPos = (last - vch.begin());\n                return last;\n            }\n        }\n        else\n            return vch.erase(first, last);\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  iterator erase(iterator first, iterator last)\n      {\n          if (first == vch.begin() + nReadPos)\n          {\n              // special case for erasing from the front\n              if (last == vch.end())\n              {\n                  nReadPos = 0;\n                  return vch.erase(vch.begin(), vch.end());\n              }\n              else\n              {\n                  nReadPos = (last - vch.begin());\n                  return last;\n              }\n          }\n          else\n              return vch.erase(first, last);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "OutputDebugStringA",
          "args": [
            "buffer.substr(line_start, line_end - line_start).c_str()"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer.substr",
          "args": [],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer.substr",
          "args": [
            "line_start",
            "line_end - line_start"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer.find",
          "args": [
            "'\\n'",
            "line_start"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "arg_ptr"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vstrprintf",
          "args": [
            "pszFormat",
            "arg_ptr"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "vstrprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "291-320",
          "snippet": "string vstrprintf(const char *format, va_list ap)\n{\n    char buffer[50000];\n    char* p = buffer;\n    int limit = sizeof(buffer);\n    int ret;\n    while (true)\n    {\n        va_list arg_ptr;\n        va_copy(arg_ptr, ap);\n#ifdef WIN32\n        ret = _vsnprintf(p, limit, format, arg_ptr);\n#else\n        ret = vsnprintf(p, limit, format, arg_ptr);\n#endif\n        va_end(arg_ptr);\n        if (ret >= 0 && ret < limit)\n            break;\n        if (p != buffer)\n            delete[] p;\n        limit *= 2;\n        p = new char[limit];\n        if (p == NULL)\n            throw std::bad_alloc();\n    }\n    string str(p, p+ret);\n    if (p != buffer)\n        delete[] p;\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring vstrprintf(const char *format, va_list ap)\n{\n    char buffer[50000];\n    char* p = buffer;\n    int limit = sizeof(buffer);\n    int ret;\n    while (true)\n    {\n        va_list arg_ptr;\n        va_copy(arg_ptr, ap);\n#ifdef WIN32\n        ret = _vsnprintf(p, limit, format, arg_ptr);\n#else\n        ret = vsnprintf(p, limit, format, arg_ptr);\n#endif\n        va_end(arg_ptr);\n        if (ret >= 0 && ret < limit)\n            break;\n        if (p != buffer)\n            delete[] p;\n        limit *= 2;\n        p = new char[limit];\n        if (p == NULL)\n            throw std::bad_alloc();\n    }\n    string str(p, p+ret);\n    if (p != buffer)\n        delete[] p;\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "arg_ptr",
            "pszFormat"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs_OutputDebugStringF"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "arg_ptr"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vfprintf",
          "args": [
            "fileout",
            "pszFormat",
            "arg_ptr"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "arg_ptr",
            "pszFormat"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pszFormat"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fileout",
            "\"%s \"",
            "DateTimeStrFormat(\"%x %H:%M:%S\", GetTime()).c_str()"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DateTimeStrFormat",
          "args": [],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DateTimeStrFormat",
          "args": [
            "\"%x %H:%M:%S\"",
            "GetTime()"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "DateTimeStrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "376-383",
          "snippet": "inline std::string DateTimeStrFormat(const char* pszFormat, int64_t nTime)\n{\n    time_t n = nTime;\n    struct tm* ptmTime = gmtime(&n);\n    char pszTime[200];\n    strftime(pszTime, sizeof(pszTime), pszFormat, ptmTime);\n    return pszTime;\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline std::string DateTimeStrFormat(const char* pszFormat, int64_t nTime)\n{\n    time_t n = nTime;\n    struct tm* ptmTime = gmtime(&n);\n    char pszTime[200];\n    strftime(pszTime, sizeof(pszTime), pszFormat, ptmTime);\n    return pszTime;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetTime",
          "args": [],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "GetTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1182-1187",
          "snippet": "int64_t GetTime()\n{\n    if (nMockTime) return nMockTime;\n\n    return time(NULL);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int64_t nMockTime = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic int64_t nMockTime = 0;\n\nint64_t GetTime()\n{\n    if (nMockTime) return nMockTime;\n\n    return time(NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "setbuf",
          "args": [
            "fileout",
            "NULL"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freopen",
          "args": [
            "pathDebug.string().c_str()",
            "\"a\"",
            "fileout"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathDebug.string",
          "args": [],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathDebug.string",
          "args": [],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetDataDir",
          "args": [],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setbuf",
          "args": [
            "fileout",
            "NULL"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "pathDebug.string().c_str()",
            "\"a\""
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathDebug.string",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathDebug.string",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetDataDir",
          "args": [],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "arg_ptr"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vprintf",
          "args": [
            "pszFormat",
            "arg_ptr"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "arg_ptr",
            "pszFormat"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool fPrintToConsole = false;\nbool fPrintToDebugger = false;\nbool fLogTimestamps = false;\nbool fReopenDebugLog = false;\nstatic FILE* fileout = NULL;\n\ninline int OutputDebugStringF(const char* pszFormat, ...)\n{\n    int ret = 0;\n    if (fPrintToConsole)\n    {\n        // print to console\n        va_list arg_ptr;\n        va_start(arg_ptr, pszFormat);\n        ret = vprintf(pszFormat, arg_ptr);\n        va_end(arg_ptr);\n    }\n    else if (!fPrintToDebugger)\n    {\n        // print to debug.log\n\n        if (!fileout)\n        {\n            boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n            fileout = fopen(pathDebug.string().c_str(), \"a\");\n            if (fileout) setbuf(fileout, NULL); // unbuffered\n        }\n        if (fileout)\n        {\n            static bool fStartedNewLine = true;\n\n            // This routine may be called by global destructors during shutdown.\n            // Since the order of destruction of static/global objects is undefined,\n            // allocate mutexDebugLog on the heap the first time this routine\n            // is called to avoid crashes during shutdown.\n            static boost::mutex* mutexDebugLog = NULL;\n            if (mutexDebugLog == NULL) mutexDebugLog = new boost::mutex();\n            boost::mutex::scoped_lock scoped_lock(*mutexDebugLog);\n\n            // reopen the log file, if requested\n            if (fReopenDebugLog) {\n                fReopenDebugLog = false;\n                boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n                if (freopen(pathDebug.string().c_str(),\"a\",fileout) != NULL)\n                    setbuf(fileout, NULL); // unbuffered\n            }\n\n            // Debug print useful for profiling\n            if (fLogTimestamps && fStartedNewLine)\n                fprintf(fileout, \"%s \", DateTimeStrFormat(\"%x %H:%M:%S\", GetTime()).c_str());\n            if (pszFormat[strlen(pszFormat) - 1] == '\\n')\n                fStartedNewLine = true;\n            else\n                fStartedNewLine = false;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            ret = vfprintf(fileout, pszFormat, arg_ptr);\n            va_end(arg_ptr);\n        }\n    }\n\n#ifdef WIN32\n    if (fPrintToDebugger)\n    {\n        static CCriticalSection cs_OutputDebugStringF;\n\n        // accumulate and output a line at a time\n        {\n            LOCK(cs_OutputDebugStringF);\n            static std::string buffer;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            buffer += vstrprintf(pszFormat, arg_ptr);\n            va_end(arg_ptr);\n\n            int line_start = 0, line_end;\n            while((line_end = buffer.find('\\n', line_start)) != -1)\n            {\n                OutputDebugStringA(buffer.substr(line_start, line_end - line_start).c_str());\n                line_start = line_end + 1;\n            }\n            buffer.erase(0, line_start);\n        }\n    }\n#endif\n    return ret;\n}"
  },
  {
    "function_name": "GetRandHash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "193-198",
    "snippet": "uint256 GetRandHash()\n{\n    uint256 hash;\n    RAND_bytes((unsigned char*)&hash, sizeof(hash));\n    return hash;\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RAND_bytes",
          "args": [
            "(unsigned char*)&hash",
            "sizeof(hash)"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nuint256 GetRandHash()\n{\n    uint256 hash;\n    RAND_bytes((unsigned char*)&hash, sizeof(hash));\n    return hash;\n}"
  },
  {
    "function_name": "GetRandInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "188-191",
    "snippet": "int GetRandInt(int nMax)\n{\n    return GetRand(nMax);\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetRand",
          "args": [
            "nMax"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "GetRandInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "188-191",
          "snippet": "int GetRandInt(int nMax)\n{\n    return GetRand(nMax);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nint GetRandInt(int nMax)\n{\n    return GetRand(nMax);\n}"
  },
  {
    "function_name": "GetRand",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "173-186",
    "snippet": "uint64_t GetRand(uint64_t nMax)\n{\n    if (nMax == 0)\n        return 0;\n\n    // The range of the random source must be a multiple of the modulus\n    // to give every possible output value an equal possibility\n    uint64_t nRange = (std::numeric_limits<uint64_t>::max() / nMax) * nMax;\n    uint64_t nRand = 0;\n    do\n        RAND_bytes((unsigned char*)&nRand, sizeof(nRand));\n    while (nRand >= nRange);\n    return (nRand % nMax);\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RAND_bytes",
          "args": [
            "(unsigned char*)&nRand",
            "sizeof(nRand)"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::numeric_limits<uint64_t>::max",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nuint64_t GetRand(uint64_t nMax)\n{\n    if (nMax == 0)\n        return 0;\n\n    // The range of the random source must be a multiple of the modulus\n    // to give every possible output value an equal possibility\n    uint64_t nRange = (std::numeric_limits<uint64_t>::max() / nMax) * nMax;\n    uint64_t nRand = 0;\n    do\n        RAND_bytes((unsigned char*)&nRand, sizeof(nRand));\n    while (nRand >= nRange);\n    return (nRand % nMax);\n}"
  },
  {
    "function_name": "RandAddSeedPerfmon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "146-171",
    "snippet": "void RandAddSeedPerfmon()\n{\n    RandAddSeed();\n\n    // This can take up to 2 seconds, so only do it every 10 minutes\n    static int64_t nLastPerfmon;\n    if (GetTime() < nLastPerfmon + 10 * 60)\n        return;\n    nLastPerfmon = GetTime();\n\n#ifdef WIN32\n    // Don't need this on Linux, OpenSSL automatically uses /dev/urandom\n    // Seed with the entire set of perfmon data\n    unsigned char pdata[250000];\n    memset(pdata, 0, sizeof(pdata));\n    unsigned long nSize = sizeof(pdata);\n    long ret = RegQueryValueExA(HKEY_PERFORMANCE_DATA, \"Global\", NULL, NULL, pdata, &nSize);\n    RegCloseKey(HKEY_PERFORMANCE_DATA);\n    if (ret == ERROR_SUCCESS)\n    {\n        RAND_add(pdata, nSize, nSize/100.0);\n        memset(pdata, 0, nSize);\n        printf(\"RandAddSeed() %lu bytes\\n\", nSize);\n    }\n#endif\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"RandAddSeed() %lu bytes\\n\"",
            "nSize"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "pdata",
            "0",
            "nSize"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RAND_add",
          "args": [
            "pdata",
            "nSize",
            "nSize/100.0"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RegCloseKey",
          "args": [
            "HKEY_PERFORMANCE_DATA"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RegQueryValueExA",
          "args": [
            "HKEY_PERFORMANCE_DATA",
            "\"Global\"",
            "NULL",
            "NULL",
            "pdata",
            "&nSize"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "pdata",
            "0",
            "sizeof(pdata)"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetTime",
          "args": [],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "GetTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1182-1187",
          "snippet": "int64_t GetTime()\n{\n    if (nMockTime) return nMockTime;\n\n    return time(NULL);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int64_t nMockTime = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic int64_t nMockTime = 0;\n\nint64_t GetTime()\n{\n    if (nMockTime) return nMockTime;\n\n    return time(NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "RandAddSeed",
          "args": [],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "RandAddSeedPerfmon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "146-171",
          "snippet": "void RandAddSeedPerfmon()\n{\n    RandAddSeed();\n\n    // This can take up to 2 seconds, so only do it every 10 minutes\n    static int64_t nLastPerfmon;\n    if (GetTime() < nLastPerfmon + 10 * 60)\n        return;\n    nLastPerfmon = GetTime();\n\n#ifdef WIN32\n    // Don't need this on Linux, OpenSSL automatically uses /dev/urandom\n    // Seed with the entire set of perfmon data\n    unsigned char pdata[250000];\n    memset(pdata, 0, sizeof(pdata));\n    unsigned long nSize = sizeof(pdata);\n    long ret = RegQueryValueExA(HKEY_PERFORMANCE_DATA, \"Global\", NULL, NULL, pdata, &nSize);\n    RegCloseKey(HKEY_PERFORMANCE_DATA);\n    if (ret == ERROR_SUCCESS)\n    {\n        RAND_add(pdata, nSize, nSize/100.0);\n        memset(pdata, 0, nSize);\n        printf(\"RandAddSeed() %lu bytes\\n\", nSize);\n    }\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvoid RandAddSeedPerfmon()\n{\n    RandAddSeed();\n\n    // This can take up to 2 seconds, so only do it every 10 minutes\n    static int64_t nLastPerfmon;\n    if (GetTime() < nLastPerfmon + 10 * 60)\n        return;\n    nLastPerfmon = GetTime();\n\n#ifdef WIN32\n    // Don't need this on Linux, OpenSSL automatically uses /dev/urandom\n    // Seed with the entire set of perfmon data\n    unsigned char pdata[250000];\n    memset(pdata, 0, sizeof(pdata));\n    unsigned long nSize = sizeof(pdata);\n    long ret = RegQueryValueExA(HKEY_PERFORMANCE_DATA, \"Global\", NULL, NULL, pdata, &nSize);\n    RegCloseKey(HKEY_PERFORMANCE_DATA);\n    if (ret == ERROR_SUCCESS)\n    {\n        RAND_add(pdata, nSize, nSize/100.0);\n        memset(pdata, 0, nSize);\n        printf(\"RandAddSeed() %lu bytes\\n\", nSize);\n    }\n#endif\n}"
  },
  {
    "function_name": "RandAddSeed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "138-144",
    "snippet": "void RandAddSeed()\n{\n    // Seed with CPU performance counter\n    int64_t nCounter = GetPerformanceCounter();\n    RAND_add(&nCounter, sizeof(nCounter), 1.5);\n    memset(&nCounter, 0, sizeof(nCounter));\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&nCounter",
            "0",
            "sizeof(nCounter)"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RAND_add",
          "args": [
            "&nCounter",
            "sizeof(nCounter)",
            "1.5"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetPerformanceCounter",
          "args": [],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "GetPerformanceCounter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "357-368",
          "snippet": "inline int64_t GetPerformanceCounter()\n{\n    int64_t nCounter = 0;\n#ifdef WIN32\n    QueryPerformanceCounter((LARGE_INTEGER*)&nCounter);\n#else\n    timeval t;\n    gettimeofday(&t, NULL);\n    nCounter = (int64_t) t.tv_sec * 1000000 + t.tv_usec;\n#endif\n    return nCounter;\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t GetPerformanceCounter()\n{\n    int64_t nCounter = 0;\n#ifdef WIN32\n    QueryPerformanceCounter((LARGE_INTEGER*)&nCounter);\n#else\n    timeval t;\n    gettimeofday(&t, NULL);\n    nCounter = (int64_t) t.tv_sec * 1000000 + t.tv_usec;\n#endif\n    return nCounter;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvoid RandAddSeed()\n{\n    // Seed with CPU performance counter\n    int64_t nCounter = GetPerformanceCounter();\n    RAND_add(&nCounter, sizeof(nCounter), 1.5);\n    memset(&nCounter, 0, sizeof(nCounter));\n}"
  },
  {
    "function_name": "CInit",
    "container": "CInit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "104-119",
    "snippet": "CInit()\n    {\n        // Init OpenSSL library multithreading support\n        ppmutexOpenSSL = (CCriticalSection**)OPENSSL_malloc(CRYPTO_num_locks() * sizeof(CCriticalSection*));\n        for (int i = 0; i < CRYPTO_num_locks(); i++)\n            ppmutexOpenSSL[i] = new CCriticalSection();\n        CRYPTO_set_locking_callback(locking_callback);\n\n#ifdef WIN32\n        // Seed random number generator with screen scrape and other hardware sources\n        RAND_screen();\n#endif\n\n        // Seed random number generator with performance counter\n        RandAddSeed();\n    }",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static CCriticalSection** ppmutexOpenSSL;",
      "class CInit\n{\npublic:\n    CInit()\n    {\n        // Init OpenSSL library multithreading support\n        ppmutexOpenSSL = (CCriticalSection**)OPENSSL_malloc(CRYPTO_num_locks() * sizeof(CCriticalSection*));\n        for (int i = 0; i < CRYPTO_num_locks(); i++)\n            ppmutexOpenSSL[i] = new CCriticalSection();\n        CRYPTO_set_locking_callback(locking_callback);\n\n#ifdef WIN32\n        // Seed random number generator with screen scrape and other hardware sources\n        RAND_screen();\n#endif\n\n        // Seed random number generator with performance counter\n        RandAddSeed();\n    }\n    ~CInit()\n    {\n        // Shutdown OpenSSL library multithreading support\n        CRYPTO_set_locking_callback(NULL);\n        for (int i = 0; i < CRYPTO_num_locks(); i++)\n            delete ppmutexOpenSSL[i];\n        OPENSSL_free(ppmutexOpenSSL);\n    }\n}\ninstance_of_cinit;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RandAddSeed",
          "args": [],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "RandAddSeedPerfmon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "146-171",
          "snippet": "void RandAddSeedPerfmon()\n{\n    RandAddSeed();\n\n    // This can take up to 2 seconds, so only do it every 10 minutes\n    static int64_t nLastPerfmon;\n    if (GetTime() < nLastPerfmon + 10 * 60)\n        return;\n    nLastPerfmon = GetTime();\n\n#ifdef WIN32\n    // Don't need this on Linux, OpenSSL automatically uses /dev/urandom\n    // Seed with the entire set of perfmon data\n    unsigned char pdata[250000];\n    memset(pdata, 0, sizeof(pdata));\n    unsigned long nSize = sizeof(pdata);\n    long ret = RegQueryValueExA(HKEY_PERFORMANCE_DATA, \"Global\", NULL, NULL, pdata, &nSize);\n    RegCloseKey(HKEY_PERFORMANCE_DATA);\n    if (ret == ERROR_SUCCESS)\n    {\n        RAND_add(pdata, nSize, nSize/100.0);\n        memset(pdata, 0, nSize);\n        printf(\"RandAddSeed() %lu bytes\\n\", nSize);\n    }\n#endif\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvoid RandAddSeedPerfmon()\n{\n    RandAddSeed();\n\n    // This can take up to 2 seconds, so only do it every 10 minutes\n    static int64_t nLastPerfmon;\n    if (GetTime() < nLastPerfmon + 10 * 60)\n        return;\n    nLastPerfmon = GetTime();\n\n#ifdef WIN32\n    // Don't need this on Linux, OpenSSL automatically uses /dev/urandom\n    // Seed with the entire set of perfmon data\n    unsigned char pdata[250000];\n    memset(pdata, 0, sizeof(pdata));\n    unsigned long nSize = sizeof(pdata);\n    long ret = RegQueryValueExA(HKEY_PERFORMANCE_DATA, \"Global\", NULL, NULL, pdata, &nSize);\n    RegCloseKey(HKEY_PERFORMANCE_DATA);\n    if (ret == ERROR_SUCCESS)\n    {\n        RAND_add(pdata, nSize, nSize/100.0);\n        memset(pdata, 0, nSize);\n        printf(\"RandAddSeed() %lu bytes\\n\", nSize);\n    }\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "RAND_screen",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTO_set_locking_callback",
          "args": [
            "locking_callback"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTO_num_locks",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OPENSSL_malloc",
          "args": [
            "CRYPTO_num_locks() * sizeof(CCriticalSection*)"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTO_num_locks",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic CCriticalSection** ppmutexOpenSSL;\nclass CInit\n{\npublic:\n    CInit()\n    {\n        // Init OpenSSL library multithreading support\n        ppmutexOpenSSL = (CCriticalSection**)OPENSSL_malloc(CRYPTO_num_locks() * sizeof(CCriticalSection*));\n        for (int i = 0; i < CRYPTO_num_locks(); i++)\n            ppmutexOpenSSL[i] = new CCriticalSection();\n        CRYPTO_set_locking_callback(locking_callback);\n\n#ifdef WIN32\n        // Seed random number generator with screen scrape and other hardware sources\n        RAND_screen();\n#endif\n\n        // Seed random number generator with performance counter\n        RandAddSeed();\n    }\n    ~CInit()\n    {\n        // Shutdown OpenSSL library multithreading support\n        CRYPTO_set_locking_callback(NULL);\n        for (int i = 0; i < CRYPTO_num_locks(); i++)\n            delete ppmutexOpenSSL[i];\n        OPENSSL_free(ppmutexOpenSSL);\n    }\n}\ninstance_of_cinit;\n\nCInit {\n  CInit()\n      {\n          // Init OpenSSL library multithreading support\n          ppmutexOpenSSL = (CCriticalSection**)OPENSSL_malloc(CRYPTO_num_locks() * sizeof(CCriticalSection*));\n          for (int i = 0; i < CRYPTO_num_locks(); i++)\n              ppmutexOpenSSL[i] = new CCriticalSection();\n          CRYPTO_set_locking_callback(locking_callback);\n  \n  #ifdef WIN32\n          // Seed random number generator with screen scrape and other hardware sources\n          RAND_screen();\n  #endif\n  \n          // Seed random number generator with performance counter\n          RandAddSeed();\n      }\n}"
  },
  {
    "function_name": "locking_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
    "lines": "89-96",
    "snippet": "void locking_callback(int mode, int i, const char* file, int line)\n{\n    if (mode & CRYPTO_LOCK) {\n        ENTER_CRITICAL_SECTION(*ppmutexOpenSSL[i]);\n    } else {\n        LEAVE_CRITICAL_SECTION(*ppmutexOpenSSL[i]);\n    }\n}",
    "includes": [
      "#include <execinfo.h>",
      "# include <sys/prctl.h>",
      "#include \"shlobj.h\"",
      "#include <io.h> /* for _commit */",
      "#include <stdarg.h>",
      "#include <openssl/rand.h>",
      "#include <openssl/crypto.h>",
      "#include <boost/thread.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/program_options/parsers.hpp>",
      "#include <boost/program_options/detail/config_file.hpp>",
      "#include <boost/algorithm/string/join.hpp>",
      "#include \"ui_interface.h\"",
      "#include \"version.h\"",
      "#include \"strlcpy.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static CCriticalSection** ppmutexOpenSSL;",
      "class CInit\n{\npublic:\n    CInit()\n    {\n        // Init OpenSSL library multithreading support\n        ppmutexOpenSSL = (CCriticalSection**)OPENSSL_malloc(CRYPTO_num_locks() * sizeof(CCriticalSection*));\n        for (int i = 0; i < CRYPTO_num_locks(); i++)\n            ppmutexOpenSSL[i] = new CCriticalSection();\n        CRYPTO_set_locking_callback(locking_callback);\n\n#ifdef WIN32\n        // Seed random number generator with screen scrape and other hardware sources\n        RAND_screen();\n#endif\n\n        // Seed random number generator with performance counter\n        RandAddSeed();\n    }\n    ~CInit()\n    {\n        // Shutdown OpenSSL library multithreading support\n        CRYPTO_set_locking_callback(NULL);\n        for (int i = 0; i < CRYPTO_num_locks(); i++)\n            delete ppmutexOpenSSL[i];\n        OPENSSL_free(ppmutexOpenSSL);\n    }\n}\ninstance_of_cinit;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "LEAVE_CRITICAL_SECTION",
          "args": [
            "*ppmutexOpenSSL[i]"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENTER_CRITICAL_SECTION",
          "args": [
            "*ppmutexOpenSSL[i]"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic CCriticalSection** ppmutexOpenSSL;\nclass CInit\n{\npublic:\n    CInit()\n    {\n        // Init OpenSSL library multithreading support\n        ppmutexOpenSSL = (CCriticalSection**)OPENSSL_malloc(CRYPTO_num_locks() * sizeof(CCriticalSection*));\n        for (int i = 0; i < CRYPTO_num_locks(); i++)\n            ppmutexOpenSSL[i] = new CCriticalSection();\n        CRYPTO_set_locking_callback(locking_callback);\n\n#ifdef WIN32\n        // Seed random number generator with screen scrape and other hardware sources\n        RAND_screen();\n#endif\n\n        // Seed random number generator with performance counter\n        RandAddSeed();\n    }\n    ~CInit()\n    {\n        // Shutdown OpenSSL library multithreading support\n        CRYPTO_set_locking_callback(NULL);\n        for (int i = 0; i < CRYPTO_num_locks(); i++)\n            delete ppmutexOpenSSL[i];\n        OPENSSL_free(ppmutexOpenSSL);\n    }\n}\ninstance_of_cinit;\n\nvoid locking_callback(int mode, int i, const char* file, int line)\n{\n    if (mode & CRYPTO_LOCK) {\n        ENTER_CRITICAL_SECTION(*ppmutexOpenSSL[i]);\n    } else {\n        LEAVE_CRITICAL_SECTION(*ppmutexOpenSSL[i]);\n    }\n}"
  }
]