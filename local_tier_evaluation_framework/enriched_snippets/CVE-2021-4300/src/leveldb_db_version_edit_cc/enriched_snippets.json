[
  {
    "function_name": "DebugString",
    "container": "VersionEdit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.cc",
    "lines": "212-264",
    "snippet": "std::string VersionEdit::DebugString() const {\n  std::string r;\n  r.append(\"VersionEdit {\");\n  if (has_comparator_) {\n    r.append(\"\\n  Comparator: \");\n    r.append(comparator_);\n  }\n  if (has_log_number_) {\n    r.append(\"\\n  LogNumber: \");\n    AppendNumberTo(&r, log_number_);\n  }\n  if (has_prev_log_number_) {\n    r.append(\"\\n  PrevLogNumber: \");\n    AppendNumberTo(&r, prev_log_number_);\n  }\n  if (has_next_file_number_) {\n    r.append(\"\\n  NextFile: \");\n    AppendNumberTo(&r, next_file_number_);\n  }\n  if (has_last_sequence_) {\n    r.append(\"\\n  LastSeq: \");\n    AppendNumberTo(&r, last_sequence_);\n  }\n  for (size_t i = 0; i < compact_pointers_.size(); i++) {\n    r.append(\"\\n  CompactPointer: \");\n    AppendNumberTo(&r, compact_pointers_[i].first);\n    r.append(\" \");\n    r.append(compact_pointers_[i].second.DebugString());\n  }\n  for (DeletedFileSet::const_iterator iter = deleted_files_.begin();\n       iter != deleted_files_.end();\n       ++iter) {\n    r.append(\"\\n  DeleteFile: \");\n    AppendNumberTo(&r, iter->first);\n    r.append(\" \");\n    AppendNumberTo(&r, iter->second);\n  }\n  for (size_t i = 0; i < new_files_.size(); i++) {\n    const FileMetaData& f = new_files_[i].second;\n    r.append(\"\\n  AddFile: \");\n    AppendNumberTo(&r, new_files_[i].first);\n    r.append(\" \");\n    AppendNumberTo(&r, f.number);\n    r.append(\" \");\n    AppendNumberTo(&r, f.file_size);\n    r.append(\" \");\n    r.append(f.smallest.DebugString());\n    r.append(\" .. \");\n    r.append(f.largest.DebugString());\n  }\n  r.append(\"\\n}\\n\");\n  return r;\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/version_edit.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\"\\n}\\n\""
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "f.largest.DebugString()"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f.largest.DebugString",
          "args": [],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "DebugString",
          "container": "VersionEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.cc",
          "lines": "212-264",
          "snippet": "std::string VersionEdit::DebugString() const {\n  std::string r;\n  r.append(\"VersionEdit {\");\n  if (has_comparator_) {\n    r.append(\"\\n  Comparator: \");\n    r.append(comparator_);\n  }\n  if (has_log_number_) {\n    r.append(\"\\n  LogNumber: \");\n    AppendNumberTo(&r, log_number_);\n  }\n  if (has_prev_log_number_) {\n    r.append(\"\\n  PrevLogNumber: \");\n    AppendNumberTo(&r, prev_log_number_);\n  }\n  if (has_next_file_number_) {\n    r.append(\"\\n  NextFile: \");\n    AppendNumberTo(&r, next_file_number_);\n  }\n  if (has_last_sequence_) {\n    r.append(\"\\n  LastSeq: \");\n    AppendNumberTo(&r, last_sequence_);\n  }\n  for (size_t i = 0; i < compact_pointers_.size(); i++) {\n    r.append(\"\\n  CompactPointer: \");\n    AppendNumberTo(&r, compact_pointers_[i].first);\n    r.append(\" \");\n    r.append(compact_pointers_[i].second.DebugString());\n  }\n  for (DeletedFileSet::const_iterator iter = deleted_files_.begin();\n       iter != deleted_files_.end();\n       ++iter) {\n    r.append(\"\\n  DeleteFile: \");\n    AppendNumberTo(&r, iter->first);\n    r.append(\" \");\n    AppendNumberTo(&r, iter->second);\n  }\n  for (size_t i = 0; i < new_files_.size(); i++) {\n    const FileMetaData& f = new_files_[i].second;\n    r.append(\"\\n  AddFile: \");\n    AppendNumberTo(&r, new_files_[i].first);\n    r.append(\" \");\n    AppendNumberTo(&r, f.number);\n    r.append(\" \");\n    AppendNumberTo(&r, f.file_size);\n    r.append(\" \");\n    r.append(f.smallest.DebugString());\n    r.append(\" .. \");\n    r.append(f.largest.DebugString());\n  }\n  r.append(\"\\n}\\n\");\n  return r;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\" .. \""
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "f.smallest.DebugString()"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\" \""
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AppendNumberTo",
          "args": [
            "&r",
            "f.file_size"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "AppendNumberTo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
          "lines": "16-20",
          "snippet": "void AppendNumberTo(std::string* str, uint64_t num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%llu\", (unsigned long long) num);\n  str->append(buf);\n}",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"util/logging.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nvoid AppendNumberTo(std::string* str, uint64_t num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%llu\", (unsigned long long) num);\n  str->append(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\" \""
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\" \""
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\"\\n  AddFile: \""
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_files_.size",
          "args": [],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\" \""
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\"\\n  DeleteFile: \""
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deleted_files_.end",
          "args": [],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "deleted_files_.begin",
          "args": [],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "compact_pointers_[i].second.DebugString()"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\" \""
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\"\\n  CompactPointer: \""
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\"\\n  LastSeq: \""
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\"\\n  NextFile: \""
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\"\\n  PrevLogNumber: \""
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\"\\n  LogNumber: \""
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "comparator_"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\"\\n  Comparator: \""
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.append",
          "args": [
            "\"VersionEdit {\""
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/version_set.h\"\n#include \"db/version_edit.h\"\n\nVersionEdit {\n  std::string VersionEdit::DebugString() const {\n    std::string r;\n    r.append(\"VersionEdit {\");\n    if (has_comparator_) {\n      r.append(\"\\n  Comparator: \");\n      r.append(comparator_);\n    }\n    if (has_log_number_) {\n      r.append(\"\\n  LogNumber: \");\n      AppendNumberTo(&r, log_number_);\n    }\n    if (has_prev_log_number_) {\n      r.append(\"\\n  PrevLogNumber: \");\n      AppendNumberTo(&r, prev_log_number_);\n    }\n    if (has_next_file_number_) {\n      r.append(\"\\n  NextFile: \");\n      AppendNumberTo(&r, next_file_number_);\n    }\n    if (has_last_sequence_) {\n      r.append(\"\\n  LastSeq: \");\n      AppendNumberTo(&r, last_sequence_);\n    }\n    for (size_t i = 0; i < compact_pointers_.size(); i++) {\n      r.append(\"\\n  CompactPointer: \");\n      AppendNumberTo(&r, compact_pointers_[i].first);\n      r.append(\" \");\n      r.append(compact_pointers_[i].second.DebugString());\n    }\n    for (DeletedFileSet::const_iterator iter = deleted_files_.begin();\n         iter != deleted_files_.end();\n         ++iter) {\n      r.append(\"\\n  DeleteFile: \");\n      AppendNumberTo(&r, iter->first);\n      r.append(\" \");\n      AppendNumberTo(&r, iter->second);\n    }\n    for (size_t i = 0; i < new_files_.size(); i++) {\n      const FileMetaData& f = new_files_[i].second;\n      r.append(\"\\n  AddFile: \");\n      AppendNumberTo(&r, new_files_[i].first);\n      r.append(\" \");\n      AppendNumberTo(&r, f.number);\n      r.append(\" \");\n      AppendNumberTo(&r, f.file_size);\n      r.append(\" \");\n      r.append(f.smallest.DebugString());\n      r.append(\" .. \");\n      r.append(f.largest.DebugString());\n    }\n    r.append(\"\\n}\\n\");\n    return r;\n  }\n}"
  },
  {
    "function_name": "DecodeFrom",
    "container": "VersionEdit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.cc",
    "lines": "109-210",
    "snippet": "Status VersionEdit::DecodeFrom(const Slice& src) {\n  Clear();\n  Slice input = src;\n  const char* msg = NULL;\n  uint32_t tag;\n\n  // Temporary storage for parsing\n  int level;\n  uint64_t number;\n  FileMetaData f;\n  Slice str;\n  InternalKey key;\n\n  while (msg == NULL && GetVarint32(&input, &tag)) {\n    switch (tag) {\n      case kComparator:\n        if (GetLengthPrefixedSlice(&input, &str)) {\n          comparator_ = str.ToString();\n          has_comparator_ = true;\n        } else {\n          msg = \"comparator name\";\n        }\n        break;\n\n      case kLogNumber:\n        if (GetVarint64(&input, &log_number_)) {\n          has_log_number_ = true;\n        } else {\n          msg = \"log number\";\n        }\n        break;\n\n      case kPrevLogNumber:\n        if (GetVarint64(&input, &prev_log_number_)) {\n          has_prev_log_number_ = true;\n        } else {\n          msg = \"previous log number\";\n        }\n        break;\n\n      case kNextFileNumber:\n        if (GetVarint64(&input, &next_file_number_)) {\n          has_next_file_number_ = true;\n        } else {\n          msg = \"next file number\";\n        }\n        break;\n\n      case kLastSequence:\n        if (GetVarint64(&input, &last_sequence_)) {\n          has_last_sequence_ = true;\n        } else {\n          msg = \"last sequence number\";\n        }\n        break;\n\n      case kCompactPointer:\n        if (GetLevel(&input, &level) &&\n            GetInternalKey(&input, &key)) {\n          compact_pointers_.push_back(std::make_pair(level, key));\n        } else {\n          msg = \"compaction pointer\";\n        }\n        break;\n\n      case kDeletedFile:\n        if (GetLevel(&input, &level) &&\n            GetVarint64(&input, &number)) {\n          deleted_files_.insert(std::make_pair(level, number));\n        } else {\n          msg = \"deleted file\";\n        }\n        break;\n\n      case kNewFile:\n        if (GetLevel(&input, &level) &&\n            GetVarint64(&input, &f.number) &&\n            GetVarint64(&input, &f.file_size) &&\n            GetInternalKey(&input, &f.smallest) &&\n            GetInternalKey(&input, &f.largest)) {\n          new_files_.push_back(std::make_pair(level, f));\n        } else {\n          msg = \"new-file entry\";\n        }\n        break;\n\n      default:\n        msg = \"unknown tag\";\n        break;\n    }\n  }\n\n  if (msg == NULL && !input.empty()) {\n    msg = \"invalid tag\";\n  }\n\n  Status result;\n  if (msg != NULL) {\n    result = Status::Corruption(\"VersionEdit\", msg);\n  }\n  return result;\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/version_edit.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::Corruption",
          "args": [
            "\"VersionEdit\"",
            "msg"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "Corruption",
          "container": "CorruptionReporter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/leveldb_main.cc",
          "lines": "38-42",
          "snippet": "virtual void Corruption(size_t bytes, const Status& status) {\n    printf(\"corruption: %d bytes; %s\\n\",\n            static_cast<int>(bytes),\n            status.ToString().c_str());\n  }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_edit.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/write_batch.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_edit.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nCorruptionReporter {\n  virtual void Corruption(size_t bytes, const Status& status) {\n      printf(\"corruption: %d bytes; %s\\n\",\n              static_cast<int>(bytes),\n              status.ToString().c_str());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "input.empty",
          "args": [],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "SnapshotList",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/snapshot.h",
          "lines": "37-37",
          "snippet": "bool empty() const { return list_.next_ == &list_; }",
          "includes": [
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/db.h\"\n\nSnapshotList {\n  bool empty() const { return list_.next_ == &list_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_files_.push_back",
          "args": [
            "std::make_pair(level, f)"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "level",
            "f"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetInternalKey",
          "args": [
            "&input",
            "&f.largest"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "GetInternalKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.cc",
          "lines": "88-96",
          "snippet": "static bool GetInternalKey(Slice* input, InternalKey* dst) {\n  Slice str;\n  if (GetLengthPrefixedSlice(input, &str)) {\n    dst->DecodeFrom(str);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/version_edit.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/version_set.h\"\n#include \"db/version_edit.h\"\n\nstatic bool GetInternalKey(Slice* input, InternalKey* dst) {\n  Slice str;\n  if (GetLengthPrefixedSlice(input, &str)) {\n    dst->DecodeFrom(str);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetVarint64",
          "args": [
            "&input",
            "&f.file_size"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "GetVarint64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "160-170",
          "snippet": "bool GetVarint64(Slice* input, uint64_t* value) {\n  const char* p = input->data();\n  const char* limit = p + input->size();\n  const char* q = GetVarint64Ptr(p, limit, value);\n  if (q == NULL) {\n    return false;\n  } else {\n    *input = Slice(q, limit - q);\n    return true;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetVarint64(Slice* input, uint64_t* value) {\n  const char* p = input->data();\n  const char* limit = p + input->size();\n  const char* q = GetVarint64Ptr(p, limit, value);\n  if (q == NULL) {\n    return false;\n  } else {\n    *input = Slice(q, limit - q);\n    return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLevel",
          "args": [
            "&input",
            "&level"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "GetLevel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.cc",
          "lines": "98-107",
          "snippet": "static bool GetLevel(Slice* input, int* level) {\n  uint32_t v;\n  if (GetVarint32(input, &v) &&\n      v < config::kNumLevels) {\n    *level = v;\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/version_edit.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/version_set.h\"\n#include \"db/version_edit.h\"\n\nstatic bool GetLevel(Slice* input, int* level) {\n  uint32_t v;\n  if (GetVarint32(input, &v) &&\n      v < config::kNumLevels) {\n    *level = v;\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "deleted_files_.insert",
          "args": [
            "std::make_pair(level, number)"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "61-65",
          "snippet": "void CBloomFilter::insert(const uint256& hash)\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    insert(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  void CBloomFilter::insert(const uint256& hash)\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      insert(data);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "level",
            "number"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compact_pointers_.push_back",
          "args": [
            "std::make_pair(level, key)"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "level",
            "key"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.ToString",
          "args": [],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLengthPrefixedSlice",
          "args": [
            "&input",
            "&str"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetVarint32",
          "args": [
            "&input",
            "&tag"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "GetVarint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "131-141",
          "snippet": "bool GetVarint32(Slice* input, uint32_t* value) {\n  const char* p = input->data();\n  const char* limit = p + input->size();\n  const char* q = GetVarint32Ptr(p, limit, value);\n  if (q == NULL) {\n    return false;\n  } else {\n    *input = Slice(q, limit - q);\n    return true;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetVarint32(Slice* input, uint32_t* value) {\n  const char* p = input->data();\n  const char* limit = p + input->size();\n  const char* q = GetVarint32Ptr(p, limit, value);\n  if (q == NULL) {\n    return false;\n  } else {\n    *input = Slice(q, limit - q);\n    return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Clear",
          "args": [],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "Clear",
          "container": "VersionEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.cc",
          "lines": "26-39",
          "snippet": "void VersionEdit::Clear() {\n  comparator_.clear();\n  log_number_ = 0;\n  prev_log_number_ = 0;\n  last_sequence_ = 0;\n  next_file_number_ = 0;\n  has_comparator_ = false;\n  has_log_number_ = false;\n  has_prev_log_number_ = false;\n  has_next_file_number_ = false;\n  has_last_sequence_ = false;\n  deleted_files_.clear();\n  new_files_.clear();\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/version_edit.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/version_set.h\"\n#include \"db/version_edit.h\"\n\nVersionEdit {\n  void VersionEdit::Clear() {\n    comparator_.clear();\n    log_number_ = 0;\n    prev_log_number_ = 0;\n    last_sequence_ = 0;\n    next_file_number_ = 0;\n    has_comparator_ = false;\n    has_log_number_ = false;\n    has_prev_log_number_ = false;\n    has_next_file_number_ = false;\n    has_last_sequence_ = false;\n    deleted_files_.clear();\n    new_files_.clear();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/version_set.h\"\n#include \"db/version_edit.h\"\n\nVersionEdit {\n  Status VersionEdit::DecodeFrom(const Slice& src) {\n    Clear();\n    Slice input = src;\n    const char* msg = NULL;\n    uint32_t tag;\n  \n    // Temporary storage for parsing\n    int level;\n    uint64_t number;\n    FileMetaData f;\n    Slice str;\n    InternalKey key;\n  \n    while (msg == NULL && GetVarint32(&input, &tag)) {\n      switch (tag) {\n        case kComparator:\n          if (GetLengthPrefixedSlice(&input, &str)) {\n            comparator_ = str.ToString();\n            has_comparator_ = true;\n          } else {\n            msg = \"comparator name\";\n          }\n          break;\n  \n        case kLogNumber:\n          if (GetVarint64(&input, &log_number_)) {\n            has_log_number_ = true;\n          } else {\n            msg = \"log number\";\n          }\n          break;\n  \n        case kPrevLogNumber:\n          if (GetVarint64(&input, &prev_log_number_)) {\n            has_prev_log_number_ = true;\n          } else {\n            msg = \"previous log number\";\n          }\n          break;\n  \n        case kNextFileNumber:\n          if (GetVarint64(&input, &next_file_number_)) {\n            has_next_file_number_ = true;\n          } else {\n            msg = \"next file number\";\n          }\n          break;\n  \n        case kLastSequence:\n          if (GetVarint64(&input, &last_sequence_)) {\n            has_last_sequence_ = true;\n          } else {\n            msg = \"last sequence number\";\n          }\n          break;\n  \n        case kCompactPointer:\n          if (GetLevel(&input, &level) &&\n              GetInternalKey(&input, &key)) {\n            compact_pointers_.push_back(std::make_pair(level, key));\n          } else {\n            msg = \"compaction pointer\";\n          }\n          break;\n  \n        case kDeletedFile:\n          if (GetLevel(&input, &level) &&\n              GetVarint64(&input, &number)) {\n            deleted_files_.insert(std::make_pair(level, number));\n          } else {\n            msg = \"deleted file\";\n          }\n          break;\n  \n        case kNewFile:\n          if (GetLevel(&input, &level) &&\n              GetVarint64(&input, &f.number) &&\n              GetVarint64(&input, &f.file_size) &&\n              GetInternalKey(&input, &f.smallest) &&\n              GetInternalKey(&input, &f.largest)) {\n            new_files_.push_back(std::make_pair(level, f));\n          } else {\n            msg = \"new-file entry\";\n          }\n          break;\n  \n        default:\n          msg = \"unknown tag\";\n          break;\n      }\n    }\n  \n    if (msg == NULL && !input.empty()) {\n      msg = \"invalid tag\";\n    }\n  \n    Status result;\n    if (msg != NULL) {\n      result = Status::Corruption(\"VersionEdit\", msg);\n    }\n    return result;\n  }\n}"
  },
  {
    "function_name": "GetLevel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.cc",
    "lines": "98-107",
    "snippet": "static bool GetLevel(Slice* input, int* level) {\n  uint32_t v;\n  if (GetVarint32(input, &v) &&\n      v < config::kNumLevels) {\n    *level = v;\n    return true;\n  } else {\n    return false;\n  }\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/version_edit.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetVarint32",
          "args": [
            "input",
            "&v"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "GetVarint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "131-141",
          "snippet": "bool GetVarint32(Slice* input, uint32_t* value) {\n  const char* p = input->data();\n  const char* limit = p + input->size();\n  const char* q = GetVarint32Ptr(p, limit, value);\n  if (q == NULL) {\n    return false;\n  } else {\n    *input = Slice(q, limit - q);\n    return true;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetVarint32(Slice* input, uint32_t* value) {\n  const char* p = input->data();\n  const char* limit = p + input->size();\n  const char* q = GetVarint32Ptr(p, limit, value);\n  if (q == NULL) {\n    return false;\n  } else {\n    *input = Slice(q, limit - q);\n    return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/version_set.h\"\n#include \"db/version_edit.h\"\n\nstatic bool GetLevel(Slice* input, int* level) {\n  uint32_t v;\n  if (GetVarint32(input, &v) &&\n      v < config::kNumLevels) {\n    *level = v;\n    return true;\n  } else {\n    return false;\n  }\n}"
  },
  {
    "function_name": "GetInternalKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.cc",
    "lines": "88-96",
    "snippet": "static bool GetInternalKey(Slice* input, InternalKey* dst) {\n  Slice str;\n  if (GetLengthPrefixedSlice(input, &str)) {\n    dst->DecodeFrom(str);\n    return true;\n  } else {\n    return false;\n  }\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/version_edit.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dst->DecodeFrom",
          "args": [
            "str"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeFrom",
          "container": "VersionEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.cc",
          "lines": "109-210",
          "snippet": "Status VersionEdit::DecodeFrom(const Slice& src) {\n  Clear();\n  Slice input = src;\n  const char* msg = NULL;\n  uint32_t tag;\n\n  // Temporary storage for parsing\n  int level;\n  uint64_t number;\n  FileMetaData f;\n  Slice str;\n  InternalKey key;\n\n  while (msg == NULL && GetVarint32(&input, &tag)) {\n    switch (tag) {\n      case kComparator:\n        if (GetLengthPrefixedSlice(&input, &str)) {\n          comparator_ = str.ToString();\n          has_comparator_ = true;\n        } else {\n          msg = \"comparator name\";\n        }\n        break;\n\n      case kLogNumber:\n        if (GetVarint64(&input, &log_number_)) {\n          has_log_number_ = true;\n        } else {\n          msg = \"log number\";\n        }\n        break;\n\n      case kPrevLogNumber:\n        if (GetVarint64(&input, &prev_log_number_)) {\n          has_prev_log_number_ = true;\n        } else {\n          msg = \"previous log number\";\n        }\n        break;\n\n      case kNextFileNumber:\n        if (GetVarint64(&input, &next_file_number_)) {\n          has_next_file_number_ = true;\n        } else {\n          msg = \"next file number\";\n        }\n        break;\n\n      case kLastSequence:\n        if (GetVarint64(&input, &last_sequence_)) {\n          has_last_sequence_ = true;\n        } else {\n          msg = \"last sequence number\";\n        }\n        break;\n\n      case kCompactPointer:\n        if (GetLevel(&input, &level) &&\n            GetInternalKey(&input, &key)) {\n          compact_pointers_.push_back(std::make_pair(level, key));\n        } else {\n          msg = \"compaction pointer\";\n        }\n        break;\n\n      case kDeletedFile:\n        if (GetLevel(&input, &level) &&\n            GetVarint64(&input, &number)) {\n          deleted_files_.insert(std::make_pair(level, number));\n        } else {\n          msg = \"deleted file\";\n        }\n        break;\n\n      case kNewFile:\n        if (GetLevel(&input, &level) &&\n            GetVarint64(&input, &f.number) &&\n            GetVarint64(&input, &f.file_size) &&\n            GetInternalKey(&input, &f.smallest) &&\n            GetInternalKey(&input, &f.largest)) {\n          new_files_.push_back(std::make_pair(level, f));\n        } else {\n          msg = \"new-file entry\";\n        }\n        break;\n\n      default:\n        msg = \"unknown tag\";\n        break;\n    }\n  }\n\n  if (msg == NULL && !input.empty()) {\n    msg = \"invalid tag\";\n  }\n\n  Status result;\n  if (msg != NULL) {\n    result = Status::Corruption(\"VersionEdit\", msg);\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/version_edit.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/version_set.h\"\n#include \"db/version_edit.h\"\n\nVersionEdit {\n  Status VersionEdit::DecodeFrom(const Slice& src) {\n    Clear();\n    Slice input = src;\n    const char* msg = NULL;\n    uint32_t tag;\n  \n    // Temporary storage for parsing\n    int level;\n    uint64_t number;\n    FileMetaData f;\n    Slice str;\n    InternalKey key;\n  \n    while (msg == NULL && GetVarint32(&input, &tag)) {\n      switch (tag) {\n        case kComparator:\n          if (GetLengthPrefixedSlice(&input, &str)) {\n            comparator_ = str.ToString();\n            has_comparator_ = true;\n          } else {\n            msg = \"comparator name\";\n          }\n          break;\n  \n        case kLogNumber:\n          if (GetVarint64(&input, &log_number_)) {\n            has_log_number_ = true;\n          } else {\n            msg = \"log number\";\n          }\n          break;\n  \n        case kPrevLogNumber:\n          if (GetVarint64(&input, &prev_log_number_)) {\n            has_prev_log_number_ = true;\n          } else {\n            msg = \"previous log number\";\n          }\n          break;\n  \n        case kNextFileNumber:\n          if (GetVarint64(&input, &next_file_number_)) {\n            has_next_file_number_ = true;\n          } else {\n            msg = \"next file number\";\n          }\n          break;\n  \n        case kLastSequence:\n          if (GetVarint64(&input, &last_sequence_)) {\n            has_last_sequence_ = true;\n          } else {\n            msg = \"last sequence number\";\n          }\n          break;\n  \n        case kCompactPointer:\n          if (GetLevel(&input, &level) &&\n              GetInternalKey(&input, &key)) {\n            compact_pointers_.push_back(std::make_pair(level, key));\n          } else {\n            msg = \"compaction pointer\";\n          }\n          break;\n  \n        case kDeletedFile:\n          if (GetLevel(&input, &level) &&\n              GetVarint64(&input, &number)) {\n            deleted_files_.insert(std::make_pair(level, number));\n          } else {\n            msg = \"deleted file\";\n          }\n          break;\n  \n        case kNewFile:\n          if (GetLevel(&input, &level) &&\n              GetVarint64(&input, &f.number) &&\n              GetVarint64(&input, &f.file_size) &&\n              GetInternalKey(&input, &f.smallest) &&\n              GetInternalKey(&input, &f.largest)) {\n            new_files_.push_back(std::make_pair(level, f));\n          } else {\n            msg = \"new-file entry\";\n          }\n          break;\n  \n        default:\n          msg = \"unknown tag\";\n          break;\n      }\n    }\n  \n    if (msg == NULL && !input.empty()) {\n      msg = \"invalid tag\";\n    }\n  \n    Status result;\n    if (msg != NULL) {\n      result = Status::Corruption(\"VersionEdit\", msg);\n    }\n    return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLengthPrefixedSlice",
          "args": [
            "input",
            "&str"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/version_set.h\"\n#include \"db/version_edit.h\"\n\nstatic bool GetInternalKey(Slice* input, InternalKey* dst) {\n  Slice str;\n  if (GetLengthPrefixedSlice(input, &str)) {\n    dst->DecodeFrom(str);\n    return true;\n  } else {\n    return false;\n  }\n}"
  },
  {
    "function_name": "EncodeTo",
    "container": "VersionEdit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.cc",
    "lines": "41-86",
    "snippet": "void VersionEdit::EncodeTo(std::string* dst) const {\n  if (has_comparator_) {\n    PutVarint32(dst, kComparator);\n    PutLengthPrefixedSlice(dst, comparator_);\n  }\n  if (has_log_number_) {\n    PutVarint32(dst, kLogNumber);\n    PutVarint64(dst, log_number_);\n  }\n  if (has_prev_log_number_) {\n    PutVarint32(dst, kPrevLogNumber);\n    PutVarint64(dst, prev_log_number_);\n  }\n  if (has_next_file_number_) {\n    PutVarint32(dst, kNextFileNumber);\n    PutVarint64(dst, next_file_number_);\n  }\n  if (has_last_sequence_) {\n    PutVarint32(dst, kLastSequence);\n    PutVarint64(dst, last_sequence_);\n  }\n\n  for (size_t i = 0; i < compact_pointers_.size(); i++) {\n    PutVarint32(dst, kCompactPointer);\n    PutVarint32(dst, compact_pointers_[i].first);  // level\n    PutLengthPrefixedSlice(dst, compact_pointers_[i].second.Encode());\n  }\n\n  for (DeletedFileSet::const_iterator iter = deleted_files_.begin();\n       iter != deleted_files_.end();\n       ++iter) {\n    PutVarint32(dst, kDeletedFile);\n    PutVarint32(dst, iter->first);   // level\n    PutVarint64(dst, iter->second);  // file number\n  }\n\n  for (size_t i = 0; i < new_files_.size(); i++) {\n    const FileMetaData& f = new_files_[i].second;\n    PutVarint32(dst, kNewFile);\n    PutVarint32(dst, new_files_[i].first);  // level\n    PutVarint64(dst, f.number);\n    PutVarint64(dst, f.file_size);\n    PutLengthPrefixedSlice(dst, f.smallest.Encode());\n    PutLengthPrefixedSlice(dst, f.largest.Encode());\n  }\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/version_edit.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PutLengthPrefixedSlice",
          "args": [
            "dst",
            "f.largest.Encode()"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "PutLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "98-101",
          "snippet": "void PutLengthPrefixedSlice(std::string* dst, const Slice& value) {\n  PutVarint32(dst, value.size());\n  dst->append(value.data(), value.size());\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutLengthPrefixedSlice(std::string* dst, const Slice& value) {\n  PutVarint32(dst, value.size());\n  dst->append(value.data(), value.size());\n}"
        }
      },
      {
        "call_info": {
          "callee": "f.largest.Encode",
          "args": [],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "Encode",
          "container": "InternalKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "154-157",
          "snippet": "Slice Encode() const {\n    assert(!rep_.empty());\n    return rep_;\n  }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\nInternalKey {\n  Slice Encode() const {\n      assert(!rep_.empty());\n      return rep_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "PutVarint64",
          "args": [
            "dst",
            "f.file_size"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "PutVarint64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "92-96",
          "snippet": "void PutVarint64(std::string* dst, uint64_t v) {\n  char buf[10];\n  char* ptr = EncodeVarint64(buf, v);\n  dst->append(buf, ptr - buf);\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutVarint64(std::string* dst, uint64_t v) {\n  char buf[10];\n  char* ptr = EncodeVarint64(buf, v);\n  dst->append(buf, ptr - buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PutVarint32",
          "args": [
            "dst",
            "new_files_[i].first"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "PutVarint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "75-79",
          "snippet": "void PutVarint32(std::string* dst, uint32_t v) {\n  char buf[5];\n  char* ptr = EncodeVarint32(buf, v);\n  dst->append(buf, ptr - buf);\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutVarint32(std::string* dst, uint32_t v) {\n  char buf[5];\n  char* ptr = EncodeVarint32(buf, v);\n  dst->append(buf, ptr - buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_files_.size",
          "args": [],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "deleted_files_.end",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "deleted_files_.begin",
          "args": [],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/version_set.h\"\n#include \"db/version_edit.h\"\n\nVersionEdit {\n  void VersionEdit::EncodeTo(std::string* dst) const {\n    if (has_comparator_) {\n      PutVarint32(dst, kComparator);\n      PutLengthPrefixedSlice(dst, comparator_);\n    }\n    if (has_log_number_) {\n      PutVarint32(dst, kLogNumber);\n      PutVarint64(dst, log_number_);\n    }\n    if (has_prev_log_number_) {\n      PutVarint32(dst, kPrevLogNumber);\n      PutVarint64(dst, prev_log_number_);\n    }\n    if (has_next_file_number_) {\n      PutVarint32(dst, kNextFileNumber);\n      PutVarint64(dst, next_file_number_);\n    }\n    if (has_last_sequence_) {\n      PutVarint32(dst, kLastSequence);\n      PutVarint64(dst, last_sequence_);\n    }\n  \n    for (size_t i = 0; i < compact_pointers_.size(); i++) {\n      PutVarint32(dst, kCompactPointer);\n      PutVarint32(dst, compact_pointers_[i].first);  // level\n      PutLengthPrefixedSlice(dst, compact_pointers_[i].second.Encode());\n    }\n  \n    for (DeletedFileSet::const_iterator iter = deleted_files_.begin();\n         iter != deleted_files_.end();\n         ++iter) {\n      PutVarint32(dst, kDeletedFile);\n      PutVarint32(dst, iter->first);   // level\n      PutVarint64(dst, iter->second);  // file number\n    }\n  \n    for (size_t i = 0; i < new_files_.size(); i++) {\n      const FileMetaData& f = new_files_[i].second;\n      PutVarint32(dst, kNewFile);\n      PutVarint32(dst, new_files_[i].first);  // level\n      PutVarint64(dst, f.number);\n      PutVarint64(dst, f.file_size);\n      PutLengthPrefixedSlice(dst, f.smallest.Encode());\n      PutLengthPrefixedSlice(dst, f.largest.Encode());\n    }\n  }\n}"
  },
  {
    "function_name": "Clear",
    "container": "VersionEdit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.cc",
    "lines": "26-39",
    "snippet": "void VersionEdit::Clear() {\n  comparator_.clear();\n  log_number_ = 0;\n  prev_log_number_ = 0;\n  last_sequence_ = 0;\n  next_file_number_ = 0;\n  has_comparator_ = false;\n  has_log_number_ = false;\n  has_prev_log_number_ = false;\n  has_next_file_number_ = false;\n  has_last_sequence_ = false;\n  deleted_files_.clear();\n  new_files_.clear();\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/version_edit.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "new_files_.clear",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/version_set.h\"\n#include \"db/version_edit.h\"\n\nVersionEdit {\n  void VersionEdit::Clear() {\n    comparator_.clear();\n    log_number_ = 0;\n    prev_log_number_ = 0;\n    last_sequence_ = 0;\n    next_file_number_ = 0;\n    has_comparator_ = false;\n    has_log_number_ = false;\n    has_prev_log_number_ = false;\n    has_next_file_number_ = false;\n    has_last_sequence_ = false;\n    deleted_files_.clear();\n    new_files_.clear();\n  }\n}"
  }
]