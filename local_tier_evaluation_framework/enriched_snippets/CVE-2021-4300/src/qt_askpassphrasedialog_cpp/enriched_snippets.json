[
  {
    "function_name": "eventFilter",
    "container": "AskPassphraseDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/askpassphrasedialog.cpp",
    "lines": "233-257",
    "snippet": "bool AskPassphraseDialog::eventFilter(QObject *object, QEvent *event)\n{\n    /* Detect Caps Lock.\n     * There is no good OS-independent way to check a key state in Qt, but we\n     * can detect Caps Lock by checking for the following condition:\n     * Shift key is down and the result is a lower case character, or\n     * Shift key is not down and the result is an upper case character.\n     */\n    if (event->type() == QEvent::KeyPress) {\n        QKeyEvent *ke = static_cast<QKeyEvent *>(event);\n        QString str = ke->text();\n        if (str.length() != 0) {\n            const QChar *psz = str.unicode();\n            bool fShift = (ke->modifiers() & Qt::ShiftModifier) != 0;\n            if ((fShift && psz->isLower()) || (!fShift && psz->isUpper())) {\n                fCapsLock = true;\n                ui->capsLabel->setText(tr(\"Warning: The Caps Lock key is on!\"));\n            } else if (psz->isLetter()) {\n                fCapsLock = false;\n                ui->capsLabel->clear();\n            }\n        }\n    }\n    return QDialog::eventFilter(object, event);\n}",
    "includes": [
      "#include <QKeyEvent>",
      "#include <QPushButton>",
      "#include <QMessageBox>",
      "#include \"walletmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"ui_askpassphrasedialog.h\"",
      "#include \"askpassphrasedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QDialog::eventFilter",
          "args": [
            "object",
            "event"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "eventFilter",
          "container": "AskPassphraseDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/askpassphrasedialog.cpp",
          "lines": "233-257",
          "snippet": "bool AskPassphraseDialog::eventFilter(QObject *object, QEvent *event)\n{\n    /* Detect Caps Lock.\n     * There is no good OS-independent way to check a key state in Qt, but we\n     * can detect Caps Lock by checking for the following condition:\n     * Shift key is down and the result is a lower case character, or\n     * Shift key is not down and the result is an upper case character.\n     */\n    if (event->type() == QEvent::KeyPress) {\n        QKeyEvent *ke = static_cast<QKeyEvent *>(event);\n        QString str = ke->text();\n        if (str.length() != 0) {\n            const QChar *psz = str.unicode();\n            bool fShift = (ke->modifiers() & Qt::ShiftModifier) != 0;\n            if ((fShift && psz->isLower()) || (!fShift && psz->isUpper())) {\n                fCapsLock = true;\n                ui->capsLabel->setText(tr(\"Warning: The Caps Lock key is on!\"));\n            } else if (psz->isLetter()) {\n                fCapsLock = false;\n                ui->capsLabel->clear();\n            }\n        }\n    }\n    return QDialog::eventFilter(object, event);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ui->capsLabel->clear",
          "args": [],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "psz->isLetter",
          "args": [],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->capsLabel->setText",
          "args": [
            "tr(\"Warning: The Caps Lock key is on!\")"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Warning: The Caps Lock key is on!\""
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "psz->isUpper",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "psz->isLower",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ke->modifiers",
          "args": [],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.unicode",
          "args": [],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.length",
          "args": [],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ke->text",
          "args": [],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<QKeyEvent *>",
          "args": [
            "event"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "event->type",
          "args": [],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QKeyEvent>\n#include <QPushButton>\n#include <QMessageBox>\n#include \"walletmodel.h\"\n#include \"guiconstants.h\"\n#include \"ui_askpassphrasedialog.h\"\n#include \"askpassphrasedialog.h\"\n\nAskPassphraseDialog {\n  bool AskPassphraseDialog::eventFilter(QObject *object, QEvent *event)\n  {\n      /* Detect Caps Lock.\n       * There is no good OS-independent way to check a key state in Qt, but we\n       * can detect Caps Lock by checking for the following condition:\n       * Shift key is down and the result is a lower case character, or\n       * Shift key is not down and the result is an upper case character.\n       */\n      if (event->type() == QEvent::KeyPress) {\n          QKeyEvent *ke = static_cast<QKeyEvent *>(event);\n          QString str = ke->text();\n          if (str.length() != 0) {\n              const QChar *psz = str.unicode();\n              bool fShift = (ke->modifiers() & Qt::ShiftModifier) != 0;\n              if ((fShift && psz->isLower()) || (!fShift && psz->isUpper())) {\n                  fCapsLock = true;\n                  ui->capsLabel->setText(tr(\"Warning: The Caps Lock key is on!\"));\n              } else if (psz->isLetter()) {\n                  fCapsLock = false;\n                  ui->capsLabel->clear();\n              }\n          }\n      }\n      return QDialog::eventFilter(object, event);\n  }\n}"
  },
  {
    "function_name": "event",
    "container": "AskPassphraseDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/askpassphrasedialog.cpp",
    "lines": "216-231",
    "snippet": "bool AskPassphraseDialog::event(QEvent *event)\n{\n    // Detect Caps Lock key press.\n    if (event->type() == QEvent::KeyPress) {\n        QKeyEvent *ke = static_cast<QKeyEvent *>(event);\n        if (ke->key() == Qt::Key_CapsLock) {\n            fCapsLock = !fCapsLock;\n        }\n        if (fCapsLock) {\n            ui->capsLabel->setText(tr(\"Warning: The Caps Lock key is on!\"));\n        } else {\n            ui->capsLabel->clear();\n        }\n    }\n    return QWidget::event(event);\n}",
    "includes": [
      "#include <QKeyEvent>",
      "#include <QPushButton>",
      "#include <QMessageBox>",
      "#include \"walletmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"ui_askpassphrasedialog.h\"",
      "#include \"askpassphrasedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QWidget::event",
          "args": [
            "event"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "event",
          "container": "AskPassphraseDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/askpassphrasedialog.cpp",
          "lines": "216-231",
          "snippet": "bool AskPassphraseDialog::event(QEvent *event)\n{\n    // Detect Caps Lock key press.\n    if (event->type() == QEvent::KeyPress) {\n        QKeyEvent *ke = static_cast<QKeyEvent *>(event);\n        if (ke->key() == Qt::Key_CapsLock) {\n            fCapsLock = !fCapsLock;\n        }\n        if (fCapsLock) {\n            ui->capsLabel->setText(tr(\"Warning: The Caps Lock key is on!\"));\n        } else {\n            ui->capsLabel->clear();\n        }\n    }\n    return QWidget::event(event);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ui->capsLabel->clear",
          "args": [],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->capsLabel->setText",
          "args": [
            "tr(\"Warning: The Caps Lock key is on!\")"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Warning: The Caps Lock key is on!\""
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ke->key",
          "args": [],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "LRUHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "37-45",
          "snippet": "Slice key() const {\n    // For cheaper lookups, we allow a temporary Handle object\n    // to store a pointer to a key in \"value\".\n    if (next == this) {\n      return *(reinterpret_cast<Slice*>(value));\n    } else {\n      return Slice(key_data, key_length);\n    }\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nLRUHandle {\n  Slice key() const {\n      // For cheaper lookups, we allow a temporary Handle object\n      // to store a pointer to a key in \"value\".\n      if (next == this) {\n        return *(reinterpret_cast<Slice*>(value));\n      } else {\n        return Slice(key_data, key_length);\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<QKeyEvent *>",
          "args": [
            "event"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "event->type",
          "args": [],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QKeyEvent>\n#include <QPushButton>\n#include <QMessageBox>\n#include \"walletmodel.h\"\n#include \"guiconstants.h\"\n#include \"ui_askpassphrasedialog.h\"\n#include \"askpassphrasedialog.h\"\n\nAskPassphraseDialog {\n  bool AskPassphraseDialog::event(QEvent *event)\n  {\n      // Detect Caps Lock key press.\n      if (event->type() == QEvent::KeyPress) {\n          QKeyEvent *ke = static_cast<QKeyEvent *>(event);\n          if (ke->key() == Qt::Key_CapsLock) {\n              fCapsLock = !fCapsLock;\n          }\n          if (fCapsLock) {\n              ui->capsLabel->setText(tr(\"Warning: The Caps Lock key is on!\"));\n          } else {\n              ui->capsLabel->clear();\n          }\n      }\n      return QWidget::event(event);\n  }\n}"
  },
  {
    "function_name": "textChanged",
    "container": "AskPassphraseDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/askpassphrasedialog.cpp",
    "lines": "195-214",
    "snippet": "void AskPassphraseDialog::textChanged()\n{\n    // Validate input, set Ok button to enabled when acceptable\n    bool acceptable = false;\n    switch(mode)\n    {\n    case Encrypt: // New passphrase x2\n        acceptable = !ui->passEdit2->text().isEmpty() && !ui->passEdit3->text().isEmpty();\n        break;\n    case UnlockStaking:\n    case Unlock: // Old passphrase x1\n    case Decrypt:\n        acceptable = !ui->passEdit1->text().isEmpty();\n        break;\n    case ChangePass: // Old passphrase x1, new passphrase x2\n        acceptable = !ui->passEdit1->text().isEmpty() && !ui->passEdit2->text().isEmpty() && !ui->passEdit3->text().isEmpty();\n        break;\n    }\n    ui->buttonBox->button(QDialogButtonBox::Ok)->setEnabled(acceptable);\n}",
    "includes": [
      "#include <QKeyEvent>",
      "#include <QPushButton>",
      "#include <QMessageBox>",
      "#include \"walletmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"ui_askpassphrasedialog.h\"",
      "#include \"askpassphrasedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->buttonBox->button",
          "args": [
            "acceptable"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->buttonBox->button",
          "args": [
            "QDialogButtonBox::Ok"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit3->text",
          "args": [],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QKeyEvent>\n#include <QPushButton>\n#include <QMessageBox>\n#include \"walletmodel.h\"\n#include \"guiconstants.h\"\n#include \"ui_askpassphrasedialog.h\"\n#include \"askpassphrasedialog.h\"\n\nAskPassphraseDialog {\n  void AskPassphraseDialog::textChanged()\n  {\n      // Validate input, set Ok button to enabled when acceptable\n      bool acceptable = false;\n      switch(mode)\n      {\n      case Encrypt: // New passphrase x2\n          acceptable = !ui->passEdit2->text().isEmpty() && !ui->passEdit3->text().isEmpty();\n          break;\n      case UnlockStaking:\n      case Unlock: // Old passphrase x1\n      case Decrypt:\n          acceptable = !ui->passEdit1->text().isEmpty();\n          break;\n      case ChangePass: // Old passphrase x1, new passphrase x2\n          acceptable = !ui->passEdit1->text().isEmpty() && !ui->passEdit2->text().isEmpty() && !ui->passEdit3->text().isEmpty();\n          break;\n      }\n      ui->buttonBox->button(QDialogButtonBox::Ok)->setEnabled(acceptable);\n  }\n}"
  },
  {
    "function_name": "accept",
    "container": "AskPassphraseDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/askpassphrasedialog.cpp",
    "lines": "84-193",
    "snippet": "void AskPassphraseDialog::accept()\n{\n    SecureString oldpass, newpass1, newpass2;\n    if(!model)\n        return;\n    oldpass.reserve(MAX_PASSPHRASE_SIZE);\n    newpass1.reserve(MAX_PASSPHRASE_SIZE);\n    newpass2.reserve(MAX_PASSPHRASE_SIZE);\n    // TODO: get rid of this .c_str() by implementing SecureString::operator=(std::string)\n    // Alternately, find a way to make this input mlock()'d to begin with.\n    oldpass.assign(ui->passEdit1->text().toStdString().c_str());\n    newpass1.assign(ui->passEdit2->text().toStdString().c_str());\n    newpass2.assign(ui->passEdit3->text().toStdString().c_str());\n\n    switch(mode)\n    {\n    case Encrypt: {\n        if(newpass1.empty() || newpass2.empty())\n        {\n            // Cannot encrypt with empty passphrase\n            break;\n        }\n        QMessageBox::StandardButton retval = QMessageBox::question(this, tr(\"Confirm wallet encryption\"),\n                 tr(\"Warning: If you encrypt your wallet and lose your passphrase, you will <b>LOSE ALL OF YOUR COINS</b>!\") + \"<br><br>\" + tr(\"Are you sure you wish to encrypt your wallet?\"),\n                 QMessageBox::Yes|QMessageBox::Cancel,\n                 QMessageBox::Cancel);\n        if(retval == QMessageBox::Yes)\n        {\n            if(newpass1 == newpass2)\n            {\n                if(model->setWalletEncrypted(true, newpass1))\n                {\n                    QMessageBox::warning(this, tr(\"Wallet encrypted\"),\n                                         \"<qt>\" + \n                                         tr(\"Halcyon will close now to finish the encryption process. \"\n                                         \"Remember that encrypting your wallet cannot fully protect \"\n                                         \"your coins from being stolen by malware infecting your computer.\") + \n                                         \"<br><br><b>\" + \n                                         tr(\"IMPORTANT: Any previous backups you have made of your wallet file \"\n                                         \"should be replaced with the newly generated, encrypted wallet file. \"\n                                         \"For security reasons, previous backups of the unencrypted wallet file \"\n                                         \"will become useless as soon as you start using the new, encrypted wallet.\") + \n                                         \"</b></qt>\");\n                    QApplication::quit();\n                }\n                else\n                {\n                    QMessageBox::critical(this, tr(\"Wallet encryption failed\"),\n                                         tr(\"Wallet encryption failed due to an internal error. Your wallet was not encrypted.\"));\n                }\n                QDialog::accept(); // Success\n            }\n            else\n            {\n                QMessageBox::critical(this, tr(\"Wallet encryption failed\"),\n                                     tr(\"The supplied passphrases do not match.\"));\n            }\n        }\n        else\n        {\n            QDialog::reject(); // Cancelled\n        }\n        } break;\n    case UnlockStaking:\n    case Unlock:\n        if(!model->setWalletLocked(false, oldpass))\n        {\n            QMessageBox::critical(this, tr(\"Wallet unlock failed\"),\n                                  tr(\"The passphrase entered for the wallet decryption was incorrect.\"));\n        }\n        else\n        {\n            fWalletUnlockStakingOnly = ui->stakingCheckBox->isChecked();\n            QDialog::accept(); // Success\n        }\n        break;\n    case Decrypt:\n        if(!model->setWalletEncrypted(false, oldpass))\n        {\n            QMessageBox::critical(this, tr(\"Wallet decryption failed\"),\n                                  tr(\"The passphrase entered for the wallet decryption was incorrect.\"));\n        }\n        else\n        {\n            QDialog::accept(); // Success\n        }\n        break;\n    case ChangePass:\n        if(newpass1 == newpass2)\n        {\n            if(model->changePassphrase(oldpass, newpass1))\n            {\n                QMessageBox::information(this, tr(\"Wallet encrypted\"),\n                                     tr(\"Wallet passphrase was successfully changed.\"));\n                QDialog::accept(); // Success\n            }\n            else\n            {\n                QMessageBox::critical(this, tr(\"Wallet encryption failed\"),\n                                     tr(\"The passphrase entered for the wallet decryption was incorrect.\"));\n            }\n        }\n        else\n        {\n            QMessageBox::critical(this, tr(\"Wallet encryption failed\"),\n                                 tr(\"The supplied passphrases do not match.\"));\n        }\n        break;\n    }\n}",
    "includes": [
      "#include <QKeyEvent>",
      "#include <QPushButton>",
      "#include <QMessageBox>",
      "#include \"walletmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"ui_askpassphrasedialog.h\"",
      "#include \"askpassphrasedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "extern bool fWalletUnlockStakingOnly;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "QMessageBox::critical",
          "args": [
            "this",
            "tr(\"Wallet encryption failed\")",
            "tr(\"The supplied passphrases do not match.\")"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"The supplied passphrases do not match.\""
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QMessageBox::critical",
          "args": [
            "this",
            "tr(\"Wallet encryption failed\")",
            "tr(\"The passphrase entered for the wallet decryption was incorrect.\")"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDialog::accept",
          "args": [],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "accept",
          "container": "AskPassphraseDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/askpassphrasedialog.cpp",
          "lines": "84-193",
          "snippet": "void AskPassphraseDialog::accept()\n{\n    SecureString oldpass, newpass1, newpass2;\n    if(!model)\n        return;\n    oldpass.reserve(MAX_PASSPHRASE_SIZE);\n    newpass1.reserve(MAX_PASSPHRASE_SIZE);\n    newpass2.reserve(MAX_PASSPHRASE_SIZE);\n    // TODO: get rid of this .c_str() by implementing SecureString::operator=(std::string)\n    // Alternately, find a way to make this input mlock()'d to begin with.\n    oldpass.assign(ui->passEdit1->text().toStdString().c_str());\n    newpass1.assign(ui->passEdit2->text().toStdString().c_str());\n    newpass2.assign(ui->passEdit3->text().toStdString().c_str());\n\n    switch(mode)\n    {\n    case Encrypt: {\n        if(newpass1.empty() || newpass2.empty())\n        {\n            // Cannot encrypt with empty passphrase\n            break;\n        }\n        QMessageBox::StandardButton retval = QMessageBox::question(this, tr(\"Confirm wallet encryption\"),\n                 tr(\"Warning: If you encrypt your wallet and lose your passphrase, you will <b>LOSE ALL OF YOUR COINS</b>!\") + \"<br><br>\" + tr(\"Are you sure you wish to encrypt your wallet?\"),\n                 QMessageBox::Yes|QMessageBox::Cancel,\n                 QMessageBox::Cancel);\n        if(retval == QMessageBox::Yes)\n        {\n            if(newpass1 == newpass2)\n            {\n                if(model->setWalletEncrypted(true, newpass1))\n                {\n                    QMessageBox::warning(this, tr(\"Wallet encrypted\"),\n                                         \"<qt>\" + \n                                         tr(\"Halcyon will close now to finish the encryption process. \"\n                                         \"Remember that encrypting your wallet cannot fully protect \"\n                                         \"your coins from being stolen by malware infecting your computer.\") + \n                                         \"<br><br><b>\" + \n                                         tr(\"IMPORTANT: Any previous backups you have made of your wallet file \"\n                                         \"should be replaced with the newly generated, encrypted wallet file. \"\n                                         \"For security reasons, previous backups of the unencrypted wallet file \"\n                                         \"will become useless as soon as you start using the new, encrypted wallet.\") + \n                                         \"</b></qt>\");\n                    QApplication::quit();\n                }\n                else\n                {\n                    QMessageBox::critical(this, tr(\"Wallet encryption failed\"),\n                                         tr(\"Wallet encryption failed due to an internal error. Your wallet was not encrypted.\"));\n                }\n                QDialog::accept(); // Success\n            }\n            else\n            {\n                QMessageBox::critical(this, tr(\"Wallet encryption failed\"),\n                                     tr(\"The supplied passphrases do not match.\"));\n            }\n        }\n        else\n        {\n            QDialog::reject(); // Cancelled\n        }\n        } break;\n    case UnlockStaking:\n    case Unlock:\n        if(!model->setWalletLocked(false, oldpass))\n        {\n            QMessageBox::critical(this, tr(\"Wallet unlock failed\"),\n                                  tr(\"The passphrase entered for the wallet decryption was incorrect.\"));\n        }\n        else\n        {\n            fWalletUnlockStakingOnly = ui->stakingCheckBox->isChecked();\n            QDialog::accept(); // Success\n        }\n        break;\n    case Decrypt:\n        if(!model->setWalletEncrypted(false, oldpass))\n        {\n            QMessageBox::critical(this, tr(\"Wallet decryption failed\"),\n                                  tr(\"The passphrase entered for the wallet decryption was incorrect.\"));\n        }\n        else\n        {\n            QDialog::accept(); // Success\n        }\n        break;\n    case ChangePass:\n        if(newpass1 == newpass2)\n        {\n            if(model->changePassphrase(oldpass, newpass1))\n            {\n                QMessageBox::information(this, tr(\"Wallet encrypted\"),\n                                     tr(\"Wallet passphrase was successfully changed.\"));\n                QDialog::accept(); // Success\n            }\n            else\n            {\n                QMessageBox::critical(this, tr(\"Wallet encryption failed\"),\n                                     tr(\"The passphrase entered for the wallet decryption was incorrect.\"));\n            }\n        }\n        else\n        {\n            QMessageBox::critical(this, tr(\"Wallet encryption failed\"),\n                                 tr(\"The supplied passphrases do not match.\"));\n        }\n        break;\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "QMessageBox::information",
          "args": [
            "this",
            "tr(\"Wallet encrypted\")",
            "tr(\"Wallet passphrase was successfully changed.\")"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->changePassphrase",
          "args": [
            "oldpass",
            "newpass1"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "changePassphrase",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "298-307",
          "snippet": "bool WalletModel::changePassphrase(const SecureString &oldPass, const SecureString &newPass)\n{\n    bool retval;\n    {\n        LOCK(wallet->cs_wallet);\n        wallet->Lock(); // Make sure wallet is locked before attempting pass change\n        retval = wallet->ChangeWalletPassphrase(oldPass, newPass);\n    }\n    return retval;\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  bool WalletModel::changePassphrase(const SecureString &oldPass, const SecureString &newPass)\n  {\n      bool retval;\n      {\n          LOCK(wallet->cs_wallet);\n          wallet->Lock(); // Make sure wallet is locked before attempting pass change\n          retval = wallet->ChangeWalletPassphrase(oldPass, newPass);\n      }\n      return retval;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QMessageBox::critical",
          "args": [
            "this",
            "tr(\"Wallet decryption failed\")",
            "tr(\"The passphrase entered for the wallet decryption was incorrect.\")"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->setWalletEncrypted",
          "args": [
            "false",
            "oldpass"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "setWalletEncrypted",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "270-282",
          "snippet": "bool WalletModel::setWalletEncrypted(bool encrypted, const SecureString &passphrase)\n{\n    if(encrypted)\n    {\n        // Encrypt\n        return wallet->EncryptWallet(passphrase);\n    }\n    else\n    {\n        // Decrypt -- TODO; not supported yet\n        return false;\n    }\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  bool WalletModel::setWalletEncrypted(bool encrypted, const SecureString &passphrase)\n  {\n      if(encrypted)\n      {\n          // Encrypt\n          return wallet->EncryptWallet(passphrase);\n      }\n      else\n      {\n          // Decrypt -- TODO; not supported yet\n          return false;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->stakingCheckBox->isChecked",
          "args": [],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QMessageBox::critical",
          "args": [
            "this",
            "tr(\"Wallet unlock failed\")",
            "tr(\"The passphrase entered for the wallet decryption was incorrect.\")"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->setWalletLocked",
          "args": [
            "false",
            "oldpass"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "setWalletLocked",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "284-296",
          "snippet": "bool WalletModel::setWalletLocked(bool locked, const SecureString &passPhrase)\n{\n    if(locked)\n    {\n        // Lock\n        return wallet->Lock();\n    }\n    else\n    {\n        // Unlock\n        return wallet->Unlock(passPhrase);\n    }\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  bool WalletModel::setWalletLocked(bool locked, const SecureString &passPhrase)\n  {\n      if(locked)\n      {\n          // Lock\n          return wallet->Lock();\n      }\n      else\n      {\n          // Unlock\n          return wallet->Unlock(passPhrase);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QDialog::reject",
          "args": [],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "reject",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "242-245",
          "snippet": "void SendCoinsDialog::reject()\n{\n    clear();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::reject()\n  {\n      clear();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QMessageBox::critical",
          "args": [
            "this",
            "tr(\"Wallet encryption failed\")",
            "tr(\"The supplied passphrases do not match.\")"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QMessageBox::critical",
          "args": [
            "this",
            "tr(\"Wallet encryption failed\")",
            "tr(\"Wallet encryption failed due to an internal error. Your wallet was not encrypted.\")"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::quit",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QMessageBox::warning",
          "args": [
            "this",
            "tr(\"Wallet encrypted\")",
            "\"<qt>\" + \n                                         tr(\"Halcyon will close now to finish the encryption process. \"\n                                         \"Remember that encrypting your wallet cannot fully protect \"\n                                         \"your coins from being stolen by malware infecting your computer.\") + \n                                         \"<br><br><b>\" + \n                                         tr(\"IMPORTANT: Any previous backups you have made of your wallet file \"\n                                         \"should be replaced with the newly generated, encrypted wallet file. \"\n                                         \"For security reasons, previous backups of the unencrypted wallet file \"\n                                         \"will become useless as soon as you start using the new, encrypted wallet.\") + \n                                         \"</b></qt>\""
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QMessageBox::question",
          "args": [
            "this",
            "tr(\"Confirm wallet encryption\")",
            "tr(\"Warning: If you encrypt your wallet and lose your passphrase, you will <b>LOSE ALL OF YOUR COINS</b>!\") + \"<br><br>\" + tr(\"Are you sure you wish to encrypt your wallet?\")",
            "QMessageBox::Yes|QMessageBox::Cancel",
            "QMessageBox::Cancel"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newpass2.empty",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "newpass2.assign",
          "args": [
            "ui->passEdit3->text().toStdString().c_str()"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit3->text",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "newpass1.assign",
          "args": [
            "ui->passEdit2->text().toStdString().c_str()"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oldpass.assign",
          "args": [
            "ui->passEdit1->text().toStdString().c_str()"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newpass2.reserve",
          "args": [
            "MAX_PASSPHRASE_SIZE"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "805-805",
          "snippet": "void reserve(size_type n)                        { vch.reserve(n + nReadPos); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void reserve(size_type n)                        { vch.reserve(n + nReadPos); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QKeyEvent>\n#include <QPushButton>\n#include <QMessageBox>\n#include \"walletmodel.h\"\n#include \"guiconstants.h\"\n#include \"ui_askpassphrasedialog.h\"\n#include \"askpassphrasedialog.h\"\n\nextern bool fWalletUnlockStakingOnly;\n\nAskPassphraseDialog {\n  void AskPassphraseDialog::accept()\n  {\n      SecureString oldpass, newpass1, newpass2;\n      if(!model)\n          return;\n      oldpass.reserve(MAX_PASSPHRASE_SIZE);\n      newpass1.reserve(MAX_PASSPHRASE_SIZE);\n      newpass2.reserve(MAX_PASSPHRASE_SIZE);\n      // TODO: get rid of this .c_str() by implementing SecureString::operator=(std::string)\n      // Alternately, find a way to make this input mlock()'d to begin with.\n      oldpass.assign(ui->passEdit1->text().toStdString().c_str());\n      newpass1.assign(ui->passEdit2->text().toStdString().c_str());\n      newpass2.assign(ui->passEdit3->text().toStdString().c_str());\n  \n      switch(mode)\n      {\n      case Encrypt: {\n          if(newpass1.empty() || newpass2.empty())\n          {\n              // Cannot encrypt with empty passphrase\n              break;\n          }\n          QMessageBox::StandardButton retval = QMessageBox::question(this, tr(\"Confirm wallet encryption\"),\n                   tr(\"Warning: If you encrypt your wallet and lose your passphrase, you will <b>LOSE ALL OF YOUR COINS</b>!\") + \"<br><br>\" + tr(\"Are you sure you wish to encrypt your wallet?\"),\n                   QMessageBox::Yes|QMessageBox::Cancel,\n                   QMessageBox::Cancel);\n          if(retval == QMessageBox::Yes)\n          {\n              if(newpass1 == newpass2)\n              {\n                  if(model->setWalletEncrypted(true, newpass1))\n                  {\n                      QMessageBox::warning(this, tr(\"Wallet encrypted\"),\n                                           \"<qt>\" + \n                                           tr(\"Halcyon will close now to finish the encryption process. \"\n                                           \"Remember that encrypting your wallet cannot fully protect \"\n                                           \"your coins from being stolen by malware infecting your computer.\") + \n                                           \"<br><br><b>\" + \n                                           tr(\"IMPORTANT: Any previous backups you have made of your wallet file \"\n                                           \"should be replaced with the newly generated, encrypted wallet file. \"\n                                           \"For security reasons, previous backups of the unencrypted wallet file \"\n                                           \"will become useless as soon as you start using the new, encrypted wallet.\") + \n                                           \"</b></qt>\");\n                      QApplication::quit();\n                  }\n                  else\n                  {\n                      QMessageBox::critical(this, tr(\"Wallet encryption failed\"),\n                                           tr(\"Wallet encryption failed due to an internal error. Your wallet was not encrypted.\"));\n                  }\n                  QDialog::accept(); // Success\n              }\n              else\n              {\n                  QMessageBox::critical(this, tr(\"Wallet encryption failed\"),\n                                       tr(\"The supplied passphrases do not match.\"));\n              }\n          }\n          else\n          {\n              QDialog::reject(); // Cancelled\n          }\n          } break;\n      case UnlockStaking:\n      case Unlock:\n          if(!model->setWalletLocked(false, oldpass))\n          {\n              QMessageBox::critical(this, tr(\"Wallet unlock failed\"),\n                                    tr(\"The passphrase entered for the wallet decryption was incorrect.\"));\n          }\n          else\n          {\n              fWalletUnlockStakingOnly = ui->stakingCheckBox->isChecked();\n              QDialog::accept(); // Success\n          }\n          break;\n      case Decrypt:\n          if(!model->setWalletEncrypted(false, oldpass))\n          {\n              QMessageBox::critical(this, tr(\"Wallet decryption failed\"),\n                                    tr(\"The passphrase entered for the wallet decryption was incorrect.\"));\n          }\n          else\n          {\n              QDialog::accept(); // Success\n          }\n          break;\n      case ChangePass:\n          if(newpass1 == newpass2)\n          {\n              if(model->changePassphrase(oldpass, newpass1))\n              {\n                  QMessageBox::information(this, tr(\"Wallet encrypted\"),\n                                       tr(\"Wallet passphrase was successfully changed.\"));\n                  QDialog::accept(); // Success\n              }\n              else\n              {\n                  QMessageBox::critical(this, tr(\"Wallet encryption failed\"),\n                                       tr(\"The passphrase entered for the wallet decryption was incorrect.\"));\n              }\n          }\n          else\n          {\n              QMessageBox::critical(this, tr(\"Wallet encryption failed\"),\n                                   tr(\"The supplied passphrases do not match.\"));\n          }\n          break;\n      }\n  }\n}"
  },
  {
    "function_name": "setModel",
    "container": "AskPassphraseDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/askpassphrasedialog.cpp",
    "lines": "79-82",
    "snippet": "void AskPassphraseDialog::setModel(WalletModel *model)\n{\n    this->model = model;\n}",
    "includes": [
      "#include <QKeyEvent>",
      "#include <QPushButton>",
      "#include <QMessageBox>",
      "#include \"walletmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"ui_askpassphrasedialog.h\"",
      "#include \"askpassphrasedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QKeyEvent>\n#include <QPushButton>\n#include <QMessageBox>\n#include \"walletmodel.h\"\n#include \"guiconstants.h\"\n#include \"ui_askpassphrasedialog.h\"\n#include \"askpassphrasedialog.h\"\n\nAskPassphraseDialog {\n  void AskPassphraseDialog::setModel(WalletModel *model)\n  {\n      this->model = model;\n  }\n}"
  },
  {
    "function_name": "~AskPassphraseDialog",
    "container": "AskPassphraseDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/askpassphrasedialog.cpp",
    "lines": "70-77",
    "snippet": "AskPassphraseDialog::~AskPassphraseDialog()\n{\n    // Attempt to overwrite text so that they do not linger around in memory\n    ui->passEdit1->setText(QString(\" \").repeated(ui->passEdit1->text().size()));\n    ui->passEdit2->setText(QString(\" \").repeated(ui->passEdit2->text().size()));\n    ui->passEdit3->setText(QString(\" \").repeated(ui->passEdit3->text().size()));\n    delete ui;\n}",
    "includes": [
      "#include <QKeyEvent>",
      "#include <QPushButton>",
      "#include <QMessageBox>",
      "#include \"walletmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"ui_askpassphrasedialog.h\"",
      "#include \"askpassphrasedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->passEdit3->setText",
          "args": [
            "QString(\" \").repeated(ui->passEdit3->text().size())"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "ui->passEdit3->text().size()"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit3->text",
          "args": [],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" \""
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "ui->passEdit2->text().size()"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" \""
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "ui->passEdit1->text().size()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" \""
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QKeyEvent>\n#include <QPushButton>\n#include <QMessageBox>\n#include \"walletmodel.h\"\n#include \"guiconstants.h\"\n#include \"ui_askpassphrasedialog.h\"\n#include \"askpassphrasedialog.h\"\n\nAskPassphraseDialog {\n  AskPassphraseDialog::~AskPassphraseDialog()\n  {\n      // Attempt to overwrite text so that they do not linger around in memory\n      ui->passEdit1->setText(QString(\" \").repeated(ui->passEdit1->text().size()));\n      ui->passEdit2->setText(QString(\" \").repeated(ui->passEdit2->text().size()));\n      ui->passEdit3->setText(QString(\" \").repeated(ui->passEdit3->text().size()));\n      delete ui;\n  }\n}"
  },
  {
    "function_name": "AskPassphraseDialog",
    "container": "AskPassphraseDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/askpassphrasedialog.cpp",
    "lines": "13-68",
    "snippet": "AskPassphraseDialog::AskPassphraseDialog(Mode mode, QWidget *parent) :\n    QDialog(parent),\n    ui(new Ui::AskPassphraseDialog),\n    mode(mode),\n    model(0),\n    fCapsLock(false)\n{\n    ui->setupUi(this);\n    ui->passEdit1->setMaxLength(MAX_PASSPHRASE_SIZE);\n    ui->passEdit2->setMaxLength(MAX_PASSPHRASE_SIZE);\n    ui->passEdit3->setMaxLength(MAX_PASSPHRASE_SIZE);\n    \n    // Setup Caps Lock detection.\n    ui->passEdit1->installEventFilter(this);\n    ui->passEdit2->installEventFilter(this);\n    ui->passEdit3->installEventFilter(this);\n\n    switch(mode)\n    {\n        case Encrypt: // Ask passphrase x2\n            ui->passLabel1->hide();\n            ui->passEdit1->hide();\n            ui->warningLabel->setText(tr(\"Enter the new passphrase to the wallet.<br/>Please use a passphrase of <b>10 or more random characters</b>, or <b>eight or more words</b>.\"));\n            setWindowTitle(tr(\"Encrypt wallet\"));\n            break;\n        case UnlockStaking:\n            ui->stakingCheckBox->setChecked(true);\n            ui->stakingCheckBox->show();\n            // fallthru\n        case Unlock: // Ask passphrase\n            ui->warningLabel->setText(tr(\"This operation needs your wallet passphrase to unlock the wallet.\"));\n            ui->passLabel2->hide();\n            ui->passEdit2->hide();\n            ui->passLabel3->hide();\n            ui->passEdit3->hide();\n            setWindowTitle(tr(\"Unlock wallet\"));\n            break;\n        case Decrypt:   // Ask passphrase\n            ui->warningLabel->setText(tr(\"This operation needs your wallet passphrase to decrypt the wallet.\"));\n            ui->passLabel2->hide();\n            ui->passEdit2->hide();\n            ui->passLabel3->hide();\n            ui->passEdit3->hide();\n            setWindowTitle(tr(\"Decrypt wallet\"));\n            break;\n        case ChangePass: // Ask old passphrase + new passphrase x2\n            setWindowTitle(tr(\"Change passphrase\"));\n            ui->warningLabel->setText(tr(\"Enter the old and new passphrase to the wallet.\"));\n            break;\n    }\n\n    textChanged();\n    connect(ui->passEdit1, SIGNAL(textChanged(QString)), this, SLOT(textChanged()));\n    connect(ui->passEdit2, SIGNAL(textChanged(QString)), this, SLOT(textChanged()));\n    connect(ui->passEdit3, SIGNAL(textChanged(QString)), this, SLOT(textChanged()));\n}",
    "includes": [
      "#include <QKeyEvent>",
      "#include <QPushButton>",
      "#include <QMessageBox>",
      "#include \"walletmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"ui_askpassphrasedialog.h\"",
      "#include \"askpassphrasedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->passEdit3",
            "SIGNAL(textChanged(QString))",
            "this",
            "SLOT(textChanged())"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "textChanged()"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "textChanged",
          "args": [],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "textChanged",
          "container": "AskPassphraseDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/askpassphrasedialog.cpp",
          "lines": "195-214",
          "snippet": "void AskPassphraseDialog::textChanged()\n{\n    // Validate input, set Ok button to enabled when acceptable\n    bool acceptable = false;\n    switch(mode)\n    {\n    case Encrypt: // New passphrase x2\n        acceptable = !ui->passEdit2->text().isEmpty() && !ui->passEdit3->text().isEmpty();\n        break;\n    case UnlockStaking:\n    case Unlock: // Old passphrase x1\n    case Decrypt:\n        acceptable = !ui->passEdit1->text().isEmpty();\n        break;\n    case ChangePass: // Old passphrase x1, new passphrase x2\n        acceptable = !ui->passEdit1->text().isEmpty() && !ui->passEdit2->text().isEmpty() && !ui->passEdit3->text().isEmpty();\n        break;\n    }\n    ui->buttonBox->button(QDialogButtonBox::Ok)->setEnabled(acceptable);\n}",
          "includes": [
            "#include <QKeyEvent>",
            "#include <QPushButton>",
            "#include <QMessageBox>",
            "#include \"walletmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"ui_askpassphrasedialog.h\"",
            "#include \"askpassphrasedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QKeyEvent>\n#include <QPushButton>\n#include <QMessageBox>\n#include \"walletmodel.h\"\n#include \"guiconstants.h\"\n#include \"ui_askpassphrasedialog.h\"\n#include \"askpassphrasedialog.h\"\n\nAskPassphraseDialog {\n  void AskPassphraseDialog::textChanged()\n  {\n      // Validate input, set Ok button to enabled when acceptable\n      bool acceptable = false;\n      switch(mode)\n      {\n      case Encrypt: // New passphrase x2\n          acceptable = !ui->passEdit2->text().isEmpty() && !ui->passEdit3->text().isEmpty();\n          break;\n      case UnlockStaking:\n      case Unlock: // Old passphrase x1\n      case Decrypt:\n          acceptable = !ui->passEdit1->text().isEmpty();\n          break;\n      case ChangePass: // Old passphrase x1, new passphrase x2\n          acceptable = !ui->passEdit1->text().isEmpty() && !ui->passEdit2->text().isEmpty() && !ui->passEdit3->text().isEmpty();\n          break;\n      }\n      ui->buttonBox->button(QDialogButtonBox::Ok)->setEnabled(acceptable);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "textChanged(QString)"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "textChanged",
          "args": [
            "QString"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "on_payTo_textChanged",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "58-66",
          "snippet": "void SendCoinsEntry::on_payTo_textChanged(const QString &address)\n{\n    if(!model)\n        return;\n    // Fill in label from address book, if address has an associated label\n    QString associatedLabel = model->getAddressTableModel()->labelForAddress(address);\n    if(!associatedLabel.isEmpty())\n        ui->addAsLabel->setText(associatedLabel);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::on_payTo_textChanged(const QString &address)\n  {\n      if(!model)\n          return;\n      // Fill in label from address book, if address has an associated label\n      QString associatedLabel = model->getAddressTableModel()->labelForAddress(address);\n      if(!associatedLabel.isEmpty())\n          ui->addAsLabel->setText(associatedLabel);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->passEdit2",
            "SIGNAL(textChanged(QString))",
            "this",
            "SLOT(textChanged())"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "textChanged()"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "textChanged(QString)"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->passEdit1",
            "SIGNAL(textChanged(QString))",
            "this",
            "SLOT(textChanged())"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "textChanged()"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "textChanged(QString)"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->warningLabel->setText",
          "args": [
            "tr(\"Enter the old and new passphrase to the wallet.\")"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Enter the old and new passphrase to the wallet.\""
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setWindowTitle",
          "args": [
            "tr(\"Change passphrase\")"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setWindowTitle",
          "args": [
            "tr(\"Decrypt wallet\")"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit3->hide",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passLabel3->hide",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit2->hide",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passLabel2->hide",
          "args": [],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setWindowTitle",
          "args": [
            "tr(\"Unlock wallet\")"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit3->hide",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passLabel3->hide",
          "args": [],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit2->hide",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passLabel2->hide",
          "args": [],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->stakingCheckBox->show",
          "args": [],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->stakingCheckBox->setChecked",
          "args": [
            "true"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setWindowTitle",
          "args": [
            "tr(\"Encrypt wallet\")"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit1->hide",
          "args": [],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passLabel1->hide",
          "args": [],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit3->installEventFilter",
          "args": [
            "this"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit2->installEventFilter",
          "args": [
            "this"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit1->installEventFilter",
          "args": [
            "this"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit3->setMaxLength",
          "args": [
            "MAX_PASSPHRASE_SIZE"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit2->setMaxLength",
          "args": [
            "MAX_PASSPHRASE_SIZE"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->passEdit1->setMaxLength",
          "args": [
            "MAX_PASSPHRASE_SIZE"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->setupUi",
          "args": [
            "this"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QKeyEvent>\n#include <QPushButton>\n#include <QMessageBox>\n#include \"walletmodel.h\"\n#include \"guiconstants.h\"\n#include \"ui_askpassphrasedialog.h\"\n#include \"askpassphrasedialog.h\"\n\nAskPassphraseDialog {\n  AskPassphraseDialog::AskPassphraseDialog(Mode mode, QWidget *parent) :\n      QDialog(parent),\n      ui(new Ui::AskPassphraseDialog),\n      mode(mode),\n      model(0),\n      fCapsLock(false)\n  {\n      ui->setupUi(this);\n      ui->passEdit1->setMaxLength(MAX_PASSPHRASE_SIZE);\n      ui->passEdit2->setMaxLength(MAX_PASSPHRASE_SIZE);\n      ui->passEdit3->setMaxLength(MAX_PASSPHRASE_SIZE);\n      \n      // Setup Caps Lock detection.\n      ui->passEdit1->installEventFilter(this);\n      ui->passEdit2->installEventFilter(this);\n      ui->passEdit3->installEventFilter(this);\n  \n      switch(mode)\n      {\n          case Encrypt: // Ask passphrase x2\n              ui->passLabel1->hide();\n              ui->passEdit1->hide();\n              ui->warningLabel->setText(tr(\"Enter the new passphrase to the wallet.<br/>Please use a passphrase of <b>10 or more random characters</b>, or <b>eight or more words</b>.\"));\n              setWindowTitle(tr(\"Encrypt wallet\"));\n              break;\n          case UnlockStaking:\n              ui->stakingCheckBox->setChecked(true);\n              ui->stakingCheckBox->show();\n              // fallthru\n          case Unlock: // Ask passphrase\n              ui->warningLabel->setText(tr(\"This operation needs your wallet passphrase to unlock the wallet.\"));\n              ui->passLabel2->hide();\n              ui->passEdit2->hide();\n              ui->passLabel3->hide();\n              ui->passEdit3->hide();\n              setWindowTitle(tr(\"Unlock wallet\"));\n              break;\n          case Decrypt:   // Ask passphrase\n              ui->warningLabel->setText(tr(\"This operation needs your wallet passphrase to decrypt the wallet.\"));\n              ui->passLabel2->hide();\n              ui->passEdit2->hide();\n              ui->passLabel3->hide();\n              ui->passEdit3->hide();\n              setWindowTitle(tr(\"Decrypt wallet\"));\n              break;\n          case ChangePass: // Ask old passphrase + new passphrase x2\n              setWindowTitle(tr(\"Change passphrase\"));\n              ui->warningLabel->setText(tr(\"Enter the old and new passphrase to the wallet.\"));\n              break;\n      }\n  \n      textChanged();\n      connect(ui->passEdit1, SIGNAL(textChanged(QString)), this, SLOT(textChanged()));\n      connect(ui->passEdit2, SIGNAL(textChanged(QString)), this, SLOT(textChanged()));\n      connect(ui->passEdit3, SIGNAL(textChanged(QString)), this, SLOT(textChanged()));\n  }\n}"
  }
]