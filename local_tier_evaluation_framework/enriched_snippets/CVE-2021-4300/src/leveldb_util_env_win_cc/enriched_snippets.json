[
  {
    "function_name": "InitDefaultEnv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "1022-1022",
    "snippet": "static void InitDefaultEnv() { default_env = new Win32::Win32Env(); }",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstatic void InitDefaultEnv() { default_env = new Win32::Win32Env(); }"
  },
  {
    "function_name": "~Win32Env",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "1012-1015",
    "snippet": "Win32Env::~Win32Env()\n{\n\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Win32Env::~Win32Env()\n  {\n  \n  }\n}"
  },
  {
    "function_name": "Win32Env",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "1007-1010",
    "snippet": "Win32Env::Win32Env()\n{\n\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Win32Env::Win32Env()\n  {\n  \n  }\n}"
  },
  {
    "function_name": "NewWritableFile",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "994-1005",
    "snippet": "Status Win32Env::NewWritableFile( const std::string& fname, WritableFile** result )\n{\n    Status sRet;\n    std::string path = fname;\n    Win32MapFile* pFile = new Win32MapFile(ModifyPath(path));\n    if(!pFile->isEnable()){\n        *result = NULL;\n        sRet = Status::IOError(fname,Win32::GetLastErrSz());\n    }else\n        *result = pFile;\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "fname",
            "Win32::GetLastErrSz()"
          ],
          "line": 1001
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Win32::GetLastErrSz",
          "args": [],
          "line": 1001
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastErrSz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "265-283",
          "snippet": "std::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstd::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pFile->isEnable",
          "args": [],
          "line": 999
        },
        "resolved": true,
        "details": {
          "function_name": "isEnable",
          "container": "Win32MapFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "638-641",
          "snippet": "BOOL Win32MapFile::isEnable()\n{\n    return _hFile ? TRUE : FALSE;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  BOOL Win32MapFile::isEnable()\n  {\n      return _hFile ? TRUE : FALSE;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "path"
          ],
          "line": 998
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::NewWritableFile( const std::string& fname, WritableFile** result )\n  {\n      Status sRet;\n      std::string path = fname;\n      Win32MapFile* pFile = new Win32MapFile(ModifyPath(path));\n      if(!pFile->isEnable()){\n          *result = NULL;\n          sRet = Status::IOError(fname,Win32::GetLastErrSz());\n      }else\n          *result = pFile;\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "NewLogger",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "980-992",
    "snippet": "Status Win32Env::NewLogger( const std::string& fname, Logger** result )\n{\n    Status sRet;\n    std::string path = fname;\n    Win32MapFile* pMapFile = new Win32MapFile(ModifyPath(path));\n    if(!pMapFile->isEnable()){\n        delete pMapFile;\n        *result = NULL;\n        sRet = Status::IOError(path,\"could not create a logger.\");\n    }else\n        *result = new Win32Logger(pMapFile);\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "path",
            "\"could not create a logger.\""
          ],
          "line": 988
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pMapFile->isEnable",
          "args": [],
          "line": 985
        },
        "resolved": true,
        "details": {
          "function_name": "isEnable",
          "container": "Win32FileLock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "675-678",
          "snippet": "BOOL Win32FileLock::isEnable()\n{\n    return _hFile ? TRUE : FALSE;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32FileLock {\n  BOOL Win32FileLock::isEnable()\n  {\n      return _hFile ? TRUE : FALSE;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "path"
          ],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::NewLogger( const std::string& fname, Logger** result )\n  {\n      Status sRet;\n      std::string path = fname;\n      Win32MapFile* pMapFile = new Win32MapFile(ModifyPath(path));\n      if(!pMapFile->isEnable()){\n          delete pMapFile;\n          *result = NULL;\n          sRet = Status::IOError(path,\"could not create a logger.\");\n      }else\n          *result = new Win32Logger(pMapFile);\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "NewRandomAccessFile",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "966-978",
    "snippet": "Status Win32Env::NewRandomAccessFile( const std::string& fname, RandomAccessFile** result )\n{\n    Status sRet;\n    std::string path = fname;\n    Win32RandomAccessFile* pFile = new Win32RandomAccessFile(ModifyPath(path));\n    if(!pFile->isEnable()){\n        delete pFile;\n        *result = NULL;\n        sRet = Status::IOError(path, Win32::GetLastErrSz());\n    }else\n        *result = pFile;\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "path",
            "Win32::GetLastErrSz()"
          ],
          "line": 974
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Win32::GetLastErrSz",
          "args": [],
          "line": 974
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastErrSz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "265-283",
          "snippet": "std::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstd::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pFile->isEnable",
          "args": [],
          "line": 971
        },
        "resolved": true,
        "details": {
          "function_name": "isEnable",
          "container": "Win32MapFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "638-641",
          "snippet": "BOOL Win32MapFile::isEnable()\n{\n    return _hFile ? TRUE : FALSE;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  BOOL Win32MapFile::isEnable()\n  {\n      return _hFile ? TRUE : FALSE;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "path"
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::NewRandomAccessFile( const std::string& fname, RandomAccessFile** result )\n  {\n      Status sRet;\n      std::string path = fname;\n      Win32RandomAccessFile* pFile = new Win32RandomAccessFile(ModifyPath(path));\n      if(!pFile->isEnable()){\n          delete pFile;\n          *result = NULL;\n          sRet = Status::IOError(path, Win32::GetLastErrSz());\n      }else\n          *result = pFile;\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "NewSequentialFile",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "951-964",
    "snippet": "Status Win32Env::NewSequentialFile( const std::string& fname, SequentialFile** result )\n{\n    Status sRet;\n    std::string path = fname;\n    ModifyPath(path);\n    Win32SequentialFile* pFile = new Win32SequentialFile(path);\n    if(pFile->isEnable()){\n        *result = pFile;\n    }else {\n        delete pFile;\n        sRet = Status::IOError(path, Win32::GetLastErrSz());\n    }\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "path",
            "Win32::GetLastErrSz()"
          ],
          "line": 961
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Win32::GetLastErrSz",
          "args": [],
          "line": 961
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastErrSz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "265-283",
          "snippet": "std::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstd::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pFile->isEnable",
          "args": [],
          "line": 957
        },
        "resolved": true,
        "details": {
          "function_name": "isEnable",
          "container": "Win32MapFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "638-641",
          "snippet": "BOOL Win32MapFile::isEnable()\n{\n    return _hFile ? TRUE : FALSE;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  BOOL Win32MapFile::isEnable()\n  {\n      return _hFile ? TRUE : FALSE;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "path"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::NewSequentialFile( const std::string& fname, SequentialFile** result )\n  {\n      Status sRet;\n      std::string path = fname;\n      ModifyPath(path);\n      Win32SequentialFile* pFile = new Win32SequentialFile(path);\n      if(pFile->isEnable()){\n          *result = pFile;\n      }else {\n          delete pFile;\n          sRet = Status::IOError(path, Win32::GetLastErrSz());\n      }\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "DeleteDir",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "939-949",
    "snippet": "Status Win32Env::DeleteDir( const std::string& dirname )\n{\n    Status sRet;\n    std::wstring path;\n\tToWidePath(dirname, path);\n    ModifyPath(path);\n    if(!::RemoveDirectoryW( path.c_str() ) ){\n        sRet = Status::IOError(dirname, \"Could not delete directory.\");\n    }\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "dirname",
            "\"Could not delete directory.\""
          ],
          "line": 946
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "::RemoveDirectoryW",
          "args": [
            "path.c_str()"
          ],
          "line": 945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.c_str",
          "args": [],
          "line": 945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "path"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToWidePath",
          "args": [
            "dirname",
            "path"
          ],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "ToWidePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "218-222",
          "snippet": "void ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::DeleteDir( const std::string& dirname )\n  {\n      Status sRet;\n      std::wstring path;\n  \tToWidePath(dirname, path);\n      ModifyPath(path);\n      if(!::RemoveDirectoryW( path.c_str() ) ){\n          sRet = Status::IOError(dirname, \"Could not delete directory.\");\n      }\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "CreateDir",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "928-937",
    "snippet": "Status Win32Env::CreateDir( const std::string& dirname )\n{\n    std::string path = dirname;\n    if(path[path.length() - 1] != '\\\\'){\n        path += '\\\\';\n    }\n    ModifyPath(path);\n\n    return CreateDirInner(path);\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CreateDirInner",
          "args": [
            "path"
          ],
          "line": 936
        },
        "resolved": true,
        "details": {
          "function_name": "CreateDirInner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "909-926",
          "snippet": "static Status CreateDirInner( const std::string& dirname )\n{\n    Status sRet;\n    DWORD attr = ::GetFileAttributes(dirname.c_str());\n    if (attr == INVALID_FILE_ATTRIBUTES) { // doesn't exist:\n      std::size_t slash = dirname.find_last_of(\"\\\\\");\n      if (slash != std::string::npos){\n\tsRet = CreateDirInner(dirname.substr(0, slash));\n\tif (!sRet.ok()) return sRet;\n      }\n      BOOL result = ::CreateDirectory(dirname.c_str(), NULL);\n      if (result == FALSE) {\n\tsRet = Status::IOError(dirname, \"Could not create directory.\");\n\treturn sRet;\n      }\n    }\n    return sRet;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstatic Status CreateDirInner( const std::string& dirname )\n{\n    Status sRet;\n    DWORD attr = ::GetFileAttributes(dirname.c_str());\n    if (attr == INVALID_FILE_ATTRIBUTES) { // doesn't exist:\n      std::size_t slash = dirname.find_last_of(\"\\\\\");\n      if (slash != std::string::npos){\n\tsRet = CreateDirInner(dirname.substr(0, slash));\n\tif (!sRet.ok()) return sRet;\n      }\n      BOOL result = ::CreateDirectory(dirname.c_str(), NULL);\n      if (result == FALSE) {\n\tsRet = Status::IOError(dirname, \"Could not create directory.\");\n\treturn sRet;\n      }\n    }\n    return sRet;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "path"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.length",
          "args": [],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::CreateDir( const std::string& dirname )\n  {\n      std::string path = dirname;\n      if(path[path.length() - 1] != '\\\\'){\n          path += '\\\\';\n      }\n      ModifyPath(path);\n  \n      return CreateDirInner(path);\n  }\n}"
  },
  {
    "function_name": "CreateDirInner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "909-926",
    "snippet": "static Status CreateDirInner( const std::string& dirname )\n{\n    Status sRet;\n    DWORD attr = ::GetFileAttributes(dirname.c_str());\n    if (attr == INVALID_FILE_ATTRIBUTES) { // doesn't exist:\n      std::size_t slash = dirname.find_last_of(\"\\\\\");\n      if (slash != std::string::npos){\n\tsRet = CreateDirInner(dirname.substr(0, slash));\n\tif (!sRet.ok()) return sRet;\n      }\n      BOOL result = ::CreateDirectory(dirname.c_str(), NULL);\n      if (result == FALSE) {\n\tsRet = Status::IOError(dirname, \"Could not create directory.\");\n\treturn sRet;\n      }\n    }\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "dirname",
            "\"Could not create directory.\""
          ],
          "line": 921
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "::CreateDirectory",
          "args": [
            "dirname.c_str()",
            "NULL"
          ],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirname.c_str",
          "args": [],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sRet.ok",
          "args": [],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "TableBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/table_builder.h",
          "lines": "78-78",
          "snippet": "bool ok() const { return status().ok(); }",
          "includes": [
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include <stdint.h>\n\nTableBuilder {\n  bool ok() const { return status().ok(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CreateDirInner",
          "args": [
            "dirname.substr(0, slash)"
          ],
          "line": 916
        },
        "resolved": true,
        "details": {
          "function_name": "CreateDirInner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "909-926",
          "snippet": "static Status CreateDirInner( const std::string& dirname )\n{\n    Status sRet;\n    DWORD attr = ::GetFileAttributes(dirname.c_str());\n    if (attr == INVALID_FILE_ATTRIBUTES) { // doesn't exist:\n      std::size_t slash = dirname.find_last_of(\"\\\\\");\n      if (slash != std::string::npos){\n\tsRet = CreateDirInner(dirname.substr(0, slash));\n\tif (!sRet.ok()) return sRet;\n      }\n      BOOL result = ::CreateDirectory(dirname.c_str(), NULL);\n      if (result == FALSE) {\n\tsRet = Status::IOError(dirname, \"Could not create directory.\");\n\treturn sRet;\n      }\n    }\n    return sRet;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "dirname.substr",
          "args": [
            "0",
            "slash"
          ],
          "line": 916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirname.find_last_of",
          "args": [
            "\"\\\\\""
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::GetFileAttributes",
          "args": [
            "dirname.c_str()"
          ],
          "line": 912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirname.c_str",
          "args": [],
          "line": 912
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstatic Status CreateDirInner( const std::string& dirname )\n{\n    Status sRet;\n    DWORD attr = ::GetFileAttributes(dirname.c_str());\n    if (attr == INVALID_FILE_ATTRIBUTES) { // doesn't exist:\n      std::size_t slash = dirname.find_last_of(\"\\\\\");\n      if (slash != std::string::npos){\n\tsRet = CreateDirInner(dirname.substr(0, slash));\n\tif (!sRet.ok()) return sRet;\n      }\n      BOOL result = ::CreateDirectory(dirname.c_str(), NULL);\n      if (result == FALSE) {\n\tsRet = Status::IOError(dirname, \"Could not create directory.\");\n\treturn sRet;\n      }\n    }\n    return sRet;\n}"
  },
  {
    "function_name": "NowMicros",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "901-907",
    "snippet": "uint64_t Win32Env::NowMicros()\n{\n#ifndef USE_VISTA_API\n#define GetTickCount64 GetTickCount\n#endif\n    return (uint64_t)(GetTickCount64()*1000);\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [
      "#define GetTickCount64 GetTickCount"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetTickCount64",
          "args": [],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\n#define GetTickCount64 GetTickCount\n\nWin32Env {\n  uint64_t Win32Env::NowMicros()\n  {\n  #ifndef USE_VISTA_API\n  #define GetTickCount64 GetTickCount\n  #endif\n      return (uint64_t)(GetTickCount64()*1000);\n  }\n}"
  },
  {
    "function_name": "GetTestDirectory",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "890-899",
    "snippet": "Status Win32Env::GetTestDirectory( std::string* path )\n{\n    Status sRet;\n    WCHAR TempPath[MAX_PATH];\n    ::GetTempPathW(MAX_PATH,TempPath);\n\tToNarrowPath(TempPath, *path);\n    path->append(\"leveldb\\\\test\\\\\");\n    ModifyPath(*path);\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "*path"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->append",
          "args": [
            "\"leveldb\\\\test\\\\\""
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToNarrowPath",
          "args": [
            "TempPath",
            "*path"
          ],
          "line": 895
        },
        "resolved": true,
        "details": {
          "function_name": "ToNarrowPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "224-228",
          "snippet": "void ToNarrowPath(const std::wstring& value, std::string& target) {\n\tchar buffer[MAX_PATH];\n\tWideCharToMultiByte(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH, NULL, NULL);\n\ttarget = buffer;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToNarrowPath(const std::wstring& value, std::string& target) {\n\tchar buffer[MAX_PATH];\n\tWideCharToMultiByte(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH, NULL, NULL);\n\ttarget = buffer;\n}"
        }
      },
      {
        "call_info": {
          "callee": "::GetTempPathW",
          "args": [
            "MAX_PATH",
            "TempPath"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::GetTestDirectory( std::string* path )\n  {\n      Status sRet;\n      WCHAR TempPath[MAX_PATH];\n      ::GetTempPathW(MAX_PATH,TempPath);\n  \tToNarrowPath(TempPath, *path);\n      path->append(\"leveldb\\\\test\\\\\");\n      ModifyPath(*path);\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "StartThread",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "885-888",
    "snippet": "void Win32Env::StartThread( void (*function)(void* arg), void* arg )\n{\n    ::_beginthread(function,0,arg);\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::_beginthread",
          "args": [
            "function",
            "0",
            "arg"
          ],
          "line": 887
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  void Win32Env::StartThread( void (*function)(void* arg), void* arg )\n  {\n      ::_beginthread(function,0,arg);\n  }\n}"
  },
  {
    "function_name": "Schedule",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "878-883",
    "snippet": "void Win32Env::Schedule( void (*function)(void* arg), void* arg )\n{\n    QueueUserWorkItem(Win32::WorkItemWrapperProc,\n                      new Win32::WorkItemWrapper(function,arg),\n                      WT_EXECUTEDEFAULT);\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QueueUserWorkItem",
          "args": [
            "Win32::WorkItemWrapperProc",
            "new Win32::WorkItemWrapper(function,arg)",
            "WT_EXECUTEDEFAULT"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  void Win32Env::Schedule( void (*function)(void* arg), void* arg )\n  {\n      QueueUserWorkItem(Win32::WorkItemWrapperProc,\n                        new Win32::WorkItemWrapper(function,arg),\n                        WT_EXECUTEDEFAULT);\n  }\n}"
  },
  {
    "function_name": "UnlockFile",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "871-876",
    "snippet": "Status Win32Env::UnlockFile( FileLock* lock )\n{\n    Status sRet;\n    delete lock;\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::UnlockFile( FileLock* lock )\n  {\n      Status sRet;\n      delete lock;\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "LockFile",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "855-869",
    "snippet": "Status Win32Env::LockFile( const std::string& fname, FileLock** lock )\n{\n    Status sRet;\n    std::string path = fname;\n    ModifyPath(path);\n    Win32FileLock* _lock = new Win32FileLock(path);\n    if(!_lock->isEnable()){\n        delete _lock;\n        *lock = NULL;\n        sRet = Status::IOError(path, \"Could not lock file.\");\n    }\n    else\n        *lock = _lock;\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "path",
            "\"Could not lock file.\""
          ],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "_lock->isEnable",
          "args": [],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "isEnable",
          "container": "Win32FileLock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "675-678",
          "snippet": "BOOL Win32FileLock::isEnable()\n{\n    return _hFile ? TRUE : FALSE;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32FileLock {\n  BOOL Win32FileLock::isEnable()\n  {\n      return _hFile ? TRUE : FALSE;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "path"
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::LockFile( const std::string& fname, FileLock** lock )\n  {\n      Status sRet;\n      std::string path = fname;\n      ModifyPath(path);\n      Win32FileLock* _lock = new Win32FileLock(path);\n      if(!_lock->isEnable()){\n          delete _lock;\n          *lock = NULL;\n          sRet = Status::IOError(path, \"Could not lock file.\");\n      }\n      else\n          *lock = _lock;\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "RenameFile",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "832-853",
    "snippet": "Status Win32Env::RenameFile( const std::string& src, const std::string& target )\n{\n    Status sRet;\n    std::string src_path = src;\n    std::wstring wsrc_path;\n\tToWidePath(ModifyPath(src_path), wsrc_path);\n\tstd::string target_path = target;\n    std::wstring wtarget_path;\n\tToWidePath(ModifyPath(target_path), wtarget_path);\n\n    if(!MoveFileW(wsrc_path.c_str(), wtarget_path.c_str() ) ){\n        DWORD err = GetLastError();\n        if(err == 0x000000b7){\n            if(!::DeleteFileW(wtarget_path.c_str() ) )\n                sRet = Status::IOError(src, \"Could not rename file.\");\n\t\t\telse if(!::MoveFileW(wsrc_path.c_str(),\n                                 wtarget_path.c_str() ) )\n                sRet = Status::IOError(src, \"Could not rename file.\");    \n        }\n    }\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "src",
            "\"Could not rename file.\""
          ],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "::MoveFileW",
          "args": [
            "wsrc_path.c_str()",
            "wtarget_path.c_str()"
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wtarget_path.c_str",
          "args": [],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wsrc_path.c_str",
          "args": [],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::DeleteFileW",
          "args": [
            "wtarget_path.c_str()"
          ],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wtarget_path.c_str",
          "args": [],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetLastError",
          "args": [],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MoveFileW",
          "args": [
            "wsrc_path.c_str()",
            "wtarget_path.c_str()"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wtarget_path.c_str",
          "args": [],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wsrc_path.c_str",
          "args": [],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToWidePath",
          "args": [
            "ModifyPath(target_path)",
            "wtarget_path"
          ],
          "line": 840
        },
        "resolved": true,
        "details": {
          "function_name": "ToWidePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "218-222",
          "snippet": "void ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "target_path"
          ],
          "line": 840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "src_path"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::RenameFile( const std::string& src, const std::string& target )\n  {\n      Status sRet;\n      std::string src_path = src;\n      std::wstring wsrc_path;\n  \tToWidePath(ModifyPath(src_path), wsrc_path);\n  \tstd::string target_path = target;\n      std::wstring wtarget_path;\n  \tToWidePath(ModifyPath(target_path), wtarget_path);\n  \n      if(!MoveFileW(wsrc_path.c_str(), wtarget_path.c_str() ) ){\n          DWORD err = GetLastError();\n          if(err == 0x000000b7){\n              if(!::DeleteFileW(wtarget_path.c_str() ) )\n                  sRet = Status::IOError(src, \"Could not rename file.\");\n  \t\t\telse if(!::MoveFileW(wsrc_path.c_str(),\n                                   wtarget_path.c_str() ) )\n                  sRet = Status::IOError(src, \"Could not rename file.\");    \n          }\n      }\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "GetFileSize",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "814-830",
    "snippet": "Status Win32Env::GetFileSize( const std::string& fname, uint64_t* file_size )\n{\n    Status sRet;\n    std::string path = fname;\n    std::wstring wpath;\n\tToWidePath(ModifyPath(path), wpath);\n\n    HANDLE file = ::CreateFileW(wpath.c_str(),\n        GENERIC_READ,FILE_SHARE_READ,NULL,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,NULL);\n    LARGE_INTEGER li;\n    if(::GetFileSizeEx(file,&li)){\n        *file_size = (uint64_t)li.QuadPart;\n    }else\n        sRet = Status::IOError(path,\"Could not get the file size.\");\n    CloseHandle(file);\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CloseHandle",
          "args": [
            "file"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "path",
            "\"Could not get the file size.\""
          ],
          "line": 827
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "::GetFileSizeEx",
          "args": [
            "file",
            "&li"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::CreateFileW",
          "args": [
            "wpath.c_str()",
            "GENERIC_READ",
            "FILE_SHARE_READ",
            "NULL",
            "OPEN_EXISTING",
            "FILE_ATTRIBUTE_NORMAL",
            "NULL"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wpath.c_str",
          "args": [],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToWidePath",
          "args": [
            "ModifyPath(path)",
            "wpath"
          ],
          "line": 819
        },
        "resolved": true,
        "details": {
          "function_name": "ToWidePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "218-222",
          "snippet": "void ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "path"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::GetFileSize( const std::string& fname, uint64_t* file_size )\n  {\n      Status sRet;\n      std::string path = fname;\n      std::wstring wpath;\n  \tToWidePath(ModifyPath(path), wpath);\n  \n      HANDLE file = ::CreateFileW(wpath.c_str(),\n          GENERIC_READ,FILE_SHARE_READ,NULL,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,NULL);\n      LARGE_INTEGER li;\n      if(::GetFileSizeEx(file,&li)){\n          *file_size = (uint64_t)li.QuadPart;\n      }else\n          sRet = Status::IOError(path,\"Could not get the file size.\");\n      CloseHandle(file);\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "DeleteFile",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "801-812",
    "snippet": "Status Win32Env::DeleteFile( const std::string& fname )\n{\n    Status sRet;\n    std::string path = fname;\n    std::wstring wpath;\n\tToWidePath(ModifyPath(path), wpath);\n\n    if(!::DeleteFileW(wpath.c_str())) {\n        sRet = Status::IOError(path, \"Could not delete file.\");\n    }\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "path",
            "\"Could not delete file.\""
          ],
          "line": 809
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "::DeleteFileW",
          "args": [
            "wpath.c_str()"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wpath.c_str",
          "args": [],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToWidePath",
          "args": [
            "ModifyPath(path)",
            "wpath"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "ToWidePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "218-222",
          "snippet": "void ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "path"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::DeleteFile( const std::string& fname )\n  {\n      Status sRet;\n      std::string path = fname;\n      std::wstring wpath;\n  \tToWidePath(ModifyPath(path), wpath);\n  \n      if(!::DeleteFileW(wpath.c_str())) {\n          sRet = Status::IOError(path, \"Could not delete file.\");\n      }\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "SleepForMicroseconds",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "795-798",
    "snippet": "void Win32Env::SleepForMicroseconds( int micros )\n{\n    ::Sleep((micros + 999) /1000);\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::Sleep",
          "args": [
            "(micros + 999) /1000"
          ],
          "line": 797
        },
        "resolved": true,
        "details": {
          "function_name": "SleepForMicroseconds",
          "container": "Win32Env",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "795-798",
          "snippet": "void Win32Env::SleepForMicroseconds( int micros )\n{\n    ::Sleep((micros + 999) /1000);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  void Win32Env::SleepForMicroseconds( int micros )\n  {\n      ::Sleep((micros + 999) /1000);\n  }\n}"
  },
  {
    "function_name": "GetChildren",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "767-793",
    "snippet": "Status Win32Env::GetChildren(const std::string& dir, std::vector<std::string>* result)\n{\n    Status sRet;\n    ::WIN32_FIND_DATAW wfd;\n    std::string path = dir;\n    ModifyPath(path);\n    path += \"\\\\*.*\";\n\tstd::wstring wpath;\n\tToWidePath(path, wpath);\n\n\t::HANDLE hFind = ::FindFirstFileW(wpath.c_str() ,&wfd);\n    if(hFind && hFind != INVALID_HANDLE_VALUE){\n        BOOL hasNext = TRUE;\n        std::string child;\n        while(hasNext){\n            ToNarrowPath(wfd.cFileName, child); \n            if(child != \"..\" && child != \".\")  {\n                result->push_back(child);\n            }\n            hasNext = ::FindNextFileW(hFind,&wfd);\n        }\n        ::FindClose(hFind);\n    }\n    else\n        sRet = Status::IOError(dir,\"Could not get children.\");\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "dir",
            "\"Could not get children.\""
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "::FindClose",
          "args": [
            "hFind"
          ],
          "line": 788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::FindNextFileW",
          "args": [
            "hFind",
            "&wfd"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result->push_back",
          "args": [
            "child"
          ],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToNarrowPath",
          "args": [
            "wfd.cFileName",
            "child"
          ],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "ToNarrowPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "224-228",
          "snippet": "void ToNarrowPath(const std::wstring& value, std::string& target) {\n\tchar buffer[MAX_PATH];\n\tWideCharToMultiByte(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH, NULL, NULL);\n\ttarget = buffer;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToNarrowPath(const std::wstring& value, std::string& target) {\n\tchar buffer[MAX_PATH];\n\tWideCharToMultiByte(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH, NULL, NULL);\n\ttarget = buffer;\n}"
        }
      },
      {
        "call_info": {
          "callee": "::FindFirstFileW",
          "args": [
            "wpath.c_str()",
            "&wfd"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wpath.c_str",
          "args": [],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToWidePath",
          "args": [
            "path",
            "wpath"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "ToWidePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "218-222",
          "snippet": "void ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "path"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::GetChildren(const std::string& dir, std::vector<std::string>* result)\n  {\n      Status sRet;\n      ::WIN32_FIND_DATAW wfd;\n      std::string path = dir;\n      ModifyPath(path);\n      path += \"\\\\*.*\";\n  \tstd::wstring wpath;\n  \tToWidePath(path, wpath);\n  \n  \t::HANDLE hFind = ::FindFirstFileW(wpath.c_str() ,&wfd);\n      if(hFind && hFind != INVALID_HANDLE_VALUE){\n          BOOL hasNext = TRUE;\n          std::string child;\n          while(hasNext){\n              ToNarrowPath(wfd.cFileName, child); \n              if(child != \"..\" && child != \".\")  {\n                  result->push_back(child);\n              }\n              hasNext = ::FindNextFileW(hFind,&wfd);\n          }\n          ::FindClose(hFind);\n      }\n      else\n          sRet = Status::IOError(dir,\"Could not get children.\");\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "FileExists",
    "container": "Win32Env",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "759-765",
    "snippet": "bool Win32Env::FileExists(const std::string& fname)\n{\n\tstd::string path = fname;\n    std::wstring wpath;\n\tToWidePath(ModifyPath(path), wpath);\n    return ::PathFileExistsW(wpath.c_str()) ? true : false;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::PathFileExistsW",
          "args": [
            "wpath.c_str()"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wpath.c_str",
          "args": [],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToWidePath",
          "args": [
            "ModifyPath(path)",
            "wpath"
          ],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "ToWidePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "218-222",
          "snippet": "void ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModifyPath",
          "args": [
            "path"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  bool Win32Env::FileExists(const std::string& fname)\n  {\n  \tstd::string path = fname;\n      std::wstring wpath;\n  \tToWidePath(ModifyPath(path), wpath);\n      return ::PathFileExistsW(wpath.c_str()) ? true : false;\n  }\n}"
  },
  {
    "function_name": "Logv",
    "container": "Win32Logger",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "691-757",
    "snippet": "void Win32Logger::Logv( const char* format, va_list ap )\n{\n    uint64_t thread_id = ::GetCurrentThreadId();\n\n    // We try twice: the first time with a fixed-size stack allocated buffer,\n    // and the second time with a much larger dynamically allocated buffer.\n    char buffer[500];\n    for (int iter = 0; iter < 2; iter++) {\n        char* base;\n        int bufsize;\n        if (iter == 0) {\n            bufsize = sizeof(buffer);\n            base = buffer;\n        } else {\n            bufsize = 30000;\n            base = new char[bufsize];\n        }\n        char* p = base;\n        char* limit = base + bufsize;\n\n        SYSTEMTIME st;\n        GetLocalTime(&st);\n        p += snprintf(p, limit - p,\n            \"%04d/%02d/%02d-%02d:%02d:%02d.%06d %llx \",\n            int(st.wYear),\n            int(st.wMonth),\n            int(st.wDay),\n            int(st.wHour),\n            int(st.wMinute),\n            int(st.wMinute),\n            int(st.wMilliseconds),\n            static_cast<long long unsigned int>(thread_id));\n\n        // Print the message\n        if (p < limit) {\n            va_list backup_ap;\n            va_copy(backup_ap, ap);\n            p += vsnprintf(p, limit - p, format, backup_ap);\n            va_end(backup_ap);\n        }\n\n        // Truncate to available space if necessary\n        if (p >= limit) {\n            if (iter == 0) {\n                continue;       // Try again with larger buffer\n            } else {\n                p = limit - 1;\n            }\n        }\n\n        // Add newline if necessary\n        if (p == base || p[-1] != '\\n') {\n            *p++ = '\\n';\n        }\n\n        assert(p <= limit);\n        DWORD hasWritten = 0;\n        if(_pFileProxy){\n            _pFileProxy->Append(Slice(base, p - base));\n            _pFileProxy->Flush();\n        }\n        if (base != buffer) {\n            delete[] base;\n        }\n        break;\n    }\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_pFileProxy->Flush",
          "args": [],
          "line": 750
        },
        "resolved": true,
        "details": {
          "function_name": "Flush",
          "container": "Win32MapFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "610-613",
          "snippet": "Status Win32MapFile::Flush()\n{\n    return Status::OK();\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  Status Win32MapFile::Flush()\n  {\n      return Status::OK();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_pFileProxy->Append",
          "args": [
            "Slice(base, p - base)"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "Append",
          "container": "Win32MapFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "535-557",
          "snippet": "Status Win32MapFile::Append( const Slice& data )\n{\n    const char* src = data.data();\n    size_t left = data.size();\n    Status s;\n    while (left > 0) {\n        assert(_base <= _dst);\n        assert(_dst <= _limit);\n        size_t avail = _limit - _dst;\n        if (avail == 0) {\n            if (!_UnmapCurrentRegion() ||\n                !_MapNewRegion()) {\n                    return Status::IOError(\"WinMmapFile.Append::UnmapCurrentRegion or MapNewRegion: \", Win32::GetLastErrSz());\n            }\n        }\n        size_t n = (left <= avail) ? left : avail;\n        memcpy(_dst, src, n);\n        _dst += n;\n        src += n;\n        left -= n;\n    }\n    return s;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  Status Win32MapFile::Append( const Slice& data )\n  {\n      const char* src = data.data();\n      size_t left = data.size();\n      Status s;\n      while (left > 0) {\n          assert(_base <= _dst);\n          assert(_dst <= _limit);\n          size_t avail = _limit - _dst;\n          if (avail == 0) {\n              if (!_UnmapCurrentRegion() ||\n                  !_MapNewRegion()) {\n                      return Status::IOError(\"WinMmapFile.Append::UnmapCurrentRegion or MapNewRegion: \", Win32::GetLastErrSz());\n              }\n          }\n          size_t n = (left <= avail) ? left : avail;\n          memcpy(_dst, src, n);\n          _dst += n;\n          src += n;\n          left -= n;\n      }\n      return s;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "base",
            "p - base"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "p <= limit"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "backup_ap"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsnprintf",
          "args": [
            "p",
            "limit - p",
            "format",
            "backup_ap"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_copy",
          "args": [
            "backup_ap",
            "ap"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "p",
            "limit - p",
            "\"%04d/%02d/%02d-%02d:%02d:%02d.%06d %llx \"",
            "int(st.wYear)",
            "int(st.wMonth)",
            "int(st.wDay)",
            "int(st.wHour)",
            "int(st.wMinute)",
            "int(st.wMinute)",
            "int(st.wMilliseconds)",
            "static_cast<long long unsigned int>(thread_id)"
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<long long unsigned int>",
          "args": [
            "thread_id"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "int",
          "args": [
            "st.wMilliseconds"
          ],
          "line": 721
        },
        "resolved": true,
        "details": {
          "function_name": "VarintLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "103-110",
          "snippet": "int VarintLength(uint64_t v) {\n  int len = 1;\n  while (v >= 128) {\n    v >>= 7;\n    len++;\n  }\n  return len;\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nint VarintLength(uint64_t v) {\n  int len = 1;\n  while (v >= 128) {\n    v >>= 7;\n    len++;\n  }\n  return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLocalTime",
          "args": [
            "&st"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::GetCurrentThreadId",
          "args": [],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Logger {\n  void Win32Logger::Logv( const char* format, va_list ap )\n  {\n      uint64_t thread_id = ::GetCurrentThreadId();\n  \n      // We try twice: the first time with a fixed-size stack allocated buffer,\n      // and the second time with a much larger dynamically allocated buffer.\n      char buffer[500];\n      for (int iter = 0; iter < 2; iter++) {\n          char* base;\n          int bufsize;\n          if (iter == 0) {\n              bufsize = sizeof(buffer);\n              base = buffer;\n          } else {\n              bufsize = 30000;\n              base = new char[bufsize];\n          }\n          char* p = base;\n          char* limit = base + bufsize;\n  \n          SYSTEMTIME st;\n          GetLocalTime(&st);\n          p += snprintf(p, limit - p,\n              \"%04d/%02d/%02d-%02d:%02d:%02d.%06d %llx \",\n              int(st.wYear),\n              int(st.wMonth),\n              int(st.wDay),\n              int(st.wHour),\n              int(st.wMinute),\n              int(st.wMinute),\n              int(st.wMilliseconds),\n              static_cast<long long unsigned int>(thread_id));\n  \n          // Print the message\n          if (p < limit) {\n              va_list backup_ap;\n              va_copy(backup_ap, ap);\n              p += vsnprintf(p, limit - p, format, backup_ap);\n              va_end(backup_ap);\n          }\n  \n          // Truncate to available space if necessary\n          if (p >= limit) {\n              if (iter == 0) {\n                  continue;       // Try again with larger buffer\n              } else {\n                  p = limit - 1;\n              }\n          }\n  \n          // Add newline if necessary\n          if (p == base || p[-1] != '\\n') {\n              *p++ = '\\n';\n          }\n  \n          assert(p <= limit);\n          DWORD hasWritten = 0;\n          if(_pFileProxy){\n              _pFileProxy->Append(Slice(base, p - base));\n              _pFileProxy->Flush();\n          }\n          if (base != buffer) {\n              delete[] base;\n          }\n          break;\n      }\n  }\n}"
  },
  {
    "function_name": "~Win32Logger",
    "container": "Win32Logger",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "685-689",
    "snippet": "Win32Logger::~Win32Logger()\n{\n    if(_pFileProxy)\n        delete _pFileProxy;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Logger {\n  Win32Logger::~Win32Logger()\n  {\n      if(_pFileProxy)\n          delete _pFileProxy;\n  }\n}"
  },
  {
    "function_name": "Win32Logger",
    "container": "Win32Logger",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "680-683",
    "snippet": "Win32Logger::Win32Logger(WritableFile* pFile) : _pFileProxy(pFile)\n{\n    assert(_pFileProxy);\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "_pFileProxy"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Logger {\n  Win32Logger::Win32Logger(WritableFile* pFile) : _pFileProxy(pFile)\n  {\n      assert(_pFileProxy);\n  }\n}"
  },
  {
    "function_name": "isEnable",
    "container": "Win32FileLock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "675-678",
    "snippet": "BOOL Win32FileLock::isEnable()\n{\n    return _hFile ? TRUE : FALSE;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32FileLock {\n  BOOL Win32FileLock::isEnable()\n  {\n      return _hFile ? TRUE : FALSE;\n  }\n}"
  },
  {
    "function_name": "_CleanUp",
    "container": "Win32FileLock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "669-673",
    "snippet": "void Win32FileLock::_CleanUp()\n{\n    ::CloseHandle(_hFile);\n    _hFile = NULL;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::CloseHandle",
          "args": [
            "_hFile"
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32FileLock {\n  void Win32FileLock::_CleanUp()\n  {\n      ::CloseHandle(_hFile);\n      _hFile = NULL;\n  }\n}"
  },
  {
    "function_name": "_Init",
    "container": "Win32FileLock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "656-667",
    "snippet": "BOOL Win32FileLock::_Init( LPCWSTR path )\n{\n    BOOL bRet = FALSE;\n    if(!_hFile)\n        _hFile = ::CreateFileW(path,0,0,NULL,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,NULL);\n    if(!_hFile || _hFile == INVALID_HANDLE_VALUE ){\n        _hFile = NULL;\n    }\n    else\n        bRet = TRUE;\n    return bRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::CreateFileW",
          "args": [
            "path",
            "0",
            "0",
            "NULL",
            "CREATE_ALWAYS",
            "FILE_ATTRIBUTE_NORMAL",
            "NULL"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32FileLock {\n  BOOL Win32FileLock::_Init( LPCWSTR path )\n  {\n      BOOL bRet = FALSE;\n      if(!_hFile)\n          _hFile = ::CreateFileW(path,0,0,NULL,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,NULL);\n      if(!_hFile || _hFile == INVALID_HANDLE_VALUE ){\n          _hFile = NULL;\n      }\n      else\n          bRet = TRUE;\n      return bRet;\n  }\n}"
  },
  {
    "function_name": "~Win32FileLock",
    "container": "Win32FileLock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "651-654",
    "snippet": "Win32FileLock::~Win32FileLock()\n{\n    _CleanUp();\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_CleanUp",
          "args": [],
          "line": 653
        },
        "resolved": true,
        "details": {
          "function_name": "_CleanUp",
          "container": "Win32FileLock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "669-673",
          "snippet": "void Win32FileLock::_CleanUp()\n{\n    ::CloseHandle(_hFile);\n    _hFile = NULL;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32FileLock {\n  void Win32FileLock::_CleanUp()\n  {\n      ::CloseHandle(_hFile);\n      _hFile = NULL;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32FileLock {\n  Win32FileLock::~Win32FileLock()\n  {\n      _CleanUp();\n  }\n}"
  },
  {
    "function_name": "Win32FileLock",
    "container": "Win32FileLock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "643-649",
    "snippet": "Win32FileLock::Win32FileLock( const std::string& fname ) :\n    _hFile(NULL),_filename(fname)\n{\n\tstd::wstring path;\n\tToWidePath(fname, path);\n\t_Init(path.c_str());\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Init",
          "args": [
            "path.c_str()"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "_Init",
          "container": "Win32FileLock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "656-667",
          "snippet": "BOOL Win32FileLock::_Init( LPCWSTR path )\n{\n    BOOL bRet = FALSE;\n    if(!_hFile)\n        _hFile = ::CreateFileW(path,0,0,NULL,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,NULL);\n    if(!_hFile || _hFile == INVALID_HANDLE_VALUE ){\n        _hFile = NULL;\n    }\n    else\n        bRet = TRUE;\n    return bRet;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32FileLock {\n  BOOL Win32FileLock::_Init( LPCWSTR path )\n  {\n      BOOL bRet = FALSE;\n      if(!_hFile)\n          _hFile = ::CreateFileW(path,0,0,NULL,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,NULL);\n      if(!_hFile || _hFile == INVALID_HANDLE_VALUE ){\n          _hFile = NULL;\n      }\n      else\n          bRet = TRUE;\n      return bRet;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path.c_str",
          "args": [],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToWidePath",
          "args": [
            "fname",
            "path"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "ToWidePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "218-222",
          "snippet": "void ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32FileLock {\n  Win32FileLock::Win32FileLock( const std::string& fname ) :\n      _hFile(NULL),_filename(fname)\n  {\n  \tstd::wstring path;\n  \tToWidePath(fname, path);\n  \t_Init(path.c_str());\n  }\n}"
  },
  {
    "function_name": "isEnable",
    "container": "Win32MapFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "638-641",
    "snippet": "BOOL Win32MapFile::isEnable()\n{\n    return _hFile ? TRUE : FALSE;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  BOOL Win32MapFile::isEnable()\n  {\n      return _hFile ? TRUE : FALSE;\n  }\n}"
  },
  {
    "function_name": "_Init",
    "container": "Win32MapFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "622-636",
    "snippet": "BOOL Win32MapFile::_Init( LPCWSTR Path )\n{\n    DWORD Flag = PathFileExistsW(Path) ? OPEN_EXISTING : CREATE_ALWAYS;\n    _hFile = CreateFileW(Path,\n                         GENERIC_READ | GENERIC_WRITE,\n                         FILE_SHARE_READ|FILE_SHARE_DELETE|FILE_SHARE_WRITE,\n                         NULL,\n                         Flag,\n                         FILE_ATTRIBUTE_NORMAL,\n                         NULL);\n    if(!_hFile || _hFile == INVALID_HANDLE_VALUE)\n        return FALSE;\n    else\n        return TRUE;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CreateFileW",
          "args": [
            "Path",
            "GENERIC_READ | GENERIC_WRITE",
            "FILE_SHARE_READ|FILE_SHARE_DELETE|FILE_SHARE_WRITE",
            "NULL",
            "Flag",
            "FILE_ATTRIBUTE_NORMAL",
            "NULL"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PathFileExistsW",
          "args": [
            "Path"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  BOOL Win32MapFile::_Init( LPCWSTR Path )\n  {\n      DWORD Flag = PathFileExistsW(Path) ? OPEN_EXISTING : CREATE_ALWAYS;\n      _hFile = CreateFileW(Path,\n                           GENERIC_READ | GENERIC_WRITE,\n                           FILE_SHARE_READ|FILE_SHARE_DELETE|FILE_SHARE_WRITE,\n                           NULL,\n                           Flag,\n                           FILE_ATTRIBUTE_NORMAL,\n                           NULL);\n      if(!_hFile || _hFile == INVALID_HANDLE_VALUE)\n          return FALSE;\n      else\n          return TRUE;\n  }\n}"
  },
  {
    "function_name": "~Win32MapFile",
    "container": "Win32MapFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "615-620",
    "snippet": "Win32MapFile::~Win32MapFile()\n{\n    if (_hFile != INVALID_HANDLE_VALUE) { \n        Win32MapFile::Close();\n    }\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Win32MapFile::Close",
          "args": [],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "Close",
          "container": "Win32MapFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "559-585",
          "snippet": "Status Win32MapFile::Close()\n{\n    Status s;\n    size_t unused = _limit - _dst;\n    if (!_UnmapCurrentRegion()) {\n        s = Status::IOError(\"WinMmapFile.Close::UnmapCurrentRegion: \",Win32::GetLastErrSz());\n    } else if (unused > 0) {\n        // Trim the extra space at the end of the file\n        LARGE_INTEGER newSize;\n        newSize.QuadPart = _file_offset - unused;\n        if (!SetFilePointerEx(_hFile, newSize, NULL, FILE_BEGIN)) {\n            s = Status::IOError(\"WinMmapFile.Close::SetFilePointer: \",Win32::GetLastErrSz());\n        } else \n            SetEndOfFile(_hFile);\n    }\n    if (!CloseHandle(_hFile)) {\n        if (s.ok()) {\n            s = Status::IOError(\"WinMmapFile.Close::CloseHandle: \", Win32::GetLastErrSz());\n        }\n    }\n    _hFile = INVALID_HANDLE_VALUE;\n    _base = NULL;\n    _base_handle = NULL;\n    _limit = NULL;\n\n    return s;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  Status Win32MapFile::Close()\n  {\n      Status s;\n      size_t unused = _limit - _dst;\n      if (!_UnmapCurrentRegion()) {\n          s = Status::IOError(\"WinMmapFile.Close::UnmapCurrentRegion: \",Win32::GetLastErrSz());\n      } else if (unused > 0) {\n          // Trim the extra space at the end of the file\n          LARGE_INTEGER newSize;\n          newSize.QuadPart = _file_offset - unused;\n          if (!SetFilePointerEx(_hFile, newSize, NULL, FILE_BEGIN)) {\n              s = Status::IOError(\"WinMmapFile.Close::SetFilePointer: \",Win32::GetLastErrSz());\n          } else \n              SetEndOfFile(_hFile);\n      }\n      if (!CloseHandle(_hFile)) {\n          if (s.ok()) {\n              s = Status::IOError(\"WinMmapFile.Close::CloseHandle: \", Win32::GetLastErrSz());\n          }\n      }\n      _hFile = INVALID_HANDLE_VALUE;\n      _base = NULL;\n      _base_handle = NULL;\n      _limit = NULL;\n  \n      return s;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  Win32MapFile::~Win32MapFile()\n  {\n      if (_hFile != INVALID_HANDLE_VALUE) { \n          Win32MapFile::Close();\n      }\n  }\n}"
  },
  {
    "function_name": "Flush",
    "container": "Win32MapFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "610-613",
    "snippet": "Status Win32MapFile::Flush()\n{\n    return Status::OK();\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  Status Win32MapFile::Flush()\n  {\n      return Status::OK();\n  }\n}"
  },
  {
    "function_name": "Sync",
    "container": "Win32MapFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "587-608",
    "snippet": "Status Win32MapFile::Sync()\n{\n    Status s;\n    if (_pending_sync) {\n        // Some unmapped data was not synced\n        _pending_sync = false;\n        if (!FlushFileBuffers(_hFile)) {\n            s = Status::IOError(\"WinMmapFile.Sync::FlushFileBuffers: \",Win32::GetLastErrSz());\n        }\n    }\n    if (_dst > _last_sync) {\n        // Find the beginnings of the pages that contain the first and last\n        // bytes to be synced.\n        size_t p1 = _TruncateToPageBoundary(_last_sync - _base);\n        size_t p2 = _TruncateToPageBoundary(_dst - _base - 1);\n        _last_sync = _dst;\n        if (!FlushViewOfFile(_base + p1, p2 - p1 + _page_size)) {\n            s = Status::IOError(\"WinMmapFile.Sync::FlushViewOfFile: \",Win32::GetLastErrSz());\n        }\n    }\n    return s;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "\"WinMmapFile.Sync::FlushViewOfFile: \"",
            "Win32::GetLastErrSz()"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Win32::GetLastErrSz",
          "args": [],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastErrSz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "265-283",
          "snippet": "std::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstd::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "FlushViewOfFile",
          "args": [
            "_base + p1",
            "p2 - p1 + _page_size"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_TruncateToPageBoundary",
          "args": [
            "_dst - _base - 1"
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "_TruncateToPageBoundary",
          "container": "Win32MapFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "450-455",
          "snippet": "size_t Win32MapFile::_TruncateToPageBoundary( size_t s )\n{\n    s -= (s & (_page_size - 1));\n    assert((s % _page_size) == 0);\n    return s;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  size_t Win32MapFile::_TruncateToPageBoundary( size_t s )\n  {\n      s -= (s & (_page_size - 1));\n      assert((s % _page_size) == 0);\n      return s;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FlushFileBuffers",
          "args": [
            "_hFile"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  Status Win32MapFile::Sync()\n  {\n      Status s;\n      if (_pending_sync) {\n          // Some unmapped data was not synced\n          _pending_sync = false;\n          if (!FlushFileBuffers(_hFile)) {\n              s = Status::IOError(\"WinMmapFile.Sync::FlushFileBuffers: \",Win32::GetLastErrSz());\n          }\n      }\n      if (_dst > _last_sync) {\n          // Find the beginnings of the pages that contain the first and last\n          // bytes to be synced.\n          size_t p1 = _TruncateToPageBoundary(_last_sync - _base);\n          size_t p2 = _TruncateToPageBoundary(_dst - _base - 1);\n          _last_sync = _dst;\n          if (!FlushViewOfFile(_base + p1, p2 - p1 + _page_size)) {\n              s = Status::IOError(\"WinMmapFile.Sync::FlushViewOfFile: \",Win32::GetLastErrSz());\n          }\n      }\n      return s;\n  }\n}"
  },
  {
    "function_name": "Close",
    "container": "Win32MapFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "559-585",
    "snippet": "Status Win32MapFile::Close()\n{\n    Status s;\n    size_t unused = _limit - _dst;\n    if (!_UnmapCurrentRegion()) {\n        s = Status::IOError(\"WinMmapFile.Close::UnmapCurrentRegion: \",Win32::GetLastErrSz());\n    } else if (unused > 0) {\n        // Trim the extra space at the end of the file\n        LARGE_INTEGER newSize;\n        newSize.QuadPart = _file_offset - unused;\n        if (!SetFilePointerEx(_hFile, newSize, NULL, FILE_BEGIN)) {\n            s = Status::IOError(\"WinMmapFile.Close::SetFilePointer: \",Win32::GetLastErrSz());\n        } else \n            SetEndOfFile(_hFile);\n    }\n    if (!CloseHandle(_hFile)) {\n        if (s.ok()) {\n            s = Status::IOError(\"WinMmapFile.Close::CloseHandle: \", Win32::GetLastErrSz());\n        }\n    }\n    _hFile = INVALID_HANDLE_VALUE;\n    _base = NULL;\n    _base_handle = NULL;\n    _limit = NULL;\n\n    return s;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "\"WinMmapFile.Close::CloseHandle: \"",
            "Win32::GetLastErrSz()"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Win32::GetLastErrSz",
          "args": [],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastErrSz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "265-283",
          "snippet": "std::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstd::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CloseHandle",
          "args": [
            "_hFile"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetEndOfFile",
          "args": [
            "_hFile"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetFilePointerEx",
          "args": [
            "_hFile",
            "newSize",
            "NULL",
            "FILE_BEGIN"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_UnmapCurrentRegion",
          "args": [],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "_UnmapCurrentRegion",
          "container": "Win32MapFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "457-479",
          "snippet": "bool Win32MapFile::_UnmapCurrentRegion()\n{\n    bool result = true;\n    if (_base != NULL) {\n        if (_last_sync < _limit) {\n            // Defer syncing this data until next Sync() call, if any\n            _pending_sync = true;\n        }\n        if (!UnmapViewOfFile(_base) || !CloseHandle(_base_handle))\n            result = false;\n        _file_offset += _limit - _base;\n        _base = NULL;\n        _base_handle = NULL;\n        _limit = NULL;\n        _last_sync = NULL;\n        _dst = NULL;\n        // Increase the amount we map the next time, but capped at 1MB\n        if (_map_size < (1<<20)) {\n            _map_size *= 2;\n        }\n    }\n    return result;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  bool Win32MapFile::_UnmapCurrentRegion()\n  {\n      bool result = true;\n      if (_base != NULL) {\n          if (_last_sync < _limit) {\n              // Defer syncing this data until next Sync() call, if any\n              _pending_sync = true;\n          }\n          if (!UnmapViewOfFile(_base) || !CloseHandle(_base_handle))\n              result = false;\n          _file_offset += _limit - _base;\n          _base = NULL;\n          _base_handle = NULL;\n          _limit = NULL;\n          _last_sync = NULL;\n          _dst = NULL;\n          // Increase the amount we map the next time, but capped at 1MB\n          if (_map_size < (1<<20)) {\n              _map_size *= 2;\n          }\n      }\n      return result;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  Status Win32MapFile::Close()\n  {\n      Status s;\n      size_t unused = _limit - _dst;\n      if (!_UnmapCurrentRegion()) {\n          s = Status::IOError(\"WinMmapFile.Close::UnmapCurrentRegion: \",Win32::GetLastErrSz());\n      } else if (unused > 0) {\n          // Trim the extra space at the end of the file\n          LARGE_INTEGER newSize;\n          newSize.QuadPart = _file_offset - unused;\n          if (!SetFilePointerEx(_hFile, newSize, NULL, FILE_BEGIN)) {\n              s = Status::IOError(\"WinMmapFile.Close::SetFilePointer: \",Win32::GetLastErrSz());\n          } else \n              SetEndOfFile(_hFile);\n      }\n      if (!CloseHandle(_hFile)) {\n          if (s.ok()) {\n              s = Status::IOError(\"WinMmapFile.Close::CloseHandle: \", Win32::GetLastErrSz());\n          }\n      }\n      _hFile = INVALID_HANDLE_VALUE;\n      _base = NULL;\n      _base_handle = NULL;\n      _limit = NULL;\n  \n      return s;\n  }\n}"
  },
  {
    "function_name": "Append",
    "container": "Win32MapFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "535-557",
    "snippet": "Status Win32MapFile::Append( const Slice& data )\n{\n    const char* src = data.data();\n    size_t left = data.size();\n    Status s;\n    while (left > 0) {\n        assert(_base <= _dst);\n        assert(_dst <= _limit);\n        size_t avail = _limit - _dst;\n        if (avail == 0) {\n            if (!_UnmapCurrentRegion() ||\n                !_MapNewRegion()) {\n                    return Status::IOError(\"WinMmapFile.Append::UnmapCurrentRegion or MapNewRegion: \", Win32::GetLastErrSz());\n            }\n        }\n        size_t n = (left <= avail) ? left : avail;\n        memcpy(_dst, src, n);\n        _dst += n;\n        src += n;\n        left -= n;\n    }\n    return s;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "_dst",
            "src",
            "n"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "\"WinMmapFile.Append::UnmapCurrentRegion or MapNewRegion: \"",
            "Win32::GetLastErrSz()"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Win32::GetLastErrSz",
          "args": [],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastErrSz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "265-283",
          "snippet": "std::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstd::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_MapNewRegion",
          "args": [],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "_MapNewRegion",
          "container": "Win32MapFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "481-514",
          "snippet": "bool Win32MapFile::_MapNewRegion()\n{\n    assert(_base == NULL);\n    //LONG newSizeHigh = (LONG)((file_offset_ + map_size_) >> 32);\n    //LONG newSizeLow = (LONG)((file_offset_ + map_size_) & 0xFFFFFFFF);\n    DWORD off_hi = (DWORD)(_file_offset >> 32);\n    DWORD off_lo = (DWORD)(_file_offset & 0xFFFFFFFF);\n    LARGE_INTEGER newSize;\n    newSize.QuadPart = _file_offset + _map_size;\n    SetFilePointerEx(_hFile, newSize, NULL, FILE_BEGIN);\n    SetEndOfFile(_hFile);\n\n    _base_handle = CreateFileMappingA(\n        _hFile,\n        NULL,\n        PAGE_READWRITE,\n        0,\n        0,\n        0);\n    if (_base_handle != NULL) {\n        _base = (char*) MapViewOfFile(_base_handle,\n            FILE_MAP_ALL_ACCESS,\n            off_hi,\n            off_lo,\n            _map_size);\n        if (_base != NULL) {\n            _limit = _base + _map_size;\n            _dst = _base;\n            _last_sync = _base;\n            return true;\n        }\n    }\n    return false;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  bool Win32MapFile::_MapNewRegion()\n  {\n      assert(_base == NULL);\n      //LONG newSizeHigh = (LONG)((file_offset_ + map_size_) >> 32);\n      //LONG newSizeLow = (LONG)((file_offset_ + map_size_) & 0xFFFFFFFF);\n      DWORD off_hi = (DWORD)(_file_offset >> 32);\n      DWORD off_lo = (DWORD)(_file_offset & 0xFFFFFFFF);\n      LARGE_INTEGER newSize;\n      newSize.QuadPart = _file_offset + _map_size;\n      SetFilePointerEx(_hFile, newSize, NULL, FILE_BEGIN);\n      SetEndOfFile(_hFile);\n  \n      _base_handle = CreateFileMappingA(\n          _hFile,\n          NULL,\n          PAGE_READWRITE,\n          0,\n          0,\n          0);\n      if (_base_handle != NULL) {\n          _base = (char*) MapViewOfFile(_base_handle,\n              FILE_MAP_ALL_ACCESS,\n              off_hi,\n              off_lo,\n              _map_size);\n          if (_base != NULL) {\n              _limit = _base + _map_size;\n              _dst = _base;\n              _last_sync = _base;\n              return true;\n          }\n      }\n      return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_UnmapCurrentRegion",
          "args": [],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "_UnmapCurrentRegion",
          "container": "Win32MapFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "457-479",
          "snippet": "bool Win32MapFile::_UnmapCurrentRegion()\n{\n    bool result = true;\n    if (_base != NULL) {\n        if (_last_sync < _limit) {\n            // Defer syncing this data until next Sync() call, if any\n            _pending_sync = true;\n        }\n        if (!UnmapViewOfFile(_base) || !CloseHandle(_base_handle))\n            result = false;\n        _file_offset += _limit - _base;\n        _base = NULL;\n        _base_handle = NULL;\n        _limit = NULL;\n        _last_sync = NULL;\n        _dst = NULL;\n        // Increase the amount we map the next time, but capped at 1MB\n        if (_map_size < (1<<20)) {\n            _map_size *= 2;\n        }\n    }\n    return result;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  bool Win32MapFile::_UnmapCurrentRegion()\n  {\n      bool result = true;\n      if (_base != NULL) {\n          if (_last_sync < _limit) {\n              // Defer syncing this data until next Sync() call, if any\n              _pending_sync = true;\n          }\n          if (!UnmapViewOfFile(_base) || !CloseHandle(_base_handle))\n              result = false;\n          _file_offset += _limit - _base;\n          _base = NULL;\n          _base_handle = NULL;\n          _limit = NULL;\n          _last_sync = NULL;\n          _dst = NULL;\n          // Increase the amount we map the next time, but capped at 1MB\n          if (_map_size < (1<<20)) {\n              _map_size *= 2;\n          }\n      }\n      return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "_dst <= _limit"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "_base <= _dst"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.size",
          "args": [],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.data",
          "args": [],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  Status Win32MapFile::Append( const Slice& data )\n  {\n      const char* src = data.data();\n      size_t left = data.size();\n      Status s;\n      while (left > 0) {\n          assert(_base <= _dst);\n          assert(_dst <= _limit);\n          size_t avail = _limit - _dst;\n          if (avail == 0) {\n              if (!_UnmapCurrentRegion() ||\n                  !_MapNewRegion()) {\n                      return Status::IOError(\"WinMmapFile.Append::UnmapCurrentRegion or MapNewRegion: \", Win32::GetLastErrSz());\n              }\n          }\n          size_t n = (left <= avail) ? left : avail;\n          memcpy(_dst, src, n);\n          _dst += n;\n          src += n;\n          left -= n;\n      }\n      return s;\n  }\n}"
  },
  {
    "function_name": "Win32MapFile",
    "container": "Win32MapFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "516-533",
    "snippet": "Win32MapFile::Win32MapFile( const std::string& fname) :\n    _filename(fname),\n    _hFile(NULL),\n    _page_size(Win32::g_PageSize),\n    _map_size(_Roundup(65536, Win32::g_PageSize)),\n    _base(NULL),\n    _base_handle(NULL),\n    _limit(NULL),\n    _dst(NULL),\n    _last_sync(NULL),\n    _file_offset(0),\n    _pending_sync(false)\n{\n\tstd::wstring path;\n\tToWidePath(fname, path);\n    _Init(path.c_str());\n    assert((Win32::g_PageSize & (Win32::g_PageSize - 1)) == 0);\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "(Win32::g_PageSize & (Win32::g_PageSize - 1)) == 0"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_Init",
          "args": [
            "path.c_str()"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "_Init",
          "container": "Win32FileLock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "656-667",
          "snippet": "BOOL Win32FileLock::_Init( LPCWSTR path )\n{\n    BOOL bRet = FALSE;\n    if(!_hFile)\n        _hFile = ::CreateFileW(path,0,0,NULL,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,NULL);\n    if(!_hFile || _hFile == INVALID_HANDLE_VALUE ){\n        _hFile = NULL;\n    }\n    else\n        bRet = TRUE;\n    return bRet;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32FileLock {\n  BOOL Win32FileLock::_Init( LPCWSTR path )\n  {\n      BOOL bRet = FALSE;\n      if(!_hFile)\n          _hFile = ::CreateFileW(path,0,0,NULL,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,NULL);\n      if(!_hFile || _hFile == INVALID_HANDLE_VALUE ){\n          _hFile = NULL;\n      }\n      else\n          bRet = TRUE;\n      return bRet;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path.c_str",
          "args": [],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToWidePath",
          "args": [
            "fname",
            "path"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "ToWidePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "218-222",
          "snippet": "void ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_Roundup",
          "args": [
            "65536",
            "Win32::g_PageSize"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "_Roundup",
          "container": "Win32MapFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "445-448",
          "snippet": "size_t Win32MapFile::_Roundup( size_t x, size_t y )\n{\n    return ((x + y - 1) / y) * y;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  size_t Win32MapFile::_Roundup( size_t x, size_t y )\n  {\n      return ((x + y - 1) / y) * y;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  Win32MapFile::Win32MapFile( const std::string& fname) :\n      _filename(fname),\n      _hFile(NULL),\n      _page_size(Win32::g_PageSize),\n      _map_size(_Roundup(65536, Win32::g_PageSize)),\n      _base(NULL),\n      _base_handle(NULL),\n      _limit(NULL),\n      _dst(NULL),\n      _last_sync(NULL),\n      _file_offset(0),\n      _pending_sync(false)\n  {\n  \tstd::wstring path;\n  \tToWidePath(fname, path);\n      _Init(path.c_str());\n      assert((Win32::g_PageSize & (Win32::g_PageSize - 1)) == 0);\n  }\n}"
  },
  {
    "function_name": "_MapNewRegion",
    "container": "Win32MapFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "481-514",
    "snippet": "bool Win32MapFile::_MapNewRegion()\n{\n    assert(_base == NULL);\n    //LONG newSizeHigh = (LONG)((file_offset_ + map_size_) >> 32);\n    //LONG newSizeLow = (LONG)((file_offset_ + map_size_) & 0xFFFFFFFF);\n    DWORD off_hi = (DWORD)(_file_offset >> 32);\n    DWORD off_lo = (DWORD)(_file_offset & 0xFFFFFFFF);\n    LARGE_INTEGER newSize;\n    newSize.QuadPart = _file_offset + _map_size;\n    SetFilePointerEx(_hFile, newSize, NULL, FILE_BEGIN);\n    SetEndOfFile(_hFile);\n\n    _base_handle = CreateFileMappingA(\n        _hFile,\n        NULL,\n        PAGE_READWRITE,\n        0,\n        0,\n        0);\n    if (_base_handle != NULL) {\n        _base = (char*) MapViewOfFile(_base_handle,\n            FILE_MAP_ALL_ACCESS,\n            off_hi,\n            off_lo,\n            _map_size);\n        if (_base != NULL) {\n            _limit = _base + _map_size;\n            _dst = _base;\n            _last_sync = _base;\n            return true;\n        }\n    }\n    return false;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MapViewOfFile",
          "args": [
            "_base_handle",
            "FILE_MAP_ALL_ACCESS",
            "off_hi",
            "off_lo",
            "_map_size"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CreateFileMappingA",
          "args": [
            "_hFile",
            "NULL",
            "PAGE_READWRITE",
            "0",
            "0",
            "0"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetEndOfFile",
          "args": [
            "_hFile"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetFilePointerEx",
          "args": [
            "_hFile",
            "newSize",
            "NULL",
            "FILE_BEGIN"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "_file_offset & 0xFFFFFFFF"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "_file_offset >> 32"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "_base == NULL"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  bool Win32MapFile::_MapNewRegion()\n  {\n      assert(_base == NULL);\n      //LONG newSizeHigh = (LONG)((file_offset_ + map_size_) >> 32);\n      //LONG newSizeLow = (LONG)((file_offset_ + map_size_) & 0xFFFFFFFF);\n      DWORD off_hi = (DWORD)(_file_offset >> 32);\n      DWORD off_lo = (DWORD)(_file_offset & 0xFFFFFFFF);\n      LARGE_INTEGER newSize;\n      newSize.QuadPart = _file_offset + _map_size;\n      SetFilePointerEx(_hFile, newSize, NULL, FILE_BEGIN);\n      SetEndOfFile(_hFile);\n  \n      _base_handle = CreateFileMappingA(\n          _hFile,\n          NULL,\n          PAGE_READWRITE,\n          0,\n          0,\n          0);\n      if (_base_handle != NULL) {\n          _base = (char*) MapViewOfFile(_base_handle,\n              FILE_MAP_ALL_ACCESS,\n              off_hi,\n              off_lo,\n              _map_size);\n          if (_base != NULL) {\n              _limit = _base + _map_size;\n              _dst = _base;\n              _last_sync = _base;\n              return true;\n          }\n      }\n      return false;\n  }\n}"
  },
  {
    "function_name": "_UnmapCurrentRegion",
    "container": "Win32MapFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "457-479",
    "snippet": "bool Win32MapFile::_UnmapCurrentRegion()\n{\n    bool result = true;\n    if (_base != NULL) {\n        if (_last_sync < _limit) {\n            // Defer syncing this data until next Sync() call, if any\n            _pending_sync = true;\n        }\n        if (!UnmapViewOfFile(_base) || !CloseHandle(_base_handle))\n            result = false;\n        _file_offset += _limit - _base;\n        _base = NULL;\n        _base_handle = NULL;\n        _limit = NULL;\n        _last_sync = NULL;\n        _dst = NULL;\n        // Increase the amount we map the next time, but capped at 1MB\n        if (_map_size < (1<<20)) {\n            _map_size *= 2;\n        }\n    }\n    return result;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CloseHandle",
          "args": [
            "_base_handle"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UnmapViewOfFile",
          "args": [
            "_base"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  bool Win32MapFile::_UnmapCurrentRegion()\n  {\n      bool result = true;\n      if (_base != NULL) {\n          if (_last_sync < _limit) {\n              // Defer syncing this data until next Sync() call, if any\n              _pending_sync = true;\n          }\n          if (!UnmapViewOfFile(_base) || !CloseHandle(_base_handle))\n              result = false;\n          _file_offset += _limit - _base;\n          _base = NULL;\n          _base_handle = NULL;\n          _limit = NULL;\n          _last_sync = NULL;\n          _dst = NULL;\n          // Increase the amount we map the next time, but capped at 1MB\n          if (_map_size < (1<<20)) {\n              _map_size *= 2;\n          }\n      }\n      return result;\n  }\n}"
  },
  {
    "function_name": "_TruncateToPageBoundary",
    "container": "Win32MapFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "450-455",
    "snippet": "size_t Win32MapFile::_TruncateToPageBoundary( size_t s )\n{\n    s -= (s & (_page_size - 1));\n    assert((s % _page_size) == 0);\n    return s;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "(s % _page_size) == 0"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  size_t Win32MapFile::_TruncateToPageBoundary( size_t s )\n  {\n      s -= (s & (_page_size - 1));\n      assert((s % _page_size) == 0);\n      return s;\n  }\n}"
  },
  {
    "function_name": "_Roundup",
    "container": "Win32MapFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "445-448",
    "snippet": "size_t Win32MapFile::_Roundup( size_t x, size_t y )\n{\n    return ((x + y - 1) / y) * y;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32MapFile {\n  size_t Win32MapFile::_Roundup( size_t x, size_t y )\n  {\n      return ((x + y - 1) / y) * y;\n  }\n}"
  },
  {
    "function_name": "_CleanUp",
    "container": "Win32RandomAccessFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "437-443",
    "snippet": "void Win32RandomAccessFile::_CleanUp()\n{\n    if(_hFile){\n        ::CloseHandle(_hFile);\n        _hFile = NULL;\n    }\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::CloseHandle",
          "args": [
            "_hFile"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32RandomAccessFile {\n  void Win32RandomAccessFile::_CleanUp()\n  {\n      if(_hFile){\n          ::CloseHandle(_hFile);\n          _hFile = NULL;\n      }\n  }\n}"
  },
  {
    "function_name": "isEnable",
    "container": "Win32RandomAccessFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "432-435",
    "snippet": "BOOL Win32RandomAccessFile::isEnable()\n{\n    return _hFile ? TRUE : FALSE;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32RandomAccessFile {\n  BOOL Win32RandomAccessFile::isEnable()\n  {\n      return _hFile ? TRUE : FALSE;\n  }\n}"
  },
  {
    "function_name": "_Init",
    "container": "Win32RandomAccessFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "419-430",
    "snippet": "BOOL Win32RandomAccessFile::_Init( LPCWSTR path )\n{\n    BOOL bRet = FALSE;\n    if(!_hFile)\n        _hFile = ::CreateFileW(path,GENERIC_READ,FILE_SHARE_READ,NULL,OPEN_EXISTING,\n        FILE_ATTRIBUTE_NORMAL | FILE_FLAG_RANDOM_ACCESS,NULL);\n    if(!_hFile || _hFile == INVALID_HANDLE_VALUE )\n        _hFile = NULL;\n    else\n        bRet = TRUE;\n    return bRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::CreateFileW",
          "args": [
            "path",
            "GENERIC_READ",
            "FILE_SHARE_READ",
            "NULL",
            "OPEN_EXISTING",
            "FILE_ATTRIBUTE_NORMAL | FILE_FLAG_RANDOM_ACCESS",
            "NULL"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32RandomAccessFile {\n  BOOL Win32RandomAccessFile::_Init( LPCWSTR path )\n  {\n      BOOL bRet = FALSE;\n      if(!_hFile)\n          _hFile = ::CreateFileW(path,GENERIC_READ,FILE_SHARE_READ,NULL,OPEN_EXISTING,\n          FILE_ATTRIBUTE_NORMAL | FILE_FLAG_RANDOM_ACCESS,NULL);\n      if(!_hFile || _hFile == INVALID_HANDLE_VALUE )\n          _hFile = NULL;\n      else\n          bRet = TRUE;\n      return bRet;\n  }\n}"
  },
  {
    "function_name": "Read",
    "container": "Win32RandomAccessFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "404-417",
    "snippet": "Status Win32RandomAccessFile::Read(uint64_t offset,size_t n,Slice* result,char* scratch) const\n{\n    Status sRet;\n    OVERLAPPED ol = {0};\n    ZeroMemory(&ol,sizeof(ol));\n    ol.Offset = (DWORD)offset;\n    ol.OffsetHigh = (DWORD)(offset >> 32);\n    DWORD hasRead = 0;\n    if(!ReadFile(_hFile,scratch,n,&hasRead,&ol))\n        sRet = Status::IOError(_filename,Win32::GetLastErrSz());\n    else\n        *result = Slice(scratch,hasRead);\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "scratch",
            "hasRead"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "_filename",
            "Win32::GetLastErrSz()"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Win32::GetLastErrSz",
          "args": [],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastErrSz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "265-283",
          "snippet": "std::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstd::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ReadFile",
          "args": [
            "_hFile",
            "scratch",
            "n",
            "&hasRead",
            "&ol"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "offset >> 32"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ZeroMemory",
          "args": [
            "&ol",
            "sizeof(ol)"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32RandomAccessFile {\n  Status Win32RandomAccessFile::Read(uint64_t offset,size_t n,Slice* result,char* scratch) const\n  {\n      Status sRet;\n      OVERLAPPED ol = {0};\n      ZeroMemory(&ol,sizeof(ol));\n      ol.Offset = (DWORD)offset;\n      ol.OffsetHigh = (DWORD)(offset >> 32);\n      DWORD hasRead = 0;\n      if(!ReadFile(_hFile,scratch,n,&hasRead,&ol))\n          sRet = Status::IOError(_filename,Win32::GetLastErrSz());\n      else\n          *result = Slice(scratch,hasRead);\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "~Win32RandomAccessFile",
    "container": "Win32RandomAccessFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "399-402",
    "snippet": "Win32RandomAccessFile::~Win32RandomAccessFile()\n{\n    _CleanUp();\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_CleanUp",
          "args": [],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "_CleanUp",
          "container": "Win32FileLock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "669-673",
          "snippet": "void Win32FileLock::_CleanUp()\n{\n    ::CloseHandle(_hFile);\n    _hFile = NULL;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32FileLock {\n  void Win32FileLock::_CleanUp()\n  {\n      ::CloseHandle(_hFile);\n      _hFile = NULL;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32RandomAccessFile {\n  Win32RandomAccessFile::~Win32RandomAccessFile()\n  {\n      _CleanUp();\n  }\n}"
  },
  {
    "function_name": "Win32RandomAccessFile",
    "container": "Win32RandomAccessFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "391-397",
    "snippet": "Win32RandomAccessFile::Win32RandomAccessFile( const std::string& fname ) :\n    _filename(fname),_hFile(NULL)\n{\n\tstd::wstring path;\n\tToWidePath(fname, path);\n    _Init( path.c_str() );\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Init",
          "args": [
            "path.c_str()"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "_Init",
          "container": "Win32FileLock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "656-667",
          "snippet": "BOOL Win32FileLock::_Init( LPCWSTR path )\n{\n    BOOL bRet = FALSE;\n    if(!_hFile)\n        _hFile = ::CreateFileW(path,0,0,NULL,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,NULL);\n    if(!_hFile || _hFile == INVALID_HANDLE_VALUE ){\n        _hFile = NULL;\n    }\n    else\n        bRet = TRUE;\n    return bRet;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32FileLock {\n  BOOL Win32FileLock::_Init( LPCWSTR path )\n  {\n      BOOL bRet = FALSE;\n      if(!_hFile)\n          _hFile = ::CreateFileW(path,0,0,NULL,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,NULL);\n      if(!_hFile || _hFile == INVALID_HANDLE_VALUE ){\n          _hFile = NULL;\n      }\n      else\n          bRet = TRUE;\n      return bRet;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path.c_str",
          "args": [],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToWidePath",
          "args": [
            "fname",
            "path"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "ToWidePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "218-222",
          "snippet": "void ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32RandomAccessFile {\n  Win32RandomAccessFile::Win32RandomAccessFile( const std::string& fname ) :\n      _filename(fname),_hFile(NULL)\n  {\n  \tstd::wstring path;\n  \tToWidePath(fname, path);\n      _Init( path.c_str() );\n  }\n}"
  },
  {
    "function_name": "_CleanUp",
    "container": "Win32SequentialFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "383-389",
    "snippet": "void Win32SequentialFile::_CleanUp()\n{\n    if(_hFile){\n        CloseHandle(_hFile);\n        _hFile = NULL;\n    }\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CloseHandle",
          "args": [
            "_hFile"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32SequentialFile {\n  void Win32SequentialFile::_CleanUp()\n  {\n      if(_hFile){\n          CloseHandle(_hFile);\n          _hFile = NULL;\n      }\n  }\n}"
  },
  {
    "function_name": "_Init",
    "container": "Win32SequentialFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "369-381",
    "snippet": "BOOL Win32SequentialFile::_Init()\n{\n\tstd::wstring path;\n\tToWidePath(_filename, path);\n\t_hFile = CreateFileW(path.c_str(),\n                         GENERIC_READ,\n                         FILE_SHARE_READ,\n                         NULL,\n                         OPEN_EXISTING,\n                         FILE_ATTRIBUTE_NORMAL,\n                         NULL);\n    return _hFile ? TRUE : FALSE;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CreateFileW",
          "args": [
            "path.c_str()",
            "GENERIC_READ",
            "FILE_SHARE_READ",
            "NULL",
            "OPEN_EXISTING",
            "FILE_ATTRIBUTE_NORMAL",
            "NULL"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.c_str",
          "args": [],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToWidePath",
          "args": [
            "_filename",
            "path"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "ToWidePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "218-222",
          "snippet": "void ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32SequentialFile {\n  BOOL Win32SequentialFile::_Init()\n  {\n  \tstd::wstring path;\n  \tToWidePath(_filename, path);\n  \t_hFile = CreateFileW(path.c_str(),\n                           GENERIC_READ,\n                           FILE_SHARE_READ,\n                           NULL,\n                           OPEN_EXISTING,\n                           FILE_ATTRIBUTE_NORMAL,\n                           NULL);\n      return _hFile ? TRUE : FALSE;\n  }\n}"
  },
  {
    "function_name": "isEnable",
    "container": "Win32SequentialFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "364-367",
    "snippet": "BOOL Win32SequentialFile::isEnable()\n{\n    return _hFile ? TRUE : FALSE;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32SequentialFile {\n  BOOL Win32SequentialFile::isEnable()\n  {\n      return _hFile ? TRUE : FALSE;\n  }\n}"
  },
  {
    "function_name": "Skip",
    "container": "Win32SequentialFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "353-362",
    "snippet": "Status Win32SequentialFile::Skip( uint64_t n )\n{\n    Status sRet;\n    LARGE_INTEGER Move,NowPointer;\n    Move.QuadPart = n;\n    if(!SetFilePointerEx(_hFile,Move,&NowPointer,FILE_CURRENT)){\n        sRet = Status::IOError(_filename,Win32::GetLastErrSz());\n    }\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "_filename",
            "Win32::GetLastErrSz()"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Win32::GetLastErrSz",
          "args": [],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastErrSz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "265-283",
          "snippet": "std::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstd::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetFilePointerEx",
          "args": [
            "_hFile",
            "Move",
            "&NowPointer",
            "FILE_CURRENT"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32SequentialFile {\n  Status Win32SequentialFile::Skip( uint64_t n )\n  {\n      Status sRet;\n      LARGE_INTEGER Move,NowPointer;\n      Move.QuadPart = n;\n      if(!SetFilePointerEx(_hFile,Move,&NowPointer,FILE_CURRENT)){\n          sRet = Status::IOError(_filename,Win32::GetLastErrSz());\n      }\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "Read",
    "container": "Win32SequentialFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "341-351",
    "snippet": "Status Win32SequentialFile::Read( size_t n, Slice* result, char* scratch )\n{\n    Status sRet;\n    DWORD hasRead = 0;\n    if(_hFile && ReadFile(_hFile,scratch,n,&hasRead,NULL) ){\n        *result = Slice(scratch,hasRead);\n    } else {\n        sRet = Status::IOError(_filename, Win32::GetLastErrSz() );\n    }\n    return sRet;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "_filename",
            "Win32::GetLastErrSz()"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Win32::GetLastErrSz",
          "args": [],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastErrSz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "265-283",
          "snippet": "std::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstd::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "scratch",
            "hasRead"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ReadFile",
          "args": [
            "_hFile",
            "scratch",
            "n",
            "&hasRead",
            "NULL"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32SequentialFile {\n  Status Win32SequentialFile::Read( size_t n, Slice* result, char* scratch )\n  {\n      Status sRet;\n      DWORD hasRead = 0;\n      if(_hFile && ReadFile(_hFile,scratch,n,&hasRead,NULL) ){\n          *result = Slice(scratch,hasRead);\n      } else {\n          sRet = Status::IOError(_filename, Win32::GetLastErrSz() );\n      }\n      return sRet;\n  }\n}"
  },
  {
    "function_name": "~Win32SequentialFile",
    "container": "Win32SequentialFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "336-339",
    "snippet": "Win32SequentialFile::~Win32SequentialFile()\n{\n    _CleanUp();\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_CleanUp",
          "args": [],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "_CleanUp",
          "container": "Win32FileLock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "669-673",
          "snippet": "void Win32FileLock::_CleanUp()\n{\n    ::CloseHandle(_hFile);\n    _hFile = NULL;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32FileLock {\n  void Win32FileLock::_CleanUp()\n  {\n      ::CloseHandle(_hFile);\n      _hFile = NULL;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32SequentialFile {\n  Win32SequentialFile::~Win32SequentialFile()\n  {\n      _CleanUp();\n  }\n}"
  },
  {
    "function_name": "Win32SequentialFile",
    "container": "Win32SequentialFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "330-334",
    "snippet": "Win32SequentialFile::Win32SequentialFile( const std::string& fname ) :\n    _filename(fname),_hFile(NULL)\n{\n    _Init();\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Init",
          "args": [],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "_Init",
          "container": "Win32SequentialFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "369-381",
          "snippet": "BOOL Win32SequentialFile::_Init()\n{\n\tstd::wstring path;\n\tToWidePath(_filename, path);\n\t_hFile = CreateFileW(path.c_str(),\n                         GENERIC_READ,\n                         FILE_SHARE_READ,\n                         NULL,\n                         OPEN_EXISTING,\n                         FILE_ATTRIBUTE_NORMAL,\n                         NULL);\n    return _hFile ? TRUE : FALSE;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32SequentialFile {\n  BOOL Win32SequentialFile::_Init()\n  {\n  \tstd::wstring path;\n  \tToWidePath(_filename, path);\n  \t_hFile = CreateFileW(path.c_str(),\n                           GENERIC_READ,\n                           FILE_SHARE_READ,\n                           NULL,\n                           OPEN_EXISTING,\n                           FILE_ATTRIBUTE_NORMAL,\n                           NULL);\n      return _hFile ? TRUE : FALSE;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32SequentialFile {\n  Win32SequentialFile::Win32SequentialFile( const std::string& fname ) :\n      _filename(fname),_hFile(NULL)\n  {\n      _Init();\n  }\n}"
  },
  {
    "function_name": "GetPageSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "320-325",
    "snippet": "size_t GetPageSize()\n{\n    SYSTEM_INFO si;\n    GetSystemInfo(&si);\n    return std::max(si.dwPageSize,si.dwAllocationGranularity);\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::max",
          "args": [
            "si.dwPageSize",
            "si.dwAllocationGranularity"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSystemInfo",
          "args": [
            "&si"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nsize_t GetPageSize()\n{\n    SYSTEM_INFO si;\n    GetSystemInfo(&si);\n    return std::max(si.dwPageSize,si.dwAllocationGranularity);\n}"
  },
  {
    "function_name": "WorkItemWrapperProc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "310-318",
    "snippet": "DWORD WINAPI WorkItemWrapperProc(LPVOID pContent)\n{\n    WorkItemWrapper* item = static_cast<WorkItemWrapper*>(pContent);\n    ScheduleProc TempProc = item->proc;\n    void* arg = item->pContent;\n    delete item;\n    TempProc(arg);\n    return 0;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TempProc",
          "args": [
            "arg"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<WorkItemWrapper*>",
          "args": [
            "pContent"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nDWORD WINAPI WorkItemWrapperProc(LPVOID pContent)\n{\n    WorkItemWrapper* item = static_cast<WorkItemWrapper*>(pContent);\n    ScheduleProc TempProc = item->proc;\n    void* arg = item->pContent;\n    delete item;\n    TempProc(arg);\n    return 0;\n}"
  },
  {
    "function_name": "WorkItemWrapper",
    "container": "WorkItemWrapper",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "304-308",
    "snippet": "WorkItemWrapper::WorkItemWrapper( ScheduleProc proc_,void* content_ ) :\n    proc(proc_),pContent(content_)\n{\n\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWorkItemWrapper {\n  WorkItemWrapper::WorkItemWrapper( ScheduleProc proc_,void* content_ ) :\n      proc(proc_),pContent(content_)\n  {\n  \n  }\n}"
  },
  {
    "function_name": "GetLastErrSzW",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "285-302",
    "snippet": "std::wstring GetLastErrSzW()\n{\n    LPVOID lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::wstring Err = (LPCWSTR)lpMsgBuf;\n    LocalFree(lpMsgBuf);\n    return Err;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "LocalFree",
          "args": [
            "lpMsgBuf"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatMessageW",
          "args": [
            "FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS",
            "NULL",
            "GetLastError()",
            "0",
            "// Default language(LPWSTR) &lpMsgBuf",
            "0",
            "NULL"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetLastError",
          "args": [],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstd::wstring GetLastErrSzW()\n{\n    LPVOID lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::wstring Err = (LPCWSTR)lpMsgBuf;\n    LocalFree(lpMsgBuf);\n    return Err;\n}"
  },
  {
    "function_name": "GetLastErrSz",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "265-283",
    "snippet": "std::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "LocalFree",
          "args": [
            "lpMsgBuf"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToNarrowPath",
          "args": [
            "lpMsgBuf",
            "Err"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "ToNarrowPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "224-228",
          "snippet": "void ToNarrowPath(const std::wstring& value, std::string& target) {\n\tchar buffer[MAX_PATH];\n\tWideCharToMultiByte(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH, NULL, NULL);\n\ttarget = buffer;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToNarrowPath(const std::wstring& value, std::string& target) {\n\tchar buffer[MAX_PATH];\n\tWideCharToMultiByte(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH, NULL, NULL);\n\ttarget = buffer;\n}"
        }
      },
      {
        "call_info": {
          "callee": "FormatMessageW",
          "args": [
            "FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS",
            "NULL",
            "GetLastError()",
            "0",
            "// Default language(LPWSTR) &lpMsgBuf",
            "0",
            "NULL"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetLastError",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstd::string GetLastErrSz()\n{\n    LPWSTR lpMsgBuf;\n    FormatMessageW( \n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM | \n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        GetLastError(),\n        0, // Default language\n        (LPWSTR) &lpMsgBuf,\n        0,\n        NULL \n        );\n    std::string Err;\n\tToNarrowPath(lpMsgBuf, Err); \n    LocalFree( lpMsgBuf );\n    return Err;\n}"
  },
  {
    "function_name": "GetCurrentDirW",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "238-244",
    "snippet": "std::wstring GetCurrentDirW()\n{\n    WCHAR path[MAX_PATH];\n    ::GetModuleFileNameW(::GetModuleHandleW(NULL),path,MAX_PATH);\n    *wcsrchr(path,L'\\\\') = 0;\n    return std::wstring(path);\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::wstring",
          "args": [
            "path"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wcsrchr",
          "args": [
            "path",
            "L'\\\\'"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::GetModuleFileNameW",
          "args": [
            "::GetModuleHandleW(NULL)",
            "path",
            "MAX_PATH"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::GetModuleHandleW",
          "args": [
            "NULL"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstd::wstring GetCurrentDirW()\n{\n    WCHAR path[MAX_PATH];\n    ::GetModuleFileNameW(::GetModuleHandleW(NULL),path,MAX_PATH);\n    *wcsrchr(path,L'\\\\') = 0;\n    return std::wstring(path);\n}"
  },
  {
    "function_name": "GetCurrentDir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "230-236",
    "snippet": "std::string GetCurrentDir()\n{\n    CHAR path[MAX_PATH];\n    ::GetModuleFileNameA(::GetModuleHandleA(NULL),path,MAX_PATH);\n    *strrchr(path,'\\\\') = 0;\n    return std::string(path);\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "path"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "path",
            "'\\\\'"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::GetModuleFileNameA",
          "args": [
            "::GetModuleHandleA(NULL)",
            "path",
            "MAX_PATH"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::GetModuleHandleA",
          "args": [
            "NULL"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nstd::string GetCurrentDir()\n{\n    CHAR path[MAX_PATH];\n    ::GetModuleFileNameA(::GetModuleHandleA(NULL),path,MAX_PATH);\n    *strrchr(path,'\\\\') = 0;\n    return std::string(path);\n}"
  },
  {
    "function_name": "ToNarrowPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "224-228",
    "snippet": "void ToNarrowPath(const std::wstring& value, std::string& target) {\n\tchar buffer[MAX_PATH];\n\tWideCharToMultiByte(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH, NULL, NULL);\n\ttarget = buffer;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WideCharToMultiByte",
          "args": [
            "CP_ACP",
            "0",
            "value.c_str()",
            "-1",
            "buffer",
            "MAX_PATH",
            "NULL",
            "NULL"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.c_str",
          "args": [],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToNarrowPath(const std::wstring& value, std::string& target) {\n\tchar buffer[MAX_PATH];\n\tWideCharToMultiByte(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH, NULL, NULL);\n\ttarget = buffer;\n}"
  },
  {
    "function_name": "ToWidePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
    "lines": "218-222",
    "snippet": "void ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}",
    "includes": [
      "#include <algorithm>",
      "#include <io.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <cstring>",
      "#include <process.h>",
      "#include <shlwapi.h>",
      "#include \"util/logging.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\"",
      "#include <map>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MultiByteToWideChar",
          "args": [
            "CP_ACP",
            "0",
            "value.c_str()",
            "-1",
            "buffer",
            "MAX_PATH"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.c_str",
          "args": [],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nvoid ToWidePath(const std::string& value, std::wstring& target) {\n\twchar_t buffer[MAX_PATH];\n\tMultiByteToWideChar(CP_ACP, 0, value.c_str(), -1, buffer, MAX_PATH);\n\ttarget = buffer;\n}"
  }
]