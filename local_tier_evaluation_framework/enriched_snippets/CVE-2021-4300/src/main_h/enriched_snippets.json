[
  {
    "function_name": "exists",
    "container": "CTxMemPool",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1697-1700",
    "snippet": "bool exists(uint256 hash)\n    {\n        return (mapTx.count(hash) != 0);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mapTx.count",
          "args": [
            "hash"
          ],
          "line": 1699
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  bool exists(uint256 hash)\n      {\n          return (mapTx.count(hash) != 0);\n      }\n}"
  },
  {
    "function_name": "size",
    "container": "CTxMemPool",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1691-1695",
    "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mapTx.size",
          "args": [],
          "line": 1694
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1691-1695",
          "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs"
          ],
          "line": 1693
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  unsigned long size()\n      {\n          LOCK(cs);\n          return mapTx.size();\n      }\n}"
  },
  {
    "function_name": "GetHeight",
    "container": "CBlockLocator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1660-1666",
    "snippet": "int GetHeight()\n    {\n        CBlockIndex* pindex = GetBlockIndex();\n        if (!pindex)\n            return 0;\n        return pindex->nHeight;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetBlockIndex",
          "args": [],
          "line": 1662
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  int GetHeight()\n      {\n          CBlockIndex* pindex = GetBlockIndex();\n          if (!pindex)\n              return 0;\n          return pindex->nHeight;\n      }\n}"
  },
  {
    "function_name": "GetBlockHash",
    "container": "CBlockLocator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1644-1658",
    "snippet": "uint256 GetBlockHash()\n    {\n        // Find the first block the caller has in the main chain\n        BOOST_FOREACH(const uint256& hash, vHave)\n        {\n            std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n            if (mi != mapBlockIndex.end())\n            {\n                CBlockIndex* pindex = (*mi).second;\n                if (pindex->IsInMainChain())\n                    return hash;\n            }\n        }\n        return (!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pindex->IsInMainChain",
          "args": [],
          "line": 1653
        },
        "resolved": true,
        "details": {
          "function_name": "IsInMainChain",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1291-1294",
          "snippet": "bool IsInMainChain() const\n    {\n        return (pnext || this == pindexBest);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool IsInMainChain() const\n      {\n          return (pnext || this == pindexBest);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapBlockIndex.end",
          "args": [],
          "line": 1650
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapBlockIndex.find",
          "args": [
            "hash"
          ],
          "line": 1649
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  uint256 GetBlockHash()\n      {\n          // Find the first block the caller has in the main chain\n          BOOST_FOREACH(const uint256& hash, vHave)\n          {\n              std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n              if (mi != mapBlockIndex.end())\n              {\n                  CBlockIndex* pindex = (*mi).second;\n                  if (pindex->IsInMainChain())\n                      return hash;\n              }\n          }\n          return (!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet);\n      }\n}"
  },
  {
    "function_name": "GetDistanceBack",
    "container": "CBlockLocator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1607-1626",
    "snippet": "int GetDistanceBack()\n    {\n        // Retrace how far back it was in the sender's branch\n        int nDistance = 0;\n        int nStep = 1;\n        BOOST_FOREACH(const uint256& hash, vHave)\n        {\n            std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n            if (mi != mapBlockIndex.end())\n            {\n                CBlockIndex* pindex = (*mi).second;\n                if (pindex->IsInMainChain())\n                    return nDistance;\n            }\n            nDistance += nStep;\n            if (nDistance > 10)\n                nStep *= 2;\n        }\n        return nDistance;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pindex->IsInMainChain",
          "args": [],
          "line": 1618
        },
        "resolved": true,
        "details": {
          "function_name": "IsInMainChain",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1291-1294",
          "snippet": "bool IsInMainChain() const\n    {\n        return (pnext || this == pindexBest);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool IsInMainChain() const\n      {\n          return (pnext || this == pindexBest);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapBlockIndex.end",
          "args": [],
          "line": 1615
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapBlockIndex.find",
          "args": [
            "hash"
          ],
          "line": 1614
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  int GetDistanceBack()\n      {\n          // Retrace how far back it was in the sender's branch\n          int nDistance = 0;\n          int nStep = 1;\n          BOOST_FOREACH(const uint256& hash, vHave)\n          {\n              std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n              if (mi != mapBlockIndex.end())\n              {\n                  CBlockIndex* pindex = (*mi).second;\n                  if (pindex->IsInMainChain())\n                      return nDistance;\n              }\n              nDistance += nStep;\n              if (nDistance > 10)\n                  nStep *= 2;\n          }\n          return nDistance;\n      }\n}"
  },
  {
    "function_name": "Set",
    "container": "CBlockLocator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1590-1605",
    "snippet": "void Set(const CBlockIndex* pindex)\n    {\n        vHave.clear();\n        int nStep = 1;\n        while (pindex)\n        {\n            vHave.push_back(pindex->GetBlockHash());\n\n            // Exponentially larger steps back\n            for (int i = 0; pindex && i < nStep; i++)\n                pindex = pindex->pprev;\n            if (vHave.size() > 10)\n                nStep *= 2;\n        }\n        vHave.push_back((!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet));\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vHave.push_back",
          "args": [
            "(!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet)"
          ],
          "line": 1604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vHave.size",
          "args": [],
          "line": 1601
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1691-1695",
          "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  unsigned long size()\n      {\n          LOCK(cs);\n          return mapTx.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vHave.push_back",
          "args": [
            "pindex->GetBlockHash()"
          ],
          "line": 1596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pindex->GetBlockHash",
          "args": [],
          "line": 1596
        },
        "resolved": true,
        "details": {
          "function_name": "GetBlockHash",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1644-1658",
          "snippet": "uint256 GetBlockHash()\n    {\n        // Find the first block the caller has in the main chain\n        BOOST_FOREACH(const uint256& hash, vHave)\n        {\n            std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n            if (mi != mapBlockIndex.end())\n            {\n                CBlockIndex* pindex = (*mi).second;\n                if (pindex->IsInMainChain())\n                    return hash;\n            }\n        }\n        return (!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  uint256 GetBlockHash()\n      {\n          // Find the first block the caller has in the main chain\n          BOOST_FOREACH(const uint256& hash, vHave)\n          {\n              std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n              if (mi != mapBlockIndex.end())\n              {\n                  CBlockIndex* pindex = (*mi).second;\n                  if (pindex->IsInMainChain())\n                      return hash;\n              }\n          }\n          return (!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vHave.clear",
          "args": [],
          "line": 1592
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void Set(const CBlockIndex* pindex)\n      {\n          vHave.clear();\n          int nStep = 1;\n          while (pindex)\n          {\n              vHave.push_back(pindex->GetBlockHash());\n  \n              // Exponentially larger steps back\n              for (int i = 0; pindex && i < nStep; i++)\n                  pindex = pindex->pprev;\n              if (vHave.size() > 10)\n                  nStep *= 2;\n          }\n          vHave.push_back((!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet));\n      }\n}"
  },
  {
    "function_name": "IsNull",
    "container": "CBlockLocator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1585-1588",
    "snippet": "bool IsNull()\n    {\n        return vHave.empty();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vHave.empty",
          "args": [],
          "line": 1587
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  bool IsNull()\n      {\n          return vHave.empty();\n      }\n}"
  },
  {
    "function_name": "SetNull",
    "container": "CBlockLocator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1580-1583",
    "snippet": "void SetNull()\n    {\n        vHave.clear();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vHave.clear",
          "args": [],
          "line": 1582
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void SetNull()\n      {\n          vHave.clear();\n      }\n}"
  },
  {
    "function_name": "CBlockLocator",
    "container": "CBlockLocator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1568-1571",
    "snippet": "CBlockLocator(const std::vector<uint256>& vHaveIn)\n    {\n        vHave = vHaveIn;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  CBlockLocator(const std::vector<uint256>& vHaveIn)\n      {\n          vHave = vHaveIn;\n      }\n}"
  },
  {
    "function_name": "CBlockLocator",
    "container": "CBlockLocator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1561-1566",
    "snippet": "explicit CBlockLocator(uint256 hashBlock)\n    {\n        std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hashBlock);\n        if (mi != mapBlockIndex.end())\n            Set((*mi).second);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Set",
          "args": [
            "(*mi).second"
          ],
          "line": 1565
        },
        "resolved": true,
        "details": {
          "function_name": "Set",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1590-1605",
          "snippet": "void Set(const CBlockIndex* pindex)\n    {\n        vHave.clear();\n        int nStep = 1;\n        while (pindex)\n        {\n            vHave.push_back(pindex->GetBlockHash());\n\n            // Exponentially larger steps back\n            for (int i = 0; pindex && i < nStep; i++)\n                pindex = pindex->pprev;\n            if (vHave.size() > 10)\n                nStep *= 2;\n        }\n        vHave.push_back((!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet));\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void Set(const CBlockIndex* pindex)\n      {\n          vHave.clear();\n          int nStep = 1;\n          while (pindex)\n          {\n              vHave.push_back(pindex->GetBlockHash());\n  \n              // Exponentially larger steps back\n              for (int i = 0; pindex && i < nStep; i++)\n                  pindex = pindex->pprev;\n              if (vHave.size() > 10)\n                  nStep *= 2;\n          }\n          vHave.push_back((!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet));\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapBlockIndex.end",
          "args": [],
          "line": 1564
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapBlockIndex.find",
          "args": [
            "hashBlock"
          ],
          "line": 1563
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  explicit CBlockLocator(uint256 hashBlock)\n      {\n          std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hashBlock);\n          if (mi != mapBlockIndex.end())\n              Set((*mi).second);\n      }\n}"
  },
  {
    "function_name": "CBlockLocator",
    "container": "CBlockLocator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1556-1559",
    "snippet": "explicit CBlockLocator(const CBlockIndex* pindex)\n    {\n        Set(pindex);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Set",
          "args": [
            "pindex"
          ],
          "line": 1558
        },
        "resolved": true,
        "details": {
          "function_name": "Set",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1590-1605",
          "snippet": "void Set(const CBlockIndex* pindex)\n    {\n        vHave.clear();\n        int nStep = 1;\n        while (pindex)\n        {\n            vHave.push_back(pindex->GetBlockHash());\n\n            // Exponentially larger steps back\n            for (int i = 0; pindex && i < nStep; i++)\n                pindex = pindex->pprev;\n            if (vHave.size() > 10)\n                nStep *= 2;\n        }\n        vHave.push_back((!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet));\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void Set(const CBlockIndex* pindex)\n      {\n          vHave.clear();\n          int nStep = 1;\n          while (pindex)\n          {\n              vHave.push_back(pindex->GetBlockHash());\n  \n              // Exponentially larger steps back\n              for (int i = 0; pindex && i < nStep; i++)\n                  pindex = pindex->pprev;\n              if (vHave.size() > 10)\n                  nStep *= 2;\n          }\n          vHave.push_back((!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet));\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  explicit CBlockLocator(const CBlockIndex* pindex)\n      {\n          Set(pindex);\n      }\n}"
  },
  {
    "function_name": "CBlockLocator",
    "container": "CBlockLocator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1552-1554",
    "snippet": "CBlockLocator()\n    {\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  CBlockLocator()\n      {\n      }\n}"
  },
  {
    "function_name": "print",
    "container": "CDiskBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1529-1532",
    "snippet": "void print() const\n    {\n        printf(\"%s\\n\", ToString().c_str());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "ToString().c_str()"
          ],
          "line": 1531
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [],
          "line": 1531
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  void print() const\n      {\n          printf(\"%s\\n\", ToString().c_str());\n      }\n}"
  },
  {
    "function_name": "ToString",
    "container": "CDiskBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1518-1527",
    "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\"",
            "GetBlockHash().ToString().c_str()",
            "hashPrev.ToString().c_str()",
            "hashNext.ToString().c_str()"
          ],
          "line": 1522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hashNext.ToString",
          "args": [],
          "line": 1525
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "GetBlockHash",
          "args": [],
          "line": 1523
        },
        "resolved": true,
        "details": {
          "function_name": "GetBlockHash",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1644-1658",
          "snippet": "uint256 GetBlockHash()\n    {\n        // Find the first block the caller has in the main chain\n        BOOST_FOREACH(const uint256& hash, vHave)\n        {\n            std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n            if (mi != mapBlockIndex.end())\n            {\n                CBlockIndex* pindex = (*mi).second;\n                if (pindex->IsInMainChain())\n                    return hash;\n            }\n        }\n        return (!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  uint256 GetBlockHash()\n      {\n          // Find the first block the caller has in the main chain\n          BOOST_FOREACH(const uint256& hash, vHave)\n          {\n              std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n              if (mi != mapBlockIndex.end())\n              {\n                  CBlockIndex* pindex = (*mi).second;\n                  if (pindex->IsInMainChain())\n                      return hash;\n              }\n          }\n          return (!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CBlockIndex::ToString",
          "args": [],
          "line": 1521
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1419-1430",
          "snippet": "std::string ToString() const\n    {\n        return strprintf(\"CBlockIndex(nprev=%p, pnext=%p, nFile=%u, nBlockPos=%-6d nHeight=%d, nMint=%s, nMoneySupply=%s, nFlags=(%s)(%d)(%s), nStakeModifier=%016\"PRIx64\", nStakeModifierChecksum=%08x, hashProofOfStake=%s, prevoutStake=(%s), nStakeTime=%d merkle=%s, hashBlock=%s)\",\n            pprev, pnext, nFile, nBlockPos, nHeight,\n            FormatMoney(nMint).c_str(), FormatMoney(nMoneySupply).c_str(),\n            GeneratedStakeModifier() ? \"MOD\" : \"-\", GetStakeEntropyBit(), IsProofOfStake()? \"PoS\" : \"PoW\",\n            nStakeModifier, nStakeModifierChecksum, \n            hashProofOfStake.ToString().c_str(),\n            prevoutStake.ToString().c_str(), nStakeTime,\n            hashMerkleRoot.ToString().c_str(),\n            GetBlockHash().ToString().c_str());\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  std::string ToString() const\n      {\n          return strprintf(\"CBlockIndex(nprev=%p, pnext=%p, nFile=%u, nBlockPos=%-6d nHeight=%d, nMint=%s, nMoneySupply=%s, nFlags=(%s)(%d)(%s), nStakeModifier=%016\"PRIx64\", nStakeModifierChecksum=%08x, hashProofOfStake=%s, prevoutStake=(%s), nStakeTime=%d merkle=%s, hashBlock=%s)\",\n              pprev, pnext, nFile, nBlockPos, nHeight,\n              FormatMoney(nMint).c_str(), FormatMoney(nMoneySupply).c_str(),\n              GeneratedStakeModifier() ? \"MOD\" : \"-\", GetStakeEntropyBit(), IsProofOfStake()? \"PoS\" : \"PoW\",\n              nStakeModifier, nStakeModifierChecksum, \n              hashProofOfStake.ToString().c_str(),\n              prevoutStake.ToString().c_str(), nStakeTime,\n              hashMerkleRoot.ToString().c_str(),\n              GetBlockHash().ToString().c_str());\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
  },
  {
    "function_name": "GetBlockHash",
    "container": "CDiskBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1499-1516",
    "snippet": "uint256 GetBlockHash() const {\n        /* Fast index: use stored hashes for blocks older than 1 hour */\n        if((blockHash != 0) && (nTime < (GetAdjustedTime() - 1 * 60 * 60)))\n          return(blockHash);\n\n        CBlock block;\n        block.nVersion        = nVersion;\n        block.hashPrevBlock   = hashPrev;\n        block.hashMerkleRoot  = hashMerkleRoot;\n        block.nTime           = nTime;\n        block.nBits           = nBits;\n        block.nNonce          = nNonce;\n\n        /* nTime is used to choose between old and new block hashing */\n        const_cast<CDiskBlockIndex*>(this)->blockHash = block.GetHash();\n\n        return(blockHash);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "block.GetHash",
          "args": [],
          "line": 1513
        },
        "resolved": true,
        "details": {
          "function_name": "GetHash",
          "container": "CBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "915-933",
          "snippet": "uint256 GetHash() const {\n        uint256 hashBlock;\n\n        if(!fTestNet && (nTime < 1419062077)) {\n            x15hash((uchar *) &nVersion, (uchar *) &hashBlock);\n        } else {\n            /* 80 + 32 bytes, no padding */\n            uchar input[112];\n            /* Copy the block header */\n            neoscrypt_copy(&input[0], &nVersion, 80);\n            /* Copy the merkle root once again */\n            neoscrypt_copy(&input[80], &hashMerkleRoot, 32);\n            /* Hash the data;\n             * key is higher and lower 10 bytes of merkle root\n             * with nTime, nBits, nNonce in between */\n            neoscrypt_blake2s(&input[0], 112, &input[58], 32, &hashBlock, 32);\n        }\n        return(hashBlock);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  uint256 GetHash() const {\n          uint256 hashBlock;\n  \n          if(!fTestNet && (nTime < 1419062077)) {\n              x15hash((uchar *) &nVersion, (uchar *) &hashBlock);\n          } else {\n              /* 80 + 32 bytes, no padding */\n              uchar input[112];\n              /* Copy the block header */\n              neoscrypt_copy(&input[0], &nVersion, 80);\n              /* Copy the merkle root once again */\n              neoscrypt_copy(&input[80], &hashMerkleRoot, 32);\n              /* Hash the data;\n               * key is higher and lower 10 bytes of merkle root\n               * with nTime, nBits, nNonce in between */\n              neoscrypt_blake2s(&input[0], 112, &input[58], 32, &hashBlock, 32);\n          }\n          return(hashBlock);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "const_cast<CDiskBlockIndex*>",
          "args": [
            "this"
          ],
          "line": 1513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetAdjustedTime",
          "args": [],
          "line": 1501
        },
        "resolved": true,
        "details": {
          "function_name": "GetAdjustedTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1201-1214",
          "snippet": "int64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern int64 nNtpOffset;",
            "int64 nPeersOffset = INT64_MAX;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nextern int64 nNtpOffset;\nint64 nPeersOffset = INT64_MAX;\n\nint64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  uint256 GetBlockHash() const {\n          /* Fast index: use stored hashes for blocks older than 1 hour */\n          if((blockHash != 0) && (nTime < (GetAdjustedTime() - 1 * 60 * 60)))\n            return(blockHash);\n  \n          CBlock block;\n          block.nVersion        = nVersion;\n          block.hashPrevBlock   = hashPrev;\n          block.hashMerkleRoot  = hashMerkleRoot;\n          block.nTime           = nTime;\n          block.nBits           = nBits;\n          block.nNonce          = nNonce;\n  \n          /* nTime is used to choose between old and new block hashing */\n          const_cast<CDiskBlockIndex*>(this)->blockHash = block.GetHash();\n  \n          return(blockHash);\n      }\n}"
  },
  {
    "function_name": "if",
    "container": "CDiskBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1482-1487",
    "snippet": "else if (fRead)\n        {\n            const_cast<CDiskBlockIndex*>(this)->prevoutStake.SetNull();\n            const_cast<CDiskBlockIndex*>(this)->nStakeTime = 0;\n            const_cast<CDiskBlockIndex*>(this)->hashProofOfStake = 0;\n        }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "const_cast<CDiskBlockIndex*>",
          "args": [
            "this"
          ],
          "line": 1486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<CDiskBlockIndex*>",
          "args": [
            "this"
          ],
          "line": 1485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<CDiskBlockIndex*>",
          "args": [],
          "line": 1484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<CDiskBlockIndex*>",
          "args": [
            "this"
          ],
          "line": 1484
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  else if (fRead)\n          {\n              const_cast<CDiskBlockIndex*>(this)->prevoutStake.SetNull();\n              const_cast<CDiskBlockIndex*>(this)->nStakeTime = 0;\n              const_cast<CDiskBlockIndex*>(this)->hashProofOfStake = 0;\n          }\n}"
  },
  {
    "function_name": "if",
    "container": "CDiskBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1476-1481",
    "snippet": "if (IsProofOfStake())\n        {\n            READWRITE(prevoutStake);\n            READWRITE(nStakeTime);\n            READWRITE(hashProofOfStake);\n        }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "READWRITE",
          "args": [
            "hashProofOfStake"
          ],
          "line": 1480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READWRITE",
          "args": [
            "nStakeTime"
          ],
          "line": 1479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READWRITE",
          "args": [
            "prevoutStake"
          ],
          "line": 1478
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  if (IsProofOfStake())\n          {\n              READWRITE(prevoutStake);\n              READWRITE(nStakeTime);\n              READWRITE(hashProofOfStake);\n          }\n}"
  },
  {
    "function_name": "CDiskBlockIndex",
    "container": "CDiskBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1457-1461",
    "snippet": "explicit CDiskBlockIndex(CBlockIndex* pindex) : CBlockIndex(*pindex)\n    {\n        hashPrev = (pprev ? pprev->GetBlockHash() : 0);\n        hashNext = (pnext ? pnext->GetBlockHash() : 0);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pnext->GetBlockHash",
          "args": [],
          "line": 1460
        },
        "resolved": true,
        "details": {
          "function_name": "GetBlockHash",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1644-1658",
          "snippet": "uint256 GetBlockHash()\n    {\n        // Find the first block the caller has in the main chain\n        BOOST_FOREACH(const uint256& hash, vHave)\n        {\n            std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n            if (mi != mapBlockIndex.end())\n            {\n                CBlockIndex* pindex = (*mi).second;\n                if (pindex->IsInMainChain())\n                    return hash;\n            }\n        }\n        return (!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  uint256 GetBlockHash()\n      {\n          // Find the first block the caller has in the main chain\n          BOOST_FOREACH(const uint256& hash, vHave)\n          {\n              std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n              if (mi != mapBlockIndex.end())\n              {\n                  CBlockIndex* pindex = (*mi).second;\n                  if (pindex->IsInMainChain())\n                      return hash;\n              }\n          }\n          return (!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  explicit CDiskBlockIndex(CBlockIndex* pindex) : CBlockIndex(*pindex)\n      {\n          hashPrev = (pprev ? pprev->GetBlockHash() : 0);\n          hashNext = (pnext ? pnext->GetBlockHash() : 0);\n      }\n}"
  },
  {
    "function_name": "CDiskBlockIndex",
    "container": "CDiskBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1450-1455",
    "snippet": "CDiskBlockIndex()\n    {\n        hashPrev = 0;\n        hashNext = 0;\n        blockHash = 0;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  CDiskBlockIndex()\n      {\n          hashPrev = 0;\n          hashNext = 0;\n          blockHash = 0;\n      }\n}"
  },
  {
    "function_name": "print",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1432-1435",
    "snippet": "void print() const\n    {\n        printf(\"%s\\n\", ToString().c_str());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "ToString().c_str()"
          ],
          "line": 1434
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [],
          "line": 1434
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  void print() const\n      {\n          printf(\"%s\\n\", ToString().c_str());\n      }\n}"
  },
  {
    "function_name": "ToString",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1419-1430",
    "snippet": "std::string ToString() const\n    {\n        return strprintf(\"CBlockIndex(nprev=%p, pnext=%p, nFile=%u, nBlockPos=%-6d nHeight=%d, nMint=%s, nMoneySupply=%s, nFlags=(%s)(%d)(%s), nStakeModifier=%016\"PRIx64\", nStakeModifierChecksum=%08x, hashProofOfStake=%s, prevoutStake=(%s), nStakeTime=%d merkle=%s, hashBlock=%s)\",\n            pprev, pnext, nFile, nBlockPos, nHeight,\n            FormatMoney(nMint).c_str(), FormatMoney(nMoneySupply).c_str(),\n            GeneratedStakeModifier() ? \"MOD\" : \"-\", GetStakeEntropyBit(), IsProofOfStake()? \"PoS\" : \"PoW\",\n            nStakeModifier, nStakeModifierChecksum, \n            hashProofOfStake.ToString().c_str(),\n            prevoutStake.ToString().c_str(), nStakeTime,\n            hashMerkleRoot.ToString().c_str(),\n            GetBlockHash().ToString().c_str());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"CBlockIndex(nprev=%p, pnext=%p, nFile=%u, nBlockPos=%-6d nHeight=%d, nMint=%s, nMoneySupply=%s, nFlags=(%s)(%d)(%s), nStakeModifier=%016\"PRIx64\", nStakeModifierChecksum=%08x, hashProofOfStake=%s, prevoutStake=(%s), nStakeTime=%d merkle=%s, hashBlock=%s)\"",
            "pprev",
            "pnext",
            "nFile",
            "nBlockPos",
            "nHeight",
            "FormatMoney(nMint).c_str()",
            "FormatMoney(nMoneySupply).c_str()",
            "GeneratedStakeModifier() ? \"MOD\" : \"-\"",
            "GetStakeEntropyBit()",
            "IsProofOfStake()? \"PoS\" : \"PoW\"",
            "nStakeModifier",
            "nStakeModifierChecksum",
            "hashProofOfStake.ToString().c_str()",
            "prevoutStake.ToString().c_str()",
            "nStakeTime",
            "hashMerkleRoot.ToString().c_str()",
            "GetBlockHash().ToString().c_str()"
          ],
          "line": 1421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetBlockHash",
          "args": [],
          "line": 1429
        },
        "resolved": true,
        "details": {
          "function_name": "GetBlockHash",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1644-1658",
          "snippet": "uint256 GetBlockHash()\n    {\n        // Find the first block the caller has in the main chain\n        BOOST_FOREACH(const uint256& hash, vHave)\n        {\n            std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n            if (mi != mapBlockIndex.end())\n            {\n                CBlockIndex* pindex = (*mi).second;\n                if (pindex->IsInMainChain())\n                    return hash;\n            }\n        }\n        return (!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  uint256 GetBlockHash()\n      {\n          // Find the first block the caller has in the main chain\n          BOOST_FOREACH(const uint256& hash, vHave)\n          {\n              std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n              if (mi != mapBlockIndex.end())\n              {\n                  CBlockIndex* pindex = (*mi).second;\n                  if (pindex->IsInMainChain())\n                      return hash;\n              }\n          }\n          return (!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "hashMerkleRoot.ToString",
          "args": [],
          "line": 1428
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsProofOfStake",
          "args": [],
          "line": 1424
        },
        "resolved": true,
        "details": {
          "function_name": "IsProofOfStake",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1384-1387",
          "snippet": "bool IsProofOfStake() const\n    {\n        return (nFlags & BLOCK_PROOF_OF_STAKE);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool IsProofOfStake() const\n      {\n          return (nFlags & BLOCK_PROOF_OF_STAKE);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetStakeEntropyBit",
          "args": [],
          "line": 1424
        },
        "resolved": true,
        "details": {
          "function_name": "GetStakeEntropyBit",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1394-1397",
          "snippet": "unsigned int GetStakeEntropyBit() const\n    {\n        return ((nFlags & BLOCK_STAKE_ENTROPY) >> 1);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  unsigned int GetStakeEntropyBit() const\n      {\n          return ((nFlags & BLOCK_STAKE_ENTROPY) >> 1);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GeneratedStakeModifier",
          "args": [],
          "line": 1424
        },
        "resolved": true,
        "details": {
          "function_name": "GeneratedStakeModifier",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1407-1410",
          "snippet": "bool GeneratedStakeModifier() const\n    {\n        return (nFlags & BLOCK_STAKE_MODIFIER);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool GeneratedStakeModifier() const\n      {\n          return (nFlags & BLOCK_STAKE_MODIFIER);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FormatMoney",
          "args": [],
          "line": 1423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatMoney",
          "args": [
            "nMoneySupply"
          ],
          "line": 1423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatMoney",
          "args": [],
          "line": 1423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatMoney",
          "args": [
            "nMint"
          ],
          "line": 1423
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  std::string ToString() const\n      {\n          return strprintf(\"CBlockIndex(nprev=%p, pnext=%p, nFile=%u, nBlockPos=%-6d nHeight=%d, nMint=%s, nMoneySupply=%s, nFlags=(%s)(%d)(%s), nStakeModifier=%016\"PRIx64\", nStakeModifierChecksum=%08x, hashProofOfStake=%s, prevoutStake=(%s), nStakeTime=%d merkle=%s, hashBlock=%s)\",\n              pprev, pnext, nFile, nBlockPos, nHeight,\n              FormatMoney(nMint).c_str(), FormatMoney(nMoneySupply).c_str(),\n              GeneratedStakeModifier() ? \"MOD\" : \"-\", GetStakeEntropyBit(), IsProofOfStake()? \"PoS\" : \"PoW\",\n              nStakeModifier, nStakeModifierChecksum, \n              hashProofOfStake.ToString().c_str(),\n              prevoutStake.ToString().c_str(), nStakeTime,\n              hashMerkleRoot.ToString().c_str(),\n              GetBlockHash().ToString().c_str());\n      }\n}"
  },
  {
    "function_name": "SetStakeModifier",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1412-1417",
    "snippet": "void SetStakeModifier(uint64_t nModifier, bool fGeneratedStakeModifier)\n    {\n        nStakeModifier = nModifier;\n        if (fGeneratedStakeModifier)\n            nFlags |= BLOCK_STAKE_MODIFIER;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  void SetStakeModifier(uint64_t nModifier, bool fGeneratedStakeModifier)\n      {\n          nStakeModifier = nModifier;\n          if (fGeneratedStakeModifier)\n              nFlags |= BLOCK_STAKE_MODIFIER;\n      }\n}"
  },
  {
    "function_name": "GeneratedStakeModifier",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1407-1410",
    "snippet": "bool GeneratedStakeModifier() const\n    {\n        return (nFlags & BLOCK_STAKE_MODIFIER);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool GeneratedStakeModifier() const\n      {\n          return (nFlags & BLOCK_STAKE_MODIFIER);\n      }\n}"
  },
  {
    "function_name": "SetStakeEntropyBit",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1399-1405",
    "snippet": "bool SetStakeEntropyBit(unsigned int nEntropyBit)\n    {\n        if (nEntropyBit > 1)\n            return false;\n        nFlags |= (nEntropyBit? BLOCK_STAKE_ENTROPY : 0);\n        return true;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool SetStakeEntropyBit(unsigned int nEntropyBit)\n      {\n          if (nEntropyBit > 1)\n              return false;\n          nFlags |= (nEntropyBit? BLOCK_STAKE_ENTROPY : 0);\n          return true;\n      }\n}"
  },
  {
    "function_name": "GetStakeEntropyBit",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1394-1397",
    "snippet": "unsigned int GetStakeEntropyBit() const\n    {\n        return ((nFlags & BLOCK_STAKE_ENTROPY) >> 1);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  unsigned int GetStakeEntropyBit() const\n      {\n          return ((nFlags & BLOCK_STAKE_ENTROPY) >> 1);\n      }\n}"
  },
  {
    "function_name": "SetProofOfStake",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1389-1392",
    "snippet": "void SetProofOfStake()\n    {\n        nFlags |= BLOCK_PROOF_OF_STAKE;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  void SetProofOfStake()\n      {\n          nFlags |= BLOCK_PROOF_OF_STAKE;\n      }\n}"
  },
  {
    "function_name": "IsProofOfStake",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1384-1387",
    "snippet": "bool IsProofOfStake() const\n    {\n        return (nFlags & BLOCK_PROOF_OF_STAKE);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool IsProofOfStake() const\n      {\n          return (nFlags & BLOCK_PROOF_OF_STAKE);\n      }\n}"
  },
  {
    "function_name": "IsProofOfWork",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1379-1382",
    "snippet": "bool IsProofOfWork() const\n    {\n        return !(nFlags & BLOCK_PROOF_OF_STAKE);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool IsProofOfWork() const\n      {\n          return !(nFlags & BLOCK_PROOF_OF_STAKE);\n      }\n}"
  },
  {
    "function_name": "GetAverageTimePast",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1335-1369",
    "snippet": "uint GetAverageTimePast(uint nAvgTimeSpan, uint nMinDelay) const {\n        uint avg[nAvgTimeSpan], nTempTime, i;\n        uint64 nAvgAccum;\n        const CBlockIndex* pindex = this;\n\n        /* Keep it fail safe */\n        if(!nAvgTimeSpan) return(0);\n\n        /* Initialise the elements to zero */\n        for(i = 0; i < nAvgTimeSpan; i++)\n          avg[i] = 0;\n\n        /* Fill with the time stamps */\n        for(i = nAvgTimeSpan; i && pindex; i--, pindex = pindex->pprev)\n          avg[i - 1] = pindex->nTime;\n\n        /* Not enough input blocks */\n        if(!avg[0]) return(0);\n\n        /* Time travel aware accumulator */\n        nTempTime = avg[0];\n        for(i = 1, nAvgAccum = nTempTime; i < nAvgTimeSpan; i++) { \n            /* Update the accumulator either with an actual or minimal\n             * delay supplied to prevent extremely fast blocks */\n            if(avg[i] < (nTempTime + nMinDelay))\n              nTempTime += nMinDelay;\n            else\n              nTempTime  = avg[i];\n            nAvgAccum += nTempTime;\n        }\n\n        nTempTime = (uint)(nAvgAccum / (uint64)nAvgTimeSpan);\n\n        return(nTempTime);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "nAvgAccum / (uint64)nAvgTimeSpan"
          ],
          "line": 1366
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  uint GetAverageTimePast(uint nAvgTimeSpan, uint nMinDelay) const {\n          uint avg[nAvgTimeSpan], nTempTime, i;\n          uint64 nAvgAccum;\n          const CBlockIndex* pindex = this;\n  \n          /* Keep it fail safe */\n          if(!nAvgTimeSpan) return(0);\n  \n          /* Initialise the elements to zero */\n          for(i = 0; i < nAvgTimeSpan; i++)\n            avg[i] = 0;\n  \n          /* Fill with the time stamps */\n          for(i = nAvgTimeSpan; i && pindex; i--, pindex = pindex->pprev)\n            avg[i - 1] = pindex->nTime;\n  \n          /* Not enough input blocks */\n          if(!avg[0]) return(0);\n  \n          /* Time travel aware accumulator */\n          nTempTime = avg[0];\n          for(i = 1, nAvgAccum = nTempTime; i < nAvgTimeSpan; i++) { \n              /* Update the accumulator either with an actual or minimal\n               * delay supplied to prevent extremely fast blocks */\n              if(avg[i] < (nTempTime + nMinDelay))\n                nTempTime += nMinDelay;\n              else\n                nTempTime  = avg[i];\n              nAvgAccum += nTempTime;\n          }\n  \n          nTempTime = (uint)(nAvgAccum / (uint64)nAvgTimeSpan);\n  \n          return(nTempTime);\n      }\n}"
  },
  {
    "function_name": "GetMedianTime",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1322-1332",
    "snippet": "int64_t GetMedianTime() const\n    {\n        const CBlockIndex* pindex = this;\n        for (int i = 0; i < nMedianTimeSpan/2; i++)\n        {\n            if (!pindex->pnext)\n                return GetBlockTime();\n            pindex = pindex->pnext;\n        }\n        return pindex->GetMedianTimePast();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pindex->GetMedianTimePast",
          "args": [],
          "line": 1331
        },
        "resolved": true,
        "details": {
          "function_name": "GetMedianTimePast",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1308-1320",
          "snippet": "int64_t GetMedianTimePast() const\n    {\n        int64_t pmedian[nMedianTimeSpan];\n        int64_t* pbegin = &pmedian[nMedianTimeSpan];\n        int64_t* pend = &pmedian[nMedianTimeSpan];\n\n        const CBlockIndex* pindex = this;\n        for (int i = 0; i < nMedianTimeSpan && pindex; i++, pindex = pindex->pprev)\n            *(--pbegin) = pindex->GetBlockTime();\n\n        std::sort(pbegin, pend);\n        return pbegin[(pend - pbegin)/2];\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  int64_t GetMedianTimePast() const\n      {\n          int64_t pmedian[nMedianTimeSpan];\n          int64_t* pbegin = &pmedian[nMedianTimeSpan];\n          int64_t* pend = &pmedian[nMedianTimeSpan];\n  \n          const CBlockIndex* pindex = this;\n          for (int i = 0; i < nMedianTimeSpan && pindex; i++, pindex = pindex->pprev)\n              *(--pbegin) = pindex->GetBlockTime();\n  \n          std::sort(pbegin, pend);\n          return pbegin[(pend - pbegin)/2];\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetBlockTime",
          "args": [],
          "line": 1328
        },
        "resolved": true,
        "details": {
          "function_name": "GetBlockTime",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1284-1287",
          "snippet": "int64_t GetBlockTime() const\n    {\n        return (int64_t)nTime;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  int64_t GetBlockTime() const\n      {\n          return (int64_t)nTime;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  int64_t GetMedianTime() const\n      {\n          const CBlockIndex* pindex = this;\n          for (int i = 0; i < nMedianTimeSpan/2; i++)\n          {\n              if (!pindex->pnext)\n                  return GetBlockTime();\n              pindex = pindex->pnext;\n          }\n          return pindex->GetMedianTimePast();\n      }\n}"
  },
  {
    "function_name": "GetMedianTimePast",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1308-1320",
    "snippet": "int64_t GetMedianTimePast() const\n    {\n        int64_t pmedian[nMedianTimeSpan];\n        int64_t* pbegin = &pmedian[nMedianTimeSpan];\n        int64_t* pend = &pmedian[nMedianTimeSpan];\n\n        const CBlockIndex* pindex = this;\n        for (int i = 0; i < nMedianTimeSpan && pindex; i++, pindex = pindex->pprev)\n            *(--pbegin) = pindex->GetBlockTime();\n\n        std::sort(pbegin, pend);\n        return pbegin[(pend - pbegin)/2];\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::sort",
          "args": [
            "pbegin",
            "pend"
          ],
          "line": 1318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pindex->GetBlockTime",
          "args": [],
          "line": 1316
        },
        "resolved": true,
        "details": {
          "function_name": "GetBlockTime",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1284-1287",
          "snippet": "int64_t GetBlockTime() const\n    {\n        return (int64_t)nTime;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  int64_t GetBlockTime() const\n      {\n          return (int64_t)nTime;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  int64_t GetMedianTimePast() const\n      {\n          int64_t pmedian[nMedianTimeSpan];\n          int64_t* pbegin = &pmedian[nMedianTimeSpan];\n          int64_t* pend = &pmedian[nMedianTimeSpan];\n  \n          const CBlockIndex* pindex = this;\n          for (int i = 0; i < nMedianTimeSpan && pindex; i++, pindex = pindex->pprev)\n              *(--pbegin) = pindex->GetBlockTime();\n  \n          std::sort(pbegin, pend);\n          return pbegin[(pend - pbegin)/2];\n      }\n}"
  },
  {
    "function_name": "GetPastTimeLimit",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1301-1304",
    "snippet": "int64_t GetPastTimeLimit() const\n    {\n        return GetMedianTimePast();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetMedianTimePast",
          "args": [],
          "line": 1303
        },
        "resolved": true,
        "details": {
          "function_name": "GetMedianTimePast",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1308-1320",
          "snippet": "int64_t GetMedianTimePast() const\n    {\n        int64_t pmedian[nMedianTimeSpan];\n        int64_t* pbegin = &pmedian[nMedianTimeSpan];\n        int64_t* pend = &pmedian[nMedianTimeSpan];\n\n        const CBlockIndex* pindex = this;\n        for (int i = 0; i < nMedianTimeSpan && pindex; i++, pindex = pindex->pprev)\n            *(--pbegin) = pindex->GetBlockTime();\n\n        std::sort(pbegin, pend);\n        return pbegin[(pend - pbegin)/2];\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  int64_t GetMedianTimePast() const\n      {\n          int64_t pmedian[nMedianTimeSpan];\n          int64_t* pbegin = &pmedian[nMedianTimeSpan];\n          int64_t* pend = &pmedian[nMedianTimeSpan];\n  \n          const CBlockIndex* pindex = this;\n          for (int i = 0; i < nMedianTimeSpan && pindex; i++, pindex = pindex->pprev)\n              *(--pbegin) = pindex->GetBlockTime();\n  \n          std::sort(pbegin, pend);\n          return pbegin[(pend - pbegin)/2];\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  int64_t GetPastTimeLimit() const\n      {\n          return GetMedianTimePast();\n      }\n}"
  },
  {
    "function_name": "CheckIndex",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1296-1299",
    "snippet": "bool CheckIndex() const\n    {\n        return true;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool CheckIndex() const\n      {\n          return true;\n      }\n}"
  },
  {
    "function_name": "IsInMainChain",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1291-1294",
    "snippet": "bool IsInMainChain() const\n    {\n        return (pnext || this == pindexBest);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool IsInMainChain() const\n      {\n          return (pnext || this == pindexBest);\n      }\n}"
  },
  {
    "function_name": "GetBlockTime",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1284-1287",
    "snippet": "int64_t GetBlockTime() const\n    {\n        return (int64_t)nTime;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  int64_t GetBlockTime() const\n      {\n          return (int64_t)nTime;\n      }\n}"
  },
  {
    "function_name": "GetBlockHash",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1279-1282",
    "snippet": "uint256 GetBlockHash() const\n    {\n        return *phashBlock;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  uint256 GetBlockHash() const\n      {\n          return *phashBlock;\n      }\n}"
  },
  {
    "function_name": "GetBlockHeader",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1266-1277",
    "snippet": "CBlock GetBlockHeader() const\n    {\n        CBlock block;\n        block.nVersion       = nVersion;\n        if (pprev)\n            block.hashPrevBlock = pprev->GetBlockHash();\n        block.hashMerkleRoot = hashMerkleRoot;\n        block.nTime          = nTime;\n        block.nBits          = nBits;\n        block.nNonce         = nNonce;\n        return block;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pprev->GetBlockHash",
          "args": [],
          "line": 1271
        },
        "resolved": true,
        "details": {
          "function_name": "GetBlockHash",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1644-1658",
          "snippet": "uint256 GetBlockHash()\n    {\n        // Find the first block the caller has in the main chain\n        BOOST_FOREACH(const uint256& hash, vHave)\n        {\n            std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n            if (mi != mapBlockIndex.end())\n            {\n                CBlockIndex* pindex = (*mi).second;\n                if (pindex->IsInMainChain())\n                    return hash;\n            }\n        }\n        return (!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  uint256 GetBlockHash()\n      {\n          // Find the first block the caller has in the main chain\n          BOOST_FOREACH(const uint256& hash, vHave)\n          {\n              std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);\n              if (mi != mapBlockIndex.end())\n              {\n                  CBlockIndex* pindex = (*mi).second;\n                  if (pindex->IsInMainChain())\n                      return hash;\n              }\n          }\n          return (!fTestNet ? hashGenesisBlock : hashGenesisBlockTestNet);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  CBlock GetBlockHeader() const\n      {\n          CBlock block;\n          block.nVersion       = nVersion;\n          if (pprev)\n              block.hashPrevBlock = pprev->GetBlockHash();\n          block.hashMerkleRoot = hashMerkleRoot;\n          block.nTime          = nTime;\n          block.nBits          = nBits;\n          block.nNonce         = nNonce;\n          return block;\n      }\n}"
  },
  {
    "function_name": "CBlockIndex",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1232-1264",
    "snippet": "CBlockIndex(unsigned int nFileIn, unsigned int nBlockPosIn, CBlock& block)\n    {\n        phashBlock = NULL;\n        pprev = NULL;\n        pnext = NULL;\n        nFile = nFileIn;\n        nBlockPos = nBlockPosIn;\n        nHeight = 0;\n        nChainTrust = 0;\n        nMint = 0;\n        nMoneySupply = 0;\n        nFlags = 0;\n        nStakeModifier = 0;\n        nStakeModifierChecksum = 0;\n        hashProofOfStake = 0;\n        if (block.IsProofOfStake())\n        {\n            SetProofOfStake();\n            prevoutStake = block.vtx[1].vin[0].prevout;\n            nStakeTime = block.vtx[1].nTime;\n        }\n        else\n        {\n            prevoutStake.SetNull();\n            nStakeTime = 0;\n        }\n\n        nVersion       = block.nVersion;\n        hashMerkleRoot = block.hashMerkleRoot;\n        nTime          = block.nTime;\n        nBits          = block.nBits;\n        nNonce         = block.nNonce;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prevoutStake.SetNull",
          "args": [],
          "line": 1255
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1580-1583",
          "snippet": "void SetNull()\n    {\n        vHave.clear();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void SetNull()\n      {\n          vHave.clear();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetProofOfStake",
          "args": [],
          "line": 1249
        },
        "resolved": true,
        "details": {
          "function_name": "SetProofOfStake",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1389-1392",
          "snippet": "void SetProofOfStake()\n    {\n        nFlags |= BLOCK_PROOF_OF_STAKE;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  void SetProofOfStake()\n      {\n          nFlags |= BLOCK_PROOF_OF_STAKE;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "block.IsProofOfStake",
          "args": [],
          "line": 1247
        },
        "resolved": true,
        "details": {
          "function_name": "IsProofOfStake",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1384-1387",
          "snippet": "bool IsProofOfStake() const\n    {\n        return (nFlags & BLOCK_PROOF_OF_STAKE);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool IsProofOfStake() const\n      {\n          return (nFlags & BLOCK_PROOF_OF_STAKE);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  CBlockIndex(unsigned int nFileIn, unsigned int nBlockPosIn, CBlock& block)\n      {\n          phashBlock = NULL;\n          pprev = NULL;\n          pnext = NULL;\n          nFile = nFileIn;\n          nBlockPos = nBlockPosIn;\n          nHeight = 0;\n          nChainTrust = 0;\n          nMint = 0;\n          nMoneySupply = 0;\n          nFlags = 0;\n          nStakeModifier = 0;\n          nStakeModifierChecksum = 0;\n          hashProofOfStake = 0;\n          if (block.IsProofOfStake())\n          {\n              SetProofOfStake();\n              prevoutStake = block.vtx[1].vin[0].prevout;\n              nStakeTime = block.vtx[1].nTime;\n          }\n          else\n          {\n              prevoutStake.SetNull();\n              nStakeTime = 0;\n          }\n  \n          nVersion       = block.nVersion;\n          hashMerkleRoot = block.hashMerkleRoot;\n          nTime          = block.nTime;\n          nBits          = block.nBits;\n          nNonce         = block.nNonce;\n      }\n}"
  },
  {
    "function_name": "CBlockIndex",
    "container": "CBlockIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1207-1230",
    "snippet": "CBlockIndex()\n    {\n        phashBlock = NULL;\n        pprev = NULL;\n        pnext = NULL;\n        nFile = 0;\n        nBlockPos = 0;\n        nHeight = 0;\n        nChainTrust = 0;\n        nMint = 0;\n        nMoneySupply = 0;\n        nFlags = 0;\n        nStakeModifier = 0;\n        nStakeModifierChecksum = 0;\n        hashProofOfStake = 0;\n        prevoutStake.SetNull();\n        nStakeTime = 0;\n\n        nVersion       = 0;\n        hashMerkleRoot = 0;\n        nTime          = 0;\n        nBits          = 0;\n        nNonce         = 0;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prevoutStake.SetNull",
          "args": [],
          "line": 1222
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1580-1583",
          "snippet": "void SetNull()\n    {\n        vHave.clear();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void SetNull()\n      {\n          vHave.clear();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  CBlockIndex()\n      {\n          phashBlock = NULL;\n          pprev = NULL;\n          pnext = NULL;\n          nFile = 0;\n          nBlockPos = 0;\n          nHeight = 0;\n          nChainTrust = 0;\n          nMint = 0;\n          nMoneySupply = 0;\n          nFlags = 0;\n          nStakeModifier = 0;\n          nStakeModifierChecksum = 0;\n          hashProofOfStake = 0;\n          prevoutStake.SetNull();\n          nStakeTime = 0;\n  \n          nVersion       = 0;\n          hashMerkleRoot = 0;\n          nTime          = 0;\n          nBits          = 0;\n          nNonce         = 0;\n      }\n}"
  },
  {
    "function_name": "print",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1121-1140",
    "snippet": "void print() const\n    {\n        printf(\"CBlock(hash=%s, ver=%d, hashPrevBlock=%s, hashMerkleRoot=%s, nTime=%u, nBits=%08x, nNonce=%u, vtx=%\"PRIszu\", vchBlockSig=%s)\\n\",\n            GetHash().ToString().c_str(),\n            nVersion,\n            hashPrevBlock.ToString().c_str(),\n            hashMerkleRoot.ToString().c_str(),\n            nTime, nBits, nNonce,\n            vtx.size(),\n            HexStr(vchBlockSig.begin(), vchBlockSig.end()).c_str());\n        for (unsigned int i = 0; i < vtx.size(); i++)\n        {\n            printf(\"  \");\n            vtx[i].print();\n        }\n        printf(\"  vMerkleTree: \");\n        for (unsigned int i = 0; i < vMerkleTree.size(); i++)\n            printf(\"%s \", vMerkleTree[i].ToString().substr(0,10).c_str());\n        printf(\"\\n\");\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 1139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s \"",
            "vMerkleTree[i].ToString().substr(0,10).c_str()"
          ],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vMerkleTree[i].ToString",
          "args": [],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vMerkleTree[i].ToString",
          "args": [
            "0",
            "10"
          ],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "595-602",
          "snippet": "std::string ToString(const KVMap& data,\n                       const KVMap::const_reverse_iterator& it) {\n    if (it == data.rend()) {\n      return \"END\";\n    } else {\n      return \"'\" + it->first + \"->\" + it->second + \"'\";\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string ToString(const KVMap& data,\n                         const KVMap::const_reverse_iterator& it) {\n      if (it == data.rend()) {\n        return \"END\";\n      } else {\n        return \"'\" + it->first + \"->\" + it->second + \"'\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vMerkleTree.size",
          "args": [],
          "line": 1137
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1691-1695",
          "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  unsigned long size()\n      {\n          LOCK(cs);\n          return mapTx.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"  vMerkleTree: \""
          ],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vtx[i].print",
          "args": [],
          "line": 1134
        },
        "resolved": true,
        "details": {
          "function_name": "print",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1529-1532",
          "snippet": "void print() const\n    {\n        printf(\"%s\\n\", ToString().c_str());\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  void print() const\n      {\n          printf(\"%s\\n\", ToString().c_str());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"  \""
          ],
          "line": 1133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"CBlock(hash=%s, ver=%d, hashPrevBlock=%s, hashMerkleRoot=%s, nTime=%u, nBits=%08x, nNonce=%u, vtx=%\"PRIszu\", vchBlockSig=%s)\\n\"",
            "GetHash().ToString().c_str()",
            "nVersion",
            "hashPrevBlock.ToString().c_str()",
            "hashMerkleRoot.ToString().c_str()",
            "nTime",
            "nBits",
            "nNonce",
            "vtx.size()",
            "HexStr(vchBlockSig.begin(), vchBlockSig.end()).c_str()"
          ],
          "line": 1123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HexStr",
          "args": [],
          "line": 1130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HexStr",
          "args": [
            "vchBlockSig.begin()",
            "vchBlockSig.end()"
          ],
          "line": 1130
        },
        "resolved": true,
        "details": {
          "function_name": "HexStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "323-339",
          "snippet": "std::string HexStr(const T itbegin, const T itend, bool fSpaces=false)\n{\n    std::string rv;\n    static const char hexmap[16] = { '0', '1', '2', '3', '4', '5', '6', '7',\n                                     '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };\n    rv.reserve((itend-itbegin)*3);\n    for(T it = itbegin; it < itend; ++it)\n    {\n        unsigned char val = (unsigned char)(*it);\n        if(fSpaces && it != itbegin)\n            rv.push_back(' ');\n        rv.push_back(hexmap[val>>4]);\n        rv.push_back(hexmap[val&15]);\n    }\n\n    return rv;\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nstd::string HexStr(const T itbegin, const T itend, bool fSpaces=false)\n{\n    std::string rv;\n    static const char hexmap[16] = { '0', '1', '2', '3', '4', '5', '6', '7',\n                                     '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };\n    rv.reserve((itend-itbegin)*3);\n    for(T it = itbegin; it < itend; ++it)\n    {\n        unsigned char val = (unsigned char)(*it);\n        if(fSpaces && it != itbegin)\n            rv.push_back(' ');\n        rv.push_back(hexmap[val>>4]);\n        rv.push_back(hexmap[val&15]);\n    }\n\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchBlockSig.end",
          "args": [],
          "line": 1130
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchBlockSig.begin",
          "args": [],
          "line": 1130
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetHash",
          "args": [],
          "line": 1124
        },
        "resolved": true,
        "details": {
          "function_name": "GetHashPoW",
          "container": "CBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "936-952",
          "snippet": "uint256 GetHashPoW() const {\n        uint256 hashPoW;\n        uint profile = 0x0;\n\n        /* All these blocks must be v2+ with valid nHeight */\n        int nHeight = GetBlockHeight();\n\n        /* X15 or NeoScrypt */\n        if(!fTestNet && (nHeight < nForkOne)) {\n            x15hash((uchar *) &nVersion, (uchar *) &hashPoW);\n        } else {\n            profile |= nNeoScryptOptions;\n            neoscrypt((uchar *) &nVersion, (uchar *) &hashPoW, profile);\n        }\n\n        return(hashPoW);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  uint256 GetHashPoW() const {\n          uint256 hashPoW;\n          uint profile = 0x0;\n  \n          /* All these blocks must be v2+ with valid nHeight */\n          int nHeight = GetBlockHeight();\n  \n          /* X15 or NeoScrypt */\n          if(!fTestNet && (nHeight < nForkOne)) {\n              x15hash((uchar *) &nVersion, (uchar *) &hashPoW);\n          } else {\n              profile |= nNeoScryptOptions;\n              neoscrypt((uchar *) &nVersion, (uchar *) &hashPoW, profile);\n          }\n  \n          return(hashPoW);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  void print() const\n      {\n          printf(\"CBlock(hash=%s, ver=%d, hashPrevBlock=%s, hashMerkleRoot=%s, nTime=%u, nBits=%08x, nNonce=%u, vtx=%\"PRIszu\", vchBlockSig=%s)\\n\",\n              GetHash().ToString().c_str(),\n              nVersion,\n              hashPrevBlock.ToString().c_str(),\n              hashMerkleRoot.ToString().c_str(),\n              nTime, nBits, nNonce,\n              vtx.size(),\n              HexStr(vchBlockSig.begin(), vchBlockSig.end()).c_str());\n          for (unsigned int i = 0; i < vtx.size(); i++)\n          {\n              printf(\"  \");\n              vtx[i].print();\n          }\n          printf(\"  vMerkleTree: \");\n          for (unsigned int i = 0; i < vMerkleTree.size(); i++)\n              printf(\"%s \", vMerkleTree[i].ToString().substr(0,10).c_str());\n          printf(\"\\n\");\n      }\n}"
  },
  {
    "function_name": "ReadFromDisk",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1097-1117",
    "snippet": "bool ReadFromDisk(unsigned int nFile, unsigned int nBlockPos, bool fReadTransactions=true)\n    {\n        SetNull();\n\n        // Open history file to read\n        CAutoFile filein = CAutoFile(OpenBlockFile(nFile, nBlockPos, \"rb\"), SER_DISK, CLIENT_VERSION);\n        if (!filein)\n            return error(\"CBlock::ReadFromDisk() : OpenBlockFile failed\");\n        if (!fReadTransactions)\n            filein.nType |= SER_BLOCKHEADERONLY;\n\n        // Read block\n        try {\n            filein >> *this;\n        }\n        catch (std::exception &e) {\n            return error(\"%s() : deserialize or I/O error\", __PRETTY_FUNCTION__);\n        }\n\n        return true;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"%s() : deserialize or I/O error\"",
            "__PRETTY_FUNCTION__"
          ],
          "line": 1113
        },
        "resolved": true,
        "details": {
          "function_name": "leveldb_options_set_error_if_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "411-414",
          "snippet": "void leveldb_options_set_error_if_exists(\n    leveldb_options_t* opt, unsigned char v) {\n  opt->rep.error_if_exists = v;\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_error_if_exists(\n    leveldb_options_t* opt, unsigned char v) {\n  opt->rep.error_if_exists = v;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"CBlock::ReadFromDisk() : OpenBlockFile failed\""
          ],
          "line": 1104
        },
        "resolved": true,
        "details": {
          "function_name": "key_error",
          "container": "key_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "44-44",
          "snippet": "explicit key_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nkey_error {\n  explicit key_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "CAutoFile",
          "args": [
            "OpenBlockFile(nFile, nBlockPos, \"rb\")",
            "SER_DISK",
            "CLIENT_VERSION"
          ],
          "line": 1102
        },
        "resolved": true,
        "details": {
          "function_name": "CAutoFile",
          "container": "CAutoFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "1037-1044",
          "snippet": "CAutoFile(FILE* filenew, int nTypeIn, int nVersionIn)\n    {\n        file = filenew;\n        nType = nTypeIn;\n        nVersion = nVersionIn;\n        state = 0;\n        exceptmask = std::ios::badbit | std::ios::failbit;\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCAutoFile {\n  CAutoFile(FILE* filenew, int nTypeIn, int nVersionIn)\n      {\n          file = filenew;\n          nType = nTypeIn;\n          nVersion = nVersionIn;\n          state = 0;\n          exceptmask = std::ios::badbit | std::ios::failbit;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "OpenBlockFile",
          "args": [
            "nFile",
            "nBlockPos",
            "\"rb\""
          ],
          "line": 1102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetNull",
          "args": [],
          "line": 1099
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1580-1583",
          "snippet": "void SetNull()\n    {\n        vHave.clear();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void SetNull()\n      {\n          vHave.clear();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  bool ReadFromDisk(unsigned int nFile, unsigned int nBlockPos, bool fReadTransactions=true)\n      {\n          SetNull();\n  \n          // Open history file to read\n          CAutoFile filein = CAutoFile(OpenBlockFile(nFile, nBlockPos, \"rb\"), SER_DISK, CLIENT_VERSION);\n          if (!filein)\n              return error(\"CBlock::ReadFromDisk() : OpenBlockFile failed\");\n          if (!fReadTransactions)\n              filein.nType |= SER_BLOCKHEADERONLY;\n  \n          // Read block\n          try {\n              filein >> *this;\n          }\n          catch (std::exception &e) {\n              return error(\"%s() : deserialize or I/O error\", __PRETTY_FUNCTION__);\n          }\n  \n          return true;\n      }\n}"
  },
  {
    "function_name": "WriteToDisk",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1071-1095",
    "snippet": "bool WriteToDisk(unsigned int& nFileRet, unsigned int& nBlockPosRet)\n    {\n        // Open history file to append\n        CAutoFile fileout = CAutoFile(AppendBlockFile(nFileRet), SER_DISK, CLIENT_VERSION);\n        if (!fileout)\n            return error(\"CBlock::WriteToDisk() : AppendBlockFile failed\");\n\n        // Write index header\n        unsigned int nSize = fileout.GetSerializeSize(*this);\n        fileout << FLATDATA(pchMessageStart) << nSize;\n\n        // Write block\n        long fileOutPos = ftell(fileout);\n        if (fileOutPos < 0)\n            return error(\"CBlock::WriteToDisk() : ftell failed\");\n        nBlockPosRet = fileOutPos;\n        fileout << *this;\n\n        // Flush stdio buffers and commit to disk before returning\n        fflush(fileout);\n        if(!IsInitialBlockDownload() || !((nBestHeight + 1) % 100))\n          FileCommit(fileout);\n\n        return true;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FileCommit",
          "args": [
            "fileout"
          ],
          "line": 1092
        },
        "resolved": true,
        "details": {
          "function_name": "FileCommit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1141-1149",
          "snippet": "void FileCommit(FILE *fileout)\n{\n    fflush(fileout);                // harmless if redundantly called\n#ifdef WIN32\n    _commit(_fileno(fileout));\n#else\n    fsync(fileno(fileout));\n#endif\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static FILE* fileout = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic FILE* fileout = NULL;\n\nvoid FileCommit(FILE *fileout)\n{\n    fflush(fileout);                // harmless if redundantly called\n#ifdef WIN32\n    _commit(_fileno(fileout));\n#else\n    fsync(fileno(fileout));\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsInitialBlockDownload",
          "args": [],
          "line": 1091
        },
        "resolved": true,
        "details": {
          "function_name": "IsInitialBlockDownload",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "1220-1233",
          "snippet": "bool IsInitialBlockDownload()\n{\n    if (pindexBest == NULL || nBestHeight < Checkpoints::GetTotalBlocksEstimate())\n        return true;\n    static int64_t nLastUpdate;\n    static CBlockIndex* pindexLastBest;\n    if (pindexBest != pindexLastBest)\n    {\n        pindexLastBest = pindexBest;\n        nLastUpdate = GetTime();\n    }\n    return(((GetTime() - nLastUpdate) < 10) &&\n      (pindexBest->GetBlockTime() < (GetTime() - 4 * 60 * 60)));\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int nBestHeight = -1;",
            "CBlockIndex* pindexBest = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nint nBestHeight = -1;\nCBlockIndex* pindexBest = NULL;\n\nbool IsInitialBlockDownload()\n{\n    if (pindexBest == NULL || nBestHeight < Checkpoints::GetTotalBlocksEstimate())\n        return true;\n    static int64_t nLastUpdate;\n    static CBlockIndex* pindexLastBest;\n    if (pindexBest != pindexLastBest)\n    {\n        pindexLastBest = pindexBest;\n        nLastUpdate = GetTime();\n    }\n    return(((GetTime() - nLastUpdate) < 10) &&\n      (pindexBest->GetBlockTime() < (GetTime() - 4 * 60 * 60)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "fileout"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"CBlock::WriteToDisk() : ftell failed\""
          ],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "key_error",
          "container": "key_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "44-44",
          "snippet": "explicit key_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nkey_error {\n  explicit key_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ftell",
          "args": [
            "fileout"
          ],
          "line": 1083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FLATDATA",
          "args": [
            "pchMessageStart"
          ],
          "line": 1080
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fileout.GetSerializeSize",
          "args": [
            "*this"
          ],
          "line": 1079
        },
        "resolved": true,
        "details": {
          "function_name": "GetSerializeSize",
          "container": "CAutoFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "1109-1113",
          "snippet": "unsigned int GetSerializeSize(const T& obj)\n    {\n        // Tells the size of the object if serialized to this stream\n        return ::GetSerializeSize(obj, nType, nVersion);\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCAutoFile {\n  unsigned int GetSerializeSize(const T& obj)\n      {\n          // Tells the size of the object if serialized to this stream\n          return ::GetSerializeSize(obj, nType, nVersion);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CAutoFile",
          "args": [
            "AppendBlockFile(nFileRet)",
            "SER_DISK",
            "CLIENT_VERSION"
          ],
          "line": 1074
        },
        "resolved": true,
        "details": {
          "function_name": "CAutoFile",
          "container": "CAutoFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "1037-1044",
          "snippet": "CAutoFile(FILE* filenew, int nTypeIn, int nVersionIn)\n    {\n        file = filenew;\n        nType = nTypeIn;\n        nVersion = nVersionIn;\n        state = 0;\n        exceptmask = std::ios::badbit | std::ios::failbit;\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCAutoFile {\n  CAutoFile(FILE* filenew, int nTypeIn, int nVersionIn)\n      {\n          file = filenew;\n          nType = nTypeIn;\n          nVersion = nVersionIn;\n          state = 0;\n          exceptmask = std::ios::badbit | std::ios::failbit;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "AppendBlockFile",
          "args": [
            "nFileRet"
          ],
          "line": 1074
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  bool WriteToDisk(unsigned int& nFileRet, unsigned int& nBlockPosRet)\n      {\n          // Open history file to append\n          CAutoFile fileout = CAutoFile(AppendBlockFile(nFileRet), SER_DISK, CLIENT_VERSION);\n          if (!fileout)\n              return error(\"CBlock::WriteToDisk() : AppendBlockFile failed\");\n  \n          // Write index header\n          unsigned int nSize = fileout.GetSerializeSize(*this);\n          fileout << FLATDATA(pchMessageStart) << nSize;\n  \n          // Write block\n          long fileOutPos = ftell(fileout);\n          if (fileOutPos < 0)\n              return error(\"CBlock::WriteToDisk() : ftell failed\");\n          nBlockPosRet = fileOutPos;\n          fileout << *this;\n  \n          // Flush stdio buffers and commit to disk before returning\n          fflush(fileout);\n          if(!IsInitialBlockDownload() || !((nBestHeight + 1) % 100))\n            FileCommit(fileout);\n  \n          return true;\n      }\n}"
  },
  {
    "function_name": "CheckMerkleBranch",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1055-1068",
    "snippet": "static uint256 CheckMerkleBranch(uint256 hash, const std::vector<uint256>& vMerkleBranch, int nIndex)\n    {\n        if (nIndex == -1)\n            return 0;\n        BOOST_FOREACH(const uint256& otherside, vMerkleBranch)\n        {\n            if (nIndex & 1)\n                hash = Hash(BEGIN(otherside), END(otherside), BEGIN(hash), END(hash));\n            else\n                hash = Hash(BEGIN(hash), END(hash), BEGIN(otherside), END(otherside));\n            nIndex >>= 1;\n        }\n        return hash;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Hash",
          "args": [
            "BEGIN(hash)",
            "END(hash)",
            "BEGIN(otherside)",
            "END(otherside)"
          ],
          "line": 1064
        },
        "resolved": true,
        "details": {
          "function_name": "Hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "513-526",
          "snippet": "inline uint256 Hash(const T1 p1begin, const T1 p1end,\n                    const T2 p2begin, const T2 p2end)\n{\n    static unsigned char pblank[1];\n    uint256 hash1;\n    SHA256_CTX ctx;\n    SHA256_Init(&ctx);\n    SHA256_Update(&ctx, (p1begin == p1end ? pblank : (unsigned char*)&p1begin[0]), (p1end - p1begin) * sizeof(p1begin[0]));\n    SHA256_Update(&ctx, (p2begin == p2end ? pblank : (unsigned char*)&p2begin[0]), (p2end - p2begin) * sizeof(p2begin[0]));\n    SHA256_Final((unsigned char*)&hash1, &ctx);\n    uint256 hash2;\n    SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline uint256 Hash(const T1 p1begin, const T1 p1end,\n                    const T2 p2begin, const T2 p2end)\n{\n    static unsigned char pblank[1];\n    uint256 hash1;\n    SHA256_CTX ctx;\n    SHA256_Init(&ctx);\n    SHA256_Update(&ctx, (p1begin == p1end ? pblank : (unsigned char*)&p1begin[0]), (p1end - p1begin) * sizeof(p1begin[0]));\n    SHA256_Update(&ctx, (p2begin == p2end ? pblank : (unsigned char*)&p2begin[0]), (p2end - p2begin) * sizeof(p2begin[0]));\n    SHA256_Final((unsigned char*)&hash1, &ctx);\n    uint256 hash2;\n    SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "END",
          "args": [
            "otherside"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BEGIN",
          "args": [
            "otherside"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "END",
          "args": [
            "hash"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BEGIN",
          "args": [
            "hash"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "END",
          "args": [
            "hash"
          ],
          "line": 1062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BEGIN",
          "args": [
            "hash"
          ],
          "line": 1062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "END",
          "args": [
            "otherside"
          ],
          "line": 1062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BEGIN",
          "args": [
            "otherside"
          ],
          "line": 1062
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  static uint256 CheckMerkleBranch(uint256 hash, const std::vector<uint256>& vMerkleBranch, int nIndex)\n      {\n          if (nIndex == -1)\n              return 0;\n          BOOST_FOREACH(const uint256& otherside, vMerkleBranch)\n          {\n              if (nIndex & 1)\n                  hash = Hash(BEGIN(otherside), END(otherside), BEGIN(hash), END(hash));\n              else\n                  hash = Hash(BEGIN(hash), END(hash), BEGIN(otherside), END(otherside));\n              nIndex >>= 1;\n          }\n          return hash;\n      }\n}"
  },
  {
    "function_name": "GetMerkleBranch",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1039-1053",
    "snippet": "std::vector<uint256> GetMerkleBranch(int nIndex) const\n    {\n        if (vMerkleTree.empty())\n            BuildMerkleTree();\n        std::vector<uint256> vMerkleBranch;\n        int j = 0;\n        for (int nSize = vtx.size(); nSize > 1; nSize = (nSize + 1) / 2)\n        {\n            int i = std::min(nIndex^1, nSize-1);\n            vMerkleBranch.push_back(vMerkleTree[j+i]);\n            nIndex >>= 1;\n            j += nSize;\n        }\n        return vMerkleBranch;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vMerkleBranch.push_back",
          "args": [
            "vMerkleTree[j+i]"
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::min",
          "args": [
            "nIndex^1",
            "nSize-1"
          ],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vtx.size",
          "args": [],
          "line": 1045
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1691-1695",
          "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  unsigned long size()\n      {\n          LOCK(cs);\n          return mapTx.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BuildMerkleTree",
          "args": [],
          "line": 1042
        },
        "resolved": true,
        "details": {
          "function_name": "BuildMerkleTree",
          "container": "CBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1020-1037",
          "snippet": "uint256 BuildMerkleTree() const\n    {\n        vMerkleTree.clear();\n        BOOST_FOREACH(const CTransaction& tx, vtx)\n            vMerkleTree.push_back(tx.GetHash());\n        int j = 0;\n        for (int nSize = vtx.size(); nSize > 1; nSize = (nSize + 1) / 2)\n        {\n            for (int i = 0; i < nSize; i += 2)\n            {\n                int i2 = std::min(i+1, nSize-1);\n                vMerkleTree.push_back(Hash(BEGIN(vMerkleTree[j+i]),  END(vMerkleTree[j+i]),\n                                           BEGIN(vMerkleTree[j+i2]), END(vMerkleTree[j+i2])));\n            }\n            j += nSize;\n        }\n        return (vMerkleTree.empty() ? 0 : vMerkleTree.back());\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  uint256 BuildMerkleTree() const\n      {\n          vMerkleTree.clear();\n          BOOST_FOREACH(const CTransaction& tx, vtx)\n              vMerkleTree.push_back(tx.GetHash());\n          int j = 0;\n          for (int nSize = vtx.size(); nSize > 1; nSize = (nSize + 1) / 2)\n          {\n              for (int i = 0; i < nSize; i += 2)\n              {\n                  int i2 = std::min(i+1, nSize-1);\n                  vMerkleTree.push_back(Hash(BEGIN(vMerkleTree[j+i]),  END(vMerkleTree[j+i]),\n                                             BEGIN(vMerkleTree[j+i2]), END(vMerkleTree[j+i2])));\n              }\n              j += nSize;\n          }\n          return (vMerkleTree.empty() ? 0 : vMerkleTree.back());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vMerkleTree.empty",
          "args": [],
          "line": 1041
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  std::vector<uint256> GetMerkleBranch(int nIndex) const\n      {\n          if (vMerkleTree.empty())\n              BuildMerkleTree();\n          std::vector<uint256> vMerkleBranch;\n          int j = 0;\n          for (int nSize = vtx.size(); nSize > 1; nSize = (nSize + 1) / 2)\n          {\n              int i = std::min(nIndex^1, nSize-1);\n              vMerkleBranch.push_back(vMerkleTree[j+i]);\n              nIndex >>= 1;\n              j += nSize;\n          }\n          return vMerkleBranch;\n      }\n}"
  },
  {
    "function_name": "BuildMerkleTree",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1020-1037",
    "snippet": "uint256 BuildMerkleTree() const\n    {\n        vMerkleTree.clear();\n        BOOST_FOREACH(const CTransaction& tx, vtx)\n            vMerkleTree.push_back(tx.GetHash());\n        int j = 0;\n        for (int nSize = vtx.size(); nSize > 1; nSize = (nSize + 1) / 2)\n        {\n            for (int i = 0; i < nSize; i += 2)\n            {\n                int i2 = std::min(i+1, nSize-1);\n                vMerkleTree.push_back(Hash(BEGIN(vMerkleTree[j+i]),  END(vMerkleTree[j+i]),\n                                           BEGIN(vMerkleTree[j+i2]), END(vMerkleTree[j+i2])));\n            }\n            j += nSize;\n        }\n        return (vMerkleTree.empty() ? 0 : vMerkleTree.back());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vMerkleTree.back",
          "args": [],
          "line": 1036
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vMerkleTree.empty",
          "args": [],
          "line": 1036
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vMerkleTree.push_back",
          "args": [
            "Hash(BEGIN(vMerkleTree[j+i]),  END(vMerkleTree[j+i]),\n                                           BEGIN(vMerkleTree[j+i2]), END(vMerkleTree[j+i2]))"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Hash",
          "args": [
            "BEGIN(vMerkleTree[j+i])",
            "END(vMerkleTree[j+i])",
            "BEGIN(vMerkleTree[j+i2])",
            "END(vMerkleTree[j+i2])"
          ],
          "line": 1031
        },
        "resolved": true,
        "details": {
          "function_name": "Hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "513-526",
          "snippet": "inline uint256 Hash(const T1 p1begin, const T1 p1end,\n                    const T2 p2begin, const T2 p2end)\n{\n    static unsigned char pblank[1];\n    uint256 hash1;\n    SHA256_CTX ctx;\n    SHA256_Init(&ctx);\n    SHA256_Update(&ctx, (p1begin == p1end ? pblank : (unsigned char*)&p1begin[0]), (p1end - p1begin) * sizeof(p1begin[0]));\n    SHA256_Update(&ctx, (p2begin == p2end ? pblank : (unsigned char*)&p2begin[0]), (p2end - p2begin) * sizeof(p2begin[0]));\n    SHA256_Final((unsigned char*)&hash1, &ctx);\n    uint256 hash2;\n    SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline uint256 Hash(const T1 p1begin, const T1 p1end,\n                    const T2 p2begin, const T2 p2end)\n{\n    static unsigned char pblank[1];\n    uint256 hash1;\n    SHA256_CTX ctx;\n    SHA256_Init(&ctx);\n    SHA256_Update(&ctx, (p1begin == p1end ? pblank : (unsigned char*)&p1begin[0]), (p1end - p1begin) * sizeof(p1begin[0]));\n    SHA256_Update(&ctx, (p2begin == p2end ? pblank : (unsigned char*)&p2begin[0]), (p2end - p2begin) * sizeof(p2begin[0]));\n    SHA256_Final((unsigned char*)&hash1, &ctx);\n    uint256 hash2;\n    SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "END",
          "args": [
            "vMerkleTree[j+i2]"
          ],
          "line": 1032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BEGIN",
          "args": [
            "vMerkleTree[j+i2]"
          ],
          "line": 1032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "END",
          "args": [
            "vMerkleTree[j+i]"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BEGIN",
          "args": [
            "vMerkleTree[j+i]"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::min",
          "args": [
            "i+1",
            "nSize-1"
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vtx.size",
          "args": [],
          "line": 1026
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1691-1695",
          "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  unsigned long size()\n      {\n          LOCK(cs);\n          return mapTx.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vMerkleTree.push_back",
          "args": [
            "tx.GetHash()"
          ],
          "line": 1024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tx.GetHash",
          "args": [],
          "line": 1024
        },
        "resolved": true,
        "details": {
          "function_name": "GetHash",
          "container": "CBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "915-933",
          "snippet": "uint256 GetHash() const {\n        uint256 hashBlock;\n\n        if(!fTestNet && (nTime < 1419062077)) {\n            x15hash((uchar *) &nVersion, (uchar *) &hashBlock);\n        } else {\n            /* 80 + 32 bytes, no padding */\n            uchar input[112];\n            /* Copy the block header */\n            neoscrypt_copy(&input[0], &nVersion, 80);\n            /* Copy the merkle root once again */\n            neoscrypt_copy(&input[80], &hashMerkleRoot, 32);\n            /* Hash the data;\n             * key is higher and lower 10 bytes of merkle root\n             * with nTime, nBits, nNonce in between */\n            neoscrypt_blake2s(&input[0], 112, &input[58], 32, &hashBlock, 32);\n        }\n        return(hashBlock);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  uint256 GetHash() const {\n          uint256 hashBlock;\n  \n          if(!fTestNet && (nTime < 1419062077)) {\n              x15hash((uchar *) &nVersion, (uchar *) &hashBlock);\n          } else {\n              /* 80 + 32 bytes, no padding */\n              uchar input[112];\n              /* Copy the block header */\n              neoscrypt_copy(&input[0], &nVersion, 80);\n              /* Copy the merkle root once again */\n              neoscrypt_copy(&input[80], &hashMerkleRoot, 32);\n              /* Hash the data;\n               * key is higher and lower 10 bytes of merkle root\n               * with nTime, nBits, nNonce in between */\n              neoscrypt_blake2s(&input[0], 112, &input[58], 32, &hashBlock, 32);\n          }\n          return(hashBlock);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vMerkleTree.clear",
          "args": [],
          "line": 1022
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  uint256 BuildMerkleTree() const\n      {\n          vMerkleTree.clear();\n          BOOST_FOREACH(const CTransaction& tx, vtx)\n              vMerkleTree.push_back(tx.GetHash());\n          int j = 0;\n          for (int nSize = vtx.size(); nSize > 1; nSize = (nSize + 1) / 2)\n          {\n              for (int i = 0; i < nSize; i += 2)\n              {\n                  int i2 = std::min(i+1, nSize-1);\n                  vMerkleTree.push_back(Hash(BEGIN(vMerkleTree[j+i]),  END(vMerkleTree[j+i]),\n                                             BEGIN(vMerkleTree[j+i2]), END(vMerkleTree[j+i2])));\n              }\n              j += nSize;\n          }\n          return (vMerkleTree.empty() ? 0 : vMerkleTree.back());\n      }\n}"
  },
  {
    "function_name": "GetMaxTransactionTime",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1012-1018",
    "snippet": "int64_t GetMaxTransactionTime() const\n    {\n        int64_t maxTransactionTime = 0;\n        BOOST_FOREACH(const CTransaction& tx, vtx)\n            maxTransactionTime = std::max(maxTransactionTime, (int64_t)tx.nTime);\n        return maxTransactionTime;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::max",
          "args": [
            "maxTransactionTime",
            "(int64_t)tx.nTime"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  int64_t GetMaxTransactionTime() const\n      {\n          int64_t maxTransactionTime = 0;\n          BOOST_FOREACH(const CTransaction& tx, vtx)\n              maxTransactionTime = std::max(maxTransactionTime, (int64_t)tx.nTime);\n          return maxTransactionTime;\n      }\n}"
  },
  {
    "function_name": "GetProofOfStake",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1006-1009",
    "snippet": "std::pair<COutPoint, unsigned int> GetProofOfStake() const\n    {\n        return IsProofOfStake()? std::make_pair(vtx[1].vin[0].prevout, vtx[1].nTime) : std::make_pair(COutPoint(), (unsigned int)0);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "COutPoint()",
            "(unsigned int)0"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COutPoint",
          "args": [],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "print",
          "container": "COutPoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "252-255",
          "snippet": "void print() const\n    {\n        printf(\"%s\\n\", ToString().c_str());\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCOutPoint {\n  void print() const\n      {\n          printf(\"%s\\n\", ToString().c_str());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "vtx[1].vin[0].prevout",
            "vtx[1].nTime"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsProofOfStake",
          "args": [],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "IsProofOfStake",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1384-1387",
          "snippet": "bool IsProofOfStake() const\n    {\n        return (nFlags & BLOCK_PROOF_OF_STAKE);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool IsProofOfStake() const\n      {\n          return (nFlags & BLOCK_PROOF_OF_STAKE);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  std::pair<COutPoint, unsigned int> GetProofOfStake() const\n      {\n          return IsProofOfStake()? std::make_pair(vtx[1].vin[0].prevout, vtx[1].nTime) : std::make_pair(COutPoint(), (unsigned int)0);\n      }\n}"
  },
  {
    "function_name": "IsProofOfWork",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "1001-1004",
    "snippet": "bool IsProofOfWork() const\n    {\n        return !IsProofOfStake();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsProofOfStake",
          "args": [],
          "line": 1003
        },
        "resolved": true,
        "details": {
          "function_name": "IsProofOfStake",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1384-1387",
          "snippet": "bool IsProofOfStake() const\n    {\n        return (nFlags & BLOCK_PROOF_OF_STAKE);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool IsProofOfStake() const\n      {\n          return (nFlags & BLOCK_PROOF_OF_STAKE);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  bool IsProofOfWork() const\n      {\n          return !IsProofOfStake();\n      }\n}"
  },
  {
    "function_name": "IsProofOfStake",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "996-999",
    "snippet": "bool IsProofOfStake() const\n    {\n        return (vtx.size() > 1 && vtx[1].IsCoinStake());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vtx[1].IsCoinStake",
          "args": [],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinStake",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "542-546",
          "snippet": "bool IsCoinStake() const\n    {\n        // ppcoin: the coin stake transaction is marked with the first output empty\n        return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinStake() const\n      {\n          // ppcoin: the coin stake transaction is marked with the first output empty\n          return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vtx.size",
          "args": [],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1691-1695",
          "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  unsigned long size()\n      {\n          LOCK(cs);\n          return mapTx.size();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  bool IsProofOfStake() const\n      {\n          return (vtx.size() > 1 && vtx[1].IsCoinStake());\n      }\n}"
  },
  {
    "function_name": "GetStakeEntropyBit",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "986-993",
    "snippet": "unsigned int GetStakeEntropyBit() const\n    {\n        // Take last bit of block hash as entropy bit\n        unsigned int nEntropyBit = ((GetHash().Get64()) & 1llu);\n        if (fDebug && GetBoolArg(\"-printstakemodifier\"))\n            printf(\"GetStakeEntropyBit: hashBlock=%s nEntropyBit=%u\\n\", GetHash().ToString().c_str(), nEntropyBit);\n        return nEntropyBit;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"GetStakeEntropyBit: hashBlock=%s nEntropyBit=%u\\n\"",
            "GetHash().ToString().c_str()",
            "nEntropyBit"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetHash",
          "args": [],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "GetHashPoW",
          "container": "CBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "936-952",
          "snippet": "uint256 GetHashPoW() const {\n        uint256 hashPoW;\n        uint profile = 0x0;\n\n        /* All these blocks must be v2+ with valid nHeight */\n        int nHeight = GetBlockHeight();\n\n        /* X15 or NeoScrypt */\n        if(!fTestNet && (nHeight < nForkOne)) {\n            x15hash((uchar *) &nVersion, (uchar *) &hashPoW);\n        } else {\n            profile |= nNeoScryptOptions;\n            neoscrypt((uchar *) &nVersion, (uchar *) &hashPoW, profile);\n        }\n\n        return(hashPoW);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  uint256 GetHashPoW() const {\n          uint256 hashPoW;\n          uint profile = 0x0;\n  \n          /* All these blocks must be v2+ with valid nHeight */\n          int nHeight = GetBlockHeight();\n  \n          /* X15 or NeoScrypt */\n          if(!fTestNet && (nHeight < nForkOne)) {\n              x15hash((uchar *) &nVersion, (uchar *) &hashPoW);\n          } else {\n              profile |= nNeoScryptOptions;\n              neoscrypt((uchar *) &nVersion, (uchar *) &hashPoW, profile);\n          }\n  \n          return(hashPoW);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetBoolArg",
          "args": [
            "\"-printstakemodifier\""
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  unsigned int GetStakeEntropyBit() const\n      {\n          // Take last bit of block hash as entropy bit\n          unsigned int nEntropyBit = ((GetHash().Get64()) & 1llu);\n          if (fDebug && GetBoolArg(\"-printstakemodifier\"))\n              printf(\"GetStakeEntropyBit: hashBlock=%s nEntropyBit=%u\\n\", GetHash().ToString().c_str(), nEntropyBit);\n          return nEntropyBit;\n      }\n}"
  },
  {
    "function_name": "GetBlockTime",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "978-981",
    "snippet": "int64_t GetBlockTime() const\n    {\n        return (int64_t)nTime;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  int64_t GetBlockTime() const\n      {\n          return (int64_t)nTime;\n      }\n}"
  },
  {
    "function_name": "GetBlockHeight",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "956-976",
    "snippet": "int GetBlockHeight() const {\n        /* Prevents a crash if called on a block header alone */\n        if(vtx.size()) {\n            /* Serialised CScript */\n            std::vector<uchar>::const_iterator scriptsig = vtx[0].vin[0].scriptSig.begin();\n            uchar i, scount = scriptsig[0];\n            /* Optimise: nTime is 4 bytes always,\n             * nHeight must be less for a long time;\n             * check against a threshold when the time comes */\n            if(scount < 4) {\n                int height = 0;\n                uchar *pheight = (uchar *) &height;\n                for(i = 0; i < scount; i++)\n                  pheight[i] = scriptsig[i + 1];\n                /* v2+ block with nHeight in coin base */\n                return(height);\n            }\n        }\n        /* Not found */\n        return(-1);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vtx[0].vin[0].scriptSig.begin",
          "args": [],
          "line": 960
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vtx.size",
          "args": [],
          "line": 958
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1691-1695",
          "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  unsigned long size()\n      {\n          LOCK(cs);\n          return mapTx.size();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  int GetBlockHeight() const {\n          /* Prevents a crash if called on a block header alone */\n          if(vtx.size()) {\n              /* Serialised CScript */\n              std::vector<uchar>::const_iterator scriptsig = vtx[0].vin[0].scriptSig.begin();\n              uchar i, scount = scriptsig[0];\n              /* Optimise: nTime is 4 bytes always,\n               * nHeight must be less for a long time;\n               * check against a threshold when the time comes */\n              if(scount < 4) {\n                  int height = 0;\n                  uchar *pheight = (uchar *) &height;\n                  for(i = 0; i < scount; i++)\n                    pheight[i] = scriptsig[i + 1];\n                  /* v2+ block with nHeight in coin base */\n                  return(height);\n              }\n          }\n          /* Not found */\n          return(-1);\n      }\n}"
  },
  {
    "function_name": "GetHashPoW",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "936-952",
    "snippet": "uint256 GetHashPoW() const {\n        uint256 hashPoW;\n        uint profile = 0x0;\n\n        /* All these blocks must be v2+ with valid nHeight */\n        int nHeight = GetBlockHeight();\n\n        /* X15 or NeoScrypt */\n        if(!fTestNet && (nHeight < nForkOne)) {\n            x15hash((uchar *) &nVersion, (uchar *) &hashPoW);\n        } else {\n            profile |= nNeoScryptOptions;\n            neoscrypt((uchar *) &nVersion, (uchar *) &hashPoW, profile);\n        }\n\n        return(hashPoW);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "neoscrypt",
          "args": [
            "(uchar *) &nVersion",
            "(uchar *) &hashPoW",
            "profile"
          ],
          "line": 948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "x15hash",
          "args": [
            "(uchar *) &nVersion",
            "(uchar *) &hashPoW"
          ],
          "line": 945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetBlockHeight",
          "args": [],
          "line": 941
        },
        "resolved": true,
        "details": {
          "function_name": "GetBlockHeight",
          "container": "CBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "956-976",
          "snippet": "int GetBlockHeight() const {\n        /* Prevents a crash if called on a block header alone */\n        if(vtx.size()) {\n            /* Serialised CScript */\n            std::vector<uchar>::const_iterator scriptsig = vtx[0].vin[0].scriptSig.begin();\n            uchar i, scount = scriptsig[0];\n            /* Optimise: nTime is 4 bytes always,\n             * nHeight must be less for a long time;\n             * check against a threshold when the time comes */\n            if(scount < 4) {\n                int height = 0;\n                uchar *pheight = (uchar *) &height;\n                for(i = 0; i < scount; i++)\n                  pheight[i] = scriptsig[i + 1];\n                /* v2+ block with nHeight in coin base */\n                return(height);\n            }\n        }\n        /* Not found */\n        return(-1);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  int GetBlockHeight() const {\n          /* Prevents a crash if called on a block header alone */\n          if(vtx.size()) {\n              /* Serialised CScript */\n              std::vector<uchar>::const_iterator scriptsig = vtx[0].vin[0].scriptSig.begin();\n              uchar i, scount = scriptsig[0];\n              /* Optimise: nTime is 4 bytes always,\n               * nHeight must be less for a long time;\n               * check against a threshold when the time comes */\n              if(scount < 4) {\n                  int height = 0;\n                  uchar *pheight = (uchar *) &height;\n                  for(i = 0; i < scount; i++)\n                    pheight[i] = scriptsig[i + 1];\n                  /* v2+ block with nHeight in coin base */\n                  return(height);\n              }\n          }\n          /* Not found */\n          return(-1);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  uint256 GetHashPoW() const {\n          uint256 hashPoW;\n          uint profile = 0x0;\n  \n          /* All these blocks must be v2+ with valid nHeight */\n          int nHeight = GetBlockHeight();\n  \n          /* X15 or NeoScrypt */\n          if(!fTestNet && (nHeight < nForkOne)) {\n              x15hash((uchar *) &nVersion, (uchar *) &hashPoW);\n          } else {\n              profile |= nNeoScryptOptions;\n              neoscrypt((uchar *) &nVersion, (uchar *) &hashPoW, profile);\n          }\n  \n          return(hashPoW);\n      }\n}"
  },
  {
    "function_name": "GetHash",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "915-933",
    "snippet": "uint256 GetHash() const {\n        uint256 hashBlock;\n\n        if(!fTestNet && (nTime < 1419062077)) {\n            x15hash((uchar *) &nVersion, (uchar *) &hashBlock);\n        } else {\n            /* 80 + 32 bytes, no padding */\n            uchar input[112];\n            /* Copy the block header */\n            neoscrypt_copy(&input[0], &nVersion, 80);\n            /* Copy the merkle root once again */\n            neoscrypt_copy(&input[80], &hashMerkleRoot, 32);\n            /* Hash the data;\n             * key is higher and lower 10 bytes of merkle root\n             * with nTime, nBits, nNonce in between */\n            neoscrypt_blake2s(&input[0], 112, &input[58], 32, &hashBlock, 32);\n        }\n        return(hashBlock);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "neoscrypt_blake2s",
          "args": [
            "&input[0]",
            "112",
            "&input[58]",
            "32",
            "&hashBlock",
            "32"
          ],
          "line": 930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "neoscrypt_copy",
          "args": [
            "&input[80]",
            "&hashMerkleRoot",
            "32"
          ],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "neoscrypt_copy",
          "args": [
            "&input[0]",
            "&nVersion",
            "80"
          ],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "x15hash",
          "args": [
            "(uchar *) &nVersion",
            "(uchar *) &hashBlock"
          ],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  uint256 GetHash() const {\n          uint256 hashBlock;\n  \n          if(!fTestNet && (nTime < 1419062077)) {\n              x15hash((uchar *) &nVersion, (uchar *) &hashBlock);\n          } else {\n              /* 80 + 32 bytes, no padding */\n              uchar input[112];\n              /* Copy the block header */\n              neoscrypt_copy(&input[0], &nVersion, 80);\n              /* Copy the merkle root once again */\n              neoscrypt_copy(&input[80], &hashMerkleRoot, 32);\n              /* Hash the data;\n               * key is higher and lower 10 bytes of merkle root\n               * with nTime, nBits, nNonce in between */\n              neoscrypt_blake2s(&input[0], 112, &input[58], 32, &hashBlock, 32);\n          }\n          return(hashBlock);\n      }\n}"
  },
  {
    "function_name": "IsNull",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "909-912",
    "snippet": "bool IsNull() const\n    {\n        return (nBits == 0);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  bool IsNull() const\n      {\n          return (nBits == 0);\n      }\n}"
  },
  {
    "function_name": "SetNull",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "895-907",
    "snippet": "void SetNull()\n    {\n        nVersion = 2;\n        hashPrevBlock = 0;\n        hashMerkleRoot = 0;\n        nTime = 0;\n        nBits = 0;\n        nNonce = 0;\n        vtx.clear();\n        vchBlockSig.clear();\n        vMerkleTree.clear();\n        nDoS = 0;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vMerkleTree.clear",
          "args": [],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  void SetNull()\n      {\n          nVersion = 2;\n          hashPrevBlock = 0;\n          hashMerkleRoot = 0;\n          nTime = 0;\n          nBits = 0;\n          nNonce = 0;\n          vtx.clear();\n          vchBlockSig.clear();\n          vMerkleTree.clear();\n          nDoS = 0;\n      }\n}"
  },
  {
    "function_name": "if",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "888-892",
    "snippet": "else if (fRead)\n        {\n            const_cast<CBlock*>(this)->vtx.clear();\n            const_cast<CBlock*>(this)->vchBlockSig.clear();\n        }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "const_cast<CBlock*>",
          "args": [],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<CBlock*>",
          "args": [
            "this"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<CBlock*>",
          "args": [],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<CBlock*>",
          "args": [
            "this"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  else if (fRead)\n          {\n              const_cast<CBlock*>(this)->vtx.clear();\n              const_cast<CBlock*>(this)->vchBlockSig.clear();\n          }\n}"
  },
  {
    "function_name": "CBlock",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "867-870",
    "snippet": "CBlock()\n    {\n        SetNull();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetNull",
          "args": [],
          "line": 869
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1580-1583",
          "snippet": "void SetNull()\n    {\n        vHave.clear();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void SetNull()\n      {\n          vHave.clear();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  CBlock()\n      {\n          SetNull();\n      }\n}"
  },
  {
    "function_name": "DoS",
    "container": "CBlock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "865-865",
    "snippet": "bool DoS(int nDoSIn, bool fIn) const { nDoS += nDoSIn; return fIn; }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  bool DoS(int nDoSIn, bool fIn) const { nDoS += nDoSIn; return fIn; }\n}"
  },
  {
    "function_name": "IsNull",
    "container": "CTxIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "810-813",
    "snippet": "bool IsNull()\n    {\n        return pos.IsNull();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pos.IsNull",
          "args": [],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "IsNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1585-1588",
          "snippet": "bool IsNull()\n    {\n        return vHave.empty();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  bool IsNull()\n      {\n          return vHave.empty();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxIndex {\n  bool IsNull()\n      {\n          return pos.IsNull();\n      }\n}"
  },
  {
    "function_name": "SetNull",
    "container": "CTxIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "804-808",
    "snippet": "void SetNull()\n    {\n        pos.SetNull();\n        vSpent.clear();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vSpent.clear",
          "args": [],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pos.SetNull",
          "args": [],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1580-1583",
          "snippet": "void SetNull()\n    {\n        vHave.clear();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void SetNull()\n      {\n          vHave.clear();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxIndex {\n  void SetNull()\n      {\n          pos.SetNull();\n          vSpent.clear();\n      }\n}"
  },
  {
    "function_name": "CTxIndex",
    "container": "CTxIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "790-794",
    "snippet": "CTxIndex(const CDiskTxPos& posIn, unsigned int nOutputs)\n    {\n        pos = posIn;\n        vSpent.resize(nOutputs);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vSpent.resize",
          "args": [
            "nOutputs"
          ],
          "line": 793
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxIndex {\n  CTxIndex(const CDiskTxPos& posIn, unsigned int nOutputs)\n      {\n          pos = posIn;\n          vSpent.resize(nOutputs);\n      }\n}"
  },
  {
    "function_name": "CTxIndex",
    "container": "CTxIndex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "785-788",
    "snippet": "CTxIndex()\n    {\n        SetNull();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetNull",
          "args": [],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1580-1583",
          "snippet": "void SetNull()\n    {\n        vHave.clear();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void SetNull()\n      {\n          vHave.clear();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxIndex {\n  CTxIndex()\n      {\n          SetNull();\n      }\n}"
  },
  {
    "function_name": "IsInMainChain",
    "container": "CMerkleTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "766-766",
    "snippet": "bool IsInMainChain() const { return GetDepthInMainChain() > 0; }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetDepthInMainChain",
          "args": [],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "GetDepthInMainChain",
          "container": "CMerkleTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "765-765",
          "snippet": "int GetDepthInMainChain() const { CBlockIndex *pindexRet; return GetDepthInMainChain(pindexRet); }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCMerkleTx {\n  int GetDepthInMainChain() const { CBlockIndex *pindexRet; return GetDepthInMainChain(pindexRet); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCMerkleTx {\n  bool IsInMainChain() const { return GetDepthInMainChain() > 0; }\n}"
  },
  {
    "function_name": "GetDepthInMainChain",
    "container": "CMerkleTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "765-765",
    "snippet": "int GetDepthInMainChain() const { CBlockIndex *pindexRet; return GetDepthInMainChain(pindexRet); }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetDepthInMainChain",
          "args": [
            "pindexRet"
          ],
          "line": 765
        },
        "resolved": true,
        "details": {
          "function_name": "GetDepthInMainChain",
          "container": "CMerkleTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "790-814",
          "snippet": "int CMerkleTx::GetDepthInMainChain(CBlockIndex* &pindexRet) const {\n    bool fTxMempool = mempool.exists(GetHash());\n\n    if((hashBlock == 0) || (nIndex == -1))\n      return(fTxMempool ? 0 : -1);\n\n    // Find the block it claims to be in\n    map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hashBlock);\n    if(mi == mapBlockIndex.end())\n      return(fTxMempool ? 0 : -1);\n\n    CBlockIndex* pindex = (*mi).second;\n    if(!pindex || !pindex->IsInMainChain())\n      return(fTxMempool ? 0 : -1);\n\n    // Make sure the merkle branch connects to this block\n    if(!fMerkleVerified) {\n        if(CBlock::CheckMerkleBranch(GetHash(), vMerkleBranch, nIndex) != pindex->hashMerkleRoot)\n          return(fTxMempool ? 0 : -1);\n        fMerkleVerified = true;\n    }\n\n    pindexRet = pindex;\n    return(pindexBest->nHeight - pindex->nHeight + 1);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCMerkleTx {\n  int GetDepthInMainChain() const { CBlockIndex *pindexRet; return GetDepthInMainChain(pindexRet); }\n}"
  },
  {
    "function_name": "Init",
    "container": "CMerkleTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "740-745",
    "snippet": "void Init()\n    {\n        hashBlock = 0;\n        nIndex = -1;\n        fMerkleVerified = false;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCMerkleTx {\n  void Init()\n      {\n          hashBlock = 0;\n          nIndex = -1;\n          fMerkleVerified = false;\n      }\n}"
  },
  {
    "function_name": "CMerkleTx",
    "container": "CMerkleTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "735-738",
    "snippet": "CMerkleTx(const CTransaction& txIn) : CTransaction(txIn)\n    {\n        Init();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [],
          "line": 737
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "CMerkleTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "740-745",
          "snippet": "void Init()\n    {\n        hashBlock = 0;\n        nIndex = -1;\n        fMerkleVerified = false;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCMerkleTx {\n  void Init()\n      {\n          hashBlock = 0;\n          nIndex = -1;\n          fMerkleVerified = false;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCMerkleTx {\n  CMerkleTx(const CTransaction& txIn) : CTransaction(txIn)\n      {\n          Init();\n      }\n}"
  },
  {
    "function_name": "CMerkleTx",
    "container": "CMerkleTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "730-733",
    "snippet": "CMerkleTx()\n    {\n        Init();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "CMerkleTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "740-745",
          "snippet": "void Init()\n    {\n        hashBlock = 0;\n        nIndex = -1;\n        fMerkleVerified = false;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCMerkleTx {\n  void Init()\n      {\n          hashBlock = 0;\n          nIndex = -1;\n          fMerkleVerified = false;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCMerkleTx {\n  CMerkleTx()\n      {\n          Init();\n      }\n}"
  },
  {
    "function_name": "print",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "667-670",
    "snippet": "void print() const\n    {\n        printf(\"%s\", ToString().c_str());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\"",
            "ToString().c_str()"
          ],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  void print() const\n      {\n          printf(\"%s\", ToString().c_str());\n      }\n}"
  },
  {
    "function_name": "ToString",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "649-665",
    "snippet": "std::string ToString() const\n    {\n        std::string str;\n        str += IsCoinBase()? \"Coinbase\" : (IsCoinStake()? \"Coinstake\" : \"CTransaction\");\n        str += strprintf(\"(hash=%s, nTime=%d, ver=%d, vin.size=%\"PRIszu\", vout.size=%\"PRIszu\", nLockTime=%d)\\n\",\n            GetHash().ToString().substr(0,10).c_str(),\n            nTime,\n            nVersion,\n            vin.size(),\n            vout.size(),\n            nLockTime);\n        for (unsigned int i = 0; i < vin.size(); i++)\n            str += \"    \" + vin[i].ToString() + \"\\n\";\n        for (unsigned int i = 0; i < vout.size(); i++)\n            str += \"    \" + vout[i].ToString() + \"\\n\";\n        return str;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vout[i].ToString",
          "args": [],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vout.size",
          "args": [],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1691-1695",
          "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  unsigned long size()\n      {\n          LOCK(cs);\n          return mapTx.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"(hash=%s, nTime=%d, ver=%d, vin.size=%\"PRIszu\", vout.size=%\"PRIszu\", nLockTime=%d)\\n\"",
            "GetHash().ToString().substr(0,10).c_str()",
            "nTime",
            "nVersion",
            "vin.size()",
            "vout.size()",
            "nLockTime"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetHash",
          "args": [],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "GetHashPoW",
          "container": "CBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "936-952",
          "snippet": "uint256 GetHashPoW() const {\n        uint256 hashPoW;\n        uint profile = 0x0;\n\n        /* All these blocks must be v2+ with valid nHeight */\n        int nHeight = GetBlockHeight();\n\n        /* X15 or NeoScrypt */\n        if(!fTestNet && (nHeight < nForkOne)) {\n            x15hash((uchar *) &nVersion, (uchar *) &hashPoW);\n        } else {\n            profile |= nNeoScryptOptions;\n            neoscrypt((uchar *) &nVersion, (uchar *) &hashPoW, profile);\n        }\n\n        return(hashPoW);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  uint256 GetHashPoW() const {\n          uint256 hashPoW;\n          uint profile = 0x0;\n  \n          /* All these blocks must be v2+ with valid nHeight */\n          int nHeight = GetBlockHeight();\n  \n          /* X15 or NeoScrypt */\n          if(!fTestNet && (nHeight < nForkOne)) {\n              x15hash((uchar *) &nVersion, (uchar *) &hashPoW);\n          } else {\n              profile |= nNeoScryptOptions;\n              neoscrypt((uchar *) &nVersion, (uchar *) &hashPoW, profile);\n          }\n  \n          return(hashPoW);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetHash",
          "args": [
            "0",
            "10"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsCoinStake",
          "args": [],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinStake",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "542-546",
          "snippet": "bool IsCoinStake() const\n    {\n        // ppcoin: the coin stake transaction is marked with the first output empty\n        return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinStake() const\n      {\n          // ppcoin: the coin stake transaction is marked with the first output empty\n          return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsCoinBase",
          "args": [],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinBase",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "537-540",
          "snippet": "bool IsCoinBase() const\n    {\n        return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinBase() const\n      {\n          return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  std::string ToString() const\n      {\n          std::string str;\n          str += IsCoinBase()? \"Coinbase\" : (IsCoinStake()? \"Coinstake\" : \"CTransaction\");\n          str += strprintf(\"(hash=%s, nTime=%d, ver=%d, vin.size=%\"PRIszu\", vout.size=%\"PRIszu\", nLockTime=%d)\\n\",\n              GetHash().ToString().substr(0,10).c_str(),\n              nTime,\n              nVersion,\n              vin.size(),\n              vout.size(),\n              nLockTime);\n          for (unsigned int i = 0; i < vin.size(); i++)\n              str += \"    \" + vin[i].ToString() + \"\\n\";\n          for (unsigned int i = 0; i < vout.size(); i++)\n              str += \"    \" + vout[i].ToString() + \"\\n\";\n          return str;\n      }\n}"
  },
  {
    "function_name": "ToStringShort",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "642-647",
    "snippet": "std::string ToStringShort() const\n    {\n        std::string str;\n        str += strprintf(\"%s %s\", GetHash().ToString().c_str(), IsCoinBase()? \"base\" : (IsCoinStake()? \"stake\" : \"user\"));\n        return str;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"%s %s\"",
            "GetHash().ToString().c_str()",
            "IsCoinBase()? \"base\" : (IsCoinStake()? \"stake\" : \"user\")"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsCoinStake",
          "args": [],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinStake",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "542-546",
          "snippet": "bool IsCoinStake() const\n    {\n        // ppcoin: the coin stake transaction is marked with the first output empty\n        return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinStake() const\n      {\n          // ppcoin: the coin stake transaction is marked with the first output empty\n          return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsCoinBase",
          "args": [],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinBase",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "537-540",
          "snippet": "bool IsCoinBase() const\n    {\n        return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinBase() const\n      {\n          return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetHash",
          "args": [],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "GetHashPoW",
          "container": "CBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "936-952",
          "snippet": "uint256 GetHashPoW() const {\n        uint256 hashPoW;\n        uint profile = 0x0;\n\n        /* All these blocks must be v2+ with valid nHeight */\n        int nHeight = GetBlockHeight();\n\n        /* X15 or NeoScrypt */\n        if(!fTestNet && (nHeight < nForkOne)) {\n            x15hash((uchar *) &nVersion, (uchar *) &hashPoW);\n        } else {\n            profile |= nNeoScryptOptions;\n            neoscrypt((uchar *) &nVersion, (uchar *) &hashPoW, profile);\n        }\n\n        return(hashPoW);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlock {\n  uint256 GetHashPoW() const {\n          uint256 hashPoW;\n          uint profile = 0x0;\n  \n          /* All these blocks must be v2+ with valid nHeight */\n          int nHeight = GetBlockHeight();\n  \n          /* X15 or NeoScrypt */\n          if(!fTestNet && (nHeight < nForkOne)) {\n              x15hash((uchar *) &nVersion, (uchar *) &hashPoW);\n          } else {\n              profile |= nNeoScryptOptions;\n              neoscrypt((uchar *) &nVersion, (uchar *) &hashPoW, profile);\n          }\n  \n          return(hashPoW);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  std::string ToStringShort() const\n      {\n          std::string str;\n          str += strprintf(\"%s %s\", GetHash().ToString().c_str(), IsCoinBase()? \"base\" : (IsCoinStake()? \"stake\" : \"user\"));\n          return str;\n      }\n}"
  },
  {
    "function_name": "ReadFromDisk",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "601-626",
    "snippet": "bool ReadFromDisk(CDiskTxPos pos, FILE** pfileRet=NULL)\n    {\n        CAutoFile filein = CAutoFile(OpenBlockFile(pos.nFile, 0, pfileRet ? \"rb+\" : \"rb\"), SER_DISK, CLIENT_VERSION);\n        if (!filein)\n            return error(\"CTransaction::ReadFromDisk() : OpenBlockFile failed\");\n\n        // Read transaction\n        if (fseek(filein, pos.nTxPos, SEEK_SET) != 0)\n            return error(\"CTransaction::ReadFromDisk() : fseek failed\");\n\n        try {\n            filein >> *this;\n        }\n        catch (std::exception &e) {\n            return error(\"%s() : deserialize or I/O error\", __PRETTY_FUNCTION__);\n        }\n\n        // Return file pointer\n        if (pfileRet)\n        {\n            if (fseek(filein, pos.nTxPos, SEEK_SET) != 0)\n                return error(\"CTransaction::ReadFromDisk() : second fseek failed\");\n            *pfileRet = filein.release();\n        }\n        return true;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "filein.release",
          "args": [],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"CTransaction::ReadFromDisk() : second fseek failed\""
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "key_error",
          "container": "key_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "44-44",
          "snippet": "explicit key_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nkey_error {\n  explicit key_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fseek",
          "args": [
            "filein",
            "pos.nTxPos",
            "SEEK_SET"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"%s() : deserialize or I/O error\"",
            "__PRETTY_FUNCTION__"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "leveldb_options_set_error_if_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "411-414",
          "snippet": "void leveldb_options_set_error_if_exists(\n    leveldb_options_t* opt, unsigned char v) {\n  opt->rep.error_if_exists = v;\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_error_if_exists(\n    leveldb_options_t* opt, unsigned char v) {\n  opt->rep.error_if_exists = v;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fseek",
          "args": [
            "filein",
            "pos.nTxPos",
            "SEEK_SET"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CAutoFile",
          "args": [
            "OpenBlockFile(pos.nFile, 0, pfileRet ? \"rb+\" : \"rb\")",
            "SER_DISK",
            "CLIENT_VERSION"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "CAutoFile",
          "container": "CAutoFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "1037-1044",
          "snippet": "CAutoFile(FILE* filenew, int nTypeIn, int nVersionIn)\n    {\n        file = filenew;\n        nType = nTypeIn;\n        nVersion = nVersionIn;\n        state = 0;\n        exceptmask = std::ios::badbit | std::ios::failbit;\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCAutoFile {\n  CAutoFile(FILE* filenew, int nTypeIn, int nVersionIn)\n      {\n          file = filenew;\n          nType = nTypeIn;\n          nVersion = nVersionIn;\n          state = 0;\n          exceptmask = std::ios::badbit | std::ios::failbit;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "OpenBlockFile",
          "args": [
            "pos.nFile",
            "0",
            "pfileRet ? \"rb+\" : \"rb\""
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool ReadFromDisk(CDiskTxPos pos, FILE** pfileRet=NULL)\n      {\n          CAutoFile filein = CAutoFile(OpenBlockFile(pos.nFile, 0, pfileRet ? \"rb+\" : \"rb\"), SER_DISK, CLIENT_VERSION);\n          if (!filein)\n              return error(\"CTransaction::ReadFromDisk() : OpenBlockFile failed\");\n  \n          // Read transaction\n          if (fseek(filein, pos.nTxPos, SEEK_SET) != 0)\n              return error(\"CTransaction::ReadFromDisk() : fseek failed\");\n  \n          try {\n              filein >> *this;\n          }\n          catch (std::exception &e) {\n              return error(\"%s() : deserialize or I/O error\", __PRETTY_FUNCTION__);\n          }\n  \n          // Return file pointer\n          if (pfileRet)\n          {\n              if (fseek(filein, pos.nTxPos, SEEK_SET) != 0)\n                  return error(\"CTransaction::ReadFromDisk() : second fseek failed\");\n              *pfileRet = filein.release();\n          }\n          return true;\n      }\n}"
  },
  {
    "function_name": "GetValueOut",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "577-587",
    "snippet": "int64_t GetValueOut() const\n    {\n        int64_t nValueOut = 0;\n        BOOST_FOREACH(const CTxOut& txout, vout)\n        {\n            nValueOut += txout.nValue;\n            if (!MoneyRange(txout.nValue) || !MoneyRange(nValueOut))\n                throw std::runtime_error(\"CTransaction::GetValueOut() : value out of range\");\n        }\n        return nValueOut;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"CTransaction::GetValueOut() : value out of range\""
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MoneyRange",
          "args": [
            "nValueOut"
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "MoneyRange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "48-48",
          "snippet": "inline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\ninline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  int64_t GetValueOut() const\n      {\n          int64_t nValueOut = 0;\n          BOOST_FOREACH(const CTxOut& txout, vout)\n          {\n              nValueOut += txout.nValue;\n              if (!MoneyRange(txout.nValue) || !MoneyRange(nValueOut))\n                  throw std::runtime_error(\"CTransaction::GetValueOut() : value out of range\");\n          }\n          return nValueOut;\n      }\n}"
  },
  {
    "function_name": "IsCoinStake",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "542-546",
    "snippet": "bool IsCoinStake() const\n    {\n        // ppcoin: the coin stake transaction is marked with the first output empty\n        return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vout[0].IsEmpty",
          "args": [],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "IsEmpty",
          "container": "CTxOut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "387-390",
          "snippet": "bool IsEmpty() const\n    {\n        return (nValue == 0 && scriptPubKey.empty());\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxOut {\n  bool IsEmpty() const\n      {\n          return (nValue == 0 && scriptPubKey.empty());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vout.size",
          "args": [],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1691-1695",
          "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  unsigned long size()\n      {\n          LOCK(cs);\n          return mapTx.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vin[0].prevout.IsNull",
          "args": [],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "IsNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1585-1588",
          "snippet": "bool IsNull()\n    {\n        return vHave.empty();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  bool IsNull()\n      {\n          return vHave.empty();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinStake() const\n      {\n          // ppcoin: the coin stake transaction is marked with the first output empty\n          return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n      }\n}"
  },
  {
    "function_name": "IsCoinBase",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "537-540",
    "snippet": "bool IsCoinBase() const\n    {\n        return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vout.size",
          "args": [],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1691-1695",
          "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  unsigned long size()\n      {\n          LOCK(cs);\n          return mapTx.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vin[0].prevout.IsNull",
          "args": [],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "IsNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1585-1588",
          "snippet": "bool IsNull()\n    {\n        return vHave.empty();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  bool IsNull()\n      {\n          return vHave.empty();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinBase() const\n      {\n          return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n      }\n}"
  },
  {
    "function_name": "IsNewerThan",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "508-535",
    "snippet": "bool IsNewerThan(const CTransaction& old) const\n    {\n        if (vin.size() != old.vin.size())\n            return false;\n        for (unsigned int i = 0; i < vin.size(); i++)\n            if (vin[i].prevout != old.vin[i].prevout)\n                return false;\n\n        bool fNewer = false;\n        unsigned int nLowest = std::numeric_limits<unsigned int>::max();\n        for (unsigned int i = 0; i < vin.size(); i++)\n        {\n            if (vin[i].nSequence != old.vin[i].nSequence)\n            {\n                if (vin[i].nSequence <= nLowest)\n                {\n                    fNewer = false;\n                    nLowest = vin[i].nSequence;\n                }\n                if (old.vin[i].nSequence < nLowest)\n                {\n                    fNewer = true;\n                    nLowest = old.vin[i].nSequence;\n                }\n            }\n        }\n        return fNewer;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vin.size",
          "args": [],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1691-1695",
          "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  unsigned long size()\n      {\n          LOCK(cs);\n          return mapTx.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::numeric_limits<unsigned int>::max",
          "args": [],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsNewerThan(const CTransaction& old) const\n      {\n          if (vin.size() != old.vin.size())\n              return false;\n          for (unsigned int i = 0; i < vin.size(); i++)\n              if (vin[i].prevout != old.vin[i].prevout)\n                  return false;\n  \n          bool fNewer = false;\n          unsigned int nLowest = std::numeric_limits<unsigned int>::max();\n          for (unsigned int i = 0; i < vin.size(); i++)\n          {\n              if (vin[i].nSequence != old.vin[i].nSequence)\n              {\n                  if (vin[i].nSequence <= nLowest)\n                  {\n                      fNewer = false;\n                      nLowest = vin[i].nSequence;\n                  }\n                  if (old.vin[i].nSequence < nLowest)\n                  {\n                      fNewer = true;\n                      nLowest = old.vin[i].nSequence;\n                  }\n              }\n          }\n          return fNewer;\n      }\n}"
  },
  {
    "function_name": "IsFinal",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "491-506",
    "snippet": "bool IsFinal(int nBlockHeight=0, int64_t nBlockTime=0) const\n    {\n        // Time based nLockTime implemented in 0.1.6\n        if (nLockTime == 0)\n            return true;\n        if (nBlockHeight == 0)\n            nBlockHeight = nBestHeight;\n        if (nBlockTime == 0)\n            nBlockTime = GetAdjustedTime();\n        if ((int64_t)nLockTime < ((int64_t)nLockTime < LOCKTIME_THRESHOLD ? (int64_t)nBlockHeight : nBlockTime))\n            return true;\n        BOOST_FOREACH(const CTxIn& txin, vin)\n            if (!txin.IsFinal())\n                return false;\n        return true;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "txin.IsFinal",
          "args": [],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "IsFinal",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "491-506",
          "snippet": "bool IsFinal(int nBlockHeight=0, int64_t nBlockTime=0) const\n    {\n        // Time based nLockTime implemented in 0.1.6\n        if (nLockTime == 0)\n            return true;\n        if (nBlockHeight == 0)\n            nBlockHeight = nBestHeight;\n        if (nBlockTime == 0)\n            nBlockTime = GetAdjustedTime();\n        if ((int64_t)nLockTime < ((int64_t)nLockTime < LOCKTIME_THRESHOLD ? (int64_t)nBlockHeight : nBlockTime))\n            return true;\n        BOOST_FOREACH(const CTxIn& txin, vin)\n            if (!txin.IsFinal())\n                return false;\n        return true;\n    }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "GetAdjustedTime",
          "args": [],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "GetAdjustedTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1201-1214",
          "snippet": "int64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern int64 nNtpOffset;",
            "int64 nPeersOffset = INT64_MAX;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nextern int64 nNtpOffset;\nint64 nPeersOffset = INT64_MAX;\n\nint64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsFinal(int nBlockHeight=0, int64_t nBlockTime=0) const\n      {\n          // Time based nLockTime implemented in 0.1.6\n          if (nLockTime == 0)\n              return true;\n          if (nBlockHeight == 0)\n              nBlockHeight = nBestHeight;\n          if (nBlockTime == 0)\n              nBlockTime = GetAdjustedTime();\n          if ((int64_t)nLockTime < ((int64_t)nLockTime < LOCKTIME_THRESHOLD ? (int64_t)nBlockHeight : nBlockTime))\n              return true;\n          BOOST_FOREACH(const CTxIn& txin, vin)\n              if (!txin.IsFinal())\n                  return false;\n          return true;\n      }\n}"
  },
  {
    "function_name": "GetHash",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "486-489",
    "snippet": "uint256 GetHash() const\n    {\n        return SerializeHash(*this);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SerializeHash",
          "args": [
            "*this"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "SerializeHash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "547-552",
          "snippet": "uint256 SerializeHash(const T& obj, int nType=SER_GETHASH, int nVersion=PROTOCOL_VERSION)\n{\n    CHashWriter ss(nType, nVersion);\n    ss << obj;\n    return ss.GetHash();\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nuint256 SerializeHash(const T& obj, int nType=SER_GETHASH, int nVersion=PROTOCOL_VERSION)\n{\n    CHashWriter ss(nType, nVersion);\n    ss << obj;\n    return ss.GetHash();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  uint256 GetHash() const\n      {\n          return SerializeHash(*this);\n      }\n}"
  },
  {
    "function_name": "IsNull",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "481-484",
    "snippet": "bool IsNull() const\n    {\n        return (vin.empty() && vout.empty());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vout.empty",
          "args": [],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsNull() const\n      {\n          return (vin.empty() && vout.empty());\n      }\n}"
  },
  {
    "function_name": "SetNull",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "471-479",
    "snippet": "void SetNull()\n    {\n        nVersion = CTransaction::CURRENT_VERSION;\n        nTime = GetAdjustedTime();\n        vin.clear();\n        vout.clear();\n        nLockTime = 0;\n        nDoS = 0;  // Denial-of-service prevention\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vout.clear",
          "args": [],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetAdjustedTime",
          "args": [],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "GetAdjustedTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1201-1214",
          "snippet": "int64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern int64 nNtpOffset;",
            "int64 nPeersOffset = INT64_MAX;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nextern int64 nNtpOffset;\nint64 nPeersOffset = INT64_MAX;\n\nint64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  void SetNull()\n      {\n          nVersion = CTransaction::CURRENT_VERSION;\n          nTime = GetAdjustedTime();\n          vin.clear();\n          vout.clear();\n          nLockTime = 0;\n          nDoS = 0;  // Denial-of-service prevention\n      }\n}"
  },
  {
    "function_name": "CTransaction",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "456-459",
    "snippet": "CTransaction()\n    {\n        SetNull();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetNull",
          "args": [],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1580-1583",
          "snippet": "void SetNull()\n    {\n        vHave.clear();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void SetNull()\n      {\n          vHave.clear();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  CTransaction()\n      {\n          SetNull();\n      }\n}"
  },
  {
    "function_name": "DoS",
    "container": "CTransaction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "454-454",
    "snippet": "bool DoS(int nDoSIn, bool fIn) const { nDoS += nDoSIn; return fIn; }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool DoS(int nDoSIn, bool fIn) const { nDoS += nDoSIn; return fIn; }\n}"
  },
  {
    "function_name": "print",
    "container": "CTxOut",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "421-424",
    "snippet": "void print() const\n    {\n        printf(\"%s\\n\", ToString().c_str());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "ToString().c_str()"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxOut {\n  void print() const\n      {\n          printf(\"%s\\n\", ToString().c_str());\n      }\n}"
  },
  {
    "function_name": "ToString",
    "container": "CTxOut",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "413-419",
    "snippet": "std::string ToString() const\n    {\n        if (IsEmpty()) return \"CTxOut(empty)\";\n        if (scriptPubKey.size() < 6)\n            return \"CTxOut(error)\";\n        return strprintf(\"CTxOut(nValue=%s, scriptPubKey=%s)\", FormatMoney(nValue).c_str(), scriptPubKey.ToString().c_str());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"CTxOut(nValue=%s, scriptPubKey=%s)\"",
            "FormatMoney(nValue).c_str()",
            "scriptPubKey.ToString().c_str()"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scriptPubKey.ToString",
          "args": [],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FormatMoney",
          "args": [],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatMoney",
          "args": [
            "nValue"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scriptPubKey.size",
          "args": [],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1691-1695",
          "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  unsigned long size()\n      {\n          LOCK(cs);\n          return mapTx.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsEmpty",
          "args": [],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "IsEmpty",
          "container": "CTxOut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "387-390",
          "snippet": "bool IsEmpty() const\n    {\n        return (nValue == 0 && scriptPubKey.empty());\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxOut {\n  bool IsEmpty() const\n      {\n          return (nValue == 0 && scriptPubKey.empty());\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxOut {\n  std::string ToString() const\n      {\n          if (IsEmpty()) return \"CTxOut(empty)\";\n          if (scriptPubKey.size() < 6)\n              return \"CTxOut(error)\";\n          return strprintf(\"CTxOut(nValue=%s, scriptPubKey=%s)\", FormatMoney(nValue).c_str(), scriptPubKey.ToString().c_str());\n      }\n}"
  },
  {
    "function_name": "ToStringShort",
    "container": "CTxOut",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "408-411",
    "snippet": "std::string ToStringShort() const\n    {\n        return strprintf(\" out %s %s\", FormatMoney(nValue).c_str(), scriptPubKey.ToString(true).c_str());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\" out %s %s\"",
            "FormatMoney(nValue).c_str()",
            "scriptPubKey.ToString(true).c_str()"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scriptPubKey.ToString",
          "args": [],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "scriptPubKey.ToString",
          "args": [
            "true"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "604-610",
          "snippet": "std::string ToString(const Iterator* it) {\n    if (!it->Valid()) {\n      return \"END\";\n    } else {\n      return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string ToString(const Iterator* it) {\n      if (!it->Valid()) {\n        return \"END\";\n      } else {\n        return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FormatMoney",
          "args": [],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatMoney",
          "args": [
            "nValue"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxOut {\n  std::string ToStringShort() const\n      {\n          return strprintf(\" out %s %s\", FormatMoney(nValue).c_str(), scriptPubKey.ToString(true).c_str());\n      }\n}"
  },
  {
    "function_name": "GetHash",
    "container": "CTxOut",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "392-395",
    "snippet": "uint256 GetHash() const\n    {\n        return SerializeHash(*this);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SerializeHash",
          "args": [
            "*this"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "SerializeHash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "547-552",
          "snippet": "uint256 SerializeHash(const T& obj, int nType=SER_GETHASH, int nVersion=PROTOCOL_VERSION)\n{\n    CHashWriter ss(nType, nVersion);\n    ss << obj;\n    return ss.GetHash();\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nuint256 SerializeHash(const T& obj, int nType=SER_GETHASH, int nVersion=PROTOCOL_VERSION)\n{\n    CHashWriter ss(nType, nVersion);\n    ss << obj;\n    return ss.GetHash();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxOut {\n  uint256 GetHash() const\n      {\n          return SerializeHash(*this);\n      }\n}"
  },
  {
    "function_name": "IsEmpty",
    "container": "CTxOut",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "387-390",
    "snippet": "bool IsEmpty() const\n    {\n        return (nValue == 0 && scriptPubKey.empty());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scriptPubKey.empty",
          "args": [],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxOut {\n  bool IsEmpty() const\n      {\n          return (nValue == 0 && scriptPubKey.empty());\n      }\n}"
  },
  {
    "function_name": "SetEmpty",
    "container": "CTxOut",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "381-385",
    "snippet": "void SetEmpty()\n    {\n        nValue = 0;\n        scriptPubKey.clear();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scriptPubKey.clear",
          "args": [],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxOut {\n  void SetEmpty()\n      {\n          nValue = 0;\n          scriptPubKey.clear();\n      }\n}"
  },
  {
    "function_name": "IsNull",
    "container": "CTxOut",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "376-379",
    "snippet": "bool IsNull()\n    {\n        return (nValue == -1);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxOut {\n  bool IsNull()\n      {\n          return (nValue == -1);\n      }\n}"
  },
  {
    "function_name": "SetNull",
    "container": "CTxOut",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "370-374",
    "snippet": "void SetNull()\n    {\n        nValue = -1;\n        scriptPubKey.clear();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scriptPubKey.clear",
          "args": [],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxOut {\n  void SetNull()\n      {\n          nValue = -1;\n          scriptPubKey.clear();\n      }\n}"
  },
  {
    "function_name": "CTxOut",
    "container": "CTxOut",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "358-362",
    "snippet": "CTxOut(int64_t nValueIn, CScript scriptPubKeyIn)\n    {\n        nValue = nValueIn;\n        scriptPubKey = scriptPubKeyIn;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxOut {\n  CTxOut(int64_t nValueIn, CScript scriptPubKeyIn)\n      {\n          nValue = nValueIn;\n          scriptPubKey = scriptPubKeyIn;\n      }\n}"
  },
  {
    "function_name": "CTxOut",
    "container": "CTxOut",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "353-356",
    "snippet": "CTxOut()\n    {\n        SetNull();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetNull",
          "args": [],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1580-1583",
          "snippet": "void SetNull()\n    {\n        vHave.clear();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void SetNull()\n      {\n          vHave.clear();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxOut {\n  CTxOut()\n      {\n          SetNull();\n      }\n}"
  },
  {
    "function_name": "print",
    "container": "CTxIn",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "335-338",
    "snippet": "void print() const\n    {\n        printf(\"%s\\n\", ToString().c_str());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "ToString().c_str()"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxIn {\n  void print() const\n      {\n          printf(\"%s\\n\", ToString().c_str());\n      }\n}"
  },
  {
    "function_name": "ToString",
    "container": "CTxIn",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "320-333",
    "snippet": "std::string ToString() const\n    {\n        std::string str;\n        str += \"CTxIn(\";\n        str += prevout.ToString();\n        if (prevout.IsNull())\n            str += strprintf(\", coinbase %s\", HexStr(scriptSig).c_str());\n        else\n            str += strprintf(\", scriptSig=%s\", scriptSig.ToString().substr(0,24).c_str());\n        if (nSequence != std::numeric_limits<unsigned int>::max())\n            str += strprintf(\", nSequence=%u\", nSequence);\n        str += \")\";\n        return str;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\", nSequence=%u\"",
            "nSequence"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::numeric_limits<unsigned int>::max",
          "args": [],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scriptSig.ToString",
          "args": [],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "scriptSig.ToString",
          "args": [
            "0",
            "24"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "595-602",
          "snippet": "std::string ToString(const KVMap& data,\n                       const KVMap::const_reverse_iterator& it) {\n    if (it == data.rend()) {\n      return \"END\";\n    } else {\n      return \"'\" + it->first + \"->\" + it->second + \"'\";\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string ToString(const KVMap& data,\n                         const KVMap::const_reverse_iterator& it) {\n      if (it == data.rend()) {\n        return \"END\";\n      } else {\n        return \"'\" + it->first + \"->\" + it->second + \"'\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "HexStr",
          "args": [],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HexStr",
          "args": [
            "scriptSig"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "HexStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "341-344",
          "snippet": "inline std::string HexStr(const std::vector<unsigned char>& vch, bool fSpaces=false)\n{\n    return HexStr(vch.begin(), vch.end(), fSpaces);\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline std::string HexStr(const std::vector<unsigned char>& vch, bool fSpaces=false)\n{\n    return HexStr(vch.begin(), vch.end(), fSpaces);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prevout.IsNull",
          "args": [],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "IsNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1585-1588",
          "snippet": "bool IsNull()\n    {\n        return vHave.empty();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  bool IsNull()\n      {\n          return vHave.empty();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxIn {\n  std::string ToString() const\n      {\n          std::string str;\n          str += \"CTxIn(\";\n          str += prevout.ToString();\n          if (prevout.IsNull())\n              str += strprintf(\", coinbase %s\", HexStr(scriptSig).c_str());\n          else\n              str += strprintf(\", scriptSig=%s\", scriptSig.ToString().substr(0,24).c_str());\n          if (nSequence != std::numeric_limits<unsigned int>::max())\n              str += strprintf(\", nSequence=%u\", nSequence);\n          str += \")\";\n          return str;\n      }\n}"
  },
  {
    "function_name": "ToStringShort",
    "container": "CTxIn",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "315-318",
    "snippet": "std::string ToStringShort() const\n    {\n        return strprintf(\" %s %d\", prevout.hash.ToString().c_str(), prevout.n);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\" %s %d\"",
            "prevout.hash.ToString().c_str()",
            "prevout.n"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prevout.hash.ToString",
          "args": [],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxIn {\n  std::string ToStringShort() const\n      {\n          return strprintf(\" %s %d\", prevout.hash.ToString().c_str(), prevout.n);\n      }\n}"
  },
  {
    "function_name": "IsFinal",
    "container": "CTxIn",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "298-301",
    "snippet": "bool IsFinal() const\n    {\n        return (nSequence == std::numeric_limits<unsigned int>::max());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::numeric_limits<unsigned int>::max",
          "args": [],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxIn {\n  bool IsFinal() const\n      {\n          return (nSequence == std::numeric_limits<unsigned int>::max());\n      }\n}"
  },
  {
    "function_name": "CTxIn",
    "container": "CTxIn",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "284-289",
    "snippet": "CTxIn(uint256 hashPrevTx, unsigned int nOut, CScript scriptSigIn=CScript(), unsigned int nSequenceIn=std::numeric_limits<unsigned int>::max())\n    {\n        prevout = COutPoint(hashPrevTx, nOut);\n        scriptSig = scriptSigIn;\n        nSequence = nSequenceIn;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "COutPoint",
          "args": [
            "hashPrevTx",
            "nOut"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "COutPoint",
          "container": "COutPoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "227-227",
          "snippet": "COutPoint(uint256 hashIn, unsigned int nIn) { hash = hashIn; n = nIn; }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCOutPoint {\n  COutPoint(uint256 hashIn, unsigned int nIn) { hash = hashIn; n = nIn; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::numeric_limits<unsigned int>::max",
          "args": [],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CScript",
          "args": [],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "CScriptID",
          "container": "CScriptID",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "59-59",
          "snippet": "CScriptID() : uint160(0) { }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCScriptID {\n  CScriptID() : uint160(0) { }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxIn {\n  CTxIn(uint256 hashPrevTx, unsigned int nOut, CScript scriptSigIn=CScript(), unsigned int nSequenceIn=std::numeric_limits<unsigned int>::max())\n      {\n          prevout = COutPoint(hashPrevTx, nOut);\n          scriptSig = scriptSigIn;\n          nSequence = nSequenceIn;\n      }\n}"
  },
  {
    "function_name": "CTxIn",
    "container": "CTxIn",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "277-282",
    "snippet": "explicit CTxIn(COutPoint prevoutIn, CScript scriptSigIn=CScript(), unsigned int nSequenceIn=std::numeric_limits<unsigned int>::max())\n    {\n        prevout = prevoutIn;\n        scriptSig = scriptSigIn;\n        nSequence = nSequenceIn;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::numeric_limits<unsigned int>::max",
          "args": [],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CScript",
          "args": [],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "CScriptID",
          "container": "CScriptID",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "59-59",
          "snippet": "CScriptID() : uint160(0) { }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCScriptID {\n  CScriptID() : uint160(0) { }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxIn {\n  explicit CTxIn(COutPoint prevoutIn, CScript scriptSigIn=CScript(), unsigned int nSequenceIn=std::numeric_limits<unsigned int>::max())\n      {\n          prevout = prevoutIn;\n          scriptSig = scriptSigIn;\n          nSequence = nSequenceIn;\n      }\n}"
  },
  {
    "function_name": "CTxIn",
    "container": "CTxIn",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "272-275",
    "snippet": "CTxIn()\n    {\n        nSequence = std::numeric_limits<unsigned int>::max();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::numeric_limits<unsigned int>::max",
          "args": [],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxIn {\n  CTxIn()\n      {\n          nSequence = std::numeric_limits<unsigned int>::max();\n      }\n}"
  },
  {
    "function_name": "print",
    "container": "COutPoint",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "252-255",
    "snippet": "void print() const\n    {\n        printf(\"%s\\n\", ToString().c_str());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "ToString().c_str()"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCOutPoint {\n  void print() const\n      {\n          printf(\"%s\\n\", ToString().c_str());\n      }\n}"
  },
  {
    "function_name": "ToString",
    "container": "COutPoint",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "247-250",
    "snippet": "std::string ToString() const\n    {\n        return strprintf(\"COutPoint(%s, %u)\", hash.ToString().substr(0,10).c_str(), n);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"COutPoint(%s, %u)\"",
            "hash.ToString().substr(0,10).c_str()",
            "n"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.ToString",
          "args": [],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.ToString",
          "args": [
            "0",
            "10"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "595-602",
          "snippet": "std::string ToString(const KVMap& data,\n                       const KVMap::const_reverse_iterator& it) {\n    if (it == data.rend()) {\n      return \"END\";\n    } else {\n      return \"'\" + it->first + \"->\" + it->second + \"'\";\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string ToString(const KVMap& data,\n                         const KVMap::const_reverse_iterator& it) {\n      if (it == data.rend()) {\n        return \"END\";\n      } else {\n        return \"'\" + it->first + \"->\" + it->second + \"'\";\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCOutPoint {\n  std::string ToString() const\n      {\n          return strprintf(\"COutPoint(%s, %u)\", hash.ToString().substr(0,10).c_str(), n);\n      }\n}"
  },
  {
    "function_name": "IsNull",
    "container": "COutPoint",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "230-230",
    "snippet": "bool IsNull() const { return (hash == 0 && n == (unsigned int) -1); }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCOutPoint {\n  bool IsNull() const { return (hash == 0 && n == (unsigned int) -1); }\n}"
  },
  {
    "function_name": "SetNull",
    "container": "COutPoint",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "229-229",
    "snippet": "void SetNull() { hash = 0; n = (unsigned int) -1; }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCOutPoint {\n  void SetNull() { hash = 0; n = (unsigned int) -1; }\n}"
  },
  {
    "function_name": "COutPoint",
    "container": "COutPoint",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "227-227",
    "snippet": "COutPoint(uint256 hashIn, unsigned int nIn) { hash = hashIn; n = nIn; }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCOutPoint {\n  COutPoint(uint256 hashIn, unsigned int nIn) { hash = hashIn; n = nIn; }\n}"
  },
  {
    "function_name": "COutPoint",
    "container": "COutPoint",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "226-226",
    "snippet": "COutPoint() { SetNull(); }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetNull",
          "args": [],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1580-1583",
          "snippet": "void SetNull()\n    {\n        vHave.clear();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void SetNull()\n      {\n          vHave.clear();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCOutPoint {\n  COutPoint() { SetNull(); }\n}"
  },
  {
    "function_name": "IsNull",
    "container": "CInPoint",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "214-214",
    "snippet": "bool IsNull() const { return (ptx == NULL && n == (unsigned int) -1); }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCInPoint {\n  bool IsNull() const { return (ptx == NULL && n == (unsigned int) -1); }\n}"
  },
  {
    "function_name": "SetNull",
    "container": "CInPoint",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "213-213",
    "snippet": "void SetNull() { ptx = NULL; n = (unsigned int) -1; }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCInPoint {\n  void SetNull() { ptx = NULL; n = (unsigned int) -1; }\n}"
  },
  {
    "function_name": "CInPoint",
    "container": "CInPoint",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "212-212",
    "snippet": "CInPoint(CTransaction* ptxIn, unsigned int nIn) { ptx = ptxIn; n = nIn; }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCInPoint {\n  CInPoint(CTransaction* ptxIn, unsigned int nIn) { ptx = ptxIn; n = nIn; }\n}"
  },
  {
    "function_name": "CInPoint",
    "container": "CInPoint",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "211-211",
    "snippet": "CInPoint() { SetNull(); }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetNull",
          "args": [],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1580-1583",
          "snippet": "void SetNull()\n    {\n        vHave.clear();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void SetNull()\n      {\n          vHave.clear();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCInPoint {\n  CInPoint() { SetNull(); }\n}"
  },
  {
    "function_name": "print",
    "container": "CDiskTxPos",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "196-199",
    "snippet": "void print() const\n    {\n        printf(\"%s\", ToString().c_str());\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\"",
            "ToString().c_str()"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskTxPos {\n  void print() const\n      {\n          printf(\"%s\", ToString().c_str());\n      }\n}"
  },
  {
    "function_name": "ToString",
    "container": "CDiskTxPos",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "188-194",
    "snippet": "std::string ToString() const\n    {\n        if (IsNull())\n            return \"null\";\n        else\n            return strprintf(\"(nFile=%u, nBlockPos=%u, nTxPos=%u)\", nFile, nBlockPos, nTxPos);\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"(nFile=%u, nBlockPos=%u, nTxPos=%u)\"",
            "nFile",
            "nBlockPos",
            "nTxPos"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsNull",
          "args": [],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "IsNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1585-1588",
          "snippet": "bool IsNull()\n    {\n        return vHave.empty();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  bool IsNull()\n      {\n          return vHave.empty();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskTxPos {\n  std::string ToString() const\n      {\n          if (IsNull())\n              return \"null\";\n          else\n              return strprintf(\"(nFile=%u, nBlockPos=%u, nTxPos=%u)\", nFile, nBlockPos, nTxPos);\n      }\n}"
  },
  {
    "function_name": "IsNull",
    "container": "CDiskTxPos",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "173-173",
    "snippet": "bool IsNull() const { return (nFile == (unsigned int) -1); }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskTxPos {\n  bool IsNull() const { return (nFile == (unsigned int) -1); }\n}"
  },
  {
    "function_name": "SetNull",
    "container": "CDiskTxPos",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "172-172",
    "snippet": "void SetNull() { nFile = (unsigned int) -1; nBlockPos = 0; nTxPos = 0; }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskTxPos {\n  void SetNull() { nFile = (unsigned int) -1; nBlockPos = 0; nTxPos = 0; }\n}"
  },
  {
    "function_name": "CDiskTxPos",
    "container": "CDiskTxPos",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "164-169",
    "snippet": "CDiskTxPos(unsigned int nFileIn, unsigned int nBlockPosIn, unsigned int nTxPosIn)\n    {\n        nFile = nFileIn;\n        nBlockPos = nBlockPosIn;\n        nTxPos = nTxPosIn;\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskTxPos {\n  CDiskTxPos(unsigned int nFileIn, unsigned int nBlockPosIn, unsigned int nTxPosIn)\n      {\n          nFile = nFileIn;\n          nBlockPos = nBlockPosIn;\n          nTxPos = nTxPosIn;\n      }\n}"
  },
  {
    "function_name": "CDiskTxPos",
    "container": "CDiskTxPos",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "159-162",
    "snippet": "CDiskTxPos()\n    {\n        SetNull();\n    }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetNull",
          "args": [],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CBlockLocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1580-1583",
          "snippet": "void SetNull()\n    {\n        vHave.clear();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockLocator {\n  void SetNull()\n      {\n          vHave.clear();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskTxPos {\n  CDiskTxPos()\n      {\n          SetNull();\n      }\n}"
  },
  {
    "function_name": "FutureDrift",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "64-64",
    "snippet": "inline int64_t FutureDrift(int64_t nTime) { return(nTime + 10 * 60); }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\ninline int64_t FutureDrift(int64_t nTime) { return(nTime + 10 * 60); }"
  },
  {
    "function_name": "PastDrift",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "62-62",
    "snippet": "inline int64_t PastDrift(int64_t nTime)   { return(nTime - 10 * 60); }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\ninline int64_t PastDrift(int64_t nTime)   { return(nTime - 10 * 60); }"
  },
  {
    "function_name": "MoneyRange",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
    "lines": "48-48",
    "snippet": "inline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }",
    "includes": [
      "#include <list>",
      "#include \"x15hash.h\"",
      "#include \"neoscrypt.h\"",
      "#include \"script.h\"",
      "#include \"net.h\"",
      "#include \"sync.h\"",
      "#include \"bignum.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\ninline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }"
  }
]