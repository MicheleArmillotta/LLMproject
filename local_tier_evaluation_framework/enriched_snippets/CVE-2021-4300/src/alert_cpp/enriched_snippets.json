[
  {
    "function_name": "ProcessAlert",
    "container": "CAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "173-270",
    "snippet": "bool CAlert::ProcessAlert(bool fThread)\n{\n    if (!CheckSignature())\n        return false;\n    if (!IsInEffect())\n        return false;\n\n    // alert.nID=max is reserved for if the alert key is\n    // compromised. It must have a pre-defined message,\n    // must never expire, must apply to all versions,\n    // and must cancel all previous\n    // alerts or it will be ignored (so an attacker can't\n    // send an \"everything is OK, don't panic\" version that\n    // cannot be overridden):\n    int maxInt = std::numeric_limits<int>::max();\n    if (nID == maxInt)\n    {\n        if (!(\n                nExpiration == maxInt &&\n                nCancel == (maxInt-1) &&\n                nMinVer == 0 &&\n                nMaxVer == maxInt &&\n                setSubVer.empty() &&\n                nPriority == maxInt &&\n                strStatusBar == \"URGENT: Alert key compromised, upgrade required\"\n                ))\n            return false;\n    }\n\n    {\n        LOCK(cs_mapAlerts);\n        // Cancel previous alerts\n        for (map<uint256, CAlert>::iterator mi = mapAlerts.begin(); mi != mapAlerts.end();)\n        {\n            const CAlert& alert = (*mi).second;\n            if (Cancels(alert))\n            {\n                printf(\"cancelling alert %d\\n\", alert.nID);\n                uiInterface.NotifyAlertChanged((*mi).first, CT_DELETED);\n                mapAlerts.erase(mi++);\n            }\n            else if (!alert.IsInEffect())\n            {\n                printf(\"expiring alert %d\\n\", alert.nID);\n                uiInterface.NotifyAlertChanged((*mi).first, CT_DELETED);\n                mapAlerts.erase(mi++);\n            }\n            else\n                mi++;\n        }\n\n        // Check if this alert has been cancelled\n        BOOST_FOREACH(PAIRTYPE(const uint256, CAlert)& item, mapAlerts)\n        {\n            const CAlert& alert = item.second;\n            if (alert.Cancels(*this))\n            {\n                printf(\"alert already cancelled by %d\\n\", alert.nID);\n                return false;\n            }\n        }\n\n        // Add to mapAlerts\n        mapAlerts.insert(make_pair(GetHash(), *this));\n        // Notify UI and -alertnotify if it applies to me\n        if(AppliesToMe())\n        {\n            uiInterface.NotifyAlertChanged(GetHash(), CT_NEW);\n            std::string strCmd = GetArg(\"-alertnotify\", \"\");\n            if (!strCmd.empty())\n            {\n                // Alert text should be plain ascii coming from a trusted source, but to\n                // be safe we first strip anything not in safeChars, then add single quotes around\n                // the whole string before passing it to the shell:\n                std::string singleQuote(\"'\");\n                // safeChars chosen to allow simple messages/URLs/email addresses, but avoid anything\n                // even possibly remotely dangerous like & or >\n                std::string safeChars(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890 .,;_/:?@\");\n                std::string safeStatus;\n                for (std::string::size_type i = 0; i < strStatusBar.size(); i++)\n                {\n                    if (safeChars.find(strStatusBar[i]) != std::string::npos)\n                        safeStatus.push_back(strStatusBar[i]);\n                }\n                safeStatus = singleQuote+safeStatus+singleQuote;\n                boost::replace_all(strCmd, \"%s\", safeStatus);\n\n                if (fThread)\n                    boost::thread t(runCommand, strCmd); // thread runs free\n                else\n                    runCommand(strCmd);\n            }\n        }\n    }\n\n    printf(\"accepted alert %d, AppliesToMe()=%d\\n\", nID, AppliesToMe());\n    return true;\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [
      "map<uint256, CAlert> mapAlerts;",
      "CCriticalSection cs_mapAlerts;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"accepted alert %d, AppliesToMe()=%d\\n\"",
            "nID",
            "AppliesToMe()"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AppliesToMe",
          "args": [],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "AppliesToMe",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "124-127",
          "snippet": "bool CAlert::AppliesToMe() const\n{\n    return AppliesTo(PROTOCOL_VERSION, FormatSubVersion(CLIENT_NAME, CLIENT_VERSION, std::vector<std::string>()));\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::AppliesToMe() const\n  {\n      return AppliesTo(PROTOCOL_VERSION, FormatSubVersion(CLIENT_NAME, CLIENT_VERSION, std::vector<std::string>()));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "t",
          "args": [
            "runCommand",
            "strCmd"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "AppliesTo",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "116-122",
          "snippet": "bool CAlert::AppliesTo(int nVersion, std::string strSubVerIn) const\n{\n    // TODO: rework for client-version-embedded-in-strSubVer ?\n    return (IsInEffect() &&\n            nMinVer <= nVersion && nVersion <= nMaxVer &&\n            (setSubVer.empty() || setSubVer.count(strSubVerIn)));\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::AppliesTo(int nVersion, std::string strSubVerIn) const\n  {\n      // TODO: rework for client-version-embedded-in-strSubVer ?\n      return (IsInEffect() &&\n              nMinVer <= nVersion && nVersion <= nMaxVer &&\n              (setSubVer.empty() || setSubVer.count(strSubVerIn)));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "boost::replace_all",
          "args": [
            "strCmd",
            "\"%s\"",
            "safeStatus"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "safeStatus.push_back",
          "args": [
            "strStatusBar[i]"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "safeChars.find",
          "args": [
            "strStatusBar[i]"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strStatusBar.size",
          "args": [],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strCmd.empty",
          "args": [],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetArg",
          "args": [
            "\"-alertnotify\"",
            "\"\""
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "GetArg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "562-567",
          "snippet": "int64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "map<string, string> mapArgs;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nint64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}"
        }
      },
      {
        "call_info": {
          "callee": "uiInterface.NotifyAlertChanged",
          "args": [
            "GetHash()",
            "CT_NEW"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetHash",
          "args": [],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "GetHash",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "99-102",
          "snippet": "uint256 CAlert::GetHash() const\n{\n    return Hash(this->vchMsg.begin(), this->vchMsg.end());\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  uint256 CAlert::GetHash() const\n  {\n      return Hash(this->vchMsg.begin(), this->vchMsg.end());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapAlerts.insert",
          "args": [
            "make_pair(GetHash(), *this)"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "61-65",
          "snippet": "void CBloomFilter::insert(const uint256& hash)\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    insert(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  void CBloomFilter::insert(const uint256& hash)\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      insert(data);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_pair",
          "args": [
            "GetHash()",
            "*this"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"alert already cancelled by %d\\n\"",
            "alert.nID"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "alert.Cancels",
          "args": [
            "*this"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "Cancels",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "109-114",
          "snippet": "bool CAlert::Cancels(const CAlert& alert) const\n{\n    if (!IsInEffect())\n        return false; // this was a no-op before 31403\n    return (alert.nID <= nCancel || setCancel.count(alert.nID));\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::Cancels(const CAlert& alert) const\n  {\n      if (!IsInEffect())\n          return false; // this was a no-op before 31403\n      return (alert.nID <= nCancel || setCancel.count(alert.nID));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapAlerts.erase",
          "args": [
            "mi++"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "49-65",
          "snippet": "void erase(const key_type& k)\n    {\n        iterator itTarget = map.find(k);\n        if (itTarget == map.end())\n            return;\n        std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n        for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n            if (it->second == itTarget)\n            {\n                rmap.erase(it);\n                map.erase(itTarget);\n                return;\n            }\n        // Shouldn't ever get here\n        assert(0); //TODO remove me\n        map.erase(itTarget);\n    }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  void erase(const key_type& k)\n      {\n          iterator itTarget = map.find(k);\n          if (itTarget == map.end())\n              return;\n          std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n          for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n              if (it->second == itTarget)\n              {\n                  rmap.erase(it);\n                  map.erase(itTarget);\n                  return;\n              }\n          // Shouldn't ever get here\n          assert(0); //TODO remove me\n          map.erase(itTarget);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "uiInterface.NotifyAlertChanged",
          "args": [
            "(*mi).first",
            "CT_DELETED"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alert.IsInEffect",
          "args": [],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "IsInEffect",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "104-107",
          "snippet": "bool CAlert::IsInEffect() const\n{\n    return (GetAdjustedTime() < nExpiration);\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::IsInEffect() const\n  {\n      return (GetAdjustedTime() < nExpiration);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "uiInterface.NotifyAlertChanged",
          "args": [
            "(*mi).first",
            "CT_DELETED"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapAlerts.end",
          "args": [],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapAlerts.begin",
          "args": [],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs_mapAlerts"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::numeric_limits<int>::max",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CheckSignature",
          "args": [],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "CheckSignature",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "147-159",
          "snippet": "bool CAlert::CheckSignature() const\n{\n    CKey key;\n    if (!key.SetPubKey(ParseHex(fTestNet ? pszTestKey : pszMainKey)))\n        return error(\"CAlert::CheckSignature() : SetPubKey failed\");\n    if (!key.Verify(Hash(vchMsg.begin(), vchMsg.end()), vchSig))\n        return error(\"CAlert::CheckSignature() : verify signature failed\");\n\n    // Now unserialize the data\n    CDataStream sMsg(vchMsg, SER_NETWORK, PROTOCOL_VERSION);\n    sMsg >> *(CUnsignedAlert*)this;\n    return true;\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char* pszMainKey = \"044f5718a9d3ccccd98b9e1c22d1dbf15212b7f5e179f4c47ec5c9459bda7930676f501c430003e2488403dd46317d6c02b70dc7bda0a8a1aadc3c5b79e7524487\";",
            "static const char* pszTestKey = \"043f0bb17f40014ac56d202711e9c54f3cf75f777f519ec1cb451e329b31af850ace9d1c3c15c540da63cea7cab70b83d2d3d2bd25ded94d3040e9142c49fe7dd0\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nstatic const char* pszMainKey = \"044f5718a9d3ccccd98b9e1c22d1dbf15212b7f5e179f4c47ec5c9459bda7930676f501c430003e2488403dd46317d6c02b70dc7bda0a8a1aadc3c5b79e7524487\";\nstatic const char* pszTestKey = \"043f0bb17f40014ac56d202711e9c54f3cf75f777f519ec1cb451e329b31af850ace9d1c3c15c540da63cea7cab70b83d2d3d2bd25ded94d3040e9142c49fe7dd0\";\n\nCAlert {\n  bool CAlert::CheckSignature() const\n  {\n      CKey key;\n      if (!key.SetPubKey(ParseHex(fTestNet ? pszTestKey : pszMainKey)))\n          return error(\"CAlert::CheckSignature() : SetPubKey failed\");\n      if (!key.Verify(Hash(vchMsg.begin(), vchMsg.end()), vchSig))\n          return error(\"CAlert::CheckSignature() : verify signature failed\");\n  \n      // Now unserialize the data\n      CDataStream sMsg(vchMsg, SER_NETWORK, PROTOCOL_VERSION);\n      sMsg >> *(CUnsignedAlert*)this;\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nmap<uint256, CAlert> mapAlerts;\nCCriticalSection cs_mapAlerts;\n\nCAlert {\n  bool CAlert::ProcessAlert(bool fThread)\n  {\n      if (!CheckSignature())\n          return false;\n      if (!IsInEffect())\n          return false;\n  \n      // alert.nID=max is reserved for if the alert key is\n      // compromised. It must have a pre-defined message,\n      // must never expire, must apply to all versions,\n      // and must cancel all previous\n      // alerts or it will be ignored (so an attacker can't\n      // send an \"everything is OK, don't panic\" version that\n      // cannot be overridden):\n      int maxInt = std::numeric_limits<int>::max();\n      if (nID == maxInt)\n      {\n          if (!(\n                  nExpiration == maxInt &&\n                  nCancel == (maxInt-1) &&\n                  nMinVer == 0 &&\n                  nMaxVer == maxInt &&\n                  setSubVer.empty() &&\n                  nPriority == maxInt &&\n                  strStatusBar == \"URGENT: Alert key compromised, upgrade required\"\n                  ))\n              return false;\n      }\n  \n      {\n          LOCK(cs_mapAlerts);\n          // Cancel previous alerts\n          for (map<uint256, CAlert>::iterator mi = mapAlerts.begin(); mi != mapAlerts.end();)\n          {\n              const CAlert& alert = (*mi).second;\n              if (Cancels(alert))\n              {\n                  printf(\"cancelling alert %d\\n\", alert.nID);\n                  uiInterface.NotifyAlertChanged((*mi).first, CT_DELETED);\n                  mapAlerts.erase(mi++);\n              }\n              else if (!alert.IsInEffect())\n              {\n                  printf(\"expiring alert %d\\n\", alert.nID);\n                  uiInterface.NotifyAlertChanged((*mi).first, CT_DELETED);\n                  mapAlerts.erase(mi++);\n              }\n              else\n                  mi++;\n          }\n  \n          // Check if this alert has been cancelled\n          BOOST_FOREACH(PAIRTYPE(const uint256, CAlert)& item, mapAlerts)\n          {\n              const CAlert& alert = item.second;\n              if (alert.Cancels(*this))\n              {\n                  printf(\"alert already cancelled by %d\\n\", alert.nID);\n                  return false;\n              }\n          }\n  \n          // Add to mapAlerts\n          mapAlerts.insert(make_pair(GetHash(), *this));\n          // Notify UI and -alertnotify if it applies to me\n          if(AppliesToMe())\n          {\n              uiInterface.NotifyAlertChanged(GetHash(), CT_NEW);\n              std::string strCmd = GetArg(\"-alertnotify\", \"\");\n              if (!strCmd.empty())\n              {\n                  // Alert text should be plain ascii coming from a trusted source, but to\n                  // be safe we first strip anything not in safeChars, then add single quotes around\n                  // the whole string before passing it to the shell:\n                  std::string singleQuote(\"'\");\n                  // safeChars chosen to allow simple messages/URLs/email addresses, but avoid anything\n                  // even possibly remotely dangerous like & or >\n                  std::string safeChars(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890 .,;_/:?@\");\n                  std::string safeStatus;\n                  for (std::string::size_type i = 0; i < strStatusBar.size(); i++)\n                  {\n                      if (safeChars.find(strStatusBar[i]) != std::string::npos)\n                          safeStatus.push_back(strStatusBar[i]);\n                  }\n                  safeStatus = singleQuote+safeStatus+singleQuote;\n                  boost::replace_all(strCmd, \"%s\", safeStatus);\n  \n                  if (fThread)\n                      boost::thread t(runCommand, strCmd); // thread runs free\n                  else\n                      runCommand(strCmd);\n              }\n          }\n      }\n  \n      printf(\"accepted alert %d, AppliesToMe()=%d\\n\", nID, AppliesToMe());\n      return true;\n  }\n}"
  },
  {
    "function_name": "getAlertByHash",
    "container": "CAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "161-171",
    "snippet": "CAlert CAlert::getAlertByHash(const uint256 &hash)\n{\n    CAlert retval;\n    {\n        LOCK(cs_mapAlerts);\n        map<uint256, CAlert>::iterator mi = mapAlerts.find(hash);\n        if(mi != mapAlerts.end())\n            retval = mi->second;\n    }\n    return retval;\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [
      "map<uint256, CAlert> mapAlerts;",
      "CCriticalSection cs_mapAlerts;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mapAlerts.end",
          "args": [],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapAlerts.find",
          "args": [
            "hash"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs_mapAlerts"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nmap<uint256, CAlert> mapAlerts;\nCCriticalSection cs_mapAlerts;\n\nCAlert {\n  CAlert CAlert::getAlertByHash(const uint256 &hash)\n  {\n      CAlert retval;\n      {\n          LOCK(cs_mapAlerts);\n          map<uint256, CAlert>::iterator mi = mapAlerts.find(hash);\n          if(mi != mapAlerts.end())\n              retval = mi->second;\n      }\n      return retval;\n  }\n}"
  },
  {
    "function_name": "CheckSignature",
    "container": "CAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "147-159",
    "snippet": "bool CAlert::CheckSignature() const\n{\n    CKey key;\n    if (!key.SetPubKey(ParseHex(fTestNet ? pszTestKey : pszMainKey)))\n        return error(\"CAlert::CheckSignature() : SetPubKey failed\");\n    if (!key.Verify(Hash(vchMsg.begin(), vchMsg.end()), vchSig))\n        return error(\"CAlert::CheckSignature() : verify signature failed\");\n\n    // Now unserialize the data\n    CDataStream sMsg(vchMsg, SER_NETWORK, PROTOCOL_VERSION);\n    sMsg >> *(CUnsignedAlert*)this;\n    return true;\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char* pszMainKey = \"044f5718a9d3ccccd98b9e1c22d1dbf15212b7f5e179f4c47ec5c9459bda7930676f501c430003e2488403dd46317d6c02b70dc7bda0a8a1aadc3c5b79e7524487\";",
      "static const char* pszTestKey = \"043f0bb17f40014ac56d202711e9c54f3cf75f777f519ec1cb451e329b31af850ace9d1c3c15c540da63cea7cab70b83d2d3d2bd25ded94d3040e9142c49fe7dd0\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"CAlert::CheckSignature() : verify signature failed\""
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "key_error",
          "container": "key_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "44-44",
          "snippet": "explicit key_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nkey_error {\n  explicit key_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "key.Verify",
          "args": [
            "Hash(vchMsg.begin(), vchMsg.end())",
            "vchSig"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "Verify",
          "container": "CKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.cpp",
          "lines": "392-399",
          "snippet": "bool CKey::Verify(uint256 hash, const std::vector<unsigned char>& vchSig)\n{\n    // -1 = error, 0 = bad sig, 1 = good\n    if (ECDSA_verify(0, (unsigned char*)&hash, sizeof(hash), &vchSig[0], vchSig.size(), pkey) != 1)\n        return false;\n\n    return true;\n}",
          "includes": [
            "#include \"key.h\"",
            "#include <openssl/obj_mac.h>",
            "#include <openssl/ecdsa.h>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"key.h\"\n#include <openssl/obj_mac.h>\n#include <openssl/ecdsa.h>\n#include <map>\n\nCKey {\n  bool CKey::Verify(uint256 hash, const std::vector<unsigned char>& vchSig)\n  {\n      // -1 = error, 0 = bad sig, 1 = good\n      if (ECDSA_verify(0, (unsigned char*)&hash, sizeof(hash), &vchSig[0], vchSig.size(), pkey) != 1)\n          return false;\n  \n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Hash",
          "args": [
            "vchMsg.begin()",
            "vchMsg.end()"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "Hash",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "34-38",
          "snippet": "inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n{\n    // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n    return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n  {\n      // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n      return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchMsg.end",
          "args": [],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchMsg.begin",
          "args": [],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "key.SetPubKey",
          "args": [
            "ParseHex(fTestNet ? pszTestKey : pszMainKey)"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "SetPubKey",
          "container": "CKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.cpp",
          "lines": "259-272",
          "snippet": "bool CKey::SetPubKey(const CPubKey& vchPubKey)\n{\n    const unsigned char* pbegin = &vchPubKey.vchPubKey[0];\n    if (o2i_ECPublicKey(&pkey, &pbegin, vchPubKey.vchPubKey.size()))\n    {\n        fSet = true;\n        if (vchPubKey.vchPubKey.size() == 33)\n            SetCompressedPubKey();\n        return true;\n    }\n    pkey = NULL;\n    Reset();\n    return false;\n}",
          "includes": [
            "#include \"key.h\"",
            "#include <openssl/obj_mac.h>",
            "#include <openssl/ecdsa.h>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"key.h\"\n#include <openssl/obj_mac.h>\n#include <openssl/ecdsa.h>\n#include <map>\n\nCKey {\n  bool CKey::SetPubKey(const CPubKey& vchPubKey)\n  {\n      const unsigned char* pbegin = &vchPubKey.vchPubKey[0];\n      if (o2i_ECPublicKey(&pkey, &pbegin, vchPubKey.vchPubKey.size()))\n      {\n          fSet = true;\n          if (vchPubKey.vchPubKey.size() == 33)\n              SetCompressedPubKey();\n          return true;\n      }\n      pkey = NULL;\n      Reset();\n      return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ParseHex",
          "args": [
            "fTestNet ? pszTestKey : pszMainKey"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "ParseHex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "490-493",
          "snippet": "vector<unsigned char> ParseHex(const string& str)\n{\n    return ParseHex(str.c_str());\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvector<unsigned char> ParseHex(const string& str)\n{\n    return ParseHex(str.c_str());\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nstatic const char* pszMainKey = \"044f5718a9d3ccccd98b9e1c22d1dbf15212b7f5e179f4c47ec5c9459bda7930676f501c430003e2488403dd46317d6c02b70dc7bda0a8a1aadc3c5b79e7524487\";\nstatic const char* pszTestKey = \"043f0bb17f40014ac56d202711e9c54f3cf75f777f519ec1cb451e329b31af850ace9d1c3c15c540da63cea7cab70b83d2d3d2bd25ded94d3040e9142c49fe7dd0\";\n\nCAlert {\n  bool CAlert::CheckSignature() const\n  {\n      CKey key;\n      if (!key.SetPubKey(ParseHex(fTestNet ? pszTestKey : pszMainKey)))\n          return error(\"CAlert::CheckSignature() : SetPubKey failed\");\n      if (!key.Verify(Hash(vchMsg.begin(), vchMsg.end()), vchSig))\n          return error(\"CAlert::CheckSignature() : verify signature failed\");\n  \n      // Now unserialize the data\n      CDataStream sMsg(vchMsg, SER_NETWORK, PROTOCOL_VERSION);\n      sMsg >> *(CUnsignedAlert*)this;\n      return true;\n  }\n}"
  },
  {
    "function_name": "RelayTo",
    "container": "CAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "129-145",
    "snippet": "bool CAlert::RelayTo(CNode* pnode) const\n{\n    if (!IsInEffect())\n        return false;\n    // returns true if wasn't already contained in the set\n    if (pnode->setKnown.insert(GetHash()).second)\n    {\n        if (AppliesTo(pnode->nVersion, pnode->strSubVer) ||\n            AppliesToMe() ||\n            GetAdjustedTime() < nRelayUntil)\n        {\n            pnode->PushMessage(\"alert\", *this);\n            return true;\n        }\n    }\n    return false;\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pnode->PushMessage",
          "args": [
            "\"alert\"",
            "*this"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "PushMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "425-438",
          "snippet": "void PushMessage(const char* pszCommand, const T1& a1)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            vSend << a1;\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand, const T1& a1)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              vSend << a1;\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetAdjustedTime",
          "args": [],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "GetAdjustedTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1201-1214",
          "snippet": "int64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern int64 nNtpOffset;",
            "int64 nPeersOffset = INT64_MAX;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nextern int64 nNtpOffset;\nint64 nPeersOffset = INT64_MAX;\n\nint64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}"
        }
      },
      {
        "call_info": {
          "callee": "AppliesToMe",
          "args": [],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "AppliesToMe",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "124-127",
          "snippet": "bool CAlert::AppliesToMe() const\n{\n    return AppliesTo(PROTOCOL_VERSION, FormatSubVersion(CLIENT_NAME, CLIENT_VERSION, std::vector<std::string>()));\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::AppliesToMe() const\n  {\n      return AppliesTo(PROTOCOL_VERSION, FormatSubVersion(CLIENT_NAME, CLIENT_VERSION, std::vector<std::string>()));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "AppliesTo",
          "args": [
            "pnode->nVersion",
            "pnode->strSubVer"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "AppliesTo",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "116-122",
          "snippet": "bool CAlert::AppliesTo(int nVersion, std::string strSubVerIn) const\n{\n    // TODO: rework for client-version-embedded-in-strSubVer ?\n    return (IsInEffect() &&\n            nMinVer <= nVersion && nVersion <= nMaxVer &&\n            (setSubVer.empty() || setSubVer.count(strSubVerIn)));\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::AppliesTo(int nVersion, std::string strSubVerIn) const\n  {\n      // TODO: rework for client-version-embedded-in-strSubVer ?\n      return (IsInEffect() &&\n              nMinVer <= nVersion && nVersion <= nMaxVer &&\n              (setSubVer.empty() || setSubVer.count(strSubVerIn)));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pnode->setKnown.insert",
          "args": [
            "GetHash()"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "61-65",
          "snippet": "void CBloomFilter::insert(const uint256& hash)\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    insert(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  void CBloomFilter::insert(const uint256& hash)\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      insert(data);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetHash",
          "args": [],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "GetHash",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "99-102",
          "snippet": "uint256 CAlert::GetHash() const\n{\n    return Hash(this->vchMsg.begin(), this->vchMsg.end());\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  uint256 CAlert::GetHash() const\n  {\n      return Hash(this->vchMsg.begin(), this->vchMsg.end());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsInEffect",
          "args": [],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "IsInEffect",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "104-107",
          "snippet": "bool CAlert::IsInEffect() const\n{\n    return (GetAdjustedTime() < nExpiration);\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::IsInEffect() const\n  {\n      return (GetAdjustedTime() < nExpiration);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::RelayTo(CNode* pnode) const\n  {\n      if (!IsInEffect())\n          return false;\n      // returns true if wasn't already contained in the set\n      if (pnode->setKnown.insert(GetHash()).second)\n      {\n          if (AppliesTo(pnode->nVersion, pnode->strSubVer) ||\n              AppliesToMe() ||\n              GetAdjustedTime() < nRelayUntil)\n          {\n              pnode->PushMessage(\"alert\", *this);\n              return true;\n          }\n      }\n      return false;\n  }\n}"
  },
  {
    "function_name": "AppliesToMe",
    "container": "CAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "124-127",
    "snippet": "bool CAlert::AppliesToMe() const\n{\n    return AppliesTo(PROTOCOL_VERSION, FormatSubVersion(CLIENT_NAME, CLIENT_VERSION, std::vector<std::string>()));\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AppliesTo",
          "args": [
            "PROTOCOL_VERSION",
            "FormatSubVersion(CLIENT_NAME, CLIENT_VERSION, std::vector<std::string>())"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "AppliesTo",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "116-122",
          "snippet": "bool CAlert::AppliesTo(int nVersion, std::string strSubVerIn) const\n{\n    // TODO: rework for client-version-embedded-in-strSubVer ?\n    return (IsInEffect() &&\n            nMinVer <= nVersion && nVersion <= nMaxVer &&\n            (setSubVer.empty() || setSubVer.count(strSubVerIn)));\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::AppliesTo(int nVersion, std::string strSubVerIn) const\n  {\n      // TODO: rework for client-version-embedded-in-strSubVer ?\n      return (IsInEffect() &&\n              nMinVer <= nVersion && nVersion <= nMaxVer &&\n              (setSubVer.empty() || setSubVer.count(strSubVerIn)));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FormatSubVersion",
          "args": [
            "CLIENT_NAME",
            "CLIENT_VERSION",
            "std::vector<std::string>()"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "FormatSubVersion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1294-1303",
          "snippet": "std::string FormatSubVersion(const std::string& name, uint nClientVersion,\n  const std::vector<std::string>& comments) {\n    std::ostringstream ss;\n    ss << \"/\";\n    ss << name << \":\" << FormatVersion(nClientVersion);\n    if (!comments.empty())\n        ss << \"(\" << boost::algorithm::join(comments, \"; \") << \")\";\n    ss << \"/\";\n    return ss.str();\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstd::string FormatSubVersion(const std::string& name, uint nClientVersion,\n  const std::vector<std::string>& comments) {\n    std::ostringstream ss;\n    ss << \"/\";\n    ss << name << \":\" << FormatVersion(nClientVersion);\n    if (!comments.empty())\n        ss << \"(\" << boost::algorithm::join(comments, \"; \") << \")\";\n    ss << \"/\";\n    return ss.str();\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::vector<std::string>",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::AppliesToMe() const\n  {\n      return AppliesTo(PROTOCOL_VERSION, FormatSubVersion(CLIENT_NAME, CLIENT_VERSION, std::vector<std::string>()));\n  }\n}"
  },
  {
    "function_name": "AppliesTo",
    "container": "CAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "116-122",
    "snippet": "bool CAlert::AppliesTo(int nVersion, std::string strSubVerIn) const\n{\n    // TODO: rework for client-version-embedded-in-strSubVer ?\n    return (IsInEffect() &&\n            nMinVer <= nVersion && nVersion <= nMaxVer &&\n            (setSubVer.empty() || setSubVer.count(strSubVerIn)));\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setSubVer.count",
          "args": [
            "strSubVerIn"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setSubVer.empty",
          "args": [],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsInEffect",
          "args": [],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "IsInEffect",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "104-107",
          "snippet": "bool CAlert::IsInEffect() const\n{\n    return (GetAdjustedTime() < nExpiration);\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::IsInEffect() const\n  {\n      return (GetAdjustedTime() < nExpiration);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::AppliesTo(int nVersion, std::string strSubVerIn) const\n  {\n      // TODO: rework for client-version-embedded-in-strSubVer ?\n      return (IsInEffect() &&\n              nMinVer <= nVersion && nVersion <= nMaxVer &&\n              (setSubVer.empty() || setSubVer.count(strSubVerIn)));\n  }\n}"
  },
  {
    "function_name": "Cancels",
    "container": "CAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "109-114",
    "snippet": "bool CAlert::Cancels(const CAlert& alert) const\n{\n    if (!IsInEffect())\n        return false; // this was a no-op before 31403\n    return (alert.nID <= nCancel || setCancel.count(alert.nID));\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setCancel.count",
          "args": [
            "alert.nID"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsInEffect",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "IsInEffect",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "104-107",
          "snippet": "bool CAlert::IsInEffect() const\n{\n    return (GetAdjustedTime() < nExpiration);\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::IsInEffect() const\n  {\n      return (GetAdjustedTime() < nExpiration);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::Cancels(const CAlert& alert) const\n  {\n      if (!IsInEffect())\n          return false; // this was a no-op before 31403\n      return (alert.nID <= nCancel || setCancel.count(alert.nID));\n  }\n}"
  },
  {
    "function_name": "IsInEffect",
    "container": "CAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "104-107",
    "snippet": "bool CAlert::IsInEffect() const\n{\n    return (GetAdjustedTime() < nExpiration);\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetAdjustedTime",
          "args": [],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "GetAdjustedTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1201-1214",
          "snippet": "int64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern int64 nNtpOffset;",
            "int64 nPeersOffset = INT64_MAX;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nextern int64 nNtpOffset;\nint64 nPeersOffset = INT64_MAX;\n\nint64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::IsInEffect() const\n  {\n      return (GetAdjustedTime() < nExpiration);\n  }\n}"
  },
  {
    "function_name": "GetHash",
    "container": "CAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "99-102",
    "snippet": "uint256 CAlert::GetHash() const\n{\n    return Hash(this->vchMsg.begin(), this->vchMsg.end());\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Hash",
          "args": [
            "this->vchMsg.begin()",
            "this->vchMsg.end()"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "Hash",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "34-38",
          "snippet": "inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n{\n    // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n    return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n  {\n      // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n      return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "this->vchMsg.end",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "this->vchMsg.begin",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  uint256 CAlert::GetHash() const\n  {\n      return Hash(this->vchMsg.begin(), this->vchMsg.end());\n  }\n}"
  },
  {
    "function_name": "IsNull",
    "container": "CAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "94-97",
    "snippet": "bool CAlert::IsNull() const\n{\n    return (nExpiration == 0);\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  bool CAlert::IsNull() const\n  {\n      return (nExpiration == 0);\n  }\n}"
  },
  {
    "function_name": "SetNull",
    "container": "CAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "87-92",
    "snippet": "void CAlert::SetNull()\n{\n    CUnsignedAlert::SetNull();\n    vchMsg.clear();\n    vchSig.clear();\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vchSig.clear",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CUnsignedAlert::SetNull",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CUnsignedAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "27-43",
          "snippet": "void CUnsignedAlert::SetNull()\n{\n    nVersion = 1;\n    nRelayUntil = 0;\n    nExpiration = 0;\n    nID = 0;\n    nCancel = 0;\n    setCancel.clear();\n    nMinVer = 0;\n    nMaxVer = 0;\n    setSubVer.clear();\n    nPriority = 0;\n\n    strComment.clear();\n    strStatusBar.clear();\n    strReserved.clear();\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCUnsignedAlert {\n  void CUnsignedAlert::SetNull()\n  {\n      nVersion = 1;\n      nRelayUntil = 0;\n      nExpiration = 0;\n      nID = 0;\n      nCancel = 0;\n      setCancel.clear();\n      nMinVer = 0;\n      nMaxVer = 0;\n      setSubVer.clear();\n      nPriority = 0;\n  \n      strComment.clear();\n      strStatusBar.clear();\n      strReserved.clear();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCAlert {\n  void CAlert::SetNull()\n  {\n      CUnsignedAlert::SetNull();\n      vchMsg.clear();\n      vchSig.clear();\n  }\n}"
  },
  {
    "function_name": "print",
    "container": "CUnsignedAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "82-85",
    "snippet": "void CUnsignedAlert::print() const\n{\n    printf(\"%s\", ToString().c_str());\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\"",
            "ToString().c_str()"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CUnsignedAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "45-80",
          "snippet": "std::string CUnsignedAlert::ToString() const\n{\n    std::string strSetCancel;\n    BOOST_FOREACH(int n, setCancel)\n        strSetCancel += strprintf(\"%d \", n);\n    std::string strSetSubVer;\n    BOOST_FOREACH(std::string str, setSubVer)\n        strSetSubVer += \"\\\"\" + str + \"\\\" \";\n    return strprintf(\n        \"CAlert(\\n\"\n        \"    nVersion     = %d\\n\"\n        \"    nRelayUntil  = %\"PRId64\"\\n\"\n        \"    nExpiration  = %\"PRId64\"\\n\"\n        \"    nID          = %d\\n\"\n        \"    nCancel      = %d\\n\"\n        \"    setCancel    = %s\\n\"\n        \"    nMinVer      = %d\\n\"\n        \"    nMaxVer      = %d\\n\"\n        \"    setSubVer    = %s\\n\"\n        \"    nPriority    = %d\\n\"\n        \"    strComment   = \\\"%s\\\"\\n\"\n        \"    strStatusBar = \\\"%s\\\"\\n\"\n        \")\\n\",\n        nVersion,\n        nRelayUntil,\n        nExpiration,\n        nID,\n        nCancel,\n        strSetCancel.c_str(),\n        nMinVer,\n        nMaxVer,\n        strSetSubVer.c_str(),\n        nPriority,\n        strComment.c_str(),\n        strStatusBar.c_str());\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCUnsignedAlert {\n  std::string CUnsignedAlert::ToString() const\n  {\n      std::string strSetCancel;\n      BOOST_FOREACH(int n, setCancel)\n          strSetCancel += strprintf(\"%d \", n);\n      std::string strSetSubVer;\n      BOOST_FOREACH(std::string str, setSubVer)\n          strSetSubVer += \"\\\"\" + str + \"\\\" \";\n      return strprintf(\n          \"CAlert(\\n\"\n          \"    nVersion     = %d\\n\"\n          \"    nRelayUntil  = %\"PRId64\"\\n\"\n          \"    nExpiration  = %\"PRId64\"\\n\"\n          \"    nID          = %d\\n\"\n          \"    nCancel      = %d\\n\"\n          \"    setCancel    = %s\\n\"\n          \"    nMinVer      = %d\\n\"\n          \"    nMaxVer      = %d\\n\"\n          \"    setSubVer    = %s\\n\"\n          \"    nPriority    = %d\\n\"\n          \"    strComment   = \\\"%s\\\"\\n\"\n          \"    strStatusBar = \\\"%s\\\"\\n\"\n          \")\\n\",\n          nVersion,\n          nRelayUntil,\n          nExpiration,\n          nID,\n          nCancel,\n          strSetCancel.c_str(),\n          nMinVer,\n          nMaxVer,\n          strSetSubVer.c_str(),\n          nPriority,\n          strComment.c_str(),\n          strStatusBar.c_str());\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCUnsignedAlert {\n  void CUnsignedAlert::print() const\n  {\n      printf(\"%s\", ToString().c_str());\n  }\n}"
  },
  {
    "function_name": "ToString",
    "container": "CUnsignedAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "45-80",
    "snippet": "std::string CUnsignedAlert::ToString() const\n{\n    std::string strSetCancel;\n    BOOST_FOREACH(int n, setCancel)\n        strSetCancel += strprintf(\"%d \", n);\n    std::string strSetSubVer;\n    BOOST_FOREACH(std::string str, setSubVer)\n        strSetSubVer += \"\\\"\" + str + \"\\\" \";\n    return strprintf(\n        \"CAlert(\\n\"\n        \"    nVersion     = %d\\n\"\n        \"    nRelayUntil  = %\"PRId64\"\\n\"\n        \"    nExpiration  = %\"PRId64\"\\n\"\n        \"    nID          = %d\\n\"\n        \"    nCancel      = %d\\n\"\n        \"    setCancel    = %s\\n\"\n        \"    nMinVer      = %d\\n\"\n        \"    nMaxVer      = %d\\n\"\n        \"    setSubVer    = %s\\n\"\n        \"    nPriority    = %d\\n\"\n        \"    strComment   = \\\"%s\\\"\\n\"\n        \"    strStatusBar = \\\"%s\\\"\\n\"\n        \")\\n\",\n        nVersion,\n        nRelayUntil,\n        nExpiration,\n        nID,\n        nCancel,\n        strSetCancel.c_str(),\n        nMinVer,\n        nMaxVer,\n        strSetSubVer.c_str(),\n        nPriority,\n        strComment.c_str(),\n        strStatusBar.c_str());\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"CAlert(\\n\"\n        \"    nVersion     = %d\\n\"\n        \"    nRelayUntil  = %\"PRId64\"\\n\"\n        \"    nExpiration  = %\"PRId64\"\\n\"\n        \"    nID          = %d\\n\"\n        \"    nCancel      = %d\\n\"\n        \"    setCancel    = %s\\n\"\n        \"    nMinVer      = %d\\n\"\n        \"    nMaxVer      = %d\\n\"\n        \"    setSubVer    = %s\\n\"\n        \"    nPriority    = %d\\n\"\n        \"    strComment   = \\\"%s\\\"\\n\"\n        \"    strStatusBar = \\\"%s\\\"\\n\"\n        \")\\n\"",
            "nVersion",
            "nRelayUntil",
            "nExpiration",
            "nID",
            "nCancel",
            "strSetCancel.c_str()",
            "nMinVer",
            "nMaxVer",
            "strSetSubVer.c_str()",
            "nPriority",
            "strComment.c_str()",
            "strStatusBar.c_str()"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strStatusBar.c_str",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strComment.c_str",
          "args": [],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strSetSubVer.c_str",
          "args": [],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strSetCancel.c_str",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"%d \"",
            "n"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCUnsignedAlert {\n  std::string CUnsignedAlert::ToString() const\n  {\n      std::string strSetCancel;\n      BOOST_FOREACH(int n, setCancel)\n          strSetCancel += strprintf(\"%d \", n);\n      std::string strSetSubVer;\n      BOOST_FOREACH(std::string str, setSubVer)\n          strSetSubVer += \"\\\"\" + str + \"\\\" \";\n      return strprintf(\n          \"CAlert(\\n\"\n          \"    nVersion     = %d\\n\"\n          \"    nRelayUntil  = %\"PRId64\"\\n\"\n          \"    nExpiration  = %\"PRId64\"\\n\"\n          \"    nID          = %d\\n\"\n          \"    nCancel      = %d\\n\"\n          \"    setCancel    = %s\\n\"\n          \"    nMinVer      = %d\\n\"\n          \"    nMaxVer      = %d\\n\"\n          \"    setSubVer    = %s\\n\"\n          \"    nPriority    = %d\\n\"\n          \"    strComment   = \\\"%s\\\"\\n\"\n          \"    strStatusBar = \\\"%s\\\"\\n\"\n          \")\\n\",\n          nVersion,\n          nRelayUntil,\n          nExpiration,\n          nID,\n          nCancel,\n          strSetCancel.c_str(),\n          nMinVer,\n          nMaxVer,\n          strSetSubVer.c_str(),\n          nPriority,\n          strComment.c_str(),\n          strStatusBar.c_str());\n  }\n}"
  },
  {
    "function_name": "SetNull",
    "container": "CUnsignedAlert",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
    "lines": "27-43",
    "snippet": "void CUnsignedAlert::SetNull()\n{\n    nVersion = 1;\n    nRelayUntil = 0;\n    nExpiration = 0;\n    nID = 0;\n    nCancel = 0;\n    setCancel.clear();\n    nMinVer = 0;\n    nMaxVer = 0;\n    setSubVer.clear();\n    nPriority = 0;\n\n    strComment.clear();\n    strStatusBar.clear();\n    strReserved.clear();\n}",
    "includes": [
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"net.h\"",
      "#include \"key.h\"",
      "#include \"alert.h\"",
      "#include <map>",
      "#include <boost/foreach.hpp>",
      "#include <boost/algorithm/string/replace.hpp>",
      "#include <boost/algorithm/string/classification.hpp>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strReserved.clear",
          "args": [],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nCUnsignedAlert {\n  void CUnsignedAlert::SetNull()\n  {\n      nVersion = 1;\n      nRelayUntil = 0;\n      nExpiration = 0;\n      nID = 0;\n      nCancel = 0;\n      setCancel.clear();\n      nMinVer = 0;\n      nMaxVer = 0;\n      setSubVer.clear();\n      nPriority = 0;\n  \n      strComment.clear();\n      strStatusBar.clear();\n      strReserved.clear();\n  }\n}"
  }
]