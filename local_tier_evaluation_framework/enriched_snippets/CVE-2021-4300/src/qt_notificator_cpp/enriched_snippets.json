[
  {
    "function_name": "notify",
    "container": "Notificator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
    "lines": "276-302",
    "snippet": "void Notificator::notify(Class cls, const QString &title, const QString &text, const QIcon &icon, int millisTimeout)\n{\n    switch(mode)\n    {\n#ifdef USE_DBUS\n    case Freedesktop:\n        notifyDBus(cls, title, text, icon, millisTimeout);\n        break;\n#endif\n    case QSystemTray:\n        notifySystray(cls, title, text, icon, millisTimeout);\n        break;\n#ifdef Q_OS_MAC\n    case Growl12:\n    case Growl13:\n        notifyGrowl(cls, title, text, icon);\n        break;\n#endif\n    default:\n        if(cls == Critical)\n        {\n            // Fall back to old fashioned pop-up dialog if critical and no other notification available\n            QMessageBox::critical(parent, title, text, QMessageBox::Ok, QMessageBox::Ok);\n        }\n        break;\n    }\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <stdint.h>",
      "#include <QtDBus/QtDBus>",
      "#include <QImageWriter>",
      "#include <QTemporaryFile>",
      "#include <QMessageBox>",
      "#include <QSystemTrayIcon>",
      "#include <QByteArray>",
      "#include <QStyle>",
      "#include <QApplication>",
      "#include <QIcon>",
      "#include <QVariant>",
      "#include <QMetaType>",
      "#include \"notificator.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QMessageBox::critical",
          "args": [
            "parent",
            "title",
            "text",
            "QMessageBox::Ok",
            "QMessageBox::Ok"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notifyGrowl",
          "args": [
            "cls",
            "title",
            "text",
            "icon"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "notifyGrowl",
          "container": "Notificator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
          "lines": "229-273",
          "snippet": "void Notificator::notifyGrowl(Class cls, const QString &title, const QString &text, const QIcon &icon)\n{\n    const QString script(\n        \"tell application \\\"%5\\\"\\n\"\n        \"  set the allNotificationsList to {\\\"Notification\\\"}\\n\" // -- Make a list of all the notification types (all)\n        \"  set the enabledNotificationsList to {\\\"Notification\\\"}\\n\" // -- Make a list of the notifications (enabled)\n        \"  register as application \\\"%1\\\" all notifications allNotificationsList default notifications enabledNotificationsList\\n\" // -- Register our script with Growl\n        \"  notify with name \\\"Notification\\\" title \\\"%2\\\" description \\\"%3\\\" application name \\\"%1\\\"%4\\n\" // -- Send a Notification\n        \"end tell\"\n    );\n\n    QString notificationApp(QApplication::applicationName());\n    if (notificationApp.isEmpty())\n        notificationApp = \"Application\";\n\n    QPixmap notificationIconPixmap;\n    if (icon.isNull()) { // If no icon specified, set icon based on class\n        QStyle::StandardPixmap sicon = QStyle::SP_MessageBoxQuestion;\n        switch (cls)\n        {\n        case Information: sicon = QStyle::SP_MessageBoxInformation; break;\n        case Warning: sicon = QStyle::SP_MessageBoxWarning; break;\n        case Critical: sicon = QStyle::SP_MessageBoxCritical; break;\n        }\n        notificationIconPixmap = QApplication::style()->standardPixmap(sicon);\n    }\n    else {\n        QSize size = icon.actualSize(QSize(48, 48));\n        notificationIconPixmap = icon.pixmap(size);\n    }\n\n    QString notificationIcon;\n    QTemporaryFile notificationIconFile;\n    if (!notificationIconPixmap.isNull() && notificationIconFile.open()) {\n        QImageWriter writer(&notificationIconFile, \"PNG\");\n        if (writer.write(notificationIconPixmap.toImage()))\n            notificationIcon = QString(\" image from location \\\"file://%1\\\"\").arg(notificationIconFile.fileName());\n    }\n\n    QString quotedTitle(title), quotedText(text);\n    quotedTitle.replace(\"\\\\\", \"\\\\\\\\\").replace(\"\\\"\", \"\\\\\");\n    quotedText.replace(\"\\\\\", \"\\\\\\\\\").replace(\"\\\"\", \"\\\\\");\n    QString growlApp(this->mode == Notificator::Growl13 ? \"Growl\" : \"GrowlHelperApp\");\n    qt_mac_execute_apple_script(script.arg(notificationApp, quotedTitle, quotedText, notificationIcon, growlApp), 0);\n}",
          "includes": [
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <stdint.h>",
            "#include <QtDBus/QtDBus>",
            "#include <QImageWriter>",
            "#include <QTemporaryFile>",
            "#include <QMessageBox>",
            "#include <QSystemTrayIcon>",
            "#include <QByteArray>",
            "#include <QStyle>",
            "#include <QApplication>",
            "#include <QIcon>",
            "#include <QVariant>",
            "#include <QMetaType>",
            "#include \"notificator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nNotificator {\n  void Notificator::notifyGrowl(Class cls, const QString &title, const QString &text, const QIcon &icon)\n  {\n      const QString script(\n          \"tell application \\\"%5\\\"\\n\"\n          \"  set the allNotificationsList to {\\\"Notification\\\"}\\n\" // -- Make a list of all the notification types (all)\n          \"  set the enabledNotificationsList to {\\\"Notification\\\"}\\n\" // -- Make a list of the notifications (enabled)\n          \"  register as application \\\"%1\\\" all notifications allNotificationsList default notifications enabledNotificationsList\\n\" // -- Register our script with Growl\n          \"  notify with name \\\"Notification\\\" title \\\"%2\\\" description \\\"%3\\\" application name \\\"%1\\\"%4\\n\" // -- Send a Notification\n          \"end tell\"\n      );\n  \n      QString notificationApp(QApplication::applicationName());\n      if (notificationApp.isEmpty())\n          notificationApp = \"Application\";\n  \n      QPixmap notificationIconPixmap;\n      if (icon.isNull()) { // If no icon specified, set icon based on class\n          QStyle::StandardPixmap sicon = QStyle::SP_MessageBoxQuestion;\n          switch (cls)\n          {\n          case Information: sicon = QStyle::SP_MessageBoxInformation; break;\n          case Warning: sicon = QStyle::SP_MessageBoxWarning; break;\n          case Critical: sicon = QStyle::SP_MessageBoxCritical; break;\n          }\n          notificationIconPixmap = QApplication::style()->standardPixmap(sicon);\n      }\n      else {\n          QSize size = icon.actualSize(QSize(48, 48));\n          notificationIconPixmap = icon.pixmap(size);\n      }\n  \n      QString notificationIcon;\n      QTemporaryFile notificationIconFile;\n      if (!notificationIconPixmap.isNull() && notificationIconFile.open()) {\n          QImageWriter writer(&notificationIconFile, \"PNG\");\n          if (writer.write(notificationIconPixmap.toImage()))\n              notificationIcon = QString(\" image from location \\\"file://%1\\\"\").arg(notificationIconFile.fileName());\n      }\n  \n      QString quotedTitle(title), quotedText(text);\n      quotedTitle.replace(\"\\\\\", \"\\\\\\\\\").replace(\"\\\"\", \"\\\\\");\n      quotedText.replace(\"\\\\\", \"\\\\\\\\\").replace(\"\\\"\", \"\\\\\");\n      QString growlApp(this->mode == Notificator::Growl13 ? \"Growl\" : \"GrowlHelperApp\");\n      qt_mac_execute_apple_script(script.arg(notificationApp, quotedTitle, quotedText, notificationIcon, growlApp), 0);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "notifySystray",
          "args": [
            "cls",
            "title",
            "text",
            "icon",
            "millisTimeout"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "notifySystray",
          "container": "Notificator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
          "lines": "214-225",
          "snippet": "void Notificator::notifySystray(Class cls, const QString &title, const QString &text, const QIcon &icon, int millisTimeout)\n{\n    Q_UNUSED(icon);\n    QSystemTrayIcon::MessageIcon sicon = QSystemTrayIcon::NoIcon;\n    switch(cls) // Set icon based on class\n    {\n    case Information: sicon = QSystemTrayIcon::Information; break;\n    case Warning: sicon = QSystemTrayIcon::Warning; break;\n    case Critical: sicon = QSystemTrayIcon::Critical; break;\n    }\n    trayIcon->showMessage(title, text, sicon, millisTimeout);\n}",
          "includes": [
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <stdint.h>",
            "#include <QtDBus/QtDBus>",
            "#include <QImageWriter>",
            "#include <QTemporaryFile>",
            "#include <QMessageBox>",
            "#include <QSystemTrayIcon>",
            "#include <QByteArray>",
            "#include <QStyle>",
            "#include <QApplication>",
            "#include <QIcon>",
            "#include <QVariant>",
            "#include <QMetaType>",
            "#include \"notificator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nNotificator {\n  void Notificator::notifySystray(Class cls, const QString &title, const QString &text, const QIcon &icon, int millisTimeout)\n  {\n      Q_UNUSED(icon);\n      QSystemTrayIcon::MessageIcon sicon = QSystemTrayIcon::NoIcon;\n      switch(cls) // Set icon based on class\n      {\n      case Information: sicon = QSystemTrayIcon::Information; break;\n      case Warning: sicon = QSystemTrayIcon::Warning; break;\n      case Critical: sicon = QSystemTrayIcon::Critical; break;\n      }\n      trayIcon->showMessage(title, text, sicon, millisTimeout);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "notifyDBus",
          "args": [
            "cls",
            "title",
            "text",
            "icon",
            "millisTimeout"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "notifyDBus",
          "container": "Notificator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
          "lines": "157-211",
          "snippet": "void Notificator::notifyDBus(Class cls, const QString &title, const QString &text, const QIcon &icon, int millisTimeout)\n{\n    Q_UNUSED(cls);\n    // Arguments for DBus call:\n    QList<QVariant> args;\n\n    // Program Name:\n    args.append(programName);\n\n    // Unique ID of this notification type:\n    args.append(0U);\n\n    // Application Icon, empty string\n    args.append(QString());\n\n    // Summary\n    args.append(title);\n\n    // Body\n    args.append(text);\n\n    // Actions (none, actions are deprecated)\n    QStringList actions;\n    args.append(actions);\n\n    // Hints\n    QVariantMap hints;\n\n    // If no icon specified, set icon based on class\n    QIcon tmpicon;\n    if(icon.isNull())\n    {\n        QStyle::StandardPixmap sicon = QStyle::SP_MessageBoxQuestion;\n        switch(cls)\n        {\n        case Information: sicon = QStyle::SP_MessageBoxInformation; break;\n        case Warning: sicon = QStyle::SP_MessageBoxWarning; break;\n        case Critical: sicon = QStyle::SP_MessageBoxCritical; break;\n        default: break;\n        }\n        tmpicon = QApplication::style()->standardIcon(sicon);\n    }\n    else\n    {\n        tmpicon = icon;\n    }\n    hints[\"icon_data\"] = FreedesktopImage::toVariant(tmpicon.pixmap(FREEDESKTOP_NOTIFICATION_ICON_SIZE).toImage());\n    args.append(hints);\n\n    // Timeout (in msec)\n    args.append(millisTimeout);\n\n    // \"Fire and forget\"\n    interface->callWithArgumentList(QDBus::NoBlock, \"Notify\", args);\n}",
          "includes": [
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <stdint.h>",
            "#include <QtDBus/QtDBus>",
            "#include <QImageWriter>",
            "#include <QTemporaryFile>",
            "#include <QMessageBox>",
            "#include <QSystemTrayIcon>",
            "#include <QByteArray>",
            "#include <QStyle>",
            "#include <QApplication>",
            "#include <QIcon>",
            "#include <QVariant>",
            "#include <QMetaType>",
            "#include \"notificator.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const int FREEDESKTOP_NOTIFICATION_ICON_SIZE = 128;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nconst int FREEDESKTOP_NOTIFICATION_ICON_SIZE = 128;\n\nNotificator {\n  void Notificator::notifyDBus(Class cls, const QString &title, const QString &text, const QIcon &icon, int millisTimeout)\n  {\n      Q_UNUSED(cls);\n      // Arguments for DBus call:\n      QList<QVariant> args;\n  \n      // Program Name:\n      args.append(programName);\n  \n      // Unique ID of this notification type:\n      args.append(0U);\n  \n      // Application Icon, empty string\n      args.append(QString());\n  \n      // Summary\n      args.append(title);\n  \n      // Body\n      args.append(text);\n  \n      // Actions (none, actions are deprecated)\n      QStringList actions;\n      args.append(actions);\n  \n      // Hints\n      QVariantMap hints;\n  \n      // If no icon specified, set icon based on class\n      QIcon tmpicon;\n      if(icon.isNull())\n      {\n          QStyle::StandardPixmap sicon = QStyle::SP_MessageBoxQuestion;\n          switch(cls)\n          {\n          case Information: sicon = QStyle::SP_MessageBoxInformation; break;\n          case Warning: sicon = QStyle::SP_MessageBoxWarning; break;\n          case Critical: sicon = QStyle::SP_MessageBoxCritical; break;\n          default: break;\n          }\n          tmpicon = QApplication::style()->standardIcon(sicon);\n      }\n      else\n      {\n          tmpicon = icon;\n      }\n      hints[\"icon_data\"] = FreedesktopImage::toVariant(tmpicon.pixmap(FREEDESKTOP_NOTIFICATION_ICON_SIZE).toImage());\n      args.append(hints);\n  \n      // Timeout (in msec)\n      args.append(millisTimeout);\n  \n      // \"Fire and forget\"\n      interface->callWithArgumentList(QDBus::NoBlock, \"Notify\", args);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nNotificator {\n  void Notificator::notify(Class cls, const QString &title, const QString &text, const QIcon &icon, int millisTimeout)\n  {\n      switch(mode)\n      {\n  #ifdef USE_DBUS\n      case Freedesktop:\n          notifyDBus(cls, title, text, icon, millisTimeout);\n          break;\n  #endif\n      case QSystemTray:\n          notifySystray(cls, title, text, icon, millisTimeout);\n          break;\n  #ifdef Q_OS_MAC\n      case Growl12:\n      case Growl13:\n          notifyGrowl(cls, title, text, icon);\n          break;\n  #endif\n      default:\n          if(cls == Critical)\n          {\n              // Fall back to old fashioned pop-up dialog if critical and no other notification available\n              QMessageBox::critical(parent, title, text, QMessageBox::Ok, QMessageBox::Ok);\n          }\n          break;\n      }\n  }\n}"
  },
  {
    "function_name": "notifyGrowl",
    "container": "Notificator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
    "lines": "229-273",
    "snippet": "void Notificator::notifyGrowl(Class cls, const QString &title, const QString &text, const QIcon &icon)\n{\n    const QString script(\n        \"tell application \\\"%5\\\"\\n\"\n        \"  set the allNotificationsList to {\\\"Notification\\\"}\\n\" // -- Make a list of all the notification types (all)\n        \"  set the enabledNotificationsList to {\\\"Notification\\\"}\\n\" // -- Make a list of the notifications (enabled)\n        \"  register as application \\\"%1\\\" all notifications allNotificationsList default notifications enabledNotificationsList\\n\" // -- Register our script with Growl\n        \"  notify with name \\\"Notification\\\" title \\\"%2\\\" description \\\"%3\\\" application name \\\"%1\\\"%4\\n\" // -- Send a Notification\n        \"end tell\"\n    );\n\n    QString notificationApp(QApplication::applicationName());\n    if (notificationApp.isEmpty())\n        notificationApp = \"Application\";\n\n    QPixmap notificationIconPixmap;\n    if (icon.isNull()) { // If no icon specified, set icon based on class\n        QStyle::StandardPixmap sicon = QStyle::SP_MessageBoxQuestion;\n        switch (cls)\n        {\n        case Information: sicon = QStyle::SP_MessageBoxInformation; break;\n        case Warning: sicon = QStyle::SP_MessageBoxWarning; break;\n        case Critical: sicon = QStyle::SP_MessageBoxCritical; break;\n        }\n        notificationIconPixmap = QApplication::style()->standardPixmap(sicon);\n    }\n    else {\n        QSize size = icon.actualSize(QSize(48, 48));\n        notificationIconPixmap = icon.pixmap(size);\n    }\n\n    QString notificationIcon;\n    QTemporaryFile notificationIconFile;\n    if (!notificationIconPixmap.isNull() && notificationIconFile.open()) {\n        QImageWriter writer(&notificationIconFile, \"PNG\");\n        if (writer.write(notificationIconPixmap.toImage()))\n            notificationIcon = QString(\" image from location \\\"file://%1\\\"\").arg(notificationIconFile.fileName());\n    }\n\n    QString quotedTitle(title), quotedText(text);\n    quotedTitle.replace(\"\\\\\", \"\\\\\\\\\").replace(\"\\\"\", \"\\\\\");\n    quotedText.replace(\"\\\\\", \"\\\\\\\\\").replace(\"\\\"\", \"\\\\\");\n    QString growlApp(this->mode == Notificator::Growl13 ? \"Growl\" : \"GrowlHelperApp\");\n    qt_mac_execute_apple_script(script.arg(notificationApp, quotedTitle, quotedText, notificationIcon, growlApp), 0);\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <stdint.h>",
      "#include <QtDBus/QtDBus>",
      "#include <QImageWriter>",
      "#include <QTemporaryFile>",
      "#include <QMessageBox>",
      "#include <QSystemTrayIcon>",
      "#include <QByteArray>",
      "#include <QStyle>",
      "#include <QApplication>",
      "#include <QIcon>",
      "#include <QVariant>",
      "#include <QMetaType>",
      "#include \"notificator.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qt_mac_execute_apple_script",
          "args": [
            "script.arg(notificationApp, quotedTitle, quotedText, notificationIcon, growlApp)",
            "0"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "script.arg",
          "args": [
            "notificationApp",
            "quotedTitle",
            "quotedText",
            "notificationIcon",
            "growlApp"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "quotedText.replace",
          "args": [
            "\"\\\"\"",
            "\"\\\\\""
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "quotedText.replace",
          "args": [
            "\"\\\\\"",
            "\"\\\\\\\\\""
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "quotedTitle.replace",
          "args": [
            "\"\\\"\"",
            "\"\\\\\""
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "quotedTitle.replace",
          "args": [
            "\"\\\\\"",
            "\"\\\\\\\\\""
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "notificationIconFile.fileName()"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notificationIconFile.fileName",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" image from location \\\"file://%1\\\"\""
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writer.write",
          "args": [
            "notificationIconPixmap.toImage()"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "json_spirit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer.cpp",
          "lines": "85-88",
          "snippet": "std::wstring json_spirit::write( const wmValue&  value )\n{\n    return write_string( value, false );\n}",
          "includes": [
            "#include \"json_spirit_writer_template.h\"",
            "#include \"json_spirit_writer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"json_spirit_writer_template.h\"\n#include \"json_spirit_writer.h\"\n\njson_spirit {\n  std::wstring json_spirit::write( const wmValue&  value )\n  {\n      return write_string( value, false );\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "notificationIconPixmap.toImage",
          "args": [],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notificationIconFile.open",
          "args": [],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notificationIconPixmap.isNull",
          "args": [],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "icon.pixmap",
          "args": [
            "size"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "icon.actualSize",
          "args": [
            "QSize(48, 48)"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QSize",
          "args": [
            "48",
            "48"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::style",
          "args": [
            "sicon"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::style",
          "args": [],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "icon.isNull",
          "args": [],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notificationApp.isEmpty",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nNotificator {\n  void Notificator::notifyGrowl(Class cls, const QString &title, const QString &text, const QIcon &icon)\n  {\n      const QString script(\n          \"tell application \\\"%5\\\"\\n\"\n          \"  set the allNotificationsList to {\\\"Notification\\\"}\\n\" // -- Make a list of all the notification types (all)\n          \"  set the enabledNotificationsList to {\\\"Notification\\\"}\\n\" // -- Make a list of the notifications (enabled)\n          \"  register as application \\\"%1\\\" all notifications allNotificationsList default notifications enabledNotificationsList\\n\" // -- Register our script with Growl\n          \"  notify with name \\\"Notification\\\" title \\\"%2\\\" description \\\"%3\\\" application name \\\"%1\\\"%4\\n\" // -- Send a Notification\n          \"end tell\"\n      );\n  \n      QString notificationApp(QApplication::applicationName());\n      if (notificationApp.isEmpty())\n          notificationApp = \"Application\";\n  \n      QPixmap notificationIconPixmap;\n      if (icon.isNull()) { // If no icon specified, set icon based on class\n          QStyle::StandardPixmap sicon = QStyle::SP_MessageBoxQuestion;\n          switch (cls)\n          {\n          case Information: sicon = QStyle::SP_MessageBoxInformation; break;\n          case Warning: sicon = QStyle::SP_MessageBoxWarning; break;\n          case Critical: sicon = QStyle::SP_MessageBoxCritical; break;\n          }\n          notificationIconPixmap = QApplication::style()->standardPixmap(sicon);\n      }\n      else {\n          QSize size = icon.actualSize(QSize(48, 48));\n          notificationIconPixmap = icon.pixmap(size);\n      }\n  \n      QString notificationIcon;\n      QTemporaryFile notificationIconFile;\n      if (!notificationIconPixmap.isNull() && notificationIconFile.open()) {\n          QImageWriter writer(&notificationIconFile, \"PNG\");\n          if (writer.write(notificationIconPixmap.toImage()))\n              notificationIcon = QString(\" image from location \\\"file://%1\\\"\").arg(notificationIconFile.fileName());\n      }\n  \n      QString quotedTitle(title), quotedText(text);\n      quotedTitle.replace(\"\\\\\", \"\\\\\\\\\").replace(\"\\\"\", \"\\\\\");\n      quotedText.replace(\"\\\\\", \"\\\\\\\\\").replace(\"\\\"\", \"\\\\\");\n      QString growlApp(this->mode == Notificator::Growl13 ? \"Growl\" : \"GrowlHelperApp\");\n      qt_mac_execute_apple_script(script.arg(notificationApp, quotedTitle, quotedText, notificationIcon, growlApp), 0);\n  }\n}"
  },
  {
    "function_name": "notifySystray",
    "container": "Notificator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
    "lines": "214-225",
    "snippet": "void Notificator::notifySystray(Class cls, const QString &title, const QString &text, const QIcon &icon, int millisTimeout)\n{\n    Q_UNUSED(icon);\n    QSystemTrayIcon::MessageIcon sicon = QSystemTrayIcon::NoIcon;\n    switch(cls) // Set icon based on class\n    {\n    case Information: sicon = QSystemTrayIcon::Information; break;\n    case Warning: sicon = QSystemTrayIcon::Warning; break;\n    case Critical: sicon = QSystemTrayIcon::Critical; break;\n    }\n    trayIcon->showMessage(title, text, sicon, millisTimeout);\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <stdint.h>",
      "#include <QtDBus/QtDBus>",
      "#include <QImageWriter>",
      "#include <QTemporaryFile>",
      "#include <QMessageBox>",
      "#include <QSystemTrayIcon>",
      "#include <QByteArray>",
      "#include <QStyle>",
      "#include <QApplication>",
      "#include <QIcon>",
      "#include <QVariant>",
      "#include <QMetaType>",
      "#include \"notificator.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "trayIcon->showMessage",
          "args": [
            "title",
            "text",
            "sicon",
            "millisTimeout"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_UNUSED",
          "args": [
            "icon"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nNotificator {\n  void Notificator::notifySystray(Class cls, const QString &title, const QString &text, const QIcon &icon, int millisTimeout)\n  {\n      Q_UNUSED(icon);\n      QSystemTrayIcon::MessageIcon sicon = QSystemTrayIcon::NoIcon;\n      switch(cls) // Set icon based on class\n      {\n      case Information: sicon = QSystemTrayIcon::Information; break;\n      case Warning: sicon = QSystemTrayIcon::Warning; break;\n      case Critical: sicon = QSystemTrayIcon::Critical; break;\n      }\n      trayIcon->showMessage(title, text, sicon, millisTimeout);\n  }\n}"
  },
  {
    "function_name": "notifyDBus",
    "container": "Notificator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
    "lines": "157-211",
    "snippet": "void Notificator::notifyDBus(Class cls, const QString &title, const QString &text, const QIcon &icon, int millisTimeout)\n{\n    Q_UNUSED(cls);\n    // Arguments for DBus call:\n    QList<QVariant> args;\n\n    // Program Name:\n    args.append(programName);\n\n    // Unique ID of this notification type:\n    args.append(0U);\n\n    // Application Icon, empty string\n    args.append(QString());\n\n    // Summary\n    args.append(title);\n\n    // Body\n    args.append(text);\n\n    // Actions (none, actions are deprecated)\n    QStringList actions;\n    args.append(actions);\n\n    // Hints\n    QVariantMap hints;\n\n    // If no icon specified, set icon based on class\n    QIcon tmpicon;\n    if(icon.isNull())\n    {\n        QStyle::StandardPixmap sicon = QStyle::SP_MessageBoxQuestion;\n        switch(cls)\n        {\n        case Information: sicon = QStyle::SP_MessageBoxInformation; break;\n        case Warning: sicon = QStyle::SP_MessageBoxWarning; break;\n        case Critical: sicon = QStyle::SP_MessageBoxCritical; break;\n        default: break;\n        }\n        tmpicon = QApplication::style()->standardIcon(sicon);\n    }\n    else\n    {\n        tmpicon = icon;\n    }\n    hints[\"icon_data\"] = FreedesktopImage::toVariant(tmpicon.pixmap(FREEDESKTOP_NOTIFICATION_ICON_SIZE).toImage());\n    args.append(hints);\n\n    // Timeout (in msec)\n    args.append(millisTimeout);\n\n    // \"Fire and forget\"\n    interface->callWithArgumentList(QDBus::NoBlock, \"Notify\", args);\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <stdint.h>",
      "#include <QtDBus/QtDBus>",
      "#include <QImageWriter>",
      "#include <QTemporaryFile>",
      "#include <QMessageBox>",
      "#include <QSystemTrayIcon>",
      "#include <QByteArray>",
      "#include <QStyle>",
      "#include <QApplication>",
      "#include <QIcon>",
      "#include <QVariant>",
      "#include <QMetaType>",
      "#include \"notificator.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "const int FREEDESKTOP_NOTIFICATION_ICON_SIZE = 128;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "interface->callWithArgumentList",
          "args": [
            "QDBus::NoBlock",
            "\"Notify\"",
            "args"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.append",
          "args": [
            "millisTimeout"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.append",
          "args": [
            "hints"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FreedesktopImage::toVariant",
          "args": [
            "tmpicon.pixmap(FREEDESKTOP_NOTIFICATION_ICON_SIZE).toImage()"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "toVariant",
          "container": "FreedesktopImage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
          "lines": "151-155",
          "snippet": "QVariant FreedesktopImage::toVariant(const QImage &img)\n{\n    FreedesktopImage fimg(img);\n    return QVariant(FreedesktopImage::metaType(), &fimg);\n}",
          "includes": [
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <stdint.h>",
            "#include <QtDBus/QtDBus>",
            "#include <QImageWriter>",
            "#include <QTemporaryFile>",
            "#include <QMessageBox>",
            "#include <QSystemTrayIcon>",
            "#include <QByteArray>",
            "#include <QStyle>",
            "#include <QApplication>",
            "#include <QIcon>",
            "#include <QVariant>",
            "#include <QMetaType>",
            "#include \"notificator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nFreedesktopImage {\n  QVariant FreedesktopImage::toVariant(const QImage &img)\n  {\n      FreedesktopImage fimg(img);\n      return QVariant(FreedesktopImage::metaType(), &fimg);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tmpicon.pixmap",
          "args": [],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tmpicon.pixmap",
          "args": [
            "FREEDESKTOP_NOTIFICATION_ICON_SIZE"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::style",
          "args": [
            "sicon"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::style",
          "args": [],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "icon.isNull",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.append",
          "args": [
            "actions"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.append",
          "args": [
            "text"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.append",
          "args": [
            "title"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.append",
          "args": [
            "QString()"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.append",
          "args": [
            "0U"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.append",
          "args": [
            "programName"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_UNUSED",
          "args": [
            "cls"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nconst int FREEDESKTOP_NOTIFICATION_ICON_SIZE = 128;\n\nNotificator {\n  void Notificator::notifyDBus(Class cls, const QString &title, const QString &text, const QIcon &icon, int millisTimeout)\n  {\n      Q_UNUSED(cls);\n      // Arguments for DBus call:\n      QList<QVariant> args;\n  \n      // Program Name:\n      args.append(programName);\n  \n      // Unique ID of this notification type:\n      args.append(0U);\n  \n      // Application Icon, empty string\n      args.append(QString());\n  \n      // Summary\n      args.append(title);\n  \n      // Body\n      args.append(text);\n  \n      // Actions (none, actions are deprecated)\n      QStringList actions;\n      args.append(actions);\n  \n      // Hints\n      QVariantMap hints;\n  \n      // If no icon specified, set icon based on class\n      QIcon tmpicon;\n      if(icon.isNull())\n      {\n          QStyle::StandardPixmap sicon = QStyle::SP_MessageBoxQuestion;\n          switch(cls)\n          {\n          case Information: sicon = QStyle::SP_MessageBoxInformation; break;\n          case Warning: sicon = QStyle::SP_MessageBoxWarning; break;\n          case Critical: sicon = QStyle::SP_MessageBoxCritical; break;\n          default: break;\n          }\n          tmpicon = QApplication::style()->standardIcon(sicon);\n      }\n      else\n      {\n          tmpicon = icon;\n      }\n      hints[\"icon_data\"] = FreedesktopImage::toVariant(tmpicon.pixmap(FREEDESKTOP_NOTIFICATION_ICON_SIZE).toImage());\n      args.append(hints);\n  \n      // Timeout (in msec)\n      args.append(millisTimeout);\n  \n      // \"Fire and forget\"\n      interface->callWithArgumentList(QDBus::NoBlock, \"Notify\", args);\n  }\n}"
  },
  {
    "function_name": "toVariant",
    "container": "FreedesktopImage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
    "lines": "151-155",
    "snippet": "QVariant FreedesktopImage::toVariant(const QImage &img)\n{\n    FreedesktopImage fimg(img);\n    return QVariant(FreedesktopImage::metaType(), &fimg);\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <stdint.h>",
      "#include <QtDBus/QtDBus>",
      "#include <QImageWriter>",
      "#include <QTemporaryFile>",
      "#include <QMessageBox>",
      "#include <QSystemTrayIcon>",
      "#include <QByteArray>",
      "#include <QStyle>",
      "#include <QApplication>",
      "#include <QIcon>",
      "#include <QVariant>",
      "#include <QMetaType>",
      "#include \"notificator.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "FreedesktopImage::metaType()",
            "&fimg"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FreedesktopImage::metaType",
          "args": [],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "metaType",
          "container": "FreedesktopImage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
          "lines": "146-149",
          "snippet": "int FreedesktopImage::metaType()\n{\n    return qDBusRegisterMetaType<FreedesktopImage>();\n}",
          "includes": [
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <stdint.h>",
            "#include <QtDBus/QtDBus>",
            "#include <QImageWriter>",
            "#include <QTemporaryFile>",
            "#include <QMessageBox>",
            "#include <QSystemTrayIcon>",
            "#include <QByteArray>",
            "#include <QStyle>",
            "#include <QApplication>",
            "#include <QIcon>",
            "#include <QVariant>",
            "#include <QMetaType>",
            "#include \"notificator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nFreedesktopImage {\n  int FreedesktopImage::metaType()\n  {\n      return qDBusRegisterMetaType<FreedesktopImage>();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nFreedesktopImage {\n  QVariant FreedesktopImage::toVariant(const QImage &img)\n  {\n      FreedesktopImage fimg(img);\n      return QVariant(FreedesktopImage::metaType(), &fimg);\n  }\n}"
  },
  {
    "function_name": "metaType",
    "container": "FreedesktopImage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
    "lines": "146-149",
    "snippet": "int FreedesktopImage::metaType()\n{\n    return qDBusRegisterMetaType<FreedesktopImage>();\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <stdint.h>",
      "#include <QtDBus/QtDBus>",
      "#include <QImageWriter>",
      "#include <QTemporaryFile>",
      "#include <QMessageBox>",
      "#include <QSystemTrayIcon>",
      "#include <QByteArray>",
      "#include <QStyle>",
      "#include <QApplication>",
      "#include <QIcon>",
      "#include <QVariant>",
      "#include <QMetaType>",
      "#include \"notificator.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qDBusRegisterMetaType<FreedesktopImage>",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nFreedesktopImage {\n  int FreedesktopImage::metaType()\n  {\n      return qDBusRegisterMetaType<FreedesktopImage>();\n  }\n}"
  },
  {
    "function_name": "FreedesktopImage",
    "container": "FreedesktopImage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
    "lines": "106-128",
    "snippet": "FreedesktopImage::FreedesktopImage(const QImage &img):\n    width(img.width()),\n    height(img.height()),\n    stride(img.width() * BYTES_PER_PIXEL),\n    hasAlpha(true),\n    channels(CHANNELS),\n    bitsPerSample(BITS_PER_SAMPLE)\n{\n    // Convert 00xAARRGGBB to RGBA bytewise (endian-independent) format\n    QImage tmp = img.convertToFormat(QImage::Format_ARGB32);\n    const uint32_t *data = reinterpret_cast<const uint32_t*>(tmp.bits());\n\n    unsigned int num_pixels = width * height;\n    image.resize(num_pixels * BYTES_PER_PIXEL);\n\n    for(unsigned int ptr = 0; ptr < num_pixels; ++ptr)\n    {\n        image[ptr*BYTES_PER_PIXEL+0] = data[ptr] >> 16; // R\n        image[ptr*BYTES_PER_PIXEL+1] = data[ptr] >> 8;  // G\n        image[ptr*BYTES_PER_PIXEL+2] = data[ptr];       // B\n        image[ptr*BYTES_PER_PIXEL+3] = data[ptr] >> 24; // A\n    }\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <stdint.h>",
      "#include <QtDBus/QtDBus>",
      "#include <QImageWriter>",
      "#include <QTemporaryFile>",
      "#include <QMessageBox>",
      "#include <QSystemTrayIcon>",
      "#include <QByteArray>",
      "#include <QStyle>",
      "#include <QApplication>",
      "#include <QIcon>",
      "#include <QVariant>",
      "#include <QMetaType>",
      "#include \"notificator.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "image.resize",
          "args": [
            "num_pixels * BYTES_PER_PIXEL"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<const uint32_t*>",
          "args": [
            "tmp.bits()"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tmp.bits",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "img.convertToFormat",
          "args": [
            "QImage::Format_ARGB32"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "img.width",
          "args": [],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "img.height",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "img.width",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nFreedesktopImage {\n  FreedesktopImage::FreedesktopImage(const QImage &img):\n      width(img.width()),\n      height(img.height()),\n      stride(img.width() * BYTES_PER_PIXEL),\n      hasAlpha(true),\n      channels(CHANNELS),\n      bitsPerSample(BITS_PER_SAMPLE)\n  {\n      // Convert 00xAARRGGBB to RGBA bytewise (endian-independent) format\n      QImage tmp = img.convertToFormat(QImage::Format_ARGB32);\n      const uint32_t *data = reinterpret_cast<const uint32_t*>(tmp.bits());\n  \n      unsigned int num_pixels = width * height;\n      image.resize(num_pixels * BYTES_PER_PIXEL);\n  \n      for(unsigned int ptr = 0; ptr < num_pixels; ++ptr)\n      {\n          image[ptr*BYTES_PER_PIXEL+0] = data[ptr] >> 16; // R\n          image[ptr*BYTES_PER_PIXEL+1] = data[ptr] >> 8;  // G\n          image[ptr*BYTES_PER_PIXEL+2] = data[ptr];       // B\n          image[ptr*BYTES_PER_PIXEL+3] = data[ptr] >> 24; // A\n      }\n  }\n}"
  },
  {
    "function_name": "FreedesktopImage",
    "container": "FreedesktopImage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
    "lines": "80-80",
    "snippet": "FreedesktopImage() {}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <stdint.h>",
      "#include <QtDBus/QtDBus>",
      "#include <QImageWriter>",
      "#include <QTemporaryFile>",
      "#include <QMessageBox>",
      "#include <QSystemTrayIcon>",
      "#include <QByteArray>",
      "#include <QStyle>",
      "#include <QApplication>",
      "#include <QIcon>",
      "#include <QVariant>",
      "#include <QMetaType>",
      "#include \"notificator.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nFreedesktopImage {\n  FreedesktopImage() {}\n}"
  },
  {
    "function_name": "~Notificator",
    "container": "Notificator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
    "lines": "67-72",
    "snippet": "Notificator::~Notificator()\n{\n#ifdef USE_DBUS\n    delete interface;\n#endif\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <stdint.h>",
      "#include <QtDBus/QtDBus>",
      "#include <QImageWriter>",
      "#include <QTemporaryFile>",
      "#include <QMessageBox>",
      "#include <QSystemTrayIcon>",
      "#include <QByteArray>",
      "#include <QStyle>",
      "#include <QApplication>",
      "#include <QIcon>",
      "#include <QVariant>",
      "#include <QMetaType>",
      "#include \"notificator.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nNotificator {\n  Notificator::~Notificator()\n  {\n  #ifdef USE_DBUS\n      delete interface;\n  #endif\n  }\n}"
  },
  {
    "function_name": "Notificator",
    "container": "Notificator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/notificator.cpp",
    "lines": "27-65",
    "snippet": "Notificator::Notificator(const QString &programName, QSystemTrayIcon *trayicon, QWidget *parent):\n    QObject(parent),\n    parent(parent),\n    programName(programName),\n    mode(None),\n    trayIcon(trayicon)\n#ifdef USE_DBUS\n    ,interface(0)\n#endif\n{\n    if(trayicon && trayicon->supportsMessages())\n    {\n        mode = QSystemTray;\n    }\n#ifdef USE_DBUS\n    interface = new QDBusInterface(\"org.freedesktop.Notifications\",\n          \"/org/freedesktop/Notifications\", \"org.freedesktop.Notifications\");\n    if(interface->isValid())\n    {\n        mode = Freedesktop;\n    }\n#endif\n#ifdef Q_OS_MAC\n    // Check if Growl is installed (based on Qt's tray icon implementation)\n    CFURLRef cfurl;\n    OSStatus status = LSGetApplicationForInfo(kLSUnknownType, kLSUnknownCreator, CFSTR(\"growlTicket\"), kLSRolesAll, 0, &cfurl);\n    if (status != kLSApplicationNotFoundErr) {\n        CFBundleRef bundle = CFBundleCreate(0, cfurl);\n        if (CFStringCompare(CFBundleGetIdentifier(bundle), CFSTR(\"com.Growl.GrowlHelperApp\"), kCFCompareCaseInsensitive | kCFCompareBackwards) == kCFCompareEqualTo) {\n            if (CFStringHasSuffix(CFURLGetString(cfurl), CFSTR(\"/Growl.app/\")))\n                mode = Growl13;\n            else\n                mode = Growl12;\n        }\n        CFRelease(cfurl);\n        CFRelease(bundle);\n    }\n#endif\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <stdint.h>",
      "#include <QtDBus/QtDBus>",
      "#include <QImageWriter>",
      "#include <QTemporaryFile>",
      "#include <QMessageBox>",
      "#include <QSystemTrayIcon>",
      "#include <QByteArray>",
      "#include <QStyle>",
      "#include <QApplication>",
      "#include <QIcon>",
      "#include <QVariant>",
      "#include <QMetaType>",
      "#include \"notificator.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CFRelease",
          "args": [
            "bundle"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CFRelease",
          "args": [
            "cfurl"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CFStringHasSuffix",
          "args": [
            "CFURLGetString(cfurl)",
            "CFSTR(\"/Growl.app/\")"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CFSTR",
          "args": [
            "\"/Growl.app/\""
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CFURLGetString",
          "args": [
            "cfurl"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CFStringCompare",
          "args": [
            "CFBundleGetIdentifier(bundle)",
            "CFSTR(\"com.Growl.GrowlHelperApp\")",
            "kCFCompareCaseInsensitive | kCFCompareBackwards"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CFSTR",
          "args": [
            "\"com.Growl.GrowlHelperApp\""
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CFBundleGetIdentifier",
          "args": [
            "bundle"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CFBundleCreate",
          "args": [
            "0",
            "cfurl"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LSGetApplicationForInfo",
          "args": [
            "kLSUnknownType",
            "kLSUnknownCreator",
            "CFSTR(\"growlTicket\")",
            "kLSRolesAll",
            "0",
            "&cfurl"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CFSTR",
          "args": [
            "\"growlTicket\""
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "interface->isValid",
          "args": [],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "WalletModel::UnlockContext",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.h",
          "lines": "106-106",
          "snippet": "bool isValid() const { return valid; }",
          "includes": [
            "#include \"allocators.h\" /* for SecureString */",
            "#include <map>",
            "#include <vector>",
            "#include <QObject>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"allocators.h\" /* for SecureString */\n#include <map>\n#include <vector>\n#include <QObject>\n\nWalletModel {\n  UnlockContext {\n    bool isValid() const { return valid; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "trayicon->supportsMessages",
          "args": [],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <stdint.h>\n#include <QtDBus/QtDBus>\n#include <QImageWriter>\n#include <QTemporaryFile>\n#include <QMessageBox>\n#include <QSystemTrayIcon>\n#include <QByteArray>\n#include <QStyle>\n#include <QApplication>\n#include <QIcon>\n#include <QVariant>\n#include <QMetaType>\n#include \"notificator.h\"\n\nNotificator {\n  Notificator::Notificator(const QString &programName, QSystemTrayIcon *trayicon, QWidget *parent):\n      QObject(parent),\n      parent(parent),\n      programName(programName),\n      mode(None),\n      trayIcon(trayicon)\n  #ifdef USE_DBUS\n      ,interface(0)\n  #endif\n  {\n      if(trayicon && trayicon->supportsMessages())\n      {\n          mode = QSystemTray;\n      }\n  #ifdef USE_DBUS\n      interface = new QDBusInterface(\"org.freedesktop.Notifications\",\n            \"/org/freedesktop/Notifications\", \"org.freedesktop.Notifications\");\n      if(interface->isValid())\n      {\n          mode = Freedesktop;\n      }\n  #endif\n  #ifdef Q_OS_MAC\n      // Check if Growl is installed (based on Qt's tray icon implementation)\n      CFURLRef cfurl;\n      OSStatus status = LSGetApplicationForInfo(kLSUnknownType, kLSUnknownCreator, CFSTR(\"growlTicket\"), kLSRolesAll, 0, &cfurl);\n      if (status != kLSApplicationNotFoundErr) {\n          CFBundleRef bundle = CFBundleCreate(0, cfurl);\n          if (CFStringCompare(CFBundleGetIdentifier(bundle), CFSTR(\"com.Growl.GrowlHelperApp\"), kCFCompareCaseInsensitive | kCFCompareBackwards) == kCFCompareEqualTo) {\n              if (CFStringHasSuffix(CFURLGetString(cfurl), CFSTR(\"/Growl.app/\")))\n                  mode = Growl13;\n              else\n                  mode = Growl12;\n          }\n          CFRelease(cfurl);\n          CFRelease(bundle);\n      }\n  #endif\n  }\n}"
  }
]