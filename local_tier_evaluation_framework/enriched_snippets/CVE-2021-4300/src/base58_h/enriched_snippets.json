[
  {
    "function_name": "CBitcoinSecret",
    "container": "CBitcoinSecret",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "455-457",
    "snippet": "CBitcoinSecret()\n    {\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  CBitcoinSecret()\n      {\n      }\n}"
  },
  {
    "function_name": "CBitcoinSecret",
    "container": "CBitcoinSecret",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "450-453",
    "snippet": "CBitcoinSecret(const CSecret& vchSecret, bool fCompressed)\n    {\n        SetSecret(vchSecret, fCompressed);\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetSecret",
          "args": [
            "vchSecret",
            "fCompressed"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "SetSecret",
          "container": "CBitcoinSecret",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "405-411",
          "snippet": "void SetSecret(const CSecret& vchSecret, bool fCompressed)\n    {\n        assert(vchSecret.size() == 32);\n        SetData(128 + (fTestNet ? CBitcoinAddress::PUBKEY_ADDRESS_TEST : CBitcoinAddress::PUBKEY_ADDRESS), &vchSecret[0], vchSecret.size());\n        if (fCompressed)\n            vchData.push_back(1);\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  void SetSecret(const CSecret& vchSecret, bool fCompressed)\n      {\n          assert(vchSecret.size() == 32);\n          SetData(128 + (fTestNet ? CBitcoinAddress::PUBKEY_ADDRESS_TEST : CBitcoinAddress::PUBKEY_ADDRESS), &vchSecret[0], vchSecret.size());\n          if (fCompressed)\n              vchData.push_back(1);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  CBitcoinSecret(const CSecret& vchSecret, bool fCompressed)\n      {\n          SetSecret(vchSecret, fCompressed);\n      }\n}"
  },
  {
    "function_name": "SetString",
    "container": "CBitcoinSecret",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "445-448",
    "snippet": "bool SetString(const std::string& strSecret)\n    {\n        return SetString(strSecret.c_str());\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetString",
          "args": [
            "strSecret.c_str()"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "SetString",
          "container": "CBitcoinSecret",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "445-448",
          "snippet": "bool SetString(const std::string& strSecret)\n    {\n        return SetString(strSecret.c_str());\n    }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "strSecret.c_str",
          "args": [],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  bool SetString(const std::string& strSecret)\n      {\n          return SetString(strSecret.c_str());\n      }\n}"
  },
  {
    "function_name": "SetString",
    "container": "CBitcoinSecret",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "440-443",
    "snippet": "bool SetString(const char* pszSecret)\n    {\n        return CBase58Data::SetString(pszSecret) && IsValid();\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsValid",
          "args": [],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "IsValid",
          "container": "CBitcoinSecret",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "422-438",
          "snippet": "bool IsValid() const\n    {\n        bool fExpectTestNet = false;\n        switch(nVersion)\n        {\n            case (128 + CBitcoinAddress::PUBKEY_ADDRESS):\n                break;\n\n            case (128 + CBitcoinAddress::PUBKEY_ADDRESS_TEST):\n                fExpectTestNet = true;\n                break;\n\n            default:\n                return false;\n        }\n        return fExpectTestNet == fTestNet && (vchData.size() == 32 || (vchData.size() == 33 && vchData[32] == 1));\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  bool IsValid() const\n      {\n          bool fExpectTestNet = false;\n          switch(nVersion)\n          {\n              case (128 + CBitcoinAddress::PUBKEY_ADDRESS):\n                  break;\n  \n              case (128 + CBitcoinAddress::PUBKEY_ADDRESS_TEST):\n                  fExpectTestNet = true;\n                  break;\n  \n              default:\n                  return false;\n          }\n          return fExpectTestNet == fTestNet && (vchData.size() == 32 || (vchData.size() == 33 && vchData[32] == 1));\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CBase58Data::SetString",
          "args": [
            "pszSecret"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "SetString",
          "container": "CBase58Data",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "228-231",
          "snippet": "bool SetString(const std::string& str)\n    {\n        return SetString(str.c_str());\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBase58Data {\n  bool SetString(const std::string& str)\n      {\n          return SetString(str.c_str());\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  bool SetString(const char* pszSecret)\n      {\n          return CBase58Data::SetString(pszSecret) && IsValid();\n      }\n}"
  },
  {
    "function_name": "IsValid",
    "container": "CBitcoinSecret",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "422-438",
    "snippet": "bool IsValid() const\n    {\n        bool fExpectTestNet = false;\n        switch(nVersion)\n        {\n            case (128 + CBitcoinAddress::PUBKEY_ADDRESS):\n                break;\n\n            case (128 + CBitcoinAddress::PUBKEY_ADDRESS_TEST):\n                fExpectTestNet = true;\n                break;\n\n            default:\n                return false;\n        }\n        return fExpectTestNet == fTestNet && (vchData.size() == 32 || (vchData.size() == 33 && vchData[32] == 1));\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vchData.size",
          "args": [],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  bool IsValid() const\n      {\n          bool fExpectTestNet = false;\n          switch(nVersion)\n          {\n              case (128 + CBitcoinAddress::PUBKEY_ADDRESS):\n                  break;\n  \n              case (128 + CBitcoinAddress::PUBKEY_ADDRESS_TEST):\n                  fExpectTestNet = true;\n                  break;\n  \n              default:\n                  return false;\n          }\n          return fExpectTestNet == fTestNet && (vchData.size() == 32 || (vchData.size() == 33 && vchData[32] == 1));\n      }\n}"
  },
  {
    "function_name": "GetSecret",
    "container": "CBitcoinSecret",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "413-420",
    "snippet": "CSecret GetSecret(bool &fCompressedOut)\n    {\n        CSecret vchSecret;\n        vchSecret.resize(32);\n        memcpy(&vchSecret[0], &vchData[0], 32);\n        fCompressedOut = vchData.size() == 33;\n        return vchSecret;\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vchData.size",
          "args": [],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&vchSecret[0]",
            "&vchData[0]",
            "32"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchSecret.resize",
          "args": [
            "32"
          ],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  CSecret GetSecret(bool &fCompressedOut)\n      {\n          CSecret vchSecret;\n          vchSecret.resize(32);\n          memcpy(&vchSecret[0], &vchData[0], 32);\n          fCompressedOut = vchData.size() == 33;\n          return vchSecret;\n      }\n}"
  },
  {
    "function_name": "SetSecret",
    "container": "CBitcoinSecret",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "405-411",
    "snippet": "void SetSecret(const CSecret& vchSecret, bool fCompressed)\n    {\n        assert(vchSecret.size() == 32);\n        SetData(128 + (fTestNet ? CBitcoinAddress::PUBKEY_ADDRESS_TEST : CBitcoinAddress::PUBKEY_ADDRESS), &vchSecret[0], vchSecret.size());\n        if (fCompressed)\n            vchData.push_back(1);\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vchData.push_back",
          "args": [
            "1"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetData",
          "args": [
            "128 + (fTestNet ? CBitcoinAddress::PUBKEY_ADDRESS_TEST : CBitcoinAddress::PUBKEY_ADDRESS)",
            "&vchSecret[0]",
            "vchSecret.size()"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "SetData",
          "container": "CBase58Data",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "204-207",
          "snippet": "void SetData(int nVersionIn, const unsigned char *pbegin, const unsigned char *pend)\n    {\n        SetData(nVersionIn, (void*)pbegin, pend - pbegin);\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBase58Data {\n  void SetData(int nVersionIn, const unsigned char *pbegin, const unsigned char *pend)\n      {\n          SetData(nVersionIn, (void*)pbegin, pend - pbegin);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchSecret.size",
          "args": [],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "vchSecret.size() == 32"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  void SetSecret(const CSecret& vchSecret, bool fCompressed)\n      {\n          assert(vchSecret.size() == 32);\n          SetData(128 + (fTestNet ? CBitcoinAddress::PUBKEY_ADDRESS_TEST : CBitcoinAddress::PUBKEY_ADDRESS), &vchSecret[0], vchSecret.size());\n          if (fCompressed)\n              vchData.push_back(1);\n      }\n}"
  },
  {
    "function_name": "operator()",
    "container": "CBitcoinAddressVisitor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "399-399",
    "snippet": "bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddressVisitor {\n  bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }\n}"
  },
  {
    "function_name": "operator()",
    "container": "CBitcoinAddressVisitor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "398-398",
    "snippet": "bool inline CBitcoinAddressVisitor::operator()(const CScriptID &id) const      { return addr->Set(id); }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "addr->Set",
          "args": [
            "id"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "Set",
          "container": "CBitcoinAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "295-298",
          "snippet": "bool Set(const CTxDestination &dest)\n    {\n        return boost::apply_visitor(CBitcoinAddressVisitor(this), dest);\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool Set(const CTxDestination &dest)\n      {\n          return boost::apply_visitor(CBitcoinAddressVisitor(this), dest);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddressVisitor {\n  bool inline CBitcoinAddressVisitor::operator()(const CScriptID &id) const      { return addr->Set(id); }\n}"
  },
  {
    "function_name": "operator()",
    "container": "CBitcoinAddressVisitor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "397-397",
    "snippet": "bool inline CBitcoinAddressVisitor::operator()(const CKeyID &id) const         { return addr->Set(id); }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "addr->Set",
          "args": [
            "id"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "Set",
          "container": "CBitcoinAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "295-298",
          "snippet": "bool Set(const CTxDestination &dest)\n    {\n        return boost::apply_visitor(CBitcoinAddressVisitor(this), dest);\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool Set(const CTxDestination &dest)\n      {\n          return boost::apply_visitor(CBitcoinAddressVisitor(this), dest);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddressVisitor {\n  bool inline CBitcoinAddressVisitor::operator()(const CKeyID &id) const         { return addr->Set(id); }\n}"
  },
  {
    "function_name": "IsScript",
    "container": "CBitcoinAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "384-394",
    "snippet": "bool IsScript() const {\n        if (!IsValid())\n            return false;\n        switch (nVersion) {\n        case SCRIPT_ADDRESS:\n        case SCRIPT_ADDRESS_TEST: {\n            return true;\n        }\n        default: return false;\n        }\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsValid",
          "args": [],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "IsValid",
          "container": "CBitcoinSecret",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "422-438",
          "snippet": "bool IsValid() const\n    {\n        bool fExpectTestNet = false;\n        switch(nVersion)\n        {\n            case (128 + CBitcoinAddress::PUBKEY_ADDRESS):\n                break;\n\n            case (128 + CBitcoinAddress::PUBKEY_ADDRESS_TEST):\n                fExpectTestNet = true;\n                break;\n\n            default:\n                return false;\n        }\n        return fExpectTestNet == fTestNet && (vchData.size() == 32 || (vchData.size() == 33 && vchData[32] == 1));\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  bool IsValid() const\n      {\n          bool fExpectTestNet = false;\n          switch(nVersion)\n          {\n              case (128 + CBitcoinAddress::PUBKEY_ADDRESS):\n                  break;\n  \n              case (128 + CBitcoinAddress::PUBKEY_ADDRESS_TEST):\n                  fExpectTestNet = true;\n                  break;\n  \n              default:\n                  return false;\n          }\n          return fExpectTestNet == fTestNet && (vchData.size() == 32 || (vchData.size() == 33 && vchData[32] == 1));\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool IsScript() const {\n          if (!IsValid())\n              return false;\n          switch (nVersion) {\n          case SCRIPT_ADDRESS:\n          case SCRIPT_ADDRESS_TEST: {\n              return true;\n          }\n          default: return false;\n          }\n      }\n}"
  },
  {
    "function_name": "GetKeyID",
    "container": "CBitcoinAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "369-382",
    "snippet": "bool GetKeyID(CKeyID &keyID) const {\n        if (!IsValid())\n            return false;\n        switch (nVersion) {\n        case PUBKEY_ADDRESS:\n        case PUBKEY_ADDRESS_TEST: {\n            uint160 id;\n            memcpy(&id, &vchData[0], 20);\n            keyID = CKeyID(id);\n            return true;\n        }\n        default: return false;\n        }\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CKeyID",
          "args": [
            "id"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "CKeyID",
          "container": "CKeyID",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "52-52",
          "snippet": "CKeyID(const uint160 &in) : uint160(in) { }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCKeyID {\n  CKeyID(const uint160 &in) : uint160(in) { }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&id",
            "&vchData[0]",
            "20"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsValid",
          "args": [],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "IsValid",
          "container": "CBitcoinSecret",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "422-438",
          "snippet": "bool IsValid() const\n    {\n        bool fExpectTestNet = false;\n        switch(nVersion)\n        {\n            case (128 + CBitcoinAddress::PUBKEY_ADDRESS):\n                break;\n\n            case (128 + CBitcoinAddress::PUBKEY_ADDRESS_TEST):\n                fExpectTestNet = true;\n                break;\n\n            default:\n                return false;\n        }\n        return fExpectTestNet == fTestNet && (vchData.size() == 32 || (vchData.size() == 33 && vchData[32] == 1));\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  bool IsValid() const\n      {\n          bool fExpectTestNet = false;\n          switch(nVersion)\n          {\n              case (128 + CBitcoinAddress::PUBKEY_ADDRESS):\n                  break;\n  \n              case (128 + CBitcoinAddress::PUBKEY_ADDRESS_TEST):\n                  fExpectTestNet = true;\n                  break;\n  \n              default:\n                  return false;\n          }\n          return fExpectTestNet == fTestNet && (vchData.size() == 32 || (vchData.size() == 33 && vchData[32] == 1));\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool GetKeyID(CKeyID &keyID) const {\n          if (!IsValid())\n              return false;\n          switch (nVersion) {\n          case PUBKEY_ADDRESS:\n          case PUBKEY_ADDRESS_TEST: {\n              uint160 id;\n              memcpy(&id, &vchData[0], 20);\n              keyID = CKeyID(id);\n              return true;\n          }\n          default: return false;\n          }\n      }\n}"
  },
  {
    "function_name": "Get",
    "container": "CBitcoinAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "349-367",
    "snippet": "CTxDestination Get() const {\n        if (!IsValid())\n            return CNoDestination();\n        switch (nVersion) {\n        case PUBKEY_ADDRESS:\n        case PUBKEY_ADDRESS_TEST: {\n            uint160 id;\n            memcpy(&id, &vchData[0], 20);\n            return CKeyID(id);\n        }\n        case SCRIPT_ADDRESS:\n        case SCRIPT_ADDRESS_TEST: {\n            uint160 id;\n            memcpy(&id, &vchData[0], 20);\n            return CScriptID(id);\n        }\n        }\n        return CNoDestination();\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CNoDestination",
          "args": [],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CScriptID",
          "args": [
            "id"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "CScriptID",
          "container": "CScriptID",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "60-60",
          "snippet": "CScriptID(const uint160 &in) : uint160(in) { }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCScriptID {\n  CScriptID(const uint160 &in) : uint160(in) { }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&id",
            "&vchData[0]",
            "20"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CKeyID",
          "args": [
            "id"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "CKeyID",
          "container": "CKeyID",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "52-52",
          "snippet": "CKeyID(const uint160 &in) : uint160(in) { }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCKeyID {\n  CKeyID(const uint160 &in) : uint160(in) { }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&id",
            "&vchData[0]",
            "20"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CNoDestination",
          "args": [],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsValid",
          "args": [],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "IsValid",
          "container": "CBitcoinSecret",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "422-438",
          "snippet": "bool IsValid() const\n    {\n        bool fExpectTestNet = false;\n        switch(nVersion)\n        {\n            case (128 + CBitcoinAddress::PUBKEY_ADDRESS):\n                break;\n\n            case (128 + CBitcoinAddress::PUBKEY_ADDRESS_TEST):\n                fExpectTestNet = true;\n                break;\n\n            default:\n                return false;\n        }\n        return fExpectTestNet == fTestNet && (vchData.size() == 32 || (vchData.size() == 33 && vchData[32] == 1));\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  bool IsValid() const\n      {\n          bool fExpectTestNet = false;\n          switch(nVersion)\n          {\n              case (128 + CBitcoinAddress::PUBKEY_ADDRESS):\n                  break;\n  \n              case (128 + CBitcoinAddress::PUBKEY_ADDRESS_TEST):\n                  fExpectTestNet = true;\n                  break;\n  \n              default:\n                  return false;\n          }\n          return fExpectTestNet == fTestNet && (vchData.size() == 32 || (vchData.size() == 33 && vchData[32] == 1));\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  CTxDestination Get() const {\n          if (!IsValid())\n              return CNoDestination();\n          switch (nVersion) {\n          case PUBKEY_ADDRESS:\n          case PUBKEY_ADDRESS_TEST: {\n              uint160 id;\n              memcpy(&id, &vchData[0], 20);\n              return CKeyID(id);\n          }\n          case SCRIPT_ADDRESS:\n          case SCRIPT_ADDRESS_TEST: {\n              uint160 id;\n              memcpy(&id, &vchData[0], 20);\n              return CScriptID(id);\n          }\n          }\n          return CNoDestination();\n      }\n}"
  },
  {
    "function_name": "CBitcoinAddress",
    "container": "CBitcoinAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "344-347",
    "snippet": "CBitcoinAddress(const char* pszAddress)\n    {\n        SetString(pszAddress);\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetString",
          "args": [
            "pszAddress"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "SetString",
          "container": "CBitcoinSecret",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "445-448",
          "snippet": "bool SetString(const std::string& strSecret)\n    {\n        return SetString(strSecret.c_str());\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  bool SetString(const std::string& strSecret)\n      {\n          return SetString(strSecret.c_str());\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  CBitcoinAddress(const char* pszAddress)\n      {\n          SetString(pszAddress);\n      }\n}"
  },
  {
    "function_name": "CBitcoinAddress",
    "container": "CBitcoinAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "339-342",
    "snippet": "CBitcoinAddress(const std::string& strAddress)\n    {\n        SetString(strAddress);\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetString",
          "args": [
            "strAddress"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "SetString",
          "container": "CBitcoinSecret",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "445-448",
          "snippet": "bool SetString(const std::string& strSecret)\n    {\n        return SetString(strSecret.c_str());\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  bool SetString(const std::string& strSecret)\n      {\n          return SetString(strSecret.c_str());\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  CBitcoinAddress(const std::string& strAddress)\n      {\n          SetString(strAddress);\n      }\n}"
  },
  {
    "function_name": "CBitcoinAddress",
    "container": "CBitcoinAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "334-337",
    "snippet": "CBitcoinAddress(const CTxDestination &dest)\n    {\n        Set(dest);\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Set",
          "args": [
            "dest"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "SetString",
          "container": "CBitcoinSecret",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "445-448",
          "snippet": "bool SetString(const std::string& strSecret)\n    {\n        return SetString(strSecret.c_str());\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  bool SetString(const std::string& strSecret)\n      {\n          return SetString(strSecret.c_str());\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  CBitcoinAddress(const CTxDestination &dest)\n      {\n          Set(dest);\n      }\n}"
  },
  {
    "function_name": "CBitcoinAddress",
    "container": "CBitcoinAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "330-332",
    "snippet": "CBitcoinAddress()\n    {\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  CBitcoinAddress()\n      {\n      }\n}"
  },
  {
    "function_name": "IsValid",
    "container": "CBitcoinAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "300-328",
    "snippet": "bool IsValid() const\n    {\n        unsigned int nExpectedSize = 20;\n        bool fExpectTestNet = false;\n        switch(nVersion)\n        {\n            case PUBKEY_ADDRESS:\n                nExpectedSize = 20; // Hash of public key\n                fExpectTestNet = false;\n                break;\n            case SCRIPT_ADDRESS:\n                nExpectedSize = 20; // Hash of CScript\n                fExpectTestNet = false;\n                break;\n\n            case PUBKEY_ADDRESS_TEST:\n                nExpectedSize = 20;\n                fExpectTestNet = true;\n                break;\n            case SCRIPT_ADDRESS_TEST:\n                nExpectedSize = 20;\n                fExpectTestNet = true;\n                break;\n\n            default:\n                return false;\n        }\n        return fExpectTestNet == fTestNet && vchData.size() == nExpectedSize;\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vchData.size",
          "args": [],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool IsValid() const\n      {\n          unsigned int nExpectedSize = 20;\n          bool fExpectTestNet = false;\n          switch(nVersion)\n          {\n              case PUBKEY_ADDRESS:\n                  nExpectedSize = 20; // Hash of public key\n                  fExpectTestNet = false;\n                  break;\n              case SCRIPT_ADDRESS:\n                  nExpectedSize = 20; // Hash of CScript\n                  fExpectTestNet = false;\n                  break;\n  \n              case PUBKEY_ADDRESS_TEST:\n                  nExpectedSize = 20;\n                  fExpectTestNet = true;\n                  break;\n              case SCRIPT_ADDRESS_TEST:\n                  nExpectedSize = 20;\n                  fExpectTestNet = true;\n                  break;\n  \n              default:\n                  return false;\n          }\n          return fExpectTestNet == fTestNet && vchData.size() == nExpectedSize;\n      }\n}"
  },
  {
    "function_name": "Set",
    "container": "CBitcoinAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "295-298",
    "snippet": "bool Set(const CTxDestination &dest)\n    {\n        return boost::apply_visitor(CBitcoinAddressVisitor(this), dest);\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "boost::apply_visitor",
          "args": [
            "CBitcoinAddressVisitor(this)",
            "dest"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CBitcoinAddressVisitor",
          "args": [
            "this"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "operator()",
          "container": "CBitcoinAddressVisitor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "399-399",
          "snippet": "bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddressVisitor {\n  bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool Set(const CTxDestination &dest)\n      {\n          return boost::apply_visitor(CBitcoinAddressVisitor(this), dest);\n      }\n}"
  },
  {
    "function_name": "Set",
    "container": "CBitcoinAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "290-293",
    "snippet": "bool Set(const CScriptID &id) {\n        SetData(fTestNet ? SCRIPT_ADDRESS_TEST : SCRIPT_ADDRESS, &id, 20);\n        return true;\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetData",
          "args": [
            "fTestNet ? SCRIPT_ADDRESS_TEST : SCRIPT_ADDRESS",
            "&id",
            "20"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "SetData",
          "container": "CBase58Data",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "204-207",
          "snippet": "void SetData(int nVersionIn, const unsigned char *pbegin, const unsigned char *pend)\n    {\n        SetData(nVersionIn, (void*)pbegin, pend - pbegin);\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBase58Data {\n  void SetData(int nVersionIn, const unsigned char *pbegin, const unsigned char *pend)\n      {\n          SetData(nVersionIn, (void*)pbegin, pend - pbegin);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool Set(const CScriptID &id) {\n          SetData(fTestNet ? SCRIPT_ADDRESS_TEST : SCRIPT_ADDRESS, &id, 20);\n          return true;\n      }\n}"
  },
  {
    "function_name": "Set",
    "container": "CBitcoinAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "285-288",
    "snippet": "bool Set(const CKeyID &id) {\n        SetData(fTestNet ? PUBKEY_ADDRESS_TEST : PUBKEY_ADDRESS, &id, 20);\n        return true;\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetData",
          "args": [
            "fTestNet ? PUBKEY_ADDRESS_TEST : PUBKEY_ADDRESS",
            "&id",
            "20"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "SetData",
          "container": "CBase58Data",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "204-207",
          "snippet": "void SetData(int nVersionIn, const unsigned char *pbegin, const unsigned char *pend)\n    {\n        SetData(nVersionIn, (void*)pbegin, pend - pbegin);\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBase58Data {\n  void SetData(int nVersionIn, const unsigned char *pbegin, const unsigned char *pend)\n      {\n          SetData(nVersionIn, (void*)pbegin, pend - pbegin);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool Set(const CKeyID &id) {\n          SetData(fTestNet ? PUBKEY_ADDRESS_TEST : PUBKEY_ADDRESS, &id, 20);\n          return true;\n      }\n}"
  },
  {
    "function_name": "CBitcoinAddressVisitor",
    "container": "CBitcoinAddressVisitor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "268-268",
    "snippet": "CBitcoinAddressVisitor(CBitcoinAddress *addrIn) : addr(addrIn) { }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddressVisitor {\n  CBitcoinAddressVisitor(CBitcoinAddress *addrIn) : addr(addrIn) { }\n}"
  },
  {
    "function_name": "CompareTo",
    "container": "CBase58Data",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "240-247",
    "snippet": "int CompareTo(const CBase58Data& b58) const\n    {\n        if (nVersion < b58.nVersion) return -1;\n        if (nVersion > b58.nVersion) return  1;\n        if (vchData < b58.vchData)   return -1;\n        if (vchData > b58.vchData)   return  1;\n        return 0;\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBase58Data {\n  int CompareTo(const CBase58Data& b58) const\n      {\n          if (nVersion < b58.nVersion) return -1;\n          if (nVersion > b58.nVersion) return  1;\n          if (vchData < b58.vchData)   return -1;\n          if (vchData > b58.vchData)   return  1;\n          return 0;\n      }\n}"
  },
  {
    "function_name": "ToString",
    "container": "CBase58Data",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "233-238",
    "snippet": "std::string ToString() const\n    {\n        std::vector<unsigned char> vch(1, nVersion);\n        vch.insert(vch.end(), vchData.begin(), vchData.end());\n        return EncodeBase58Check(vch);\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EncodeBase58Check",
          "args": [
            "vch"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeBase58Check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "132-139",
          "snippet": "inline std::string EncodeBase58Check(const std::vector<unsigned char>& vchIn)\n{\n    // add 4-byte hash check to the end\n    std::vector<unsigned char> vch(vchIn);\n    uint256 hash = Hash(vch.begin(), vch.end());\n    vch.insert(vch.end(), (unsigned char*)&hash, (unsigned char*)&hash + 4);\n    return EncodeBase58(vch);\n}",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\ninline std::string EncodeBase58Check(const std::vector<unsigned char>& vchIn)\n{\n    // add 4-byte hash check to the end\n    std::vector<unsigned char> vch(vchIn);\n    uint256 hash = Hash(vch.begin(), vch.end());\n    vch.insert(vch.end(), (unsigned char*)&hash, (unsigned char*)&hash + 4);\n    return EncodeBase58(vch);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vch.insert",
          "args": [
            "vch.end()",
            "vchData.begin()",
            "vchData.end()"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "839-850",
          "snippet": "void insert(iterator it, const char* first, const char* last)\n    {\n        assert(last - first >= 0);\n        if (it == vch.begin() + nReadPos && (unsigned int)(last - first) <= nReadPos)\n        {\n            // special case for inserting at the front when there's room\n            nReadPos -= (last - first);\n            memcpy(&vch[nReadPos], &first[0], last - first);\n        }\n        else\n            vch.insert(it, first, last);\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void insert(iterator it, const char* first, const char* last)\n      {\n          assert(last - first >= 0);\n          if (it == vch.begin() + nReadPos && (unsigned int)(last - first) <= nReadPos)\n          {\n              // special case for inserting at the front when there's room\n              nReadPos -= (last - first);\n              memcpy(&vch[nReadPos], &first[0], last - first);\n          }\n          else\n              vch.insert(it, first, last);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchData.end",
          "args": [],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchData.begin",
          "args": [],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBase58Data {\n  std::string ToString() const\n      {\n          std::vector<unsigned char> vch(1, nVersion);\n          vch.insert(vch.end(), vchData.begin(), vchData.end());\n          return EncodeBase58Check(vch);\n      }\n}"
  },
  {
    "function_name": "SetString",
    "container": "CBase58Data",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "228-231",
    "snippet": "bool SetString(const std::string& str)\n    {\n        return SetString(str.c_str());\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetString",
          "args": [
            "str.c_str()"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "SetString",
          "container": "CBitcoinSecret",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "445-448",
          "snippet": "bool SetString(const std::string& strSecret)\n    {\n        return SetString(strSecret.c_str());\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinSecret {\n  bool SetString(const std::string& strSecret)\n      {\n          return SetString(strSecret.c_str());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBase58Data {\n  bool SetString(const std::string& str)\n      {\n          return SetString(str.c_str());\n      }\n}"
  },
  {
    "function_name": "SetString",
    "container": "CBase58Data",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "210-226",
    "snippet": "bool SetString(const char* psz)\n    {\n        std::vector<unsigned char> vchTemp;\n        DecodeBase58Check(psz, vchTemp);\n        if (vchTemp.empty())\n        {\n            vchData.clear();\n            nVersion = 0;\n            return false;\n        }\n        nVersion = vchTemp[0];\n        vchData.resize(vchTemp.size() - 1);\n        if (!vchData.empty())\n            memcpy(&vchData[0], &vchTemp[1], vchData.size());\n        memset(&vchTemp[0], 0, vchTemp.size());\n        return true;\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&vchTemp[0]",
            "0",
            "vchTemp.size()"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchTemp.size",
          "args": [],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&vchData[0]",
            "&vchTemp[1]",
            "vchData.size()"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchData.empty",
          "args": [],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchData.resize",
          "args": [
            "vchTemp.size() - 1"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchData.clear",
          "args": [],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DecodeBase58Check",
          "args": [
            "psz",
            "vchTemp"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeBase58Check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "164-167",
          "snippet": "inline bool DecodeBase58Check(const std::string& str, std::vector<unsigned char>& vchRet)\n{\n    return DecodeBase58Check(str.c_str(), vchRet);\n}",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\ninline bool DecodeBase58Check(const std::string& str, std::vector<unsigned char>& vchRet)\n{\n    return DecodeBase58Check(str.c_str(), vchRet);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBase58Data {\n  bool SetString(const char* psz)\n      {\n          std::vector<unsigned char> vchTemp;\n          DecodeBase58Check(psz, vchTemp);\n          if (vchTemp.empty())\n          {\n              vchData.clear();\n              nVersion = 0;\n              return false;\n          }\n          nVersion = vchTemp[0];\n          vchData.resize(vchTemp.size() - 1);\n          if (!vchData.empty())\n              memcpy(&vchData[0], &vchTemp[1], vchData.size());\n          memset(&vchTemp[0], 0, vchTemp.size());\n          return true;\n      }\n}"
  },
  {
    "function_name": "SetData",
    "container": "CBase58Data",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "204-207",
    "snippet": "void SetData(int nVersionIn, const unsigned char *pbegin, const unsigned char *pend)\n    {\n        SetData(nVersionIn, (void*)pbegin, pend - pbegin);\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetData",
          "args": [
            "nVersionIn",
            "(void*)pbegin",
            "pend - pbegin"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "SetData",
          "container": "CBase58Data",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "204-207",
          "snippet": "void SetData(int nVersionIn, const unsigned char *pbegin, const unsigned char *pend)\n    {\n        SetData(nVersionIn, (void*)pbegin, pend - pbegin);\n    }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBase58Data {\n  void SetData(int nVersionIn, const unsigned char *pbegin, const unsigned char *pend)\n      {\n          SetData(nVersionIn, (void*)pbegin, pend - pbegin);\n      }\n}"
  },
  {
    "function_name": "SetData",
    "container": "CBase58Data",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "196-202",
    "snippet": "void SetData(int nVersionIn, const void* pdata, size_t nSize)\n    {\n        nVersion = nVersionIn;\n        vchData.resize(nSize);\n        if (!vchData.empty())\n            memcpy(&vchData[0], pdata, nSize);\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&vchData[0]",
            "pdata",
            "nSize"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchData.empty",
          "args": [],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchData.resize",
          "args": [
            "nSize"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBase58Data {\n  void SetData(int nVersionIn, const void* pdata, size_t nSize)\n      {\n          nVersion = nVersionIn;\n          vchData.resize(nSize);\n          if (!vchData.empty())\n              memcpy(&vchData[0], pdata, nSize);\n      }\n}"
  },
  {
    "function_name": "CBase58Data",
    "container": "CBase58Data",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "183-187",
    "snippet": "CBase58Data()\n    {\n        nVersion = 0;\n        vchData.clear();\n    }",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vchData.clear",
          "args": [],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBase58Data {\n  CBase58Data()\n      {\n          nVersion = 0;\n          vchData.clear();\n      }\n}"
  },
  {
    "function_name": "DecodeBase58Check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "164-167",
    "snippet": "inline bool DecodeBase58Check(const std::string& str, std::vector<unsigned char>& vchRet)\n{\n    return DecodeBase58Check(str.c_str(), vchRet);\n}",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DecodeBase58Check",
          "args": [
            "str.c_str()",
            "vchRet"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeBase58Check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "164-167",
          "snippet": "inline bool DecodeBase58Check(const std::string& str, std::vector<unsigned char>& vchRet)\n{\n    return DecodeBase58Check(str.c_str(), vchRet);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\ninline bool DecodeBase58Check(const std::string& str, std::vector<unsigned char>& vchRet)\n{\n    return DecodeBase58Check(str.c_str(), vchRet);\n}"
  },
  {
    "function_name": "DecodeBase58Check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "143-160",
    "snippet": "inline bool DecodeBase58Check(const char* psz, std::vector<unsigned char>& vchRet)\n{\n    if (!DecodeBase58(psz, vchRet))\n        return false;\n    if (vchRet.size() < 4)\n    {\n        vchRet.clear();\n        return false;\n    }\n    uint256 hash = Hash(vchRet.begin(), vchRet.end()-4);\n    if (memcmp(&hash, &vchRet.end()[-4], 4) != 0)\n    {\n        vchRet.clear();\n        return false;\n    }\n    vchRet.resize(vchRet.size()-4);\n    return true;\n}",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vchRet.resize",
          "args": [
            "vchRet.size()-4"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchRet.size",
          "args": [],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchRet.clear",
          "args": [],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&hash",
            "&vchRet.end()[-4]",
            "4"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchRet.end",
          "args": [],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Hash",
          "args": [
            "vchRet.begin()",
            "vchRet.end()-4"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "Hash",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "34-38",
          "snippet": "inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n{\n    // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n    return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n  {\n      // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n      return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchRet.begin",
          "args": [],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DecodeBase58",
          "args": [
            "psz",
            "vchRet"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeBase58Check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "164-167",
          "snippet": "inline bool DecodeBase58Check(const std::string& str, std::vector<unsigned char>& vchRet)\n{\n    return DecodeBase58Check(str.c_str(), vchRet);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\ninline bool DecodeBase58Check(const char* psz, std::vector<unsigned char>& vchRet)\n{\n    if (!DecodeBase58(psz, vchRet))\n        return false;\n    if (vchRet.size() < 4)\n    {\n        vchRet.clear();\n        return false;\n    }\n    uint256 hash = Hash(vchRet.begin(), vchRet.end()-4);\n    if (memcmp(&hash, &vchRet.end()[-4], 4) != 0)\n    {\n        vchRet.clear();\n        return false;\n    }\n    vchRet.resize(vchRet.size()-4);\n    return true;\n}"
  },
  {
    "function_name": "EncodeBase58Check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "132-139",
    "snippet": "inline std::string EncodeBase58Check(const std::vector<unsigned char>& vchIn)\n{\n    // add 4-byte hash check to the end\n    std::vector<unsigned char> vch(vchIn);\n    uint256 hash = Hash(vch.begin(), vch.end());\n    vch.insert(vch.end(), (unsigned char*)&hash, (unsigned char*)&hash + 4);\n    return EncodeBase58(vch);\n}",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EncodeBase58",
          "args": [
            "vch"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeBase58Check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "132-139",
          "snippet": "inline std::string EncodeBase58Check(const std::vector<unsigned char>& vchIn)\n{\n    // add 4-byte hash check to the end\n    std::vector<unsigned char> vch(vchIn);\n    uint256 hash = Hash(vch.begin(), vch.end());\n    vch.insert(vch.end(), (unsigned char*)&hash, (unsigned char*)&hash + 4);\n    return EncodeBase58(vch);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "vch.insert",
          "args": [
            "vch.end()",
            "(unsigned char*)&hash",
            "(unsigned char*)&hash + 4"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "839-850",
          "snippet": "void insert(iterator it, const char* first, const char* last)\n    {\n        assert(last - first >= 0);\n        if (it == vch.begin() + nReadPos && (unsigned int)(last - first) <= nReadPos)\n        {\n            // special case for inserting at the front when there's room\n            nReadPos -= (last - first);\n            memcpy(&vch[nReadPos], &first[0], last - first);\n        }\n        else\n            vch.insert(it, first, last);\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void insert(iterator it, const char* first, const char* last)\n      {\n          assert(last - first >= 0);\n          if (it == vch.begin() + nReadPos && (unsigned int)(last - first) <= nReadPos)\n          {\n              // special case for inserting at the front when there's room\n              nReadPos -= (last - first);\n              memcpy(&vch[nReadPos], &first[0], last - first);\n          }\n          else\n              vch.insert(it, first, last);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vch.end",
          "args": [],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Hash",
          "args": [
            "vch.begin()",
            "vch.end()"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "Hash",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "34-38",
          "snippet": "inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n{\n    // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n    return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n  {\n      // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n      return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vch.begin",
          "args": [],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\ninline std::string EncodeBase58Check(const std::vector<unsigned char>& vchIn)\n{\n    // add 4-byte hash check to the end\n    std::vector<unsigned char> vch(vchIn);\n    uint256 hash = Hash(vch.begin(), vch.end());\n    vch.insert(vch.end(), (unsigned char*)&hash, (unsigned char*)&hash + 4);\n    return EncodeBase58(vch);\n}"
  },
  {
    "function_name": "DecodeBase58",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "123-126",
    "snippet": "inline bool DecodeBase58(const std::string& str, std::vector<unsigned char>& vchRet)\n{\n    return DecodeBase58(str.c_str(), vchRet);\n}",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DecodeBase58",
          "args": [
            "str.c_str()",
            "vchRet"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeBase58Check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "164-167",
          "snippet": "inline bool DecodeBase58Check(const std::string& str, std::vector<unsigned char>& vchRet)\n{\n    return DecodeBase58Check(str.c_str(), vchRet);\n}",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\ninline bool DecodeBase58Check(const std::string& str, std::vector<unsigned char>& vchRet)\n{\n    return DecodeBase58Check(str.c_str(), vchRet);\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\ninline bool DecodeBase58(const std::string& str, std::vector<unsigned char>& vchRet)\n{\n    return DecodeBase58(str.c_str(), vchRet);\n}"
  },
  {
    "function_name": "DecodeBase58",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "75-119",
    "snippet": "inline bool DecodeBase58(const char* psz, std::vector<unsigned char>& vchRet)\n{\n    CAutoBN_CTX pctx;\n    vchRet.clear();\n    CBigNum bn58 = 58;\n    CBigNum bn = 0;\n    CBigNum bnChar;\n    while (isspace(*psz))\n        psz++;\n\n    // Convert big endian string to bignum\n    for (const char* p = psz; *p; p++)\n    {\n        const char* p1 = strchr(pszBase58, *p);\n        if (p1 == NULL)\n        {\n            while (isspace(*p))\n                p++;\n            if (*p != '\\0')\n                return false;\n            break;\n        }\n        bnChar.setulong(p1 - pszBase58);\n        if (!BN_mul(&bn, &bn, &bn58, pctx))\n            throw bignum_error(\"DecodeBase58 : BN_mul failed\");\n        bn += bnChar;\n    }\n\n    // Get bignum as little endian data\n    std::vector<unsigned char> vchTmp = bn.getvch();\n\n    // Trim off sign byte if present\n    if (vchTmp.size() >= 2 && vchTmp.end()[-1] == 0 && vchTmp.end()[-2] >= 0x80)\n        vchTmp.erase(vchTmp.end()-1);\n\n    // Restore leading zeros\n    int nLeadingZeros = 0;\n    for (const char* p = psz; *p == pszBase58[0]; p++)\n        nLeadingZeros++;\n    vchRet.assign(nLeadingZeros + vchTmp.size(), 0);\n\n    // Convert little endian data to big endian\n    reverse_copy(vchTmp.begin(), vchTmp.end(), vchRet.end() - vchTmp.size());\n    return true;\n}",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reverse_copy",
          "args": [
            "vchTmp.begin()",
            "vchTmp.end()",
            "vchRet.end() - vchTmp.size()"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchTmp.size",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchRet.end",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchTmp.begin",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchRet.assign",
          "args": [
            "nLeadingZeros + vchTmp.size()",
            "0"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchTmp.erase",
          "args": [
            "vchTmp.end()-1"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "49-65",
          "snippet": "void erase(const key_type& k)\n    {\n        iterator itTarget = map.find(k);\n        if (itTarget == map.end())\n            return;\n        std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n        for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n            if (it->second == itTarget)\n            {\n                rmap.erase(it);\n                map.erase(itTarget);\n                return;\n            }\n        // Shouldn't ever get here\n        assert(0); //TODO remove me\n        map.erase(itTarget);\n    }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  void erase(const key_type& k)\n      {\n          iterator itTarget = map.find(k);\n          if (itTarget == map.end())\n              return;\n          std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n          for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n              if (it->second == itTarget)\n              {\n                  rmap.erase(it);\n                  map.erase(itTarget);\n                  return;\n              }\n          // Shouldn't ever get here\n          assert(0); //TODO remove me\n          map.erase(itTarget);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "bn.getvch",
          "args": [],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "getvch",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "309-319",
          "snippet": "std::vector<unsigned char> getvch() const\n    {\n        unsigned int nSize = BN_bn2mpi(this, NULL);\n        if (nSize <= 4)\n            return std::vector<unsigned char>();\n        std::vector<unsigned char> vch(nSize);\n        BN_bn2mpi(this, &vch[0]);\n        vch.erase(vch.begin(), vch.begin() + 4);\n        reverse(vch.begin(), vch.end());\n        return vch;\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  std::vector<unsigned char> getvch() const\n      {\n          unsigned int nSize = BN_bn2mpi(this, NULL);\n          if (nSize <= 4)\n              return std::vector<unsigned char>();\n          std::vector<unsigned char> vch(nSize);\n          BN_bn2mpi(this, &vch[0]);\n          vch.erase(vch.begin(), vch.begin() + 4);\n          reverse(vch.begin(), vch.end());\n          return vch;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"DecodeBase58 : BN_mul failed\""
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_mul",
          "args": [
            "&bn",
            "&bn",
            "&bn58",
            "pctx"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bnChar.setulong",
          "args": [
            "p1 - pszBase58"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "setulong",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "140-144",
          "snippet": "void setulong(unsigned long n)\n    {\n        if (!BN_set_word(this, n))\n            throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setulong(unsigned long n)\n      {\n          if (!BN_set_word(this, n))\n              throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "*p"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "pszBase58",
            "*p"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "*psz"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchRet.clear",
          "args": [],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\ninline bool DecodeBase58(const char* psz, std::vector<unsigned char>& vchRet)\n{\n    CAutoBN_CTX pctx;\n    vchRet.clear();\n    CBigNum bn58 = 58;\n    CBigNum bn = 0;\n    CBigNum bnChar;\n    while (isspace(*psz))\n        psz++;\n\n    // Convert big endian string to bignum\n    for (const char* p = psz; *p; p++)\n    {\n        const char* p1 = strchr(pszBase58, *p);\n        if (p1 == NULL)\n        {\n            while (isspace(*p))\n                p++;\n            if (*p != '\\0')\n                return false;\n            break;\n        }\n        bnChar.setulong(p1 - pszBase58);\n        if (!BN_mul(&bn, &bn, &bn58, pctx))\n            throw bignum_error(\"DecodeBase58 : BN_mul failed\");\n        bn += bnChar;\n    }\n\n    // Get bignum as little endian data\n    std::vector<unsigned char> vchTmp = bn.getvch();\n\n    // Trim off sign byte if present\n    if (vchTmp.size() >= 2 && vchTmp.end()[-1] == 0 && vchTmp.end()[-2] >= 0x80)\n        vchTmp.erase(vchTmp.end()-1);\n\n    // Restore leading zeros\n    int nLeadingZeros = 0;\n    for (const char* p = psz; *p == pszBase58[0]; p++)\n        nLeadingZeros++;\n    vchRet.assign(nLeadingZeros + vchTmp.size(), 0);\n\n    // Convert little endian data to big endian\n    reverse_copy(vchTmp.begin(), vchTmp.end(), vchRet.end() - vchTmp.size());\n    return true;\n}"
  },
  {
    "function_name": "EncodeBase58",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "68-71",
    "snippet": "inline std::string EncodeBase58(const std::vector<unsigned char>& vch)\n{\n    return EncodeBase58(&vch[0], &vch[0] + vch.size());\n}",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EncodeBase58",
          "args": [
            "&vch[0]",
            "&vch[0] + vch.size()"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeBase58",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "27-65",
          "snippet": "inline std::string EncodeBase58(const unsigned char* pbegin, const unsigned char* pend)\n{\n    CAutoBN_CTX pctx;\n    CBigNum bn58 = 58;\n    CBigNum bn0 = 0;\n\n    // Convert big endian data to little endian\n    // Extra zero at the end make sure bignum will interpret as a positive number\n    std::vector<unsigned char> vchTmp(pend-pbegin+1, 0);\n    reverse_copy(pbegin, pend, vchTmp.begin());\n\n    // Convert little endian data to bignum\n    CBigNum bn;\n    bn.setvch(vchTmp);\n\n    // Convert bignum to std::string\n    std::string str;\n    // Expected size increase from base58 conversion is approximately 137%\n    // use 138% to be safe\n    str.reserve((pend - pbegin) * 138 / 100 + 1);\n    CBigNum dv;\n    CBigNum rem;\n    while (bn > bn0)\n    {\n        if (!BN_div(&dv, &rem, &bn, &bn58, pctx))\n            throw bignum_error(\"EncodeBase58 : BN_div failed\");\n        bn = dv;\n        unsigned int c = rem.getulong();\n        str += pszBase58[c];\n    }\n\n    // Leading zeroes encoded as base58 zeros\n    for (const unsigned char* p = pbegin; p < pend && *p == 0; p++)\n        str += pszBase58[0];\n\n    // Convert little endian std::string to big endian\n    reverse(str.begin(), str.end());\n    return str;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "vch.size",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\ninline std::string EncodeBase58(const std::vector<unsigned char>& vch)\n{\n    return EncodeBase58(&vch[0], &vch[0] + vch.size());\n}"
  },
  {
    "function_name": "EncodeBase58",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
    "lines": "27-65",
    "snippet": "inline std::string EncodeBase58(const unsigned char* pbegin, const unsigned char* pend)\n{\n    CAutoBN_CTX pctx;\n    CBigNum bn58 = 58;\n    CBigNum bn0 = 0;\n\n    // Convert big endian data to little endian\n    // Extra zero at the end make sure bignum will interpret as a positive number\n    std::vector<unsigned char> vchTmp(pend-pbegin+1, 0);\n    reverse_copy(pbegin, pend, vchTmp.begin());\n\n    // Convert little endian data to bignum\n    CBigNum bn;\n    bn.setvch(vchTmp);\n\n    // Convert bignum to std::string\n    std::string str;\n    // Expected size increase from base58 conversion is approximately 137%\n    // use 138% to be safe\n    str.reserve((pend - pbegin) * 138 / 100 + 1);\n    CBigNum dv;\n    CBigNum rem;\n    while (bn > bn0)\n    {\n        if (!BN_div(&dv, &rem, &bn, &bn58, pctx))\n            throw bignum_error(\"EncodeBase58 : BN_div failed\");\n        bn = dv;\n        unsigned int c = rem.getulong();\n        str += pszBase58[c];\n    }\n\n    // Leading zeroes encoded as base58 zeros\n    for (const unsigned char* p = pbegin; p < pend && *p == 0; p++)\n        str += pszBase58[0];\n\n    // Convert little endian std::string to big endian\n    reverse(str.begin(), str.end());\n    return str;\n}",
    "includes": [
      "#include \"script.h\"",
      "#include \"key.h\"",
      "#include \"bignum.h\"",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reverse",
          "args": [
            "str.begin()",
            "str.end()"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.end",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.begin",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rem.getulong",
          "args": [],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "getulong",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "146-149",
          "snippet": "unsigned long getulong() const\n    {\n        return BN_get_word(this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  unsigned long getulong() const\n      {\n          return BN_get_word(this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"EncodeBase58 : BN_div failed\""
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_div",
          "args": [
            "&dv",
            "&rem",
            "&bn",
            "&bn58",
            "pctx"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.reserve",
          "args": [
            "(pend - pbegin) * 138 / 100 + 1"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "805-805",
          "snippet": "void reserve(size_type n)                        { vch.reserve(n + nReadPos); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void reserve(size_type n)                        { vch.reserve(n + nReadPos); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "bn.setvch",
          "args": [
            "vchTmp"
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "setvch",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "294-307",
          "snippet": "void setvch(const std::vector<unsigned char>& vch)\n    {\n        std::vector<unsigned char> vch2(vch.size() + 4);\n        unsigned int nSize = vch.size();\n        // BIGNUM's byte stream format expects 4 bytes of\n        // big endian size data info at the front\n        vch2[0] = (nSize >> 24) & 0xff;\n        vch2[1] = (nSize >> 16) & 0xff;\n        vch2[2] = (nSize >> 8) & 0xff;\n        vch2[3] = (nSize >> 0) & 0xff;\n        // swap data to big endian\n        reverse_copy(vch.begin(), vch.end(), vch2.begin() + 4);\n        BN_mpi2bn(&vch2[0], vch2.size(), this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setvch(const std::vector<unsigned char>& vch)\n      {\n          std::vector<unsigned char> vch2(vch.size() + 4);\n          unsigned int nSize = vch.size();\n          // BIGNUM's byte stream format expects 4 bytes of\n          // big endian size data info at the front\n          vch2[0] = (nSize >> 24) & 0xff;\n          vch2[1] = (nSize >> 16) & 0xff;\n          vch2[2] = (nSize >> 8) & 0xff;\n          vch2[3] = (nSize >> 0) & 0xff;\n          // swap data to big endian\n          reverse_copy(vch.begin(), vch.end(), vch2.begin() + 4);\n          BN_mpi2bn(&vch2[0], vch2.size(), this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reverse_copy",
          "args": [
            "pbegin",
            "pend",
            "vchTmp.begin()"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\ninline std::string EncodeBase58(const unsigned char* pbegin, const unsigned char* pend)\n{\n    CAutoBN_CTX pctx;\n    CBigNum bn58 = 58;\n    CBigNum bn0 = 0;\n\n    // Convert big endian data to little endian\n    // Extra zero at the end make sure bignum will interpret as a positive number\n    std::vector<unsigned char> vchTmp(pend-pbegin+1, 0);\n    reverse_copy(pbegin, pend, vchTmp.begin());\n\n    // Convert little endian data to bignum\n    CBigNum bn;\n    bn.setvch(vchTmp);\n\n    // Convert bignum to std::string\n    std::string str;\n    // Expected size increase from base58 conversion is approximately 137%\n    // use 138% to be safe\n    str.reserve((pend - pbegin) * 138 / 100 + 1);\n    CBigNum dv;\n    CBigNum rem;\n    while (bn > bn0)\n    {\n        if (!BN_div(&dv, &rem, &bn, &bn58, pctx))\n            throw bignum_error(\"EncodeBase58 : BN_div failed\");\n        bn = dv;\n        unsigned int c = rem.getulong();\n        str += pszBase58[c];\n    }\n\n    // Leading zeroes encoded as base58 zeros\n    for (const unsigned char* p = pbegin; p < pend && *p == 0; p++)\n        str += pszBase58[0];\n\n    // Convert little endian std::string to big endian\n    reverse(str.begin(), str.end());\n    return str;\n}"
  }
]