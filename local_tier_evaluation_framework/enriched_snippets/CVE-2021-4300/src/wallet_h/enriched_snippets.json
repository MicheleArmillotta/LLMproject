[
  {
    "function_name": "if",
    "container": "CAccountingEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "857-867",
    "snippet": "if (fRead)\n        {\n            me.mapValue.clear();\n            if (std::string::npos != nSepPos)\n            {\n                CDataStream ss(std::vector<char>(strComment.begin() + nSepPos + 1, strComment.end()), nType, nVersion);\n                ss >> me.mapValue;\n                me._ssExtra = std::vector<char>(ss.begin(), ss.end());\n            }\n            ReadOrderPos(me.nOrderPos, me.mapValue);\n        }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReadOrderPos",
          "args": [
            "me.nOrderPos",
            "me.mapValue"
          ],
          "line": 866
        },
        "resolved": true,
        "details": {
          "function_name": "ReadOrderPos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "357-365",
          "snippet": "static void ReadOrderPos(int64_t& nOrderPos, mapValue_t& mapValue)\n{\n    if (!mapValue.count(\"n\"))\n    {\n        nOrderPos = -1; // TODO: calculate elsewhere\n        return;\n    }\n    nOrderPos = atoi64(mapValue[\"n\"].c_str());\n}",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nstatic void ReadOrderPos(int64_t& nOrderPos, mapValue_t& mapValue)\n{\n    if (!mapValue.count(\"n\"))\n    {\n        nOrderPos = -1; // TODO: calculate elsewhere\n        return;\n    }\n    nOrderPos = atoi64(mapValue[\"n\"].c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::vector<char>",
          "args": [
            "ss.begin()",
            "ss.end()"
          ],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ss.end",
          "args": [],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ss.begin",
          "args": [],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::vector<char>",
          "args": [
            "strComment.begin() + nSepPos + 1",
            "strComment.end()"
          ],
          "line": 862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "me.mapValue.clear",
          "args": [],
          "line": 859
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCAccountingEntry {\n  if (fRead)\n          {\n              me.mapValue.clear();\n              if (std::string::npos != nSepPos)\n              {\n                  CDataStream ss(std::vector<char>(strComment.begin() + nSepPos + 1, strComment.end()), nType, nVersion);\n                  ss >> me.mapValue;\n                  me._ssExtra = std::vector<char>(ss.begin(), ss.end());\n              }\n              ReadOrderPos(me.nOrderPos, me.mapValue);\n          }\n}"
  },
  {
    "function_name": "SetNull",
    "container": "CAccountingEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "820-828",
    "snippet": "void SetNull()\n    {\n        nCreditDebit = 0;\n        nTime = 0;\n        strAccount.clear();\n        strOtherAccount.clear();\n        strComment.clear();\n        nOrderPos = -1;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strComment.clear",
          "args": [],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCAccountingEntry {\n  void SetNull()\n      {\n          nCreditDebit = 0;\n          nTime = 0;\n          strAccount.clear();\n          strOtherAccount.clear();\n          strComment.clear();\n          nOrderPos = -1;\n      }\n}"
  },
  {
    "function_name": "CAccountingEntry",
    "container": "CAccountingEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "815-818",
    "snippet": "CAccountingEntry()\n    {\n        SetNull();\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetNull",
          "args": [],
          "line": 817
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CAccountingEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "820-828",
          "snippet": "void SetNull()\n    {\n        nCreditDebit = 0;\n        nTime = 0;\n        strAccount.clear();\n        strOtherAccount.clear();\n        strComment.clear();\n        nOrderPos = -1;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCAccountingEntry {\n  void SetNull()\n      {\n          nCreditDebit = 0;\n          nTime = 0;\n          strAccount.clear();\n          strOtherAccount.clear();\n          strComment.clear();\n          nOrderPos = -1;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCAccountingEntry {\n  CAccountingEntry()\n      {\n          SetNull();\n      }\n}"
  },
  {
    "function_name": "SetNull",
    "container": "CAccount",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "785-788",
    "snippet": "void SetNull()\n    {\n        vchPubKey = CPubKey();\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CPubKey",
          "args": [],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "Raw",
          "container": "CPubKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "96-98",
          "snippet": "std::vector<unsigned char> Raw() const {\n        return vchPubKey;\n    }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  std::vector<unsigned char> Raw() const {\n          return vchPubKey;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCAccount {\n  void SetNull()\n      {\n          vchPubKey = CPubKey();\n      }\n}"
  },
  {
    "function_name": "CAccount",
    "container": "CAccount",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "780-783",
    "snippet": "CAccount()\n    {\n        SetNull();\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetNull",
          "args": [],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CAccountingEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "820-828",
          "snippet": "void SetNull()\n    {\n        nCreditDebit = 0;\n        nTime = 0;\n        strAccount.clear();\n        strOtherAccount.clear();\n        strComment.clear();\n        nOrderPos = -1;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCAccountingEntry {\n  void SetNull()\n      {\n          nCreditDebit = 0;\n          nTime = 0;\n          strAccount.clear();\n          strOtherAccount.clear();\n          strComment.clear();\n          nOrderPos = -1;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCAccount {\n  CAccount()\n      {\n          SetNull();\n      }\n}"
  },
  {
    "function_name": "CWalletKey",
    "container": "CWalletKey",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "750-754",
    "snippet": "CWalletKey(int64_t nExpires=0)\n    {\n        nTimeCreated = (nExpires ? GetTime() : 0);\n        nTimeExpires = nExpires;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetTime",
          "args": [],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "GetTimeMillis",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "370-374",
          "snippet": "inline int64_t GetTimeMillis()\n{\n    return (boost::posix_time::ptime(boost::posix_time::microsec_clock::universal_time()) -\n            boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_milliseconds();\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t GetTimeMillis()\n{\n    return (boost::posix_time::ptime(boost::posix_time::microsec_clock::universal_time()) -\n            boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_milliseconds();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletKey {\n  CWalletKey(int64_t nExpires=0)\n      {\n          nTimeCreated = (nExpires ? GetTime() : 0);\n          nTimeExpires = nExpires;\n      }\n}"
  },
  {
    "function_name": "print",
    "container": "COutput",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "730-733",
    "snippet": "void print() const\n    {\n        printf(\"%s\\n\", ToString().c_str());\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "ToString().c_str()"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "COutput",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "725-728",
          "snippet": "std::string ToString() const\n    {\n        return strprintf(\"COutput(%s, %d, %d) [%s]\", tx->GetHash().ToString().substr(0,10).c_str(), i, nDepth, FormatMoney(tx->vout[i].nValue).c_str());\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCOutput {\n  std::string ToString() const\n      {\n          return strprintf(\"COutput(%s, %d, %d) [%s]\", tx->GetHash().ToString().substr(0,10).c_str(), i, nDepth, FormatMoney(tx->vout[i].nValue).c_str());\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCOutput {\n  void print() const\n      {\n          printf(\"%s\\n\", ToString().c_str());\n      }\n}"
  },
  {
    "function_name": "ToString",
    "container": "COutput",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "725-728",
    "snippet": "std::string ToString() const\n    {\n        return strprintf(\"COutput(%s, %d, %d) [%s]\", tx->GetHash().ToString().substr(0,10).c_str(), i, nDepth, FormatMoney(tx->vout[i].nValue).c_str());\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"COutput(%s, %d, %d) [%s]\"",
            "tx->GetHash().ToString().substr(0,10).c_str()",
            "i",
            "nDepth",
            "FormatMoney(tx->vout[i].nValue).c_str()"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatMoney",
          "args": [],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatMoney",
          "args": [
            "tx->vout[i].nValue"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tx->GetHash",
          "args": [],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "GetHash",
          "container": "CNetAddr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "922-928",
          "snippet": "uint64_t CNetAddr::GetHash() const\n{\n    uint256 hash = Hash(&ip[0], &ip[16]);\n    uint64_t nRet;\n    memcpy(&nRet, &hash, sizeof(nRet));\n    return nRet;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCNetAddr {\n  uint64_t CNetAddr::GetHash() const\n  {\n      uint256 hash = Hash(&ip[0], &ip[16]);\n      uint64_t nRet;\n      memcpy(&nRet, &hash, sizeof(nRet));\n      return nRet;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tx->GetHash",
          "args": [
            "0",
            "10"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCOutput {\n  std::string ToString() const\n      {\n          return strprintf(\"COutput(%s, %d, %d) [%s]\", tx->GetHash().ToString().substr(0,10).c_str(), i, nDepth, FormatMoney(tx->vout[i].nValue).c_str());\n      }\n}"
  },
  {
    "function_name": "COutput",
    "container": "COutput",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "720-723",
    "snippet": "COutput(const CWalletTx *txIn, int iIn, int nDepthIn)\n    {\n        tx = txIn; i = iIn; nDepth = nDepthIn;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCOutput {\n  COutput(const CWalletTx *txIn, int iIn, int nDepthIn)\n      {\n          tx = txIn; i = iIn; nDepth = nDepthIn;\n      }\n}"
  },
  {
    "function_name": "IsTrusted",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "646-694",
    "snippet": "bool IsTrusted() const\n    {\n        // Quick answer in most cases\n        if (!IsFinal())\n            return false;\n        int nDepth = GetDepthInMainChain();\n        if (nDepth >= 1)\n            return true;\n        if (nDepth < 0)\n            return false;\n        if (fConfChange || !IsFromMe()) // using wtx's cached debit\n            return false;\n\n        // If no confirmations but it's from us, we can still\n        // consider it confirmed if all dependencies are confirmed\n        std::map<uint256, const CMerkleTx*> mapPrev;\n        std::vector<const CMerkleTx*> vWorkQueue;\n        vWorkQueue.reserve(vtxPrev.size()+1);\n        vWorkQueue.push_back(this);\n        for (unsigned int i = 0; i < vWorkQueue.size(); i++)\n        {\n            const CMerkleTx* ptx = vWorkQueue[i];\n\n            if (!ptx->IsFinal())\n                return false;\n            int nPDepth = ptx->GetDepthInMainChain();\n            if (nPDepth >= 1)\n                continue;\n            if (nPDepth < 0)\n                return false;\n            if (!pwallet->IsFromMe(*ptx))\n                return false;\n\n            if (mapPrev.empty())\n            {\n                BOOST_FOREACH(const CMerkleTx& tx, vtxPrev)\n                    mapPrev[tx.GetHash()] = &tx;\n            }\n\n            BOOST_FOREACH(const CTxIn& txin, ptx->vin)\n            {\n                if (!mapPrev.count(txin.prevout.hash))\n                    return false;\n                vWorkQueue.push_back(mapPrev[txin.prevout.hash]);\n            }\n        }\n\n        return true;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vWorkQueue.push_back",
          "args": [
            "mapPrev[txin.prevout.hash]"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapPrev.count",
          "args": [
            "txin.prevout.hash"
          ],
          "line": 687
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tx.GetHash",
          "args": [],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "GetHash",
          "container": "CNetAddr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "922-928",
          "snippet": "uint64_t CNetAddr::GetHash() const\n{\n    uint256 hash = Hash(&ip[0], &ip[16]);\n    uint64_t nRet;\n    memcpy(&nRet, &hash, sizeof(nRet));\n    return nRet;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCNetAddr {\n  uint64_t CNetAddr::GetHash() const\n  {\n      uint256 hash = Hash(&ip[0], &ip[16]);\n      uint64_t nRet;\n      memcpy(&nRet, &hash, sizeof(nRet));\n      return nRet;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapPrev.empty",
          "args": [],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pwallet->IsFromMe",
          "args": [
            "*ptx"
          ],
          "line": 676
        },
        "resolved": true,
        "details": {
          "function_name": "IsFromMe",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "237-240",
          "snippet": "bool IsFromMe(const CTransaction& tx) const\n    {\n        return (GetDebit(tx) > 0);\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  bool IsFromMe(const CTransaction& tx) const\n      {\n          return (GetDebit(tx) > 0);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ptx->GetDepthInMainChain",
          "args": [],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "GetDepthInMainChain",
          "container": "CMerkleTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "765-765",
          "snippet": "int GetDepthInMainChain() const { CBlockIndex *pindexRet; return GetDepthInMainChain(pindexRet); }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCMerkleTx {\n  int GetDepthInMainChain() const { CBlockIndex *pindexRet; return GetDepthInMainChain(pindexRet); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ptx->IsFinal",
          "args": [],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "IsFinal",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "491-506",
          "snippet": "bool IsFinal(int nBlockHeight=0, int64_t nBlockTime=0) const\n    {\n        // Time based nLockTime implemented in 0.1.6\n        if (nLockTime == 0)\n            return true;\n        if (nBlockHeight == 0)\n            nBlockHeight = nBestHeight;\n        if (nBlockTime == 0)\n            nBlockTime = GetAdjustedTime();\n        if ((int64_t)nLockTime < ((int64_t)nLockTime < LOCKTIME_THRESHOLD ? (int64_t)nBlockHeight : nBlockTime))\n            return true;\n        BOOST_FOREACH(const CTxIn& txin, vin)\n            if (!txin.IsFinal())\n                return false;\n        return true;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsFinal(int nBlockHeight=0, int64_t nBlockTime=0) const\n      {\n          // Time based nLockTime implemented in 0.1.6\n          if (nLockTime == 0)\n              return true;\n          if (nBlockHeight == 0)\n              nBlockHeight = nBestHeight;\n          if (nBlockTime == 0)\n              nBlockTime = GetAdjustedTime();\n          if ((int64_t)nLockTime < ((int64_t)nLockTime < LOCKTIME_THRESHOLD ? (int64_t)nBlockHeight : nBlockTime))\n              return true;\n          BOOST_FOREACH(const CTxIn& txin, vin)\n              if (!txin.IsFinal())\n                  return false;\n          return true;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vWorkQueue.size",
          "args": [],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vWorkQueue.push_back",
          "args": [
            "this"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vWorkQueue.reserve",
          "args": [
            "vtxPrev.size()+1"
          ],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "805-805",
          "snippet": "void reserve(size_type n)                        { vch.reserve(n + nReadPos); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void reserve(size_type n)                        { vch.reserve(n + nReadPos); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsFromMe",
          "args": [],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "IsFromMe",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "641-644",
          "snippet": "bool IsFromMe() const\n    {\n        return (GetDebit() > 0);\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  bool IsFromMe() const\n      {\n          return (GetDebit() > 0);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  bool IsTrusted() const\n      {\n          // Quick answer in most cases\n          if (!IsFinal())\n              return false;\n          int nDepth = GetDepthInMainChain();\n          if (nDepth >= 1)\n              return true;\n          if (nDepth < 0)\n              return false;\n          if (fConfChange || !IsFromMe()) // using wtx's cached debit\n              return false;\n  \n          // If no confirmations but it's from us, we can still\n          // consider it confirmed if all dependencies are confirmed\n          std::map<uint256, const CMerkleTx*> mapPrev;\n          std::vector<const CMerkleTx*> vWorkQueue;\n          vWorkQueue.reserve(vtxPrev.size()+1);\n          vWorkQueue.push_back(this);\n          for (unsigned int i = 0; i < vWorkQueue.size(); i++)\n          {\n              const CMerkleTx* ptx = vWorkQueue[i];\n  \n              if (!ptx->IsFinal())\n                  return false;\n              int nPDepth = ptx->GetDepthInMainChain();\n              if (nPDepth >= 1)\n                  continue;\n              if (nPDepth < 0)\n                  return false;\n              if (!pwallet->IsFromMe(*ptx))\n                  return false;\n  \n              if (mapPrev.empty())\n              {\n                  BOOST_FOREACH(const CMerkleTx& tx, vtxPrev)\n                      mapPrev[tx.GetHash()] = &tx;\n              }\n  \n              BOOST_FOREACH(const CTxIn& txin, ptx->vin)\n              {\n                  if (!mapPrev.count(txin.prevout.hash))\n                      return false;\n                  vWorkQueue.push_back(mapPrev[txin.prevout.hash]);\n              }\n          }\n  \n          return true;\n      }\n}"
  },
  {
    "function_name": "IsFromMe",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "641-644",
    "snippet": "bool IsFromMe() const\n    {\n        return (GetDebit() > 0);\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetDebit",
          "args": [],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "GetDebit",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "574-583",
          "snippet": "int64_t GetDebit() const\n    {\n        if (vin.empty())\n            return 0;\n        if (fDebitCached)\n            return nDebitCached;\n        nDebitCached = pwallet->GetDebit(*this);\n        fDebitCached = true;\n        return nDebitCached;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  int64_t GetDebit() const\n      {\n          if (vin.empty())\n              return 0;\n          if (fDebitCached)\n              return nDebitCached;\n          nDebitCached = pwallet->GetDebit(*this);\n          fDebitCached = true;\n          return nDebitCached;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  bool IsFromMe() const\n      {\n          return (GetDebit() > 0);\n      }\n}"
  },
  {
    "function_name": "GetChange",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "626-633",
    "snippet": "int64_t GetChange() const\n    {\n        if (fChangeCached)\n            return nChangeCached;\n        nChangeCached = pwallet->GetChange(*this);\n        fChangeCached = true;\n        return nChangeCached;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pwallet->GetChange",
          "args": [
            "*this"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "GetChange",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "263-273",
          "snippet": "int64_t GetChange(const CTransaction& tx) const\n    {\n        int64_t nChange = 0;\n        BOOST_FOREACH(const CTxOut& txout, tx.vout)\n        {\n            nChange += GetChange(txout);\n            if (!MoneyRange(nChange))\n                throw std::runtime_error(\"CWallet::GetChange() : value out of range\");\n        }\n        return nChange;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  int64_t GetChange(const CTransaction& tx) const\n      {\n          int64_t nChange = 0;\n          BOOST_FOREACH(const CTxOut& txout, tx.vout)\n          {\n              nChange += GetChange(txout);\n              if (!MoneyRange(nChange))\n                  throw std::runtime_error(\"CWallet::GetChange() : value out of range\");\n          }\n          return nChange;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  int64_t GetChange() const\n      {\n          if (fChangeCached)\n              return nChangeCached;\n          nChangeCached = pwallet->GetChange(*this);\n          fChangeCached = true;\n          return nChangeCached;\n      }\n}"
  },
  {
    "function_name": "GetAvailableCredit",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "599-623",
    "snippet": "int64_t GetAvailableCredit(bool fUseCache=true) const\n    {\n        // Must wait until coinbase is safely deep enough in the chain before valuing it\n        if ((IsCoinBase() || IsCoinStake()) && GetBlocksToMaturity() > 0)\n            return 0;\n\n        if (fUseCache && fAvailableCreditCached)\n            return nAvailableCreditCached;\n\n        int64_t nCredit = 0;\n        for (unsigned int i = 0; i < vout.size(); i++)\n        {\n            if (!IsSpent(i))\n            {\n                const CTxOut &txout = vout[i];\n                nCredit += pwallet->GetCredit(txout);\n                if (!MoneyRange(nCredit))\n                    throw std::runtime_error(\"CWalletTx::GetAvailableCredit() : value out of range\");\n            }\n        }\n\n        nAvailableCreditCached = nCredit;\n        fAvailableCreditCached = true;\n        return nCredit;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"CWalletTx::GetAvailableCredit() : value out of range\""
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MoneyRange",
          "args": [
            "nCredit"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "MoneyRange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "48-48",
          "snippet": "inline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\ninline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }"
        }
      },
      {
        "call_info": {
          "callee": "pwallet->GetCredit",
          "args": [
            "txout"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "GetCredit",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "252-262",
          "snippet": "int64_t GetCredit(const CTransaction& tx) const\n    {\n        int64_t nCredit = 0;\n        BOOST_FOREACH(const CTxOut& txout, tx.vout)\n        {\n            nCredit += GetCredit(txout);\n            if (!MoneyRange(nCredit))\n                throw std::runtime_error(\"CWallet::GetCredit() : value out of range\");\n        }\n        return nCredit;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  int64_t GetCredit(const CTransaction& tx) const\n      {\n          int64_t nCredit = 0;\n          BOOST_FOREACH(const CTxOut& txout, tx.vout)\n          {\n              nCredit += GetCredit(txout);\n              if (!MoneyRange(nCredit))\n                  throw std::runtime_error(\"CWallet::GetCredit() : value out of range\");\n          }\n          return nCredit;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsSpent",
          "args": [
            "i"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "IsSpent",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "565-572",
          "snippet": "bool IsSpent(unsigned int nOut) const\n    {\n        if (nOut >= vout.size())\n            throw std::runtime_error(\"CWalletTx::IsSpent() : nOut out of range\");\n        if (nOut >= vfSpent.size())\n            return false;\n        return (!!vfSpent[nOut]);\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  bool IsSpent(unsigned int nOut) const\n      {\n          if (nOut >= vout.size())\n              throw std::runtime_error(\"CWalletTx::IsSpent() : nOut out of range\");\n          if (nOut >= vfSpent.size())\n              return false;\n          return (!!vfSpent[nOut]);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vout.size",
          "args": [],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetBlocksToMaturity",
          "args": [],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "GetBlocksToMaturity",
          "container": "CMerkleTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "817-822",
          "snippet": "int CMerkleTx::GetBlocksToMaturity() const\n{\n    if (!(IsCoinBase() || IsCoinStake()))\n        return 0;\n    return max(0, (nCoinbaseMaturity+10) - GetDepthInMainChain());\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int nCoinbaseMaturity = 50;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nint nCoinbaseMaturity = 50;\n\nCMerkleTx {\n  int CMerkleTx::GetBlocksToMaturity() const\n  {\n      if (!(IsCoinBase() || IsCoinStake()))\n          return 0;\n      return max(0, (nCoinbaseMaturity+10) - GetDepthInMainChain());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsCoinStake",
          "args": [],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinStake",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "542-546",
          "snippet": "bool IsCoinStake() const\n    {\n        // ppcoin: the coin stake transaction is marked with the first output empty\n        return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinStake() const\n      {\n          // ppcoin: the coin stake transaction is marked with the first output empty\n          return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsCoinBase",
          "args": [],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinBase",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "537-540",
          "snippet": "bool IsCoinBase() const\n    {\n        return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinBase() const\n      {\n          return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  int64_t GetAvailableCredit(bool fUseCache=true) const\n      {\n          // Must wait until coinbase is safely deep enough in the chain before valuing it\n          if ((IsCoinBase() || IsCoinStake()) && GetBlocksToMaturity() > 0)\n              return 0;\n  \n          if (fUseCache && fAvailableCreditCached)\n              return nAvailableCreditCached;\n  \n          int64_t nCredit = 0;\n          for (unsigned int i = 0; i < vout.size(); i++)\n          {\n              if (!IsSpent(i))\n              {\n                  const CTxOut &txout = vout[i];\n                  nCredit += pwallet->GetCredit(txout);\n                  if (!MoneyRange(nCredit))\n                      throw std::runtime_error(\"CWalletTx::GetAvailableCredit() : value out of range\");\n              }\n          }\n  \n          nAvailableCreditCached = nCredit;\n          fAvailableCreditCached = true;\n          return nCredit;\n      }\n}"
  },
  {
    "function_name": "GetCredit",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "585-597",
    "snippet": "int64_t GetCredit(bool fUseCache=true) const\n    {\n        // Must wait until coinbase is safely deep enough in the chain before valuing it\n        if ((IsCoinBase() || IsCoinStake()) && GetBlocksToMaturity() > 0)\n            return 0;\n\n        // GetBalance can assume transactions in mapWallet won't change\n        if (fUseCache && fCreditCached)\n            return nCreditCached;\n        nCreditCached = pwallet->GetCredit(*this);\n        fCreditCached = true;\n        return nCreditCached;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pwallet->GetCredit",
          "args": [
            "*this"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "GetCredit",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "252-262",
          "snippet": "int64_t GetCredit(const CTransaction& tx) const\n    {\n        int64_t nCredit = 0;\n        BOOST_FOREACH(const CTxOut& txout, tx.vout)\n        {\n            nCredit += GetCredit(txout);\n            if (!MoneyRange(nCredit))\n                throw std::runtime_error(\"CWallet::GetCredit() : value out of range\");\n        }\n        return nCredit;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  int64_t GetCredit(const CTransaction& tx) const\n      {\n          int64_t nCredit = 0;\n          BOOST_FOREACH(const CTxOut& txout, tx.vout)\n          {\n              nCredit += GetCredit(txout);\n              if (!MoneyRange(nCredit))\n                  throw std::runtime_error(\"CWallet::GetCredit() : value out of range\");\n          }\n          return nCredit;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetBlocksToMaturity",
          "args": [],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "GetBlocksToMaturity",
          "container": "CMerkleTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "817-822",
          "snippet": "int CMerkleTx::GetBlocksToMaturity() const\n{\n    if (!(IsCoinBase() || IsCoinStake()))\n        return 0;\n    return max(0, (nCoinbaseMaturity+10) - GetDepthInMainChain());\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int nCoinbaseMaturity = 50;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nint nCoinbaseMaturity = 50;\n\nCMerkleTx {\n  int CMerkleTx::GetBlocksToMaturity() const\n  {\n      if (!(IsCoinBase() || IsCoinStake()))\n          return 0;\n      return max(0, (nCoinbaseMaturity+10) - GetDepthInMainChain());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsCoinStake",
          "args": [],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinStake",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "542-546",
          "snippet": "bool IsCoinStake() const\n    {\n        // ppcoin: the coin stake transaction is marked with the first output empty\n        return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinStake() const\n      {\n          // ppcoin: the coin stake transaction is marked with the first output empty\n          return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsCoinBase",
          "args": [],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinBase",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "537-540",
          "snippet": "bool IsCoinBase() const\n    {\n        return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinBase() const\n      {\n          return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  int64_t GetCredit(bool fUseCache=true) const\n      {\n          // Must wait until coinbase is safely deep enough in the chain before valuing it\n          if ((IsCoinBase() || IsCoinStake()) && GetBlocksToMaturity() > 0)\n              return 0;\n  \n          // GetBalance can assume transactions in mapWallet won't change\n          if (fUseCache && fCreditCached)\n              return nCreditCached;\n          nCreditCached = pwallet->GetCredit(*this);\n          fCreditCached = true;\n          return nCreditCached;\n      }\n}"
  },
  {
    "function_name": "GetDebit",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "574-583",
    "snippet": "int64_t GetDebit() const\n    {\n        if (vin.empty())\n            return 0;\n        if (fDebitCached)\n            return nDebitCached;\n        nDebitCached = pwallet->GetDebit(*this);\n        fDebitCached = true;\n        return nDebitCached;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pwallet->GetDebit",
          "args": [
            "*this"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "GetDebit",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "241-251",
          "snippet": "int64_t GetDebit(const CTransaction& tx) const\n    {\n        int64_t nDebit = 0;\n        BOOST_FOREACH(const CTxIn& txin, tx.vin)\n        {\n            nDebit += GetDebit(txin);\n            if (!MoneyRange(nDebit))\n                throw std::runtime_error(\"CWallet::GetDebit() : value out of range\");\n        }\n        return nDebit;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  int64_t GetDebit(const CTransaction& tx) const\n      {\n          int64_t nDebit = 0;\n          BOOST_FOREACH(const CTxIn& txin, tx.vin)\n          {\n              nDebit += GetDebit(txin);\n              if (!MoneyRange(nDebit))\n                  throw std::runtime_error(\"CWallet::GetDebit() : value out of range\");\n          }\n          return nDebit;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vin.empty",
          "args": [],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  int64_t GetDebit() const\n      {\n          if (vin.empty())\n              return 0;\n          if (fDebitCached)\n              return nDebitCached;\n          nDebitCached = pwallet->GetDebit(*this);\n          fDebitCached = true;\n          return nDebitCached;\n      }\n}"
  },
  {
    "function_name": "IsSpent",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "565-572",
    "snippet": "bool IsSpent(unsigned int nOut) const\n    {\n        if (nOut >= vout.size())\n            throw std::runtime_error(\"CWalletTx::IsSpent() : nOut out of range\");\n        if (nOut >= vfSpent.size())\n            return false;\n        return (!!vfSpent[nOut]);\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfSpent.size",
          "args": [],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"CWalletTx::IsSpent() : nOut out of range\""
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  bool IsSpent(unsigned int nOut) const\n      {\n          if (nOut >= vout.size())\n              throw std::runtime_error(\"CWalletTx::IsSpent() : nOut out of range\");\n          if (nOut >= vfSpent.size())\n              return false;\n          return (!!vfSpent[nOut]);\n      }\n}"
  },
  {
    "function_name": "MarkUnspent",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "553-563",
    "snippet": "void MarkUnspent(unsigned int nOut)\n    {\n        if (nOut >= vout.size())\n            throw std::runtime_error(\"CWalletTx::MarkUnspent() : nOut out of range\");\n        vfSpent.resize(vout.size());\n        if (vfSpent[nOut])\n        {\n            vfSpent[nOut] = false;\n            fAvailableCreditCached = false;\n        }\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfSpent.resize",
          "args": [
            "vout.size()"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vout.size",
          "args": [],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"CWalletTx::MarkUnspent() : nOut out of range\""
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  void MarkUnspent(unsigned int nOut)\n      {\n          if (nOut >= vout.size())\n              throw std::runtime_error(\"CWalletTx::MarkUnspent() : nOut out of range\");\n          vfSpent.resize(vout.size());\n          if (vfSpent[nOut])\n          {\n              vfSpent[nOut] = false;\n              fAvailableCreditCached = false;\n          }\n      }\n}"
  },
  {
    "function_name": "MarkSpent",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "541-551",
    "snippet": "void MarkSpent(unsigned int nOut)\n    {\n        if (nOut >= vout.size())\n            throw std::runtime_error(\"CWalletTx::MarkSpent() : nOut out of range\");\n        vfSpent.resize(vout.size());\n        if (!vfSpent[nOut])\n        {\n            vfSpent[nOut] = true;\n            fAvailableCreditCached = false;\n        }\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfSpent.resize",
          "args": [
            "vout.size()"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vout.size",
          "args": [],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"CWalletTx::MarkSpent() : nOut out of range\""
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  void MarkSpent(unsigned int nOut)\n      {\n          if (nOut >= vout.size())\n              throw std::runtime_error(\"CWalletTx::MarkSpent() : nOut out of range\");\n          vfSpent.resize(vout.size());\n          if (!vfSpent[nOut])\n          {\n              vfSpent[nOut] = true;\n              fAvailableCreditCached = false;\n          }\n      }\n}"
  },
  {
    "function_name": "BindWallet",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "535-539",
    "snippet": "void BindWallet(CWallet *pwalletIn)\n    {\n        pwallet = pwalletIn;\n        MarkDirty();\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MarkDirty",
          "args": [],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "MarkDirty",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "527-533",
          "snippet": "void MarkDirty()\n    {\n        fCreditCached = false;\n        fAvailableCreditCached = false;\n        fDebitCached = false;\n        fChangeCached = false;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  void MarkDirty()\n      {\n          fCreditCached = false;\n          fAvailableCreditCached = false;\n          fDebitCached = false;\n          fChangeCached = false;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  void BindWallet(CWallet *pwalletIn)\n      {\n          pwallet = pwalletIn;\n          MarkDirty();\n      }\n}"
  },
  {
    "function_name": "MarkDirty",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "527-533",
    "snippet": "void MarkDirty()\n    {\n        fCreditCached = false;\n        fAvailableCreditCached = false;\n        fDebitCached = false;\n        fChangeCached = false;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  void MarkDirty()\n      {\n          fCreditCached = false;\n          fAvailableCreditCached = false;\n          fDebitCached = false;\n          fChangeCached = false;\n      }\n}"
  },
  {
    "function_name": "UpdateSpent",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "508-524",
    "snippet": "bool UpdateSpent(const std::vector<char>& vfNewSpent)\n    {\n        bool fReturn = false;\n        for (unsigned int i = 0; i < vfNewSpent.size(); i++)\n        {\n            if (i == vfSpent.size())\n                break;\n\n            if (vfNewSpent[i] && !vfSpent[i])\n            {\n                vfSpent[i] = true;\n                fReturn = true;\n                fAvailableCreditCached = false;\n            }\n        }\n        return fReturn;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfSpent.size",
          "args": [],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  bool UpdateSpent(const std::vector<char>& vfNewSpent)\n      {\n          bool fReturn = false;\n          for (unsigned int i = 0; i < vfNewSpent.size(); i++)\n          {\n              if (i == vfSpent.size())\n                  break;\n  \n              if (vfNewSpent[i] && !vfSpent[i])\n              {\n                  vfSpent[i] = true;\n                  fReturn = true;\n                  fAvailableCreditCached = false;\n              }\n          }\n          return fReturn;\n      }\n}"
  },
  {
    "function_name": "if",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "484-497",
    "snippet": "if (fRead)\n        {\n            pthis->strFromAccount = pthis->mapValue[\"fromaccount\"];\n\n            if (mapValue.count(\"spent\"))\n                BOOST_FOREACH(char c, pthis->mapValue[\"spent\"])\n                    pthis->vfSpent.push_back(c != '0');\n            else\n                pthis->vfSpent.assign(vout.size(), fSpent);\n\n            ReadOrderPos(pthis->nOrderPos, pthis->mapValue);\n\n            pthis->nTimeSmart = mapValue.count(\"timesmart\") ? (unsigned int)atoi64(pthis->mapValue[\"timesmart\"]) : 0;\n        }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atoi64",
          "args": [
            "pthis->mapValue[\"timesmart\"]"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "atoi64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "283-290",
          "snippet": "inline int64_t atoi64(const std::string& str)\n{\n#ifdef _MSC_VER\n    return _atoi64(str.c_str());\n#else\n    return strtoll(str.c_str(), NULL, 10);\n#endif\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t atoi64(const std::string& str)\n{\n#ifdef _MSC_VER\n    return _atoi64(str.c_str());\n#else\n    return strtoll(str.c_str(), NULL, 10);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapValue.count",
          "args": [
            "\"timesmart\""
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ReadOrderPos",
          "args": [
            "pthis->nOrderPos",
            "pthis->mapValue"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "ReadOrderPos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "357-365",
          "snippet": "static void ReadOrderPos(int64_t& nOrderPos, mapValue_t& mapValue)\n{\n    if (!mapValue.count(\"n\"))\n    {\n        nOrderPos = -1; // TODO: calculate elsewhere\n        return;\n    }\n    nOrderPos = atoi64(mapValue[\"n\"].c_str());\n}",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nstatic void ReadOrderPos(int64_t& nOrderPos, mapValue_t& mapValue)\n{\n    if (!mapValue.count(\"n\"))\n    {\n        nOrderPos = -1; // TODO: calculate elsewhere\n        return;\n    }\n    nOrderPos = atoi64(mapValue[\"n\"].c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthis->vfSpent.assign",
          "args": [
            "vout.size()",
            "fSpent"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vout.size",
          "args": [],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BOOST_FOREACH",
          "args": [
            "c != '0'"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BOOST_FOREACH",
          "args": [
            "charc",
            "pthis->mapValue[\"spent\"]"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  if (fRead)\n          {\n              pthis->strFromAccount = pthis->mapValue[\"fromaccount\"];\n  \n              if (mapValue.count(\"spent\"))\n                  BOOST_FOREACH(char c, pthis->mapValue[\"spent\"])\n                      pthis->vfSpent.push_back(c != '0');\n              else\n                  pthis->vfSpent.assign(vout.size(), fSpent);\n  \n              ReadOrderPos(pthis->nOrderPos, pthis->mapValue);\n  \n              pthis->nTimeSmart = mapValue.count(\"timesmart\") ? (unsigned int)atoi64(pthis->mapValue[\"timesmart\"]) : 0;\n          }\n}"
  },
  {
    "function_name": "Init",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "426-447",
    "snippet": "void Init(const CWallet* pwalletIn)\n    {\n        pwallet = pwalletIn;\n        vtxPrev.clear();\n        mapValue.clear();\n        vOrderForm.clear();\n        fTimeReceivedIsTxTime = false;\n        nTimeReceived = 0;\n        nTimeSmart = 0;\n        fFromMe = false;\n        strFromAccount.clear();\n        vfSpent.clear();\n        fDebitCached = false;\n        fCreditCached = false;\n        fAvailableCreditCached = false;\n        fChangeCached = false;\n        nDebitCached = 0;\n        nCreditCached = 0;\n        nAvailableCreditCached = 0;\n        nChangeCached = 0;\n        nOrderPos = -1;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfSpent.clear",
          "args": [],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  void Init(const CWallet* pwalletIn)\n      {\n          pwallet = pwalletIn;\n          vtxPrev.clear();\n          mapValue.clear();\n          vOrderForm.clear();\n          fTimeReceivedIsTxTime = false;\n          nTimeReceived = 0;\n          nTimeSmart = 0;\n          fFromMe = false;\n          strFromAccount.clear();\n          vfSpent.clear();\n          fDebitCached = false;\n          fCreditCached = false;\n          fAvailableCreditCached = false;\n          fChangeCached = false;\n          nDebitCached = 0;\n          nCreditCached = 0;\n          nAvailableCreditCached = 0;\n          nChangeCached = 0;\n          nOrderPos = -1;\n      }\n}"
  },
  {
    "function_name": "CWalletTx",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "421-424",
    "snippet": "CWalletTx(const CWallet* pwalletIn, const CTransaction& txIn) : CMerkleTx(txIn)\n    {\n        Init(pwalletIn);\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "pwalletIn"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "426-447",
          "snippet": "void Init(const CWallet* pwalletIn)\n    {\n        pwallet = pwalletIn;\n        vtxPrev.clear();\n        mapValue.clear();\n        vOrderForm.clear();\n        fTimeReceivedIsTxTime = false;\n        nTimeReceived = 0;\n        nTimeSmart = 0;\n        fFromMe = false;\n        strFromAccount.clear();\n        vfSpent.clear();\n        fDebitCached = false;\n        fCreditCached = false;\n        fAvailableCreditCached = false;\n        fChangeCached = false;\n        nDebitCached = 0;\n        nCreditCached = 0;\n        nAvailableCreditCached = 0;\n        nChangeCached = 0;\n        nOrderPos = -1;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  void Init(const CWallet* pwalletIn)\n      {\n          pwallet = pwalletIn;\n          vtxPrev.clear();\n          mapValue.clear();\n          vOrderForm.clear();\n          fTimeReceivedIsTxTime = false;\n          nTimeReceived = 0;\n          nTimeSmart = 0;\n          fFromMe = false;\n          strFromAccount.clear();\n          vfSpent.clear();\n          fDebitCached = false;\n          fCreditCached = false;\n          fAvailableCreditCached = false;\n          fChangeCached = false;\n          nDebitCached = 0;\n          nCreditCached = 0;\n          nAvailableCreditCached = 0;\n          nChangeCached = 0;\n          nOrderPos = -1;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  CWalletTx(const CWallet* pwalletIn, const CTransaction& txIn) : CMerkleTx(txIn)\n      {\n          Init(pwalletIn);\n      }\n}"
  },
  {
    "function_name": "CWalletTx",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "416-419",
    "snippet": "CWalletTx(const CWallet* pwalletIn, const CMerkleTx& txIn) : CMerkleTx(txIn)\n    {\n        Init(pwalletIn);\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "pwalletIn"
          ],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "426-447",
          "snippet": "void Init(const CWallet* pwalletIn)\n    {\n        pwallet = pwalletIn;\n        vtxPrev.clear();\n        mapValue.clear();\n        vOrderForm.clear();\n        fTimeReceivedIsTxTime = false;\n        nTimeReceived = 0;\n        nTimeSmart = 0;\n        fFromMe = false;\n        strFromAccount.clear();\n        vfSpent.clear();\n        fDebitCached = false;\n        fCreditCached = false;\n        fAvailableCreditCached = false;\n        fChangeCached = false;\n        nDebitCached = 0;\n        nCreditCached = 0;\n        nAvailableCreditCached = 0;\n        nChangeCached = 0;\n        nOrderPos = -1;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  void Init(const CWallet* pwalletIn)\n      {\n          pwallet = pwalletIn;\n          vtxPrev.clear();\n          mapValue.clear();\n          vOrderForm.clear();\n          fTimeReceivedIsTxTime = false;\n          nTimeReceived = 0;\n          nTimeSmart = 0;\n          fFromMe = false;\n          strFromAccount.clear();\n          vfSpent.clear();\n          fDebitCached = false;\n          fCreditCached = false;\n          fAvailableCreditCached = false;\n          fChangeCached = false;\n          nDebitCached = 0;\n          nCreditCached = 0;\n          nAvailableCreditCached = 0;\n          nChangeCached = 0;\n          nOrderPos = -1;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  CWalletTx(const CWallet* pwalletIn, const CMerkleTx& txIn) : CMerkleTx(txIn)\n      {\n          Init(pwalletIn);\n      }\n}"
  },
  {
    "function_name": "CWalletTx",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "411-414",
    "snippet": "CWalletTx(const CWallet* pwalletIn)\n    {\n        Init(pwalletIn);\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "pwalletIn"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "426-447",
          "snippet": "void Init(const CWallet* pwalletIn)\n    {\n        pwallet = pwalletIn;\n        vtxPrev.clear();\n        mapValue.clear();\n        vOrderForm.clear();\n        fTimeReceivedIsTxTime = false;\n        nTimeReceived = 0;\n        nTimeSmart = 0;\n        fFromMe = false;\n        strFromAccount.clear();\n        vfSpent.clear();\n        fDebitCached = false;\n        fCreditCached = false;\n        fAvailableCreditCached = false;\n        fChangeCached = false;\n        nDebitCached = 0;\n        nCreditCached = 0;\n        nAvailableCreditCached = 0;\n        nChangeCached = 0;\n        nOrderPos = -1;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  void Init(const CWallet* pwalletIn)\n      {\n          pwallet = pwalletIn;\n          vtxPrev.clear();\n          mapValue.clear();\n          vOrderForm.clear();\n          fTimeReceivedIsTxTime = false;\n          nTimeReceived = 0;\n          nTimeSmart = 0;\n          fFromMe = false;\n          strFromAccount.clear();\n          vfSpent.clear();\n          fDebitCached = false;\n          fCreditCached = false;\n          fAvailableCreditCached = false;\n          fChangeCached = false;\n          nDebitCached = 0;\n          nCreditCached = 0;\n          nAvailableCreditCached = 0;\n          nChangeCached = 0;\n          nOrderPos = -1;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  CWalletTx(const CWallet* pwalletIn)\n      {\n          Init(pwalletIn);\n      }\n}"
  },
  {
    "function_name": "CWalletTx",
    "container": "CWalletTx",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "406-409",
    "snippet": "CWalletTx()\n    {\n        Init(NULL);\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "NULL"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "426-447",
          "snippet": "void Init(const CWallet* pwalletIn)\n    {\n        pwallet = pwalletIn;\n        vtxPrev.clear();\n        mapValue.clear();\n        vOrderForm.clear();\n        fTimeReceivedIsTxTime = false;\n        nTimeReceived = 0;\n        nTimeSmart = 0;\n        fFromMe = false;\n        strFromAccount.clear();\n        vfSpent.clear();\n        fDebitCached = false;\n        fCreditCached = false;\n        fAvailableCreditCached = false;\n        fChangeCached = false;\n        nDebitCached = 0;\n        nCreditCached = 0;\n        nAvailableCreditCached = 0;\n        nChangeCached = 0;\n        nOrderPos = -1;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  void Init(const CWallet* pwalletIn)\n      {\n          pwallet = pwalletIn;\n          vtxPrev.clear();\n          mapValue.clear();\n          vOrderForm.clear();\n          fTimeReceivedIsTxTime = false;\n          nTimeReceived = 0;\n          nTimeSmart = 0;\n          fFromMe = false;\n          strFromAccount.clear();\n          vfSpent.clear();\n          fDebitCached = false;\n          fCreditCached = false;\n          fAvailableCreditCached = false;\n          fChangeCached = false;\n          nDebitCached = 0;\n          nCreditCached = 0;\n          nAvailableCreditCached = 0;\n          nChangeCached = 0;\n          nOrderPos = -1;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  CWalletTx()\n      {\n          Init(NULL);\n      }\n}"
  },
  {
    "function_name": "WriteOrderPos",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "368-373",
    "snippet": "static void WriteOrderPos(const int64_t& nOrderPos, mapValue_t& mapValue)\n{\n    if (nOrderPos == -1)\n        return;\n    mapValue[\"n\"] = i64tostr(nOrderPos);\n}",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "i64tostr",
          "args": [
            "nOrderPos"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "i64tostr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "264-267",
          "snippet": "inline std::string i64tostr(int64_t n)\n{\n    return strprintf(\"%\"PRId64, n);\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline std::string i64tostr(int64_t n)\n{\n    return strprintf(\"%\"PRId64, n);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nstatic void WriteOrderPos(const int64_t& nOrderPos, mapValue_t& mapValue)\n{\n    if (nOrderPos == -1)\n        return;\n    mapValue[\"n\"] = i64tostr(nOrderPos);\n}"
  },
  {
    "function_name": "ReadOrderPos",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "357-365",
    "snippet": "static void ReadOrderPos(int64_t& nOrderPos, mapValue_t& mapValue)\n{\n    if (!mapValue.count(\"n\"))\n    {\n        nOrderPos = -1; // TODO: calculate elsewhere\n        return;\n    }\n    nOrderPos = atoi64(mapValue[\"n\"].c_str());\n}",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atoi64",
          "args": [
            "mapValue[\"n\"].c_str()"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "atoi64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "283-290",
          "snippet": "inline int64_t atoi64(const std::string& str)\n{\n#ifdef _MSC_VER\n    return _atoi64(str.c_str());\n#else\n    return strtoll(str.c_str(), NULL, 10);\n#endif\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t atoi64(const std::string& str)\n{\n#ifdef _MSC_VER\n    return _atoi64(str.c_str());\n#else\n    return strtoll(str.c_str(), NULL, 10);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapValue[\"n\"].c_str",
          "args": [],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapValue.count",
          "args": [
            "\"n\""
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nstatic void ReadOrderPos(int64_t& nOrderPos, mapValue_t& mapValue)\n{\n    if (!mapValue.count(\"n\"))\n    {\n        nOrderPos = -1; // TODO: calculate elsewhere\n        return;\n    }\n    nOrderPos = atoi64(mapValue[\"n\"].c_str());\n}"
  },
  {
    "function_name": "CReserveKey",
    "container": "CReserveKey",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "336-340",
    "snippet": "CReserveKey(CWallet* pwalletIn)\n    {\n        nIndex = -1;\n        pwallet = pwalletIn;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCReserveKey {\n  CReserveKey(CWallet* pwalletIn)\n      {\n          nIndex = -1;\n          pwallet = pwalletIn;\n      }\n}"
  },
  {
    "function_name": "GetVersion",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "312-312",
    "snippet": "int GetVersion() { return nWalletVersion; }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  int GetVersion() { return nWalletVersion; }\n}"
  },
  {
    "function_name": "GetKeyPoolSize",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "296-299",
    "snippet": "unsigned int GetKeyPoolSize()\n    {\n        return setKeyPool.size();\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setKeyPool.size",
          "args": [],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  unsigned int GetKeyPoolSize()\n      {\n          return setKeyPool.size();\n      }\n}"
  },
  {
    "function_name": "Inventory",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "286-294",
    "snippet": "void Inventory(const uint256 &hash)\n    {\n        {\n            LOCK(cs_wallet);\n            std::map<uint256, int>::iterator mi = mapRequestCount.find(hash);\n            if (mi != mapRequestCount.end())\n                (*mi).second++;\n        }\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mapRequestCount.end",
          "args": [],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapRequestCount.find",
          "args": [
            "hash"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs_wallet"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  void Inventory(const uint256 &hash)\n      {\n          {\n              LOCK(cs_wallet);\n              std::map<uint256, int>::iterator mi = mapRequestCount.find(hash);\n              if (mi != mapRequestCount.end())\n                  (*mi).second++;\n          }\n      }\n}"
  },
  {
    "function_name": "GetChange",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "263-273",
    "snippet": "int64_t GetChange(const CTransaction& tx) const\n    {\n        int64_t nChange = 0;\n        BOOST_FOREACH(const CTxOut& txout, tx.vout)\n        {\n            nChange += GetChange(txout);\n            if (!MoneyRange(nChange))\n                throw std::runtime_error(\"CWallet::GetChange() : value out of range\");\n        }\n        return nChange;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"CWallet::GetChange() : value out of range\""
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MoneyRange",
          "args": [
            "nChange"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "MoneyRange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "48-48",
          "snippet": "inline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\ninline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }"
        }
      },
      {
        "call_info": {
          "callee": "GetChange",
          "args": [
            "txout"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "GetChange",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "263-273",
          "snippet": "int64_t GetChange(const CTransaction& tx) const\n    {\n        int64_t nChange = 0;\n        BOOST_FOREACH(const CTxOut& txout, tx.vout)\n        {\n            nChange += GetChange(txout);\n            if (!MoneyRange(nChange))\n                throw std::runtime_error(\"CWallet::GetChange() : value out of range\");\n        }\n        return nChange;\n    }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  int64_t GetChange(const CTransaction& tx) const\n      {\n          int64_t nChange = 0;\n          BOOST_FOREACH(const CTxOut& txout, tx.vout)\n          {\n              nChange += GetChange(txout);\n              if (!MoneyRange(nChange))\n                  throw std::runtime_error(\"CWallet::GetChange() : value out of range\");\n          }\n          return nChange;\n      }\n}"
  },
  {
    "function_name": "GetCredit",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "252-262",
    "snippet": "int64_t GetCredit(const CTransaction& tx) const\n    {\n        int64_t nCredit = 0;\n        BOOST_FOREACH(const CTxOut& txout, tx.vout)\n        {\n            nCredit += GetCredit(txout);\n            if (!MoneyRange(nCredit))\n                throw std::runtime_error(\"CWallet::GetCredit() : value out of range\");\n        }\n        return nCredit;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"CWallet::GetCredit() : value out of range\""
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MoneyRange",
          "args": [
            "nCredit"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "MoneyRange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "48-48",
          "snippet": "inline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\ninline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }"
        }
      },
      {
        "call_info": {
          "callee": "GetCredit",
          "args": [
            "txout"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "GetCredit",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "252-262",
          "snippet": "int64_t GetCredit(const CTransaction& tx) const\n    {\n        int64_t nCredit = 0;\n        BOOST_FOREACH(const CTxOut& txout, tx.vout)\n        {\n            nCredit += GetCredit(txout);\n            if (!MoneyRange(nCredit))\n                throw std::runtime_error(\"CWallet::GetCredit() : value out of range\");\n        }\n        return nCredit;\n    }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  int64_t GetCredit(const CTransaction& tx) const\n      {\n          int64_t nCredit = 0;\n          BOOST_FOREACH(const CTxOut& txout, tx.vout)\n          {\n              nCredit += GetCredit(txout);\n              if (!MoneyRange(nCredit))\n                  throw std::runtime_error(\"CWallet::GetCredit() : value out of range\");\n          }\n          return nCredit;\n      }\n}"
  },
  {
    "function_name": "GetDebit",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "241-251",
    "snippet": "int64_t GetDebit(const CTransaction& tx) const\n    {\n        int64_t nDebit = 0;\n        BOOST_FOREACH(const CTxIn& txin, tx.vin)\n        {\n            nDebit += GetDebit(txin);\n            if (!MoneyRange(nDebit))\n                throw std::runtime_error(\"CWallet::GetDebit() : value out of range\");\n        }\n        return nDebit;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"CWallet::GetDebit() : value out of range\""
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MoneyRange",
          "args": [
            "nDebit"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "MoneyRange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "48-48",
          "snippet": "inline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\ninline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }"
        }
      },
      {
        "call_info": {
          "callee": "GetDebit",
          "args": [
            "txin"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "GetDebit",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "241-251",
          "snippet": "int64_t GetDebit(const CTransaction& tx) const\n    {\n        int64_t nDebit = 0;\n        BOOST_FOREACH(const CTxIn& txin, tx.vin)\n        {\n            nDebit += GetDebit(txin);\n            if (!MoneyRange(nDebit))\n                throw std::runtime_error(\"CWallet::GetDebit() : value out of range\");\n        }\n        return nDebit;\n    }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  int64_t GetDebit(const CTransaction& tx) const\n      {\n          int64_t nDebit = 0;\n          BOOST_FOREACH(const CTxIn& txin, tx.vin)\n          {\n              nDebit += GetDebit(txin);\n              if (!MoneyRange(nDebit))\n                  throw std::runtime_error(\"CWallet::GetDebit() : value out of range\");\n          }\n          return nDebit;\n      }\n}"
  },
  {
    "function_name": "IsFromMe",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "237-240",
    "snippet": "bool IsFromMe(const CTransaction& tx) const\n    {\n        return (GetDebit(tx) > 0);\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetDebit",
          "args": [
            "tx"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "GetDebit",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "241-251",
          "snippet": "int64_t GetDebit(const CTransaction& tx) const\n    {\n        int64_t nDebit = 0;\n        BOOST_FOREACH(const CTxIn& txin, tx.vin)\n        {\n            nDebit += GetDebit(txin);\n            if (!MoneyRange(nDebit))\n                throw std::runtime_error(\"CWallet::GetDebit() : value out of range\");\n        }\n        return nDebit;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  int64_t GetDebit(const CTransaction& tx) const\n      {\n          int64_t nDebit = 0;\n          BOOST_FOREACH(const CTxIn& txin, tx.vin)\n          {\n              nDebit += GetDebit(txin);\n              if (!MoneyRange(nDebit))\n                  throw std::runtime_error(\"CWallet::GetDebit() : value out of range\");\n          }\n          return nDebit;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  bool IsFromMe(const CTransaction& tx) const\n      {\n          return (GetDebit(tx) > 0);\n      }\n}"
  },
  {
    "function_name": "IsMine",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "230-236",
    "snippet": "bool IsMine(const CTransaction& tx) const\n    {\n        BOOST_FOREACH(const CTxOut& txout, tx.vout)\n            if (IsMine(txout) && txout.nValue >= nMinimumInputValue)\n                return true;\n        return false;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsMine",
          "args": [
            "txout"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "IsMine",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "230-236",
          "snippet": "bool IsMine(const CTransaction& tx) const\n    {\n        BOOST_FOREACH(const CTxOut& txout, tx.vout)\n            if (IsMine(txout) && txout.nValue >= nMinimumInputValue)\n                return true;\n        return false;\n    }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  bool IsMine(const CTransaction& tx) const\n      {\n          BOOST_FOREACH(const CTxOut& txout, tx.vout)\n              if (IsMine(txout) && txout.nValue >= nMinimumInputValue)\n                  return true;\n          return false;\n      }\n}"
  },
  {
    "function_name": "GetChange",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "224-229",
    "snippet": "int64_t GetChange(const CTxOut& txout) const\n    {\n        if (!MoneyRange(txout.nValue))\n            throw std::runtime_error(\"CWallet::GetChange() : value out of range\");\n        return (IsChange(txout) ? txout.nValue : 0);\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsChange",
          "args": [
            "txout"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "IsChange",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.cpp",
          "lines": "613-631",
          "snippet": "bool CWallet::IsChange(const CTxOut& txout) const\n{\n    CTxDestination address;\n\n    // TODO: fix handling of 'change' outputs. The assumption is that any\n    // payment to a TX_PUBKEYHASH that is mine but isn't in the address book\n    // is change. That assumption is likely to break when we implement multisignature\n    // wallets that return change back into a multi-signature-protected address;\n    // a better way of identifying which outputs are 'the send' and which are\n    // 'the change' will need to be implemented (maybe extend CWalletTx to remember\n    // which output, if any, was change).\n    if (ExtractDestination(txout.scriptPubKey, address) && ::IsMine(*this, address))\n    {\n        LOCK(cs_wallet);\n        if (!mapAddressBook.count(address))\n            return true;\n    }\n    return false;\n}",
          "includes": [
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"coincontrol.h\"",
            "#include \"kernel.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"crypter.h\"",
            "#include \"walletdb.h\"",
            "#include \"wallet.h\"",
            "#include \"txdb.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/replace.hpp>\n#include \"coincontrol.h\"\n#include \"kernel.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"crypter.h\"\n#include \"walletdb.h\"\n#include \"wallet.h\"\n#include \"txdb.h\"\n\nCWallet {\n  bool CWallet::IsChange(const CTxOut& txout) const\n  {\n      CTxDestination address;\n  \n      // TODO: fix handling of 'change' outputs. The assumption is that any\n      // payment to a TX_PUBKEYHASH that is mine but isn't in the address book\n      // is change. That assumption is likely to break when we implement multisignature\n      // wallets that return change back into a multi-signature-protected address;\n      // a better way of identifying which outputs are 'the send' and which are\n      // 'the change' will need to be implemented (maybe extend CWalletTx to remember\n      // which output, if any, was change).\n      if (ExtractDestination(txout.scriptPubKey, address) && ::IsMine(*this, address))\n      {\n          LOCK(cs_wallet);\n          if (!mapAddressBook.count(address))\n              return true;\n      }\n      return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"CWallet::GetChange() : value out of range\""
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MoneyRange",
          "args": [
            "txout.nValue"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "MoneyRange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "48-48",
          "snippet": "inline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\ninline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  int64_t GetChange(const CTxOut& txout) const\n      {\n          if (!MoneyRange(txout.nValue))\n              throw std::runtime_error(\"CWallet::GetChange() : value out of range\");\n          return (IsChange(txout) ? txout.nValue : 0);\n      }\n}"
  },
  {
    "function_name": "GetCredit",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "217-222",
    "snippet": "int64_t GetCredit(const CTxOut& txout) const\n    {\n        if (!MoneyRange(txout.nValue))\n            throw std::runtime_error(\"CWallet::GetCredit() : value out of range\");\n        return (IsMine(txout) ? txout.nValue : 0);\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsMine",
          "args": [
            "txout"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "IsMine",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "230-236",
          "snippet": "bool IsMine(const CTransaction& tx) const\n    {\n        BOOST_FOREACH(const CTxOut& txout, tx.vout)\n            if (IsMine(txout) && txout.nValue >= nMinimumInputValue)\n                return true;\n        return false;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  bool IsMine(const CTransaction& tx) const\n      {\n          BOOST_FOREACH(const CTxOut& txout, tx.vout)\n              if (IsMine(txout) && txout.nValue >= nMinimumInputValue)\n                  return true;\n          return false;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"CWallet::GetCredit() : value out of range\""
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MoneyRange",
          "args": [
            "txout.nValue"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "MoneyRange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "48-48",
          "snippet": "inline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\ninline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  int64_t GetCredit(const CTxOut& txout) const\n      {\n          if (!MoneyRange(txout.nValue))\n              throw std::runtime_error(\"CWallet::GetCredit() : value out of range\");\n          return (IsMine(txout) ? txout.nValue : 0);\n      }\n}"
  },
  {
    "function_name": "IsMine",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "213-216",
    "snippet": "bool IsMine(const CTxOut& txout) const\n    {\n        return ::IsMine(*this, txout.scriptPubKey);\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::IsMine",
          "args": [
            "*this",
            "txout.scriptPubKey"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "IsMine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.cpp",
          "lines": "1551-1588",
          "snippet": "bool IsMine(const CKeyStore &keystore, const CScript& scriptPubKey)\n{\n    vector<valtype> vSolutions;\n    txnouttype whichType;\n    if (!Solver(scriptPubKey, whichType, vSolutions))\n        return false;\n\n    CKeyID keyID;\n    switch (whichType)\n    {\n    case TX_NONSTANDARD:\n        return false;\n    case TX_PUBKEY:\n        keyID = CPubKey(vSolutions[0]).GetID();\n        return keystore.HaveKey(keyID);\n    case TX_PUBKEYHASH:\n        keyID = CKeyID(uint160(vSolutions[0]));\n        return keystore.HaveKey(keyID);\n    case TX_SCRIPTHASH:\n    {\n        CScript subscript;\n        if (!keystore.GetCScript(CScriptID(uint160(vSolutions[0])), subscript))\n            return false;\n        return IsMine(keystore, subscript);\n    }\n    case TX_MULTISIG:\n    {\n        // Only consider transactions \"mine\" if we own ALL the\n        // keys involved. multi-signature transactions that are\n        // partially owned (somebody else has a key that can spend\n        // them) enable spend-out-from-under-you attacks, especially\n        // in shared-wallet situations.\n        vector<valtype> keys(vSolutions.begin()+1, vSolutions.begin()+vSolutions.size()-1);\n        return HaveKeys(keys, keystore) == keys.size();\n    }\n    }\n    return false;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"sync.h\"",
            "#include \"main.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include \"script.h\"",
            "#include <boost/tuple/tuple_comparison.hpp>",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/foreach.hpp>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"sync.h\"\n#include \"main.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include \"keystore.h\"\n#include \"script.h\"\n#include <boost/tuple/tuple_comparison.hpp>\n#include <boost/tuple/tuple.hpp>\n#include <boost/foreach.hpp>\n\nbool IsMine(const CKeyStore &keystore, const CScript& scriptPubKey)\n{\n    vector<valtype> vSolutions;\n    txnouttype whichType;\n    if (!Solver(scriptPubKey, whichType, vSolutions))\n        return false;\n\n    CKeyID keyID;\n    switch (whichType)\n    {\n    case TX_NONSTANDARD:\n        return false;\n    case TX_PUBKEY:\n        keyID = CPubKey(vSolutions[0]).GetID();\n        return keystore.HaveKey(keyID);\n    case TX_PUBKEYHASH:\n        keyID = CKeyID(uint160(vSolutions[0]));\n        return keystore.HaveKey(keyID);\n    case TX_SCRIPTHASH:\n    {\n        CScript subscript;\n        if (!keystore.GetCScript(CScriptID(uint160(vSolutions[0])), subscript))\n            return false;\n        return IsMine(keystore, subscript);\n    }\n    case TX_MULTISIG:\n    {\n        // Only consider transactions \"mine\" if we own ALL the\n        // keys involved. multi-signature transactions that are\n        // partially owned (somebody else has a key that can spend\n        // them) enable spend-out-from-under-you attacks, especially\n        // in shared-wallet situations.\n        vector<valtype> keys(vSolutions.begin()+1, vSolutions.begin()+vSolutions.size()-1);\n        return HaveKeys(keys, keystore) == keys.size();\n    }\n    }\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  bool IsMine(const CTxOut& txout) const\n      {\n          return ::IsMine(*this, txout.scriptPubKey);\n      }\n}"
  },
  {
    "function_name": "LoadCScript",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "150-150",
    "snippet": "bool LoadCScript(const CScript& redeemScript) { return CCryptoKeyStore::AddCScript(redeemScript); }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CCryptoKeyStore::AddCScript",
          "args": [
            "redeemScript"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "AddCScript",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.cpp",
          "lines": "101-108",
          "snippet": "bool CWallet::AddCScript(const CScript& redeemScript)\n{\n    if (!CCryptoKeyStore::AddCScript(redeemScript))\n        return false;\n    if (!fFileBacked)\n        return true;\n    return CWalletDB(strWalletFile).WriteCScript(Hash160(redeemScript), redeemScript);\n}",
          "includes": [
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"coincontrol.h\"",
            "#include \"kernel.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"crypter.h\"",
            "#include \"walletdb.h\"",
            "#include \"wallet.h\"",
            "#include \"txdb.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/replace.hpp>\n#include \"coincontrol.h\"\n#include \"kernel.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"crypter.h\"\n#include \"walletdb.h\"\n#include \"wallet.h\"\n#include \"txdb.h\"\n\nCWallet {\n  bool CWallet::AddCScript(const CScript& redeemScript)\n  {\n      if (!CCryptoKeyStore::AddCScript(redeemScript))\n          return false;\n      if (!fFileBacked)\n          return true;\n      return CWalletDB(strWalletFile).WriteCScript(Hash160(redeemScript), redeemScript);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  bool LoadCScript(const CScript& redeemScript) { return CCryptoKeyStore::AddCScript(redeemScript); }\n}"
  },
  {
    "function_name": "LoadMinVersion",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "143-143",
    "snippet": "bool LoadMinVersion(int nVersion) { nWalletVersion = nVersion; nWalletMaxVersion = std::max(nWalletMaxVersion, nVersion); return true; }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::max",
          "args": [
            "nWalletMaxVersion",
            "nVersion"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  bool LoadMinVersion(int nVersion) { nWalletVersion = nVersion; nWalletMaxVersion = std::max(nWalletMaxVersion, nVersion); return true; }\n}"
  },
  {
    "function_name": "LoadKey",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "139-139",
    "snippet": "bool LoadKey(const CKey& key) { return CCryptoKeyStore::AddKey(key); }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CCryptoKeyStore::AddKey",
          "args": [
            "key"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "AddKey",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.cpp",
          "lines": "58-69",
          "snippet": "bool CWallet::AddKey(const CKey& key)\n{\n    CPubKey pubkey = key.GetPubKey();\n\n    if (!CCryptoKeyStore::AddKey(key))\n        return false;\n    if (!fFileBacked)\n        return true;\n    if (!IsCrypted())\n        return CWalletDB(strWalletFile).WriteKey(pubkey, key.GetPrivKey(), mapKeyMetadata[pubkey.GetID()]);\n    return true;\n}",
          "includes": [
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"coincontrol.h\"",
            "#include \"kernel.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"crypter.h\"",
            "#include \"walletdb.h\"",
            "#include \"wallet.h\"",
            "#include \"txdb.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/replace.hpp>\n#include \"coincontrol.h\"\n#include \"kernel.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"crypter.h\"\n#include \"walletdb.h\"\n#include \"wallet.h\"\n#include \"txdb.h\"\n\nCWallet {\n  bool CWallet::AddKey(const CKey& key)\n  {\n      CPubKey pubkey = key.GetPubKey();\n  \n      if (!CCryptoKeyStore::AddKey(key))\n          return false;\n      if (!fFileBacked)\n          return true;\n      if (!IsCrypted())\n          return CWalletDB(strWalletFile).WriteKey(pubkey, key.GetPrivKey(), mapKeyMetadata[pubkey.GetID()]);\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  bool LoadKey(const CKey& key) { return CCryptoKeyStore::AddKey(key); }\n}"
  },
  {
    "function_name": "CanSupportFeature",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "128-128",
    "snippet": "bool CanSupportFeature(enum WalletFeature wf) { return nWalletMaxVersion >= wf; }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  bool CanSupportFeature(enum WalletFeature wf) { return nWalletMaxVersion >= wf; }\n}"
  },
  {
    "function_name": "CWallet",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "107-116",
    "snippet": "CWallet(std::string strWalletFileIn)\n    {\n        nWalletVersion = FEATURE_BASE;\n        nWalletMaxVersion = FEATURE_BASE;\n        strWalletFile = strWalletFileIn;\n        fFileBacked = true;\n        nMasterKeyMaxID = 0;\n        pwalletdbEncryption = NULL;\n        nOrderPosNext = 0;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  CWallet(std::string strWalletFileIn)\n      {\n          nWalletVersion = FEATURE_BASE;\n          nWalletMaxVersion = FEATURE_BASE;\n          strWalletFile = strWalletFileIn;\n          fFileBacked = true;\n          nMasterKeyMaxID = 0;\n          pwalletdbEncryption = NULL;\n          nOrderPosNext = 0;\n      }\n}"
  },
  {
    "function_name": "CWallet",
    "container": "CWallet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "98-106",
    "snippet": "CWallet()\n    {\n        nWalletVersion = FEATURE_BASE;\n        nWalletMaxVersion = FEATURE_BASE;\n        fFileBacked = false;\n        nMasterKeyMaxID = 0;\n        pwalletdbEncryption = NULL;\n        nOrderPosNext = 0;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  CWallet()\n      {\n          nWalletVersion = FEATURE_BASE;\n          nWalletMaxVersion = FEATURE_BASE;\n          fFileBacked = false;\n          nMasterKeyMaxID = 0;\n          pwalletdbEncryption = NULL;\n          nOrderPosNext = 0;\n      }\n}"
  },
  {
    "function_name": "CKeyPool",
    "container": "CKeyPool",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "52-56",
    "snippet": "CKeyPool(const CPubKey& vchPubKeyIn)\n    {\n        nTime = GetTime();\n        vchPubKey = vchPubKeyIn;\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetTime",
          "args": [],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "GetTimeMillis",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "370-374",
          "snippet": "inline int64_t GetTimeMillis()\n{\n    return (boost::posix_time::ptime(boost::posix_time::microsec_clock::universal_time()) -\n            boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_milliseconds();\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t GetTimeMillis()\n{\n    return (boost::posix_time::ptime(boost::posix_time::microsec_clock::universal_time()) -\n            boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_milliseconds();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCKeyPool {\n  CKeyPool(const CPubKey& vchPubKeyIn)\n      {\n          nTime = GetTime();\n          vchPubKey = vchPubKeyIn;\n      }\n}"
  },
  {
    "function_name": "CKeyPool",
    "container": "CKeyPool",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
    "lines": "47-50",
    "snippet": "CKeyPool()\n    {\n        nTime = GetTime();\n    }",
    "includes": [
      "#include \"walletdb.h\"",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"script.h\"",
      "#include \"keystore.h\"",
      "#include \"key.h\"",
      "#include \"main.h\"",
      "#include <stdlib.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetTime",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "GetTimeMillis",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "370-374",
          "snippet": "inline int64_t GetTimeMillis()\n{\n    return (boost::posix_time::ptime(boost::posix_time::microsec_clock::universal_time()) -\n            boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_milliseconds();\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t GetTimeMillis()\n{\n    return (boost::posix_time::ptime(boost::posix_time::microsec_clock::universal_time()) -\n            boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_milliseconds();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCKeyPool {\n  CKeyPool()\n      {\n          nTime = GetTime();\n      }\n}"
  }
]