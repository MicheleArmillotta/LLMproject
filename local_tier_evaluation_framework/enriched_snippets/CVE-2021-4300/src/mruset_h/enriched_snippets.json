[
  {
    "function_name": "max_size",
    "container": "mruset",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
    "lines": "51-61",
    "snippet": "size_type max_size(size_type s)\n    {\n        if (s)\n            while (queue.size() > s)\n            {\n                set.erase(queue.front());\n                queue.pop_front();\n            }\n        nMaxSize = s;\n        return nMaxSize;\n    }",
    "includes": [
      "#include <deque>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "queue.pop_front",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set.erase",
          "args": [
            "queue.front()"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "49-65",
          "snippet": "void erase(const key_type& k)\n    {\n        iterator itTarget = map.find(k);\n        if (itTarget == map.end())\n            return;\n        std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n        for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n            if (it->second == itTarget)\n            {\n                rmap.erase(it);\n                map.erase(itTarget);\n                return;\n            }\n        // Shouldn't ever get here\n        assert(0); //TODO remove me\n        map.erase(itTarget);\n    }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  void erase(const key_type& k)\n      {\n          iterator itTarget = map.find(k);\n          if (itTarget == map.end())\n              return;\n          std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n          for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n              if (it->second == itTarget)\n              {\n                  rmap.erase(it);\n                  map.erase(itTarget);\n                  return;\n              }\n          // Shouldn't ever get here\n          assert(0); //TODO remove me\n          map.erase(itTarget);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "queue.front",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue.size",
          "args": [],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "mruset",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
          "lines": "29-29",
          "snippet": "size_type size() const { return set.size(); }",
          "includes": [
            "#include <deque>",
            "#include <set>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <set>\n\nmruset {\n  size_type size() const { return set.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <deque>\n#include <set>\n\nmruset {\n  size_type max_size(size_type s)\n      {\n          if (s)\n              while (queue.size() > s)\n              {\n                  set.erase(queue.front());\n                  queue.pop_front();\n              }\n          nMaxSize = s;\n          return nMaxSize;\n      }\n}"
  },
  {
    "function_name": "max_size",
    "container": "mruset",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
    "lines": "50-50",
    "snippet": "size_type max_size() const { return nMaxSize; }",
    "includes": [
      "#include <deque>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <deque>\n#include <set>\n\nmruset {\n  size_type max_size() const { return nMaxSize; }\n}"
  },
  {
    "function_name": "insert",
    "container": "mruset",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
    "lines": "36-49",
    "snippet": "std::pair<iterator, bool> insert(const key_type& x)\n    {\n        std::pair<iterator, bool> ret = set.insert(x);\n        if (ret.second)\n        {\n            if (nMaxSize && queue.size() == nMaxSize)\n            {\n                set.erase(queue.front());\n                queue.pop_front();\n            }\n            queue.push_back(x);\n        }\n        return ret;\n    }",
    "includes": [
      "#include <deque>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "queue.push_back",
          "args": [
            "x"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue.pop_front",
          "args": [],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set.erase",
          "args": [
            "queue.front()"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "49-65",
          "snippet": "void erase(const key_type& k)\n    {\n        iterator itTarget = map.find(k);\n        if (itTarget == map.end())\n            return;\n        std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n        for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n            if (it->second == itTarget)\n            {\n                rmap.erase(it);\n                map.erase(itTarget);\n                return;\n            }\n        // Shouldn't ever get here\n        assert(0); //TODO remove me\n        map.erase(itTarget);\n    }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  void erase(const key_type& k)\n      {\n          iterator itTarget = map.find(k);\n          if (itTarget == map.end())\n              return;\n          std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n          for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n              if (it->second == itTarget)\n              {\n                  rmap.erase(it);\n                  map.erase(itTarget);\n                  return;\n              }\n          // Shouldn't ever get here\n          assert(0); //TODO remove me\n          map.erase(itTarget);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "queue.front",
          "args": [],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue.size",
          "args": [],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "mruset",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
          "lines": "29-29",
          "snippet": "size_type size() const { return set.size(); }",
          "includes": [
            "#include <deque>",
            "#include <set>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <set>\n\nmruset {\n  size_type size() const { return set.size(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "set.insert",
          "args": [
            "x"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "mruset",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
          "lines": "36-49",
          "snippet": "std::pair<iterator, bool> insert(const key_type& x)\n    {\n        std::pair<iterator, bool> ret = set.insert(x);\n        if (ret.second)\n        {\n            if (nMaxSize && queue.size() == nMaxSize)\n            {\n                set.erase(queue.front());\n                queue.pop_front();\n            }\n            queue.push_back(x);\n        }\n        return ret;\n    }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <deque>\n#include <set>\n\nmruset {\n  std::pair<iterator, bool> insert(const key_type& x)\n      {\n          std::pair<iterator, bool> ret = set.insert(x);\n          if (ret.second)\n          {\n              if (nMaxSize && queue.size() == nMaxSize)\n              {\n                  set.erase(queue.front());\n                  queue.pop_front();\n              }\n              queue.push_back(x);\n          }\n          return ret;\n      }\n}"
  },
  {
    "function_name": "count",
    "container": "mruset",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
    "lines": "32-32",
    "snippet": "size_type count(const key_type& k) const { return set.count(k); }",
    "includes": [
      "#include <deque>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set.count",
          "args": [
            "k"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "mruset",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
          "lines": "32-32",
          "snippet": "size_type count(const key_type& k) const { return set.count(k); }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <deque>\n#include <set>\n\nmruset {\n  size_type count(const key_type& k) const { return set.count(k); }\n}"
  },
  {
    "function_name": "find",
    "container": "mruset",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
    "lines": "31-31",
    "snippet": "iterator find(const key_type& k) const { return set.find(k); }",
    "includes": [
      "#include <deque>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set.find",
          "args": [
            "k"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "mruset",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
          "lines": "31-31",
          "snippet": "iterator find(const key_type& k) const { return set.find(k); }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <deque>\n#include <set>\n\nmruset {\n  iterator find(const key_type& k) const { return set.find(k); }\n}"
  },
  {
    "function_name": "empty",
    "container": "mruset",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
    "lines": "30-30",
    "snippet": "bool empty() const { return set.empty(); }",
    "includes": [
      "#include <deque>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set.empty",
          "args": [],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "mruset",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
          "lines": "30-30",
          "snippet": "bool empty() const { return set.empty(); }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <deque>\n#include <set>\n\nmruset {\n  bool empty() const { return set.empty(); }\n}"
  },
  {
    "function_name": "size",
    "container": "mruset",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
    "lines": "29-29",
    "snippet": "size_type size() const { return set.size(); }",
    "includes": [
      "#include <deque>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set.size",
          "args": [],
          "line": 29
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "mruset",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
          "lines": "29-29",
          "snippet": "size_type size() const { return set.size(); }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <deque>\n#include <set>\n\nmruset {\n  size_type size() const { return set.size(); }\n}"
  },
  {
    "function_name": "end",
    "container": "mruset",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
    "lines": "28-28",
    "snippet": "iterator end() const { return set.end(); }",
    "includes": [
      "#include <deque>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set.end",
          "args": [],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "mruset",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
          "lines": "28-28",
          "snippet": "iterator end() const { return set.end(); }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <deque>\n#include <set>\n\nmruset {\n  iterator end() const { return set.end(); }\n}"
  },
  {
    "function_name": "begin",
    "container": "mruset",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
    "lines": "27-27",
    "snippet": "iterator begin() const { return set.begin(); }",
    "includes": [
      "#include <deque>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set.begin",
          "args": [],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "mruset",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
          "lines": "27-27",
          "snippet": "iterator begin() const { return set.begin(); }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <deque>\n#include <set>\n\nmruset {\n  iterator begin() const { return set.begin(); }\n}"
  },
  {
    "function_name": "mruset",
    "container": "mruset",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/mruset.h",
    "lines": "26-26",
    "snippet": "mruset(size_type nMaxSizeIn = 0) { nMaxSize = nMaxSizeIn; }",
    "includes": [
      "#include <deque>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <deque>\n#include <set>\n\nmruset {\n  mruset(size_type nMaxSizeIn = 0) { nMaxSize = nMaxSizeIn; }\n}"
  }
]