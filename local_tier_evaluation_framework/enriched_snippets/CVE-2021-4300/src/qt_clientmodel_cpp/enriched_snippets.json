[
  {
    "function_name": "unsubscribeFromCoreSignals",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "176-184",
    "snippet": "void ClientModel::unsubscribeFromCoreSignals()\n{\n    // Disconnect signals from client\n    uiInterface.NotifyBlocksChanged.disconnect(boost::bind(NotifyBlocksChanged, this));\n    uiInterface.NotifyNumConnectionsChanged.disconnect(boost::bind(NotifyNumConnectionsChanged,\n      this, boost::placeholders::_1));\n    uiInterface.NotifyAlertChanged.disconnect(boost::bind(NotifyAlertChanged, this,\n      boost::placeholders::_1, boost::placeholders::_2));\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "uiInterface.NotifyAlertChanged.disconnect",
          "args": [
            "boost::bind(NotifyAlertChanged, this,\n      boost::placeholders::_1, boost::placeholders::_2)"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::bind",
          "args": [
            "NotifyAlertChanged",
            "this",
            "boost::placeholders::_1",
            "boost::placeholders::_2"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uiInterface.NotifyNumConnectionsChanged.disconnect",
          "args": [
            "boost::bind(NotifyNumConnectionsChanged,\n      this, boost::placeholders::_1)"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::bind",
          "args": [
            "NotifyNumConnectionsChanged",
            "this",
            "boost::placeholders::_1"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uiInterface.NotifyBlocksChanged.disconnect",
          "args": [
            "boost::bind(NotifyBlocksChanged, this)"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::bind",
          "args": [
            "NotifyBlocksChanged",
            "this"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  void ClientModel::unsubscribeFromCoreSignals()\n  {\n      // Disconnect signals from client\n      uiInterface.NotifyBlocksChanged.disconnect(boost::bind(NotifyBlocksChanged, this));\n      uiInterface.NotifyNumConnectionsChanged.disconnect(boost::bind(NotifyNumConnectionsChanged,\n        this, boost::placeholders::_1));\n      uiInterface.NotifyAlertChanged.disconnect(boost::bind(NotifyAlertChanged, this,\n        boost::placeholders::_1, boost::placeholders::_2));\n  }\n}"
  },
  {
    "function_name": "subscribeToCoreSignals",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "166-174",
    "snippet": "void ClientModel::subscribeToCoreSignals()\n{\n    // Connect signals to client\n    uiInterface.NotifyBlocksChanged.connect(boost::bind(NotifyBlocksChanged, this));\n    uiInterface.NotifyNumConnectionsChanged.connect(boost::bind(NotifyNumConnectionsChanged,\n      this, boost::placeholders::_1));\n    uiInterface.NotifyAlertChanged.connect(boost::bind(NotifyAlertChanged, this,\n      boost::placeholders::_1, boost::placeholders::_2));\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "uiInterface.NotifyAlertChanged.connect",
          "args": [
            "boost::bind(NotifyAlertChanged, this,\n      boost::placeholders::_1, boost::placeholders::_2)"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::bind",
          "args": [
            "NotifyAlertChanged",
            "this",
            "boost::placeholders::_1",
            "boost::placeholders::_2"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uiInterface.NotifyNumConnectionsChanged.connect",
          "args": [
            "boost::bind(NotifyNumConnectionsChanged,\n      this, boost::placeholders::_1)"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::bind",
          "args": [
            "NotifyNumConnectionsChanged",
            "this",
            "boost::placeholders::_1"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uiInterface.NotifyBlocksChanged.connect",
          "args": [
            "boost::bind(NotifyBlocksChanged, this)"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::bind",
          "args": [
            "NotifyBlocksChanged",
            "this"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  void ClientModel::subscribeToCoreSignals()\n  {\n      // Connect signals to client\n      uiInterface.NotifyBlocksChanged.connect(boost::bind(NotifyBlocksChanged, this));\n      uiInterface.NotifyNumConnectionsChanged.connect(boost::bind(NotifyNumConnectionsChanged,\n        this, boost::placeholders::_1));\n      uiInterface.NotifyAlertChanged.connect(boost::bind(NotifyAlertChanged, this,\n        boost::placeholders::_1, boost::placeholders::_2));\n  }\n}"
  },
  {
    "function_name": "NotifyAlertChanged",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "158-164",
    "snippet": "static void NotifyAlertChanged(ClientModel *clientmodel, const uint256 &hash, ChangeType status)\n{\n    OutputDebugStringF(\"NotifyAlertChanged %s status=%i\\n\", hash.GetHex().c_str(), status);\n    QMetaObject::invokeMethod(clientmodel, \"updateAlert\", Qt::QueuedConnection,\n                              Q_ARG(QString, QString::fromStdString(hash.GetHex())),\n                              Q_ARG(int, status));\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QMetaObject::invokeMethod",
          "args": [
            "clientmodel",
            "\"updateAlert\"",
            "Qt::QueuedConnection",
            "Q_ARG(QString, QString::fromStdString(hash.GetHex()))",
            "Q_ARG(int, status)"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_ARG",
          "args": [
            "int,status"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_ARG",
          "args": [
            "QString",
            "QString::fromStdString(hash.GetHex())"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "hash.GetHex()"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.GetHex",
          "args": [],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "GetHex",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "402-405",
          "snippet": "std::string GetHex() const\n    {\n        return ToString(16);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  std::string GetHex() const\n      {\n          return ToString(16);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "OutputDebugStringF",
          "args": [
            "\"NotifyAlertChanged %s status=%i\\n\"",
            "hash.GetHex().c_str()",
            "status"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nstatic void NotifyAlertChanged(ClientModel *clientmodel, const uint256 &hash, ChangeType status)\n{\n    OutputDebugStringF(\"NotifyAlertChanged %s status=%i\\n\", hash.GetHex().c_str(), status);\n    QMetaObject::invokeMethod(clientmodel, \"updateAlert\", Qt::QueuedConnection,\n                              Q_ARG(QString, QString::fromStdString(hash.GetHex())),\n                              Q_ARG(int, status));\n}"
  },
  {
    "function_name": "NotifyNumConnectionsChanged",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "151-156",
    "snippet": "static void NotifyNumConnectionsChanged(ClientModel *clientmodel, int newNumConnections)\n{\n    // Too noisy: OutputDebugStringF(\"NotifyNumConnectionsChanged %i\\n\", newNumConnections);\n    QMetaObject::invokeMethod(clientmodel, \"updateNumConnections\", Qt::QueuedConnection,\n                              Q_ARG(int, newNumConnections));\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QMetaObject::invokeMethod",
          "args": [
            "clientmodel",
            "\"updateNumConnections\"",
            "Qt::QueuedConnection",
            "Q_ARG(int, newNumConnections)"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_ARG",
          "args": [
            "int,newNumConnections"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nstatic void NotifyNumConnectionsChanged(ClientModel *clientmodel, int newNumConnections)\n{\n    // Too noisy: OutputDebugStringF(\"NotifyNumConnectionsChanged %i\\n\", newNumConnections);\n    QMetaObject::invokeMethod(clientmodel, \"updateNumConnections\", Qt::QueuedConnection,\n                              Q_ARG(int, newNumConnections));\n}"
  },
  {
    "function_name": "NotifyBlocksChanged",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "145-149",
    "snippet": "static void NotifyBlocksChanged(ClientModel *clientmodel)\n{\n    // This notification is too frequent. Don't trigger a signal.\n    // Don't remove it, though, as it might be useful later.\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nstatic void NotifyBlocksChanged(ClientModel *clientmodel)\n{\n    // This notification is too frequent. Don't trigger a signal.\n    // Don't remove it, though, as it might be useful later.\n}"
  },
  {
    "function_name": "formatClientStartupTime",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "139-142",
    "snippet": "QString ClientModel::formatClientStartupTime() const\n{\n    return QDateTime::fromTime_t(nClientStartupTime).toString();\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const int64_t nClientStartupTime = GetTime();"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "QDateTime::fromTime_t",
          "args": [],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDateTime::fromTime_t",
          "args": [
            "nClientStartupTime"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nstatic const int64_t nClientStartupTime = GetTime();\n\nClientModel {\n  QString ClientModel::formatClientStartupTime() const\n  {\n      return QDateTime::fromTime_t(nClientStartupTime).toString();\n  }\n}"
  },
  {
    "function_name": "clientName",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "134-137",
    "snippet": "QString ClientModel::clientName() const\n{\n    return QString::fromStdString(CLIENT_NAME);\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "CLIENT_NAME"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  QString ClientModel::clientName() const\n  {\n      return QString::fromStdString(CLIENT_NAME);\n  }\n}"
  },
  {
    "function_name": "formatBuildDate",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "129-132",
    "snippet": "QString ClientModel::formatBuildDate() const\n{\n    return QString::fromStdString(CLIENT_DATE);\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "CLIENT_DATE"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  QString ClientModel::formatBuildDate() const\n  {\n      return QString::fromStdString(CLIENT_DATE);\n  }\n}"
  },
  {
    "function_name": "formatFullVersion",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "124-127",
    "snippet": "QString ClientModel::formatFullVersion() const\n{\n    return QString::fromStdString(FormatFullVersion());\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "FormatFullVersion()"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatFullVersion",
          "args": [],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "FormatFullVersion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1288-1291",
          "snippet": "string FormatFullVersion()\n{\n    return CLIENT_BUILD;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring FormatFullVersion()\n{\n    return CLIENT_BUILD;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  QString ClientModel::formatFullVersion() const\n  {\n      return QString::fromStdString(FormatFullVersion());\n  }\n}"
  },
  {
    "function_name": "getStatusBarWarnings",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "114-117",
    "snippet": "QString ClientModel::getStatusBarWarnings() const\n{\n    return QString::fromStdString(GetWarnings(\"statusbar\"));\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "GetWarnings(\"statusbar\")"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetWarnings",
          "args": [
            "\"statusbar\""
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "GetWarnings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "2956-3001",
          "snippet": "string GetWarnings(string strFor)\n{\n    int nPriority = 0;\n    string strStatusBar;\n    string strRPC;\n\n    if (GetBoolArg(\"-testsafemode\"))\n        strRPC = \"test\";\n\n    // Misc warnings like out of disk space and clock is wrong\n    if (strMiscWarning != \"\")\n    {\n        nPriority = 1000;\n        strStatusBar = strMiscWarning;\n    }\n\n    // if detected invalid checkpoint enter safe mode\n    if (Checkpoints::hashInvalidCheckpoint != 0)\n    {\n        nPriority = 3000;\n        strStatusBar = strRPC = _(\"WARNING: Invalid checkpoint found! Displayed transactions may not be correct! You may need to upgrade, or notify developers.\");\n    }\n\n    // Alerts\n    {\n        LOCK(cs_mapAlerts);\n        BOOST_FOREACH(PAIRTYPE(const uint256, CAlert)& item, mapAlerts)\n        {\n            const CAlert& alert = item.second;\n            if (alert.AppliesToMe() && alert.nPriority > nPriority)\n            {\n                nPriority = alert.nPriority;\n                strStatusBar = alert.strStatusBar;\n                if (nPriority > 1000)\n                    strRPC = strStatusBar;\n            }\n        }\n    }\n\n    if (strFor == \"statusbar\")\n        return strStatusBar;\n    else if (strFor == \"rpc\")\n        return strRPC;\n    assert(!\"GetWarnings() : invalid parameter\");\n    return \"error\";\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "CBigNum bnProofOfWorkLimit(~uint256(0) >> 20);",
            "CBigNum bnProofOfStakeLimit(~uint256(0) >> 20);",
            "const CBigNum bnNeoScryptSwitch(~uint256(0) >> 30);",
            "CBigNum bnProofOfWorkLimitTestNet(~uint256(0) >> 16);",
            "CBigNum bnProofOfStakeLimitTestNet(~uint256(0) >> 16);",
            "extern map<uint256, CAlert> mapAlerts;",
            "extern CCriticalSection cs_mapAlerts;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nCBigNum bnProofOfWorkLimit(~uint256(0) >> 20);\nCBigNum bnProofOfStakeLimit(~uint256(0) >> 20);\nconst CBigNum bnNeoScryptSwitch(~uint256(0) >> 30);\nCBigNum bnProofOfWorkLimitTestNet(~uint256(0) >> 16);\nCBigNum bnProofOfStakeLimitTestNet(~uint256(0) >> 16);\nextern map<uint256, CAlert> mapAlerts;\nextern CCriticalSection cs_mapAlerts;\n\nstring GetWarnings(string strFor)\n{\n    int nPriority = 0;\n    string strStatusBar;\n    string strRPC;\n\n    if (GetBoolArg(\"-testsafemode\"))\n        strRPC = \"test\";\n\n    // Misc warnings like out of disk space and clock is wrong\n    if (strMiscWarning != \"\")\n    {\n        nPriority = 1000;\n        strStatusBar = strMiscWarning;\n    }\n\n    // if detected invalid checkpoint enter safe mode\n    if (Checkpoints::hashInvalidCheckpoint != 0)\n    {\n        nPriority = 3000;\n        strStatusBar = strRPC = _(\"WARNING: Invalid checkpoint found! Displayed transactions may not be correct! You may need to upgrade, or notify developers.\");\n    }\n\n    // Alerts\n    {\n        LOCK(cs_mapAlerts);\n        BOOST_FOREACH(PAIRTYPE(const uint256, CAlert)& item, mapAlerts)\n        {\n            const CAlert& alert = item.second;\n            if (alert.AppliesToMe() && alert.nPriority > nPriority)\n            {\n                nPriority = alert.nPriority;\n                strStatusBar = alert.strStatusBar;\n                if (nPriority > 1000)\n                    strRPC = strStatusBar;\n            }\n        }\n    }\n\n    if (strFor == \"statusbar\")\n        return strStatusBar;\n    else if (strFor == \"rpc\")\n        return strRPC;\n    assert(!\"GetWarnings() : invalid parameter\");\n    return \"error\";\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  QString ClientModel::getStatusBarWarnings() const\n  {\n      return QString::fromStdString(GetWarnings(\"statusbar\"));\n  }\n}"
  },
  {
    "function_name": "getNumBlocksOfPeers",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "109-112",
    "snippet": "int ClientModel::getNumBlocksOfPeers() const\n{\n    return GetNumBlocksOfPeers();\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetNumBlocksOfPeers",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "GetNumBlocksOfPeers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "1215-1218",
          "snippet": "int GetNumBlocksOfPeers()\n{\n    return std::max(cPeerBlockCounts.median(), Checkpoints::GetTotalBlocksEstimate());\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "CMedianFilter<int> cPeerBlockCounts(5, 0);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nCMedianFilter<int> cPeerBlockCounts(5, 0);\n\nint GetNumBlocksOfPeers()\n{\n    return std::max(cPeerBlockCounts.median(), Checkpoints::GetTotalBlocksEstimate());\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  int ClientModel::getNumBlocksOfPeers() const\n  {\n      return GetNumBlocksOfPeers();\n  }\n}"
  },
  {
    "function_name": "inInitialBlockDownload",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "104-107",
    "snippet": "bool ClientModel::inInitialBlockDownload() const\n{\n    return IsInitialBlockDownload();\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsInitialBlockDownload",
          "args": [],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "IsInitialBlockDownload",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "1220-1233",
          "snippet": "bool IsInitialBlockDownload()\n{\n    if (pindexBest == NULL || nBestHeight < Checkpoints::GetTotalBlocksEstimate())\n        return true;\n    static int64_t nLastUpdate;\n    static CBlockIndex* pindexLastBest;\n    if (pindexBest != pindexLastBest)\n    {\n        pindexLastBest = pindexBest;\n        nLastUpdate = GetTime();\n    }\n    return(((GetTime() - nLastUpdate) < 10) &&\n      (pindexBest->GetBlockTime() < (GetTime() - 4 * 60 * 60)));\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int nBestHeight = -1;",
            "CBlockIndex* pindexBest = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nint nBestHeight = -1;\nCBlockIndex* pindexBest = NULL;\n\nbool IsInitialBlockDownload()\n{\n    if (pindexBest == NULL || nBestHeight < Checkpoints::GetTotalBlocksEstimate())\n        return true;\n    static int64_t nLastUpdate;\n    static CBlockIndex* pindexLastBest;\n    if (pindexBest != pindexLastBest)\n    {\n        pindexLastBest = pindexBest;\n        nLastUpdate = GetTime();\n    }\n    return(((GetTime() - nLastUpdate) < 10) &&\n      (pindexBest->GetBlockTime() < (GetTime() - 4 * 60 * 60)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  bool ClientModel::inInitialBlockDownload() const\n  {\n      return IsInitialBlockDownload();\n  }\n}"
  },
  {
    "function_name": "isTestNet",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "99-102",
    "snippet": "bool ClientModel::isTestNet() const\n{\n    return fTestNet;\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  bool ClientModel::isTestNet() const\n  {\n      return fTestNet;\n  }\n}"
  },
  {
    "function_name": "updateAlert",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "80-97",
    "snippet": "void ClientModel::updateAlert(const QString &hash, int status)\n{\n    // Show error message notification for new alert\n    if(status == CT_NEW)\n    {\n        uint256 hash_256;\n        hash_256.SetHex(hash.toStdString());\n        CAlert alert = CAlert::getAlertByHash(hash_256);\n        if(!alert.IsNull())\n        {\n            emit error(tr(\"Network Alert\"), QString::fromStdString(alert.strStatusBar), false);\n        }\n    }\n\n    // Emit a numBlocksChanged when the status message changes,\n    // so that the view recomputes and updates the status bar.\n    emit numBlocksChanged(getNumBlocks(), getNumBlocksOfPeers());\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "alert.strStatusBar"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Network Alert\""
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "alert.IsNull",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "IsNull",
          "container": "CSyncCheckpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/checkpoints.h",
          "lines": "133-136",
          "snippet": "bool IsNull() const\n    {\n        return (hashCheckpoint == 0);\n    }",
          "includes": [
            "#include \"util.h\"",
            "#include \"net.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"net.h\"\n#include <map>\n\nCSyncCheckpoint {\n  bool IsNull() const\n      {\n          return (hashCheckpoint == 0);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CAlert::getAlertByHash",
          "args": [
            "hash_256"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "getAlertByHash",
          "container": "CAlert",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/alert.cpp",
          "lines": "161-171",
          "snippet": "CAlert CAlert::getAlertByHash(const uint256 &hash)\n{\n    CAlert retval;\n    {\n        LOCK(cs_mapAlerts);\n        map<uint256, CAlert>::iterator mi = mapAlerts.find(hash);\n        if(mi != mapAlerts.end())\n            retval = mi->second;\n    }\n    return retval;\n}",
          "includes": [
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"net.h\"",
            "#include \"key.h\"",
            "#include \"alert.h\"",
            "#include <map>",
            "#include <boost/foreach.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include <boost/algorithm/string/classification.hpp>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [
            "map<uint256, CAlert> mapAlerts;",
            "CCriticalSection cs_mapAlerts;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"net.h\"\n#include \"key.h\"\n#include \"alert.h\"\n#include <map>\n#include <boost/foreach.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include <boost/algorithm/string/classification.hpp>\n#include <algorithm>\n\nmap<uint256, CAlert> mapAlerts;\nCCriticalSection cs_mapAlerts;\n\nCAlert {\n  CAlert CAlert::getAlertByHash(const uint256 &hash)\n  {\n      CAlert retval;\n      {\n          LOCK(cs_mapAlerts);\n          map<uint256, CAlert>::iterator mi = mapAlerts.find(hash);\n          if(mi != mapAlerts.end())\n              retval = mi->second;\n      }\n      return retval;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash_256.SetHex",
          "args": [
            "hash.toStdString()"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "SetHex",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "346-374",
          "snippet": "void SetHex(const std::string& str)\n    {\n        // skip 0x\n        const char* psz = str.c_str();\n        while (isspace(*psz))\n            psz++;\n        bool fNegative = false;\n        if (*psz == '-')\n        {\n            fNegative = true;\n            psz++;\n        }\n        if (psz[0] == '0' && tolower(psz[1]) == 'x')\n            psz += 2;\n        while (isspace(*psz))\n            psz++;\n\n        // hex string to bignum\n        static const signed char phexdigit[256] = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0 };\n        *this = 0;\n        while (isxdigit(*psz))\n        {\n            *this <<= 4;\n            int n = phexdigit[(unsigned char)*psz++];\n            *this += n;\n        }\n        if (fNegative)\n            *this = 0 - *this;\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void SetHex(const std::string& str)\n      {\n          // skip 0x\n          const char* psz = str.c_str();\n          while (isspace(*psz))\n              psz++;\n          bool fNegative = false;\n          if (*psz == '-')\n          {\n              fNegative = true;\n              psz++;\n          }\n          if (psz[0] == '0' && tolower(psz[1]) == 'x')\n              psz += 2;\n          while (isspace(*psz))\n              psz++;\n  \n          // hex string to bignum\n          static const signed char phexdigit[256] = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0 };\n          *this = 0;\n          while (isxdigit(*psz))\n          {\n              *this <<= 4;\n              int n = phexdigit[(unsigned char)*psz++];\n              *this += n;\n          }\n          if (fNegative)\n              *this = 0 - *this;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.toStdString",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  void ClientModel::updateAlert(const QString &hash, int status)\n  {\n      // Show error message notification for new alert\n      if(status == CT_NEW)\n      {\n          uint256 hash_256;\n          hash_256.SetHex(hash.toStdString());\n          CAlert alert = CAlert::getAlertByHash(hash_256);\n          if(!alert.IsNull())\n          {\n              emit error(tr(\"Network Alert\"), QString::fromStdString(alert.strStatusBar), false);\n          }\n      }\n  \n      // Emit a numBlocksChanged when the status message changes,\n      // so that the view recomputes and updates the status bar.\n      emit numBlocksChanged(getNumBlocks(), getNumBlocksOfPeers());\n  }\n}"
  },
  {
    "function_name": "updateNumConnections",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "75-78",
    "snippet": "void ClientModel::updateNumConnections(int numConnections)\n{\n    emit numConnectionsChanged(numConnections);\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  void ClientModel::updateNumConnections(int numConnections)\n  {\n      emit numConnectionsChanged(numConnections);\n  }\n}"
  },
  {
    "function_name": "updateTimer",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "59-73",
    "snippet": "void ClientModel::updateTimer()\n{\n    // Some quantities (such as number of blocks) change so fast that we don't want to be notified for each change.\n    // Periodically check and update with a timer.\n    int newNumBlocks = getNumBlocks();\n    int newNumBlocksOfPeers = getNumBlocksOfPeers();\n\n    if(cachedNumBlocks != newNumBlocks || cachedNumBlocksOfPeers != newNumBlocksOfPeers)\n    {\n        cachedNumBlocks = newNumBlocks;\n        cachedNumBlocksOfPeers = newNumBlocksOfPeers;\n\n        emit numBlocksChanged(newNumBlocks, newNumBlocksOfPeers);\n    }\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "getNumBlocksOfPeers",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "getNumBlocksOfPeers",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "109-112",
          "snippet": "int ClientModel::getNumBlocksOfPeers() const\n{\n    return GetNumBlocksOfPeers();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  int ClientModel::getNumBlocksOfPeers() const\n  {\n      return GetNumBlocksOfPeers();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  void ClientModel::updateTimer()\n  {\n      // Some quantities (such as number of blocks) change so fast that we don't want to be notified for each change.\n      // Periodically check and update with a timer.\n      int newNumBlocks = getNumBlocks();\n      int newNumBlocksOfPeers = getNumBlocksOfPeers();\n  \n      if(cachedNumBlocks != newNumBlocks || cachedNumBlocksOfPeers != newNumBlocksOfPeers)\n      {\n          cachedNumBlocks = newNumBlocks;\n          cachedNumBlocksOfPeers = newNumBlocksOfPeers;\n  \n          emit numBlocksChanged(newNumBlocks, newNumBlocksOfPeers);\n      }\n  }\n}"
  },
  {
    "function_name": "getLastBlockDate",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "51-57",
    "snippet": "QDateTime ClientModel::getLastBlockDate() const\n{\n    if (pindexBest)\n        return QDateTime::fromTime_t(pindexBest->GetBlockTime());\n    else\n        return QDateTime::fromTime_t(1393221600); // Genesis block's time\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QDateTime::fromTime_t",
          "args": [
            "1393221600"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDateTime::fromTime_t",
          "args": [
            "pindexBest->GetBlockTime()"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pindexBest->GetBlockTime",
          "args": [],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "GetBlockTime",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1284-1287",
          "snippet": "int64_t GetBlockTime() const\n    {\n        return (int64_t)nTime;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  int64_t GetBlockTime() const\n      {\n          return (int64_t)nTime;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  QDateTime ClientModel::getLastBlockDate() const\n  {\n      if (pindexBest)\n          return QDateTime::fromTime_t(pindexBest->GetBlockTime());\n      else\n          return QDateTime::fromTime_t(1393221600); // Genesis block's time\n  }\n}"
  },
  {
    "function_name": "getNumBlocksAtStartup",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "45-49",
    "snippet": "int ClientModel::getNumBlocksAtStartup()\n{\n    if (numBlocksAtStartup == -1) numBlocksAtStartup = getNumBlocks();\n    return numBlocksAtStartup;\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "getNumBlocks",
          "args": [],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "getNumBlocksOfPeers",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "109-112",
          "snippet": "int ClientModel::getNumBlocksOfPeers() const\n{\n    return GetNumBlocksOfPeers();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  int ClientModel::getNumBlocksOfPeers() const\n  {\n      return GetNumBlocksOfPeers();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  int ClientModel::getNumBlocksAtStartup()\n  {\n      if (numBlocksAtStartup == -1) numBlocksAtStartup = getNumBlocks();\n      return numBlocksAtStartup;\n  }\n}"
  },
  {
    "function_name": "getNumBlocks",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "40-43",
    "snippet": "int ClientModel::getNumBlocks() const\n{\n    return nBestHeight;\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  int ClientModel::getNumBlocks() const\n  {\n      return nBestHeight;\n  }\n}"
  },
  {
    "function_name": "getNumConnections",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "35-38",
    "snippet": "int ClientModel::getNumConnections() const\n{\n    return vNodes.size();\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vNodes.size",
          "args": [],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  int ClientModel::getNumConnections() const\n  {\n      return vNodes.size();\n  }\n}"
  },
  {
    "function_name": "~ClientModel",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "30-33",
    "snippet": "ClientModel::~ClientModel()\n{\n    unsubscribeFromCoreSignals();\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unsubscribeFromCoreSignals",
          "args": [],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "unsubscribeFromCoreSignals",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "176-184",
          "snippet": "void ClientModel::unsubscribeFromCoreSignals()\n{\n    // Disconnect signals from client\n    uiInterface.NotifyBlocksChanged.disconnect(boost::bind(NotifyBlocksChanged, this));\n    uiInterface.NotifyNumConnectionsChanged.disconnect(boost::bind(NotifyNumConnectionsChanged,\n      this, boost::placeholders::_1));\n    uiInterface.NotifyAlertChanged.disconnect(boost::bind(NotifyAlertChanged, this,\n      boost::placeholders::_1, boost::placeholders::_2));\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  void ClientModel::unsubscribeFromCoreSignals()\n  {\n      // Disconnect signals from client\n      uiInterface.NotifyBlocksChanged.disconnect(boost::bind(NotifyBlocksChanged, this));\n      uiInterface.NotifyNumConnectionsChanged.disconnect(boost::bind(NotifyNumConnectionsChanged,\n        this, boost::placeholders::_1));\n      uiInterface.NotifyAlertChanged.disconnect(boost::bind(NotifyAlertChanged, this,\n        boost::placeholders::_1, boost::placeholders::_2));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  ClientModel::~ClientModel()\n  {\n      unsubscribeFromCoreSignals();\n  }\n}"
  },
  {
    "function_name": "ClientModel",
    "container": "ClientModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
    "lines": "16-28",
    "snippet": "ClientModel::ClientModel(OptionsModel *optionsModel, QObject *parent) :\n    QObject(parent), optionsModel(optionsModel),\n    cachedNumBlocks(0), cachedNumBlocksOfPeers(0), pollTimer(0)\n{\n    numBlocksAtStartup = -1;\n\n    pollTimer = new QTimer(this);\n    pollTimer->setInterval(MODEL_UPDATE_DELAY);\n    pollTimer->start();\n    connect(pollTimer, SIGNAL(timeout()), this, SLOT(updateTimer()));\n\n    subscribeToCoreSignals();\n}",
    "includes": [
      "#include <QTimer>",
      "#include <QDateTime>",
      "#include \"ui_interface.h\"",
      "#include \"main.h\"",
      "#include \"alert.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"guiconstants.h\"",
      "#include \"clientmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "subscribeToCoreSignals",
          "args": [],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "subscribeToCoreSignals",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "166-174",
          "snippet": "void ClientModel::subscribeToCoreSignals()\n{\n    // Connect signals to client\n    uiInterface.NotifyBlocksChanged.connect(boost::bind(NotifyBlocksChanged, this));\n    uiInterface.NotifyNumConnectionsChanged.connect(boost::bind(NotifyNumConnectionsChanged,\n      this, boost::placeholders::_1));\n    uiInterface.NotifyAlertChanged.connect(boost::bind(NotifyAlertChanged, this,\n      boost::placeholders::_1, boost::placeholders::_2));\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  void ClientModel::subscribeToCoreSignals()\n  {\n      // Connect signals to client\n      uiInterface.NotifyBlocksChanged.connect(boost::bind(NotifyBlocksChanged, this));\n      uiInterface.NotifyNumConnectionsChanged.connect(boost::bind(NotifyNumConnectionsChanged,\n        this, boost::placeholders::_1));\n      uiInterface.NotifyAlertChanged.connect(boost::bind(NotifyAlertChanged, this,\n        boost::placeholders::_1, boost::placeholders::_2));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "pollTimer",
            "SIGNAL(timeout())",
            "this",
            "SLOT(updateTimer())"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "updateTimer()"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "updateTimer",
          "args": [],
          "line": 25
        },
        "resolved": true,
        "details": {
          "function_name": "updateTimer",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "59-73",
          "snippet": "void ClientModel::updateTimer()\n{\n    // Some quantities (such as number of blocks) change so fast that we don't want to be notified for each change.\n    // Periodically check and update with a timer.\n    int newNumBlocks = getNumBlocks();\n    int newNumBlocksOfPeers = getNumBlocksOfPeers();\n\n    if(cachedNumBlocks != newNumBlocks || cachedNumBlocksOfPeers != newNumBlocksOfPeers)\n    {\n        cachedNumBlocks = newNumBlocks;\n        cachedNumBlocksOfPeers = newNumBlocksOfPeers;\n\n        emit numBlocksChanged(newNumBlocks, newNumBlocksOfPeers);\n    }\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  void ClientModel::updateTimer()\n  {\n      // Some quantities (such as number of blocks) change so fast that we don't want to be notified for each change.\n      // Periodically check and update with a timer.\n      int newNumBlocks = getNumBlocks();\n      int newNumBlocksOfPeers = getNumBlocksOfPeers();\n  \n      if(cachedNumBlocks != newNumBlocks || cachedNumBlocksOfPeers != newNumBlocksOfPeers)\n      {\n          cachedNumBlocks = newNumBlocks;\n          cachedNumBlocksOfPeers = newNumBlocksOfPeers;\n  \n          emit numBlocksChanged(newNumBlocks, newNumBlocksOfPeers);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "timeout()"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timeout",
          "args": [],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pollTimer->start",
          "args": [],
          "line": 24
        },
        "resolved": true,
        "details": {
          "function_name": "start",
          "container": "RPCExecutor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "51-54",
          "snippet": "void RPCExecutor::start()\n{\n   // Nothing to do\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCExecutor {\n  void RPCExecutor::start()\n  {\n     // Nothing to do\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pollTimer->setInterval",
          "args": [
            "MODEL_UPDATE_DELAY"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  ClientModel::ClientModel(OptionsModel *optionsModel, QObject *parent) :\n      QObject(parent), optionsModel(optionsModel),\n      cachedNumBlocks(0), cachedNumBlocksOfPeers(0), pollTimer(0)\n  {\n      numBlocksAtStartup = -1;\n  \n      pollTimer = new QTimer(this);\n      pollTimer->setInterval(MODEL_UPDATE_DELAY);\n      pollTimer->start();\n      connect(pollTimer, SIGNAL(timeout()), this, SLOT(updateTimer()));\n  \n      subscribeToCoreSignals();\n  }\n}"
  }
]