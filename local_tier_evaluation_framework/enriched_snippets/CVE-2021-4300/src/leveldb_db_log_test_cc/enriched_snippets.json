[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "498-500",
    "snippet": "int main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "leveldb::test::RunAllTests",
          "args": [],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "RunAllTests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "36-58",
          "snippet": "int RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nint main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "491-493",
    "snippet": "TEST(LogTest, ReadPastEnd) {\n  CheckOffsetPastEndReturnsNoRecords(5);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckOffsetPastEndReturnsNoRecords",
          "args": [
            "5"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "CheckOffsetPastEndReturnsNoRecords",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "192-202",
          "snippet": "void CheckOffsetPastEndReturnsNoRecords(uint64_t offset_past_end) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       WrittenBytes() + offset_past_end);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(!offset_reader->ReadRecord(&record, &scratch));\n    delete offset_reader;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckOffsetPastEndReturnsNoRecords(uint64_t offset_past_end) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         WrittenBytes() + offset_past_end);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(!offset_reader->ReadRecord(&record, &scratch));\n      delete offset_reader;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadPastEnd) {\n  CheckOffsetPastEndReturnsNoRecords(5);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "487-489",
    "snippet": "TEST(LogTest, ReadEnd) {\n  CheckOffsetPastEndReturnsNoRecords(0);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckOffsetPastEndReturnsNoRecords",
          "args": [
            "0"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "CheckOffsetPastEndReturnsNoRecords",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "192-202",
          "snippet": "void CheckOffsetPastEndReturnsNoRecords(uint64_t offset_past_end) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       WrittenBytes() + offset_past_end);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(!offset_reader->ReadRecord(&record, &scratch));\n    delete offset_reader;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckOffsetPastEndReturnsNoRecords(uint64_t offset_past_end) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         WrittenBytes() + offset_past_end);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(!offset_reader->ReadRecord(&record, &scratch));\n      delete offset_reader;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadEnd) {\n  CheckOffsetPastEndReturnsNoRecords(0);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "481-485",
    "snippet": "TEST(LogTest, ReadFourthStart) {\n  CheckInitialOffsetRecord(\n      2 * (kHeaderSize + 1000) + (2 * log::kBlockSize - 1000) + 3 * kHeaderSize,\n      3);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckInitialOffsetRecord",
          "args": [
            "2 * (kHeaderSize + 1000) + (2 * log::kBlockSize - 1000) + 3 * kHeaderSize",
            "3"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "CheckInitialOffsetRecord",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "204-220",
          "snippet": "void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                int expected_record_offset) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       initial_offset);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n    ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n              record.size());\n    ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n              offset_reader->LastRecordOffset());\n    ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n    delete offset_reader;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                  int expected_record_offset) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         initial_offset);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n      ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n                record.size());\n      ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n                offset_reader->LastRecordOffset());\n      ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n      delete offset_reader;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadFourthStart) {\n  CheckInitialOffsetRecord(\n      2 * (kHeaderSize + 1000) + (2 * log::kBlockSize - 1000) + 3 * kHeaderSize,\n      3);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "477-479",
    "snippet": "TEST(LogTest, ReadFourthLastBlock) {\n  CheckInitialOffsetRecord(2 * log::kBlockSize + 1, 3);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckInitialOffsetRecord",
          "args": [
            "2 * log::kBlockSize + 1",
            "3"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "CheckInitialOffsetRecord",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "204-220",
          "snippet": "void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                int expected_record_offset) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       initial_offset);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n    ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n              record.size());\n    ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n              offset_reader->LastRecordOffset());\n    ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n    delete offset_reader;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                  int expected_record_offset) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         initial_offset);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n      ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n                record.size());\n      ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n                offset_reader->LastRecordOffset());\n      ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n      delete offset_reader;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadFourthLastBlock) {\n  CheckInitialOffsetRecord(2 * log::kBlockSize + 1, 3);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "473-475",
    "snippet": "TEST(LogTest, ReadFourthMiddleBlock) {\n  CheckInitialOffsetRecord(log::kBlockSize + 1, 3);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckInitialOffsetRecord",
          "args": [
            "log::kBlockSize + 1",
            "3"
          ],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "CheckInitialOffsetRecord",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "204-220",
          "snippet": "void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                int expected_record_offset) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       initial_offset);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n    ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n              record.size());\n    ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n              offset_reader->LastRecordOffset());\n    ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n    delete offset_reader;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                  int expected_record_offset) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         initial_offset);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n      ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n                record.size());\n      ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n                offset_reader->LastRecordOffset());\n      ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n      delete offset_reader;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadFourthMiddleBlock) {\n  CheckInitialOffsetRecord(log::kBlockSize + 1, 3);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "469-471",
    "snippet": "TEST(LogTest, ReadFourthFirstBlockTrailer) {\n  CheckInitialOffsetRecord(log::kBlockSize - 4, 3);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckInitialOffsetRecord",
          "args": [
            "log::kBlockSize - 4",
            "3"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "CheckInitialOffsetRecord",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "204-220",
          "snippet": "void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                int expected_record_offset) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       initial_offset);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n    ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n              record.size());\n    ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n              offset_reader->LastRecordOffset());\n    ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n    delete offset_reader;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                  int expected_record_offset) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         initial_offset);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n      ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n                record.size());\n      ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n                offset_reader->LastRecordOffset());\n      ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n      delete offset_reader;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadFourthFirstBlockTrailer) {\n  CheckInitialOffsetRecord(log::kBlockSize - 4, 3);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "465-467",
    "snippet": "TEST(LogTest, ReadFourthOneOff) {\n  CheckInitialOffsetRecord(20015, 3);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckInitialOffsetRecord",
          "args": [
            "20015",
            "3"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "CheckInitialOffsetRecord",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "204-220",
          "snippet": "void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                int expected_record_offset) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       initial_offset);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n    ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n              record.size());\n    ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n              offset_reader->LastRecordOffset());\n    ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n    delete offset_reader;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                  int expected_record_offset) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         initial_offset);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n      ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n                record.size());\n      ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n                offset_reader->LastRecordOffset());\n      ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n      delete offset_reader;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadFourthOneOff) {\n  CheckInitialOffsetRecord(20015, 3);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "461-463",
    "snippet": "TEST(LogTest, ReadThirdStart) {\n  CheckInitialOffsetRecord(20014, 2);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckInitialOffsetRecord",
          "args": [
            "20014",
            "2"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "CheckInitialOffsetRecord",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "204-220",
          "snippet": "void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                int expected_record_offset) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       initial_offset);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n    ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n              record.size());\n    ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n              offset_reader->LastRecordOffset());\n    ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n    delete offset_reader;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                  int expected_record_offset) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         initial_offset);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n      ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n                record.size());\n      ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n                offset_reader->LastRecordOffset());\n      ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n      delete offset_reader;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadThirdStart) {\n  CheckInitialOffsetRecord(20014, 2);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "457-459",
    "snippet": "TEST(LogTest, ReadThirdOneOff) {\n  CheckInitialOffsetRecord(10008, 2);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckInitialOffsetRecord",
          "args": [
            "10008",
            "2"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "CheckInitialOffsetRecord",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "204-220",
          "snippet": "void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                int expected_record_offset) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       initial_offset);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n    ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n              record.size());\n    ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n              offset_reader->LastRecordOffset());\n    ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n    delete offset_reader;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                  int expected_record_offset) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         initial_offset);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n      ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n                record.size());\n      ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n                offset_reader->LastRecordOffset());\n      ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n      delete offset_reader;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadThirdOneOff) {\n  CheckInitialOffsetRecord(10008, 2);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "453-455",
    "snippet": "TEST(LogTest, ReadSecondStart) {\n  CheckInitialOffsetRecord(10007, 1);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckInitialOffsetRecord",
          "args": [
            "10007",
            "1"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "CheckInitialOffsetRecord",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "204-220",
          "snippet": "void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                int expected_record_offset) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       initial_offset);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n    ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n              record.size());\n    ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n              offset_reader->LastRecordOffset());\n    ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n    delete offset_reader;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                  int expected_record_offset) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         initial_offset);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n      ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n                record.size());\n      ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n                offset_reader->LastRecordOffset());\n      ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n      delete offset_reader;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadSecondStart) {\n  CheckInitialOffsetRecord(10007, 1);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "449-451",
    "snippet": "TEST(LogTest, ReadSecondTenThousand) {\n  CheckInitialOffsetRecord(10000, 1);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckInitialOffsetRecord",
          "args": [
            "10000",
            "1"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "CheckInitialOffsetRecord",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "204-220",
          "snippet": "void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                int expected_record_offset) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       initial_offset);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n    ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n              record.size());\n    ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n              offset_reader->LastRecordOffset());\n    ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n    delete offset_reader;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                  int expected_record_offset) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         initial_offset);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n      ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n                record.size());\n      ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n                offset_reader->LastRecordOffset());\n      ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n      delete offset_reader;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadSecondTenThousand) {\n  CheckInitialOffsetRecord(10000, 1);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "445-447",
    "snippet": "TEST(LogTest, ReadSecondOneOff) {\n  CheckInitialOffsetRecord(1, 1);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckInitialOffsetRecord",
          "args": [
            "1",
            "1"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "CheckInitialOffsetRecord",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "204-220",
          "snippet": "void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                int expected_record_offset) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       initial_offset);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n    ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n              record.size());\n    ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n              offset_reader->LastRecordOffset());\n    ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n    delete offset_reader;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                  int expected_record_offset) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         initial_offset);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n      ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n                record.size());\n      ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n                offset_reader->LastRecordOffset());\n      ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n      delete offset_reader;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadSecondOneOff) {\n  CheckInitialOffsetRecord(1, 1);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "441-443",
    "snippet": "TEST(LogTest, ReadStart) {\n  CheckInitialOffsetRecord(0, 0);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckInitialOffsetRecord",
          "args": [
            "0",
            "0"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "CheckInitialOffsetRecord",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "204-220",
          "snippet": "void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                int expected_record_offset) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       initial_offset);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n    ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n              record.size());\n    ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n              offset_reader->LastRecordOffset());\n    ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n    delete offset_reader;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                  int expected_record_offset) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         initial_offset);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n      ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n                record.size());\n      ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n                offset_reader->LastRecordOffset());\n      ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n      delete offset_reader;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadStart) {\n  CheckInitialOffsetRecord(0, 0);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "418-439",
    "snippet": "TEST(LogTest, ErrorJoinsRecords) {\n  // Consider two fragmented records:\n  //    first(R1) last(R1) first(R2) last(R2)\n  // where the middle two fragments disappear.  We do not want\n  // first(R1),last(R2) to get joined and returned as a valid record.\n\n  // Write records that span two blocks\n  Write(BigString(\"foo\", kBlockSize));\n  Write(BigString(\"bar\", kBlockSize));\n  Write(\"correct\");\n\n  // Wipe the middle block\n  for (int offset = kBlockSize; offset < 2*kBlockSize; offset++) {\n    SetByte(offset, 'x');\n  }\n\n  ASSERT_EQ(\"correct\", Read());\n  ASSERT_EQ(\"EOF\", Read());\n  const int dropped = DroppedBytes();\n  ASSERT_LE(dropped, 2*kBlockSize + 100);\n  ASSERT_GE(dropped, 2*kBlockSize);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_GE",
          "args": [
            "dropped",
            "2*kBlockSize"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "dropped",
            "2*kBlockSize + 100"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DroppedBytes",
          "args": [],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "DroppedBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "167-169",
          "snippet": "size_t DroppedBytes() const {\n    return report_.dropped_bytes_;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t DroppedBytes() const {\n      return report_.dropped_bytes_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"correct\"",
            "Read()"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetByte",
          "args": [
            "offset",
            "'x'"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "SetByte",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "148-150",
          "snippet": "void SetByte(int offset, char new_byte) {\n    dest_.contents_[offset] = new_byte;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void SetByte(int offset, char new_byte) {\n      dest_.contents_[offset] = new_byte;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "\"correct\""
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BigString",
          "args": [
            "\"bar\"",
            "kBlockSize"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "BigString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "18-25",
          "snippet": "static std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ErrorJoinsRecords) {\n  // Consider two fragmented records:\n  //    first(R1) last(R1) first(R2) last(R2)\n  // where the middle two fragments disappear.  We do not want\n  // first(R1),last(R2) to get joined and returned as a valid record.\n\n  // Write records that span two blocks\n  Write(BigString(\"foo\", kBlockSize));\n  Write(BigString(\"bar\", kBlockSize));\n  Write(\"correct\");\n\n  // Wipe the middle block\n  for (int offset = kBlockSize; offset < 2*kBlockSize; offset++) {\n    SetByte(offset, 'x');\n  }\n\n  ASSERT_EQ(\"correct\", Read());\n  ASSERT_EQ(\"EOF\", Read());\n  const int dropped = DroppedBytes();\n  ASSERT_LE(dropped, 2*kBlockSize + 100);\n  ASSERT_GE(dropped, 2*kBlockSize);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "407-416",
    "snippet": "TEST(LogTest, UnexpectedFirstType) {\n  Write(\"foo\");\n  Write(BigString(\"bar\", 100000));\n  SetByte(6, kFirstType);\n  FixChecksum(0, 3);\n  ASSERT_EQ(BigString(\"bar\", 100000), Read());\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(3, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"partial record without end\"));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"OK\"",
            "MatchError(\"partial record without end\")"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MatchError",
          "args": [
            "\"partial record without end\""
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "MatchError",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "176-182",
          "snippet": "std::string MatchError(const std::string& msg) const {\n    if (report_.message_.find(msg) == std::string::npos) {\n      return report_.message_;\n    } else {\n      return \"OK\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string MatchError(const std::string& msg) const {\n      if (report_.message_.find(msg) == std::string::npos) {\n        return report_.message_;\n      } else {\n        return \"OK\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "3",
            "DroppedBytes()"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DroppedBytes",
          "args": [],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "DroppedBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "167-169",
          "snippet": "size_t DroppedBytes() const {\n    return report_.dropped_bytes_;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t DroppedBytes() const {\n      return report_.dropped_bytes_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "BigString(\"bar\", 100000)",
            "Read()"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BigString",
          "args": [
            "\"bar\"",
            "100000"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "BigString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "18-25",
          "snippet": "static std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "FixChecksum",
          "args": [
            "0",
            "3"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "FixChecksum",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "156-161",
          "snippet": "void FixChecksum(int header_offset, int len) {\n    // Compute crc of type/len/data\n    uint32_t crc = crc32c::Value(&dest_.contents_[header_offset+6], 1 + len);\n    crc = crc32c::Mask(crc);\n    EncodeFixed32(&dest_.contents_[header_offset], crc);\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void FixChecksum(int header_offset, int len) {\n      // Compute crc of type/len/data\n      uint32_t crc = crc32c::Value(&dest_.contents_[header_offset+6], 1 + len);\n      crc = crc32c::Mask(crc);\n      EncodeFixed32(&dest_.contents_[header_offset], crc);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetByte",
          "args": [
            "6",
            "kFirstType"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "SetByte",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "148-150",
          "snippet": "void SetByte(int offset, char new_byte) {\n    dest_.contents_[offset] = new_byte;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void SetByte(int offset, char new_byte) {\n      dest_.contents_[offset] = new_byte;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "BigString(\"bar\", 100000)"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, UnexpectedFirstType) {\n  Write(\"foo\");\n  Write(BigString(\"bar\", 100000));\n  SetByte(6, kFirstType);\n  FixChecksum(0, 3);\n  ASSERT_EQ(BigString(\"bar\", 100000), Read());\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(3, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"partial record without end\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "396-405",
    "snippet": "TEST(LogTest, UnexpectedFullType) {\n  Write(\"foo\");\n  Write(\"bar\");\n  SetByte(6, kFirstType);\n  FixChecksum(0, 3);\n  ASSERT_EQ(\"bar\", Read());\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(3, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"partial record without end\"));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"OK\"",
            "MatchError(\"partial record without end\")"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MatchError",
          "args": [
            "\"partial record without end\""
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "MatchError",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "176-182",
          "snippet": "std::string MatchError(const std::string& msg) const {\n    if (report_.message_.find(msg) == std::string::npos) {\n      return report_.message_;\n    } else {\n      return \"OK\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string MatchError(const std::string& msg) const {\n      if (report_.message_.find(msg) == std::string::npos) {\n        return report_.message_;\n      } else {\n        return \"OK\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "3",
            "DroppedBytes()"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DroppedBytes",
          "args": [],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "DroppedBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "167-169",
          "snippet": "size_t DroppedBytes() const {\n    return report_.dropped_bytes_;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t DroppedBytes() const {\n      return report_.dropped_bytes_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Read()"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FixChecksum",
          "args": [
            "0",
            "3"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "FixChecksum",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "156-161",
          "snippet": "void FixChecksum(int header_offset, int len) {\n    // Compute crc of type/len/data\n    uint32_t crc = crc32c::Value(&dest_.contents_[header_offset+6], 1 + len);\n    crc = crc32c::Mask(crc);\n    EncodeFixed32(&dest_.contents_[header_offset], crc);\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void FixChecksum(int header_offset, int len) {\n      // Compute crc of type/len/data\n      uint32_t crc = crc32c::Value(&dest_.contents_[header_offset+6], 1 + len);\n      crc = crc32c::Mask(crc);\n      EncodeFixed32(&dest_.contents_[header_offset], crc);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetByte",
          "args": [
            "6",
            "kFirstType"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "SetByte",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "148-150",
          "snippet": "void SetByte(int offset, char new_byte) {\n    dest_.contents_[offset] = new_byte;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void SetByte(int offset, char new_byte) {\n      dest_.contents_[offset] = new_byte;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "\"bar\""
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, UnexpectedFullType) {\n  Write(\"foo\");\n  Write(\"bar\");\n  SetByte(6, kFirstType);\n  FixChecksum(0, 3);\n  ASSERT_EQ(\"bar\", Read());\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(3, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"partial record without end\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "387-394",
    "snippet": "TEST(LogTest, UnexpectedLastType) {\n  Write(\"foo\");\n  SetByte(6, kLastType);\n  FixChecksum(0, 3);\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(3, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"missing start\"));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"OK\"",
            "MatchError(\"missing start\")"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MatchError",
          "args": [
            "\"missing start\""
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "MatchError",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "176-182",
          "snippet": "std::string MatchError(const std::string& msg) const {\n    if (report_.message_.find(msg) == std::string::npos) {\n      return report_.message_;\n    } else {\n      return \"OK\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string MatchError(const std::string& msg) const {\n      if (report_.message_.find(msg) == std::string::npos) {\n        return report_.message_;\n      } else {\n        return \"OK\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "3",
            "DroppedBytes()"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DroppedBytes",
          "args": [],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "DroppedBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "167-169",
          "snippet": "size_t DroppedBytes() const {\n    return report_.dropped_bytes_;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t DroppedBytes() const {\n      return report_.dropped_bytes_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FixChecksum",
          "args": [
            "0",
            "3"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "FixChecksum",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "156-161",
          "snippet": "void FixChecksum(int header_offset, int len) {\n    // Compute crc of type/len/data\n    uint32_t crc = crc32c::Value(&dest_.contents_[header_offset+6], 1 + len);\n    crc = crc32c::Mask(crc);\n    EncodeFixed32(&dest_.contents_[header_offset], crc);\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void FixChecksum(int header_offset, int len) {\n      // Compute crc of type/len/data\n      uint32_t crc = crc32c::Value(&dest_.contents_[header_offset+6], 1 + len);\n      crc = crc32c::Mask(crc);\n      EncodeFixed32(&dest_.contents_[header_offset], crc);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetByte",
          "args": [
            "6",
            "kLastType"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "SetByte",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "148-150",
          "snippet": "void SetByte(int offset, char new_byte) {\n    dest_.contents_[offset] = new_byte;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void SetByte(int offset, char new_byte) {\n      dest_.contents_[offset] = new_byte;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "\"foo\""
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, UnexpectedLastType) {\n  Write(\"foo\");\n  SetByte(6, kLastType);\n  FixChecksum(0, 3);\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(3, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"missing start\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "378-385",
    "snippet": "TEST(LogTest, UnexpectedMiddleType) {\n  Write(\"foo\");\n  SetByte(6, kMiddleType);\n  FixChecksum(0, 3);\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(3, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"missing start\"));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"OK\"",
            "MatchError(\"missing start\")"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MatchError",
          "args": [
            "\"missing start\""
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "MatchError",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "176-182",
          "snippet": "std::string MatchError(const std::string& msg) const {\n    if (report_.message_.find(msg) == std::string::npos) {\n      return report_.message_;\n    } else {\n      return \"OK\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string MatchError(const std::string& msg) const {\n      if (report_.message_.find(msg) == std::string::npos) {\n        return report_.message_;\n      } else {\n        return \"OK\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "3",
            "DroppedBytes()"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DroppedBytes",
          "args": [],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "DroppedBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "167-169",
          "snippet": "size_t DroppedBytes() const {\n    return report_.dropped_bytes_;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t DroppedBytes() const {\n      return report_.dropped_bytes_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FixChecksum",
          "args": [
            "0",
            "3"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "FixChecksum",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "156-161",
          "snippet": "void FixChecksum(int header_offset, int len) {\n    // Compute crc of type/len/data\n    uint32_t crc = crc32c::Value(&dest_.contents_[header_offset+6], 1 + len);\n    crc = crc32c::Mask(crc);\n    EncodeFixed32(&dest_.contents_[header_offset], crc);\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void FixChecksum(int header_offset, int len) {\n      // Compute crc of type/len/data\n      uint32_t crc = crc32c::Value(&dest_.contents_[header_offset+6], 1 + len);\n      crc = crc32c::Mask(crc);\n      EncodeFixed32(&dest_.contents_[header_offset], crc);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetByte",
          "args": [
            "6",
            "kMiddleType"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "SetByte",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "148-150",
          "snippet": "void SetByte(int offset, char new_byte) {\n    dest_.contents_[offset] = new_byte;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void SetByte(int offset, char new_byte) {\n      dest_.contents_[offset] = new_byte;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "\"foo\""
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, UnexpectedMiddleType) {\n  Write(\"foo\");\n  SetByte(6, kMiddleType);\n  FixChecksum(0, 3);\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(3, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"missing start\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "370-376",
    "snippet": "TEST(LogTest, ChecksumMismatch) {\n  Write(\"foo\");\n  IncrementByte(0, 10);\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(10, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"checksum mismatch\"));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"OK\"",
            "MatchError(\"checksum mismatch\")"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MatchError",
          "args": [
            "\"checksum mismatch\""
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "MatchError",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "176-182",
          "snippet": "std::string MatchError(const std::string& msg) const {\n    if (report_.message_.find(msg) == std::string::npos) {\n      return report_.message_;\n    } else {\n      return \"OK\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string MatchError(const std::string& msg) const {\n      if (report_.message_.find(msg) == std::string::npos) {\n        return report_.message_;\n      } else {\n        return \"OK\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "10",
            "DroppedBytes()"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DroppedBytes",
          "args": [],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "DroppedBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "167-169",
          "snippet": "size_t DroppedBytes() const {\n    return report_.dropped_bytes_;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t DroppedBytes() const {\n      return report_.dropped_bytes_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IncrementByte",
          "args": [
            "0",
            "10"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "IncrementByte",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "144-146",
          "snippet": "void IncrementByte(int offset, int delta) {\n    dest_.contents_[offset] += delta;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void IncrementByte(int offset, int delta) {\n      dest_.contents_[offset] += delta;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "\"foo\""
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ChecksumMismatch) {\n  Write(\"foo\");\n  IncrementByte(0, 10);\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(10, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"checksum mismatch\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "362-368",
    "snippet": "TEST(LogTest, BadLength) {\n  Write(\"foo\");\n  ShrinkSize(1);\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(kHeaderSize + 2, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"bad record length\"));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"OK\"",
            "MatchError(\"bad record length\")"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MatchError",
          "args": [
            "\"bad record length\""
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "MatchError",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "176-182",
          "snippet": "std::string MatchError(const std::string& msg) const {\n    if (report_.message_.find(msg) == std::string::npos) {\n      return report_.message_;\n    } else {\n      return \"OK\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string MatchError(const std::string& msg) const {\n      if (report_.message_.find(msg) == std::string::npos) {\n        return report_.message_;\n      } else {\n        return \"OK\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "kHeaderSize + 2",
            "DroppedBytes()"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DroppedBytes",
          "args": [],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "DroppedBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "167-169",
          "snippet": "size_t DroppedBytes() const {\n    return report_.dropped_bytes_;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t DroppedBytes() const {\n      return report_.dropped_bytes_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ShrinkSize",
          "args": [
            "1"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "ShrinkSize",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "152-154",
          "snippet": "void ShrinkSize(int bytes) {\n    dest_.contents_.resize(dest_.contents_.size() - bytes);\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void ShrinkSize(int bytes) {\n      dest_.contents_.resize(dest_.contents_.size() - bytes);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "\"foo\""
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, BadLength) {\n  Write(\"foo\");\n  ShrinkSize(1);\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(kHeaderSize + 2, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"bad record length\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "354-360",
    "snippet": "TEST(LogTest, TruncatedTrailingRecord) {\n  Write(\"foo\");\n  ShrinkSize(4);   // Drop all payload as well as a header byte\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(kHeaderSize - 1, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"truncated record at end of file\"));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"OK\"",
            "MatchError(\"truncated record at end of file\")"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MatchError",
          "args": [
            "\"truncated record at end of file\""
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "MatchError",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "176-182",
          "snippet": "std::string MatchError(const std::string& msg) const {\n    if (report_.message_.find(msg) == std::string::npos) {\n      return report_.message_;\n    } else {\n      return \"OK\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string MatchError(const std::string& msg) const {\n      if (report_.message_.find(msg) == std::string::npos) {\n        return report_.message_;\n      } else {\n        return \"OK\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "kHeaderSize - 1",
            "DroppedBytes()"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DroppedBytes",
          "args": [],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "DroppedBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "167-169",
          "snippet": "size_t DroppedBytes() const {\n    return report_.dropped_bytes_;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t DroppedBytes() const {\n      return report_.dropped_bytes_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ShrinkSize",
          "args": [
            "4"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "ShrinkSize",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "152-154",
          "snippet": "void ShrinkSize(int bytes) {\n    dest_.contents_.resize(dest_.contents_.size() - bytes);\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void ShrinkSize(int bytes) {\n      dest_.contents_.resize(dest_.contents_.size() - bytes);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "\"foo\""
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, TruncatedTrailingRecord) {\n  Write(\"foo\");\n  ShrinkSize(4);   // Drop all payload as well as a header byte\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(kHeaderSize - 1, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"truncated record at end of file\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "344-352",
    "snippet": "TEST(LogTest, BadRecordType) {\n  Write(\"foo\");\n  // Type is stored in header[6]\n  IncrementByte(6, 100);\n  FixChecksum(0, 3);\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(3, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"unknown record type\"));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"OK\"",
            "MatchError(\"unknown record type\")"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MatchError",
          "args": [
            "\"unknown record type\""
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "MatchError",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "176-182",
          "snippet": "std::string MatchError(const std::string& msg) const {\n    if (report_.message_.find(msg) == std::string::npos) {\n      return report_.message_;\n    } else {\n      return \"OK\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string MatchError(const std::string& msg) const {\n      if (report_.message_.find(msg) == std::string::npos) {\n        return report_.message_;\n      } else {\n        return \"OK\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "3",
            "DroppedBytes()"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DroppedBytes",
          "args": [],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "DroppedBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "167-169",
          "snippet": "size_t DroppedBytes() const {\n    return report_.dropped_bytes_;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t DroppedBytes() const {\n      return report_.dropped_bytes_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FixChecksum",
          "args": [
            "0",
            "3"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "FixChecksum",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "156-161",
          "snippet": "void FixChecksum(int header_offset, int len) {\n    // Compute crc of type/len/data\n    uint32_t crc = crc32c::Value(&dest_.contents_[header_offset+6], 1 + len);\n    crc = crc32c::Mask(crc);\n    EncodeFixed32(&dest_.contents_[header_offset], crc);\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void FixChecksum(int header_offset, int len) {\n      // Compute crc of type/len/data\n      uint32_t crc = crc32c::Value(&dest_.contents_[header_offset+6], 1 + len);\n      crc = crc32c::Mask(crc);\n      EncodeFixed32(&dest_.contents_[header_offset], crc);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IncrementByte",
          "args": [
            "6",
            "100"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "IncrementByte",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "144-146",
          "snippet": "void IncrementByte(int offset, int delta) {\n    dest_.contents_[offset] += delta;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void IncrementByte(int offset, int delta) {\n      dest_.contents_[offset] += delta;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "\"foo\""
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, BadRecordType) {\n  Write(\"foo\");\n  // Type is stored in header[6]\n  IncrementByte(6, 100);\n  FixChecksum(0, 3);\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(3, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"unknown record type\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "336-342",
    "snippet": "TEST(LogTest, ReadError) {\n  Write(\"foo\");\n  ForceError();\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(kBlockSize, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"read error\"));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"OK\"",
            "MatchError(\"read error\")"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MatchError",
          "args": [
            "\"read error\""
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "MatchError",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "176-182",
          "snippet": "std::string MatchError(const std::string& msg) const {\n    if (report_.message_.find(msg) == std::string::npos) {\n      return report_.message_;\n    } else {\n      return \"OK\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string MatchError(const std::string& msg) const {\n      if (report_.message_.find(msg) == std::string::npos) {\n        return report_.message_;\n      } else {\n        return \"OK\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "kBlockSize",
            "DroppedBytes()"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DroppedBytes",
          "args": [],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "DroppedBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "167-169",
          "snippet": "size_t DroppedBytes() const {\n    return report_.dropped_bytes_;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t DroppedBytes() const {\n      return report_.dropped_bytes_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ForceError",
          "args": [],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "ForceError",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "163-165",
          "snippet": "void ForceError() {\n    source_.force_error_ = true;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void ForceError() {\n      source_.force_error_ = true;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "\"foo\""
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadError) {\n  Write(\"foo\");\n  ForceError();\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(kBlockSize, DroppedBytes());\n  ASSERT_EQ(\"OK\", MatchError(\"read error\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "321-332",
    "snippet": "TEST(LogTest, RandomRead) {\n  const int N = 500;\n  Random write_rnd(301);\n  for (int i = 0; i < N; i++) {\n    Write(RandomSkewedString(i, &write_rnd));\n  }\n  Random read_rnd(301);\n  for (int i = 0; i < N; i++) {\n    ASSERT_EQ(RandomSkewedString(i, &read_rnd), Read());\n  }\n  ASSERT_EQ(\"EOF\", Read());\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "RandomSkewedString(i, &read_rnd)",
            "Read()"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RandomSkewedString",
          "args": [
            "i",
            "&read_rnd"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "RandomSkewedString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "35-37",
          "snippet": "static std::string RandomSkewedString(int i, Random* rnd) {\n  return BigString(NumberString(i), rnd->Skewed(17));\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string RandomSkewedString(int i, Random* rnd) {\n  return BigString(NumberString(i), rnd->Skewed(17));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "RandomSkewedString(i, &write_rnd)"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, RandomRead) {\n  const int N = 500;\n  Random write_rnd(301);\n  for (int i = 0; i < N; i++) {\n    Write(RandomSkewedString(i, &write_rnd));\n  }\n  Random read_rnd(301);\n  for (int i = 0; i < N; i++) {\n    ASSERT_EQ(RandomSkewedString(i, &read_rnd), Read());\n  }\n  ASSERT_EQ(\"EOF\", Read());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "313-319",
    "snippet": "TEST(LogTest, AlignedEof) {\n  const int n = kBlockSize - 2*kHeaderSize + 4;\n  Write(BigString(\"foo\", n));\n  ASSERT_EQ(kBlockSize - kHeaderSize + 4, WrittenBytes());\n  ASSERT_EQ(BigString(\"foo\", n), Read());\n  ASSERT_EQ(\"EOF\", Read());\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "BigString(\"foo\", n)",
            "Read()"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BigString",
          "args": [
            "\"foo\"",
            "n"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "BigString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "18-25",
          "snippet": "static std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "kBlockSize - kHeaderSize + 4",
            "WrittenBytes()"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WrittenBytes",
          "args": [],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "WrittenBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "126-128",
          "snippet": "size_t WrittenBytes() const {\n    return dest_.contents_.size();\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t WrittenBytes() const {\n      return dest_.contents_.size();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "BigString(\"foo\", n)"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, AlignedEof) {\n  const int n = kBlockSize - 2*kHeaderSize + 4;\n  Write(BigString(\"foo\", n));\n  ASSERT_EQ(kBlockSize - kHeaderSize + 4, WrittenBytes());\n  ASSERT_EQ(BigString(\"foo\", n), Read());\n  ASSERT_EQ(\"EOF\", Read());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "301-311",
    "snippet": "TEST(LogTest, ShortTrailer) {\n  const int n = kBlockSize - 2*kHeaderSize + 4;\n  Write(BigString(\"foo\", n));\n  ASSERT_EQ(kBlockSize - kHeaderSize + 4, WrittenBytes());\n  Write(\"\");\n  Write(\"bar\");\n  ASSERT_EQ(BigString(\"foo\", n), Read());\n  ASSERT_EQ(\"\", Read());\n  ASSERT_EQ(\"bar\", Read());\n  ASSERT_EQ(\"EOF\", Read());\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Read()"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"\"",
            "Read()"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "BigString(\"foo\", n)",
            "Read()"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BigString",
          "args": [
            "\"foo\"",
            "n"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "BigString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "18-25",
          "snippet": "static std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "\"bar\""
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "kBlockSize - kHeaderSize + 4",
            "WrittenBytes()"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WrittenBytes",
          "args": [],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "WrittenBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "126-128",
          "snippet": "size_t WrittenBytes() const {\n    return dest_.contents_.size();\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t WrittenBytes() const {\n      return dest_.contents_.size();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ShortTrailer) {\n  const int n = kBlockSize - 2*kHeaderSize + 4;\n  Write(BigString(\"foo\", n));\n  ASSERT_EQ(kBlockSize - kHeaderSize + 4, WrittenBytes());\n  Write(\"\");\n  Write(\"bar\");\n  ASSERT_EQ(BigString(\"foo\", n), Read());\n  ASSERT_EQ(\"\", Read());\n  ASSERT_EQ(\"bar\", Read());\n  ASSERT_EQ(\"EOF\", Read());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "288-299",
    "snippet": "TEST(LogTest, MarginalTrailer2) {\n  // Make a trailer that is exactly the same length as an empty record.\n  const int n = kBlockSize - 2*kHeaderSize;\n  Write(BigString(\"foo\", n));\n  ASSERT_EQ(kBlockSize - kHeaderSize, WrittenBytes());\n  Write(\"bar\");\n  ASSERT_EQ(BigString(\"foo\", n), Read());\n  ASSERT_EQ(\"bar\", Read());\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(0, DroppedBytes());\n  ASSERT_EQ(\"\", ReportMessage());\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"\"",
            "ReportMessage()"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReportMessage",
          "args": [],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "ReportMessage",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "171-173",
          "snippet": "std::string ReportMessage() const {\n    return report_.message_;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string ReportMessage() const {\n      return report_.message_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "DroppedBytes()"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DroppedBytes",
          "args": [],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "DroppedBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "167-169",
          "snippet": "size_t DroppedBytes() const {\n    return report_.dropped_bytes_;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t DroppedBytes() const {\n      return report_.dropped_bytes_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Read()"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "BigString(\"foo\", n)",
            "Read()"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BigString",
          "args": [
            "\"foo\"",
            "n"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "BigString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "18-25",
          "snippet": "static std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "\"bar\""
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "kBlockSize - kHeaderSize",
            "WrittenBytes()"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WrittenBytes",
          "args": [],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "WrittenBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "126-128",
          "snippet": "size_t WrittenBytes() const {\n    return dest_.contents_.size();\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t WrittenBytes() const {\n      return dest_.contents_.size();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, MarginalTrailer2) {\n  // Make a trailer that is exactly the same length as an empty record.\n  const int n = kBlockSize - 2*kHeaderSize;\n  Write(BigString(\"foo\", n));\n  ASSERT_EQ(kBlockSize - kHeaderSize, WrittenBytes());\n  Write(\"bar\");\n  ASSERT_EQ(BigString(\"foo\", n), Read());\n  ASSERT_EQ(\"bar\", Read());\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(0, DroppedBytes());\n  ASSERT_EQ(\"\", ReportMessage());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "275-286",
    "snippet": "TEST(LogTest, MarginalTrailer) {\n  // Make a trailer that is exactly the same length as an empty record.\n  const int n = kBlockSize - 2*kHeaderSize;\n  Write(BigString(\"foo\", n));\n  ASSERT_EQ(kBlockSize - kHeaderSize, WrittenBytes());\n  Write(\"\");\n  Write(\"bar\");\n  ASSERT_EQ(BigString(\"foo\", n), Read());\n  ASSERT_EQ(\"\", Read());\n  ASSERT_EQ(\"bar\", Read());\n  ASSERT_EQ(\"EOF\", Read());\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Read()"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"\"",
            "Read()"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "BigString(\"foo\", n)",
            "Read()"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BigString",
          "args": [
            "\"foo\"",
            "n"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "BigString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "18-25",
          "snippet": "static std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "\"bar\""
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "kBlockSize - kHeaderSize",
            "WrittenBytes()"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WrittenBytes",
          "args": [],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "WrittenBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "126-128",
          "snippet": "size_t WrittenBytes() const {\n    return dest_.contents_.size();\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t WrittenBytes() const {\n      return dest_.contents_.size();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, MarginalTrailer) {\n  // Make a trailer that is exactly the same length as an empty record.\n  const int n = kBlockSize - 2*kHeaderSize;\n  Write(BigString(\"foo\", n));\n  ASSERT_EQ(kBlockSize - kHeaderSize, WrittenBytes());\n  Write(\"\");\n  Write(\"bar\");\n  ASSERT_EQ(BigString(\"foo\", n), Read());\n  ASSERT_EQ(\"\", Read());\n  ASSERT_EQ(\"bar\", Read());\n  ASSERT_EQ(\"EOF\", Read());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "265-273",
    "snippet": "TEST(LogTest, Fragmentation) {\n  Write(\"small\");\n  Write(BigString(\"medium\", 50000));\n  Write(BigString(\"large\", 100000));\n  ASSERT_EQ(\"small\", Read());\n  ASSERT_EQ(BigString(\"medium\", 50000), Read());\n  ASSERT_EQ(BigString(\"large\", 100000), Read());\n  ASSERT_EQ(\"EOF\", Read());\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "BigString(\"large\", 100000)",
            "Read()"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BigString",
          "args": [
            "\"large\"",
            "100000"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "BigString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "18-25",
          "snippet": "static std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "BigString(\"medium\", 50000)",
            "Read()"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"small\"",
            "Read()"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "BigString(\"large\", 100000)"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, Fragmentation) {\n  Write(\"small\");\n  Write(BigString(\"medium\", 50000));\n  Write(BigString(\"large\", 100000));\n  ASSERT_EQ(\"small\", Read());\n  ASSERT_EQ(BigString(\"medium\", 50000), Read());\n  ASSERT_EQ(BigString(\"large\", 100000), Read());\n  ASSERT_EQ(\"EOF\", Read());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "255-263",
    "snippet": "TEST(LogTest, ManyBlocks) {\n  for (int i = 0; i < 100000; i++) {\n    Write(NumberString(i));\n  }\n  for (int i = 0; i < 100000; i++) {\n    ASSERT_EQ(NumberString(i), Read());\n  }\n  ASSERT_EQ(\"EOF\", Read());\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumberString(i)",
            "Read()"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NumberString",
          "args": [
            "i"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "NumberString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "28-32",
          "snippet": "static std::string NumberString(int n) {\n  char buf[50];\n  snprintf(buf, sizeof(buf), \"%d.\", n);\n  return std::string(buf);\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string NumberString(int n) {\n  char buf[50];\n  snprintf(buf, sizeof(buf), \"%d.\", n);\n  return std::string(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "NumberString(i)"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ManyBlocks) {\n  for (int i = 0; i < 100000; i++) {\n    Write(NumberString(i));\n  }\n  for (int i = 0; i < 100000; i++) {\n    ASSERT_EQ(NumberString(i), Read());\n  }\n  ASSERT_EQ(\"EOF\", Read());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "242-253",
    "snippet": "TEST(LogTest, ReadWrite) {\n  Write(\"foo\");\n  Write(\"bar\");\n  Write(\"\");\n  Write(\"xxxx\");\n  ASSERT_EQ(\"foo\", Read());\n  ASSERT_EQ(\"bar\", Read());\n  ASSERT_EQ(\"\", Read());\n  ASSERT_EQ(\"xxxx\", Read());\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(\"EOF\", Read());  // Make sure reads at eof work\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"xxxx\"",
            "Read()"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"\"",
            "Read()"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Read()"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"foo\"",
            "Read()"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "\"xxxx\""
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, ReadWrite) {\n  Write(\"foo\");\n  Write(\"bar\");\n  Write(\"\");\n  Write(\"xxxx\");\n  ASSERT_EQ(\"foo\", Read());\n  ASSERT_EQ(\"bar\", Read());\n  ASSERT_EQ(\"\", Read());\n  ASSERT_EQ(\"xxxx\", Read());\n  ASSERT_EQ(\"EOF\", Read());\n  ASSERT_EQ(\"EOF\", Read());  // Make sure reads at eof work\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "238-240",
    "snippet": "TEST(LogTest, Empty) {\n  ASSERT_EQ(\"EOF\", Read());\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"EOF\"",
            "Read()"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Read",
          "args": [],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "130-142",
          "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nTEST(LogTest, Empty) {\n  ASSERT_EQ(\"EOF\", Read());\n}"
  },
  {
    "function_name": "CheckInitialOffsetRecord",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "204-220",
    "snippet": "void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                int expected_record_offset) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       initial_offset);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n    ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n              record.size());\n    ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n              offset_reader->LastRecordOffset());\n    ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n    delete offset_reader;\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "(char)('a' + expected_record_offset)",
            "record.data()[0]"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "record.data",
          "args": [],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "initial_offset_last_record_offsets_[expected_record_offset]",
            "offset_reader->LastRecordOffset()"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "offset_reader->LastRecordOffset",
          "args": [],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "LastRecordOffset",
          "container": "Reader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_reader.cc",
          "lines": "164-166",
          "snippet": "uint64_t Reader::LastRecordOffset() {\n  return last_record_offset_;\n}",
          "includes": [
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdio.h>",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include <stdio.h>\n#include \"db/log_reader.h\"\n\nReader {\n  uint64_t Reader::LastRecordOffset() {\n    return last_record_offset_;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "initial_offset_record_sizes_[expected_record_offset]",
            "record.size()"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "record.size",
          "args": [],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "offset_reader->ReadRecord(&record, &scratch)"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "offset_reader->ReadRecord",
          "args": [
            "&record",
            "&scratch"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "ReadRecord",
          "container": "Reader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_reader.cc",
          "lines": "59-162",
          "snippet": "bool Reader::ReadRecord(Slice* record, std::string* scratch) {\n  if (last_record_offset_ < initial_offset_) {\n    if (!SkipToInitialBlock()) {\n      return false;\n    }\n  }\n\n  scratch->clear();\n  record->clear();\n  bool in_fragmented_record = false;\n  // Record offset of the logical record that we're reading\n  // 0 is a dummy value to make compilers happy\n  uint64_t prospective_record_offset = 0;\n\n  Slice fragment;\n  while (true) {\n    uint64_t physical_record_offset = end_of_buffer_offset_ - buffer_.size();\n    const unsigned int record_type = ReadPhysicalRecord(&fragment);\n    switch (record_type) {\n      case kFullType:\n        if (in_fragmented_record) {\n          // Handle bug in earlier versions of log::Writer where\n          // it could emit an empty kFirstType record at the tail end\n          // of a block followed by a kFullType or kFirstType record\n          // at the beginning of the next block.\n          if (scratch->empty()) {\n            in_fragmented_record = false;\n          } else {\n            ReportCorruption(scratch->size(), \"partial record without end(1)\");\n          }\n        }\n        prospective_record_offset = physical_record_offset;\n        scratch->clear();\n        *record = fragment;\n        last_record_offset_ = prospective_record_offset;\n        return true;\n\n      case kFirstType:\n        if (in_fragmented_record) {\n          // Handle bug in earlier versions of log::Writer where\n          // it could emit an empty kFirstType record at the tail end\n          // of a block followed by a kFullType or kFirstType record\n          // at the beginning of the next block.\n          if (scratch->empty()) {\n            in_fragmented_record = false;\n          } else {\n            ReportCorruption(scratch->size(), \"partial record without end(2)\");\n          }\n        }\n        prospective_record_offset = physical_record_offset;\n        scratch->assign(fragment.data(), fragment.size());\n        in_fragmented_record = true;\n        break;\n\n      case kMiddleType:\n        if (!in_fragmented_record) {\n          ReportCorruption(fragment.size(),\n                           \"missing start of fragmented record(1)\");\n        } else {\n          scratch->append(fragment.data(), fragment.size());\n        }\n        break;\n\n      case kLastType:\n        if (!in_fragmented_record) {\n          ReportCorruption(fragment.size(),\n                           \"missing start of fragmented record(2)\");\n        } else {\n          scratch->append(fragment.data(), fragment.size());\n          *record = Slice(*scratch);\n          last_record_offset_ = prospective_record_offset;\n          return true;\n        }\n        break;\n\n      case kEof:\n        if (in_fragmented_record) {\n          ReportCorruption(scratch->size(), \"partial record without end(3)\");\n          scratch->clear();\n        }\n        return false;\n\n      case kBadRecord:\n        if (in_fragmented_record) {\n          ReportCorruption(scratch->size(), \"error in middle of record\");\n          in_fragmented_record = false;\n          scratch->clear();\n        }\n        break;\n\n      default: {\n        char buf[40];\n        snprintf(buf, sizeof(buf), \"unknown record type %u\", record_type);\n        ReportCorruption(\n            (fragment.size() + (in_fragmented_record ? scratch->size() : 0)),\n            buf);\n        in_fragmented_record = false;\n        scratch->clear();\n        break;\n      }\n    }\n  }\n  return false;\n}",
          "includes": [
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdio.h>",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include <stdio.h>\n#include \"db/log_reader.h\"\n\nReader {\n  bool Reader::ReadRecord(Slice* record, std::string* scratch) {\n    if (last_record_offset_ < initial_offset_) {\n      if (!SkipToInitialBlock()) {\n        return false;\n      }\n    }\n  \n    scratch->clear();\n    record->clear();\n    bool in_fragmented_record = false;\n    // Record offset of the logical record that we're reading\n    // 0 is a dummy value to make compilers happy\n    uint64_t prospective_record_offset = 0;\n  \n    Slice fragment;\n    while (true) {\n      uint64_t physical_record_offset = end_of_buffer_offset_ - buffer_.size();\n      const unsigned int record_type = ReadPhysicalRecord(&fragment);\n      switch (record_type) {\n        case kFullType:\n          if (in_fragmented_record) {\n            // Handle bug in earlier versions of log::Writer where\n            // it could emit an empty kFirstType record at the tail end\n            // of a block followed by a kFullType or kFirstType record\n            // at the beginning of the next block.\n            if (scratch->empty()) {\n              in_fragmented_record = false;\n            } else {\n              ReportCorruption(scratch->size(), \"partial record without end(1)\");\n            }\n          }\n          prospective_record_offset = physical_record_offset;\n          scratch->clear();\n          *record = fragment;\n          last_record_offset_ = prospective_record_offset;\n          return true;\n  \n        case kFirstType:\n          if (in_fragmented_record) {\n            // Handle bug in earlier versions of log::Writer where\n            // it could emit an empty kFirstType record at the tail end\n            // of a block followed by a kFullType or kFirstType record\n            // at the beginning of the next block.\n            if (scratch->empty()) {\n              in_fragmented_record = false;\n            } else {\n              ReportCorruption(scratch->size(), \"partial record without end(2)\");\n            }\n          }\n          prospective_record_offset = physical_record_offset;\n          scratch->assign(fragment.data(), fragment.size());\n          in_fragmented_record = true;\n          break;\n  \n        case kMiddleType:\n          if (!in_fragmented_record) {\n            ReportCorruption(fragment.size(),\n                             \"missing start of fragmented record(1)\");\n          } else {\n            scratch->append(fragment.data(), fragment.size());\n          }\n          break;\n  \n        case kLastType:\n          if (!in_fragmented_record) {\n            ReportCorruption(fragment.size(),\n                             \"missing start of fragmented record(2)\");\n          } else {\n            scratch->append(fragment.data(), fragment.size());\n            *record = Slice(*scratch);\n            last_record_offset_ = prospective_record_offset;\n            return true;\n          }\n          break;\n  \n        case kEof:\n          if (in_fragmented_record) {\n            ReportCorruption(scratch->size(), \"partial record without end(3)\");\n            scratch->clear();\n          }\n          return false;\n  \n        case kBadRecord:\n          if (in_fragmented_record) {\n            ReportCorruption(scratch->size(), \"error in middle of record\");\n            in_fragmented_record = false;\n            scratch->clear();\n          }\n          break;\n  \n        default: {\n          char buf[40];\n          snprintf(buf, sizeof(buf), \"unknown record type %u\", record_type);\n          ReportCorruption(\n              (fragment.size() + (in_fragmented_record ? scratch->size() : 0)),\n              buf);\n          in_fragmented_record = false;\n          scratch->clear();\n          break;\n        }\n      }\n    }\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "dest_.contents_"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/memtable.cc",
          "lines": "14-19",
          "snippet": "static Slice GetLengthPrefixedSlice(const char* data) {\n  uint32_t len;\n  const char* p = data;\n  p = GetVarint32Ptr(p, p + 5, &len);  // +5: we assume \"p\" is not corrupted\n  return Slice(p, len);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/memtable.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/comparator.h\"\n#include \"db/dbformat.h\"\n#include \"db/memtable.h\"\n\nstatic Slice GetLengthPrefixedSlice(const char* data) {\n  uint32_t len;\n  const char* p = data;\n  p = GetVarint32Ptr(p, p + 5, &len);  // +5: we assume \"p\" is not corrupted\n  return Slice(p, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WriteInitialOffsetLog",
          "args": [],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "WriteInitialOffsetLog",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "184-190",
          "snippet": "void WriteInitialOffsetLog() {\n    for (int i = 0; i < 4; i++) {\n      std::string record(initial_offset_record_sizes_[i],\n                         static_cast<char>('a' + i));\n      Write(record);\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void WriteInitialOffsetLog() {\n      for (int i = 0; i < 4; i++) {\n        std::string record(initial_offset_record_sizes_[i],\n                           static_cast<char>('a' + i));\n        Write(record);\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckInitialOffsetRecord(uint64_t initial_offset,\n                                  int expected_record_offset) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         initial_offset);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(offset_reader->ReadRecord(&record, &scratch));\n      ASSERT_EQ(initial_offset_record_sizes_[expected_record_offset],\n                record.size());\n      ASSERT_EQ(initial_offset_last_record_offsets_[expected_record_offset],\n                offset_reader->LastRecordOffset());\n      ASSERT_EQ((char)('a' + expected_record_offset), record.data()[0]);\n      delete offset_reader;\n    }\n}"
  },
  {
    "function_name": "CheckOffsetPastEndReturnsNoRecords",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "192-202",
    "snippet": "void CheckOffsetPastEndReturnsNoRecords(uint64_t offset_past_end) {\n    WriteInitialOffsetLog();\n    reading_ = true;\n    source_.contents_ = Slice(dest_.contents_);\n    Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                       WrittenBytes() + offset_past_end);\n    Slice record;\n    std::string scratch;\n    ASSERT_TRUE(!offset_reader->ReadRecord(&record, &scratch));\n    delete offset_reader;\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!offset_reader->ReadRecord(&record, &scratch)"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "offset_reader->ReadRecord",
          "args": [
            "&record",
            "&scratch"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "ReadRecord",
          "container": "Reader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_reader.cc",
          "lines": "59-162",
          "snippet": "bool Reader::ReadRecord(Slice* record, std::string* scratch) {\n  if (last_record_offset_ < initial_offset_) {\n    if (!SkipToInitialBlock()) {\n      return false;\n    }\n  }\n\n  scratch->clear();\n  record->clear();\n  bool in_fragmented_record = false;\n  // Record offset of the logical record that we're reading\n  // 0 is a dummy value to make compilers happy\n  uint64_t prospective_record_offset = 0;\n\n  Slice fragment;\n  while (true) {\n    uint64_t physical_record_offset = end_of_buffer_offset_ - buffer_.size();\n    const unsigned int record_type = ReadPhysicalRecord(&fragment);\n    switch (record_type) {\n      case kFullType:\n        if (in_fragmented_record) {\n          // Handle bug in earlier versions of log::Writer where\n          // it could emit an empty kFirstType record at the tail end\n          // of a block followed by a kFullType or kFirstType record\n          // at the beginning of the next block.\n          if (scratch->empty()) {\n            in_fragmented_record = false;\n          } else {\n            ReportCorruption(scratch->size(), \"partial record without end(1)\");\n          }\n        }\n        prospective_record_offset = physical_record_offset;\n        scratch->clear();\n        *record = fragment;\n        last_record_offset_ = prospective_record_offset;\n        return true;\n\n      case kFirstType:\n        if (in_fragmented_record) {\n          // Handle bug in earlier versions of log::Writer where\n          // it could emit an empty kFirstType record at the tail end\n          // of a block followed by a kFullType or kFirstType record\n          // at the beginning of the next block.\n          if (scratch->empty()) {\n            in_fragmented_record = false;\n          } else {\n            ReportCorruption(scratch->size(), \"partial record without end(2)\");\n          }\n        }\n        prospective_record_offset = physical_record_offset;\n        scratch->assign(fragment.data(), fragment.size());\n        in_fragmented_record = true;\n        break;\n\n      case kMiddleType:\n        if (!in_fragmented_record) {\n          ReportCorruption(fragment.size(),\n                           \"missing start of fragmented record(1)\");\n        } else {\n          scratch->append(fragment.data(), fragment.size());\n        }\n        break;\n\n      case kLastType:\n        if (!in_fragmented_record) {\n          ReportCorruption(fragment.size(),\n                           \"missing start of fragmented record(2)\");\n        } else {\n          scratch->append(fragment.data(), fragment.size());\n          *record = Slice(*scratch);\n          last_record_offset_ = prospective_record_offset;\n          return true;\n        }\n        break;\n\n      case kEof:\n        if (in_fragmented_record) {\n          ReportCorruption(scratch->size(), \"partial record without end(3)\");\n          scratch->clear();\n        }\n        return false;\n\n      case kBadRecord:\n        if (in_fragmented_record) {\n          ReportCorruption(scratch->size(), \"error in middle of record\");\n          in_fragmented_record = false;\n          scratch->clear();\n        }\n        break;\n\n      default: {\n        char buf[40];\n        snprintf(buf, sizeof(buf), \"unknown record type %u\", record_type);\n        ReportCorruption(\n            (fragment.size() + (in_fragmented_record ? scratch->size() : 0)),\n            buf);\n        in_fragmented_record = false;\n        scratch->clear();\n        break;\n      }\n    }\n  }\n  return false;\n}",
          "includes": [
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdio.h>",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include <stdio.h>\n#include \"db/log_reader.h\"\n\nReader {\n  bool Reader::ReadRecord(Slice* record, std::string* scratch) {\n    if (last_record_offset_ < initial_offset_) {\n      if (!SkipToInitialBlock()) {\n        return false;\n      }\n    }\n  \n    scratch->clear();\n    record->clear();\n    bool in_fragmented_record = false;\n    // Record offset of the logical record that we're reading\n    // 0 is a dummy value to make compilers happy\n    uint64_t prospective_record_offset = 0;\n  \n    Slice fragment;\n    while (true) {\n      uint64_t physical_record_offset = end_of_buffer_offset_ - buffer_.size();\n      const unsigned int record_type = ReadPhysicalRecord(&fragment);\n      switch (record_type) {\n        case kFullType:\n          if (in_fragmented_record) {\n            // Handle bug in earlier versions of log::Writer where\n            // it could emit an empty kFirstType record at the tail end\n            // of a block followed by a kFullType or kFirstType record\n            // at the beginning of the next block.\n            if (scratch->empty()) {\n              in_fragmented_record = false;\n            } else {\n              ReportCorruption(scratch->size(), \"partial record without end(1)\");\n            }\n          }\n          prospective_record_offset = physical_record_offset;\n          scratch->clear();\n          *record = fragment;\n          last_record_offset_ = prospective_record_offset;\n          return true;\n  \n        case kFirstType:\n          if (in_fragmented_record) {\n            // Handle bug in earlier versions of log::Writer where\n            // it could emit an empty kFirstType record at the tail end\n            // of a block followed by a kFullType or kFirstType record\n            // at the beginning of the next block.\n            if (scratch->empty()) {\n              in_fragmented_record = false;\n            } else {\n              ReportCorruption(scratch->size(), \"partial record without end(2)\");\n            }\n          }\n          prospective_record_offset = physical_record_offset;\n          scratch->assign(fragment.data(), fragment.size());\n          in_fragmented_record = true;\n          break;\n  \n        case kMiddleType:\n          if (!in_fragmented_record) {\n            ReportCorruption(fragment.size(),\n                             \"missing start of fragmented record(1)\");\n          } else {\n            scratch->append(fragment.data(), fragment.size());\n          }\n          break;\n  \n        case kLastType:\n          if (!in_fragmented_record) {\n            ReportCorruption(fragment.size(),\n                             \"missing start of fragmented record(2)\");\n          } else {\n            scratch->append(fragment.data(), fragment.size());\n            *record = Slice(*scratch);\n            last_record_offset_ = prospective_record_offset;\n            return true;\n          }\n          break;\n  \n        case kEof:\n          if (in_fragmented_record) {\n            ReportCorruption(scratch->size(), \"partial record without end(3)\");\n            scratch->clear();\n          }\n          return false;\n  \n        case kBadRecord:\n          if (in_fragmented_record) {\n            ReportCorruption(scratch->size(), \"error in middle of record\");\n            in_fragmented_record = false;\n            scratch->clear();\n          }\n          break;\n  \n        default: {\n          char buf[40];\n          snprintf(buf, sizeof(buf), \"unknown record type %u\", record_type);\n          ReportCorruption(\n              (fragment.size() + (in_fragmented_record ? scratch->size() : 0)),\n              buf);\n          in_fragmented_record = false;\n          scratch->clear();\n          break;\n        }\n      }\n    }\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WrittenBytes",
          "args": [],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "WrittenBytes",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "126-128",
          "snippet": "size_t WrittenBytes() const {\n    return dest_.contents_.size();\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t WrittenBytes() const {\n      return dest_.contents_.size();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "dest_.contents_"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/memtable.cc",
          "lines": "14-19",
          "snippet": "static Slice GetLengthPrefixedSlice(const char* data) {\n  uint32_t len;\n  const char* p = data;\n  p = GetVarint32Ptr(p, p + 5, &len);  // +5: we assume \"p\" is not corrupted\n  return Slice(p, len);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/memtable.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/comparator.h\"\n#include \"db/dbformat.h\"\n#include \"db/memtable.h\"\n\nstatic Slice GetLengthPrefixedSlice(const char* data) {\n  uint32_t len;\n  const char* p = data;\n  p = GetVarint32Ptr(p, p + 5, &len);  // +5: we assume \"p\" is not corrupted\n  return Slice(p, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WriteInitialOffsetLog",
          "args": [],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "WriteInitialOffsetLog",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "184-190",
          "snippet": "void WriteInitialOffsetLog() {\n    for (int i = 0; i < 4; i++) {\n      std::string record(initial_offset_record_sizes_[i],\n                         static_cast<char>('a' + i));\n      Write(record);\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void WriteInitialOffsetLog() {\n      for (int i = 0; i < 4; i++) {\n        std::string record(initial_offset_record_sizes_[i],\n                           static_cast<char>('a' + i));\n        Write(record);\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void CheckOffsetPastEndReturnsNoRecords(uint64_t offset_past_end) {\n      WriteInitialOffsetLog();\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n      Reader* offset_reader = new Reader(&source_, &report_, true/*checksum*/,\n                                         WrittenBytes() + offset_past_end);\n      Slice record;\n      std::string scratch;\n      ASSERT_TRUE(!offset_reader->ReadRecord(&record, &scratch));\n      delete offset_reader;\n    }\n}"
  },
  {
    "function_name": "WriteInitialOffsetLog",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "184-190",
    "snippet": "void WriteInitialOffsetLog() {\n    for (int i = 0; i < 4; i++) {\n      std::string record(initial_offset_record_sizes_[i],\n                         static_cast<char>('a' + i));\n      Write(record);\n    }\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "record"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "LogTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "121-124",
          "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<char>",
          "args": [
            "'a' + i"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void WriteInitialOffsetLog() {\n      for (int i = 0; i < 4; i++) {\n        std::string record(initial_offset_record_sizes_[i],\n                           static_cast<char>('a' + i));\n        Write(record);\n      }\n    }\n}"
  },
  {
    "function_name": "MatchError",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "176-182",
    "snippet": "std::string MatchError(const std::string& msg) const {\n    if (report_.message_.find(msg) == std::string::npos) {\n      return report_.message_;\n    } else {\n      return \"OK\";\n    }\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "report_.message_.find",
          "args": [
            "msg"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string MatchError(const std::string& msg) const {\n      if (report_.message_.find(msg) == std::string::npos) {\n        return report_.message_;\n      } else {\n        return \"OK\";\n      }\n    }\n}"
  },
  {
    "function_name": "ReportMessage",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "171-173",
    "snippet": "std::string ReportMessage() const {\n    return report_.message_;\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string ReportMessage() const {\n      return report_.message_;\n    }\n}"
  },
  {
    "function_name": "DroppedBytes",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "167-169",
    "snippet": "size_t DroppedBytes() const {\n    return report_.dropped_bytes_;\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t DroppedBytes() const {\n      return report_.dropped_bytes_;\n    }\n}"
  },
  {
    "function_name": "ForceError",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "163-165",
    "snippet": "void ForceError() {\n    source_.force_error_ = true;\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void ForceError() {\n      source_.force_error_ = true;\n    }\n}"
  },
  {
    "function_name": "FixChecksum",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "156-161",
    "snippet": "void FixChecksum(int header_offset, int len) {\n    // Compute crc of type/len/data\n    uint32_t crc = crc32c::Value(&dest_.contents_[header_offset+6], 1 + len);\n    crc = crc32c::Mask(crc);\n    EncodeFixed32(&dest_.contents_[header_offset], crc);\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EncodeFixed32",
          "args": [
            "&dest_.contents_[header_offset]",
            "crc"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeFixed32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "9-18",
          "snippet": "void EncodeFixed32(char* buf, uint32_t value) {\n  if (port::kLittleEndian) {\n    memcpy(buf, &value, sizeof(value));\n  } else {\n    buf[0] = value & 0xff;\n    buf[1] = (value >> 8) & 0xff;\n    buf[2] = (value >> 16) & 0xff;\n    buf[3] = (value >> 24) & 0xff;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid EncodeFixed32(char* buf, uint32_t value) {\n  if (port::kLittleEndian) {\n    memcpy(buf, &value, sizeof(value));\n  } else {\n    buf[0] = value & 0xff;\n    buf[1] = (value >> 8) & 0xff;\n    buf[2] = (value >> 16) & 0xff;\n    buf[3] = (value >> 24) & 0xff;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "crc32c::Mask",
          "args": [
            "crc"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "Mask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/crc32c.h",
          "lines": "31-34",
          "snippet": "inline uint32_t Mask(uint32_t crc) {\n  // Rotate right by 15 bits and add a constant.\n  return ((crc >> 15) | (crc << 17)) + kMaskDelta;\n}",
          "includes": [
            "#include <stdint.h>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <stddef.h>\n\ninline uint32_t Mask(uint32_t crc) {\n  // Rotate right by 15 bits and add a constant.\n  return ((crc >> 15) | (crc << 17)) + kMaskDelta;\n}"
        }
      },
      {
        "call_info": {
          "callee": "crc32c::Value",
          "args": [
            "&dest_.contents_[header_offset+6]",
            "1 + len"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "Value",
          "container": "CorruptionTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/corruption_test.cc",
          "lines": "196-199",
          "snippet": "Slice Value(int k, std::string* storage) {\n    Random r(k);\n    return test::RandomString(&r, kValueSize, storage);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/log_format.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n#include \"db/log_format.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/write_batch.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <errno.h>\n#include \"leveldb/db.h\"\n\nCorruptionTest {\n  Slice Value(int k, std::string* storage) {\n      Random r(k);\n      return test::RandomString(&r, kValueSize, storage);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void FixChecksum(int header_offset, int len) {\n      // Compute crc of type/len/data\n      uint32_t crc = crc32c::Value(&dest_.contents_[header_offset+6], 1 + len);\n      crc = crc32c::Mask(crc);\n      EncodeFixed32(&dest_.contents_[header_offset], crc);\n    }\n}"
  },
  {
    "function_name": "ShrinkSize",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "152-154",
    "snippet": "void ShrinkSize(int bytes) {\n    dest_.contents_.resize(dest_.contents_.size() - bytes);\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dest_.contents_.resize",
          "args": [
            "dest_.contents_.size() - bytes"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dest_.contents_.size",
          "args": [],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void ShrinkSize(int bytes) {\n      dest_.contents_.resize(dest_.contents_.size() - bytes);\n    }\n}"
  },
  {
    "function_name": "SetByte",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "148-150",
    "snippet": "void SetByte(int offset, char new_byte) {\n    dest_.contents_[offset] = new_byte;\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void SetByte(int offset, char new_byte) {\n      dest_.contents_[offset] = new_byte;\n    }\n}"
  },
  {
    "function_name": "IncrementByte",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "144-146",
    "snippet": "void IncrementByte(int offset, int delta) {\n    dest_.contents_[offset] += delta;\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void IncrementByte(int offset, int delta) {\n      dest_.contents_[offset] += delta;\n    }\n}"
  },
  {
    "function_name": "Read",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "130-142",
    "snippet": "std::string Read() {\n    if (!reading_) {\n      reading_ = true;\n      source_.contents_ = Slice(dest_.contents_);\n    }\n    std::string scratch;\n    Slice record;\n    if (reader_.ReadRecord(&record, &scratch)) {\n      return record.ToString();\n    } else {\n      return \"EOF\";\n    }\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "record.ToString",
          "args": [],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reader_.ReadRecord",
          "args": [
            "&record",
            "&scratch"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "ReadRecord",
          "container": "Reader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_reader.cc",
          "lines": "59-162",
          "snippet": "bool Reader::ReadRecord(Slice* record, std::string* scratch) {\n  if (last_record_offset_ < initial_offset_) {\n    if (!SkipToInitialBlock()) {\n      return false;\n    }\n  }\n\n  scratch->clear();\n  record->clear();\n  bool in_fragmented_record = false;\n  // Record offset of the logical record that we're reading\n  // 0 is a dummy value to make compilers happy\n  uint64_t prospective_record_offset = 0;\n\n  Slice fragment;\n  while (true) {\n    uint64_t physical_record_offset = end_of_buffer_offset_ - buffer_.size();\n    const unsigned int record_type = ReadPhysicalRecord(&fragment);\n    switch (record_type) {\n      case kFullType:\n        if (in_fragmented_record) {\n          // Handle bug in earlier versions of log::Writer where\n          // it could emit an empty kFirstType record at the tail end\n          // of a block followed by a kFullType or kFirstType record\n          // at the beginning of the next block.\n          if (scratch->empty()) {\n            in_fragmented_record = false;\n          } else {\n            ReportCorruption(scratch->size(), \"partial record without end(1)\");\n          }\n        }\n        prospective_record_offset = physical_record_offset;\n        scratch->clear();\n        *record = fragment;\n        last_record_offset_ = prospective_record_offset;\n        return true;\n\n      case kFirstType:\n        if (in_fragmented_record) {\n          // Handle bug in earlier versions of log::Writer where\n          // it could emit an empty kFirstType record at the tail end\n          // of a block followed by a kFullType or kFirstType record\n          // at the beginning of the next block.\n          if (scratch->empty()) {\n            in_fragmented_record = false;\n          } else {\n            ReportCorruption(scratch->size(), \"partial record without end(2)\");\n          }\n        }\n        prospective_record_offset = physical_record_offset;\n        scratch->assign(fragment.data(), fragment.size());\n        in_fragmented_record = true;\n        break;\n\n      case kMiddleType:\n        if (!in_fragmented_record) {\n          ReportCorruption(fragment.size(),\n                           \"missing start of fragmented record(1)\");\n        } else {\n          scratch->append(fragment.data(), fragment.size());\n        }\n        break;\n\n      case kLastType:\n        if (!in_fragmented_record) {\n          ReportCorruption(fragment.size(),\n                           \"missing start of fragmented record(2)\");\n        } else {\n          scratch->append(fragment.data(), fragment.size());\n          *record = Slice(*scratch);\n          last_record_offset_ = prospective_record_offset;\n          return true;\n        }\n        break;\n\n      case kEof:\n        if (in_fragmented_record) {\n          ReportCorruption(scratch->size(), \"partial record without end(3)\");\n          scratch->clear();\n        }\n        return false;\n\n      case kBadRecord:\n        if (in_fragmented_record) {\n          ReportCorruption(scratch->size(), \"error in middle of record\");\n          in_fragmented_record = false;\n          scratch->clear();\n        }\n        break;\n\n      default: {\n        char buf[40];\n        snprintf(buf, sizeof(buf), \"unknown record type %u\", record_type);\n        ReportCorruption(\n            (fragment.size() + (in_fragmented_record ? scratch->size() : 0)),\n            buf);\n        in_fragmented_record = false;\n        scratch->clear();\n        break;\n      }\n    }\n  }\n  return false;\n}",
          "includes": [
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdio.h>",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include <stdio.h>\n#include \"db/log_reader.h\"\n\nReader {\n  bool Reader::ReadRecord(Slice* record, std::string* scratch) {\n    if (last_record_offset_ < initial_offset_) {\n      if (!SkipToInitialBlock()) {\n        return false;\n      }\n    }\n  \n    scratch->clear();\n    record->clear();\n    bool in_fragmented_record = false;\n    // Record offset of the logical record that we're reading\n    // 0 is a dummy value to make compilers happy\n    uint64_t prospective_record_offset = 0;\n  \n    Slice fragment;\n    while (true) {\n      uint64_t physical_record_offset = end_of_buffer_offset_ - buffer_.size();\n      const unsigned int record_type = ReadPhysicalRecord(&fragment);\n      switch (record_type) {\n        case kFullType:\n          if (in_fragmented_record) {\n            // Handle bug in earlier versions of log::Writer where\n            // it could emit an empty kFirstType record at the tail end\n            // of a block followed by a kFullType or kFirstType record\n            // at the beginning of the next block.\n            if (scratch->empty()) {\n              in_fragmented_record = false;\n            } else {\n              ReportCorruption(scratch->size(), \"partial record without end(1)\");\n            }\n          }\n          prospective_record_offset = physical_record_offset;\n          scratch->clear();\n          *record = fragment;\n          last_record_offset_ = prospective_record_offset;\n          return true;\n  \n        case kFirstType:\n          if (in_fragmented_record) {\n            // Handle bug in earlier versions of log::Writer where\n            // it could emit an empty kFirstType record at the tail end\n            // of a block followed by a kFullType or kFirstType record\n            // at the beginning of the next block.\n            if (scratch->empty()) {\n              in_fragmented_record = false;\n            } else {\n              ReportCorruption(scratch->size(), \"partial record without end(2)\");\n            }\n          }\n          prospective_record_offset = physical_record_offset;\n          scratch->assign(fragment.data(), fragment.size());\n          in_fragmented_record = true;\n          break;\n  \n        case kMiddleType:\n          if (!in_fragmented_record) {\n            ReportCorruption(fragment.size(),\n                             \"missing start of fragmented record(1)\");\n          } else {\n            scratch->append(fragment.data(), fragment.size());\n          }\n          break;\n  \n        case kLastType:\n          if (!in_fragmented_record) {\n            ReportCorruption(fragment.size(),\n                             \"missing start of fragmented record(2)\");\n          } else {\n            scratch->append(fragment.data(), fragment.size());\n            *record = Slice(*scratch);\n            last_record_offset_ = prospective_record_offset;\n            return true;\n          }\n          break;\n  \n        case kEof:\n          if (in_fragmented_record) {\n            ReportCorruption(scratch->size(), \"partial record without end(3)\");\n            scratch->clear();\n          }\n          return false;\n  \n        case kBadRecord:\n          if (in_fragmented_record) {\n            ReportCorruption(scratch->size(), \"error in middle of record\");\n            in_fragmented_record = false;\n            scratch->clear();\n          }\n          break;\n  \n        default: {\n          char buf[40];\n          snprintf(buf, sizeof(buf), \"unknown record type %u\", record_type);\n          ReportCorruption(\n              (fragment.size() + (in_fragmented_record ? scratch->size() : 0)),\n              buf);\n          in_fragmented_record = false;\n          scratch->clear();\n          break;\n        }\n      }\n    }\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "dest_.contents_"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/memtable.cc",
          "lines": "14-19",
          "snippet": "static Slice GetLengthPrefixedSlice(const char* data) {\n  uint32_t len;\n  const char* p = data;\n  p = GetVarint32Ptr(p, p + 5, &len);  // +5: we assume \"p\" is not corrupted\n  return Slice(p, len);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/memtable.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/comparator.h\"\n#include \"db/dbformat.h\"\n#include \"db/memtable.h\"\n\nstatic Slice GetLengthPrefixedSlice(const char* data) {\n  uint32_t len;\n  const char* p = data;\n  p = GetVarint32Ptr(p, p + 5, &len);  // +5: we assume \"p\" is not corrupted\n  return Slice(p, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  std::string Read() {\n      if (!reading_) {\n        reading_ = true;\n        source_.contents_ = Slice(dest_.contents_);\n      }\n      std::string scratch;\n      Slice record;\n      if (reader_.ReadRecord(&record, &scratch)) {\n        return record.ToString();\n      } else {\n        return \"EOF\";\n      }\n    }\n}"
  },
  {
    "function_name": "WrittenBytes",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "126-128",
    "snippet": "size_t WrittenBytes() const {\n    return dest_.contents_.size();\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dest_.contents_.size",
          "args": [],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  size_t WrittenBytes() const {\n      return dest_.contents_.size();\n    }\n}"
  },
  {
    "function_name": "Write",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "121-124",
    "snippet": "void Write(const std::string& msg) {\n    ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n    writer_.AddRecord(Slice(msg));\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "writer_.AddRecord",
          "args": [
            "Slice(msg)"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "AddRecord",
          "container": "Writer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_writer.cc",
          "lines": "27-73",
          "snippet": "Status Writer::AddRecord(const Slice& slice) {\n  const char* ptr = slice.data();\n  size_t left = slice.size();\n\n  // Fragment the record if necessary and emit it.  Note that if slice\n  // is empty, we still want to iterate once to emit a single\n  // zero-length record\n  Status s;\n  bool begin = true;\n  do {\n    const int leftover = kBlockSize - block_offset_;\n    assert(leftover >= 0);\n    if (leftover < kHeaderSize) {\n      // Switch to a new block\n      if (leftover > 0) {\n        // Fill the trailer (literal below relies on kHeaderSize being 7)\n        assert(kHeaderSize == 7);\n        dest_->Append(Slice(\"\\x00\\x00\\x00\\x00\\x00\\x00\", leftover));\n      }\n      block_offset_ = 0;\n    }\n\n    // Invariant: we never leave < kHeaderSize bytes in a block.\n    assert(kBlockSize - block_offset_ - kHeaderSize >= 0);\n\n    const size_t avail = kBlockSize - block_offset_ - kHeaderSize;\n    const size_t fragment_length = (left < avail) ? left : avail;\n\n    RecordType type;\n    const bool end = (left == fragment_length);\n    if (begin && end) {\n      type = kFullType;\n    } else if (begin) {\n      type = kFirstType;\n    } else if (end) {\n      type = kLastType;\n    } else {\n      type = kMiddleType;\n    }\n\n    s = EmitPhysicalRecord(type, ptr, fragment_length);\n    ptr += fragment_length;\n    left -= fragment_length;\n    begin = false;\n  } while (s.ok() && left > 0);\n  return s;\n}",
          "includes": [
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdint.h>",
            "#include \"db/log_writer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include <stdint.h>\n#include \"db/log_writer.h\"\n\nWriter {\n  Status Writer::AddRecord(const Slice& slice) {\n    const char* ptr = slice.data();\n    size_t left = slice.size();\n  \n    // Fragment the record if necessary and emit it.  Note that if slice\n    // is empty, we still want to iterate once to emit a single\n    // zero-length record\n    Status s;\n    bool begin = true;\n    do {\n      const int leftover = kBlockSize - block_offset_;\n      assert(leftover >= 0);\n      if (leftover < kHeaderSize) {\n        // Switch to a new block\n        if (leftover > 0) {\n          // Fill the trailer (literal below relies on kHeaderSize being 7)\n          assert(kHeaderSize == 7);\n          dest_->Append(Slice(\"\\x00\\x00\\x00\\x00\\x00\\x00\", leftover));\n        }\n        block_offset_ = 0;\n      }\n  \n      // Invariant: we never leave < kHeaderSize bytes in a block.\n      assert(kBlockSize - block_offset_ - kHeaderSize >= 0);\n  \n      const size_t avail = kBlockSize - block_offset_ - kHeaderSize;\n      const size_t fragment_length = (left < avail) ? left : avail;\n  \n      RecordType type;\n      const bool end = (left == fragment_length);\n      if (begin && end) {\n        type = kFullType;\n      } else if (begin) {\n        type = kFirstType;\n      } else if (end) {\n        type = kLastType;\n      } else {\n        type = kMiddleType;\n      }\n  \n      s = EmitPhysicalRecord(type, ptr, fragment_length);\n      ptr += fragment_length;\n      left -= fragment_length;\n      begin = false;\n    } while (s.ok() && left > 0);\n    return s;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "msg"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/memtable.cc",
          "lines": "14-19",
          "snippet": "static Slice GetLengthPrefixedSlice(const char* data) {\n  uint32_t len;\n  const char* p = data;\n  p = GetVarint32Ptr(p, p + 5, &len);  // +5: we assume \"p\" is not corrupted\n  return Slice(p, len);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/memtable.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/comparator.h\"\n#include \"db/dbformat.h\"\n#include \"db/memtable.h\"\n\nstatic Slice GetLengthPrefixedSlice(const char* data) {\n  uint32_t len;\n  const char* p = data;\n  p = GetVarint32Ptr(p, p + 5, &len);  // +5: we assume \"p\" is not corrupted\n  return Slice(p, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!reading_"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  void Write(const std::string& msg) {\n      ASSERT_TRUE(!reading_) << \"Write() after starting to read\";\n      writer_.AddRecord(Slice(msg));\n    }\n}"
  },
  {
    "function_name": "LogTest",
    "container": "LogTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "115-119",
    "snippet": "LogTest() : reading_(false),\n              writer_(&dest_),\n              reader_(&source_, &report_, true/*checksum*/,\n                      0/*initial_offset*/) {\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  LogTest() : reading_(false),\n                writer_(&dest_),\n                reader_(&source_, &report_, true/*checksum*/,\n                        0/*initial_offset*/) {\n    }\n}"
  },
  {
    "function_name": "Corruption",
    "container": "LogTest::ReportCollector",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "97-100",
    "snippet": "virtual void Corruption(size_t bytes, const Status& status) {\n      dropped_bytes_ += bytes;\n      message_.append(status.ToString());\n    }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "message_.append",
          "args": [
            "status.ToString()"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "status.ToString",
          "args": [],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  ReportCollector {\n    virtual void Corruption(size_t bytes, const Status& status) {\n          dropped_bytes_ += bytes;\n          message_.append(status.ToString());\n        }\n  }\n}"
  },
  {
    "function_name": "ReportCollector",
    "container": "LogTest::ReportCollector",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "96-96",
    "snippet": "ReportCollector() : dropped_bytes_(0) { }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  ReportCollector {\n    ReportCollector() : dropped_bytes_(0) { }\n  }\n}"
  },
  {
    "function_name": "Skip",
    "container": "LogTest::StringSource",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "79-88",
    "snippet": "virtual Status Skip(uint64_t n) {\n      if (n > contents_.size()) {\n        contents_.clear();\n        return Status::NotFound(\"in-memory file skipepd past end\");\n      }\n\n      contents_.remove_prefix(n);\n\n      return Status::OK();\n    }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "contents_.remove_prefix",
          "args": [
            "n"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "remove_prefix",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "59-63",
          "snippet": "void remove_prefix(size_t n) {\n    assert(n <= size());\n    data_ += n;\n    size_ -= n;\n  }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  void remove_prefix(size_t n) {\n      assert(n <= size());\n      data_ += n;\n      size_ -= n;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Status::NotFound",
          "args": [
            "\"in-memory file skipepd past end\""
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "NotFound",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "35-37",
          "snippet": "static Status NotFound(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kNotFound, msg, msg2);\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status NotFound(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kNotFound, msg, msg2);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "contents_.clear",
          "args": [],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "contents_.size",
          "args": [],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  StringSource {\n    virtual Status Skip(uint64_t n) {\n          if (n > contents_.size()) {\n            contents_.clear();\n            return Status::NotFound(\"in-memory file skipepd past end\");\n          }\n    \n          contents_.remove_prefix(n);\n    \n          return Status::OK();\n        }\n  }\n}"
  },
  {
    "function_name": "Read",
    "container": "LogTest::StringSource",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "61-77",
    "snippet": "virtual Status Read(size_t n, Slice* result, char* scratch) {\n      ASSERT_TRUE(!returned_partial_) << \"must not Read() after eof/error\";\n\n      if (force_error_) {\n        force_error_ = false;\n        returned_partial_ = true;\n        return Status::Corruption(\"read error\");\n      }\n\n      if (contents_.size() < n) {\n        n = contents_.size();\n        returned_partial_ = true;\n      }\n      *result = Slice(contents_.data(), n);\n      contents_.remove_prefix(n);\n      return Status::OK();\n    }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "contents_.remove_prefix",
          "args": [
            "n"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "remove_prefix",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "59-63",
          "snippet": "void remove_prefix(size_t n) {\n    assert(n <= size());\n    data_ += n;\n    size_ -= n;\n  }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  void remove_prefix(size_t n) {\n      assert(n <= size());\n      data_ += n;\n      size_ -= n;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "contents_.data()",
            "n"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "contents_.data",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contents_.size",
          "args": [],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Status::Corruption",
          "args": [
            "\"read error\""
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "Corruption",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "38-40",
          "snippet": "static Status Corruption(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kCorruption, msg, msg2);\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status Corruption(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kCorruption, msg, msg2);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!returned_partial_"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  StringSource {\n    virtual Status Read(size_t n, Slice* result, char* scratch) {\n          ASSERT_TRUE(!returned_partial_) << \"must not Read() after eof/error\";\n    \n          if (force_error_) {\n            force_error_ = false;\n            returned_partial_ = true;\n            return Status::Corruption(\"read error\");\n          }\n    \n          if (contents_.size() < n) {\n            n = contents_.size();\n            returned_partial_ = true;\n          }\n          *result = Slice(contents_.data(), n);\n          contents_.remove_prefix(n);\n          return Status::OK();\n        }\n  }\n}"
  },
  {
    "function_name": "StringSource",
    "container": "LogTest::StringSource",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "59-59",
    "snippet": "StringSource() : force_error_(false), returned_partial_(false) { }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  StringSource {\n    StringSource() : force_error_(false), returned_partial_(false) { }\n  }\n}"
  },
  {
    "function_name": "Append",
    "container": "LogTest::StringDest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "48-51",
    "snippet": "virtual Status Append(const Slice& slice) {\n      contents_.append(slice.data(), slice.size());\n      return Status::OK();\n    }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "contents_.append",
          "args": [
            "slice.data()",
            "slice.size()"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slice.size",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "slice.data",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  StringDest {\n    virtual Status Append(const Slice& slice) {\n          contents_.append(slice.data(), slice.size());\n          return Status::OK();\n        }\n  }\n}"
  },
  {
    "function_name": "Sync",
    "container": "LogTest::StringDest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "47-47",
    "snippet": "virtual Status Sync() { return Status::OK(); }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  StringDest {\n    virtual Status Sync() { return Status::OK(); }\n  }\n}"
  },
  {
    "function_name": "Flush",
    "container": "LogTest::StringDest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "46-46",
    "snippet": "virtual Status Flush() { return Status::OK(); }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  StringDest {\n    virtual Status Flush() { return Status::OK(); }\n  }\n}"
  },
  {
    "function_name": "Close",
    "container": "LogTest::StringDest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "45-45",
    "snippet": "virtual Status Close() { return Status::OK(); }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  StringDest {\n    virtual Status Close() { return Status::OK(); }\n  }\n}"
  },
  {
    "function_name": "RandomSkewedString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "35-37",
    "snippet": "static std::string RandomSkewedString(int i, Random* rnd) {\n  return BigString(NumberString(i), rnd->Skewed(17));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BigString",
          "args": [
            "NumberString(i)",
            "rnd->Skewed(17)"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "BigString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "18-25",
          "snippet": "static std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rnd->Skewed",
          "args": [
            "17"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "Skewed",
          "container": "Random",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/random.h",
          "lines": "57-59",
          "snippet": "uint32_t Skewed(int max_log) {\n    return Uniform(1 << Uniform(max_log + 1));\n  }",
          "includes": [
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n\nRandom {\n  uint32_t Skewed(int max_log) {\n      return Uniform(1 << Uniform(max_log + 1));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "NumberString",
          "args": [
            "i"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "NumberString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "28-32",
          "snippet": "static std::string NumberString(int n) {\n  char buf[50];\n  snprintf(buf, sizeof(buf), \"%d.\", n);\n  return std::string(buf);\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string NumberString(int n) {\n  char buf[50];\n  snprintf(buf, sizeof(buf), \"%d.\", n);\n  return std::string(buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string RandomSkewedString(int i, Random* rnd) {\n  return BigString(NumberString(i), rnd->Skewed(17));\n}"
  },
  {
    "function_name": "NumberString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "28-32",
    "snippet": "static std::string NumberString(int n) {\n  char buf[50];\n  snprintf(buf, sizeof(buf), \"%d.\", n);\n  return std::string(buf);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "buf"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%d.\"",
            "n"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string NumberString(int n) {\n  char buf[50];\n  snprintf(buf, sizeof(buf), \"%d.\", n);\n  return std::string(buf);\n}"
  },
  {
    "function_name": "BigString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
    "lines": "18-25",
    "snippet": "static std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/crc32c.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"db/log_writer.h\"",
      "#include \"db/log_reader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result.resize",
          "args": [
            "n"
          ],
          "line": 23
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.append",
          "args": [
            "partial_string"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.size",
          "args": [],
          "line": 20
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nstatic std::string BigString(const std::string& partial_string, size_t n) {\n  std::string result;\n  while (result.size() < n) {\n    result.append(partial_string);\n  }\n  result.resize(n);\n  return result;\n}"
  }
]