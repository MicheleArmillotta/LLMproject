[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "866-868",
    "snippet": "int main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "leveldb::test::RunAllTests",
          "args": [],
          "line": 867
        },
        "resolved": true,
        "details": {
          "function_name": "RunAllTests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "36-58",
          "snippet": "int RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nint main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "836-862",
    "snippet": "TEST(TableTest, ApproximateOffsetOfCompressed) {\n  if (!SnappyCompressionSupported()) {\n    fprintf(stderr, \"skipping compression tests\\n\");\n    return;\n  }\n\n  Random rnd(301);\n  TableConstructor c(BytewiseComparator());\n  std::string tmp;\n  c.Add(\"k01\", \"hello\");\n  c.Add(\"k02\", test::CompressibleString(&rnd, 0.25, 10000, &tmp));\n  c.Add(\"k03\", \"hello3\");\n  c.Add(\"k04\", test::CompressibleString(&rnd, 0.25, 10000, &tmp));\n  std::vector<std::string> keys;\n  KVMap kvmap;\n  Options options;\n  options.block_size = 1024;\n  options.compression = kSnappyCompression;\n  c.Finish(options, &keys, &kvmap);\n\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"abc\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k01\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k02\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k03\"),    2000,   3000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k04\"),    2000,   3000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"xyz\"),    4000,   6000));\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"xyz\"),    4000,   6000)"
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Between",
          "args": [
            "c.ApproximateOffsetOf(\"xyz\")",
            "4000",
            "6000"
          ],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "Between",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "787-796",
          "snippet": "static bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nstatic bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "c.ApproximateOffsetOf",
          "args": [
            "\"xyz\""
          ],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "ApproximateOffsetOf",
          "container": "TableConstructor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "257-259",
          "snippet": "uint64_t ApproximateOffsetOf(const Slice& key) const {\n    return table_->ApproximateOffsetOf(key);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTableConstructor {\n  uint64_t ApproximateOffsetOf(const Slice& key) const {\n      return table_->ApproximateOffsetOf(key);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"k04\"),    2000,   3000)"
          ],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"k03\"),    2000,   3000)"
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"k02\"),       0,      0)"
          ],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"k01\"),       0,      0)"
          ],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"abc\"),       0,      0)"
          ],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.Finish",
          "args": [
            "options",
            "&keys",
            "&kvmap"
          ],
          "line": 854
        },
        "resolved": true,
        "details": {
          "function_name": "Finish",
          "container": "Constructor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "153-166",
          "snippet": "void Finish(const Options& options,\n              std::vector<std::string>* keys,\n              KVMap* kvmap) {\n    *kvmap = data_;\n    keys->clear();\n    for (KVMap::const_iterator it = data_.begin();\n         it != data_.end();\n         ++it) {\n      keys->push_back(it->first);\n    }\n    data_.clear();\n    Status s = FinishImpl(options, *kvmap);\n    ASSERT_TRUE(s.ok()) << s.ToString();\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nConstructor {\n  void Finish(const Options& options,\n                std::vector<std::string>* keys,\n                KVMap* kvmap) {\n      *kvmap = data_;\n      keys->clear();\n      for (KVMap::const_iterator it = data_.begin();\n           it != data_.end();\n           ++it) {\n        keys->push_back(it->first);\n      }\n      data_.clear();\n      Status s = FinishImpl(options, *kvmap);\n      ASSERT_TRUE(s.ok()) << s.ToString();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "c.Add",
          "args": [
            "\"k04\"",
            "test::CompressibleString(&rnd, 0.25, 10000, &tmp)"
          ],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "Constructor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "146-148",
          "snippet": "void Add(const std::string& key, const Slice& value) {\n    data_[key] = value.ToString();\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nConstructor {\n  void Add(const std::string& key, const Slice& value) {\n      data_[key] = value.ToString();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::CompressibleString",
          "args": [
            "&rnd",
            "0.25",
            "10000",
            "&tmp"
          ],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "CompressibleString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testutil.cc",
          "lines": "34-48",
          "snippet": "extern Slice CompressibleString(Random* rnd, double compressed_fraction,\n                                size_t len, std::string* dst) {\n  int raw = static_cast<int>(len * compressed_fraction);\n  if (raw < 1) raw = 1;\n  std::string raw_data;\n  RandomString(rnd, raw, &raw_data);\n\n  // Duplicate the random data until we have filled \"len\" bytes\n  dst->clear();\n  while (dst->size() < len) {\n    dst->append(raw_data);\n  }\n  dst->resize(len);\n  return Slice(*dst);\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/testutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/testutil.h\"\n\nextern Slice CompressibleString(Random* rnd, double compressed_fraction,\n                                size_t len, std::string* dst) {\n  int raw = static_cast<int>(len * compressed_fraction);\n  if (raw < 1) raw = 1;\n  std::string raw_data;\n  RandomString(rnd, raw, &raw_data);\n\n  // Duplicate the random data until we have filled \"len\" bytes\n  dst->clear();\n  while (dst->size() < len) {\n    dst->append(raw_data);\n  }\n  dst->resize(len);\n  return Slice(*dst);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"skipping compression tests\\n\""
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SnappyCompressionSupported",
          "args": [],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "SnappyCompressionSupported",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "830-834",
          "snippet": "static bool SnappyCompressionSupported() {\n  std::string out;\n  Slice in = \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\";\n  return port::Snappy_Compress(in.data(), in.size(), &out);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nstatic bool SnappyCompressionSupported() {\n  std::string out;\n  Slice in = \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\";\n  return port::Snappy_Compress(in.data(), in.size(), &out);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTEST(TableTest, ApproximateOffsetOfCompressed) {\n  if (!SnappyCompressionSupported()) {\n    fprintf(stderr, \"skipping compression tests\\n\");\n    return;\n  }\n\n  Random rnd(301);\n  TableConstructor c(BytewiseComparator());\n  std::string tmp;\n  c.Add(\"k01\", \"hello\");\n  c.Add(\"k02\", test::CompressibleString(&rnd, 0.25, 10000, &tmp));\n  c.Add(\"k03\", \"hello3\");\n  c.Add(\"k04\", test::CompressibleString(&rnd, 0.25, 10000, &tmp));\n  std::vector<std::string> keys;\n  KVMap kvmap;\n  Options options;\n  options.block_size = 1024;\n  options.compression = kSnappyCompression;\n  c.Finish(options, &keys, &kvmap);\n\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"abc\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k01\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k02\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k03\"),    2000,   3000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k04\"),    2000,   3000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"xyz\"),    4000,   6000));\n}"
  },
  {
    "function_name": "SnappyCompressionSupported",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "830-834",
    "snippet": "static bool SnappyCompressionSupported() {\n  std::string out;\n  Slice in = \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\";\n  return port::Snappy_Compress(in.data(), in.size(), &out);\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "port::Snappy_Compress",
          "args": [
            "in.data()",
            "in.size()",
            "&out"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "Snappy_Compress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.h",
          "lines": "136-147",
          "snippet": "inline bool Snappy_Compress(const char* input, size_t length,\n                            ::std::string* output) {\n#ifdef SNAPPY\n  output->resize(snappy::MaxCompressedLength(length));\n  size_t outlen;\n  snappy::RawCompress(input, length, &(*output)[0], &outlen);\n  output->resize(outlen);\n  return true;\n#endif\n\n  return false;\n}",
          "includes": [
            "#include <snappy.h>",
            "#include <stdint.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <snappy.h>\n#include <stdint.h>\n#include <string>\n\ninline bool Snappy_Compress(const char* input, size_t length,\n                            ::std::string* output) {\n#ifdef SNAPPY\n  output->resize(snappy::MaxCompressedLength(length));\n  size_t outlen;\n  snappy::RawCompress(input, length, &(*output)[0], &outlen);\n  output->resize(outlen);\n  return true;\n#endif\n\n  return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "in.size",
          "args": [],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "in.data",
          "args": [],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nstatic bool SnappyCompressionSupported() {\n  std::string out;\n  Slice in = \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\";\n  return port::Snappy_Compress(in.data(), in.size(), &out);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "800-828",
    "snippet": "TEST(TableTest, ApproximateOffsetOfPlain) {\n  TableConstructor c(BytewiseComparator());\n  c.Add(\"k01\", \"hello\");\n  c.Add(\"k02\", \"hello2\");\n  c.Add(\"k03\", std::string(10000, 'x'));\n  c.Add(\"k04\", std::string(200000, 'x'));\n  c.Add(\"k05\", std::string(300000, 'x'));\n  c.Add(\"k06\", \"hello3\");\n  c.Add(\"k07\", std::string(100000, 'x'));\n  std::vector<std::string> keys;\n  KVMap kvmap;\n  Options options;\n  options.block_size = 1024;\n  options.compression = kNoCompression;\n  c.Finish(options, &keys, &kvmap);\n\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"abc\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k01\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k01a\"),      0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k02\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k03\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k04\"),   10000,  11000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k04a\"), 210000, 211000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k05\"),  210000, 211000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k06\"),  510000, 511000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k07\"),  510000, 511000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"xyz\"),  610000, 612000));\n\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"xyz\"),  610000, 612000)"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Between",
          "args": [
            "c.ApproximateOffsetOf(\"xyz\")",
            "610000",
            "612000"
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "Between",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "787-796",
          "snippet": "static bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nstatic bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "c.ApproximateOffsetOf",
          "args": [
            "\"xyz\""
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "ApproximateOffsetOf",
          "container": "TableConstructor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "257-259",
          "snippet": "uint64_t ApproximateOffsetOf(const Slice& key) const {\n    return table_->ApproximateOffsetOf(key);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTableConstructor {\n  uint64_t ApproximateOffsetOf(const Slice& key) const {\n      return table_->ApproximateOffsetOf(key);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"k07\"),  510000, 511000)"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"k06\"),  510000, 511000)"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"k05\"),  210000, 211000)"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"k04a\"), 210000, 211000)"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"k04\"),   10000,  11000)"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"k03\"),       0,      0)"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"k02\"),       0,      0)"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"k01a\"),      0,      0)"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"k01\"),       0,      0)"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(c.ApproximateOffsetOf(\"abc\"),       0,      0)"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.Finish",
          "args": [
            "options",
            "&keys",
            "&kvmap"
          ],
          "line": 814
        },
        "resolved": true,
        "details": {
          "function_name": "Finish",
          "container": "Constructor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "153-166",
          "snippet": "void Finish(const Options& options,\n              std::vector<std::string>* keys,\n              KVMap* kvmap) {\n    *kvmap = data_;\n    keys->clear();\n    for (KVMap::const_iterator it = data_.begin();\n         it != data_.end();\n         ++it) {\n      keys->push_back(it->first);\n    }\n    data_.clear();\n    Status s = FinishImpl(options, *kvmap);\n    ASSERT_TRUE(s.ok()) << s.ToString();\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nConstructor {\n  void Finish(const Options& options,\n                std::vector<std::string>* keys,\n                KVMap* kvmap) {\n      *kvmap = data_;\n      keys->clear();\n      for (KVMap::const_iterator it = data_.begin();\n           it != data_.end();\n           ++it) {\n        keys->push_back(it->first);\n      }\n      data_.clear();\n      Status s = FinishImpl(options, *kvmap);\n      ASSERT_TRUE(s.ok()) << s.ToString();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "c.Add",
          "args": [
            "\"k07\"",
            "std::string(100000, 'x')"
          ],
          "line": 808
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "Constructor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "146-148",
          "snippet": "void Add(const std::string& key, const Slice& value) {\n    data_[key] = value.ToString();\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nConstructor {\n  void Add(const std::string& key, const Slice& value) {\n      data_[key] = value.ToString();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "100000",
            "'x'"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "300000",
            "'x'"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "200000",
            "'x'"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "10000",
            "'x'"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTEST(TableTest, ApproximateOffsetOfPlain) {\n  TableConstructor c(BytewiseComparator());\n  c.Add(\"k01\", \"hello\");\n  c.Add(\"k02\", \"hello2\");\n  c.Add(\"k03\", std::string(10000, 'x'));\n  c.Add(\"k04\", std::string(200000, 'x'));\n  c.Add(\"k05\", std::string(300000, 'x'));\n  c.Add(\"k06\", \"hello3\");\n  c.Add(\"k07\", std::string(100000, 'x'));\n  std::vector<std::string> keys;\n  KVMap kvmap;\n  Options options;\n  options.block_size = 1024;\n  options.compression = kNoCompression;\n  c.Finish(options, &keys, &kvmap);\n\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"abc\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k01\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k01a\"),      0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k02\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k03\"),       0,      0));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k04\"),   10000,  11000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k04a\"), 210000, 211000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k05\"),  210000, 211000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k06\"),  510000, 511000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"k07\"),  510000, 511000));\n  ASSERT_TRUE(Between(c.ApproximateOffsetOf(\"xyz\"),  610000, 612000));\n\n}"
  },
  {
    "function_name": "Between",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "787-796",
    "snippet": "static bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Value %llu is not in range [%llu, %llu]\\n\"",
            "(unsigned long long)(val)",
            "(unsigned long long)(low)",
            "(unsigned long long)(high)"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nstatic bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "762-785",
    "snippet": "TEST(MemTableTest, Simple) {\n  InternalKeyComparator cmp(BytewiseComparator());\n  MemTable* memtable = new MemTable(cmp);\n  memtable->Ref();\n  WriteBatch batch;\n  WriteBatchInternal::SetSequence(&batch, 100);\n  batch.Put(std::string(\"k1\"), std::string(\"v1\"));\n  batch.Put(std::string(\"k2\"), std::string(\"v2\"));\n  batch.Put(std::string(\"k3\"), std::string(\"v3\"));\n  batch.Put(std::string(\"largekey\"), std::string(\"vlarge\"));\n  ASSERT_TRUE(WriteBatchInternal::InsertInto(&batch, memtable).ok());\n\n  Iterator* iter = memtable->NewIterator();\n  iter->SeekToFirst();\n  while (iter->Valid()) {\n    fprintf(stderr, \"key: '%s' -> '%s'\\n\",\n            iter->key().ToString().c_str(),\n            iter->value().ToString().c_str());\n    iter->Next();\n  }\n\n  delete iter;\n  memtable->Unref();\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memtable->Unref",
          "args": [],
          "line": 784
        },
        "resolved": true,
        "details": {
          "function_name": "Unref",
          "container": "FileState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "33-48",
          "snippet": "void Unref() {\n    bool do_delete = false;\n\n    {\n      MutexLock lock(&refs_mutex_);\n      --refs_;\n      assert(refs_ >= 0);\n      if (refs_ <= 0) {\n        do_delete = true;\n      }\n    }\n\n    if (do_delete) {\n      delete this;\n    }\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  void Unref() {\n      bool do_delete = false;\n  \n      {\n        MutexLock lock(&refs_mutex_);\n        --refs_;\n        assert(refs_ >= 0);\n        if (refs_ <= 0) {\n          do_delete = true;\n        }\n      }\n  \n      if (do_delete) {\n        delete this;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Next",
          "args": [],
          "line": 780
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "289-289",
          "snippet": "virtual void Next() { iter_->Next(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void Next() { iter_->Next(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"key: '%s' -> '%s'\\n\"",
            "iter->key().ToString().c_str()",
            "iter->value().ToString().c_str()"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->value",
          "args": [],
          "line": 779
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "302-302",
          "snippet": "virtual Slice value() const { return iter_->value(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual Slice value() const { return iter_->value(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->key",
          "args": [],
          "line": 778
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "292-300",
          "snippet": "virtual Slice key() const {\n    assert(Valid());\n    ParsedInternalKey key;\n    if (!ParseInternalKey(iter_->key(), &key)) {\n      status_ = Status::Corruption(\"malformed internal key\");\n      return Slice(\"corrupted key\");\n    }\n    return key.user_key;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual Slice key() const {\n      assert(Valid());\n      ParsedInternalKey key;\n      if (!ParseInternalKey(iter_->key(), &key)) {\n        status_ = Status::Corruption(\"malformed internal key\");\n        return Slice(\"corrupted key\");\n      }\n      return key.user_key;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Valid",
          "args": [],
          "line": 776
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "280-280",
          "snippet": "virtual bool Valid() const { return iter_->Valid(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual bool Valid() const { return iter_->Valid(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->SeekToFirst",
          "args": [],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "287-287",
          "snippet": "virtual void SeekToFirst() { iter_->SeekToFirst(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void SeekToFirst() { iter_->SeekToFirst(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memtable->NewIterator",
          "args": [],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "WriteBatchInternal::InsertInto(&batch, memtable).ok()"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WriteBatchInternal::InsertInto",
          "args": [],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WriteBatchInternal::InsertInto",
          "args": [
            "&batch",
            "memtable"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "InsertInto",
          "container": "WriteBatchInternal",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "128-134",
          "snippet": "Status WriteBatchInternal::InsertInto(const WriteBatch* b,\n                                      MemTable* memtable) {\n  MemTableInserter inserter;\n  inserter.sequence_ = WriteBatchInternal::Sequence(b);\n  inserter.mem_ = memtable;\n  return b->Iterate(&inserter);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  Status WriteBatchInternal::InsertInto(const WriteBatch* b,\n                                        MemTable* memtable) {\n    MemTableInserter inserter;\n    inserter.sequence_ = WriteBatchInternal::Sequence(b);\n    inserter.mem_ = memtable;\n    return b->Iterate(&inserter);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "batch.Put",
          "args": [
            "std::string(\"largekey\")",
            "std::string(\"vlarge\")"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "CBatchScanner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/txdb-leveldb.cpp",
          "lines": "164-170",
          "snippet": "virtual void Put(const leveldb::Slice& key, const leveldb::Slice& value) {\n        if (key.ToString() == needle) {\n            foundEntry = true;\n            *deleted = false;\n            *foundValue = value.ToString();\n        }\n    }",
          "includes": [
            "#include \"main.h\"",
            "#include \"util.h\"",
            "#include \"txdb.h\"",
            "#include \"checkpoints.h\"",
            "#include \"kernel.h\"",
            "#include <memenv/memenv.h>",
            "#include <leveldb/filter_policy.h>",
            "#include <leveldb/cache.h>",
            "#include <leveldb/env.h>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/version.hpp>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"main.h\"\n#include \"util.h\"\n#include \"txdb.h\"\n#include \"checkpoints.h\"\n#include \"kernel.h\"\n#include <memenv/memenv.h>\n#include <leveldb/filter_policy.h>\n#include <leveldb/cache.h>\n#include <leveldb/env.h>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/version.hpp>\n#include <map>\n\nCBatchScanner {\n  virtual void Put(const leveldb::Slice& key, const leveldb::Slice& value) {\n          if (key.ToString() == needle) {\n              foundEntry = true;\n              *deleted = false;\n              *foundValue = value.ToString();\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"vlarge\""
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"largekey\""
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"v3\""
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"k3\""
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"v2\""
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"k2\""
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"v1\""
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"k1\""
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WriteBatchInternal::SetSequence",
          "args": [
            "&batch",
            "100"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "SetSequence",
          "container": "WriteBatchInternal",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "94-96",
          "snippet": "void WriteBatchInternal::SetSequence(WriteBatch* b, SequenceNumber seq) {\n  EncodeFixed64(&b->rep_[0], seq);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  void WriteBatchInternal::SetSequence(WriteBatch* b, SequenceNumber seq) {\n    EncodeFixed64(&b->rep_[0], seq);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memtable->Ref",
          "args": [],
          "line": 765
        },
        "resolved": true,
        "details": {
          "function_name": "Ref",
          "container": "FileState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "27-30",
          "snippet": "void Ref() {\n    MutexLock lock(&refs_mutex_);\n    ++refs_;\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  void Ref() {\n      MutexLock lock(&refs_mutex_);\n      ++refs_;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTEST(MemTableTest, Simple) {\n  InternalKeyComparator cmp(BytewiseComparator());\n  MemTable* memtable = new MemTable(cmp);\n  memtable->Ref();\n  WriteBatch batch;\n  WriteBatchInternal::SetSequence(&batch, 100);\n  batch.Put(std::string(\"k1\"), std::string(\"v1\"));\n  batch.Put(std::string(\"k2\"), std::string(\"v2\"));\n  batch.Put(std::string(\"k3\"), std::string(\"v3\"));\n  batch.Put(std::string(\"largekey\"), std::string(\"vlarge\"));\n  ASSERT_TRUE(WriteBatchInternal::InsertInto(&batch, memtable).ok());\n\n  Iterator* iter = memtable->NewIterator();\n  iter->SeekToFirst();\n  while (iter->Valid()) {\n    fprintf(stderr, \"key: '%s' -> '%s'\\n\",\n            iter->key().ToString().c_str(),\n            iter->value().ToString().c_str());\n    iter->Next();\n  }\n\n  delete iter;\n  memtable->Unref();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "736-758",
    "snippet": "TEST(Harness, RandomizedLongDB) {\n  Random rnd(test::RandomSeed());\n  TestArgs args = { DB_TEST, false, 16 };\n  Init(args);\n  int num_entries = 100000;\n  for (int e = 0; e < num_entries; e++) {\n    std::string v;\n    Add(test::RandomKey(&rnd, rnd.Skewed(4)),\n        test::RandomString(&rnd, rnd.Skewed(5), &v).ToString());\n  }\n  Test(&rnd);\n\n  // We must have created enough data to force merging\n  int files = 0;\n  for (int level = 0; level < config::kNumLevels; level++) {\n    std::string value;\n    char name[100];\n    snprintf(name, sizeof(name), \"leveldb.num-files-at-level%d\", level);\n    ASSERT_TRUE(db()->GetProperty(name, &value));\n    files += atoi(value.c_str());\n  }\n  ASSERT_GT(files, 0);\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_GT",
          "args": [
            "files",
            "0"
          ],
          "line": 757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "value.c_str()"
          ],
          "line": 755
        },
        "resolved": true,
        "details": {
          "function_name": "atoi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "292-295",
          "snippet": "inline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.c_str",
          "args": [],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "db()->GetProperty(name, &value)"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db",
          "args": [
            "name",
            "&value"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "listreceivedbyaccount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/rpcwallet.cpp",
          "lines": "982-997",
          "snippet": "Value listreceivedbyaccount(const Array& params, bool fHelp)\n{\n    if (fHelp || params.size() > 2)\n        throw runtime_error(\n            \"listreceivedbyaccount [minconf=1] [includeempty=false]\\n\"\n            \"[minconf] is the minimum number of confirmations before payments are included.\\n\"\n            \"[includeempty] whether to include accounts that haven't received any payments.\\n\"\n            \"Returns an array of objects containing:\\n\"\n            \"  \\\"account\\\" : the account of the receiving addresses\\n\"\n            \"  \\\"amount\\\" : total amount received by addresses with this account\\n\"\n            \"  \\\"confirmations\\\" : number of confirmations of the most recent transaction included\");\n\n    accountingDeprecationCheck();\n\n    return ListReceived(params, true);\n}",
          "includes": [
            "#include \"base58.h\"",
            "#include \"ntp.h\"",
            "#include \"util.h\"",
            "#include \"init.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"walletdb.h\"",
            "#include \"wallet.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"ntp.h\"\n#include \"util.h\"\n#include \"init.h\"\n#include \"bitcoinrpc.h\"\n#include \"walletdb.h\"\n#include \"wallet.h\"\n\nValue listreceivedbyaccount(const Array& params, bool fHelp)\n{\n    if (fHelp || params.size() > 2)\n        throw runtime_error(\n            \"listreceivedbyaccount [minconf=1] [includeempty=false]\\n\"\n            \"[minconf] is the minimum number of confirmations before payments are included.\\n\"\n            \"[includeempty] whether to include accounts that haven't received any payments.\\n\"\n            \"Returns an array of objects containing:\\n\"\n            \"  \\\"account\\\" : the account of the receiving addresses\\n\"\n            \"  \\\"amount\\\" : total amount received by addresses with this account\\n\"\n            \"  \\\"confirmations\\\" : number of confirmations of the most recent transaction included\");\n\n    accountingDeprecationCheck();\n\n    return ListReceived(params, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "db",
          "args": [],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "leveldb_minor_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "591-593",
          "snippet": "int leveldb_minor_version() {\n  return kMinorVersion;\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nint leveldb_minor_version() {\n  return kMinorVersion;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "name",
            "sizeof(name)",
            "\"leveldb.num-files-at-level%d\"",
            "level"
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Test",
          "args": [
            "&rnd"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "Test",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "477-485",
          "snippet": "void Test(Random* rnd) {\n    std::vector<std::string> keys;\n    KVMap data;\n    constructor_->Finish(options_, &keys, &data);\n\n    TestForwardScan(keys, data);\n    TestBackwardScan(keys, data);\n    TestRandomAccess(rnd, keys, data);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Test(Random* rnd) {\n      std::vector<std::string> keys;\n      KVMap data;\n      constructor_->Finish(options_, &keys, &data);\n  \n      TestForwardScan(keys, data);\n      TestBackwardScan(keys, data);\n      TestRandomAccess(rnd, keys, data);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Add",
          "args": [
            "test::RandomKey(&rnd, rnd.Skewed(4))",
            "test::RandomString(&rnd, rnd.Skewed(5), &v).ToString()"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "473-475",
          "snippet": "void Add(const std::string& key, const std::string& value) {\n    constructor_->Add(key, value);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Add(const std::string& key, const std::string& value) {\n      constructor_->Add(key, value);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::RandomString",
          "args": [],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test::RandomString",
          "args": [
            "&rnd",
            "rnd.Skewed(5)",
            "&v"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "RandomString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testutil.cc",
          "lines": "12-18",
          "snippet": "Slice RandomString(Random* rnd, int len, std::string* dst) {\n  dst->resize(len);\n  for (int i = 0; i < len; i++) {\n    (*dst)[i] = static_cast<char>(' ' + rnd->Uniform(95));   // ' ' .. '~'\n  }\n  return Slice(*dst);\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/testutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/testutil.h\"\n\nSlice RandomString(Random* rnd, int len, std::string* dst) {\n  dst->resize(len);\n  for (int i = 0; i < len; i++) {\n    (*dst)[i] = static_cast<char>(' ' + rnd->Uniform(95));   // ' ' .. '~'\n  }\n  return Slice(*dst);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rnd.Skewed",
          "args": [
            "5"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "Skewed",
          "container": "Random",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/random.h",
          "lines": "57-59",
          "snippet": "uint32_t Skewed(int max_log) {\n    return Uniform(1 << Uniform(max_log + 1));\n  }",
          "includes": [
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n\nRandom {\n  uint32_t Skewed(int max_log) {\n      return Uniform(1 << Uniform(max_log + 1));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::RandomKey",
          "args": [
            "&rnd",
            "rnd.Skewed(4)"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "RandomKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testutil.cc",
          "lines": "20-31",
          "snippet": "std::string RandomKey(Random* rnd, int len) {\n  // Make sure to generate a wide variety of characters so we\n  // test the boundary conditions for short-key optimizations.\n  static const char kTestChars[] = {\n    '\\0', '\\1', 'a', 'b', 'c', 'd', 'e', '\\xfd', '\\xfe', '\\xff'\n  };\n  std::string result;\n  for (int i = 0; i < len; i++) {\n    result += kTestChars[rnd->Uniform(sizeof(kTestChars))];\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/testutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/testutil.h\"\n\nstd::string RandomKey(Random* rnd, int len) {\n  // Make sure to generate a wide variety of characters so we\n  // test the boundary conditions for short-key optimizations.\n  static const char kTestChars[] = {\n    '\\0', '\\1', 'a', 'b', 'c', 'd', 'e', '\\xfd', '\\xfe', '\\xff'\n  };\n  std::string result;\n  for (int i = 0; i < len; i++) {\n    result += kTestChars[rnd->Uniform(sizeof(kTestChars))];\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "args"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "441-467",
          "snippet": "void Init(const TestArgs& args) {\n    delete constructor_;\n    constructor_ = NULL;\n    options_ = Options();\n\n    options_.block_restart_interval = args.restart_interval;\n    // Use shorter block size for tests to exercise block boundary\n    // conditions more.\n    options_.block_size = 256;\n    if (args.reverse_compare) {\n      options_.comparator = &reverse_key_comparator;\n    }\n    switch (args.type) {\n      case TABLE_TEST:\n        constructor_ = new TableConstructor(options_.comparator);\n        break;\n      case BLOCK_TEST:\n        constructor_ = new BlockConstructor(options_.comparator);\n        break;\n      case MEMTABLE_TEST:\n        constructor_ = new MemTableConstructor(options_.comparator);\n        break;\n      case DB_TEST:\n        constructor_ = new DBConstructor(options_.comparator);\n        break;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Init(const TestArgs& args) {\n      delete constructor_;\n      constructor_ = NULL;\n      options_ = Options();\n  \n      options_.block_restart_interval = args.restart_interval;\n      // Use shorter block size for tests to exercise block boundary\n      // conditions more.\n      options_.block_size = 256;\n      if (args.reverse_compare) {\n        options_.comparator = &reverse_key_comparator;\n      }\n      switch (args.type) {\n        case TABLE_TEST:\n          constructor_ = new TableConstructor(options_.comparator);\n          break;\n        case BLOCK_TEST:\n          constructor_ = new BlockConstructor(options_.comparator);\n          break;\n        case MEMTABLE_TEST:\n          constructor_ = new MemTableConstructor(options_.comparator);\n          break;\n        case DB_TEST:\n          constructor_ = new DBConstructor(options_.comparator);\n          break;\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTEST(Harness, RandomizedLongDB) {\n  Random rnd(test::RandomSeed());\n  TestArgs args = { DB_TEST, false, 16 };\n  Init(args);\n  int num_entries = 100000;\n  for (int e = 0; e < num_entries; e++) {\n    std::string v;\n    Add(test::RandomKey(&rnd, rnd.Skewed(4)),\n        test::RandomString(&rnd, rnd.Skewed(5), &v).ToString());\n  }\n  Test(&rnd);\n\n  // We must have created enough data to force merging\n  int files = 0;\n  for (int level = 0; level < config::kNumLevels; level++) {\n    std::string value;\n    char name[100];\n    snprintf(name, sizeof(name), \"leveldb.num-files-at-level%d\", level);\n    ASSERT_TRUE(db()->GetProperty(name, &value));\n    files += atoi(value.c_str());\n  }\n  ASSERT_GT(files, 0);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "716-734",
    "snippet": "TEST(Harness, Randomized) {\n  for (int i = 0; i < kNumTestArgs; i++) {\n    Init(kTestArgList[i]);\n    Random rnd(test::RandomSeed() + 5);\n    for (int num_entries = 0; num_entries < 2000;\n         num_entries += (num_entries < 50 ? 1 : 200)) {\n      if ((num_entries % 10) == 0) {\n        fprintf(stderr, \"case %d of %d: num_entries = %d\\n\",\n                (i + 1), int(kNumTestArgs), num_entries);\n      }\n      for (int e = 0; e < num_entries; e++) {\n        std::string v;\n        Add(test::RandomKey(&rnd, rnd.Skewed(4)),\n            test::RandomString(&rnd, rnd.Skewed(5), &v).ToString());\n      }\n      Test(&rnd);\n    }\n  }\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Test",
          "args": [
            "&rnd"
          ],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "Test",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "477-485",
          "snippet": "void Test(Random* rnd) {\n    std::vector<std::string> keys;\n    KVMap data;\n    constructor_->Finish(options_, &keys, &data);\n\n    TestForwardScan(keys, data);\n    TestBackwardScan(keys, data);\n    TestRandomAccess(rnd, keys, data);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Test(Random* rnd) {\n      std::vector<std::string> keys;\n      KVMap data;\n      constructor_->Finish(options_, &keys, &data);\n  \n      TestForwardScan(keys, data);\n      TestBackwardScan(keys, data);\n      TestRandomAccess(rnd, keys, data);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Add",
          "args": [
            "test::RandomKey(&rnd, rnd.Skewed(4))",
            "test::RandomString(&rnd, rnd.Skewed(5), &v).ToString()"
          ],
          "line": 728
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "473-475",
          "snippet": "void Add(const std::string& key, const std::string& value) {\n    constructor_->Add(key, value);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Add(const std::string& key, const std::string& value) {\n      constructor_->Add(key, value);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::RandomString",
          "args": [],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test::RandomString",
          "args": [
            "&rnd",
            "rnd.Skewed(5)",
            "&v"
          ],
          "line": 729
        },
        "resolved": true,
        "details": {
          "function_name": "RandomString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testutil.cc",
          "lines": "12-18",
          "snippet": "Slice RandomString(Random* rnd, int len, std::string* dst) {\n  dst->resize(len);\n  for (int i = 0; i < len; i++) {\n    (*dst)[i] = static_cast<char>(' ' + rnd->Uniform(95));   // ' ' .. '~'\n  }\n  return Slice(*dst);\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/testutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/testutil.h\"\n\nSlice RandomString(Random* rnd, int len, std::string* dst) {\n  dst->resize(len);\n  for (int i = 0; i < len; i++) {\n    (*dst)[i] = static_cast<char>(' ' + rnd->Uniform(95));   // ' ' .. '~'\n  }\n  return Slice(*dst);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rnd.Skewed",
          "args": [
            "5"
          ],
          "line": 729
        },
        "resolved": true,
        "details": {
          "function_name": "Skewed",
          "container": "Random",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/random.h",
          "lines": "57-59",
          "snippet": "uint32_t Skewed(int max_log) {\n    return Uniform(1 << Uniform(max_log + 1));\n  }",
          "includes": [
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n\nRandom {\n  uint32_t Skewed(int max_log) {\n      return Uniform(1 << Uniform(max_log + 1));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::RandomKey",
          "args": [
            "&rnd",
            "rnd.Skewed(4)"
          ],
          "line": 728
        },
        "resolved": true,
        "details": {
          "function_name": "RandomKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testutil.cc",
          "lines": "20-31",
          "snippet": "std::string RandomKey(Random* rnd, int len) {\n  // Make sure to generate a wide variety of characters so we\n  // test the boundary conditions for short-key optimizations.\n  static const char kTestChars[] = {\n    '\\0', '\\1', 'a', 'b', 'c', 'd', 'e', '\\xfd', '\\xfe', '\\xff'\n  };\n  std::string result;\n  for (int i = 0; i < len; i++) {\n    result += kTestChars[rnd->Uniform(sizeof(kTestChars))];\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/testutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/testutil.h\"\n\nstd::string RandomKey(Random* rnd, int len) {\n  // Make sure to generate a wide variety of characters so we\n  // test the boundary conditions for short-key optimizations.\n  static const char kTestChars[] = {\n    '\\0', '\\1', 'a', 'b', 'c', 'd', 'e', '\\xfd', '\\xfe', '\\xff'\n  };\n  std::string result;\n  for (int i = 0; i < len; i++) {\n    result += kTestChars[rnd->Uniform(sizeof(kTestChars))];\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"case %d of %d: num_entries = %d\\n\"",
            "(i + 1)",
            "int(kNumTestArgs)",
            "num_entries"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "int",
          "args": [
            "kNumTestArgs"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToRestartPoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/block.cc",
          "lines": "104-112",
          "snippet": "void SeekToRestartPoint(uint32_t index) {\n    key_.clear();\n    restart_index_ = index;\n    // current_ will be fixed by ParseNextKey();\n\n    // ParseNextKey() starts at the end of value_, so set value_ accordingly\n    uint32_t offset = GetRestartPoint(index);\n    value_ = Slice(data_ + offset, 0);\n  }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/format.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <algorithm>",
            "#include <vector>",
            "#include \"table/block.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/format.h\"\n#include \"leveldb/comparator.h\"\n#include <algorithm>\n#include <vector>\n#include \"table/block.h\"\n\nvoid SeekToRestartPoint(uint32_t index) {\n    key_.clear();\n    restart_index_ = index;\n    // current_ will be fixed by ParseNextKey();\n\n    // ParseNextKey() starts at the end of value_, so set value_ accordingly\n    uint32_t offset = GetRestartPoint(index);\n    value_ = Slice(data_ + offset, 0);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "test::RandomSeed",
          "args": [],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "RandomSeed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "67-74",
          "snippet": "int RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "kTestArgList[i]"
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "441-467",
          "snippet": "void Init(const TestArgs& args) {\n    delete constructor_;\n    constructor_ = NULL;\n    options_ = Options();\n\n    options_.block_restart_interval = args.restart_interval;\n    // Use shorter block size for tests to exercise block boundary\n    // conditions more.\n    options_.block_size = 256;\n    if (args.reverse_compare) {\n      options_.comparator = &reverse_key_comparator;\n    }\n    switch (args.type) {\n      case TABLE_TEST:\n        constructor_ = new TableConstructor(options_.comparator);\n        break;\n      case BLOCK_TEST:\n        constructor_ = new BlockConstructor(options_.comparator);\n        break;\n      case MEMTABLE_TEST:\n        constructor_ = new MemTableConstructor(options_.comparator);\n        break;\n      case DB_TEST:\n        constructor_ = new DBConstructor(options_.comparator);\n        break;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Init(const TestArgs& args) {\n      delete constructor_;\n      constructor_ = NULL;\n      options_ = Options();\n  \n      options_.block_restart_interval = args.restart_interval;\n      // Use shorter block size for tests to exercise block boundary\n      // conditions more.\n      options_.block_size = 256;\n      if (args.reverse_compare) {\n        options_.comparator = &reverse_key_comparator;\n      }\n      switch (args.type) {\n        case TABLE_TEST:\n          constructor_ = new TableConstructor(options_.comparator);\n          break;\n        case BLOCK_TEST:\n          constructor_ = new BlockConstructor(options_.comparator);\n          break;\n        case MEMTABLE_TEST:\n          constructor_ = new MemTableConstructor(options_.comparator);\n          break;\n        case DB_TEST:\n          constructor_ = new DBConstructor(options_.comparator);\n          break;\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTEST(Harness, Randomized) {\n  for (int i = 0; i < kNumTestArgs; i++) {\n    Init(kTestArgList[i]);\n    Random rnd(test::RandomSeed() + 5);\n    for (int num_entries = 0; num_entries < 2000;\n         num_entries += (num_entries < 50 ? 1 : 200)) {\n      if ((num_entries % 10) == 0) {\n        fprintf(stderr, \"case %d of %d: num_entries = %d\\n\",\n                (i + 1), int(kNumTestArgs), num_entries);\n      }\n      for (int e = 0; e < num_entries; e++) {\n        std::string v;\n        Add(test::RandomKey(&rnd, rnd.Skewed(4)),\n            test::RandomString(&rnd, rnd.Skewed(5), &v).ToString());\n      }\n      Test(&rnd);\n    }\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "707-714",
    "snippet": "TEST(Harness, SimpleSpecialKey) {\n  for (int i = 0; i < kNumTestArgs; i++) {\n    Init(kTestArgList[i]);\n    Random rnd(test::RandomSeed() + 4);\n    Add(\"\\xff\\xff\", \"v3\");\n    Test(&rnd);\n  }\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Test",
          "args": [
            "&rnd"
          ],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "Test",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "477-485",
          "snippet": "void Test(Random* rnd) {\n    std::vector<std::string> keys;\n    KVMap data;\n    constructor_->Finish(options_, &keys, &data);\n\n    TestForwardScan(keys, data);\n    TestBackwardScan(keys, data);\n    TestRandomAccess(rnd, keys, data);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Test(Random* rnd) {\n      std::vector<std::string> keys;\n      KVMap data;\n      constructor_->Finish(options_, &keys, &data);\n  \n      TestForwardScan(keys, data);\n      TestBackwardScan(keys, data);\n      TestRandomAccess(rnd, keys, data);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Add",
          "args": [
            "\"\\xff\\xff\"",
            "\"v3\""
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "473-475",
          "snippet": "void Add(const std::string& key, const std::string& value) {\n    constructor_->Add(key, value);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Add(const std::string& key, const std::string& value) {\n      constructor_->Add(key, value);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::RandomSeed",
          "args": [],
          "line": 710
        },
        "resolved": true,
        "details": {
          "function_name": "RandomSeed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "67-74",
          "snippet": "int RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "kTestArgList[i]"
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "441-467",
          "snippet": "void Init(const TestArgs& args) {\n    delete constructor_;\n    constructor_ = NULL;\n    options_ = Options();\n\n    options_.block_restart_interval = args.restart_interval;\n    // Use shorter block size for tests to exercise block boundary\n    // conditions more.\n    options_.block_size = 256;\n    if (args.reverse_compare) {\n      options_.comparator = &reverse_key_comparator;\n    }\n    switch (args.type) {\n      case TABLE_TEST:\n        constructor_ = new TableConstructor(options_.comparator);\n        break;\n      case BLOCK_TEST:\n        constructor_ = new BlockConstructor(options_.comparator);\n        break;\n      case MEMTABLE_TEST:\n        constructor_ = new MemTableConstructor(options_.comparator);\n        break;\n      case DB_TEST:\n        constructor_ = new DBConstructor(options_.comparator);\n        break;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Init(const TestArgs& args) {\n      delete constructor_;\n      constructor_ = NULL;\n      options_ = Options();\n  \n      options_.block_restart_interval = args.restart_interval;\n      // Use shorter block size for tests to exercise block boundary\n      // conditions more.\n      options_.block_size = 256;\n      if (args.reverse_compare) {\n        options_.comparator = &reverse_key_comparator;\n      }\n      switch (args.type) {\n        case TABLE_TEST:\n          constructor_ = new TableConstructor(options_.comparator);\n          break;\n        case BLOCK_TEST:\n          constructor_ = new BlockConstructor(options_.comparator);\n          break;\n        case MEMTABLE_TEST:\n          constructor_ = new MemTableConstructor(options_.comparator);\n          break;\n        case DB_TEST:\n          constructor_ = new DBConstructor(options_.comparator);\n          break;\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTEST(Harness, SimpleSpecialKey) {\n  for (int i = 0; i < kNumTestArgs; i++) {\n    Init(kTestArgList[i]);\n    Random rnd(test::RandomSeed() + 4);\n    Add(\"\\xff\\xff\", \"v3\");\n    Test(&rnd);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "696-705",
    "snippet": "TEST(Harness, SimpleMulti) {\n  for (int i = 0; i < kNumTestArgs; i++) {\n    Init(kTestArgList[i]);\n    Random rnd(test::RandomSeed() + 3);\n    Add(\"abc\", \"v\");\n    Add(\"abcd\", \"v\");\n    Add(\"ac\", \"v2\");\n    Test(&rnd);\n  }\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Test",
          "args": [
            "&rnd"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "Test",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "477-485",
          "snippet": "void Test(Random* rnd) {\n    std::vector<std::string> keys;\n    KVMap data;\n    constructor_->Finish(options_, &keys, &data);\n\n    TestForwardScan(keys, data);\n    TestBackwardScan(keys, data);\n    TestRandomAccess(rnd, keys, data);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Test(Random* rnd) {\n      std::vector<std::string> keys;\n      KVMap data;\n      constructor_->Finish(options_, &keys, &data);\n  \n      TestForwardScan(keys, data);\n      TestBackwardScan(keys, data);\n      TestRandomAccess(rnd, keys, data);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Add",
          "args": [
            "\"ac\"",
            "\"v2\""
          ],
          "line": 702
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "473-475",
          "snippet": "void Add(const std::string& key, const std::string& value) {\n    constructor_->Add(key, value);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Add(const std::string& key, const std::string& value) {\n      constructor_->Add(key, value);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::RandomSeed",
          "args": [],
          "line": 699
        },
        "resolved": true,
        "details": {
          "function_name": "RandomSeed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "67-74",
          "snippet": "int RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "kTestArgList[i]"
          ],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "441-467",
          "snippet": "void Init(const TestArgs& args) {\n    delete constructor_;\n    constructor_ = NULL;\n    options_ = Options();\n\n    options_.block_restart_interval = args.restart_interval;\n    // Use shorter block size for tests to exercise block boundary\n    // conditions more.\n    options_.block_size = 256;\n    if (args.reverse_compare) {\n      options_.comparator = &reverse_key_comparator;\n    }\n    switch (args.type) {\n      case TABLE_TEST:\n        constructor_ = new TableConstructor(options_.comparator);\n        break;\n      case BLOCK_TEST:\n        constructor_ = new BlockConstructor(options_.comparator);\n        break;\n      case MEMTABLE_TEST:\n        constructor_ = new MemTableConstructor(options_.comparator);\n        break;\n      case DB_TEST:\n        constructor_ = new DBConstructor(options_.comparator);\n        break;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Init(const TestArgs& args) {\n      delete constructor_;\n      constructor_ = NULL;\n      options_ = Options();\n  \n      options_.block_restart_interval = args.restart_interval;\n      // Use shorter block size for tests to exercise block boundary\n      // conditions more.\n      options_.block_size = 256;\n      if (args.reverse_compare) {\n        options_.comparator = &reverse_key_comparator;\n      }\n      switch (args.type) {\n        case TABLE_TEST:\n          constructor_ = new TableConstructor(options_.comparator);\n          break;\n        case BLOCK_TEST:\n          constructor_ = new BlockConstructor(options_.comparator);\n          break;\n        case MEMTABLE_TEST:\n          constructor_ = new MemTableConstructor(options_.comparator);\n          break;\n        case DB_TEST:\n          constructor_ = new DBConstructor(options_.comparator);\n          break;\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTEST(Harness, SimpleMulti) {\n  for (int i = 0; i < kNumTestArgs; i++) {\n    Init(kTestArgList[i]);\n    Random rnd(test::RandomSeed() + 3);\n    Add(\"abc\", \"v\");\n    Add(\"abcd\", \"v\");\n    Add(\"ac\", \"v2\");\n    Test(&rnd);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "687-694",
    "snippet": "TEST(Harness, SimpleSingle) {\n  for (int i = 0; i < kNumTestArgs; i++) {\n    Init(kTestArgList[i]);\n    Random rnd(test::RandomSeed() + 2);\n    Add(\"abc\", \"v\");\n    Test(&rnd);\n  }\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Test",
          "args": [
            "&rnd"
          ],
          "line": 692
        },
        "resolved": true,
        "details": {
          "function_name": "Test",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "477-485",
          "snippet": "void Test(Random* rnd) {\n    std::vector<std::string> keys;\n    KVMap data;\n    constructor_->Finish(options_, &keys, &data);\n\n    TestForwardScan(keys, data);\n    TestBackwardScan(keys, data);\n    TestRandomAccess(rnd, keys, data);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Test(Random* rnd) {\n      std::vector<std::string> keys;\n      KVMap data;\n      constructor_->Finish(options_, &keys, &data);\n  \n      TestForwardScan(keys, data);\n      TestBackwardScan(keys, data);\n      TestRandomAccess(rnd, keys, data);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Add",
          "args": [
            "\"abc\"",
            "\"v\""
          ],
          "line": 691
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "473-475",
          "snippet": "void Add(const std::string& key, const std::string& value) {\n    constructor_->Add(key, value);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Add(const std::string& key, const std::string& value) {\n      constructor_->Add(key, value);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::RandomSeed",
          "args": [],
          "line": 690
        },
        "resolved": true,
        "details": {
          "function_name": "RandomSeed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "67-74",
          "snippet": "int RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "kTestArgList[i]"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "441-467",
          "snippet": "void Init(const TestArgs& args) {\n    delete constructor_;\n    constructor_ = NULL;\n    options_ = Options();\n\n    options_.block_restart_interval = args.restart_interval;\n    // Use shorter block size for tests to exercise block boundary\n    // conditions more.\n    options_.block_size = 256;\n    if (args.reverse_compare) {\n      options_.comparator = &reverse_key_comparator;\n    }\n    switch (args.type) {\n      case TABLE_TEST:\n        constructor_ = new TableConstructor(options_.comparator);\n        break;\n      case BLOCK_TEST:\n        constructor_ = new BlockConstructor(options_.comparator);\n        break;\n      case MEMTABLE_TEST:\n        constructor_ = new MemTableConstructor(options_.comparator);\n        break;\n      case DB_TEST:\n        constructor_ = new DBConstructor(options_.comparator);\n        break;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Init(const TestArgs& args) {\n      delete constructor_;\n      constructor_ = NULL;\n      options_ = Options();\n  \n      options_.block_restart_interval = args.restart_interval;\n      // Use shorter block size for tests to exercise block boundary\n      // conditions more.\n      options_.block_size = 256;\n      if (args.reverse_compare) {\n        options_.comparator = &reverse_key_comparator;\n      }\n      switch (args.type) {\n        case TABLE_TEST:\n          constructor_ = new TableConstructor(options_.comparator);\n          break;\n        case BLOCK_TEST:\n          constructor_ = new BlockConstructor(options_.comparator);\n          break;\n        case MEMTABLE_TEST:\n          constructor_ = new MemTableConstructor(options_.comparator);\n          break;\n        case DB_TEST:\n          constructor_ = new DBConstructor(options_.comparator);\n          break;\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTEST(Harness, SimpleSingle) {\n  for (int i = 0; i < kNumTestArgs; i++) {\n    Init(kTestArgList[i]);\n    Random rnd(test::RandomSeed() + 2);\n    Add(\"abc\", \"v\");\n    Test(&rnd);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "678-685",
    "snippet": "TEST(Harness, SimpleEmptyKey) {\n  for (int i = 0; i < kNumTestArgs; i++) {\n    Init(kTestArgList[i]);\n    Random rnd(test::RandomSeed() + 1);\n    Add(\"\", \"v\");\n    Test(&rnd);\n  }\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Test",
          "args": [
            "&rnd"
          ],
          "line": 683
        },
        "resolved": true,
        "details": {
          "function_name": "Test",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "477-485",
          "snippet": "void Test(Random* rnd) {\n    std::vector<std::string> keys;\n    KVMap data;\n    constructor_->Finish(options_, &keys, &data);\n\n    TestForwardScan(keys, data);\n    TestBackwardScan(keys, data);\n    TestRandomAccess(rnd, keys, data);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Test(Random* rnd) {\n      std::vector<std::string> keys;\n      KVMap data;\n      constructor_->Finish(options_, &keys, &data);\n  \n      TestForwardScan(keys, data);\n      TestBackwardScan(keys, data);\n      TestRandomAccess(rnd, keys, data);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Add",
          "args": [
            "\"\"",
            "\"v\""
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "473-475",
          "snippet": "void Add(const std::string& key, const std::string& value) {\n    constructor_->Add(key, value);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Add(const std::string& key, const std::string& value) {\n      constructor_->Add(key, value);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::RandomSeed",
          "args": [],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "RandomSeed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "67-74",
          "snippet": "int RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "kTestArgList[i]"
          ],
          "line": 680
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "441-467",
          "snippet": "void Init(const TestArgs& args) {\n    delete constructor_;\n    constructor_ = NULL;\n    options_ = Options();\n\n    options_.block_restart_interval = args.restart_interval;\n    // Use shorter block size for tests to exercise block boundary\n    // conditions more.\n    options_.block_size = 256;\n    if (args.reverse_compare) {\n      options_.comparator = &reverse_key_comparator;\n    }\n    switch (args.type) {\n      case TABLE_TEST:\n        constructor_ = new TableConstructor(options_.comparator);\n        break;\n      case BLOCK_TEST:\n        constructor_ = new BlockConstructor(options_.comparator);\n        break;\n      case MEMTABLE_TEST:\n        constructor_ = new MemTableConstructor(options_.comparator);\n        break;\n      case DB_TEST:\n        constructor_ = new DBConstructor(options_.comparator);\n        break;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Init(const TestArgs& args) {\n      delete constructor_;\n      constructor_ = NULL;\n      options_ = Options();\n  \n      options_.block_restart_interval = args.restart_interval;\n      // Use shorter block size for tests to exercise block boundary\n      // conditions more.\n      options_.block_size = 256;\n      if (args.reverse_compare) {\n        options_.comparator = &reverse_key_comparator;\n      }\n      switch (args.type) {\n        case TABLE_TEST:\n          constructor_ = new TableConstructor(options_.comparator);\n          break;\n        case BLOCK_TEST:\n          constructor_ = new BlockConstructor(options_.comparator);\n          break;\n        case MEMTABLE_TEST:\n          constructor_ = new MemTableConstructor(options_.comparator);\n          break;\n        case DB_TEST:\n          constructor_ = new DBConstructor(options_.comparator);\n          break;\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTEST(Harness, SimpleEmptyKey) {\n  for (int i = 0; i < kNumTestArgs; i++) {\n    Init(kTestArgList[i]);\n    Random rnd(test::RandomSeed() + 1);\n    Add(\"\", \"v\");\n    Test(&rnd);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "659-675",
    "snippet": "TEST(Harness, ZeroRestartPointsInBlock) {\n  char data[sizeof(uint32_t)];\n  memset(data, 0, sizeof(data));\n  BlockContents contents;\n  contents.data = Slice(data, sizeof(data));\n  contents.cachable = false;\n  contents.heap_allocated = false;\n  Block block(contents);\n  Iterator* iter = block.NewIterator(BytewiseComparator());\n  iter->SeekToFirst();\n  ASSERT_TRUE(!iter->Valid());\n  iter->SeekToLast();\n  ASSERT_TRUE(!iter->Valid());\n  iter->Seek(\"foo\");\n  ASSERT_TRUE(!iter->Valid());\n  delete iter;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter->Valid()"
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Valid",
          "args": [],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "280-280",
          "snippet": "virtual bool Valid() const { return iter_->Valid(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual bool Valid() const { return iter_->Valid(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Seek",
          "args": [
            "\"foo\""
          ],
          "line": 672
        },
        "resolved": true,
        "details": {
          "function_name": "Seek",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "281-286",
          "snippet": "virtual void Seek(const Slice& target) {\n    ParsedInternalKey ikey(target, kMaxSequenceNumber, kTypeValue);\n    std::string encoded;\n    AppendInternalKey(&encoded, ikey);\n    iter_->Seek(encoded);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void Seek(const Slice& target) {\n      ParsedInternalKey ikey(target, kMaxSequenceNumber, kTypeValue);\n      std::string encoded;\n      AppendInternalKey(&encoded, ikey);\n      iter_->Seek(encoded);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter->Valid()"
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->SeekToLast",
          "args": [],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToLast",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "288-288",
          "snippet": "virtual void SeekToLast() { iter_->SeekToLast(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void SeekToLast() { iter_->SeekToLast(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter->Valid()"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->SeekToFirst",
          "args": [],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "287-287",
          "snippet": "virtual void SeekToFirst() { iter_->SeekToFirst(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void SeekToFirst() { iter_->SeekToFirst(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "block.NewIterator",
          "args": [
            "BytewiseComparator()"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "BytewiseComparatorImpl",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "19-19",
          "snippet": "BytewiseComparatorImpl() { }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  BytewiseComparatorImpl() { }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "data",
            "sizeof(data)"
          ],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "data",
            "0",
            "sizeof(data)"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTEST(Harness, ZeroRestartPointsInBlock) {\n  char data[sizeof(uint32_t)];\n  memset(data, 0, sizeof(data));\n  BlockContents contents;\n  contents.data = Slice(data, sizeof(data));\n  contents.cachable = false;\n  contents.heap_allocated = false;\n  Block block(contents);\n  Iterator* iter = block.NewIterator(BytewiseComparator());\n  iter->SeekToFirst();\n  ASSERT_TRUE(!iter->Valid());\n  iter->SeekToLast();\n  ASSERT_TRUE(!iter->Valid());\n  iter->Seek(\"foo\");\n  ASSERT_TRUE(!iter->Valid());\n  delete iter;\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "648-654",
    "snippet": "TEST(Harness, Empty) {\n  for (int i = 0; i < kNumTestArgs; i++) {\n    Init(kTestArgList[i]);\n    Random rnd(test::RandomSeed() + 1);\n    Test(&rnd);\n  }\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Test",
          "args": [
            "&rnd"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "Test",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "477-485",
          "snippet": "void Test(Random* rnd) {\n    std::vector<std::string> keys;\n    KVMap data;\n    constructor_->Finish(options_, &keys, &data);\n\n    TestForwardScan(keys, data);\n    TestBackwardScan(keys, data);\n    TestRandomAccess(rnd, keys, data);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Test(Random* rnd) {\n      std::vector<std::string> keys;\n      KVMap data;\n      constructor_->Finish(options_, &keys, &data);\n  \n      TestForwardScan(keys, data);\n      TestBackwardScan(keys, data);\n      TestRandomAccess(rnd, keys, data);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::RandomSeed",
          "args": [],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "RandomSeed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "67-74",
          "snippet": "int RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "kTestArgList[i]"
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "441-467",
          "snippet": "void Init(const TestArgs& args) {\n    delete constructor_;\n    constructor_ = NULL;\n    options_ = Options();\n\n    options_.block_restart_interval = args.restart_interval;\n    // Use shorter block size for tests to exercise block boundary\n    // conditions more.\n    options_.block_size = 256;\n    if (args.reverse_compare) {\n      options_.comparator = &reverse_key_comparator;\n    }\n    switch (args.type) {\n      case TABLE_TEST:\n        constructor_ = new TableConstructor(options_.comparator);\n        break;\n      case BLOCK_TEST:\n        constructor_ = new BlockConstructor(options_.comparator);\n        break;\n      case MEMTABLE_TEST:\n        constructor_ = new MemTableConstructor(options_.comparator);\n        break;\n      case DB_TEST:\n        constructor_ = new DBConstructor(options_.comparator);\n        break;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Init(const TestArgs& args) {\n      delete constructor_;\n      constructor_ = NULL;\n      options_ = Options();\n  \n      options_.block_restart_interval = args.restart_interval;\n      // Use shorter block size for tests to exercise block boundary\n      // conditions more.\n      options_.block_size = 256;\n      if (args.reverse_compare) {\n        options_.comparator = &reverse_key_comparator;\n      }\n      switch (args.type) {\n        case TABLE_TEST:\n          constructor_ = new TableConstructor(options_.comparator);\n          break;\n        case BLOCK_TEST:\n          constructor_ = new BlockConstructor(options_.comparator);\n          break;\n        case MEMTABLE_TEST:\n          constructor_ = new MemTableConstructor(options_.comparator);\n          break;\n        case DB_TEST:\n          constructor_ = new DBConstructor(options_.comparator);\n          break;\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTEST(Harness, Empty) {\n  for (int i = 0; i < kNumTestArgs; i++) {\n    Init(kTestArgList[i]);\n    Random rnd(test::RandomSeed() + 1);\n    Test(&rnd);\n  }\n}"
  },
  {
    "function_name": "PickRandomKey",
    "container": "Harness",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "612-637",
    "snippet": "std::string PickRandomKey(Random* rnd, const std::vector<std::string>& keys) {\n    if (keys.empty()) {\n      return \"foo\";\n    } else {\n      const int index = rnd->Uniform(keys.size());\n      std::string result = keys[index];\n      switch (rnd->Uniform(3)) {\n        case 0:\n          // Return an existing key\n          break;\n        case 1: {\n          // Attempt to return something smaller than an existing key\n          if (result.size() > 0 && result[result.size()-1] > '\\0') {\n            result[result.size()-1]--;\n          }\n          break;\n        }\n        case 2: {\n          // Return something larger than an existing key\n          Increment(options_.comparator, &result);\n          break;\n        }\n      }\n      return result;\n    }\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Increment",
          "args": [
            "options_.comparator",
            "&result"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "Increment",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "66-75",
          "snippet": "static void Increment(const Comparator* cmp, std::string* key) {\n  if (cmp == BytewiseComparator()) {\n    key->push_back('\\0');\n  } else {\n    assert(cmp == &reverse_key_comparator);\n    std::string rev = Reverse(*key);\n    rev.push_back('\\0');\n    *key = Reverse(rev);\n  }\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nstatic void Increment(const Comparator* cmp, std::string* key) {\n  if (cmp == BytewiseComparator()) {\n    key->push_back('\\0');\n  } else {\n    assert(cmp == &reverse_key_comparator);\n    std::string rev = Reverse(*key);\n    rev.push_back('\\0');\n    *key = Reverse(rev);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.size",
          "args": [],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "BlockHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/format.h",
          "lines": "31-31",
          "snippet": "uint64_t size() const { return size_; }",
          "includes": [
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <stdint.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/table_builder.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/slice.h\"\n#include <stdint.h>\n#include <string>\n\nBlockHandle {\n  uint64_t size() const { return size_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rnd->Uniform",
          "args": [
            "3"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "Uniform",
          "container": "Random",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/random.h",
          "lines": "48-48",
          "snippet": "uint32_t Uniform(int n) { return Next() % n; }",
          "includes": [
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n\nRandom {\n  uint32_t Uniform(int n) { return Next() % n; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "keys.empty",
          "args": [],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "BlockBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/block_builder.h",
          "lines": "38-40",
          "snippet": "bool empty() const {\n    return buffer_.empty();\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <stdint.h>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <stdint.h>\n#include <vector>\n\nBlockBuilder {\n  bool empty() const {\n      return buffer_.empty();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string PickRandomKey(Random* rnd, const std::vector<std::string>& keys) {\n      if (keys.empty()) {\n        return \"foo\";\n      } else {\n        const int index = rnd->Uniform(keys.size());\n        std::string result = keys[index];\n        switch (rnd->Uniform(3)) {\n          case 0:\n            // Return an existing key\n            break;\n          case 1: {\n            // Attempt to return something smaller than an existing key\n            if (result.size() > 0 && result[result.size()-1] > '\\0') {\n              result[result.size()-1]--;\n            }\n            break;\n          }\n          case 2: {\n            // Return something larger than an existing key\n            Increment(options_.comparator, &result);\n            break;\n          }\n        }\n        return result;\n      }\n    }\n}"
  },
  {
    "function_name": "ToString",
    "container": "Harness",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "604-610",
    "snippet": "std::string ToString(const Iterator* it) {\n    if (!it->Valid()) {\n      return \"END\";\n    } else {\n      return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n    }\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "it->value",
          "args": [],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "302-302",
          "snippet": "virtual Slice value() const { return iter_->value(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual Slice value() const { return iter_->value(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "it->key",
          "args": [],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "292-300",
          "snippet": "virtual Slice key() const {\n    assert(Valid());\n    ParsedInternalKey key;\n    if (!ParseInternalKey(iter_->key(), &key)) {\n      status_ = Status::Corruption(\"malformed internal key\");\n      return Slice(\"corrupted key\");\n    }\n    return key.user_key;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual Slice key() const {\n      assert(Valid());\n      ParsedInternalKey key;\n      if (!ParseInternalKey(iter_->key(), &key)) {\n        status_ = Status::Corruption(\"malformed internal key\");\n        return Slice(\"corrupted key\");\n      }\n      return key.user_key;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "it->Valid",
          "args": [],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "280-280",
          "snippet": "virtual bool Valid() const { return iter_->Valid(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual bool Valid() const { return iter_->Valid(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string ToString(const Iterator* it) {\n      if (!it->Valid()) {\n        return \"END\";\n      } else {\n        return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n      }\n    }\n}"
  },
  {
    "function_name": "ToString",
    "container": "Harness",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "595-602",
    "snippet": "std::string ToString(const KVMap& data,\n                       const KVMap::const_reverse_iterator& it) {\n    if (it == data.rend()) {\n      return \"END\";\n    } else {\n      return \"'\" + it->first + \"->\" + it->second + \"'\";\n    }\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "data.rend",
          "args": [],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string ToString(const KVMap& data,\n                         const KVMap::const_reverse_iterator& it) {\n      if (it == data.rend()) {\n        return \"END\";\n      } else {\n        return \"'\" + it->first + \"->\" + it->second + \"'\";\n      }\n    }\n}"
  },
  {
    "function_name": "ToString",
    "container": "Harness",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "587-593",
    "snippet": "std::string ToString(const KVMap& data, const KVMap::const_iterator& it) {\n    if (it == data.end()) {\n      return \"END\";\n    } else {\n      return \"'\" + it->first + \"->\" + it->second + \"'\";\n    }\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "data.end",
          "args": [],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string ToString(const KVMap& data, const KVMap::const_iterator& it) {\n      if (it == data.end()) {\n        return \"END\";\n      } else {\n        return \"'\" + it->first + \"->\" + it->second + \"'\";\n      }\n    }\n}"
  },
  {
    "function_name": "TestRandomAccess",
    "container": "Harness",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "517-585",
    "snippet": "void TestRandomAccess(Random* rnd,\n                        const std::vector<std::string>& keys,\n                        const KVMap& data) {\n    static const bool kVerbose = false;\n    Iterator* iter = constructor_->NewIterator();\n    ASSERT_TRUE(!iter->Valid());\n    KVMap::const_iterator model_iter = data.begin();\n    if (kVerbose) fprintf(stderr, \"---\\n\");\n    for (int i = 0; i < 200; i++) {\n      const int toss = rnd->Uniform(5);\n      switch (toss) {\n        case 0: {\n          if (iter->Valid()) {\n            if (kVerbose) fprintf(stderr, \"Next\\n\");\n            iter->Next();\n            ++model_iter;\n            ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n          }\n          break;\n        }\n\n        case 1: {\n          if (kVerbose) fprintf(stderr, \"SeekToFirst\\n\");\n          iter->SeekToFirst();\n          model_iter = data.begin();\n          ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n          break;\n        }\n\n        case 2: {\n          std::string key = PickRandomKey(rnd, keys);\n          model_iter = data.lower_bound(key);\n          if (kVerbose) fprintf(stderr, \"Seek '%s'\\n\",\n                                EscapeString(key).c_str());\n          iter->Seek(Slice(key));\n          ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n          break;\n        }\n\n        case 3: {\n          if (iter->Valid()) {\n            if (kVerbose) fprintf(stderr, \"Prev\\n\");\n            iter->Prev();\n            if (model_iter == data.begin()) {\n              model_iter = data.end();   // Wrap around to invalid value\n            } else {\n              --model_iter;\n            }\n            ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n          }\n          break;\n        }\n\n        case 4: {\n          if (kVerbose) fprintf(stderr, \"SeekToLast\\n\");\n          iter->SeekToLast();\n          if (keys.empty()) {\n            model_iter = data.end();\n          } else {\n            std::string last = data.rbegin()->first;\n            model_iter = data.lower_bound(last);\n          }\n          ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n          break;\n        }\n      }\n    }\n    delete iter;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "ToString(data, model_iter)",
            "ToString(iter)"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [
            "iter"
          ],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "604-610",
          "snippet": "std::string ToString(const Iterator* it) {\n    if (!it->Valid()) {\n      return \"END\";\n    } else {\n      return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string ToString(const Iterator* it) {\n      if (!it->Valid()) {\n        return \"END\";\n      } else {\n        return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.lower_bound",
          "args": [
            "last"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.rbegin",
          "args": [],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.end",
          "args": [],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "keys.empty",
          "args": [],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "BlockBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/block_builder.h",
          "lines": "38-40",
          "snippet": "bool empty() const {\n    return buffer_.empty();\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <stdint.h>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <stdint.h>\n#include <vector>\n\nBlockBuilder {\n  bool empty() const {\n      return buffer_.empty();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->SeekToLast",
          "args": [],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToLast",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "288-288",
          "snippet": "virtual void SeekToLast() { iter_->SeekToLast(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void SeekToLast() { iter_->SeekToLast(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"SeekToLast\\n\""
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "ToString(data, model_iter)",
            "ToString(iter)"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.begin",
          "args": [],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Prev",
          "args": [],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "Prev",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "290-290",
          "snippet": "virtual void Prev() { iter_->Prev(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void Prev() { iter_->Prev(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Prev\\n\""
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Valid",
          "args": [],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "280-280",
          "snippet": "virtual bool Valid() const { return iter_->Valid(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual bool Valid() const { return iter_->Valid(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "ToString(data, model_iter)",
            "ToString(iter)"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Seek",
          "args": [
            "Slice(key)"
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "Seek",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "281-286",
          "snippet": "virtual void Seek(const Slice& target) {\n    ParsedInternalKey ikey(target, kMaxSequenceNumber, kTypeValue);\n    std::string encoded;\n    AppendInternalKey(&encoded, ikey);\n    iter_->Seek(encoded);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void Seek(const Slice& target) {\n      ParsedInternalKey ikey(target, kMaxSequenceNumber, kTypeValue);\n      std::string encoded;\n      AppendInternalKey(&encoded, ikey);\n      iter_->Seek(encoded);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "key"
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "HashSlice",
          "container": "ShardedLRUCache",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "276-278",
          "snippet": "static inline uint32_t HashSlice(const Slice& s) {\n    return Hash(s.data(), s.size(), 0);\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nShardedLRUCache {\n  static inline uint32_t HashSlice(const Slice& s) {\n      return Hash(s.data(), s.size(), 0);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Seek '%s'\\n\"",
            "EscapeString(key).c_str()"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EscapeString",
          "args": [],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EscapeString",
          "args": [
            "key"
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "EscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
          "lines": "42-46",
          "snippet": "std::string EscapeString(const Slice& value) {\n  std::string r;\n  AppendEscapedStringTo(&r, value);\n  return r;\n}",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"util/logging.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nstd::string EscapeString(const Slice& value) {\n  std::string r;\n  AppendEscapedStringTo(&r, value);\n  return r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.lower_bound",
          "args": [
            "key"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PickRandomKey",
          "args": [
            "rnd",
            "keys"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "PickRandomKey",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "612-637",
          "snippet": "std::string PickRandomKey(Random* rnd, const std::vector<std::string>& keys) {\n    if (keys.empty()) {\n      return \"foo\";\n    } else {\n      const int index = rnd->Uniform(keys.size());\n      std::string result = keys[index];\n      switch (rnd->Uniform(3)) {\n        case 0:\n          // Return an existing key\n          break;\n        case 1: {\n          // Attempt to return something smaller than an existing key\n          if (result.size() > 0 && result[result.size()-1] > '\\0') {\n            result[result.size()-1]--;\n          }\n          break;\n        }\n        case 2: {\n          // Return something larger than an existing key\n          Increment(options_.comparator, &result);\n          break;\n        }\n      }\n      return result;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string PickRandomKey(Random* rnd, const std::vector<std::string>& keys) {\n      if (keys.empty()) {\n        return \"foo\";\n      } else {\n        const int index = rnd->Uniform(keys.size());\n        std::string result = keys[index];\n        switch (rnd->Uniform(3)) {\n          case 0:\n            // Return an existing key\n            break;\n          case 1: {\n            // Attempt to return something smaller than an existing key\n            if (result.size() > 0 && result[result.size()-1] > '\\0') {\n              result[result.size()-1]--;\n            }\n            break;\n          }\n          case 2: {\n            // Return something larger than an existing key\n            Increment(options_.comparator, &result);\n            break;\n          }\n        }\n        return result;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "ToString(data, model_iter)",
            "ToString(iter)"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->SeekToFirst",
          "args": [],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "287-287",
          "snippet": "virtual void SeekToFirst() { iter_->SeekToFirst(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void SeekToFirst() { iter_->SeekToFirst(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"SeekToFirst\\n\""
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "ToString(data, model_iter)",
            "ToString(iter)"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Next",
          "args": [],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "289-289",
          "snippet": "virtual void Next() { iter_->Next(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void Next() { iter_->Next(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Next\\n\""
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rnd->Uniform",
          "args": [
            "5"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "Uniform",
          "container": "Random",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/random.h",
          "lines": "48-48",
          "snippet": "uint32_t Uniform(int n) { return Next() % n; }",
          "includes": [
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n\nRandom {\n  uint32_t Uniform(int n) { return Next() % n; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"---\\n\""
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter->Valid()"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "constructor_->NewIterator",
          "args": [],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void TestRandomAccess(Random* rnd,\n                          const std::vector<std::string>& keys,\n                          const KVMap& data) {\n      static const bool kVerbose = false;\n      Iterator* iter = constructor_->NewIterator();\n      ASSERT_TRUE(!iter->Valid());\n      KVMap::const_iterator model_iter = data.begin();\n      if (kVerbose) fprintf(stderr, \"---\\n\");\n      for (int i = 0; i < 200; i++) {\n        const int toss = rnd->Uniform(5);\n        switch (toss) {\n          case 0: {\n            if (iter->Valid()) {\n              if (kVerbose) fprintf(stderr, \"Next\\n\");\n              iter->Next();\n              ++model_iter;\n              ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n            }\n            break;\n          }\n  \n          case 1: {\n            if (kVerbose) fprintf(stderr, \"SeekToFirst\\n\");\n            iter->SeekToFirst();\n            model_iter = data.begin();\n            ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n            break;\n          }\n  \n          case 2: {\n            std::string key = PickRandomKey(rnd, keys);\n            model_iter = data.lower_bound(key);\n            if (kVerbose) fprintf(stderr, \"Seek '%s'\\n\",\n                                  EscapeString(key).c_str());\n            iter->Seek(Slice(key));\n            ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n            break;\n          }\n  \n          case 3: {\n            if (iter->Valid()) {\n              if (kVerbose) fprintf(stderr, \"Prev\\n\");\n              iter->Prev();\n              if (model_iter == data.begin()) {\n                model_iter = data.end();   // Wrap around to invalid value\n              } else {\n                --model_iter;\n              }\n              ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n            }\n            break;\n          }\n  \n          case 4: {\n            if (kVerbose) fprintf(stderr, \"SeekToLast\\n\");\n            iter->SeekToLast();\n            if (keys.empty()) {\n              model_iter = data.end();\n            } else {\n              std::string last = data.rbegin()->first;\n              model_iter = data.lower_bound(last);\n            }\n            ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n            break;\n          }\n        }\n      }\n      delete iter;\n    }\n}"
  },
  {
    "function_name": "TestBackwardScan",
    "container": "Harness",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "502-515",
    "snippet": "void TestBackwardScan(const std::vector<std::string>& keys,\n                        const KVMap& data) {\n    Iterator* iter = constructor_->NewIterator();\n    ASSERT_TRUE(!iter->Valid());\n    iter->SeekToLast();\n    for (KVMap::const_reverse_iterator model_iter = data.rbegin();\n         model_iter != data.rend();\n         ++model_iter) {\n      ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n      iter->Prev();\n    }\n    ASSERT_TRUE(!iter->Valid());\n    delete iter;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter->Valid()"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Valid",
          "args": [],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "280-280",
          "snippet": "virtual bool Valid() const { return iter_->Valid(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual bool Valid() const { return iter_->Valid(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Prev",
          "args": [],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "Prev",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "290-290",
          "snippet": "virtual void Prev() { iter_->Prev(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void Prev() { iter_->Prev(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "ToString(data, model_iter)",
            "ToString(iter)"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [
            "iter"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "604-610",
          "snippet": "std::string ToString(const Iterator* it) {\n    if (!it->Valid()) {\n      return \"END\";\n    } else {\n      return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string ToString(const Iterator* it) {\n      if (!it->Valid()) {\n        return \"END\";\n      } else {\n        return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.rend",
          "args": [],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.rbegin",
          "args": [],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->SeekToLast",
          "args": [],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToLast",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "288-288",
          "snippet": "virtual void SeekToLast() { iter_->SeekToLast(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void SeekToLast() { iter_->SeekToLast(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter->Valid()"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "constructor_->NewIterator",
          "args": [],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void TestBackwardScan(const std::vector<std::string>& keys,\n                          const KVMap& data) {\n      Iterator* iter = constructor_->NewIterator();\n      ASSERT_TRUE(!iter->Valid());\n      iter->SeekToLast();\n      for (KVMap::const_reverse_iterator model_iter = data.rbegin();\n           model_iter != data.rend();\n           ++model_iter) {\n        ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n        iter->Prev();\n      }\n      ASSERT_TRUE(!iter->Valid());\n      delete iter;\n    }\n}"
  },
  {
    "function_name": "TestForwardScan",
    "container": "Harness",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "487-500",
    "snippet": "void TestForwardScan(const std::vector<std::string>& keys,\n                       const KVMap& data) {\n    Iterator* iter = constructor_->NewIterator();\n    ASSERT_TRUE(!iter->Valid());\n    iter->SeekToFirst();\n    for (KVMap::const_iterator model_iter = data.begin();\n         model_iter != data.end();\n         ++model_iter) {\n      ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n      iter->Next();\n    }\n    ASSERT_TRUE(!iter->Valid());\n    delete iter;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter->Valid()"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Valid",
          "args": [],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "280-280",
          "snippet": "virtual bool Valid() const { return iter_->Valid(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual bool Valid() const { return iter_->Valid(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Next",
          "args": [],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "289-289",
          "snippet": "virtual void Next() { iter_->Next(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void Next() { iter_->Next(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "ToString(data, model_iter)",
            "ToString(iter)"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [
            "iter"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "604-610",
          "snippet": "std::string ToString(const Iterator* it) {\n    if (!it->Valid()) {\n      return \"END\";\n    } else {\n      return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string ToString(const Iterator* it) {\n      if (!it->Valid()) {\n        return \"END\";\n      } else {\n        return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.end",
          "args": [],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.begin",
          "args": [],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->SeekToFirst",
          "args": [],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "287-287",
          "snippet": "virtual void SeekToFirst() { iter_->SeekToFirst(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void SeekToFirst() { iter_->SeekToFirst(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter->Valid()"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "constructor_->NewIterator",
          "args": [],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void TestForwardScan(const std::vector<std::string>& keys,\n                         const KVMap& data) {\n      Iterator* iter = constructor_->NewIterator();\n      ASSERT_TRUE(!iter->Valid());\n      iter->SeekToFirst();\n      for (KVMap::const_iterator model_iter = data.begin();\n           model_iter != data.end();\n           ++model_iter) {\n        ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n        iter->Next();\n      }\n      ASSERT_TRUE(!iter->Valid());\n      delete iter;\n    }\n}"
  },
  {
    "function_name": "Test",
    "container": "Harness",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "477-485",
    "snippet": "void Test(Random* rnd) {\n    std::vector<std::string> keys;\n    KVMap data;\n    constructor_->Finish(options_, &keys, &data);\n\n    TestForwardScan(keys, data);\n    TestBackwardScan(keys, data);\n    TestRandomAccess(rnd, keys, data);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TestRandomAccess",
          "args": [
            "rnd",
            "keys",
            "data"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "TestRandomAccess",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "517-585",
          "snippet": "void TestRandomAccess(Random* rnd,\n                        const std::vector<std::string>& keys,\n                        const KVMap& data) {\n    static const bool kVerbose = false;\n    Iterator* iter = constructor_->NewIterator();\n    ASSERT_TRUE(!iter->Valid());\n    KVMap::const_iterator model_iter = data.begin();\n    if (kVerbose) fprintf(stderr, \"---\\n\");\n    for (int i = 0; i < 200; i++) {\n      const int toss = rnd->Uniform(5);\n      switch (toss) {\n        case 0: {\n          if (iter->Valid()) {\n            if (kVerbose) fprintf(stderr, \"Next\\n\");\n            iter->Next();\n            ++model_iter;\n            ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n          }\n          break;\n        }\n\n        case 1: {\n          if (kVerbose) fprintf(stderr, \"SeekToFirst\\n\");\n          iter->SeekToFirst();\n          model_iter = data.begin();\n          ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n          break;\n        }\n\n        case 2: {\n          std::string key = PickRandomKey(rnd, keys);\n          model_iter = data.lower_bound(key);\n          if (kVerbose) fprintf(stderr, \"Seek '%s'\\n\",\n                                EscapeString(key).c_str());\n          iter->Seek(Slice(key));\n          ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n          break;\n        }\n\n        case 3: {\n          if (iter->Valid()) {\n            if (kVerbose) fprintf(stderr, \"Prev\\n\");\n            iter->Prev();\n            if (model_iter == data.begin()) {\n              model_iter = data.end();   // Wrap around to invalid value\n            } else {\n              --model_iter;\n            }\n            ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n          }\n          break;\n        }\n\n        case 4: {\n          if (kVerbose) fprintf(stderr, \"SeekToLast\\n\");\n          iter->SeekToLast();\n          if (keys.empty()) {\n            model_iter = data.end();\n          } else {\n            std::string last = data.rbegin()->first;\n            model_iter = data.lower_bound(last);\n          }\n          ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n          break;\n        }\n      }\n    }\n    delete iter;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void TestRandomAccess(Random* rnd,\n                          const std::vector<std::string>& keys,\n                          const KVMap& data) {\n      static const bool kVerbose = false;\n      Iterator* iter = constructor_->NewIterator();\n      ASSERT_TRUE(!iter->Valid());\n      KVMap::const_iterator model_iter = data.begin();\n      if (kVerbose) fprintf(stderr, \"---\\n\");\n      for (int i = 0; i < 200; i++) {\n        const int toss = rnd->Uniform(5);\n        switch (toss) {\n          case 0: {\n            if (iter->Valid()) {\n              if (kVerbose) fprintf(stderr, \"Next\\n\");\n              iter->Next();\n              ++model_iter;\n              ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n            }\n            break;\n          }\n  \n          case 1: {\n            if (kVerbose) fprintf(stderr, \"SeekToFirst\\n\");\n            iter->SeekToFirst();\n            model_iter = data.begin();\n            ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n            break;\n          }\n  \n          case 2: {\n            std::string key = PickRandomKey(rnd, keys);\n            model_iter = data.lower_bound(key);\n            if (kVerbose) fprintf(stderr, \"Seek '%s'\\n\",\n                                  EscapeString(key).c_str());\n            iter->Seek(Slice(key));\n            ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n            break;\n          }\n  \n          case 3: {\n            if (iter->Valid()) {\n              if (kVerbose) fprintf(stderr, \"Prev\\n\");\n              iter->Prev();\n              if (model_iter == data.begin()) {\n                model_iter = data.end();   // Wrap around to invalid value\n              } else {\n                --model_iter;\n              }\n              ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n            }\n            break;\n          }\n  \n          case 4: {\n            if (kVerbose) fprintf(stderr, \"SeekToLast\\n\");\n            iter->SeekToLast();\n            if (keys.empty()) {\n              model_iter = data.end();\n            } else {\n              std::string last = data.rbegin()->first;\n              model_iter = data.lower_bound(last);\n            }\n            ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n            break;\n          }\n        }\n      }\n      delete iter;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TestBackwardScan",
          "args": [
            "keys",
            "data"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "TestBackwardScan",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "502-515",
          "snippet": "void TestBackwardScan(const std::vector<std::string>& keys,\n                        const KVMap& data) {\n    Iterator* iter = constructor_->NewIterator();\n    ASSERT_TRUE(!iter->Valid());\n    iter->SeekToLast();\n    for (KVMap::const_reverse_iterator model_iter = data.rbegin();\n         model_iter != data.rend();\n         ++model_iter) {\n      ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n      iter->Prev();\n    }\n    ASSERT_TRUE(!iter->Valid());\n    delete iter;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void TestBackwardScan(const std::vector<std::string>& keys,\n                          const KVMap& data) {\n      Iterator* iter = constructor_->NewIterator();\n      ASSERT_TRUE(!iter->Valid());\n      iter->SeekToLast();\n      for (KVMap::const_reverse_iterator model_iter = data.rbegin();\n           model_iter != data.rend();\n           ++model_iter) {\n        ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n        iter->Prev();\n      }\n      ASSERT_TRUE(!iter->Valid());\n      delete iter;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TestForwardScan",
          "args": [
            "keys",
            "data"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "TestForwardScan",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "487-500",
          "snippet": "void TestForwardScan(const std::vector<std::string>& keys,\n                       const KVMap& data) {\n    Iterator* iter = constructor_->NewIterator();\n    ASSERT_TRUE(!iter->Valid());\n    iter->SeekToFirst();\n    for (KVMap::const_iterator model_iter = data.begin();\n         model_iter != data.end();\n         ++model_iter) {\n      ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n      iter->Next();\n    }\n    ASSERT_TRUE(!iter->Valid());\n    delete iter;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void TestForwardScan(const std::vector<std::string>& keys,\n                         const KVMap& data) {\n      Iterator* iter = constructor_->NewIterator();\n      ASSERT_TRUE(!iter->Valid());\n      iter->SeekToFirst();\n      for (KVMap::const_iterator model_iter = data.begin();\n           model_iter != data.end();\n           ++model_iter) {\n        ASSERT_EQ(ToString(data, model_iter), ToString(iter));\n        iter->Next();\n      }\n      ASSERT_TRUE(!iter->Valid());\n      delete iter;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "constructor_->Finish",
          "args": [
            "options_",
            "&keys",
            "&data"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "Finish",
          "container": "Constructor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "153-166",
          "snippet": "void Finish(const Options& options,\n              std::vector<std::string>* keys,\n              KVMap* kvmap) {\n    *kvmap = data_;\n    keys->clear();\n    for (KVMap::const_iterator it = data_.begin();\n         it != data_.end();\n         ++it) {\n      keys->push_back(it->first);\n    }\n    data_.clear();\n    Status s = FinishImpl(options, *kvmap);\n    ASSERT_TRUE(s.ok()) << s.ToString();\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nConstructor {\n  void Finish(const Options& options,\n                std::vector<std::string>* keys,\n                KVMap* kvmap) {\n      *kvmap = data_;\n      keys->clear();\n      for (KVMap::const_iterator it = data_.begin();\n           it != data_.end();\n           ++it) {\n        keys->push_back(it->first);\n      }\n      data_.clear();\n      Status s = FinishImpl(options, *kvmap);\n      ASSERT_TRUE(s.ok()) << s.ToString();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Test(Random* rnd) {\n      std::vector<std::string> keys;\n      KVMap data;\n      constructor_->Finish(options_, &keys, &data);\n  \n      TestForwardScan(keys, data);\n      TestBackwardScan(keys, data);\n      TestRandomAccess(rnd, keys, data);\n    }\n}"
  },
  {
    "function_name": "Add",
    "container": "Harness",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "473-475",
    "snippet": "void Add(const std::string& key, const std::string& value) {\n    constructor_->Add(key, value);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "constructor_->Add",
          "args": [
            "key",
            "value"
          ],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "473-475",
          "snippet": "void Add(const std::string& key, const std::string& value) {\n    constructor_->Add(key, value);\n  }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Add(const std::string& key, const std::string& value) {\n      constructor_->Add(key, value);\n    }\n}"
  },
  {
    "function_name": "Init",
    "container": "Harness",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "441-467",
    "snippet": "void Init(const TestArgs& args) {\n    delete constructor_;\n    constructor_ = NULL;\n    options_ = Options();\n\n    options_.block_restart_interval = args.restart_interval;\n    // Use shorter block size for tests to exercise block boundary\n    // conditions more.\n    options_.block_size = 256;\n    if (args.reverse_compare) {\n      options_.comparator = &reverse_key_comparator;\n    }\n    switch (args.type) {\n      case TABLE_TEST:\n        constructor_ = new TableConstructor(options_.comparator);\n        break;\n      case BLOCK_TEST:\n        constructor_ = new BlockConstructor(options_.comparator);\n        break;\n      case MEMTABLE_TEST:\n        constructor_ = new MemTableConstructor(options_.comparator);\n        break;\n      case DB_TEST:\n        constructor_ = new DBConstructor(options_.comparator);\n        break;\n    }\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Options",
          "args": [],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "GetOptions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/txdb-leveldb.cpp",
          "lines": "28-34",
          "snippet": "static leveldb::Options GetOptions() {\n    leveldb::Options options;\n    int nCacheSizeMB = GetArg(\"-dbcache\", 25);\n    options.block_cache = leveldb::NewLRUCache(nCacheSizeMB * 1048576);\n    options.filter_policy = leveldb::NewBloomFilterPolicy(10);\n    return options;\n}",
          "includes": [
            "#include \"main.h\"",
            "#include \"util.h\"",
            "#include \"txdb.h\"",
            "#include \"checkpoints.h\"",
            "#include \"kernel.h\"",
            "#include <memenv/memenv.h>",
            "#include <leveldb/filter_policy.h>",
            "#include <leveldb/cache.h>",
            "#include <leveldb/env.h>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/version.hpp>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"main.h\"\n#include \"util.h\"\n#include \"txdb.h\"\n#include \"checkpoints.h\"\n#include \"kernel.h\"\n#include <memenv/memenv.h>\n#include <leveldb/filter_policy.h>\n#include <leveldb/cache.h>\n#include <leveldb/env.h>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/version.hpp>\n#include <map>\n\nstatic leveldb::Options GetOptions() {\n    leveldb::Options options;\n    int nCacheSizeMB = GetArg(\"-dbcache\", 25);\n    options.block_cache = leveldb::NewLRUCache(nCacheSizeMB * 1048576);\n    options.filter_policy = leveldb::NewBloomFilterPolicy(10);\n    return options;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Init(const TestArgs& args) {\n      delete constructor_;\n      constructor_ = NULL;\n      options_ = Options();\n  \n      options_.block_restart_interval = args.restart_interval;\n      // Use shorter block size for tests to exercise block boundary\n      // conditions more.\n      options_.block_size = 256;\n      if (args.reverse_compare) {\n        options_.comparator = &reverse_key_comparator;\n      }\n      switch (args.type) {\n        case TABLE_TEST:\n          constructor_ = new TableConstructor(options_.comparator);\n          break;\n        case BLOCK_TEST:\n          constructor_ = new BlockConstructor(options_.comparator);\n          break;\n        case MEMTABLE_TEST:\n          constructor_ = new MemTableConstructor(options_.comparator);\n          break;\n        case DB_TEST:\n          constructor_ = new DBConstructor(options_.comparator);\n          break;\n      }\n    }\n}"
  },
  {
    "function_name": "Harness",
    "container": "Harness",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "439-439",
    "snippet": "Harness() : constructor_(NULL) { }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  Harness() : constructor_(NULL) { }\n}"
  },
  {
    "function_name": "NewDB",
    "container": "DBConstructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "380-393",
    "snippet": "void NewDB() {\n    std::string name = test::TmpDir() + \"/table_testdb\";\n\n    Options options;\n    options.comparator = comparator_;\n    Status status = DestroyDB(name, options);\n    ASSERT_TRUE(status.ok()) << status.ToString();\n\n    options.create_if_missing = true;\n    options.error_if_exists = true;\n    options.write_buffer_size = 10000;  // Something small to force merging\n    status = DB::Open(options, name, &db_);\n    ASSERT_TRUE(status.ok()) << status.ToString();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "status.ToString",
          "args": [],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "status.ok()"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "status.ok",
          "args": [],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "TableBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/table_builder.h",
          "lines": "78-78",
          "snippet": "bool ok() const { return status().ok(); }",
          "includes": [
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include <stdint.h>\n\nTableBuilder {\n  bool ok() const { return status().ok(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DB::Open",
          "args": [
            "options",
            "name",
            "&db_"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "Open",
          "container": "DB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1445-1477",
          "snippet": "Status DB::Open(const Options& options, const std::string& dbname,\n                DB** dbptr) {\n  *dbptr = NULL;\n\n  DBImpl* impl = new DBImpl(options, dbname);\n  impl->mutex_.Lock();\n  VersionEdit edit;\n  Status s = impl->Recover(&edit); // Handles create_if_missing, error_if_exists\n  if (s.ok()) {\n    uint64_t new_log_number = impl->versions_->NewFileNumber();\n    WritableFile* lfile;\n    s = options.env->NewWritableFile(LogFileName(dbname, new_log_number),\n                                     &lfile);\n    if (s.ok()) {\n      edit.SetLogNumber(new_log_number);\n      impl->logfile_ = lfile;\n      impl->logfile_number_ = new_log_number;\n      impl->log_ = new log::Writer(lfile);\n      s = impl->versions_->LogAndApply(&edit, &impl->mutex_);\n    }\n    if (s.ok()) {\n      impl->DeleteObsoleteFiles();\n      impl->MaybeScheduleCompaction();\n    }\n  }\n  impl->mutex_.Unlock();\n  if (s.ok()) {\n    *dbptr = impl;\n  } else {\n    delete impl;\n  }\n  return s;\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nDB {\n  Status DB::Open(const Options& options, const std::string& dbname,\n                  DB** dbptr) {\n    *dbptr = NULL;\n  \n    DBImpl* impl = new DBImpl(options, dbname);\n    impl->mutex_.Lock();\n    VersionEdit edit;\n    Status s = impl->Recover(&edit); // Handles create_if_missing, error_if_exists\n    if (s.ok()) {\n      uint64_t new_log_number = impl->versions_->NewFileNumber();\n      WritableFile* lfile;\n      s = options.env->NewWritableFile(LogFileName(dbname, new_log_number),\n                                       &lfile);\n      if (s.ok()) {\n        edit.SetLogNumber(new_log_number);\n        impl->logfile_ = lfile;\n        impl->logfile_number_ = new_log_number;\n        impl->log_ = new log::Writer(lfile);\n        s = impl->versions_->LogAndApply(&edit, &impl->mutex_);\n      }\n      if (s.ok()) {\n        impl->DeleteObsoleteFiles();\n        impl->MaybeScheduleCompaction();\n      }\n    }\n    impl->mutex_.Unlock();\n    if (s.ok()) {\n      *dbptr = impl;\n    } else {\n      delete impl;\n    }\n    return s;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "status.ok()"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DestroyDB",
          "args": [
            "name",
            "options"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyDB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1482-1511",
          "snippet": "Status DestroyDB(const std::string& dbname, const Options& options) {\n  Env* env = options.env;\n  std::vector<std::string> filenames;\n  // Ignore error in case directory does not exist\n  env->GetChildren(dbname, &filenames);\n  if (filenames.empty()) {\n    return Status::OK();\n  }\n\n  FileLock* lock;\n  const std::string lockname = LockFileName(dbname);\n  Status result = env->LockFile(lockname, &lock);\n  if (result.ok()) {\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) &&\n          type != kDBLockFile) {  // Lock file will be deleted at end\n        Status del = env->DeleteFile(dbname + \"/\" + filenames[i]);\n        if (result.ok() && !del.ok()) {\n          result = del;\n        }\n      }\n    }\n    env->UnlockFile(lock);  // Ignore error since state is already gone\n    env->DeleteFile(lockname);\n    env->DeleteDir(dbname);  // Ignore error in case dir contains other files\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nStatus DestroyDB(const std::string& dbname, const Options& options) {\n  Env* env = options.env;\n  std::vector<std::string> filenames;\n  // Ignore error in case directory does not exist\n  env->GetChildren(dbname, &filenames);\n  if (filenames.empty()) {\n    return Status::OK();\n  }\n\n  FileLock* lock;\n  const std::string lockname = LockFileName(dbname);\n  Status result = env->LockFile(lockname, &lock);\n  if (result.ok()) {\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) &&\n          type != kDBLockFile) {  // Lock file will be deleted at end\n        Status del = env->DeleteFile(dbname + \"/\" + filenames[i]);\n        if (result.ok() && !del.ok()) {\n          result = del;\n        }\n      }\n    }\n    env->UnlockFile(lock);  // Ignore error since state is already gone\n    env->DeleteFile(lockname);\n    env->DeleteDir(dbname);  // Ignore error in case dir contains other files\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::TmpDir",
          "args": [],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "TmpDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "60-65",
          "snippet": "std::string TmpDir() {\n  std::string dir;\n  Status s = Env::Default()->GetTestDirectory(&dir);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  return dir;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nstd::string TmpDir() {\n  std::string dir;\n  Status s = Env::Default()->GetTestDirectory(&dir);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  return dir;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nDBConstructor {\n  void NewDB() {\n      std::string name = test::TmpDir() + \"/table_testdb\";\n  \n      Options options;\n      options.comparator = comparator_;\n      Status status = DestroyDB(name, options);\n      ASSERT_TRUE(status.ok()) << status.ToString();\n  \n      options.create_if_missing = true;\n      options.error_if_exists = true;\n      options.write_buffer_size = 10000;  // Something small to force merging\n      status = DB::Open(options, name, &db_);\n      ASSERT_TRUE(status.ok()) << status.ToString();\n    }\n}"
  },
  {
    "function_name": "FinishImpl",
    "container": "DBConstructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "360-372",
    "snippet": "virtual Status FinishImpl(const Options& options, const KVMap& data) {\n    delete db_;\n    db_ = NULL;\n    NewDB();\n    for (KVMap::const_iterator it = data.begin();\n         it != data.end();\n         ++it) {\n      WriteBatch batch;\n      batch.Put(it->first, it->second);\n      ASSERT_TRUE(db_->Write(WriteOptions(), &batch).ok());\n    }\n    return Status::OK();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "db_->Write(WriteOptions(), &batch).ok()"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->Write",
          "args": [],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->Write",
          "args": [
            "WriteOptions()",
            "&batch"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "CTxDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/txdb-leveldb.h",
          "lines": "101-123",
          "snippet": "bool Write(const K& key, const T& value)\n    {\n        if (fReadOnly)\n            assert(!\"Write called on database in read-only mode\");\n\n        CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n        ssKey.reserve(1000);\n        ssKey << key;\n        CDataStream ssValue(SER_DISK, CLIENT_VERSION);\n        ssValue.reserve(10000);\n        ssValue << value;\n\n        if (activeBatch) {\n            activeBatch->Put(ssKey.str(), ssValue.str());\n            return true;\n        }\n        leveldb::Status status = pdb->Put(leveldb::WriteOptions(), ssKey.str(), ssValue.str());\n        if (!status.ok()) {\n            printf(\"LevelDB write failure: %s\\n\", status.ToString().c_str());\n            return false;\n        }\n        return true;\n    }",
          "includes": [
            "#include <leveldb/write_batch.h>",
            "#include <leveldb/db.h>",
            "#include <vector>",
            "#include <string>",
            "#include <map>",
            "#include \"main.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <leveldb/write_batch.h>\n#include <leveldb/db.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCTxDB {\n  bool Write(const K& key, const T& value)\n      {\n          if (fReadOnly)\n              assert(!\"Write called on database in read-only mode\");\n  \n          CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n          ssKey.reserve(1000);\n          ssKey << key;\n          CDataStream ssValue(SER_DISK, CLIENT_VERSION);\n          ssValue.reserve(10000);\n          ssValue << value;\n  \n          if (activeBatch) {\n              activeBatch->Put(ssKey.str(), ssValue.str());\n              return true;\n          }\n          leveldb::Status status = pdb->Put(leveldb::WriteOptions(), ssKey.str(), ssValue.str());\n          if (!status.ok()) {\n              printf(\"LevelDB write failure: %s\\n\", status.ToString().c_str());\n              return false;\n          }\n          return true;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WriteOptions",
          "args": [],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "WriteOptions",
          "container": "WriteOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "188-190",
          "snippet": "WriteOptions()\n      : sync(false) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nWriteOptions {\n  WriteOptions()\n        : sync(false) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "batch.Put",
          "args": [
            "it->first",
            "it->second"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "CBatchScanner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/txdb-leveldb.cpp",
          "lines": "164-170",
          "snippet": "virtual void Put(const leveldb::Slice& key, const leveldb::Slice& value) {\n        if (key.ToString() == needle) {\n            foundEntry = true;\n            *deleted = false;\n            *foundValue = value.ToString();\n        }\n    }",
          "includes": [
            "#include \"main.h\"",
            "#include \"util.h\"",
            "#include \"txdb.h\"",
            "#include \"checkpoints.h\"",
            "#include \"kernel.h\"",
            "#include <memenv/memenv.h>",
            "#include <leveldb/filter_policy.h>",
            "#include <leveldb/cache.h>",
            "#include <leveldb/env.h>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/version.hpp>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"main.h\"\n#include \"util.h\"\n#include \"txdb.h\"\n#include \"checkpoints.h\"\n#include \"kernel.h\"\n#include <memenv/memenv.h>\n#include <leveldb/filter_policy.h>\n#include <leveldb/cache.h>\n#include <leveldb/env.h>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/version.hpp>\n#include <map>\n\nCBatchScanner {\n  virtual void Put(const leveldb::Slice& key, const leveldb::Slice& value) {\n          if (key.ToString() == needle) {\n              foundEntry = true;\n              *deleted = false;\n              *foundValue = value.ToString();\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.end",
          "args": [],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.begin",
          "args": [],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "NewDB",
          "args": [],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "NewDB",
          "container": "DBConstructor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "380-393",
          "snippet": "void NewDB() {\n    std::string name = test::TmpDir() + \"/table_testdb\";\n\n    Options options;\n    options.comparator = comparator_;\n    Status status = DestroyDB(name, options);\n    ASSERT_TRUE(status.ok()) << status.ToString();\n\n    options.create_if_missing = true;\n    options.error_if_exists = true;\n    options.write_buffer_size = 10000;  // Something small to force merging\n    status = DB::Open(options, name, &db_);\n    ASSERT_TRUE(status.ok()) << status.ToString();\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nDBConstructor {\n  void NewDB() {\n      std::string name = test::TmpDir() + \"/table_testdb\";\n  \n      Options options;\n      options.comparator = comparator_;\n      Status status = DestroyDB(name, options);\n      ASSERT_TRUE(status.ok()) << status.ToString();\n  \n      options.create_if_missing = true;\n      options.error_if_exists = true;\n      options.write_buffer_size = 10000;  // Something small to force merging\n      status = DB::Open(options, name, &db_);\n      ASSERT_TRUE(status.ok()) << status.ToString();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nDBConstructor {\n  virtual Status FinishImpl(const Options& options, const KVMap& data) {\n      delete db_;\n      db_ = NULL;\n      NewDB();\n      for (KVMap::const_iterator it = data.begin();\n           it != data.end();\n           ++it) {\n        WriteBatch batch;\n        batch.Put(it->first, it->second);\n        ASSERT_TRUE(db_->Write(WriteOptions(), &batch).ok());\n      }\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "DBConstructor",
    "container": "DBConstructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "351-356",
    "snippet": "explicit DBConstructor(const Comparator* cmp)\n      : Constructor(cmp),\n        comparator_(cmp) {\n    db_ = NULL;\n    NewDB();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NewDB",
          "args": [],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "NewDB",
          "container": "DBConstructor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "380-393",
          "snippet": "void NewDB() {\n    std::string name = test::TmpDir() + \"/table_testdb\";\n\n    Options options;\n    options.comparator = comparator_;\n    Status status = DestroyDB(name, options);\n    ASSERT_TRUE(status.ok()) << status.ToString();\n\n    options.create_if_missing = true;\n    options.error_if_exists = true;\n    options.write_buffer_size = 10000;  // Something small to force merging\n    status = DB::Open(options, name, &db_);\n    ASSERT_TRUE(status.ok()) << status.ToString();\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nDBConstructor {\n  void NewDB() {\n      std::string name = test::TmpDir() + \"/table_testdb\";\n  \n      Options options;\n      options.comparator = comparator_;\n      Status status = DestroyDB(name, options);\n      ASSERT_TRUE(status.ok()) << status.ToString();\n  \n      options.create_if_missing = true;\n      options.error_if_exists = true;\n      options.write_buffer_size = 10000;  // Something small to force merging\n      status = DB::Open(options, name, &db_);\n      ASSERT_TRUE(status.ok()) << status.ToString();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nDBConstructor {\n  explicit DBConstructor(const Comparator* cmp)\n        : Constructor(cmp),\n          comparator_(cmp) {\n      db_ = NULL;\n      NewDB();\n    }\n}"
  },
  {
    "function_name": "FinishImpl",
    "container": "MemTableConstructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "327-339",
    "snippet": "virtual Status FinishImpl(const Options& options, const KVMap& data) {\n    memtable_->Unref();\n    memtable_ = new MemTable(internal_comparator_);\n    memtable_->Ref();\n    int seq = 1;\n    for (KVMap::const_iterator it = data.begin();\n         it != data.end();\n         ++it) {\n      memtable_->Add(seq, kTypeValue, it->first, it->second);\n      seq++;\n    }\n    return Status::OK();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memtable_->Add",
          "args": [
            "seq",
            "kTypeValue",
            "it->first",
            "it->second"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "MemTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/memtable.cc",
          "lines": "82-106",
          "snippet": "void MemTable::Add(SequenceNumber s, ValueType type,\n                   const Slice& key,\n                   const Slice& value) {\n  // Format of an entry is concatenation of:\n  //  key_size     : varint32 of internal_key.size()\n  //  key bytes    : char[internal_key.size()]\n  //  value_size   : varint32 of value.size()\n  //  value bytes  : char[value.size()]\n  size_t key_size = key.size();\n  size_t val_size = value.size();\n  size_t internal_key_size = key_size + 8;\n  const size_t encoded_len =\n      VarintLength(internal_key_size) + internal_key_size +\n      VarintLength(val_size) + val_size;\n  char* buf = arena_.Allocate(encoded_len);\n  char* p = EncodeVarint32(buf, internal_key_size);\n  memcpy(p, key.data(), key_size);\n  p += key_size;\n  EncodeFixed64(p, (s << 8) | type);\n  p += 8;\n  p = EncodeVarint32(p, val_size);\n  memcpy(p, value.data(), val_size);\n  assert((p + val_size) - buf == encoded_len);\n  table_.Insert(buf);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/memtable.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/comparator.h\"\n#include \"db/dbformat.h\"\n#include \"db/memtable.h\"\n\nMemTable {\n  void MemTable::Add(SequenceNumber s, ValueType type,\n                     const Slice& key,\n                     const Slice& value) {\n    // Format of an entry is concatenation of:\n    //  key_size     : varint32 of internal_key.size()\n    //  key bytes    : char[internal_key.size()]\n    //  value_size   : varint32 of value.size()\n    //  value bytes  : char[value.size()]\n    size_t key_size = key.size();\n    size_t val_size = value.size();\n    size_t internal_key_size = key_size + 8;\n    const size_t encoded_len =\n        VarintLength(internal_key_size) + internal_key_size +\n        VarintLength(val_size) + val_size;\n    char* buf = arena_.Allocate(encoded_len);\n    char* p = EncodeVarint32(buf, internal_key_size);\n    memcpy(p, key.data(), key_size);\n    p += key_size;\n    EncodeFixed64(p, (s << 8) | type);\n    p += 8;\n    p = EncodeVarint32(p, val_size);\n    memcpy(p, value.data(), val_size);\n    assert((p + val_size) - buf == encoded_len);\n    table_.Insert(buf);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.end",
          "args": [],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.begin",
          "args": [],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memtable_->Ref",
          "args": [],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "Ref",
          "container": "FileState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "27-30",
          "snippet": "void Ref() {\n    MutexLock lock(&refs_mutex_);\n    ++refs_;\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  void Ref() {\n      MutexLock lock(&refs_mutex_);\n      ++refs_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memtable_->Unref",
          "args": [],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "Unref",
          "container": "FileState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "33-48",
          "snippet": "void Unref() {\n    bool do_delete = false;\n\n    {\n      MutexLock lock(&refs_mutex_);\n      --refs_;\n      assert(refs_ >= 0);\n      if (refs_ <= 0) {\n        do_delete = true;\n      }\n    }\n\n    if (do_delete) {\n      delete this;\n    }\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  void Unref() {\n      bool do_delete = false;\n  \n      {\n        MutexLock lock(&refs_mutex_);\n        --refs_;\n        assert(refs_ >= 0);\n        if (refs_ <= 0) {\n          do_delete = true;\n        }\n      }\n  \n      if (do_delete) {\n        delete this;\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nMemTableConstructor {\n  virtual Status FinishImpl(const Options& options, const KVMap& data) {\n      memtable_->Unref();\n      memtable_ = new MemTable(internal_comparator_);\n      memtable_->Ref();\n      int seq = 1;\n      for (KVMap::const_iterator it = data.begin();\n           it != data.end();\n           ++it) {\n        memtable_->Add(seq, kTypeValue, it->first, it->second);\n        seq++;\n      }\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "MemTableConstructor",
    "container": "MemTableConstructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "318-323",
    "snippet": "explicit MemTableConstructor(const Comparator* cmp)\n      : Constructor(cmp),\n        internal_comparator_(cmp) {\n    memtable_ = new MemTable(internal_comparator_);\n    memtable_->Ref();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memtable_->Ref",
          "args": [],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "Ref",
          "container": "FileState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "27-30",
          "snippet": "void Ref() {\n    MutexLock lock(&refs_mutex_);\n    ++refs_;\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  void Ref() {\n      MutexLock lock(&refs_mutex_);\n      ++refs_;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nMemTableConstructor {\n  explicit MemTableConstructor(const Comparator* cmp)\n        : Constructor(cmp),\n          internal_comparator_(cmp) {\n      memtable_ = new MemTable(internal_comparator_);\n      memtable_->Ref();\n    }\n}"
  },
  {
    "function_name": "status",
    "container": "KeyConvertingIterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "303-305",
    "snippet": "virtual Status status() const {\n    return status_.ok() ? iter_->status() : status_;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter_->status",
          "args": [],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "status",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "303-305",
          "snippet": "virtual Status status() const {\n    return status_.ok() ? iter_->status() : status_;\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "status_.ok",
          "args": [],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "TableBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/table_builder.h",
          "lines": "78-78",
          "snippet": "bool ok() const { return status().ok(); }",
          "includes": [
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include <stdint.h>\n\nTableBuilder {\n  bool ok() const { return status().ok(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual Status status() const {\n      return status_.ok() ? iter_->status() : status_;\n    }\n}"
  },
  {
    "function_name": "value",
    "container": "KeyConvertingIterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "302-302",
    "snippet": "virtual Slice value() const { return iter_->value(); }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter_->value",
          "args": [],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "302-302",
          "snippet": "virtual Slice value() const { return iter_->value(); }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual Slice value() const { return iter_->value(); }\n}"
  },
  {
    "function_name": "key",
    "container": "KeyConvertingIterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "292-300",
    "snippet": "virtual Slice key() const {\n    assert(Valid());\n    ParsedInternalKey key;\n    if (!ParseInternalKey(iter_->key(), &key)) {\n      status_ = Status::Corruption(\"malformed internal key\");\n      return Slice(\"corrupted key\");\n    }\n    return key.user_key;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "\"corrupted key\""
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "HashSlice",
          "container": "ShardedLRUCache",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "276-278",
          "snippet": "static inline uint32_t HashSlice(const Slice& s) {\n    return Hash(s.data(), s.size(), 0);\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nShardedLRUCache {\n  static inline uint32_t HashSlice(const Slice& s) {\n      return Hash(s.data(), s.size(), 0);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Status::Corruption",
          "args": [
            "\"malformed internal key\""
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "Corruption",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "38-40",
          "snippet": "static Status Corruption(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kCorruption, msg, msg2);\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status Corruption(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kCorruption, msg, msg2);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ParseInternalKey",
          "args": [
            "iter_->key()",
            "&key"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "ParseInternalKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "176-186",
          "snippet": "inline bool ParseInternalKey(const Slice& internal_key,\n                             ParsedInternalKey* result) {\n  const size_t n = internal_key.size();\n  if (n < 8) return false;\n  uint64_t num = DecodeFixed64(internal_key.data() + n - 8);\n  unsigned char c = num & 0xff;\n  result->sequence = num >> 8;\n  result->type = static_cast<ValueType>(c);\n  result->user_key = Slice(internal_key.data(), n - 8);\n  return (c <= static_cast<unsigned char>(kTypeValue));\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\ninline bool ParseInternalKey(const Slice& internal_key,\n                             ParsedInternalKey* result) {\n  const size_t n = internal_key.size();\n  if (n < 8) return false;\n  uint64_t num = DecodeFixed64(internal_key.data() + n - 8);\n  unsigned char c = num & 0xff;\n  result->sequence = num >> 8;\n  result->type = static_cast<ValueType>(c);\n  result->user_key = Slice(internal_key.data(), n - 8);\n  return (c <= static_cast<unsigned char>(kTypeValue));\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter_->key",
          "args": [],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "292-300",
          "snippet": "virtual Slice key() const {\n    assert(Valid());\n    ParsedInternalKey key;\n    if (!ParseInternalKey(iter_->key(), &key)) {\n      status_ = Status::Corruption(\"malformed internal key\");\n      return Slice(\"corrupted key\");\n    }\n    return key.user_key;\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "Valid()"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Valid",
          "args": [],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "280-280",
          "snippet": "virtual bool Valid() const { return iter_->Valid(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual bool Valid() const { return iter_->Valid(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual Slice key() const {\n      assert(Valid());\n      ParsedInternalKey key;\n      if (!ParseInternalKey(iter_->key(), &key)) {\n        status_ = Status::Corruption(\"malformed internal key\");\n        return Slice(\"corrupted key\");\n      }\n      return key.user_key;\n    }\n}"
  },
  {
    "function_name": "Prev",
    "container": "KeyConvertingIterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "290-290",
    "snippet": "virtual void Prev() { iter_->Prev(); }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter_->Prev",
          "args": [],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "Prev",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "290-290",
          "snippet": "virtual void Prev() { iter_->Prev(); }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void Prev() { iter_->Prev(); }\n}"
  },
  {
    "function_name": "Next",
    "container": "KeyConvertingIterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "289-289",
    "snippet": "virtual void Next() { iter_->Next(); }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter_->Next",
          "args": [],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "289-289",
          "snippet": "virtual void Next() { iter_->Next(); }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void Next() { iter_->Next(); }\n}"
  },
  {
    "function_name": "SeekToLast",
    "container": "KeyConvertingIterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "288-288",
    "snippet": "virtual void SeekToLast() { iter_->SeekToLast(); }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter_->SeekToLast",
          "args": [],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToLast",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "288-288",
          "snippet": "virtual void SeekToLast() { iter_->SeekToLast(); }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void SeekToLast() { iter_->SeekToLast(); }\n}"
  },
  {
    "function_name": "SeekToFirst",
    "container": "KeyConvertingIterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "287-287",
    "snippet": "virtual void SeekToFirst() { iter_->SeekToFirst(); }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter_->SeekToFirst",
          "args": [],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "287-287",
          "snippet": "virtual void SeekToFirst() { iter_->SeekToFirst(); }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void SeekToFirst() { iter_->SeekToFirst(); }\n}"
  },
  {
    "function_name": "Seek",
    "container": "KeyConvertingIterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "281-286",
    "snippet": "virtual void Seek(const Slice& target) {\n    ParsedInternalKey ikey(target, kMaxSequenceNumber, kTypeValue);\n    std::string encoded;\n    AppendInternalKey(&encoded, ikey);\n    iter_->Seek(encoded);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter_->Seek",
          "args": [
            "encoded"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "Seek",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "281-286",
          "snippet": "virtual void Seek(const Slice& target) {\n    ParsedInternalKey ikey(target, kMaxSequenceNumber, kTypeValue);\n    std::string encoded;\n    AppendInternalKey(&encoded, ikey);\n    iter_->Seek(encoded);\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "AppendInternalKey",
          "args": [
            "&encoded",
            "ikey"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "AppendInternalKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "18-21",
          "snippet": "void AppendInternalKey(std::string* result, const ParsedInternalKey& key) {\n  result->append(key.user_key.data(), key.user_key.size());\n  PutFixed64(result, PackSequenceAndType(key.sequence, key.type));\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"port/port.h\"",
            "#include \"db/dbformat.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nvoid AppendInternalKey(std::string* result, const ParsedInternalKey& key) {\n  result->append(key.user_key.data(), key.user_key.size());\n  PutFixed64(result, PackSequenceAndType(key.sequence, key.type));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual void Seek(const Slice& target) {\n      ParsedInternalKey ikey(target, kMaxSequenceNumber, kTypeValue);\n      std::string encoded;\n      AppendInternalKey(&encoded, ikey);\n      iter_->Seek(encoded);\n    }\n}"
  },
  {
    "function_name": "Valid",
    "container": "KeyConvertingIterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "280-280",
    "snippet": "virtual bool Valid() const { return iter_->Valid(); }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter_->Valid",
          "args": [],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "280-280",
          "snippet": "virtual bool Valid() const { return iter_->Valid(); }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual bool Valid() const { return iter_->Valid(); }\n}"
  },
  {
    "function_name": "KeyConvertingIterator",
    "container": "KeyConvertingIterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "278-278",
    "snippet": "explicit KeyConvertingIterator(Iterator* iter) : iter_(iter) { }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  explicit KeyConvertingIterator(Iterator* iter) : iter_(iter) { }\n}"
  },
  {
    "function_name": "Reset",
    "container": "TableConstructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "262-267",
    "snippet": "void Reset() {\n    delete table_;\n    delete source_;\n    table_ = NULL;\n    source_ = NULL;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTableConstructor {\n  void Reset() {\n      delete table_;\n      delete source_;\n      table_ = NULL;\n      source_ = NULL;\n    }\n}"
  },
  {
    "function_name": "ApproximateOffsetOf",
    "container": "TableConstructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "257-259",
    "snippet": "uint64_t ApproximateOffsetOf(const Slice& key) const {\n    return table_->ApproximateOffsetOf(key);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "table_->ApproximateOffsetOf",
          "args": [
            "key"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "ApproximateOffsetOf",
          "container": "TableConstructor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "257-259",
          "snippet": "uint64_t ApproximateOffsetOf(const Slice& key) const {\n    return table_->ApproximateOffsetOf(key);\n  }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTableConstructor {\n  uint64_t ApproximateOffsetOf(const Slice& key) const {\n      return table_->ApproximateOffsetOf(key);\n    }\n}"
  },
  {
    "function_name": "FinishImpl",
    "container": "TableConstructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "230-251",
    "snippet": "virtual Status FinishImpl(const Options& options, const KVMap& data) {\n    Reset();\n    StringSink sink;\n    TableBuilder builder(options, &sink);\n\n    for (KVMap::const_iterator it = data.begin();\n         it != data.end();\n         ++it) {\n      builder.Add(it->first, it->second);\n      ASSERT_TRUE(builder.status().ok());\n    }\n    Status s = builder.Finish();\n    ASSERT_TRUE(s.ok()) << s.ToString();\n\n    ASSERT_EQ(sink.contents().size(), builder.FileSize());\n\n    // Open the table\n    source_ = new StringSource(sink.contents());\n    Options table_options;\n    table_options.comparator = options.comparator;\n    return Table::Open(table_options, source_, sink.contents().size(), &table_);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Table::Open",
          "args": [
            "table_options",
            "source_",
            "sink.contents().size()",
            "&table_"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "Open",
          "container": "Table",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table.cc",
          "lines": "38-85",
          "snippet": "Status Table::Open(const Options& options,\n                   RandomAccessFile* file,\n                   uint64_t size,\n                   Table** table) {\n  *table = NULL;\n  if (size < Footer::kEncodedLength) {\n    return Status::InvalidArgument(\"file is too short to be an sstable\");\n  }\n\n  char footer_space[Footer::kEncodedLength];\n  Slice footer_input;\n  Status s = file->Read(size - Footer::kEncodedLength, Footer::kEncodedLength,\n                        &footer_input, footer_space);\n  if (!s.ok()) return s;\n\n  Footer footer;\n  s = footer.DecodeFrom(&footer_input);\n  if (!s.ok()) return s;\n\n  // Read the index block\n  BlockContents contents;\n  Block* index_block = NULL;\n  if (s.ok()) {\n    s = ReadBlock(file, ReadOptions(), footer.index_handle(), &contents);\n    if (s.ok()) {\n      index_block = new Block(contents);\n    }\n  }\n\n  if (s.ok()) {\n    // We've successfully read the footer and the index block: we're\n    // ready to serve requests.\n    Rep* rep = new Table::Rep;\n    rep->options = options;\n    rep->file = file;\n    rep->metaindex_handle = footer.metaindex_handle();\n    rep->index_block = index_block;\n    rep->cache_id = (options.block_cache ? options.block_cache->NewId() : 0);\n    rep->filter_data = NULL;\n    rep->filter = NULL;\n    *table = new Table(rep);\n    (*table)->ReadMeta(footer);\n  } else {\n    if (index_block) delete index_block;\n  }\n\n  return s;\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/format.h\"",
            "#include \"table/filter_block.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/format.h\"\n#include \"table/filter_block.h\"\n#include \"table/block.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include \"leveldb/table.h\"\n\nTable {\n  Status Table::Open(const Options& options,\n                     RandomAccessFile* file,\n                     uint64_t size,\n                     Table** table) {\n    *table = NULL;\n    if (size < Footer::kEncodedLength) {\n      return Status::InvalidArgument(\"file is too short to be an sstable\");\n    }\n  \n    char footer_space[Footer::kEncodedLength];\n    Slice footer_input;\n    Status s = file->Read(size - Footer::kEncodedLength, Footer::kEncodedLength,\n                          &footer_input, footer_space);\n    if (!s.ok()) return s;\n  \n    Footer footer;\n    s = footer.DecodeFrom(&footer_input);\n    if (!s.ok()) return s;\n  \n    // Read the index block\n    BlockContents contents;\n    Block* index_block = NULL;\n    if (s.ok()) {\n      s = ReadBlock(file, ReadOptions(), footer.index_handle(), &contents);\n      if (s.ok()) {\n        index_block = new Block(contents);\n      }\n    }\n  \n    if (s.ok()) {\n      // We've successfully read the footer and the index block: we're\n      // ready to serve requests.\n      Rep* rep = new Table::Rep;\n      rep->options = options;\n      rep->file = file;\n      rep->metaindex_handle = footer.metaindex_handle();\n      rep->index_block = index_block;\n      rep->cache_id = (options.block_cache ? options.block_cache->NewId() : 0);\n      rep->filter_data = NULL;\n      rep->filter = NULL;\n      *table = new Table(rep);\n      (*table)->ReadMeta(footer);\n    } else {\n      if (index_block) delete index_block;\n    }\n  \n    return s;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sink.contents",
          "args": [],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sink.contents",
          "args": [],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sink.contents",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "sink.contents().size()",
            "builder.FileSize()"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.FileSize",
          "args": [],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "FileSize",
          "container": "TableBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_builder.cc",
          "lines": "266-268",
          "snippet": "uint64_t TableBuilder::FileSize() const {\n  return rep_->offset;\n}",
          "includes": [
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/format.h\"",
            "#include \"table/filter_block.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <assert.h>",
            "#include \"leveldb/table_builder.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"table/format.h\"\n#include \"table/filter_block.h\"\n#include \"table/block_builder.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/comparator.h\"\n#include <assert.h>\n#include \"leveldb/table_builder.h\"\n\nTableBuilder {\n  uint64_t TableBuilder::FileSize() const {\n    return rep_->offset;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sink.contents",
          "args": [],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sink.contents",
          "args": [],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ToString",
          "args": [],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CUnsignedSyncCheckpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/checkpoints.h",
          "lines": "89-98",
          "snippet": "std::string ToString() const\n    {\n        return strprintf(\n                \"CSyncCheckpoint(\\n\"\n                \"    nVersion       = %d\\n\"\n                \"    hashCheckpoint = %s\\n\"\n                \")\\n\",\n            nVersion,\n            hashCheckpoint.ToString().c_str());\n    }",
          "includes": [
            "#include \"util.h\"",
            "#include \"net.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"net.h\"\n#include <map>\n\nCUnsignedSyncCheckpoint {\n  std::string ToString() const\n      {\n          return strprintf(\n                  \"CSyncCheckpoint(\\n\"\n                  \"    nVersion       = %d\\n\"\n                  \"    hashCheckpoint = %s\\n\"\n                  \")\\n\",\n              nVersion,\n              hashCheckpoint.ToString().c_str());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "s.ok()"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.Finish",
          "args": [],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "Finish",
          "container": "FilterBlockBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/filter_block.cc",
          "lines": "36-50",
          "snippet": "Slice FilterBlockBuilder::Finish() {\n  if (!start_.empty()) {\n    GenerateFilter();\n  }\n\n  // Append array of per-filter offsets\n  const uint32_t array_offset = result_.size();\n  for (size_t i = 0; i < filter_offsets_.size(); i++) {\n    PutFixed32(&result_, filter_offsets_[i]);\n  }\n\n  PutFixed32(&result_, array_offset);\n  result_.push_back(kFilterBaseLg);  // Save encoding parameter in result\n  return Slice(result_);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"table/filter_block.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"table/filter_block.h\"\n\nFilterBlockBuilder {\n  Slice FilterBlockBuilder::Finish() {\n    if (!start_.empty()) {\n      GenerateFilter();\n    }\n  \n    // Append array of per-filter offsets\n    const uint32_t array_offset = result_.size();\n    for (size_t i = 0; i < filter_offsets_.size(); i++) {\n      PutFixed32(&result_, filter_offsets_[i]);\n    }\n  \n    PutFixed32(&result_, array_offset);\n    result_.push_back(kFilterBaseLg);  // Save encoding parameter in result\n    return Slice(result_);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "builder.status().ok()"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.status",
          "args": [],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "status",
          "container": "KeyConvertingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "303-305",
          "snippet": "virtual Status status() const {\n    return status_.ok() ? iter_->status() : status_;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nKeyConvertingIterator {\n  virtual Status status() const {\n      return status_.ok() ? iter_->status() : status_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.Add",
          "args": [
            "it->first",
            "it->second"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "473-475",
          "snippet": "void Add(const std::string& key, const std::string& value) {\n    constructor_->Add(key, value);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Add(const std::string& key, const std::string& value) {\n      constructor_->Add(key, value);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.end",
          "args": [],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.begin",
          "args": [],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Reset",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "Reset",
          "container": "TableConstructor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "262-267",
          "snippet": "void Reset() {\n    delete table_;\n    delete source_;\n    table_ = NULL;\n    source_ = NULL;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTableConstructor {\n  void Reset() {\n      delete table_;\n      delete source_;\n      table_ = NULL;\n      source_ = NULL;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTableConstructor {\n  virtual Status FinishImpl(const Options& options, const KVMap& data) {\n      Reset();\n      StringSink sink;\n      TableBuilder builder(options, &sink);\n  \n      for (KVMap::const_iterator it = data.begin();\n           it != data.end();\n           ++it) {\n        builder.Add(it->first, it->second);\n        ASSERT_TRUE(builder.status().ok());\n      }\n      Status s = builder.Finish();\n      ASSERT_TRUE(s.ok()) << s.ToString();\n  \n      ASSERT_EQ(sink.contents().size(), builder.FileSize());\n  \n      // Open the table\n      source_ = new StringSource(sink.contents());\n      Options table_options;\n      table_options.comparator = options.comparator;\n      return Table::Open(table_options, source_, sink.contents().size(), &table_);\n    }\n}"
  },
  {
    "function_name": "TableConstructor",
    "container": "TableConstructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "223-226",
    "snippet": "TableConstructor(const Comparator* cmp)\n      : Constructor(cmp),\n        source_(NULL), table_(NULL) {\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nTableConstructor {\n  TableConstructor(const Comparator* cmp)\n        : Constructor(cmp),\n          source_(NULL), table_(NULL) {\n    }\n}"
  },
  {
    "function_name": "FinishImpl",
    "container": "BlockConstructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "190-208",
    "snippet": "virtual Status FinishImpl(const Options& options, const KVMap& data) {\n    delete block_;\n    block_ = NULL;\n    BlockBuilder builder(&options);\n\n    for (KVMap::const_iterator it = data.begin();\n         it != data.end();\n         ++it) {\n      builder.Add(it->first, it->second);\n    }\n    // Open the block\n    data_ = builder.Finish().ToString();\n    BlockContents contents;\n    contents.data = data_;\n    contents.cachable = false;\n    contents.heap_allocated = false;\n    block_ = new Block(contents);\n    return Status::OK();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.Finish",
          "args": [],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "Finish",
          "container": "FilterBlockBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/filter_block.cc",
          "lines": "36-50",
          "snippet": "Slice FilterBlockBuilder::Finish() {\n  if (!start_.empty()) {\n    GenerateFilter();\n  }\n\n  // Append array of per-filter offsets\n  const uint32_t array_offset = result_.size();\n  for (size_t i = 0; i < filter_offsets_.size(); i++) {\n    PutFixed32(&result_, filter_offsets_[i]);\n  }\n\n  PutFixed32(&result_, array_offset);\n  result_.push_back(kFilterBaseLg);  // Save encoding parameter in result\n  return Slice(result_);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"table/filter_block.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"table/filter_block.h\"\n\nFilterBlockBuilder {\n  Slice FilterBlockBuilder::Finish() {\n    if (!start_.empty()) {\n      GenerateFilter();\n    }\n  \n    // Append array of per-filter offsets\n    const uint32_t array_offset = result_.size();\n    for (size_t i = 0; i < filter_offsets_.size(); i++) {\n      PutFixed32(&result_, filter_offsets_[i]);\n    }\n  \n    PutFixed32(&result_, array_offset);\n    result_.push_back(kFilterBaseLg);  // Save encoding parameter in result\n    return Slice(result_);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.Add",
          "args": [
            "it->first",
            "it->second"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "473-475",
          "snippet": "void Add(const std::string& key, const std::string& value) {\n    constructor_->Add(key, value);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  void Add(const std::string& key, const std::string& value) {\n      constructor_->Add(key, value);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.end",
          "args": [],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.begin",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nBlockConstructor {\n  virtual Status FinishImpl(const Options& options, const KVMap& data) {\n      delete block_;\n      block_ = NULL;\n      BlockBuilder builder(&options);\n  \n      for (KVMap::const_iterator it = data.begin();\n           it != data.end();\n           ++it) {\n        builder.Add(it->first, it->second);\n      }\n      // Open the block\n      data_ = builder.Finish().ToString();\n      BlockContents contents;\n      contents.data = data_;\n      contents.cachable = false;\n      contents.heap_allocated = false;\n      block_ = new Block(contents);\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "BlockConstructor",
    "container": "BlockConstructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "183-186",
    "snippet": "explicit BlockConstructor(const Comparator* cmp)\n      : Constructor(cmp),\n        comparator_(cmp),\n        block_(NULL) { }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nBlockConstructor {\n  explicit BlockConstructor(const Comparator* cmp)\n        : Constructor(cmp),\n          comparator_(cmp),\n          block_(NULL) { }\n}"
  },
  {
    "function_name": "Finish",
    "container": "Constructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "153-166",
    "snippet": "void Finish(const Options& options,\n              std::vector<std::string>* keys,\n              KVMap* kvmap) {\n    *kvmap = data_;\n    keys->clear();\n    for (KVMap::const_iterator it = data_.begin();\n         it != data_.end();\n         ++it) {\n      keys->push_back(it->first);\n    }\n    data_.clear();\n    Status s = FinishImpl(options, *kvmap);\n    ASSERT_TRUE(s.ok()) << s.ToString();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s.ToString",
          "args": [],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CUnsignedSyncCheckpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/checkpoints.h",
          "lines": "89-98",
          "snippet": "std::string ToString() const\n    {\n        return strprintf(\n                \"CSyncCheckpoint(\\n\"\n                \"    nVersion       = %d\\n\"\n                \"    hashCheckpoint = %s\\n\"\n                \")\\n\",\n            nVersion,\n            hashCheckpoint.ToString().c_str());\n    }",
          "includes": [
            "#include \"util.h\"",
            "#include \"net.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"net.h\"\n#include <map>\n\nCUnsignedSyncCheckpoint {\n  std::string ToString() const\n      {\n          return strprintf(\n                  \"CSyncCheckpoint(\\n\"\n                  \"    nVersion       = %d\\n\"\n                  \"    hashCheckpoint = %s\\n\"\n                  \")\\n\",\n              nVersion,\n              hashCheckpoint.ToString().c_str());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "s.ok()"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FinishImpl",
          "args": [
            "options",
            "*kvmap"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "FinishImpl",
          "container": "DBConstructor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "360-372",
          "snippet": "virtual Status FinishImpl(const Options& options, const KVMap& data) {\n    delete db_;\n    db_ = NULL;\n    NewDB();\n    for (KVMap::const_iterator it = data.begin();\n         it != data.end();\n         ++it) {\n      WriteBatch batch;\n      batch.Put(it->first, it->second);\n      ASSERT_TRUE(db_->Write(WriteOptions(), &batch).ok());\n    }\n    return Status::OK();\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nDBConstructor {\n  virtual Status FinishImpl(const Options& options, const KVMap& data) {\n      delete db_;\n      db_ = NULL;\n      NewDB();\n      for (KVMap::const_iterator it = data.begin();\n           it != data.end();\n           ++it) {\n        WriteBatch batch;\n        batch.Put(it->first, it->second);\n        ASSERT_TRUE(db_->Write(WriteOptions(), &batch).ok());\n      }\n      return Status::OK();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data_.clear",
          "args": [],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "keys->push_back",
          "args": [
            "it->first"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data_.end",
          "args": [],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data_.begin",
          "args": [],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nConstructor {\n  void Finish(const Options& options,\n                std::vector<std::string>* keys,\n                KVMap* kvmap) {\n      *kvmap = data_;\n      keys->clear();\n      for (KVMap::const_iterator it = data_.begin();\n           it != data_.end();\n           ++it) {\n        keys->push_back(it->first);\n      }\n      data_.clear();\n      Status s = FinishImpl(options, *kvmap);\n      ASSERT_TRUE(s.ok()) << s.ToString();\n    }\n}"
  },
  {
    "function_name": "Add",
    "container": "Constructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "146-148",
    "snippet": "void Add(const std::string& key, const Slice& value) {\n    data_[key] = value.ToString();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "value.ToString",
          "args": [],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nConstructor {\n  void Add(const std::string& key, const Slice& value) {\n      data_[key] = value.ToString();\n    }\n}"
  },
  {
    "function_name": "Constructor",
    "container": "Constructor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "143-143",
    "snippet": "explicit Constructor(const Comparator* cmp) : data_(STLLessThan(cmp)) { }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STLLessThan",
          "args": [
            "cmp"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "STLLessThan",
          "container": "STLLessThan",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "83-83",
          "snippet": "STLLessThan(const Comparator* c) : cmp(c) { }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nSTLLessThan {\n  STLLessThan(const Comparator* c) : cmp(c) { }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nConstructor {\n  explicit Constructor(const Comparator* cmp) : data_(STLLessThan(cmp)) { }\n}"
  },
  {
    "function_name": "Read",
    "container": "StringSource",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "120-131",
    "snippet": "virtual Status Read(uint64_t offset, size_t n, Slice* result,\n                       char* scratch) const {\n    if (offset > contents_.size()) {\n      return Status::InvalidArgument(\"invalid Read offset\");\n    }\n    if (offset + n > contents_.size()) {\n      n = contents_.size() - offset;\n    }\n    memcpy(scratch, &contents_[offset], n);\n    *result = Slice(scratch, n);\n    return Status::OK();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "scratch",
            "n"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "scratch",
            "&contents_[offset]",
            "n"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contents_.size",
          "args": [],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "BlockHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/format.h",
          "lines": "31-31",
          "snippet": "uint64_t size() const { return size_; }",
          "includes": [
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <stdint.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/table_builder.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/slice.h\"\n#include <stdint.h>\n#include <string>\n\nBlockHandle {\n  uint64_t size() const { return size_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Status::InvalidArgument",
          "args": [
            "\"invalid Read offset\""
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "InvalidArgument",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "44-46",
          "snippet": "static Status InvalidArgument(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kInvalidArgument, msg, msg2);\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status InvalidArgument(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kInvalidArgument, msg, msg2);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nStringSource {\n  virtual Status Read(uint64_t offset, size_t n, Slice* result,\n                         char* scratch) const {\n      if (offset > contents_.size()) {\n        return Status::InvalidArgument(\"invalid Read offset\");\n      }\n      if (offset + n > contents_.size()) {\n        n = contents_.size() - offset;\n      }\n      memcpy(scratch, &contents_[offset], n);\n      *result = Slice(scratch, n);\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "Size",
    "container": "StringSource",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "118-118",
    "snippet": "uint64_t Size() const { return contents_.size(); }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "contents_.size",
          "args": [],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "BlockHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/format.h",
          "lines": "31-31",
          "snippet": "uint64_t size() const { return size_; }",
          "includes": [
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <stdint.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/table_builder.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/slice.h\"\n#include <stdint.h>\n#include <string>\n\nBlockHandle {\n  uint64_t size() const { return size_; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nStringSource {\n  uint64_t Size() const { return contents_.size(); }\n}"
  },
  {
    "function_name": "StringSource",
    "container": "StringSource",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "112-114",
    "snippet": "StringSource(const Slice& contents)\n      : contents_(contents.data(), contents.size()) {\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "contents.size",
          "args": [],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "BlockHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/format.h",
          "lines": "31-31",
          "snippet": "uint64_t size() const { return size_; }",
          "includes": [
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <stdint.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/table_builder.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/slice.h\"\n#include <stdint.h>\n#include <string>\n\nBlockHandle {\n  uint64_t size() const { return size_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "contents.data",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nStringSource {\n  StringSource(const Slice& contents)\n        : contents_(contents.data(), contents.size()) {\n    }\n}"
  },
  {
    "function_name": "Append",
    "container": "StringSink",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "100-103",
    "snippet": "virtual Status Append(const Slice& data) {\n    contents_.append(data.data(), data.size());\n    return Status::OK();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "contents_.append",
          "args": [
            "data.data()",
            "data.size()"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.size",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "BlockHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/format.h",
          "lines": "31-31",
          "snippet": "uint64_t size() const { return size_; }",
          "includes": [
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <stdint.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/table_builder.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/slice.h\"\n#include <stdint.h>\n#include <string>\n\nBlockHandle {\n  uint64_t size() const { return size_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.data",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nStringSink {\n  virtual Status Append(const Slice& data) {\n      contents_.append(data.data(), data.size());\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "Sync",
    "container": "StringSink",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "98-98",
    "snippet": "virtual Status Sync() { return Status::OK(); }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nStringSink {\n  virtual Status Sync() { return Status::OK(); }\n}"
  },
  {
    "function_name": "Flush",
    "container": "StringSink",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "97-97",
    "snippet": "virtual Status Flush() { return Status::OK(); }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nStringSink {\n  virtual Status Flush() { return Status::OK(); }\n}"
  },
  {
    "function_name": "Close",
    "container": "StringSink",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "96-96",
    "snippet": "virtual Status Close() { return Status::OK(); }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nStringSink {\n  virtual Status Close() { return Status::OK(); }\n}"
  },
  {
    "function_name": "STLLessThan",
    "container": "STLLessThan",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "83-83",
    "snippet": "STLLessThan(const Comparator* c) : cmp(c) { }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nSTLLessThan {\n  STLLessThan(const Comparator* c) : cmp(c) { }\n}"
  },
  {
    "function_name": "STLLessThan",
    "container": "STLLessThan",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "82-82",
    "snippet": "STLLessThan() : cmp(BytewiseComparator()) { }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "BytewiseComparatorImpl",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "19-19",
          "snippet": "BytewiseComparatorImpl() { }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  BytewiseComparatorImpl() { }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nSTLLessThan {\n  STLLessThan() : cmp(BytewiseComparator()) { }\n}"
  },
  {
    "function_name": "Increment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "66-75",
    "snippet": "static void Increment(const Comparator* cmp, std::string* key) {\n  if (cmp == BytewiseComparator()) {\n    key->push_back('\\0');\n  } else {\n    assert(cmp == &reverse_key_comparator);\n    std::string rev = Reverse(*key);\n    rev.push_back('\\0');\n    *key = Reverse(rev);\n  }\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Reverse",
          "args": [
            "rev"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "FindShortSuccessor",
          "container": "ReverseKeyComparator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "57-61",
          "snippet": "virtual void FindShortSuccessor(std::string* key) const {\n    std::string s = Reverse(*key);\n    BytewiseComparator()->FindShortSuccessor(&s);\n    *key = Reverse(s);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nReverseKeyComparator {\n  virtual void FindShortSuccessor(std::string* key) const {\n      std::string s = Reverse(*key);\n      BytewiseComparator()->FindShortSuccessor(&s);\n      *key = Reverse(s);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rev.push_back",
          "args": [
            "'\\0'"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "cmp == &reverse_key_comparator"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key->push_back",
          "args": [
            "'\\0'"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "BytewiseComparatorImpl",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "19-19",
          "snippet": "BytewiseComparatorImpl() { }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  BytewiseComparatorImpl() { }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nstatic void Increment(const Comparator* cmp, std::string* key) {\n  if (cmp == BytewiseComparator()) {\n    key->push_back('\\0');\n  } else {\n    assert(cmp == &reverse_key_comparator);\n    std::string rev = Reverse(*key);\n    rev.push_back('\\0');\n    *key = Reverse(rev);\n  }\n}"
  },
  {
    "function_name": "FindShortSuccessor",
    "container": "ReverseKeyComparator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "57-61",
    "snippet": "virtual void FindShortSuccessor(std::string* key) const {\n    std::string s = Reverse(*key);\n    BytewiseComparator()->FindShortSuccessor(&s);\n    *key = Reverse(s);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Reverse",
          "args": [
            "s"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "FindShortSuccessor",
          "container": "ReverseKeyComparator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "57-61",
          "snippet": "virtual void FindShortSuccessor(std::string* key) const {\n    std::string s = Reverse(*key);\n    BytewiseComparator()->FindShortSuccessor(&s);\n    *key = Reverse(s);\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [
            "&s"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "FindShortSuccessor",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "53-65",
          "snippet": "virtual void FindShortSuccessor(std::string* key) const {\n    // Find first character that can be incremented\n    size_t n = key->size();\n    for (size_t i = 0; i < n; i++) {\n      const uint8_t byte = (*key)[i];\n      if (byte != static_cast<uint8_t>(0xff)) {\n        (*key)[i] = byte + 1;\n        key->resize(i+1);\n        return;\n      }\n    }\n    // *key is a run of 0xffs.  Leave it alone.\n  }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  virtual void FindShortSuccessor(std::string* key) const {\n      // Find first character that can be incremented\n      size_t n = key->size();\n      for (size_t i = 0; i < n; i++) {\n        const uint8_t byte = (*key)[i];\n        if (byte != static_cast<uint8_t>(0xff)) {\n          (*key)[i] = byte + 1;\n          key->resize(i+1);\n          return;\n        }\n      }\n      // *key is a run of 0xffs.  Leave it alone.\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "BytewiseComparatorImpl",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "19-19",
          "snippet": "BytewiseComparatorImpl() { }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  BytewiseComparatorImpl() { }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nReverseKeyComparator {\n  virtual void FindShortSuccessor(std::string* key) const {\n      std::string s = Reverse(*key);\n      BytewiseComparator()->FindShortSuccessor(&s);\n      *key = Reverse(s);\n    }\n}"
  },
  {
    "function_name": "FindShortestSeparator",
    "container": "ReverseKeyComparator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "48-55",
    "snippet": "virtual void FindShortestSeparator(\n      std::string* start,\n      const Slice& limit) const {\n    std::string s = Reverse(*start);\n    std::string l = Reverse(limit);\n    BytewiseComparator()->FindShortestSeparator(&s, l);\n    *start = Reverse(s);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Reverse",
          "args": [
            "s"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "FindShortSuccessor",
          "container": "ReverseKeyComparator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "57-61",
          "snippet": "virtual void FindShortSuccessor(std::string* key) const {\n    std::string s = Reverse(*key);\n    BytewiseComparator()->FindShortSuccessor(&s);\n    *key = Reverse(s);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nReverseKeyComparator {\n  virtual void FindShortSuccessor(std::string* key) const {\n      std::string s = Reverse(*key);\n      BytewiseComparator()->FindShortSuccessor(&s);\n      *key = Reverse(s);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [
            "&s",
            "l"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "FindShortestSeparator",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "29-51",
          "snippet": "virtual void FindShortestSeparator(\n      std::string* start,\n      const Slice& limit) const {\n    // Find length of common prefix\n    size_t min_length = std::min(start->size(), limit.size());\n    size_t diff_index = 0;\n    while ((diff_index < min_length) &&\n           ((*start)[diff_index] == limit[diff_index])) {\n      diff_index++;\n    }\n\n    if (diff_index >= min_length) {\n      // Do not shorten if one string is a prefix of the other\n    } else {\n      uint8_t diff_byte = static_cast<uint8_t>((*start)[diff_index]);\n      if (diff_byte < static_cast<uint8_t>(0xff) &&\n          diff_byte + 1 < static_cast<uint8_t>(limit[diff_index])) {\n        (*start)[diff_index]++;\n        start->resize(diff_index + 1);\n        assert(Compare(*start, limit) < 0);\n      }\n    }\n  }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  virtual void FindShortestSeparator(\n        std::string* start,\n        const Slice& limit) const {\n      // Find length of common prefix\n      size_t min_length = std::min(start->size(), limit.size());\n      size_t diff_index = 0;\n      while ((diff_index < min_length) &&\n             ((*start)[diff_index] == limit[diff_index])) {\n        diff_index++;\n      }\n  \n      if (diff_index >= min_length) {\n        // Do not shorten if one string is a prefix of the other\n      } else {\n        uint8_t diff_byte = static_cast<uint8_t>((*start)[diff_index]);\n        if (diff_byte < static_cast<uint8_t>(0xff) &&\n            diff_byte + 1 < static_cast<uint8_t>(limit[diff_index])) {\n          (*start)[diff_index]++;\n          start->resize(diff_index + 1);\n          assert(Compare(*start, limit) < 0);\n        }\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "BytewiseComparatorImpl",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "19-19",
          "snippet": "BytewiseComparatorImpl() { }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  BytewiseComparatorImpl() { }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nReverseKeyComparator {\n  virtual void FindShortestSeparator(\n        std::string* start,\n        const Slice& limit) const {\n      std::string s = Reverse(*start);\n      std::string l = Reverse(limit);\n      BytewiseComparator()->FindShortestSeparator(&s, l);\n      *start = Reverse(s);\n    }\n}"
  },
  {
    "function_name": "Compare",
    "container": "ReverseKeyComparator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "44-46",
    "snippet": "virtual int Compare(const Slice& a, const Slice& b) const {\n    return BytewiseComparator()->Compare(Reverse(a), Reverse(b));\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [
            "Reverse(a)",
            "Reverse(b)"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "FindShortestSeparator",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "29-51",
          "snippet": "virtual void FindShortestSeparator(\n      std::string* start,\n      const Slice& limit) const {\n    // Find length of common prefix\n    size_t min_length = std::min(start->size(), limit.size());\n    size_t diff_index = 0;\n    while ((diff_index < min_length) &&\n           ((*start)[diff_index] == limit[diff_index])) {\n      diff_index++;\n    }\n\n    if (diff_index >= min_length) {\n      // Do not shorten if one string is a prefix of the other\n    } else {\n      uint8_t diff_byte = static_cast<uint8_t>((*start)[diff_index]);\n      if (diff_byte < static_cast<uint8_t>(0xff) &&\n          diff_byte + 1 < static_cast<uint8_t>(limit[diff_index])) {\n        (*start)[diff_index]++;\n        start->resize(diff_index + 1);\n        assert(Compare(*start, limit) < 0);\n      }\n    }\n  }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  virtual void FindShortestSeparator(\n        std::string* start,\n        const Slice& limit) const {\n      // Find length of common prefix\n      size_t min_length = std::min(start->size(), limit.size());\n      size_t diff_index = 0;\n      while ((diff_index < min_length) &&\n             ((*start)[diff_index] == limit[diff_index])) {\n        diff_index++;\n      }\n  \n      if (diff_index >= min_length) {\n        // Do not shorten if one string is a prefix of the other\n      } else {\n        uint8_t diff_byte = static_cast<uint8_t>((*start)[diff_index]);\n        if (diff_byte < static_cast<uint8_t>(0xff) &&\n            diff_byte + 1 < static_cast<uint8_t>(limit[diff_index])) {\n          (*start)[diff_index]++;\n          start->resize(diff_index + 1);\n          assert(Compare(*start, limit) < 0);\n        }\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Reverse",
          "args": [
            "b"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "FindShortSuccessor",
          "container": "ReverseKeyComparator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "57-61",
          "snippet": "virtual void FindShortSuccessor(std::string* key) const {\n    std::string s = Reverse(*key);\n    BytewiseComparator()->FindShortSuccessor(&s);\n    *key = Reverse(s);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nReverseKeyComparator {\n  virtual void FindShortSuccessor(std::string* key) const {\n      std::string s = Reverse(*key);\n      BytewiseComparator()->FindShortSuccessor(&s);\n      *key = Reverse(s);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "BytewiseComparatorImpl",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "19-19",
          "snippet": "BytewiseComparatorImpl() { }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  BytewiseComparatorImpl() { }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nReverseKeyComparator {\n  virtual int Compare(const Slice& a, const Slice& b) const {\n      return BytewiseComparator()->Compare(Reverse(a), Reverse(b));\n    }\n}"
  },
  {
    "function_name": "Reverse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
    "lines": "27-35",
    "snippet": "static std::string Reverse(const Slice& key) {\n  std::string str(key.ToString());\n  std::string rev(\"\");\n  for (std::string::reverse_iterator rit = str.rbegin();\n       rit != str.rend(); ++rit) {\n    rev.push_back(*rit);\n  }\n  return rev;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"table/format.h\"",
      "#include \"table/block_builder.h\"",
      "#include \"table/block.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include <string>",
      "#include <map>",
      "#include \"leveldb/table.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rev.push_back",
          "args": [
            "*rit"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.rend",
          "args": [],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.rbegin",
          "args": [],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.ToString",
          "args": [],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nstatic std::string Reverse(const Slice& key) {\n  std::string str(key.ToString());\n  std::string rev(\"\");\n  for (std::string::reverse_iterator rit = str.rbegin();\n       rit != str.rend(); ++rit) {\n    rev.push_back(*rit);\n  }\n  return rev;\n}"
  }
]