[
  {
    "function_name": "keyPressEvent",
    "container": "CoinControlTreeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroltreewidget.cpp",
    "lines": "10-28",
    "snippet": "void CoinControlTreeWidget::keyPressEvent(QKeyEvent *event)\n{\n    if (event->key() == Qt::Key_Space) // press spacebar -> select checkbox\n    {\n        event->ignore();\n        int COLUMN_CHECKBOX = 0;\n        this->currentItem()->setCheckState(COLUMN_CHECKBOX, ((this->currentItem()->checkState(COLUMN_CHECKBOX) == Qt::Checked) ? Qt::Unchecked : Qt::Checked));\n    }\n    else if (event->key() == Qt::Key_Escape) // press esc -> close dialog\n    {\n        event->ignore();\n        CoinControlDialog *coinControlDialog = (CoinControlDialog*)this->parentWidget();\n        coinControlDialog->done(QDialog::Accepted);\n    }\n    else\n    {\n        this->QTreeWidget::keyPressEvent(event);\n    }\n}",
    "includes": [
      "#include \"coincontroldialog.h\"",
      "#include \"coincontroltreewidget.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->QTreeWidget::keyPressEvent",
          "args": [
            "event"
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "keyPressEvent",
          "container": "CoinControlTreeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroltreewidget.cpp",
          "lines": "10-28",
          "snippet": "void CoinControlTreeWidget::keyPressEvent(QKeyEvent *event)\n{\n    if (event->key() == Qt::Key_Space) // press spacebar -> select checkbox\n    {\n        event->ignore();\n        int COLUMN_CHECKBOX = 0;\n        this->currentItem()->setCheckState(COLUMN_CHECKBOX, ((this->currentItem()->checkState(COLUMN_CHECKBOX) == Qt::Checked) ? Qt::Unchecked : Qt::Checked));\n    }\n    else if (event->key() == Qt::Key_Escape) // press esc -> close dialog\n    {\n        event->ignore();\n        CoinControlDialog *coinControlDialog = (CoinControlDialog*)this->parentWidget();\n        coinControlDialog->done(QDialog::Accepted);\n    }\n    else\n    {\n        this->QTreeWidget::keyPressEvent(event);\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "coinControlDialog->done",
          "args": [
            "QDialog::Accepted"
          ],
          "line": 22
        },
        "resolved": true,
        "details": {
          "function_name": "done",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "285-310",
          "snippet": "void AddressBookPage::done(int retval)\n{\n    QTableView *table = ui->tableView;\n    if(!table->selectionModel() || !table->model())\n        return;\n    // When this is a tab/widget and not a model dialog, ignore \"done\"\n    if(mode == ForEditing)\n        return;\n\n    // Figure out which address was selected, and return it\n    QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n\n    foreach (QModelIndex index, indexes)\n    {\n        QVariant address = table->model()->data(index);\n        returnValue = address.toString();\n    }\n\n    if(returnValue.isEmpty())\n    {\n        // If no address entry selected, return rejected\n        retval = Rejected;\n    }\n\n    QDialog::done(retval);\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::done(int retval)\n  {\n      QTableView *table = ui->tableView;\n      if(!table->selectionModel() || !table->model())\n          return;\n      // When this is a tab/widget and not a model dialog, ignore \"done\"\n      if(mode == ForEditing)\n          return;\n  \n      // Figure out which address was selected, and return it\n      QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n  \n      foreach (QModelIndex index, indexes)\n      {\n          QVariant address = table->model()->data(index);\n          returnValue = address.toString();\n      }\n  \n      if(returnValue.isEmpty())\n      {\n          // If no address entry selected, return rejected\n          retval = Rejected;\n      }\n  \n      QDialog::done(retval);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "this->parentWidget",
          "args": [],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "event->ignore",
          "args": [],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "event->key",
          "args": [],
          "line": 18
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "LRUHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "37-45",
          "snippet": "Slice key() const {\n    // For cheaper lookups, we allow a temporary Handle object\n    // to store a pointer to a key in \"value\".\n    if (next == this) {\n      return *(reinterpret_cast<Slice*>(value));\n    } else {\n      return Slice(key_data, key_length);\n    }\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nLRUHandle {\n  Slice key() const {\n      // For cheaper lookups, we allow a temporary Handle object\n      // to store a pointer to a key in \"value\".\n      if (next == this) {\n        return *(reinterpret_cast<Slice*>(value));\n      } else {\n        return Slice(key_data, key_length);\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "this->currentItem",
          "args": [
            "COLUMN_CHECKBOX",
            "((this->currentItem()->checkState(COLUMN_CHECKBOX) == Qt::Checked) ? Qt::Unchecked : Qt::Checked)"
          ],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->currentItem",
          "args": [
            "COLUMN_CHECKBOX"
          ],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->currentItem",
          "args": [],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->currentItem",
          "args": [],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "event->ignore",
          "args": [],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"coincontroldialog.h\"\n#include \"coincontroltreewidget.h\"\n\nCoinControlTreeWidget {\n  void CoinControlTreeWidget::keyPressEvent(QKeyEvent *event)\n  {\n      if (event->key() == Qt::Key_Space) // press spacebar -> select checkbox\n      {\n          event->ignore();\n          int COLUMN_CHECKBOX = 0;\n          this->currentItem()->setCheckState(COLUMN_CHECKBOX, ((this->currentItem()->checkState(COLUMN_CHECKBOX) == Qt::Checked) ? Qt::Unchecked : Qt::Checked));\n      }\n      else if (event->key() == Qt::Key_Escape) // press esc -> close dialog\n      {\n          event->ignore();\n          CoinControlDialog *coinControlDialog = (CoinControlDialog*)this->parentWidget();\n          coinControlDialog->done(QDialog::Accepted);\n      }\n      else\n      {\n          this->QTreeWidget::keyPressEvent(event);\n      }\n  }\n}"
  },
  {
    "function_name": "CoinControlTreeWidget",
    "container": "CoinControlTreeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroltreewidget.cpp",
    "lines": "4-8",
    "snippet": "CoinControlTreeWidget::CoinControlTreeWidget(QWidget *parent) :\n    QTreeWidget(parent)\n{\n\n}",
    "includes": [
      "#include \"coincontroldialog.h\"",
      "#include \"coincontroltreewidget.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"coincontroldialog.h\"\n#include \"coincontroltreewidget.h\"\n\nCoinControlTreeWidget {\n  CoinControlTreeWidget::CoinControlTreeWidget(QWidget *parent) :\n      QTreeWidget(parent)\n  {\n  \n  }\n}"
  }
]