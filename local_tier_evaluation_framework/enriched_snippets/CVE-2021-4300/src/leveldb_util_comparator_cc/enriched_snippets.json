[
  {
    "function_name": "InitModule",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
    "lines": "72-74",
    "snippet": "static void InitModule() {\n  bytewise = new BytewiseComparatorImpl;\n}",
    "includes": [
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include <stdint.h>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nstatic void InitModule() {\n  bytewise = new BytewiseComparatorImpl;\n}"
  },
  {
    "function_name": "FindShortSuccessor",
    "container": "BytewiseComparatorImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
    "lines": "53-65",
    "snippet": "virtual void FindShortSuccessor(std::string* key) const {\n    // Find first character that can be incremented\n    size_t n = key->size();\n    for (size_t i = 0; i < n; i++) {\n      const uint8_t byte = (*key)[i];\n      if (byte != static_cast<uint8_t>(0xff)) {\n        (*key)[i] = byte + 1;\n        key->resize(i+1);\n        return;\n      }\n    }\n    // *key is a run of 0xffs.  Leave it alone.\n  }",
    "includes": [
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include <stdint.h>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "key->resize",
          "args": [
            "i+1"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<uint8_t>",
          "args": [
            "0xff"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key->size",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  virtual void FindShortSuccessor(std::string* key) const {\n      // Find first character that can be incremented\n      size_t n = key->size();\n      for (size_t i = 0; i < n; i++) {\n        const uint8_t byte = (*key)[i];\n        if (byte != static_cast<uint8_t>(0xff)) {\n          (*key)[i] = byte + 1;\n          key->resize(i+1);\n          return;\n        }\n      }\n      // *key is a run of 0xffs.  Leave it alone.\n    }\n}"
  },
  {
    "function_name": "FindShortestSeparator",
    "container": "BytewiseComparatorImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
    "lines": "29-51",
    "snippet": "virtual void FindShortestSeparator(\n      std::string* start,\n      const Slice& limit) const {\n    // Find length of common prefix\n    size_t min_length = std::min(start->size(), limit.size());\n    size_t diff_index = 0;\n    while ((diff_index < min_length) &&\n           ((*start)[diff_index] == limit[diff_index])) {\n      diff_index++;\n    }\n\n    if (diff_index >= min_length) {\n      // Do not shorten if one string is a prefix of the other\n    } else {\n      uint8_t diff_byte = static_cast<uint8_t>((*start)[diff_index]);\n      if (diff_byte < static_cast<uint8_t>(0xff) &&\n          diff_byte + 1 < static_cast<uint8_t>(limit[diff_index])) {\n        (*start)[diff_index]++;\n        start->resize(diff_index + 1);\n        assert(Compare(*start, limit) < 0);\n      }\n    }\n  }",
    "includes": [
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include <stdint.h>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "Compare(*start, limit) < 0"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Compare",
          "args": [
            "*start",
            "limit"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "Compare",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "25-27",
          "snippet": "virtual int Compare(const Slice& a, const Slice& b) const {\n    return a.compare(b);\n  }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  virtual int Compare(const Slice& a, const Slice& b) const {\n      return a.compare(b);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "start->resize",
          "args": [
            "diff_index + 1"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<uint8_t>",
          "args": [
            "limit[diff_index]"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<uint8_t>",
          "args": [
            "0xff"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<uint8_t>",
          "args": [
            "(*start)[diff_index]"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::min",
          "args": [
            "start->size()",
            "limit.size()"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "limit.size",
          "args": [],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "31-31",
          "snippet": "size_type size() const { return map.size(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type size() const { return map.size(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "start->size",
          "args": [],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  virtual void FindShortestSeparator(\n        std::string* start,\n        const Slice& limit) const {\n      // Find length of common prefix\n      size_t min_length = std::min(start->size(), limit.size());\n      size_t diff_index = 0;\n      while ((diff_index < min_length) &&\n             ((*start)[diff_index] == limit[diff_index])) {\n        diff_index++;\n      }\n  \n      if (diff_index >= min_length) {\n        // Do not shorten if one string is a prefix of the other\n      } else {\n        uint8_t diff_byte = static_cast<uint8_t>((*start)[diff_index]);\n        if (diff_byte < static_cast<uint8_t>(0xff) &&\n            diff_byte + 1 < static_cast<uint8_t>(limit[diff_index])) {\n          (*start)[diff_index]++;\n          start->resize(diff_index + 1);\n          assert(Compare(*start, limit) < 0);\n        }\n      }\n    }\n}"
  },
  {
    "function_name": "Compare",
    "container": "BytewiseComparatorImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
    "lines": "25-27",
    "snippet": "virtual int Compare(const Slice& a, const Slice& b) const {\n    return a.compare(b);\n  }",
    "includes": [
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include <stdint.h>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a.compare",
          "args": [
            "b"
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "compare",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "96-104",
          "snippet": "inline int Slice::compare(const Slice& b) const {\n  const int min_len = (size_ < b.size_) ? size_ : b.size_;\n  int r = memcmp(data_, b.data_, min_len);\n  if (r == 0) {\n    if (size_ < b.size_) r = -1;\n    else if (size_ > b.size_) r = +1;\n  }\n  return r;\n}",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  inline int Slice::compare(const Slice& b) const {\n    const int min_len = (size_ < b.size_) ? size_ : b.size_;\n    int r = memcmp(data_, b.data_, min_len);\n    if (r == 0) {\n      if (size_ < b.size_) r = -1;\n      else if (size_ > b.size_) r = +1;\n    }\n    return r;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  virtual int Compare(const Slice& a, const Slice& b) const {\n      return a.compare(b);\n    }\n}"
  },
  {
    "function_name": "BytewiseComparatorImpl",
    "container": "BytewiseComparatorImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
    "lines": "19-19",
    "snippet": "BytewiseComparatorImpl() { }",
    "includes": [
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include <stdint.h>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  BytewiseComparatorImpl() { }\n}"
  },
  {
    "function_name": "~Comparator",
    "container": "Comparator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
    "lines": "14-14",
    "snippet": "Comparator::~Comparator() { }",
    "includes": [
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include <stdint.h>",
      "#include <algorithm>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nComparator {\n  Comparator::~Comparator() { }\n}"
  }
]