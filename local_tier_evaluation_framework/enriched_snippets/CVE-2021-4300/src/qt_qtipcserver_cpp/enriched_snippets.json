[
  {
    "function_name": "ipcInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qtipcserver.cpp",
    "lines": "120-160",
    "snippet": "void ipcInit(int argc, char *argv[])\n{\n    message_queue* mq = NULL;\n    char buffer[MAX_URI_LENGTH + 1] = \"\";\n    size_t nSize = 0;\n    unsigned int nPriority = 0;\n\n    try {\n        mq = new message_queue(open_or_create, BITCOINURI_QUEUE_NAME, 2, MAX_URI_LENGTH);\n\n        // Make sure we don't lose any bitcoin: URIs\n        for (int i = 0; i < 2; i++)\n        {\n            ptime d = boost::posix_time::microsec_clock::universal_time() + millisec(1);\n            if (mq->timed_receive(&buffer, sizeof(buffer), nSize, nPriority, d))\n            {\n                uiInterface.ThreadSafeHandleURI(std::string(buffer, nSize));\n            }\n            else\n                break;\n        }\n\n        // Make sure only one bitcoin instance is listening\n        message_queue::remove(BITCOINURI_QUEUE_NAME);\n        delete mq;\n\n        mq = new message_queue(open_or_create, BITCOINURI_QUEUE_NAME, 2, MAX_URI_LENGTH);\n    }\n    catch (interprocess_exception &ex) {\n        printf(\"ipcInit() - boost interprocess exception #%d: %s\\n\", ex.get_error_code(), ex.what());\n        return;\n    }\n\n    if (!NewThread(ipcThread, mq))\n    {\n        delete mq;\n        return;\n    }\n\n    ipcScanCmd(argc, argv, false);\n}",
    "includes": [
      "#include <boost/version.hpp>",
      "#include <boost/interprocess/ipc/message_queue.hpp>",
      "#include <boost/date_time/posix_time/posix_time.hpp>",
      "#include <boost/algorithm/string/predicate.hpp>",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"guiconstants.h\"",
      "#include \"qtipcserver.h\"",
      "#include <boost/version.hpp>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ipcScanCmd",
          "args": [
            "argc",
            "argv",
            "false"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "ipcScanCmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qtipcserver.cpp",
          "lines": "39-67",
          "snippet": "static bool ipcScanCmd(int argc, char *argv[], bool fRelay)\n{\n    // Check for URI in argv\n    bool fSent = false;\n    for (int i = 1; i < argc; i++)\n    {\n        if (boost::algorithm::istarts_with(argv[i], \"halcyon:\"))\n        {\n            const char *strURI = argv[i];\n            try {\n                boost::interprocess::message_queue mq(boost::interprocess::open_only, BITCOINURI_QUEUE_NAME);\n                if (mq.try_send(strURI, strlen(strURI), 0))\n                    fSent = true;\n                else if (fRelay)\n                    break;\n            }\n            catch (boost::interprocess::interprocess_exception &ex) {\n                // don't log the \"file not found\" exception, because that's normal for\n                // the first start of the first instance\n                if (ex.get_error_code() != boost::interprocess::not_found_error || !fRelay)\n                {\n                    printf(\"main() - boost interprocess exception #%d: %s\\n\", ex.get_error_code(), ex.what());\n                    break;\n                }\n            }\n        }\n    }\n    return fSent;\n}",
          "includes": [
            "#include <boost/version.hpp>",
            "#include <boost/interprocess/ipc/message_queue.hpp>",
            "#include <boost/date_time/posix_time/posix_time.hpp>",
            "#include <boost/algorithm/string/predicate.hpp>",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"guiconstants.h\"",
            "#include \"qtipcserver.h\"",
            "#include <boost/version.hpp>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/version.hpp>\n#include <boost/interprocess/ipc/message_queue.hpp>\n#include <boost/date_time/posix_time/posix_time.hpp>\n#include <boost/algorithm/string/predicate.hpp>\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"guiconstants.h\"\n#include \"qtipcserver.h\"\n#include <boost/version.hpp>\n\nstatic bool ipcScanCmd(int argc, char *argv[], bool fRelay)\n{\n    // Check for URI in argv\n    bool fSent = false;\n    for (int i = 1; i < argc; i++)\n    {\n        if (boost::algorithm::istarts_with(argv[i], \"halcyon:\"))\n        {\n            const char *strURI = argv[i];\n            try {\n                boost::interprocess::message_queue mq(boost::interprocess::open_only, BITCOINURI_QUEUE_NAME);\n                if (mq.try_send(strURI, strlen(strURI), 0))\n                    fSent = true;\n                else if (fRelay)\n                    break;\n            }\n            catch (boost::interprocess::interprocess_exception &ex) {\n                // don't log the \"file not found\" exception, because that's normal for\n                // the first start of the first instance\n                if (ex.get_error_code() != boost::interprocess::not_found_error || !fRelay)\n                {\n                    printf(\"main() - boost interprocess exception #%d: %s\\n\", ex.get_error_code(), ex.what());\n                    break;\n                }\n            }\n        }\n    }\n    return fSent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NewThread",
          "args": [
            "ipcThread",
            "mq"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "NewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1350-1360",
          "snippet": "bool NewThread(void(*pfn)(void*), void* parg)\n{\n    try\n    {\n        boost::thread(pfn, parg); // thread detaches when out of scope\n    } catch(boost::thread_resource_error &e) {\n        printf(\"Error creating thread: %s\\n\", e.what());\n        return false;\n    }\n    return true;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool NewThread(void(*pfn)(void*), void* parg)\n{\n    try\n    {\n        boost::thread(pfn, parg); // thread detaches when out of scope\n    } catch(boost::thread_resource_error &e) {\n        printf(\"Error creating thread: %s\\n\", e.what());\n        return false;\n    }\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ipcInit() - boost interprocess exception #%d: %s\\n\"",
            "ex.get_error_code()",
            "ex.what()"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ex.what",
          "args": [],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ex.get_error_code",
          "args": [],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message_queue::remove",
          "args": [
            "BITCOINURI_QUEUE_NAME"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uiInterface.ThreadSafeHandleURI",
          "args": [
            "std::string(buffer, nSize)"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "ThreadSafeHandleURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoin.cpp",
          "lines": "73-80",
          "snippet": "static void ThreadSafeHandleURI(const std::string& strURI)\n{\n    if(!guiref)\n        return;\n\n    QMetaObject::invokeMethod(guiref, \"handleURI\", GUIUtil::blockingGUIThreadConnection(),\n                               Q_ARG(QString, QString::fromStdString(strURI)));\n}",
          "includes": [
            "#include <QtPlugin>",
            "#include <QLibraryInfo>",
            "#include <QSplashScreen>",
            "#include <QTranslator>",
            "#include <QLocale>",
            "#include <QTextCodec>",
            "#include <QMessageBox>",
            "#include <QApplication>",
            "#include \"qtipcserver.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"guiconstants.h\"",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"clientmodel.h\"",
            "#include \"bitcoingui.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static BitcoinGUI *guiref;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <QtPlugin>\n#include <QLibraryInfo>\n#include <QSplashScreen>\n#include <QTranslator>\n#include <QLocale>\n#include <QTextCodec>\n#include <QMessageBox>\n#include <QApplication>\n#include \"qtipcserver.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"clientmodel.h\"\n#include \"bitcoingui.h\"\n\nstatic BitcoinGUI *guiref;\n\nstatic void ThreadSafeHandleURI(const std::string& strURI)\n{\n    if(!guiref)\n        return;\n\n    QMetaObject::invokeMethod(guiref, \"handleURI\", GUIUtil::blockingGUIThreadConnection(),\n                               Q_ARG(QString, QString::fromStdString(strURI)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "buffer",
            "nSize"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mq->timed_receive",
          "args": [
            "&buffer",
            "sizeof(buffer)",
            "nSize",
            "nPriority",
            "d"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "millisec",
          "args": [
            "1"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::posix_time::microsec_clock::universal_time",
          "args": [],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <boost/version.hpp>\n#include <boost/interprocess/ipc/message_queue.hpp>\n#include <boost/date_time/posix_time/posix_time.hpp>\n#include <boost/algorithm/string/predicate.hpp>\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"guiconstants.h\"\n#include \"qtipcserver.h\"\n#include <boost/version.hpp>\n\nvoid ipcInit(int argc, char *argv[])\n{\n    message_queue* mq = NULL;\n    char buffer[MAX_URI_LENGTH + 1] = \"\";\n    size_t nSize = 0;\n    unsigned int nPriority = 0;\n\n    try {\n        mq = new message_queue(open_or_create, BITCOINURI_QUEUE_NAME, 2, MAX_URI_LENGTH);\n\n        // Make sure we don't lose any bitcoin: URIs\n        for (int i = 0; i < 2; i++)\n        {\n            ptime d = boost::posix_time::microsec_clock::universal_time() + millisec(1);\n            if (mq->timed_receive(&buffer, sizeof(buffer), nSize, nPriority, d))\n            {\n                uiInterface.ThreadSafeHandleURI(std::string(buffer, nSize));\n            }\n            else\n                break;\n        }\n\n        // Make sure only one bitcoin instance is listening\n        message_queue::remove(BITCOINURI_QUEUE_NAME);\n        delete mq;\n\n        mq = new message_queue(open_or_create, BITCOINURI_QUEUE_NAME, 2, MAX_URI_LENGTH);\n    }\n    catch (interprocess_exception &ex) {\n        printf(\"ipcInit() - boost interprocess exception #%d: %s\\n\", ex.get_error_code(), ex.what());\n        return;\n    }\n\n    if (!NewThread(ipcThread, mq))\n    {\n        delete mq;\n        return;\n    }\n\n    ipcScanCmd(argc, argv, false);\n}"
  },
  {
    "function_name": "ipcThread2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qtipcserver.cpp",
    "lines": "92-118",
    "snippet": "static void ipcThread2(void* pArg)\n{\n    printf(\"ipcThread started\\n\");\n\n    message_queue* mq = (message_queue*)pArg;\n    char buffer[MAX_URI_LENGTH + 1] = \"\";\n    size_t nSize = 0;\n    unsigned int nPriority = 0;\n\n    while (true)\n    {\n        ptime d = boost::posix_time::microsec_clock::universal_time() + millisec(100);\n        if (mq->timed_receive(&buffer, sizeof(buffer), nSize, nPriority, d))\n        {\n            uiInterface.ThreadSafeHandleURI(std::string(buffer, nSize));\n            MilliSleep(1000);\n        }\n\n        if (fShutdown)\n            break;\n    }\n\n    // Remove message queue\n    message_queue::remove(BITCOINURI_QUEUE_NAME);\n    // Cleanup allocated memory\n    delete mq;\n}",
    "includes": [
      "#include <boost/version.hpp>",
      "#include <boost/interprocess/ipc/message_queue.hpp>",
      "#include <boost/date_time/posix_time/posix_time.hpp>",
      "#include <boost/algorithm/string/predicate.hpp>",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"guiconstants.h\"",
      "#include \"qtipcserver.h\"",
      "#include <boost/version.hpp>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "message_queue::remove",
          "args": [
            "BITCOINURI_QUEUE_NAME"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MilliSleep",
          "args": [
            "1000"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "MilliSleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "132-139",
          "snippet": "inline void MilliSleep(int64_t n)\n{\n#if BOOST_VERSION >= 105000\n    boost::this_thread::sleep_for(boost::chrono::milliseconds(n));\n#else\n    boost::this_thread::sleep(boost::posix_time::milliseconds(n));\n#endif\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline void MilliSleep(int64_t n)\n{\n#if BOOST_VERSION >= 105000\n    boost::this_thread::sleep_for(boost::chrono::milliseconds(n));\n#else\n    boost::this_thread::sleep(boost::posix_time::milliseconds(n));\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "uiInterface.ThreadSafeHandleURI",
          "args": [
            "std::string(buffer, nSize)"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "ThreadSafeHandleURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoin.cpp",
          "lines": "73-80",
          "snippet": "static void ThreadSafeHandleURI(const std::string& strURI)\n{\n    if(!guiref)\n        return;\n\n    QMetaObject::invokeMethod(guiref, \"handleURI\", GUIUtil::blockingGUIThreadConnection(),\n                               Q_ARG(QString, QString::fromStdString(strURI)));\n}",
          "includes": [
            "#include <QtPlugin>",
            "#include <QLibraryInfo>",
            "#include <QSplashScreen>",
            "#include <QTranslator>",
            "#include <QLocale>",
            "#include <QTextCodec>",
            "#include <QMessageBox>",
            "#include <QApplication>",
            "#include \"qtipcserver.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"guiconstants.h\"",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"clientmodel.h\"",
            "#include \"bitcoingui.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static BitcoinGUI *guiref;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <QtPlugin>\n#include <QLibraryInfo>\n#include <QSplashScreen>\n#include <QTranslator>\n#include <QLocale>\n#include <QTextCodec>\n#include <QMessageBox>\n#include <QApplication>\n#include \"qtipcserver.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"clientmodel.h\"\n#include \"bitcoingui.h\"\n\nstatic BitcoinGUI *guiref;\n\nstatic void ThreadSafeHandleURI(const std::string& strURI)\n{\n    if(!guiref)\n        return;\n\n    QMetaObject::invokeMethod(guiref, \"handleURI\", GUIUtil::blockingGUIThreadConnection(),\n                               Q_ARG(QString, QString::fromStdString(strURI)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "buffer",
            "nSize"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mq->timed_receive",
          "args": [
            "&buffer",
            "sizeof(buffer)",
            "nSize",
            "nPriority",
            "d"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "millisec",
          "args": [
            "100"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::posix_time::microsec_clock::universal_time",
          "args": [],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ipcThread started\\n\""
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <boost/version.hpp>\n#include <boost/interprocess/ipc/message_queue.hpp>\n#include <boost/date_time/posix_time/posix_time.hpp>\n#include <boost/algorithm/string/predicate.hpp>\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"guiconstants.h\"\n#include \"qtipcserver.h\"\n#include <boost/version.hpp>\n\nstatic void ipcThread2(void* pArg)\n{\n    printf(\"ipcThread started\\n\");\n\n    message_queue* mq = (message_queue*)pArg;\n    char buffer[MAX_URI_LENGTH + 1] = \"\";\n    size_t nSize = 0;\n    unsigned int nPriority = 0;\n\n    while (true)\n    {\n        ptime d = boost::posix_time::microsec_clock::universal_time() + millisec(100);\n        if (mq->timed_receive(&buffer, sizeof(buffer), nSize, nPriority, d))\n        {\n            uiInterface.ThreadSafeHandleURI(std::string(buffer, nSize));\n            MilliSleep(1000);\n        }\n\n        if (fShutdown)\n            break;\n    }\n\n    // Remove message queue\n    message_queue::remove(BITCOINURI_QUEUE_NAME);\n    // Cleanup allocated memory\n    delete mq;\n}"
  },
  {
    "function_name": "ipcThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qtipcserver.cpp",
    "lines": "75-90",
    "snippet": "static void ipcThread(void* pArg)\n{\n    // Make this thread recognisable as the GUI-IPC thread\n    RenameThread(\"hal-gui-ipc\");\n\n    try\n    {\n        ipcThread2(pArg);\n    }\n    catch (std::exception& e) {\n        PrintExceptionContinue(&e, \"ipcThread()\");\n    } catch (...) {\n        PrintExceptionContinue(NULL, \"ipcThread()\");\n    }\n    printf(\"ipcThread exited\\n\");\n}",
    "includes": [
      "#include <boost/version.hpp>",
      "#include <boost/interprocess/ipc/message_queue.hpp>",
      "#include <boost/date_time/posix_time/posix_time.hpp>",
      "#include <boost/algorithm/string/predicate.hpp>",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"guiconstants.h\"",
      "#include \"qtipcserver.h\"",
      "#include <boost/version.hpp>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ipcThread exited\\n\""
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PrintExceptionContinue",
          "args": [
            "NULL",
            "\"ipcThread()\""
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "PrintExceptionContinue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1005-1011",
          "snippet": "void PrintExceptionContinue(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n\\n************************\\n%s\\n\", message.c_str());\n    fprintf(stderr, \"\\n\\n************************\\n%s\\n\", message.c_str());\n    strMiscWarning = message;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "string strMiscWarning;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring strMiscWarning;\n\nvoid PrintExceptionContinue(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n\\n************************\\n%s\\n\", message.c_str());\n    fprintf(stderr, \"\\n\\n************************\\n%s\\n\", message.c_str());\n    strMiscWarning = message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ipcThread2",
          "args": [
            "pArg"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "ipcThread2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qtipcserver.cpp",
          "lines": "92-118",
          "snippet": "static void ipcThread2(void* pArg)\n{\n    printf(\"ipcThread started\\n\");\n\n    message_queue* mq = (message_queue*)pArg;\n    char buffer[MAX_URI_LENGTH + 1] = \"\";\n    size_t nSize = 0;\n    unsigned int nPriority = 0;\n\n    while (true)\n    {\n        ptime d = boost::posix_time::microsec_clock::universal_time() + millisec(100);\n        if (mq->timed_receive(&buffer, sizeof(buffer), nSize, nPriority, d))\n        {\n            uiInterface.ThreadSafeHandleURI(std::string(buffer, nSize));\n            MilliSleep(1000);\n        }\n\n        if (fShutdown)\n            break;\n    }\n\n    // Remove message queue\n    message_queue::remove(BITCOINURI_QUEUE_NAME);\n    // Cleanup allocated memory\n    delete mq;\n}",
          "includes": [
            "#include <boost/version.hpp>",
            "#include <boost/interprocess/ipc/message_queue.hpp>",
            "#include <boost/date_time/posix_time/posix_time.hpp>",
            "#include <boost/algorithm/string/predicate.hpp>",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"guiconstants.h\"",
            "#include \"qtipcserver.h\"",
            "#include <boost/version.hpp>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/version.hpp>\n#include <boost/interprocess/ipc/message_queue.hpp>\n#include <boost/date_time/posix_time/posix_time.hpp>\n#include <boost/algorithm/string/predicate.hpp>\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"guiconstants.h\"\n#include \"qtipcserver.h\"\n#include <boost/version.hpp>\n\nstatic void ipcThread2(void* pArg)\n{\n    printf(\"ipcThread started\\n\");\n\n    message_queue* mq = (message_queue*)pArg;\n    char buffer[MAX_URI_LENGTH + 1] = \"\";\n    size_t nSize = 0;\n    unsigned int nPriority = 0;\n\n    while (true)\n    {\n        ptime d = boost::posix_time::microsec_clock::universal_time() + millisec(100);\n        if (mq->timed_receive(&buffer, sizeof(buffer), nSize, nPriority, d))\n        {\n            uiInterface.ThreadSafeHandleURI(std::string(buffer, nSize));\n            MilliSleep(1000);\n        }\n\n        if (fShutdown)\n            break;\n    }\n\n    // Remove message queue\n    message_queue::remove(BITCOINURI_QUEUE_NAME);\n    // Cleanup allocated memory\n    delete mq;\n}"
        }
      },
      {
        "call_info": {
          "callee": "RenameThread",
          "args": [
            "\"hal-gui-ipc\""
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "RenameThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1329-1348",
          "snippet": "void RenameThread(const char* name)\n{\n#if defined(PR_SET_NAME)\n    // Only the first 15 characters are used (16 - NUL terminator)\n    ::prctl(PR_SET_NAME, name, 0, 0, 0);\n#elif 0 && (defined(__FreeBSD__) || defined(__OpenBSD__))\n    // TODO: This is currently disabled because it needs to be verified to work\n    //       on FreeBSD or OpenBSD first. When verified the '0 &&' part can be\n    //       removed.\n    pthread_set_name_np(pthread_self(), name);\n\n// This is XCode 10.6-and-later; bring back if we drop 10.5 support:\n// #elif defined(MAC_OSX)\n//    pthread_setname_np(name);\n\n#else\n    // Prevent warnings for unused parameters...\n    (void)name;\n#endif\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvoid RenameThread(const char* name)\n{\n#if defined(PR_SET_NAME)\n    // Only the first 15 characters are used (16 - NUL terminator)\n    ::prctl(PR_SET_NAME, name, 0, 0, 0);\n#elif 0 && (defined(__FreeBSD__) || defined(__OpenBSD__))\n    // TODO: This is currently disabled because it needs to be verified to work\n    //       on FreeBSD or OpenBSD first. When verified the '0 &&' part can be\n    //       removed.\n    pthread_set_name_np(pthread_self(), name);\n\n// This is XCode 10.6-and-later; bring back if we drop 10.5 support:\n// #elif defined(MAC_OSX)\n//    pthread_setname_np(name);\n\n#else\n    // Prevent warnings for unused parameters...\n    (void)name;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <boost/version.hpp>\n#include <boost/interprocess/ipc/message_queue.hpp>\n#include <boost/date_time/posix_time/posix_time.hpp>\n#include <boost/algorithm/string/predicate.hpp>\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"guiconstants.h\"\n#include \"qtipcserver.h\"\n#include <boost/version.hpp>\n\nstatic void ipcThread(void* pArg)\n{\n    // Make this thread recognisable as the GUI-IPC thread\n    RenameThread(\"hal-gui-ipc\");\n\n    try\n    {\n        ipcThread2(pArg);\n    }\n    catch (std::exception& e) {\n        PrintExceptionContinue(&e, \"ipcThread()\");\n    } catch (...) {\n        PrintExceptionContinue(NULL, \"ipcThread()\");\n    }\n    printf(\"ipcThread exited\\n\");\n}"
  },
  {
    "function_name": "ipcScanRelay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qtipcserver.cpp",
    "lines": "69-73",
    "snippet": "void ipcScanRelay(int argc, char *argv[])\n{\n    if (ipcScanCmd(argc, argv, true))\n        exit(0);\n}",
    "includes": [
      "#include <boost/version.hpp>",
      "#include <boost/interprocess/ipc/message_queue.hpp>",
      "#include <boost/date_time/posix_time/posix_time.hpp>",
      "#include <boost/algorithm/string/predicate.hpp>",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"guiconstants.h\"",
      "#include \"qtipcserver.h\"",
      "#include <boost/version.hpp>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "0"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ipcScanCmd",
          "args": [
            "argc",
            "argv",
            "true"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "ipcScanCmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qtipcserver.cpp",
          "lines": "39-67",
          "snippet": "static bool ipcScanCmd(int argc, char *argv[], bool fRelay)\n{\n    // Check for URI in argv\n    bool fSent = false;\n    for (int i = 1; i < argc; i++)\n    {\n        if (boost::algorithm::istarts_with(argv[i], \"halcyon:\"))\n        {\n            const char *strURI = argv[i];\n            try {\n                boost::interprocess::message_queue mq(boost::interprocess::open_only, BITCOINURI_QUEUE_NAME);\n                if (mq.try_send(strURI, strlen(strURI), 0))\n                    fSent = true;\n                else if (fRelay)\n                    break;\n            }\n            catch (boost::interprocess::interprocess_exception &ex) {\n                // don't log the \"file not found\" exception, because that's normal for\n                // the first start of the first instance\n                if (ex.get_error_code() != boost::interprocess::not_found_error || !fRelay)\n                {\n                    printf(\"main() - boost interprocess exception #%d: %s\\n\", ex.get_error_code(), ex.what());\n                    break;\n                }\n            }\n        }\n    }\n    return fSent;\n}",
          "includes": [
            "#include <boost/version.hpp>",
            "#include <boost/interprocess/ipc/message_queue.hpp>",
            "#include <boost/date_time/posix_time/posix_time.hpp>",
            "#include <boost/algorithm/string/predicate.hpp>",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"guiconstants.h\"",
            "#include \"qtipcserver.h\"",
            "#include <boost/version.hpp>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/version.hpp>\n#include <boost/interprocess/ipc/message_queue.hpp>\n#include <boost/date_time/posix_time/posix_time.hpp>\n#include <boost/algorithm/string/predicate.hpp>\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"guiconstants.h\"\n#include \"qtipcserver.h\"\n#include <boost/version.hpp>\n\nstatic bool ipcScanCmd(int argc, char *argv[], bool fRelay)\n{\n    // Check for URI in argv\n    bool fSent = false;\n    for (int i = 1; i < argc; i++)\n    {\n        if (boost::algorithm::istarts_with(argv[i], \"halcyon:\"))\n        {\n            const char *strURI = argv[i];\n            try {\n                boost::interprocess::message_queue mq(boost::interprocess::open_only, BITCOINURI_QUEUE_NAME);\n                if (mq.try_send(strURI, strlen(strURI), 0))\n                    fSent = true;\n                else if (fRelay)\n                    break;\n            }\n            catch (boost::interprocess::interprocess_exception &ex) {\n                // don't log the \"file not found\" exception, because that's normal for\n                // the first start of the first instance\n                if (ex.get_error_code() != boost::interprocess::not_found_error || !fRelay)\n                {\n                    printf(\"main() - boost interprocess exception #%d: %s\\n\", ex.get_error_code(), ex.what());\n                    break;\n                }\n            }\n        }\n    }\n    return fSent;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <boost/version.hpp>\n#include <boost/interprocess/ipc/message_queue.hpp>\n#include <boost/date_time/posix_time/posix_time.hpp>\n#include <boost/algorithm/string/predicate.hpp>\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"guiconstants.h\"\n#include \"qtipcserver.h\"\n#include <boost/version.hpp>\n\nvoid ipcScanRelay(int argc, char *argv[])\n{\n    if (ipcScanCmd(argc, argv, true))\n        exit(0);\n}"
  },
  {
    "function_name": "ipcScanCmd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qtipcserver.cpp",
    "lines": "39-67",
    "snippet": "static bool ipcScanCmd(int argc, char *argv[], bool fRelay)\n{\n    // Check for URI in argv\n    bool fSent = false;\n    for (int i = 1; i < argc; i++)\n    {\n        if (boost::algorithm::istarts_with(argv[i], \"halcyon:\"))\n        {\n            const char *strURI = argv[i];\n            try {\n                boost::interprocess::message_queue mq(boost::interprocess::open_only, BITCOINURI_QUEUE_NAME);\n                if (mq.try_send(strURI, strlen(strURI), 0))\n                    fSent = true;\n                else if (fRelay)\n                    break;\n            }\n            catch (boost::interprocess::interprocess_exception &ex) {\n                // don't log the \"file not found\" exception, because that's normal for\n                // the first start of the first instance\n                if (ex.get_error_code() != boost::interprocess::not_found_error || !fRelay)\n                {\n                    printf(\"main() - boost interprocess exception #%d: %s\\n\", ex.get_error_code(), ex.what());\n                    break;\n                }\n            }\n        }\n    }\n    return fSent;\n}",
    "includes": [
      "#include <boost/version.hpp>",
      "#include <boost/interprocess/ipc/message_queue.hpp>",
      "#include <boost/date_time/posix_time/posix_time.hpp>",
      "#include <boost/algorithm/string/predicate.hpp>",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"guiconstants.h\"",
      "#include \"qtipcserver.h\"",
      "#include <boost/version.hpp>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"main() - boost interprocess exception #%d: %s\\n\"",
            "ex.get_error_code()",
            "ex.what()"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ex.what",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ex.get_error_code",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ex.get_error_code",
          "args": [],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mq.try_send",
          "args": [
            "strURI",
            "strlen(strURI)",
            "0"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "strURI"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::algorithm::istarts_with",
          "args": [
            "argv[i]",
            "\"halcyon:\""
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <boost/version.hpp>\n#include <boost/interprocess/ipc/message_queue.hpp>\n#include <boost/date_time/posix_time/posix_time.hpp>\n#include <boost/algorithm/string/predicate.hpp>\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"guiconstants.h\"\n#include \"qtipcserver.h\"\n#include <boost/version.hpp>\n\nstatic bool ipcScanCmd(int argc, char *argv[], bool fRelay)\n{\n    // Check for URI in argv\n    bool fSent = false;\n    for (int i = 1; i < argc; i++)\n    {\n        if (boost::algorithm::istarts_with(argv[i], \"halcyon:\"))\n        {\n            const char *strURI = argv[i];\n            try {\n                boost::interprocess::message_queue mq(boost::interprocess::open_only, BITCOINURI_QUEUE_NAME);\n                if (mq.try_send(strURI, strlen(strURI), 0))\n                    fSent = true;\n                else if (fRelay)\n                    break;\n            }\n            catch (boost::interprocess::interprocess_exception &ex) {\n                // don't log the \"file not found\" exception, because that's normal for\n                // the first start of the first instance\n                if (ex.get_error_code() != boost::interprocess::not_found_error || !fRelay)\n                {\n                    printf(\"main() - boost interprocess exception #%d: %s\\n\", ex.get_error_code(), ex.what());\n                    break;\n                }\n            }\n        }\n    }\n    return fSent;\n}"
  },
  {
    "function_name": "ipcInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qtipcserver.cpp",
    "lines": "33-33",
    "snippet": "void ipcInit(int argc, char *argv[]) { }",
    "includes": [
      "#include <boost/version.hpp>",
      "#include <boost/interprocess/ipc/message_queue.hpp>",
      "#include <boost/date_time/posix_time/posix_time.hpp>",
      "#include <boost/algorithm/string/predicate.hpp>",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"guiconstants.h\"",
      "#include \"qtipcserver.h\"",
      "#include <boost/version.hpp>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <boost/version.hpp>\n#include <boost/interprocess/ipc/message_queue.hpp>\n#include <boost/date_time/posix_time/posix_time.hpp>\n#include <boost/algorithm/string/predicate.hpp>\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"guiconstants.h\"\n#include \"qtipcserver.h\"\n#include <boost/version.hpp>\n\nvoid ipcInit(int argc, char *argv[]) { }"
  },
  {
    "function_name": "ipcScanRelay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qtipcserver.cpp",
    "lines": "32-32",
    "snippet": "void ipcScanRelay(int argc, char *argv[]) { }",
    "includes": [
      "#include <boost/version.hpp>",
      "#include <boost/interprocess/ipc/message_queue.hpp>",
      "#include <boost/date_time/posix_time/posix_time.hpp>",
      "#include <boost/algorithm/string/predicate.hpp>",
      "#include \"util.h\"",
      "#include \"ui_interface.h\"",
      "#include \"guiconstants.h\"",
      "#include \"qtipcserver.h\"",
      "#include <boost/version.hpp>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <boost/version.hpp>\n#include <boost/interprocess/ipc/message_queue.hpp>\n#include <boost/date_time/posix_time/posix_time.hpp>\n#include <boost/algorithm/string/predicate.hpp>\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"guiconstants.h\"\n#include \"qtipcserver.h\"\n#include <boost/version.hpp>\n\nvoid ipcScanRelay(int argc, char *argv[]) { }"
  }
]