[
  {
    "function_name": "showExplorer",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "444-455",
    "snippet": "void TransactionView::showExplorer() {\n\n    if(!transactionView->selectionModel()) return;\n\n    QModelIndexList selection = transactionView->selectionModel()->selectedRows();\n    QString TxID;\n\n    if(!selection.isEmpty())\n      TxID = selection.at(0).data(TransactionTableModel::TxIDRole).toString();\n\n    emit(blockExplorerSignal(TxID));\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "emit",
          "args": [
            "blockExplorerSignal(TxID)"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "emitDataChanged",
          "container": "AddressTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
          "lines": "423-426",
          "snippet": "void AddressTableModel::emitDataChanged(int idx)\n{\n    emit dataChanged(index(idx, 0, QModelIndex()), index(idx, columns.length()-1, QModelIndex()));\n}",
          "includes": [
            "#include <QColor>",
            "#include <QFont>",
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  void AddressTableModel::emitDataChanged(int idx)\n  {\n      emit dataChanged(index(idx, 0, QModelIndex()), index(idx, columns.length()-1, QModelIndex()));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "blockExplorerSignal",
          "args": [
            "TxID"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.at",
          "args": [],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.at",
          "args": [
            "TransactionTableModel::TxIDRole"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.at",
          "args": [
            "0"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.isEmpty",
          "args": [],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->selectionModel",
          "args": [],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->selectionModel",
          "args": [],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->selectionModel",
          "args": [],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::showExplorer() {\n  \n      if(!transactionView->selectionModel()) return;\n  \n      QModelIndexList selection = transactionView->selectionModel()->selectedRows();\n      QString TxID;\n  \n      if(!selection.isEmpty())\n        TxID = selection.at(0).data(TransactionTableModel::TxIDRole).toString();\n  \n      emit(blockExplorerSignal(TxID));\n  }\n}"
  },
  {
    "function_name": "focusTransaction",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "434-442",
    "snippet": "void TransactionView::focusTransaction(const QModelIndex &idx)\n{\n    if(!transactionProxyModel)\n        return;\n    QModelIndex targetIdx = transactionProxyModel->mapFromSource(idx);\n    transactionView->scrollTo(targetIdx);\n    transactionView->setCurrentIndex(targetIdx);\n    transactionView->setFocus();\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "transactionView->setFocus",
          "args": [],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "setFocus",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "162-165",
          "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setFocus()\n  {\n      ui->payTo->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "transactionView->setCurrentIndex",
          "args": [
            "targetIdx"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->scrollTo",
          "args": [
            "targetIdx"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionProxyModel->mapFromSource",
          "args": [
            "idx"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::focusTransaction(const QModelIndex &idx)\n  {\n      if(!transactionProxyModel)\n          return;\n      QModelIndex targetIdx = transactionProxyModel->mapFromSource(idx);\n      transactionView->scrollTo(targetIdx);\n      transactionView->setCurrentIndex(targetIdx);\n      transactionView->setFocus();\n  }\n}"
  },
  {
    "function_name": "dateRangeChanged",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "425-432",
    "snippet": "void TransactionView::dateRangeChanged()\n{\n    if(!transactionProxyModel)\n        return;\n    transactionProxyModel->setDateRange(\n            QDateTime(dateFrom->date()),\n            QDateTime(dateTo->date()).addDays(1));\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "transactionProxyModel->setDateRange",
          "args": [
            "QDateTime(dateFrom->date())",
            "QDateTime(dateTo->date()).addDays(1)"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "setDateRange",
          "container": "TransactionFilterProxy",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionfilterproxy.cpp",
          "lines": "52-57",
          "snippet": "void TransactionFilterProxy::setDateRange(const QDateTime &from, const QDateTime &to)\n{\n    this->dateFrom = from;\n    this->dateTo = to;\n    invalidateFilter();\n}",
          "includes": [
            "#include <cstdlib>",
            "#include <QDateTime>",
            "#include \"transactionrecord.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"transactionfilterproxy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdlib>\n#include <QDateTime>\n#include \"transactionrecord.h\"\n#include \"transactiontablemodel.h\"\n#include \"transactionfilterproxy.h\"\n\nTransactionFilterProxy {\n  void TransactionFilterProxy::setDateRange(const QDateTime &from, const QDateTime &to)\n  {\n      this->dateFrom = from;\n      this->dateTo = to;\n      invalidateFilter();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QDateTime",
          "args": [
            "1"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDateTime",
          "args": [
            "dateTo->date()"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateTo->date",
          "args": [],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDateTime",
          "args": [
            "dateFrom->date()"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateFrom->date",
          "args": [],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::dateRangeChanged()\n  {\n      if(!transactionProxyModel)\n          return;\n      transactionProxyModel->setDateRange(\n              QDateTime(dateFrom->date()),\n              QDateTime(dateTo->date()).addDays(1));\n  }\n}"
  },
  {
    "function_name": "showDetails",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "377-387",
    "snippet": "void TransactionView::showDetails()\n{\n    if(!transactionView->selectionModel())\n        return;\n    QModelIndexList selection = transactionView->selectionModel()->selectedRows();\n    if(!selection.isEmpty())\n    {\n        TransactionDescDialog dlg(selection.at(0));\n        dlg.exec();\n    }\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlg.exec",
          "args": [],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.at",
          "args": [
            "0"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.isEmpty",
          "args": [],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->selectionModel",
          "args": [],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->selectionModel",
          "args": [],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->selectionModel",
          "args": [],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::showDetails()\n  {\n      if(!transactionView->selectionModel())\n          return;\n      QModelIndexList selection = transactionView->selectionModel()->selectedRows();\n      if(!selection.isEmpty())\n      {\n          TransactionDescDialog dlg(selection.at(0));\n          dlg.exec();\n      }\n  }\n}"
  },
  {
    "function_name": "editLabel",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "331-375",
    "snippet": "void TransactionView::editLabel()\n{\n    if(!transactionView->selectionModel() ||!model)\n        return;\n    QModelIndexList selection = transactionView->selectionModel()->selectedRows();\n    if(!selection.isEmpty())\n    {\n        AddressTableModel *addressBook = model->getAddressTableModel();\n        if(!addressBook)\n            return;\n        QString address = selection.at(0).data(TransactionTableModel::AddressRole).toString();\n        if(address.isEmpty())\n        {\n            // If this transaction has no associated address, exit\n            return;\n        }\n        // Is address in address book? Address book can miss address when a transaction is\n        // sent from outside the UI.\n        int idx = addressBook->lookupAddress(address);\n        if(idx != -1)\n        {\n            // Edit sending / receiving address\n            QModelIndex modelIdx = addressBook->index(idx, 0, QModelIndex());\n            // Determine type of address, launch appropriate editor dialog type\n            QString type = modelIdx.data(AddressTableModel::TypeRole).toString();\n\n            EditAddressDialog dlg(type==AddressTableModel::Receive\n                                         ? EditAddressDialog::EditReceivingAddress\n                                         : EditAddressDialog::EditSendingAddress,\n                                  this);\n            dlg.setModel(addressBook);\n            dlg.loadRow(idx);\n            dlg.exec();\n        }\n        else\n        {\n            // Add sending address\n            EditAddressDialog dlg(EditAddressDialog::NewSendingAddress,\n                                  this);\n            dlg.setModel(addressBook);\n            dlg.setAddress(address);\n            dlg.exec();\n        }\n    }\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlg.exec",
          "args": [],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlg.setAddress",
          "args": [
            "address"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "setAddress",
          "container": "EditAddressDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
          "lines": "132-136",
          "snippet": "void EditAddressDialog::setAddress(const QString &address)\n{\n    this->address = address;\n    ui->addressEdit->setText(address);\n}",
          "includes": [
            "#include <QMessageBox>",
            "#include <QDataWidgetMapper>",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_editaddressdialog.h\"",
            "#include \"editaddressdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  void EditAddressDialog::setAddress(const QString &address)\n  {\n      this->address = address;\n      ui->addressEdit->setText(address);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlg.setModel",
          "args": [
            "addressBook"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "161-193",
          "snippet": "void TransactionView::setModel(WalletModel *model)\n{\n    this->model = model;\n    if(model)\n    {\n        transactionProxyModel = new TransactionFilterProxy(this);\n        transactionProxyModel->setSourceModel(model->getTransactionTableModel());\n        transactionProxyModel->setDynamicSortFilter(true);\n        transactionProxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n        transactionProxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n\n        transactionProxyModel->setSortRole(Qt::EditRole);\n\n        transactionView->setModel(transactionProxyModel);\n        transactionView->setAlternatingRowColors(true);\n        transactionView->setSelectionBehavior(QAbstractItemView::SelectRows);\n        transactionView->setSelectionMode(QAbstractItemView::ExtendedSelection);\n        transactionView->setSortingEnabled(true);\n        transactionView->sortByColumn(TransactionTableModel::Date, Qt::DescendingOrder);\n        transactionView->verticalHeader()->hide();\n\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Status, 23);\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Date, 120);\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Type, 120);\n        transactionView->horizontalHeader()->setResizeMode(\n                TransactionTableModel::ToAddress, QHeaderView::Stretch);\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Amount, 100);\n    }\n}",
          "includes": [
            "#include <QDateTimeEdit>",
            "#include <QLabel>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QMenu>",
            "#include <QPoint>",
            "#include <QMessageBox>",
            "#include <QPushButton>",
            "#include <QHeaderView>",
            "#include <QTableView>",
            "#include <QLineEdit>",
            "#include <QVBoxLayout>",
            "#include <QHBoxLayout>",
            "#include <QDoubleValidator>",
            "#include <QComboBox>",
            "#include <QScrollBar>",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"transactiondescdialog.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactionview.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::setModel(WalletModel *model)\n  {\n      this->model = model;\n      if(model)\n      {\n          transactionProxyModel = new TransactionFilterProxy(this);\n          transactionProxyModel->setSourceModel(model->getTransactionTableModel());\n          transactionProxyModel->setDynamicSortFilter(true);\n          transactionProxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n          transactionProxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n  \n          transactionProxyModel->setSortRole(Qt::EditRole);\n  \n          transactionView->setModel(transactionProxyModel);\n          transactionView->setAlternatingRowColors(true);\n          transactionView->setSelectionBehavior(QAbstractItemView::SelectRows);\n          transactionView->setSelectionMode(QAbstractItemView::ExtendedSelection);\n          transactionView->setSortingEnabled(true);\n          transactionView->sortByColumn(TransactionTableModel::Date, Qt::DescendingOrder);\n          transactionView->verticalHeader()->hide();\n  \n          transactionView->horizontalHeader()->resizeSection(\n                  TransactionTableModel::Status, 23);\n          transactionView->horizontalHeader()->resizeSection(\n                  TransactionTableModel::Date, 120);\n          transactionView->horizontalHeader()->resizeSection(\n                  TransactionTableModel::Type, 120);\n          transactionView->horizontalHeader()->setResizeMode(\n                  TransactionTableModel::ToAddress, QHeaderView::Stretch);\n          transactionView->horizontalHeader()->resizeSection(\n                  TransactionTableModel::Amount, 100);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlg.exec",
          "args": [],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlg.loadRow",
          "args": [
            "idx"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "loadRow",
          "container": "EditAddressDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
          "lines": "55-58",
          "snippet": "void EditAddressDialog::loadRow(int row)\n{\n    mapper->setCurrentIndex(row);\n}",
          "includes": [
            "#include <QMessageBox>",
            "#include <QDataWidgetMapper>",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_editaddressdialog.h\"",
            "#include \"editaddressdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  void EditAddressDialog::loadRow(int row)\n  {\n      mapper->setCurrentIndex(row);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "modelIdx.data",
          "args": [],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "modelIdx.data",
          "args": [
            "AddressTableModel::TypeRole"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addressBook->index",
          "args": [
            "idx",
            "0",
            "QModelIndex()"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "index",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "604-616",
          "snippet": "QModelIndex TransactionTableModel::index(int row, int column, const QModelIndex &parent) const\n{\n    Q_UNUSED(parent);\n    TransactionRecord *data = priv->index(row);\n    if(data)\n    {\n        return createIndex(row, column, priv->index(row));\n    }\n    else\n    {\n        return QModelIndex();\n    }\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QModelIndex TransactionTableModel::index(int row, int column, const QModelIndex &parent) const\n  {\n      Q_UNUSED(parent);\n      TransactionRecord *data = priv->index(row);\n      if(data)\n      {\n          return createIndex(row, column, priv->index(row));\n      }\n      else\n      {\n          return QModelIndex();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QModelIndex",
          "args": [],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addressBook->lookupAddress",
          "args": [
            "address"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "lookupAddress",
          "container": "AddressTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
          "lines": "409-421",
          "snippet": "int AddressTableModel::lookupAddress(const QString &address) const\n{\n    QModelIndexList lst = match(index(0, Address, QModelIndex()),\n                                Qt::EditRole, address, 1, Qt::MatchExactly);\n    if(lst.isEmpty())\n    {\n        return -1;\n    }\n    else\n    {\n        return lst.at(0).row();\n    }\n}",
          "includes": [
            "#include <QColor>",
            "#include <QFont>",
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  int AddressTableModel::lookupAddress(const QString &address) const\n  {\n      QModelIndexList lst = match(index(0, Address, QModelIndex()),\n                                  Qt::EditRole, address, 1, Qt::MatchExactly);\n      if(lst.isEmpty())\n      {\n          return -1;\n      }\n      else\n      {\n          return lst.at(0).row();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "address.isEmpty",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.at",
          "args": [],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.at",
          "args": [
            "TransactionTableModel::AddressRole"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.at",
          "args": [
            "0"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.isEmpty",
          "args": [],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->selectionModel",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->selectionModel",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->selectionModel",
          "args": [],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::editLabel()\n  {\n      if(!transactionView->selectionModel() ||!model)\n          return;\n      QModelIndexList selection = transactionView->selectionModel()->selectedRows();\n      if(!selection.isEmpty())\n      {\n          AddressTableModel *addressBook = model->getAddressTableModel();\n          if(!addressBook)\n              return;\n          QString address = selection.at(0).data(TransactionTableModel::AddressRole).toString();\n          if(address.isEmpty())\n          {\n              // If this transaction has no associated address, exit\n              return;\n          }\n          // Is address in address book? Address book can miss address when a transaction is\n          // sent from outside the UI.\n          int idx = addressBook->lookupAddress(address);\n          if(idx != -1)\n          {\n              // Edit sending / receiving address\n              QModelIndex modelIdx = addressBook->index(idx, 0, QModelIndex());\n              // Determine type of address, launch appropriate editor dialog type\n              QString type = modelIdx.data(AddressTableModel::TypeRole).toString();\n  \n              EditAddressDialog dlg(type==AddressTableModel::Receive\n                                           ? EditAddressDialog::EditReceivingAddress\n                                           : EditAddressDialog::EditSendingAddress,\n                                    this);\n              dlg.setModel(addressBook);\n              dlg.loadRow(idx);\n              dlg.exec();\n          }\n          else\n          {\n              // Add sending address\n              EditAddressDialog dlg(EditAddressDialog::NewSendingAddress,\n                                    this);\n              dlg.setModel(addressBook);\n              dlg.setAddress(address);\n              dlg.exec();\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "copyTxID",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "326-329",
    "snippet": "void TransactionView::copyTxID()\n{\n    GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::TxIDRole);\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GUIUtil::copyEntryData",
          "args": [
            "transactionView",
            "0",
            "TransactionTableModel::TxIDRole"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "copyEntryData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "153-164",
          "snippet": "void copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::copyTxID()\n  {\n      GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::TxIDRole);\n  }\n}"
  },
  {
    "function_name": "copyAmount",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "321-324",
    "snippet": "void TransactionView::copyAmount()\n{\n    GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::FormattedAmountRole);\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GUIUtil::copyEntryData",
          "args": [
            "transactionView",
            "0",
            "TransactionTableModel::FormattedAmountRole"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "copyEntryData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "153-164",
          "snippet": "void copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::copyAmount()\n  {\n      GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::FormattedAmountRole);\n  }\n}"
  },
  {
    "function_name": "copyLabel",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "316-319",
    "snippet": "void TransactionView::copyLabel()\n{\n    GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::LabelRole);\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GUIUtil::copyEntryData",
          "args": [
            "transactionView",
            "0",
            "TransactionTableModel::LabelRole"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "copyEntryData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "153-164",
          "snippet": "void copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::copyLabel()\n  {\n      GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::LabelRole);\n  }\n}"
  },
  {
    "function_name": "copyAddress",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "311-314",
    "snippet": "void TransactionView::copyAddress()\n{\n    GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::AddressRole);\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GUIUtil::copyEntryData",
          "args": [
            "transactionView",
            "0",
            "TransactionTableModel::AddressRole"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "copyEntryData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "153-164",
          "snippet": "void copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::copyAddress()\n  {\n      GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::AddressRole);\n  }\n}"
  },
  {
    "function_name": "contextualMenu",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "302-309",
    "snippet": "void TransactionView::contextualMenu(const QPoint &point)\n{\n    QModelIndex index = transactionView->indexAt(point);\n    if(index.isValid())\n    {\n        contextMenu->exec(QCursor::pos());\n    }\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "contextMenu->exec",
          "args": [
            "QCursor::pos()"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCursor::pos",
          "args": [],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.isValid",
          "args": [],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "WalletModel::UnlockContext",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.h",
          "lines": "106-106",
          "snippet": "bool isValid() const { return valid; }",
          "includes": [
            "#include \"allocators.h\" /* for SecureString */",
            "#include <map>",
            "#include <vector>",
            "#include <QObject>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"allocators.h\" /* for SecureString */\n#include <map>\n#include <vector>\n#include <QObject>\n\nWalletModel {\n  UnlockContext {\n    bool isValid() const { return valid; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "transactionView->indexAt",
          "args": [
            "point"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::contextualMenu(const QPoint &point)\n  {\n      QModelIndex index = transactionView->indexAt(point);\n      if(index.isValid())\n      {\n          contextMenu->exec(QCursor::pos());\n      }\n  }\n}"
  },
  {
    "function_name": "exportClicked",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "273-300",
    "snippet": "void TransactionView::exportClicked()\n{\n    // CSV is currently the only supported format\n    QString filename = GUIUtil::getSaveFileName(\n            this,\n            tr(\"Export Transaction Data\"), QString(),\n            tr(\"Comma separated file (*.csv)\"));\n\n    if (filename.isNull()) return;\n\n    CSVModelWriter writer(filename);\n\n    // name, column, role\n    writer.setModel(transactionProxyModel);\n    writer.addColumn(tr(\"Confirmed\"), 0, TransactionTableModel::ConfirmedRole);\n    writer.addColumn(tr(\"Date\"), 0, TransactionTableModel::DateRole);\n    writer.addColumn(tr(\"Type\"), TransactionTableModel::Type, Qt::EditRole);\n    writer.addColumn(tr(\"Label\"), 0, TransactionTableModel::LabelRole);\n    writer.addColumn(tr(\"Address\"), 0, TransactionTableModel::AddressRole);\n    writer.addColumn(tr(\"Amount\"), 0, TransactionTableModel::FormattedAmountRole);\n    writer.addColumn(tr(\"ID\"), 0, TransactionTableModel::TxIDRole);\n\n    if(!writer.write())\n    {\n        QMessageBox::critical(this, tr(\"Error exporting\"), tr(\"Could not write to file %1.\").arg(filename),\n                              QMessageBox::Abort, QMessageBox::Abort);\n    }\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QMessageBox::critical",
          "args": [
            "this",
            "tr(\"Error exporting\")",
            "tr(\"Could not write to file %1.\").arg(filename)",
            "QMessageBox::Abort",
            "QMessageBox::Abort"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "filename"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writer.write",
          "args": [],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "CSVModelWriter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
          "lines": "45-87",
          "snippet": "bool CSVModelWriter::write()\n{\n    QFile file(filename);\n    if(!file.open(QIODevice::WriteOnly | QIODevice::Text))\n        return false;\n    QTextStream out(&file);\n\n    int numRows = 0;\n    if(model)\n    {\n        numRows = model->rowCount();\n    }\n\n    // Header row\n    for(int i=0; i<columns.size(); ++i)\n    {\n        if(i!=0)\n        {\n            writeSep(out);\n        }\n        writeValue(out, columns[i].title);\n    }\n    writeNewline(out);\n\n    // Data rows\n    for(int j=0; j<numRows; ++j)\n    {\n        for(int i=0; i<columns.size(); ++i)\n        {\n            if(i!=0)\n            {\n                writeSep(out);\n            }\n            QVariant data = model->index(j, columns[i].column).data(columns[i].role);\n            writeValue(out, data.toString());\n        }\n        writeNewline(out);\n    }\n\n    file.close();\n\n    return file.error() == QFile::NoError;\n}",
          "includes": [
            "#include <QTextStream>",
            "#include <QFile>",
            "#include <QAbstractItemModel>",
            "#include \"csvmodelwriter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nCSVModelWriter {\n  bool CSVModelWriter::write()\n  {\n      QFile file(filename);\n      if(!file.open(QIODevice::WriteOnly | QIODevice::Text))\n          return false;\n      QTextStream out(&file);\n  \n      int numRows = 0;\n      if(model)\n      {\n          numRows = model->rowCount();\n      }\n  \n      // Header row\n      for(int i=0; i<columns.size(); ++i)\n      {\n          if(i!=0)\n          {\n              writeSep(out);\n          }\n          writeValue(out, columns[i].title);\n      }\n      writeNewline(out);\n  \n      // Data rows\n      for(int j=0; j<numRows; ++j)\n      {\n          for(int i=0; i<columns.size(); ++i)\n          {\n              if(i!=0)\n              {\n                  writeSep(out);\n              }\n              QVariant data = model->index(j, columns[i].column).data(columns[i].role);\n              writeValue(out, data.toString());\n          }\n          writeNewline(out);\n      }\n  \n      file.close();\n  \n      return file.error() == QFile::NoError;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writer.addColumn",
          "args": [
            "tr(\"ID\")",
            "0",
            "TransactionTableModel::TxIDRole"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "addColumn",
          "container": "CSVModelWriter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
          "lines": "18-26",
          "snippet": "void CSVModelWriter::addColumn(const QString &title, int column, int role)\n{\n    Column col;\n    col.title = title;\n    col.column = column;\n    col.role = role;\n\n    columns.append(col);\n}",
          "includes": [
            "#include <QTextStream>",
            "#include <QFile>",
            "#include <QAbstractItemModel>",
            "#include \"csvmodelwriter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nCSVModelWriter {\n  void CSVModelWriter::addColumn(const QString &title, int column, int role)\n  {\n      Column col;\n      col.title = title;\n      col.column = column;\n      col.role = role;\n  \n      columns.append(col);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writer.setModel",
          "args": [
            "transactionProxyModel"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "161-193",
          "snippet": "void TransactionView::setModel(WalletModel *model)\n{\n    this->model = model;\n    if(model)\n    {\n        transactionProxyModel = new TransactionFilterProxy(this);\n        transactionProxyModel->setSourceModel(model->getTransactionTableModel());\n        transactionProxyModel->setDynamicSortFilter(true);\n        transactionProxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n        transactionProxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n\n        transactionProxyModel->setSortRole(Qt::EditRole);\n\n        transactionView->setModel(transactionProxyModel);\n        transactionView->setAlternatingRowColors(true);\n        transactionView->setSelectionBehavior(QAbstractItemView::SelectRows);\n        transactionView->setSelectionMode(QAbstractItemView::ExtendedSelection);\n        transactionView->setSortingEnabled(true);\n        transactionView->sortByColumn(TransactionTableModel::Date, Qt::DescendingOrder);\n        transactionView->verticalHeader()->hide();\n\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Status, 23);\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Date, 120);\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Type, 120);\n        transactionView->horizontalHeader()->setResizeMode(\n                TransactionTableModel::ToAddress, QHeaderView::Stretch);\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Amount, 100);\n    }\n}",
          "includes": [
            "#include <QDateTimeEdit>",
            "#include <QLabel>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QMenu>",
            "#include <QPoint>",
            "#include <QMessageBox>",
            "#include <QPushButton>",
            "#include <QHeaderView>",
            "#include <QTableView>",
            "#include <QLineEdit>",
            "#include <QVBoxLayout>",
            "#include <QHBoxLayout>",
            "#include <QDoubleValidator>",
            "#include <QComboBox>",
            "#include <QScrollBar>",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"transactiondescdialog.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactionview.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::setModel(WalletModel *model)\n  {\n      this->model = model;\n      if(model)\n      {\n          transactionProxyModel = new TransactionFilterProxy(this);\n          transactionProxyModel->setSourceModel(model->getTransactionTableModel());\n          transactionProxyModel->setDynamicSortFilter(true);\n          transactionProxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n          transactionProxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n  \n          transactionProxyModel->setSortRole(Qt::EditRole);\n  \n          transactionView->setModel(transactionProxyModel);\n          transactionView->setAlternatingRowColors(true);\n          transactionView->setSelectionBehavior(QAbstractItemView::SelectRows);\n          transactionView->setSelectionMode(QAbstractItemView::ExtendedSelection);\n          transactionView->setSortingEnabled(true);\n          transactionView->sortByColumn(TransactionTableModel::Date, Qt::DescendingOrder);\n          transactionView->verticalHeader()->hide();\n  \n          transactionView->horizontalHeader()->resizeSection(\n                  TransactionTableModel::Status, 23);\n          transactionView->horizontalHeader()->resizeSection(\n                  TransactionTableModel::Date, 120);\n          transactionView->horizontalHeader()->resizeSection(\n                  TransactionTableModel::Type, 120);\n          transactionView->horizontalHeader()->setResizeMode(\n                  TransactionTableModel::ToAddress, QHeaderView::Stretch);\n          transactionView->horizontalHeader()->resizeSection(\n                  TransactionTableModel::Amount, 100);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "filename.isNull",
          "args": [],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::getSaveFileName",
          "args": [
            "this",
            "tr(\"Export Transaction Data\")",
            "QString()",
            "tr(\"Comma separated file (*.csv)\")"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::exportClicked()\n  {\n      // CSV is currently the only supported format\n      QString filename = GUIUtil::getSaveFileName(\n              this,\n              tr(\"Export Transaction Data\"), QString(),\n              tr(\"Comma separated file (*.csv)\"));\n  \n      if (filename.isNull()) return;\n  \n      CSVModelWriter writer(filename);\n  \n      // name, column, role\n      writer.setModel(transactionProxyModel);\n      writer.addColumn(tr(\"Confirmed\"), 0, TransactionTableModel::ConfirmedRole);\n      writer.addColumn(tr(\"Date\"), 0, TransactionTableModel::DateRole);\n      writer.addColumn(tr(\"Type\"), TransactionTableModel::Type, Qt::EditRole);\n      writer.addColumn(tr(\"Label\"), 0, TransactionTableModel::LabelRole);\n      writer.addColumn(tr(\"Address\"), 0, TransactionTableModel::AddressRole);\n      writer.addColumn(tr(\"Amount\"), 0, TransactionTableModel::FormattedAmountRole);\n      writer.addColumn(tr(\"ID\"), 0, TransactionTableModel::TxIDRole);\n  \n      if(!writer.write())\n      {\n          QMessageBox::critical(this, tr(\"Error exporting\"), tr(\"Could not write to file %1.\").arg(filename),\n                                QMessageBox::Abort, QMessageBox::Abort);\n      }\n  }\n}"
  },
  {
    "function_name": "changedAmount",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "258-271",
    "snippet": "void TransactionView::changedAmount(const QString &amount)\n{\n    if(!transactionProxyModel)\n        return;\n    qint64 amount_parsed = 0;\n    if(BitcoinUnits::parse(model->getOptionsModel()->getDisplayUnit(), amount, &amount_parsed))\n    {\n        transactionProxyModel->setMinAmount(amount_parsed);\n    }\n    else\n    {\n        transactionProxyModel->setMinAmount(0);\n    }\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "transactionProxyModel->setMinAmount",
          "args": [
            "0"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "setMinAmount",
          "container": "TransactionFilterProxy",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionfilterproxy.cpp",
          "lines": "71-75",
          "snippet": "void TransactionFilterProxy::setMinAmount(qint64 minimum)\n{\n    this->minAmount = minimum;\n    invalidateFilter();\n}",
          "includes": [
            "#include <cstdlib>",
            "#include <QDateTime>",
            "#include \"transactionrecord.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"transactionfilterproxy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdlib>\n#include <QDateTime>\n#include \"transactionrecord.h\"\n#include \"transactiontablemodel.h\"\n#include \"transactionfilterproxy.h\"\n\nTransactionFilterProxy {\n  void TransactionFilterProxy::setMinAmount(qint64 minimum)\n  {\n      this->minAmount = minimum;\n      invalidateFilter();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::parse",
          "args": [
            "model->getOptionsModel()->getDisplayUnit()",
            "amount",
            "&amount_parsed"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::changedAmount(const QString &amount)\n  {\n      if(!transactionProxyModel)\n          return;\n      qint64 amount_parsed = 0;\n      if(BitcoinUnits::parse(model->getOptionsModel()->getDisplayUnit(), amount, &amount_parsed))\n      {\n          transactionProxyModel->setMinAmount(amount_parsed);\n      }\n      else\n      {\n          transactionProxyModel->setMinAmount(0);\n      }\n  }\n}"
  },
  {
    "function_name": "changedPrefix",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "251-256",
    "snippet": "void TransactionView::changedPrefix(const QString &prefix)\n{\n    if(!transactionProxyModel)\n        return;\n    transactionProxyModel->setAddressPrefix(prefix);\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "transactionProxyModel->setAddressPrefix",
          "args": [
            "prefix"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "setAddressPrefix",
          "container": "TransactionFilterProxy",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionfilterproxy.cpp",
          "lines": "59-63",
          "snippet": "void TransactionFilterProxy::setAddressPrefix(const QString &addrPrefix)\n{\n    this->addrPrefix = addrPrefix;\n    invalidateFilter();\n}",
          "includes": [
            "#include <cstdlib>",
            "#include <QDateTime>",
            "#include \"transactionrecord.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"transactionfilterproxy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdlib>\n#include <QDateTime>\n#include \"transactionrecord.h\"\n#include \"transactiontablemodel.h\"\n#include \"transactionfilterproxy.h\"\n\nTransactionFilterProxy {\n  void TransactionFilterProxy::setAddressPrefix(const QString &addrPrefix)\n  {\n      this->addrPrefix = addrPrefix;\n      invalidateFilter();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::changedPrefix(const QString &prefix)\n  {\n      if(!transactionProxyModel)\n          return;\n      transactionProxyModel->setAddressPrefix(prefix);\n  }\n}"
  },
  {
    "function_name": "chooseType",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "243-249",
    "snippet": "void TransactionView::chooseType(int idx)\n{\n    if(!transactionProxyModel)\n        return;\n    transactionProxyModel->setTypeFilter(\n        typeWidget->itemData(idx).toInt());\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "transactionProxyModel->setTypeFilter",
          "args": [
            "typeWidget->itemData(idx).toInt()"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "setTypeFilter",
          "container": "TransactionFilterProxy",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionfilterproxy.cpp",
          "lines": "65-69",
          "snippet": "void TransactionFilterProxy::setTypeFilter(quint32 modes)\n{\n    this->typeFilter = modes;\n    invalidateFilter();\n}",
          "includes": [
            "#include <cstdlib>",
            "#include <QDateTime>",
            "#include \"transactionrecord.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"transactionfilterproxy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdlib>\n#include <QDateTime>\n#include \"transactionrecord.h\"\n#include \"transactiontablemodel.h\"\n#include \"transactionfilterproxy.h\"\n\nTransactionFilterProxy {\n  void TransactionFilterProxy::setTypeFilter(quint32 modes)\n  {\n      this->typeFilter = modes;\n      invalidateFilter();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "typeWidget->itemData",
          "args": [],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeWidget->itemData",
          "args": [
            "idx"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::chooseType(int idx)\n  {\n      if(!transactionProxyModel)\n          return;\n      transactionProxyModel->setTypeFilter(\n          typeWidget->itemData(idx).toInt());\n  }\n}"
  },
  {
    "function_name": "chooseDate",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "195-241",
    "snippet": "void TransactionView::chooseDate(int idx)\n{\n    if(!transactionProxyModel)\n        return;\n    QDate current = QDate::currentDate();\n    dateRangeWidget->setVisible(false);\n    switch(dateWidget->itemData(idx).toInt())\n    {\n    case All:\n        transactionProxyModel->setDateRange(\n                TransactionFilterProxy::MIN_DATE,\n                TransactionFilterProxy::MAX_DATE);\n        break;\n    case Today:\n        transactionProxyModel->setDateRange(\n                QDateTime(current),\n                TransactionFilterProxy::MAX_DATE);\n        break;\n    case ThisWeek: {\n        // Find last Monday\n        QDate startOfWeek = current.addDays(-(current.dayOfWeek()-1));\n        transactionProxyModel->setDateRange(\n                QDateTime(startOfWeek),\n                TransactionFilterProxy::MAX_DATE);\n\n        } break;\n    case ThisMonth:\n        transactionProxyModel->setDateRange(\n                QDateTime(QDate(current.year(), current.month(), 1)),\n                TransactionFilterProxy::MAX_DATE);\n        break;\n    case LastMonth:\n        transactionProxyModel->setDateRange(\n                QDateTime(QDate(current.year(), current.month()-1, 1)),\n                QDateTime(QDate(current.year(), current.month(), 1)));\n        break;\n    case ThisYear:\n        transactionProxyModel->setDateRange(\n                QDateTime(QDate(current.year(), 1, 1)),\n                TransactionFilterProxy::MAX_DATE);\n        break;\n    case Range:\n        dateRangeWidget->setVisible(true);\n        dateRangeChanged();\n        break;\n    }\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dateRangeChanged",
          "args": [],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "dateRangeChanged",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "425-432",
          "snippet": "void TransactionView::dateRangeChanged()\n{\n    if(!transactionProxyModel)\n        return;\n    transactionProxyModel->setDateRange(\n            QDateTime(dateFrom->date()),\n            QDateTime(dateTo->date()).addDays(1));\n}",
          "includes": [
            "#include <QDateTimeEdit>",
            "#include <QLabel>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QMenu>",
            "#include <QPoint>",
            "#include <QMessageBox>",
            "#include <QPushButton>",
            "#include <QHeaderView>",
            "#include <QTableView>",
            "#include <QLineEdit>",
            "#include <QVBoxLayout>",
            "#include <QHBoxLayout>",
            "#include <QDoubleValidator>",
            "#include <QComboBox>",
            "#include <QScrollBar>",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"transactiondescdialog.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactionview.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::dateRangeChanged()\n  {\n      if(!transactionProxyModel)\n          return;\n      transactionProxyModel->setDateRange(\n              QDateTime(dateFrom->date()),\n              QDateTime(dateTo->date()).addDays(1));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dateRangeWidget->setVisible",
          "args": [
            "true"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionProxyModel->setDateRange",
          "args": [
            "QDateTime(QDate(current.year(), 1, 1))",
            "TransactionFilterProxy::MAX_DATE"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "setDateRange",
          "container": "TransactionFilterProxy",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionfilterproxy.cpp",
          "lines": "52-57",
          "snippet": "void TransactionFilterProxy::setDateRange(const QDateTime &from, const QDateTime &to)\n{\n    this->dateFrom = from;\n    this->dateTo = to;\n    invalidateFilter();\n}",
          "includes": [
            "#include <cstdlib>",
            "#include <QDateTime>",
            "#include \"transactionrecord.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"transactionfilterproxy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdlib>\n#include <QDateTime>\n#include \"transactionrecord.h\"\n#include \"transactiontablemodel.h\"\n#include \"transactionfilterproxy.h\"\n\nTransactionFilterProxy {\n  void TransactionFilterProxy::setDateRange(const QDateTime &from, const QDateTime &to)\n  {\n      this->dateFrom = from;\n      this->dateTo = to;\n      invalidateFilter();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QDateTime",
          "args": [
            "QDate(current.year(), 1, 1)"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDate",
          "args": [
            "current.year()",
            "1",
            "1"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current.year",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDateTime",
          "args": [
            "QDate(current.year(), current.month(), 1)"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDate",
          "args": [
            "current.year()",
            "current.month()",
            "1"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current.month",
          "args": [],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current.year",
          "args": [],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDateTime",
          "args": [
            "QDate(current.year(), current.month()-1, 1)"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDate",
          "args": [
            "current.year()",
            "current.month()-1",
            "1"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current.month",
          "args": [],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current.year",
          "args": [],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDateTime",
          "args": [
            "QDate(current.year(), current.month(), 1)"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDate",
          "args": [
            "current.year()",
            "current.month()",
            "1"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current.month",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current.year",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDateTime",
          "args": [
            "startOfWeek"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current.addDays",
          "args": [
            "-(current.dayOfWeek()-1)"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current.dayOfWeek",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDateTime",
          "args": [
            "current"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateWidget->itemData",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateWidget->itemData",
          "args": [
            "idx"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateRangeWidget->setVisible",
          "args": [
            "false"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDate::currentDate",
          "args": [],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::chooseDate(int idx)\n  {\n      if(!transactionProxyModel)\n          return;\n      QDate current = QDate::currentDate();\n      dateRangeWidget->setVisible(false);\n      switch(dateWidget->itemData(idx).toInt())\n      {\n      case All:\n          transactionProxyModel->setDateRange(\n                  TransactionFilterProxy::MIN_DATE,\n                  TransactionFilterProxy::MAX_DATE);\n          break;\n      case Today:\n          transactionProxyModel->setDateRange(\n                  QDateTime(current),\n                  TransactionFilterProxy::MAX_DATE);\n          break;\n      case ThisWeek: {\n          // Find last Monday\n          QDate startOfWeek = current.addDays(-(current.dayOfWeek()-1));\n          transactionProxyModel->setDateRange(\n                  QDateTime(startOfWeek),\n                  TransactionFilterProxy::MAX_DATE);\n  \n          } break;\n      case ThisMonth:\n          transactionProxyModel->setDateRange(\n                  QDateTime(QDate(current.year(), current.month(), 1)),\n                  TransactionFilterProxy::MAX_DATE);\n          break;\n      case LastMonth:\n          transactionProxyModel->setDateRange(\n                  QDateTime(QDate(current.year(), current.month()-1, 1)),\n                  QDateTime(QDate(current.year(), current.month(), 1)));\n          break;\n      case ThisYear:\n          transactionProxyModel->setDateRange(\n                  QDateTime(QDate(current.year(), 1, 1)),\n                  TransactionFilterProxy::MAX_DATE);\n          break;\n      case Range:\n          dateRangeWidget->setVisible(true);\n          dateRangeChanged();\n          break;\n      }\n  }\n}"
  },
  {
    "function_name": "setModel",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "161-193",
    "snippet": "void TransactionView::setModel(WalletModel *model)\n{\n    this->model = model;\n    if(model)\n    {\n        transactionProxyModel = new TransactionFilterProxy(this);\n        transactionProxyModel->setSourceModel(model->getTransactionTableModel());\n        transactionProxyModel->setDynamicSortFilter(true);\n        transactionProxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n        transactionProxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n\n        transactionProxyModel->setSortRole(Qt::EditRole);\n\n        transactionView->setModel(transactionProxyModel);\n        transactionView->setAlternatingRowColors(true);\n        transactionView->setSelectionBehavior(QAbstractItemView::SelectRows);\n        transactionView->setSelectionMode(QAbstractItemView::ExtendedSelection);\n        transactionView->setSortingEnabled(true);\n        transactionView->sortByColumn(TransactionTableModel::Date, Qt::DescendingOrder);\n        transactionView->verticalHeader()->hide();\n\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Status, 23);\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Date, 120);\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Type, 120);\n        transactionView->horizontalHeader()->setResizeMode(\n                TransactionTableModel::ToAddress, QHeaderView::Stretch);\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Amount, 100);\n    }\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "transactionView->horizontalHeader",
          "args": [
            "TransactionTableModel::Amount",
            "100"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->horizontalHeader",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->horizontalHeader",
          "args": [
            "TransactionTableModel::ToAddress",
            "QHeaderView::Stretch"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->horizontalHeader",
          "args": [],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->horizontalHeader",
          "args": [
            "TransactionTableModel::Type",
            "120"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->horizontalHeader",
          "args": [],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->horizontalHeader",
          "args": [
            "TransactionTableModel::Date",
            "120"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->horizontalHeader",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->horizontalHeader",
          "args": [
            "TransactionTableModel::Status",
            "23"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->horizontalHeader",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->verticalHeader",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->verticalHeader",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->sortByColumn",
          "args": [
            "TransactionTableModel::Date",
            "Qt::DescendingOrder"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->setSortingEnabled",
          "args": [
            "true"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->setSelectionMode",
          "args": [
            "QAbstractItemView::ExtendedSelection"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->setSelectionBehavior",
          "args": [
            "QAbstractItemView::SelectRows"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->setAlternatingRowColors",
          "args": [
            "true"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionView->setModel",
          "args": [
            "transactionProxyModel"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "161-193",
          "snippet": "void TransactionView::setModel(WalletModel *model)\n{\n    this->model = model;\n    if(model)\n    {\n        transactionProxyModel = new TransactionFilterProxy(this);\n        transactionProxyModel->setSourceModel(model->getTransactionTableModel());\n        transactionProxyModel->setDynamicSortFilter(true);\n        transactionProxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n        transactionProxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n\n        transactionProxyModel->setSortRole(Qt::EditRole);\n\n        transactionView->setModel(transactionProxyModel);\n        transactionView->setAlternatingRowColors(true);\n        transactionView->setSelectionBehavior(QAbstractItemView::SelectRows);\n        transactionView->setSelectionMode(QAbstractItemView::ExtendedSelection);\n        transactionView->setSortingEnabled(true);\n        transactionView->sortByColumn(TransactionTableModel::Date, Qt::DescendingOrder);\n        transactionView->verticalHeader()->hide();\n\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Status, 23);\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Date, 120);\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Type, 120);\n        transactionView->horizontalHeader()->setResizeMode(\n                TransactionTableModel::ToAddress, QHeaderView::Stretch);\n        transactionView->horizontalHeader()->resizeSection(\n                TransactionTableModel::Amount, 100);\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "transactionProxyModel->setSortRole",
          "args": [
            "Qt::EditRole"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionProxyModel->setFilterCaseSensitivity",
          "args": [
            "Qt::CaseInsensitive"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionProxyModel->setSortCaseSensitivity",
          "args": [
            "Qt::CaseInsensitive"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionProxyModel->setDynamicSortFilter",
          "args": [
            "true"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionProxyModel->setSourceModel",
          "args": [
            "model->getTransactionTableModel()"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getTransactionTableModel",
          "args": [],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::setModel(WalletModel *model)\n  {\n      this->model = model;\n      if(model)\n      {\n          transactionProxyModel = new TransactionFilterProxy(this);\n          transactionProxyModel->setSourceModel(model->getTransactionTableModel());\n          transactionProxyModel->setDynamicSortFilter(true);\n          transactionProxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n          transactionProxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n  \n          transactionProxyModel->setSortRole(Qt::EditRole);\n  \n          transactionView->setModel(transactionProxyModel);\n          transactionView->setAlternatingRowColors(true);\n          transactionView->setSelectionBehavior(QAbstractItemView::SelectRows);\n          transactionView->setSelectionMode(QAbstractItemView::ExtendedSelection);\n          transactionView->setSortingEnabled(true);\n          transactionView->sortByColumn(TransactionTableModel::Date, Qt::DescendingOrder);\n          transactionView->verticalHeader()->hide();\n  \n          transactionView->horizontalHeader()->resizeSection(\n                  TransactionTableModel::Status, 23);\n          transactionView->horizontalHeader()->resizeSection(\n                  TransactionTableModel::Date, 120);\n          transactionView->horizontalHeader()->resizeSection(\n                  TransactionTableModel::Type, 120);\n          transactionView->horizontalHeader()->setResizeMode(\n                  TransactionTableModel::ToAddress, QHeaderView::Stretch);\n          transactionView->horizontalHeader()->resizeSection(\n                  TransactionTableModel::Amount, 100);\n      }\n  }\n}"
  },
  {
    "function_name": "TransactionView",
    "container": "TransactionView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
    "lines": "32-159",
    "snippet": "TransactionView::TransactionView(QWidget *parent) :\n    QWidget(parent), model(0), transactionProxyModel(0),\n    transactionView(0)\n{\n    // Build filter row\n    setContentsMargins(0,0,0,0);\n\n    QHBoxLayout *hlayout = new QHBoxLayout();\n    hlayout->setContentsMargins(0,0,0,0);\n#ifdef Q_OS_MAC\n    hlayout->setSpacing(5);\n    hlayout->addSpacing(26);\n#else\n    hlayout->setSpacing(0);\n    hlayout->addSpacing(23);\n#endif\n\n    dateWidget = new QComboBox(this);\n#ifdef Q_OS_MAC\n    dateWidget->setFixedWidth(121);\n#else\n    dateWidget->setFixedWidth(120);\n#endif\n    dateWidget->addItem(tr(\"All\"), All);\n    dateWidget->addItem(tr(\"Today\"), Today);\n    dateWidget->addItem(tr(\"This week\"), ThisWeek);\n    dateWidget->addItem(tr(\"This month\"), ThisMonth);\n    dateWidget->addItem(tr(\"Last month\"), LastMonth);\n    dateWidget->addItem(tr(\"This year\"), ThisYear);\n    dateWidget->addItem(tr(\"Range...\"), Range);\n    hlayout->addWidget(dateWidget);\n\n    typeWidget = new QComboBox(this);\n#ifdef Q_OS_MAC\n    typeWidget->setFixedWidth(121);\n#else\n    typeWidget->setFixedWidth(120);\n#endif\n\n    typeWidget->addItem(tr(\"All\"), TransactionFilterProxy::ALL_TYPES);\n    typeWidget->addItem(tr(\"Received with\"), TransactionFilterProxy::TYPE(TransactionRecord::RecvWithAddress) |\n                                        TransactionFilterProxy::TYPE(TransactionRecord::RecvFromOther));\n    typeWidget->addItem(tr(\"Sent to\"), TransactionFilterProxy::TYPE(TransactionRecord::SendToAddress) |\n                                  TransactionFilterProxy::TYPE(TransactionRecord::SendToOther));\n    typeWidget->addItem(tr(\"To yourself\"), TransactionFilterProxy::TYPE(TransactionRecord::SendToSelf));\n    typeWidget->addItem(tr(\"Mined\"), TransactionFilterProxy::TYPE(TransactionRecord::Generated));\n    typeWidget->addItem(tr(\"Other\"), TransactionFilterProxy::TYPE(TransactionRecord::Other));\n\n    hlayout->addWidget(typeWidget);\n\n    addressWidget = new QLineEdit(this);\n#if QT_VERSION >= 0x040700\n    /* Do not move this to the XML file, Qt before 4.7 will choke on it */\n    addressWidget->setPlaceholderText(tr(\"Enter address or label to search\"));\n#endif\n    hlayout->addWidget(addressWidget);\n\n    amountWidget = new QLineEdit(this);\n#if QT_VERSION >= 0x040700\n    /* Do not move this to the XML file, Qt before 4.7 will choke on it */\n    amountWidget->setPlaceholderText(tr(\"Min amount\"));\n#endif\n#ifdef Q_OS_MAC\n    amountWidget->setFixedWidth(97);\n#else\n    amountWidget->setFixedWidth(100);\n#endif\n    amountWidget->setValidator(new QDoubleValidator(0, 1e20, 8, this));\n    hlayout->addWidget(amountWidget);\n\n    QVBoxLayout *vlayout = new QVBoxLayout(this);\n    vlayout->setContentsMargins(0,0,0,0);\n    vlayout->setSpacing(0);\n\n    QTableView *view = new QTableView(this);\n    vlayout->addLayout(hlayout);\n    vlayout->addWidget(createDateRangeWidget());\n    vlayout->addWidget(view);\n    vlayout->setSpacing(0);\n    int width = view->verticalScrollBar()->sizeHint().width();\n    // Cover scroll bar width with spacing\n#ifdef Q_OS_MAC\n    hlayout->addSpacing(width+2);\n#else\n    hlayout->addSpacing(width);\n#endif\n    // Always show scroll bar\n    view->setVerticalScrollBarPolicy(Qt::ScrollBarAlwaysOn);\n    view->setTabKeyNavigation(false);\n    view->setContextMenuPolicy(Qt::CustomContextMenu);\n\n    transactionView = view;\n\n    // Actions\n    QAction *copyAddressAction = new QAction(tr(\"Copy address\"), this);\n    QAction *copyLabelAction = new QAction(tr(\"Copy label\"), this);\n    QAction *copyAmountAction = new QAction(tr(\"Copy amount\"), this);\n    QAction *copyTxIDAction = new QAction(tr(\"Copy transaction ID\"), this);\n    QAction *editLabelAction = new QAction(tr(\"Edit label\"), this);\n    QAction *showDetailsAction = new QAction(tr(\"Show transaction details\"), this);\n    QAction *showBlockExplorer = new QAction(tr(\"Show transaction in block explorer\"), this);\n\n    contextMenu = new QMenu();\n    contextMenu->addAction(copyAddressAction);\n    contextMenu->addAction(copyLabelAction);\n    contextMenu->addAction(copyAmountAction);\n    contextMenu->addAction(copyTxIDAction);\n    contextMenu->addAction(editLabelAction);\n    contextMenu->addAction(showDetailsAction);\n    contextMenu->addAction(showBlockExplorer);\n\n    // Connect actions\n    connect(dateWidget, SIGNAL(activated(int)), this, SLOT(chooseDate(int)));\n    connect(typeWidget, SIGNAL(activated(int)), this, SLOT(chooseType(int)));\n    connect(addressWidget, SIGNAL(textChanged(QString)), this, SLOT(changedPrefix(QString)));\n    connect(amountWidget, SIGNAL(textChanged(QString)), this, SLOT(changedAmount(QString)));\n\n    connect(view, SIGNAL(doubleClicked(QModelIndex)), this, SIGNAL(doubleClicked(QModelIndex)));\n    connect(view, SIGNAL(customContextMenuRequested(QPoint)), this, SLOT(contextualMenu(QPoint)));\n\n    connect(copyAddressAction, SIGNAL(triggered()), this, SLOT(copyAddress()));\n    connect(copyLabelAction, SIGNAL(triggered()), this, SLOT(copyLabel()));\n    connect(copyAmountAction, SIGNAL(triggered()), this, SLOT(copyAmount()));\n    connect(copyTxIDAction, SIGNAL(triggered()), this, SLOT(copyTxID()));\n    connect(editLabelAction, SIGNAL(triggered()), this, SLOT(editLabel()));\n    connect(showDetailsAction, SIGNAL(triggered()), this, SLOT(showDetails()));\n    connect(showBlockExplorer, SIGNAL(triggered()), this, SLOT(showExplorer()));\n}",
    "includes": [
      "#include <QDateTimeEdit>",
      "#include <QLabel>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QMenu>",
      "#include <QPoint>",
      "#include <QMessageBox>",
      "#include <QPushButton>",
      "#include <QHeaderView>",
      "#include <QTableView>",
      "#include <QLineEdit>",
      "#include <QVBoxLayout>",
      "#include <QHBoxLayout>",
      "#include <QDoubleValidator>",
      "#include <QComboBox>",
      "#include <QScrollBar>",
      "#include \"guiutil.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"transactiondescdialog.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"transactionrecord.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactionview.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "showBlockExplorer",
            "SIGNAL(triggered())",
            "this",
            "SLOT(showExplorer())"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "showExplorer()"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "showExplorer",
          "args": [],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "showExplorer",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "444-455",
          "snippet": "void TransactionView::showExplorer() {\n\n    if(!transactionView->selectionModel()) return;\n\n    QModelIndexList selection = transactionView->selectionModel()->selectedRows();\n    QString TxID;\n\n    if(!selection.isEmpty())\n      TxID = selection.at(0).data(TransactionTableModel::TxIDRole).toString();\n\n    emit(blockExplorerSignal(TxID));\n}",
          "includes": [
            "#include <QDateTimeEdit>",
            "#include <QLabel>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QMenu>",
            "#include <QPoint>",
            "#include <QMessageBox>",
            "#include <QPushButton>",
            "#include <QHeaderView>",
            "#include <QTableView>",
            "#include <QLineEdit>",
            "#include <QVBoxLayout>",
            "#include <QHBoxLayout>",
            "#include <QDoubleValidator>",
            "#include <QComboBox>",
            "#include <QScrollBar>",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"transactiondescdialog.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactionview.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::showExplorer() {\n  \n      if(!transactionView->selectionModel()) return;\n  \n      QModelIndexList selection = transactionView->selectionModel()->selectedRows();\n      QString TxID;\n  \n      if(!selection.isEmpty())\n        TxID = selection.at(0).data(TransactionTableModel::TxIDRole).toString();\n  \n      emit(blockExplorerSignal(TxID));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "showDetailsAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(showDetails())"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "showDetails()"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "showDetails",
          "args": [],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "showDetails",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "377-387",
          "snippet": "void TransactionView::showDetails()\n{\n    if(!transactionView->selectionModel())\n        return;\n    QModelIndexList selection = transactionView->selectionModel()->selectedRows();\n    if(!selection.isEmpty())\n    {\n        TransactionDescDialog dlg(selection.at(0));\n        dlg.exec();\n    }\n}",
          "includes": [
            "#include <QDateTimeEdit>",
            "#include <QLabel>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QMenu>",
            "#include <QPoint>",
            "#include <QMessageBox>",
            "#include <QPushButton>",
            "#include <QHeaderView>",
            "#include <QTableView>",
            "#include <QLineEdit>",
            "#include <QVBoxLayout>",
            "#include <QHBoxLayout>",
            "#include <QDoubleValidator>",
            "#include <QComboBox>",
            "#include <QScrollBar>",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"transactiondescdialog.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactionview.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::showDetails()\n  {\n      if(!transactionView->selectionModel())\n          return;\n      QModelIndexList selection = transactionView->selectionModel()->selectedRows();\n      if(!selection.isEmpty())\n      {\n          TransactionDescDialog dlg(selection.at(0));\n          dlg.exec();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "editLabelAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(editLabel())"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "editLabel()"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "editLabel",
          "args": [],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "editLabel",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "331-375",
          "snippet": "void TransactionView::editLabel()\n{\n    if(!transactionView->selectionModel() ||!model)\n        return;\n    QModelIndexList selection = transactionView->selectionModel()->selectedRows();\n    if(!selection.isEmpty())\n    {\n        AddressTableModel *addressBook = model->getAddressTableModel();\n        if(!addressBook)\n            return;\n        QString address = selection.at(0).data(TransactionTableModel::AddressRole).toString();\n        if(address.isEmpty())\n        {\n            // If this transaction has no associated address, exit\n            return;\n        }\n        // Is address in address book? Address book can miss address when a transaction is\n        // sent from outside the UI.\n        int idx = addressBook->lookupAddress(address);\n        if(idx != -1)\n        {\n            // Edit sending / receiving address\n            QModelIndex modelIdx = addressBook->index(idx, 0, QModelIndex());\n            // Determine type of address, launch appropriate editor dialog type\n            QString type = modelIdx.data(AddressTableModel::TypeRole).toString();\n\n            EditAddressDialog dlg(type==AddressTableModel::Receive\n                                         ? EditAddressDialog::EditReceivingAddress\n                                         : EditAddressDialog::EditSendingAddress,\n                                  this);\n            dlg.setModel(addressBook);\n            dlg.loadRow(idx);\n            dlg.exec();\n        }\n        else\n        {\n            // Add sending address\n            EditAddressDialog dlg(EditAddressDialog::NewSendingAddress,\n                                  this);\n            dlg.setModel(addressBook);\n            dlg.setAddress(address);\n            dlg.exec();\n        }\n    }\n}",
          "includes": [
            "#include <QDateTimeEdit>",
            "#include <QLabel>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QMenu>",
            "#include <QPoint>",
            "#include <QMessageBox>",
            "#include <QPushButton>",
            "#include <QHeaderView>",
            "#include <QTableView>",
            "#include <QLineEdit>",
            "#include <QVBoxLayout>",
            "#include <QHBoxLayout>",
            "#include <QDoubleValidator>",
            "#include <QComboBox>",
            "#include <QScrollBar>",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"transactiondescdialog.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactionview.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::editLabel()\n  {\n      if(!transactionView->selectionModel() ||!model)\n          return;\n      QModelIndexList selection = transactionView->selectionModel()->selectedRows();\n      if(!selection.isEmpty())\n      {\n          AddressTableModel *addressBook = model->getAddressTableModel();\n          if(!addressBook)\n              return;\n          QString address = selection.at(0).data(TransactionTableModel::AddressRole).toString();\n          if(address.isEmpty())\n          {\n              // If this transaction has no associated address, exit\n              return;\n          }\n          // Is address in address book? Address book can miss address when a transaction is\n          // sent from outside the UI.\n          int idx = addressBook->lookupAddress(address);\n          if(idx != -1)\n          {\n              // Edit sending / receiving address\n              QModelIndex modelIdx = addressBook->index(idx, 0, QModelIndex());\n              // Determine type of address, launch appropriate editor dialog type\n              QString type = modelIdx.data(AddressTableModel::TypeRole).toString();\n  \n              EditAddressDialog dlg(type==AddressTableModel::Receive\n                                           ? EditAddressDialog::EditReceivingAddress\n                                           : EditAddressDialog::EditSendingAddress,\n                                    this);\n              dlg.setModel(addressBook);\n              dlg.loadRow(idx);\n              dlg.exec();\n          }\n          else\n          {\n              // Add sending address\n              EditAddressDialog dlg(EditAddressDialog::NewSendingAddress,\n                                    this);\n              dlg.setModel(addressBook);\n              dlg.setAddress(address);\n              dlg.exec();\n          }\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "copyTxIDAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(copyTxID())"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "copyTxID()"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copyTxID",
          "args": [],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "copyTxID",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "326-329",
          "snippet": "void TransactionView::copyTxID()\n{\n    GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::TxIDRole);\n}",
          "includes": [
            "#include <QDateTimeEdit>",
            "#include <QLabel>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QMenu>",
            "#include <QPoint>",
            "#include <QMessageBox>",
            "#include <QPushButton>",
            "#include <QHeaderView>",
            "#include <QTableView>",
            "#include <QLineEdit>",
            "#include <QVBoxLayout>",
            "#include <QHBoxLayout>",
            "#include <QDoubleValidator>",
            "#include <QComboBox>",
            "#include <QScrollBar>",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"transactiondescdialog.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactionview.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::copyTxID()\n  {\n      GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::TxIDRole);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "copyAmountAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(copyAmount())"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "copyAmount()"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copyAmount",
          "args": [],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "copyAmount",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "321-324",
          "snippet": "void TransactionView::copyAmount()\n{\n    GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::FormattedAmountRole);\n}",
          "includes": [
            "#include <QDateTimeEdit>",
            "#include <QLabel>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QMenu>",
            "#include <QPoint>",
            "#include <QMessageBox>",
            "#include <QPushButton>",
            "#include <QHeaderView>",
            "#include <QTableView>",
            "#include <QLineEdit>",
            "#include <QVBoxLayout>",
            "#include <QHBoxLayout>",
            "#include <QDoubleValidator>",
            "#include <QComboBox>",
            "#include <QScrollBar>",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"transactiondescdialog.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactionview.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::copyAmount()\n  {\n      GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::FormattedAmountRole);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "copyLabelAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(copyLabel())"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "copyLabel()"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copyLabel",
          "args": [],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "copyLabel",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "316-319",
          "snippet": "void TransactionView::copyLabel()\n{\n    GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::LabelRole);\n}",
          "includes": [
            "#include <QDateTimeEdit>",
            "#include <QLabel>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QMenu>",
            "#include <QPoint>",
            "#include <QMessageBox>",
            "#include <QPushButton>",
            "#include <QHeaderView>",
            "#include <QTableView>",
            "#include <QLineEdit>",
            "#include <QVBoxLayout>",
            "#include <QHBoxLayout>",
            "#include <QDoubleValidator>",
            "#include <QComboBox>",
            "#include <QScrollBar>",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"transactiondescdialog.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactionview.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::copyLabel()\n  {\n      GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::LabelRole);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "copyAddressAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(copyAddress())"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "copyAddress()"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copyAddress",
          "args": [],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "copyAddress",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "311-314",
          "snippet": "void TransactionView::copyAddress()\n{\n    GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::AddressRole);\n}",
          "includes": [
            "#include <QDateTimeEdit>",
            "#include <QLabel>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QMenu>",
            "#include <QPoint>",
            "#include <QMessageBox>",
            "#include <QPushButton>",
            "#include <QHeaderView>",
            "#include <QTableView>",
            "#include <QLineEdit>",
            "#include <QVBoxLayout>",
            "#include <QHBoxLayout>",
            "#include <QDoubleValidator>",
            "#include <QComboBox>",
            "#include <QScrollBar>",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"transactiondescdialog.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactionview.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::copyAddress()\n  {\n      GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::AddressRole);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "view",
            "SIGNAL(customContextMenuRequested(QPoint))",
            "this",
            "SLOT(contextualMenu(QPoint))"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "contextualMenu(QPoint)"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextualMenu",
          "args": [
            "QPoint"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "contextualMenu",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "302-309",
          "snippet": "void TransactionView::contextualMenu(const QPoint &point)\n{\n    QModelIndex index = transactionView->indexAt(point);\n    if(index.isValid())\n    {\n        contextMenu->exec(QCursor::pos());\n    }\n}",
          "includes": [
            "#include <QDateTimeEdit>",
            "#include <QLabel>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QMenu>",
            "#include <QPoint>",
            "#include <QMessageBox>",
            "#include <QPushButton>",
            "#include <QHeaderView>",
            "#include <QTableView>",
            "#include <QLineEdit>",
            "#include <QVBoxLayout>",
            "#include <QHBoxLayout>",
            "#include <QDoubleValidator>",
            "#include <QComboBox>",
            "#include <QScrollBar>",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"transactiondescdialog.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactionview.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::contextualMenu(const QPoint &point)\n  {\n      QModelIndex index = transactionView->indexAt(point);\n      if(index.isValid())\n      {\n          contextMenu->exec(QCursor::pos());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "customContextMenuRequested(QPoint)"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "customContextMenuRequested",
          "args": [
            "QPoint"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "view",
            "SIGNAL(doubleClicked(QModelIndex))",
            "this",
            "SIGNAL(doubleClicked(QModelIndex))"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "doubleClicked(QModelIndex)"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "doubleClicked",
          "args": [
            "QModelIndex"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "doubleClicked(QModelIndex)"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "doubleClicked",
          "args": [
            "QModelIndex"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "amountWidget",
            "SIGNAL(textChanged(QString))",
            "this",
            "SLOT(changedAmount(QString))"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "changedAmount(QString)"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "changedAmount",
          "args": [
            "QString"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "changedAmount",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "258-271",
          "snippet": "void TransactionView::changedAmount(const QString &amount)\n{\n    if(!transactionProxyModel)\n        return;\n    qint64 amount_parsed = 0;\n    if(BitcoinUnits::parse(model->getOptionsModel()->getDisplayUnit(), amount, &amount_parsed))\n    {\n        transactionProxyModel->setMinAmount(amount_parsed);\n    }\n    else\n    {\n        transactionProxyModel->setMinAmount(0);\n    }\n}",
          "includes": [
            "#include <QDateTimeEdit>",
            "#include <QLabel>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QMenu>",
            "#include <QPoint>",
            "#include <QMessageBox>",
            "#include <QPushButton>",
            "#include <QHeaderView>",
            "#include <QTableView>",
            "#include <QLineEdit>",
            "#include <QVBoxLayout>",
            "#include <QHBoxLayout>",
            "#include <QDoubleValidator>",
            "#include <QComboBox>",
            "#include <QScrollBar>",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"transactiondescdialog.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactionview.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::changedAmount(const QString &amount)\n  {\n      if(!transactionProxyModel)\n          return;\n      qint64 amount_parsed = 0;\n      if(BitcoinUnits::parse(model->getOptionsModel()->getDisplayUnit(), amount, &amount_parsed))\n      {\n          transactionProxyModel->setMinAmount(amount_parsed);\n      }\n      else\n      {\n          transactionProxyModel->setMinAmount(0);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "textChanged(QString)"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "textChanged",
          "args": [
            "QString"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "on_payTo_textChanged",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "58-66",
          "snippet": "void SendCoinsEntry::on_payTo_textChanged(const QString &address)\n{\n    if(!model)\n        return;\n    // Fill in label from address book, if address has an associated label\n    QString associatedLabel = model->getAddressTableModel()->labelForAddress(address);\n    if(!associatedLabel.isEmpty())\n        ui->addAsLabel->setText(associatedLabel);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::on_payTo_textChanged(const QString &address)\n  {\n      if(!model)\n          return;\n      // Fill in label from address book, if address has an associated label\n      QString associatedLabel = model->getAddressTableModel()->labelForAddress(address);\n      if(!associatedLabel.isEmpty())\n          ui->addAsLabel->setText(associatedLabel);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "addressWidget",
            "SIGNAL(textChanged(QString))",
            "this",
            "SLOT(changedPrefix(QString))"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "changedPrefix(QString)"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "changedPrefix",
          "args": [
            "QString"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "changedPrefix",
          "container": "TransactionView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionview.cpp",
          "lines": "251-256",
          "snippet": "void TransactionView::changedPrefix(const QString &prefix)\n{\n    if(!transactionProxyModel)\n        return;\n    transactionProxyModel->setAddressPrefix(prefix);\n}",
          "includes": [
            "#include <QDateTimeEdit>",
            "#include <QLabel>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QMenu>",
            "#include <QPoint>",
            "#include <QMessageBox>",
            "#include <QPushButton>",
            "#include <QHeaderView>",
            "#include <QTableView>",
            "#include <QLineEdit>",
            "#include <QVBoxLayout>",
            "#include <QHBoxLayout>",
            "#include <QDoubleValidator>",
            "#include <QComboBox>",
            "#include <QScrollBar>",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"transactiondescdialog.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactionview.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  void TransactionView::changedPrefix(const QString &prefix)\n  {\n      if(!transactionProxyModel)\n          return;\n      transactionProxyModel->setAddressPrefix(prefix);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "textChanged(QString)"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "showBlockExplorer"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "showDetailsAction"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "editLabelAction"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "copyTxIDAction"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "copyAmountAction"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "copyLabelAction"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "copyAddressAction"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Show transaction in block explorer\""
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "view->setContextMenuPolicy",
          "args": [
            "Qt::CustomContextMenu"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "view->setTabKeyNavigation",
          "args": [
            "false"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "view->setVerticalScrollBarPolicy",
          "args": [
            "Qt::ScrollBarAlwaysOn"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlayout->addSpacing",
          "args": [
            "width"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlayout->addSpacing",
          "args": [
            "width+2"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "view->verticalScrollBar",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "view->verticalScrollBar",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "view->verticalScrollBar",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vlayout->setSpacing",
          "args": [
            "0"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vlayout->addWidget",
          "args": [
            "view"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vlayout->addWidget",
          "args": [
            "createDateRangeWidget()"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "createDateRangeWidget",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vlayout->addLayout",
          "args": [
            "hlayout"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vlayout->setSpacing",
          "args": [
            "0"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vlayout->setContentsMargins",
          "args": [
            "0",
            "0",
            "0",
            "0"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlayout->addWidget",
          "args": [
            "amountWidget"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amountWidget->setValidator",
          "args": [
            "new QDoubleValidator(0, 1e20, 8, this)"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amountWidget->setFixedWidth",
          "args": [
            "100"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amountWidget->setFixedWidth",
          "args": [
            "97"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amountWidget->setPlaceholderText",
          "args": [
            "tr(\"Min amount\")"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlayout->addWidget",
          "args": [
            "addressWidget"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addressWidget->setPlaceholderText",
          "args": [
            "tr(\"Enter address or label to search\")"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlayout->addWidget",
          "args": [
            "typeWidget"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeWidget->addItem",
          "args": [
            "tr(\"Other\")",
            "TransactionFilterProxy::TYPE(TransactionRecord::Other)"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionFilterProxy::TYPE",
          "args": [
            "TransactionRecord::Other"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "TYPE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionfilterproxy.h",
          "lines": "21-21",
          "snippet": "static quint32 TYPE(int type) { return 1<<type; }",
          "includes": [
            "#include <QDateTime>",
            "#include <QSortFilterProxyModel>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDateTime>\n#include <QSortFilterProxyModel>\n\nstatic quint32 TYPE(int type) { return 1<<type; }"
        }
      },
      {
        "call_info": {
          "callee": "typeWidget->addItem",
          "args": [
            "tr(\"Mined\")",
            "TransactionFilterProxy::TYPE(TransactionRecord::Generated)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeWidget->addItem",
          "args": [
            "tr(\"To yourself\")",
            "TransactionFilterProxy::TYPE(TransactionRecord::SendToSelf)"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeWidget->addItem",
          "args": [
            "tr(\"Sent to\")",
            "TransactionFilterProxy::TYPE(TransactionRecord::SendToAddress) |\n                                  TransactionFilterProxy::TYPE(TransactionRecord::SendToOther)"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeWidget->addItem",
          "args": [
            "tr(\"Received with\")",
            "TransactionFilterProxy::TYPE(TransactionRecord::RecvWithAddress) |\n                                        TransactionFilterProxy::TYPE(TransactionRecord::RecvFromOther)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeWidget->addItem",
          "args": [
            "tr(\"All\")",
            "TransactionFilterProxy::ALL_TYPES"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeWidget->setFixedWidth",
          "args": [
            "120"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeWidget->setFixedWidth",
          "args": [
            "121"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlayout->addWidget",
          "args": [
            "dateWidget"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateWidget->addItem",
          "args": [
            "tr(\"Range...\")",
            "Range"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateWidget->addItem",
          "args": [
            "tr(\"This year\")",
            "ThisYear"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateWidget->addItem",
          "args": [
            "tr(\"Last month\")",
            "LastMonth"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateWidget->addItem",
          "args": [
            "tr(\"This month\")",
            "ThisMonth"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateWidget->addItem",
          "args": [
            "tr(\"This week\")",
            "ThisWeek"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateWidget->addItem",
          "args": [
            "tr(\"Today\")",
            "Today"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateWidget->addItem",
          "args": [
            "tr(\"All\")",
            "All"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateWidget->setFixedWidth",
          "args": [
            "120"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dateWidget->setFixedWidth",
          "args": [
            "121"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlayout->addSpacing",
          "args": [
            "23"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlayout->setSpacing",
          "args": [
            "0"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlayout->addSpacing",
          "args": [
            "26"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlayout->setSpacing",
          "args": [
            "5"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlayout->setContentsMargins",
          "args": [
            "0",
            "0",
            "0",
            "0"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setContentsMargins",
          "args": [
            "0",
            "0",
            "0",
            "0"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDateTimeEdit>\n#include <QLabel>\n#include <QClipboard>\n#include <QApplication>\n#include <QMenu>\n#include <QPoint>\n#include <QMessageBox>\n#include <QPushButton>\n#include <QHeaderView>\n#include <QTableView>\n#include <QLineEdit>\n#include <QVBoxLayout>\n#include <QHBoxLayout>\n#include <QDoubleValidator>\n#include <QComboBox>\n#include <QScrollBar>\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"editaddressdialog.h\"\n#include \"transactiondescdialog.h\"\n#include \"csvmodelwriter.h\"\n#include \"bitcoinunits.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"transactionrecord.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactionview.h\"\n\nTransactionView {\n  TransactionView::TransactionView(QWidget *parent) :\n      QWidget(parent), model(0), transactionProxyModel(0),\n      transactionView(0)\n  {\n      // Build filter row\n      setContentsMargins(0,0,0,0);\n  \n      QHBoxLayout *hlayout = new QHBoxLayout();\n      hlayout->setContentsMargins(0,0,0,0);\n  #ifdef Q_OS_MAC\n      hlayout->setSpacing(5);\n      hlayout->addSpacing(26);\n  #else\n      hlayout->setSpacing(0);\n      hlayout->addSpacing(23);\n  #endif\n  \n      dateWidget = new QComboBox(this);\n  #ifdef Q_OS_MAC\n      dateWidget->setFixedWidth(121);\n  #else\n      dateWidget->setFixedWidth(120);\n  #endif\n      dateWidget->addItem(tr(\"All\"), All);\n      dateWidget->addItem(tr(\"Today\"), Today);\n      dateWidget->addItem(tr(\"This week\"), ThisWeek);\n      dateWidget->addItem(tr(\"This month\"), ThisMonth);\n      dateWidget->addItem(tr(\"Last month\"), LastMonth);\n      dateWidget->addItem(tr(\"This year\"), ThisYear);\n      dateWidget->addItem(tr(\"Range...\"), Range);\n      hlayout->addWidget(dateWidget);\n  \n      typeWidget = new QComboBox(this);\n  #ifdef Q_OS_MAC\n      typeWidget->setFixedWidth(121);\n  #else\n      typeWidget->setFixedWidth(120);\n  #endif\n  \n      typeWidget->addItem(tr(\"All\"), TransactionFilterProxy::ALL_TYPES);\n      typeWidget->addItem(tr(\"Received with\"), TransactionFilterProxy::TYPE(TransactionRecord::RecvWithAddress) |\n                                          TransactionFilterProxy::TYPE(TransactionRecord::RecvFromOther));\n      typeWidget->addItem(tr(\"Sent to\"), TransactionFilterProxy::TYPE(TransactionRecord::SendToAddress) |\n                                    TransactionFilterProxy::TYPE(TransactionRecord::SendToOther));\n      typeWidget->addItem(tr(\"To yourself\"), TransactionFilterProxy::TYPE(TransactionRecord::SendToSelf));\n      typeWidget->addItem(tr(\"Mined\"), TransactionFilterProxy::TYPE(TransactionRecord::Generated));\n      typeWidget->addItem(tr(\"Other\"), TransactionFilterProxy::TYPE(TransactionRecord::Other));\n  \n      hlayout->addWidget(typeWidget);\n  \n      addressWidget = new QLineEdit(this);\n  #if QT_VERSION >= 0x040700\n      /* Do not move this to the XML file, Qt before 4.7 will choke on it */\n      addressWidget->setPlaceholderText(tr(\"Enter address or label to search\"));\n  #endif\n      hlayout->addWidget(addressWidget);\n  \n      amountWidget = new QLineEdit(this);\n  #if QT_VERSION >= 0x040700\n      /* Do not move this to the XML file, Qt before 4.7 will choke on it */\n      amountWidget->setPlaceholderText(tr(\"Min amount\"));\n  #endif\n  #ifdef Q_OS_MAC\n      amountWidget->setFixedWidth(97);\n  #else\n      amountWidget->setFixedWidth(100);\n  #endif\n      amountWidget->setValidator(new QDoubleValidator(0, 1e20, 8, this));\n      hlayout->addWidget(amountWidget);\n  \n      QVBoxLayout *vlayout = new QVBoxLayout(this);\n      vlayout->setContentsMargins(0,0,0,0);\n      vlayout->setSpacing(0);\n  \n      QTableView *view = new QTableView(this);\n      vlayout->addLayout(hlayout);\n      vlayout->addWidget(createDateRangeWidget());\n      vlayout->addWidget(view);\n      vlayout->setSpacing(0);\n      int width = view->verticalScrollBar()->sizeHint().width();\n      // Cover scroll bar width with spacing\n  #ifdef Q_OS_MAC\n      hlayout->addSpacing(width+2);\n  #else\n      hlayout->addSpacing(width);\n  #endif\n      // Always show scroll bar\n      view->setVerticalScrollBarPolicy(Qt::ScrollBarAlwaysOn);\n      view->setTabKeyNavigation(false);\n      view->setContextMenuPolicy(Qt::CustomContextMenu);\n  \n      transactionView = view;\n  \n      // Actions\n      QAction *copyAddressAction = new QAction(tr(\"Copy address\"), this);\n      QAction *copyLabelAction = new QAction(tr(\"Copy label\"), this);\n      QAction *copyAmountAction = new QAction(tr(\"Copy amount\"), this);\n      QAction *copyTxIDAction = new QAction(tr(\"Copy transaction ID\"), this);\n      QAction *editLabelAction = new QAction(tr(\"Edit label\"), this);\n      QAction *showDetailsAction = new QAction(tr(\"Show transaction details\"), this);\n      QAction *showBlockExplorer = new QAction(tr(\"Show transaction in block explorer\"), this);\n  \n      contextMenu = new QMenu();\n      contextMenu->addAction(copyAddressAction);\n      contextMenu->addAction(copyLabelAction);\n      contextMenu->addAction(copyAmountAction);\n      contextMenu->addAction(copyTxIDAction);\n      contextMenu->addAction(editLabelAction);\n      contextMenu->addAction(showDetailsAction);\n      contextMenu->addAction(showBlockExplorer);\n  \n      // Connect actions\n      connect(dateWidget, SIGNAL(activated(int)), this, SLOT(chooseDate(int)));\n      connect(typeWidget, SIGNAL(activated(int)), this, SLOT(chooseType(int)));\n      connect(addressWidget, SIGNAL(textChanged(QString)), this, SLOT(changedPrefix(QString)));\n      connect(amountWidget, SIGNAL(textChanged(QString)), this, SLOT(changedAmount(QString)));\n  \n      connect(view, SIGNAL(doubleClicked(QModelIndex)), this, SIGNAL(doubleClicked(QModelIndex)));\n      connect(view, SIGNAL(customContextMenuRequested(QPoint)), this, SLOT(contextualMenu(QPoint)));\n  \n      connect(copyAddressAction, SIGNAL(triggered()), this, SLOT(copyAddress()));\n      connect(copyLabelAction, SIGNAL(triggered()), this, SLOT(copyLabel()));\n      connect(copyAmountAction, SIGNAL(triggered()), this, SLOT(copyAmount()));\n      connect(copyTxIDAction, SIGNAL(triggered()), this, SLOT(copyTxID()));\n      connect(editLabelAction, SIGNAL(triggered()), this, SLOT(editLabel()));\n      connect(showDetailsAction, SIGNAL(triggered()), this, SLOT(showDetails()));\n      connect(showBlockExplorer, SIGNAL(triggered()), this, SLOT(showExplorer()));\n  }\n}"
  }
]