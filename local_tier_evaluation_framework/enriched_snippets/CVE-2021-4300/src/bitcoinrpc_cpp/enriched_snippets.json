[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "1359-1388",
    "snippet": "int main(int argc, char *argv[])\n{\n#ifdef _MSC_VER\n    // Turn off Microsoft heap dump noise\n    _CrtSetReportMode(_CRT_WARN, _CRTDBG_MODE_FILE);\n    _CrtSetReportFile(_CRT_WARN, CreateFile(\"NUL\", GENERIC_WRITE, 0, NULL, OPEN_EXISTING, 0, 0));\n#endif\n    setbuf(stdin, NULL);\n    setbuf(stdout, NULL);\n    setbuf(stderr, NULL);\n\n    try\n    {\n        if (argc >= 2 && string(argv[1]) == \"-server\")\n        {\n            printf(\"server ready\\n\");\n            ThreadRPCServer(NULL);\n        }\n        else\n        {\n            return CommandLineRPC(argc, argv);\n        }\n    }\n    catch (std::exception& e) {\n        PrintException(&e, \"main()\");\n    } catch (...) {\n        PrintException(NULL, \"main()\");\n    }\n    return 0;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [
      "#define printf OutputDebugStringF"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PrintException",
          "args": [
            "NULL",
            "\"main()\""
          ],
          "line": 1385
        },
        "resolved": true,
        "details": {
          "function_name": "PrintExceptionContinue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1005-1011",
          "snippet": "void PrintExceptionContinue(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n\\n************************\\n%s\\n\", message.c_str());\n    fprintf(stderr, \"\\n\\n************************\\n%s\\n\", message.c_str());\n    strMiscWarning = message;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "string strMiscWarning;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring strMiscWarning;\n\nvoid PrintExceptionContinue(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n\\n************************\\n%s\\n\", message.c_str());\n    fprintf(stderr, \"\\n\\n************************\\n%s\\n\", message.c_str());\n    strMiscWarning = message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CommandLineRPC",
          "args": [
            "argc",
            "argv"
          ],
          "line": 1379
        },
        "resolved": true,
        "details": {
          "function_name": "CommandLineRPC",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "1291-1353",
          "snippet": "int CommandLineRPC(int argc, char *argv[])\n{\n    string strPrint;\n    int nRet = 0;\n    try\n    {\n        // Skip switches\n        while (argc > 1 && IsSwitchChar(argv[1][0]))\n        {\n            argc--;\n            argv++;\n        }\n\n        // Method\n        if (argc < 2)\n            throw runtime_error(\"too few parameters\");\n        string strMethod = argv[1];\n\n        // Parameters default to strings\n        std::vector<std::string> strParams(&argv[2], &argv[argc]);\n        Array params = RPCConvertValues(strMethod, strParams);\n\n        // Execute\n        Object reply = CallRPC(strMethod, params);\n\n        // Parse reply\n        const Value& result = find_value(reply, \"result\");\n        const Value& error  = find_value(reply, \"error\");\n\n        if (error.type() != null_type)\n        {\n            // Error\n            strPrint = \"error: \" + write_string(error, false);\n            int code = find_value(error.get_obj(), \"code\").get_int();\n            nRet = abs(code);\n        }\n        else\n        {\n            // Result\n            if (result.type() == null_type)\n                strPrint = \"\";\n            else if (result.type() == str_type)\n                strPrint = result.get_str();\n            else\n                strPrint = write_string(result, true);\n        }\n    }\n    catch (std::exception& e)\n    {\n        strPrint = string(\"error: \") + e.what();\n        nRet = 87;\n    }\n    catch (...)\n    {\n        PrintException(NULL, \"CommandLineRPC()\");\n    }\n\n    if (strPrint != \"\")\n    {\n        fprintf((nRet == 0 ? stdout : stderr), \"%s\\n\", strPrint.c_str());\n    }\n    return nRet;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nint CommandLineRPC(int argc, char *argv[])\n{\n    string strPrint;\n    int nRet = 0;\n    try\n    {\n        // Skip switches\n        while (argc > 1 && IsSwitchChar(argv[1][0]))\n        {\n            argc--;\n            argv++;\n        }\n\n        // Method\n        if (argc < 2)\n            throw runtime_error(\"too few parameters\");\n        string strMethod = argv[1];\n\n        // Parameters default to strings\n        std::vector<std::string> strParams(&argv[2], &argv[argc]);\n        Array params = RPCConvertValues(strMethod, strParams);\n\n        // Execute\n        Object reply = CallRPC(strMethod, params);\n\n        // Parse reply\n        const Value& result = find_value(reply, \"result\");\n        const Value& error  = find_value(reply, \"error\");\n\n        if (error.type() != null_type)\n        {\n            // Error\n            strPrint = \"error: \" + write_string(error, false);\n            int code = find_value(error.get_obj(), \"code\").get_int();\n            nRet = abs(code);\n        }\n        else\n        {\n            // Result\n            if (result.type() == null_type)\n                strPrint = \"\";\n            else if (result.type() == str_type)\n                strPrint = result.get_str();\n            else\n                strPrint = write_string(result, true);\n        }\n    }\n    catch (std::exception& e)\n    {\n        strPrint = string(\"error: \") + e.what();\n        nRet = 87;\n    }\n    catch (...)\n    {\n        PrintException(NULL, \"CommandLineRPC()\");\n    }\n\n    if (strPrint != \"\")\n    {\n        fprintf((nRet == 0 ? stdout : stderr), \"%s\\n\", strPrint.c_str());\n    }\n    return nRet;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ThreadRPCServer",
          "args": [
            "NULL"
          ],
          "line": 1375
        },
        "resolved": true,
        "details": {
          "function_name": "ThreadRPCServer3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "1015-1109",
          "snippet": "void ThreadRPCServer3(void* parg)\n{\n    // Make this thread recognisable as the RPC handler\n    RenameThread(\"hal-rpchand\");\n\n    {\n        LOCK(cs_THREAD_RPCHANDLER);\n        vnThreadsRunning[THREAD_RPCHANDLER]++;\n    }\n    AcceptedConnection *conn = (AcceptedConnection *) parg;\n\n    bool fRun = true;\n    while (true)\n    {\n        if (fShutdown || !fRun)\n        {\n            conn->close();\n            delete conn;\n            {\n                LOCK(cs_THREAD_RPCHANDLER);\n                --vnThreadsRunning[THREAD_RPCHANDLER];\n            }\n            return;\n        }\n        map<string, string> mapHeaders;\n        string strRequest;\n\n        ReadHTTP(conn->stream(), mapHeaders, strRequest);\n\n        // Check authorization\n        if (mapHeaders.count(\"authorization\") == 0)\n        {\n            conn->stream() << HTTPReply(HTTP_UNAUTHORIZED, \"\", false) << std::flush;\n            break;\n        }\n        if (!HTTPAuthorized(mapHeaders))\n        {\n            printf(\"ThreadRPCServer incorrect password attempt from %s\\n\", conn->peer_address_to_string().c_str());\n            /* Deter brute-forcing short passwords.\n               If this results in a DOS the user really\n               shouldn't have their RPC port exposed.*/\n            if (mapArgs[\"-rpcpassword\"].size() < 20)\n                MilliSleep(250);\n\n            conn->stream() << HTTPReply(HTTP_UNAUTHORIZED, \"\", false) << std::flush;\n            break;\n        }\n        if (mapHeaders[\"connection\"] == \"close\")\n            fRun = false;\n\n        JSONRequest jreq;\n        try\n        {\n            // Parse request\n            Value valRequest;\n            if (!read_string(strRequest, valRequest))\n                throw JSONRPCError(RPC_PARSE_ERROR, \"Parse error\");\n\n            string strReply;\n\n            // singleton request\n            if (valRequest.type() == obj_type) {\n                jreq.parse(valRequest);\n\n                Value result = tableRPC.execute(jreq.strMethod, jreq.params);\n\n                // Send reply\n                strReply = JSONRPCReply(result, Value::null, jreq.id);\n\n            // array of requests\n            } else if (valRequest.type() == array_type)\n                strReply = JSONRPCExecBatch(valRequest.get_array());\n            else\n                throw JSONRPCError(RPC_PARSE_ERROR, \"Top-level object parse error\");\n\n            conn->stream() << HTTPReply(HTTP_OK, strReply, fRun) << std::flush;\n        }\n        catch (Object& objError)\n        {\n            ErrorReply(conn->stream(), objError, jreq.id);\n            break;\n        }\n        catch (std::exception& e)\n        {\n            ErrorReply(conn->stream(), JSONRPCError(RPC_PARSE_ERROR, e.what()), jreq.id);\n            break;\n        }\n    }\n\n    delete conn;\n    {\n        LOCK(cs_THREAD_RPCHANDLER);\n        vnThreadsRunning[THREAD_RPCHANDLER]--;\n    }\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [
            "#define printf OutputDebugStringF"
          ],
          "globals_used": [
            "void ThreadRPCServer2(void* parg);",
            "void ThreadRPCServer3(void* parg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\n#define printf OutputDebugStringF\n\nvoid ThreadRPCServer2(void* parg);\nvoid ThreadRPCServer3(void* parg);\n\nvoid ThreadRPCServer3(void* parg)\n{\n    // Make this thread recognisable as the RPC handler\n    RenameThread(\"hal-rpchand\");\n\n    {\n        LOCK(cs_THREAD_RPCHANDLER);\n        vnThreadsRunning[THREAD_RPCHANDLER]++;\n    }\n    AcceptedConnection *conn = (AcceptedConnection *) parg;\n\n    bool fRun = true;\n    while (true)\n    {\n        if (fShutdown || !fRun)\n        {\n            conn->close();\n            delete conn;\n            {\n                LOCK(cs_THREAD_RPCHANDLER);\n                --vnThreadsRunning[THREAD_RPCHANDLER];\n            }\n            return;\n        }\n        map<string, string> mapHeaders;\n        string strRequest;\n\n        ReadHTTP(conn->stream(), mapHeaders, strRequest);\n\n        // Check authorization\n        if (mapHeaders.count(\"authorization\") == 0)\n        {\n            conn->stream() << HTTPReply(HTTP_UNAUTHORIZED, \"\", false) << std::flush;\n            break;\n        }\n        if (!HTTPAuthorized(mapHeaders))\n        {\n            printf(\"ThreadRPCServer incorrect password attempt from %s\\n\", conn->peer_address_to_string().c_str());\n            /* Deter brute-forcing short passwords.\n               If this results in a DOS the user really\n               shouldn't have their RPC port exposed.*/\n            if (mapArgs[\"-rpcpassword\"].size() < 20)\n                MilliSleep(250);\n\n            conn->stream() << HTTPReply(HTTP_UNAUTHORIZED, \"\", false) << std::flush;\n            break;\n        }\n        if (mapHeaders[\"connection\"] == \"close\")\n            fRun = false;\n\n        JSONRequest jreq;\n        try\n        {\n            // Parse request\n            Value valRequest;\n            if (!read_string(strRequest, valRequest))\n                throw JSONRPCError(RPC_PARSE_ERROR, \"Parse error\");\n\n            string strReply;\n\n            // singleton request\n            if (valRequest.type() == obj_type) {\n                jreq.parse(valRequest);\n\n                Value result = tableRPC.execute(jreq.strMethod, jreq.params);\n\n                // Send reply\n                strReply = JSONRPCReply(result, Value::null, jreq.id);\n\n            // array of requests\n            } else if (valRequest.type() == array_type)\n                strReply = JSONRPCExecBatch(valRequest.get_array());\n            else\n                throw JSONRPCError(RPC_PARSE_ERROR, \"Top-level object parse error\");\n\n            conn->stream() << HTTPReply(HTTP_OK, strReply, fRun) << std::flush;\n        }\n        catch (Object& objError)\n        {\n            ErrorReply(conn->stream(), objError, jreq.id);\n            break;\n        }\n        catch (std::exception& e)\n        {\n            ErrorReply(conn->stream(), JSONRPCError(RPC_PARSE_ERROR, e.what()), jreq.id);\n            break;\n        }\n    }\n\n    delete conn;\n    {\n        LOCK(cs_THREAD_RPCHANDLER);\n        vnThreadsRunning[THREAD_RPCHANDLER]--;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"server ready\\n\""
          ],
          "line": 1374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "string",
          "args": [
            "argv[1]"
          ],
          "line": 1372
        },
        "resolved": true,
        "details": {
          "function_name": "non_printable_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "29-41",
          "snippet": "String_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "setbuf",
          "args": [
            "stderr",
            "NULL"
          ],
          "line": 1368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setbuf",
          "args": [
            "stdout",
            "NULL"
          ],
          "line": 1367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setbuf",
          "args": [
            "stdin",
            "NULL"
          ],
          "line": 1366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_CrtSetReportFile",
          "args": [
            "_CRT_WARN",
            "CreateFile(\"NUL\", GENERIC_WRITE, 0, NULL, OPEN_EXISTING, 0, 0)"
          ],
          "line": 1364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CreateFile",
          "args": [
            "\"NUL\"",
            "GENERIC_WRITE",
            "0",
            "NULL",
            "OPEN_EXISTING",
            "0",
            "0"
          ],
          "line": 1364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_CrtSetReportMode",
          "args": [
            "_CRT_WARN",
            "_CRTDBG_MODE_FILE"
          ],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\n#define printf OutputDebugStringF\n\nint main(int argc, char *argv[])\n{\n#ifdef _MSC_VER\n    // Turn off Microsoft heap dump noise\n    _CrtSetReportMode(_CRT_WARN, _CRTDBG_MODE_FILE);\n    _CrtSetReportFile(_CRT_WARN, CreateFile(\"NUL\", GENERIC_WRITE, 0, NULL, OPEN_EXISTING, 0, 0));\n#endif\n    setbuf(stdin, NULL);\n    setbuf(stdout, NULL);\n    setbuf(stderr, NULL);\n\n    try\n    {\n        if (argc >= 2 && string(argv[1]) == \"-server\")\n        {\n            printf(\"server ready\\n\");\n            ThreadRPCServer(NULL);\n        }\n        else\n        {\n            return CommandLineRPC(argc, argv);\n        }\n    }\n    catch (std::exception& e) {\n        PrintException(&e, \"main()\");\n    } catch (...) {\n        PrintException(NULL, \"main()\");\n    }\n    return 0;\n}"
  },
  {
    "function_name": "CommandLineRPC",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "1291-1353",
    "snippet": "int CommandLineRPC(int argc, char *argv[])\n{\n    string strPrint;\n    int nRet = 0;\n    try\n    {\n        // Skip switches\n        while (argc > 1 && IsSwitchChar(argv[1][0]))\n        {\n            argc--;\n            argv++;\n        }\n\n        // Method\n        if (argc < 2)\n            throw runtime_error(\"too few parameters\");\n        string strMethod = argv[1];\n\n        // Parameters default to strings\n        std::vector<std::string> strParams(&argv[2], &argv[argc]);\n        Array params = RPCConvertValues(strMethod, strParams);\n\n        // Execute\n        Object reply = CallRPC(strMethod, params);\n\n        // Parse reply\n        const Value& result = find_value(reply, \"result\");\n        const Value& error  = find_value(reply, \"error\");\n\n        if (error.type() != null_type)\n        {\n            // Error\n            strPrint = \"error: \" + write_string(error, false);\n            int code = find_value(error.get_obj(), \"code\").get_int();\n            nRet = abs(code);\n        }\n        else\n        {\n            // Result\n            if (result.type() == null_type)\n                strPrint = \"\";\n            else if (result.type() == str_type)\n                strPrint = result.get_str();\n            else\n                strPrint = write_string(result, true);\n        }\n    }\n    catch (std::exception& e)\n    {\n        strPrint = string(\"error: \") + e.what();\n        nRet = 87;\n    }\n    catch (...)\n    {\n        PrintException(NULL, \"CommandLineRPC()\");\n    }\n\n    if (strPrint != \"\")\n    {\n        fprintf((nRet == 0 ? stdout : stderr), \"%s\\n\", strPrint.c_str());\n    }\n    return nRet;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "(nRet == 0 ? stdout : stderr)",
            "\"%s\\n\"",
            "strPrint.c_str()"
          ],
          "line": 1350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strPrint.c_str",
          "args": [],
          "line": 1350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PrintException",
          "args": [
            "NULL",
            "\"CommandLineRPC()\""
          ],
          "line": 1345
        },
        "resolved": true,
        "details": {
          "function_name": "PrintExceptionContinue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1005-1011",
          "snippet": "void PrintExceptionContinue(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n\\n************************\\n%s\\n\", message.c_str());\n    fprintf(stderr, \"\\n\\n************************\\n%s\\n\", message.c_str());\n    strMiscWarning = message;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "string strMiscWarning;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring strMiscWarning;\n\nvoid PrintExceptionContinue(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n\\n************************\\n%s\\n\", message.c_str());\n    fprintf(stderr, \"\\n\\n************************\\n%s\\n\", message.c_str());\n    strMiscWarning = message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 1340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "string",
          "args": [
            "\"error: \""
          ],
          "line": 1340
        },
        "resolved": true,
        "details": {
          "function_name": "non_printable_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "29-41",
          "snippet": "String_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "write_string",
          "args": [
            "result",
            "true"
          ],
          "line": 1335
        },
        "resolved": true,
        "details": {
          "function_name": "write_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "234-243",
          "snippet": "typename Value_type::String_type write_string( const Value_type& value, bool pretty )\n    {\n        typedef typename Value_type::String_type::value_type Char_type;\n\n        std::basic_ostringstream< Char_type > os;\n\n        write_stream( value, os, pretty );\n\n        return os.str();\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\ntypename Value_type::String_type write_string( const Value_type& value, bool pretty )\n    {\n        typedef typename Value_type::String_type::value_type Char_type;\n\n        std::basic_ostringstream< Char_type > os;\n\n        write_stream( value, os, pretty );\n\n        return os.str();\n    }"
        }
      },
      {
        "call_info": {
          "callee": "result.get_str",
          "args": [],
          "line": 1333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.type",
          "args": [],
          "line": 1332
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "abs",
          "args": [
            "code"
          ],
          "line": 1325
        },
        "resolved": true,
        "details": {
          "function_name": "abs64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "307-310",
          "snippet": "inline int64_t abs64(int64_t n)\n{\n    return (n >= 0 ? n : -n);\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t abs64(int64_t n)\n{\n    return (n >= 0 ? n : -n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [
            "error.get_obj()",
            "\"code\""
          ],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error.get_obj",
          "args": [],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [
            "reply",
            "\"error\""
          ],
          "line": 1318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [
            "reply",
            "\"result\""
          ],
          "line": 1317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CallRPC",
          "args": [
            "strMethod",
            "params"
          ],
          "line": 1314
        },
        "resolved": true,
        "details": {
          "function_name": "CallRPC",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "1145-1200",
          "snippet": "Object CallRPC(const string& strMethod, const Array& params)\n{\n    if (mapArgs[\"-rpcuser\"] == \"\" && mapArgs[\"-rpcpassword\"] == \"\")\n        throw runtime_error(strprintf(\n            _(\"You must set rpcpassword=<password> in the configuration file:\\n%s\\n\"\n              \"If the file does not exist, create it with owner-readable-only file permissions.\"),\n                GetConfigFile().string().c_str()));\n\n    // Connect to localhost\n    bool fUseSSL = GetBoolArg(\"-rpcssl\");\n    asio::io_service io_service;\n\n#if (BOOST_VERSION > 106501)\n    ssl::context context(ssl::context::sslv23);\n#else\n    ssl::context context(io_service, ssl::context::sslv23);\n#endif\n\n    context.set_options(ssl::context::no_sslv2);\n    asio::ssl::stream<asio::ip::tcp::socket> sslStream(io_service, context);\n    SSLIOStreamDevice<asio::ip::tcp> d(sslStream, fUseSSL);\n    iostreams::stream< SSLIOStreamDevice<asio::ip::tcp> > stream(d);\n    if (!d.connect(GetArg(\"-rpcconnect\", \"127.0.0.1\"), GetArg(\"-rpcport\", itostr(GetDefaultRPCPort()))))\n        throw runtime_error(\"couldn't connect to server\");\n\n    // HTTP basic authentication\n    string strUserPass64 = EncodeBase64(mapArgs[\"-rpcuser\"] + \":\" + mapArgs[\"-rpcpassword\"]);\n    map<string, string> mapRequestHeaders;\n    mapRequestHeaders[\"Authorization\"] = string(\"Basic \") + strUserPass64;\n\n    // Send request\n    string strRequest = JSONRPCRequest(strMethod, params, 1);\n    string strPost = HTTPPost(strRequest, mapRequestHeaders);\n    stream << strPost << std::flush;\n\n    // Receive reply\n    map<string, string> mapHeaders;\n    string strReply;\n    int nStatus = ReadHTTP(stream, mapHeaders, strReply);\n    if (nStatus == HTTP_UNAUTHORIZED)\n        throw runtime_error(\"incorrect rpcuser or rpcpassword (authorization failed)\");\n    else if (nStatus >= 400 && nStatus != HTTP_BAD_REQUEST && nStatus != HTTP_NOT_FOUND && nStatus != HTTP_INTERNAL_SERVER_ERROR)\n        throw runtime_error(strprintf(\"server returned HTTP error %d\", nStatus));\n    else if (strReply.empty())\n        throw runtime_error(\"no response from server\");\n\n    // Parse reply\n    Value valReply;\n    if (!read_string(strReply, valReply))\n        throw runtime_error(\"couldn't parse reply from server\");\n    const Object& reply = valReply.get_obj();\n    if (reply.empty())\n        throw runtime_error(\"expected reply to have result, error and id properties\");\n\n    return reply;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject CallRPC(const string& strMethod, const Array& params)\n{\n    if (mapArgs[\"-rpcuser\"] == \"\" && mapArgs[\"-rpcpassword\"] == \"\")\n        throw runtime_error(strprintf(\n            _(\"You must set rpcpassword=<password> in the configuration file:\\n%s\\n\"\n              \"If the file does not exist, create it with owner-readable-only file permissions.\"),\n                GetConfigFile().string().c_str()));\n\n    // Connect to localhost\n    bool fUseSSL = GetBoolArg(\"-rpcssl\");\n    asio::io_service io_service;\n\n#if (BOOST_VERSION > 106501)\n    ssl::context context(ssl::context::sslv23);\n#else\n    ssl::context context(io_service, ssl::context::sslv23);\n#endif\n\n    context.set_options(ssl::context::no_sslv2);\n    asio::ssl::stream<asio::ip::tcp::socket> sslStream(io_service, context);\n    SSLIOStreamDevice<asio::ip::tcp> d(sslStream, fUseSSL);\n    iostreams::stream< SSLIOStreamDevice<asio::ip::tcp> > stream(d);\n    if (!d.connect(GetArg(\"-rpcconnect\", \"127.0.0.1\"), GetArg(\"-rpcport\", itostr(GetDefaultRPCPort()))))\n        throw runtime_error(\"couldn't connect to server\");\n\n    // HTTP basic authentication\n    string strUserPass64 = EncodeBase64(mapArgs[\"-rpcuser\"] + \":\" + mapArgs[\"-rpcpassword\"]);\n    map<string, string> mapRequestHeaders;\n    mapRequestHeaders[\"Authorization\"] = string(\"Basic \") + strUserPass64;\n\n    // Send request\n    string strRequest = JSONRPCRequest(strMethod, params, 1);\n    string strPost = HTTPPost(strRequest, mapRequestHeaders);\n    stream << strPost << std::flush;\n\n    // Receive reply\n    map<string, string> mapHeaders;\n    string strReply;\n    int nStatus = ReadHTTP(stream, mapHeaders, strReply);\n    if (nStatus == HTTP_UNAUTHORIZED)\n        throw runtime_error(\"incorrect rpcuser or rpcpassword (authorization failed)\");\n    else if (nStatus >= 400 && nStatus != HTTP_BAD_REQUEST && nStatus != HTTP_NOT_FOUND && nStatus != HTTP_INTERNAL_SERVER_ERROR)\n        throw runtime_error(strprintf(\"server returned HTTP error %d\", nStatus));\n    else if (strReply.empty())\n        throw runtime_error(\"no response from server\");\n\n    // Parse reply\n    Value valReply;\n    if (!read_string(strReply, valReply))\n        throw runtime_error(\"couldn't parse reply from server\");\n    const Object& reply = valReply.get_obj();\n    if (reply.empty())\n        throw runtime_error(\"expected reply to have result, error and id properties\");\n\n    return reply;\n}"
        }
      },
      {
        "call_info": {
          "callee": "RPCConvertValues",
          "args": [
            "strMethod",
            "strParams"
          ],
          "line": 1311
        },
        "resolved": true,
        "details": {
          "function_name": "RPCConvertValues",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "1227-1289",
          "snippet": "Array RPCConvertValues(const std::string &strMethod, const std::vector<std::string> &strParams)\n{\n    Array params;\n    BOOST_FOREACH(const std::string &param, strParams)\n        params.push_back(param);\n\n    int n = params.size();\n\n    //\n    // Special case non-string parameter types\n    //\n    if (strMethod == \"stop\"                   && n > 0) ConvertTo<bool>(params[0]);\n    if (strMethod == \"sendtoaddress\"          && n > 1) ConvertTo<double>(params[1]);\n    if (strMethod == \"settxfee\"               && n > 0) ConvertTo<double>(params[0]);\n    if (strMethod == \"getreceivedbyaddress\"   && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"getreceivedbyaccount\"   && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listreceivedbyaddress\"  && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listreceivedbyaddress\"  && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"listreceivedbyaccount\"  && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listreceivedbyaccount\"  && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getbalance\"             && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"getblock\"               && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getblockbynumber\"       && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"getblockbynumber\"       && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getblockhash\"           && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"move\"                   && n > 2) ConvertTo<double>(params[2]);\n    if (strMethod == \"move\"                   && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"sendfrom\"               && n > 2) ConvertTo<double>(params[2]);\n    if (strMethod == \"sendfrom\"               && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"listtransactions\"       && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listtransactions\"       && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"listaccounts\"           && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"walletpassphrase\"       && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"walletpassphrase\"       && n > 2) ConvertTo<bool>(params[2]);\n    if (strMethod == \"getblocktemplate\"       && n > 0) ConvertTo<Object>(params[0]);\n    if (strMethod == \"listsinceblock\"         && n > 1) ConvertTo<boost::int64_t>(params[1]);\n\n    if (strMethod == \"sendalert\"              && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"sendalert\"              && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"sendalert\"              && n > 4) ConvertTo<boost::int64_t>(params[4]);\n    if (strMethod == \"sendalert\"              && n > 5) ConvertTo<boost::int64_t>(params[5]);\n    if (strMethod == \"sendalert\"              && n > 6) ConvertTo<boost::int64_t>(params[6]);\n\n    if (strMethod == \"sendmany\"               && n > 1) ConvertTo<Object>(params[1]);\n    if (strMethod == \"sendmany\"               && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"reservebalance\"         && n > 0) ConvertTo<bool>(params[0]);\n    if (strMethod == \"reservebalance\"         && n > 1) ConvertTo<double>(params[1]);\n    if (strMethod == \"addmultisigaddress\"     && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"addmultisigaddress\"     && n > 1) ConvertTo<Array>(params[1]);\n    if (strMethod == \"listunspent\"            && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listunspent\"            && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listunspent\"            && n > 2) ConvertTo<Array>(params[2]);\n    if (strMethod == \"getrawtransaction\"      && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"createrawtransaction\"   && n > 0) ConvertTo<Array>(params[0]);\n    if (strMethod == \"createrawtransaction\"   && n > 1) ConvertTo<Object>(params[1]);\n    if (strMethod == \"signrawtransaction\"     && n > 1) ConvertTo<Array>(params[1], true);\n    if (strMethod == \"signrawtransaction\"     && n > 2) ConvertTo<Array>(params[2], true);\n    if (strMethod == \"keypoolrefill\"          && n > 0) ConvertTo<boost::int64_t>(params[0]);\n\n    if((strMethod == \"importprivkey\")         && (n > 2)) ConvertTo<bool>(params[2]);\n\n    return params;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nArray RPCConvertValues(const std::string &strMethod, const std::vector<std::string> &strParams)\n{\n    Array params;\n    BOOST_FOREACH(const std::string &param, strParams)\n        params.push_back(param);\n\n    int n = params.size();\n\n    //\n    // Special case non-string parameter types\n    //\n    if (strMethod == \"stop\"                   && n > 0) ConvertTo<bool>(params[0]);\n    if (strMethod == \"sendtoaddress\"          && n > 1) ConvertTo<double>(params[1]);\n    if (strMethod == \"settxfee\"               && n > 0) ConvertTo<double>(params[0]);\n    if (strMethod == \"getreceivedbyaddress\"   && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"getreceivedbyaccount\"   && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listreceivedbyaddress\"  && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listreceivedbyaddress\"  && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"listreceivedbyaccount\"  && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listreceivedbyaccount\"  && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getbalance\"             && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"getblock\"               && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getblockbynumber\"       && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"getblockbynumber\"       && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getblockhash\"           && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"move\"                   && n > 2) ConvertTo<double>(params[2]);\n    if (strMethod == \"move\"                   && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"sendfrom\"               && n > 2) ConvertTo<double>(params[2]);\n    if (strMethod == \"sendfrom\"               && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"listtransactions\"       && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listtransactions\"       && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"listaccounts\"           && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"walletpassphrase\"       && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"walletpassphrase\"       && n > 2) ConvertTo<bool>(params[2]);\n    if (strMethod == \"getblocktemplate\"       && n > 0) ConvertTo<Object>(params[0]);\n    if (strMethod == \"listsinceblock\"         && n > 1) ConvertTo<boost::int64_t>(params[1]);\n\n    if (strMethod == \"sendalert\"              && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"sendalert\"              && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"sendalert\"              && n > 4) ConvertTo<boost::int64_t>(params[4]);\n    if (strMethod == \"sendalert\"              && n > 5) ConvertTo<boost::int64_t>(params[5]);\n    if (strMethod == \"sendalert\"              && n > 6) ConvertTo<boost::int64_t>(params[6]);\n\n    if (strMethod == \"sendmany\"               && n > 1) ConvertTo<Object>(params[1]);\n    if (strMethod == \"sendmany\"               && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"reservebalance\"         && n > 0) ConvertTo<bool>(params[0]);\n    if (strMethod == \"reservebalance\"         && n > 1) ConvertTo<double>(params[1]);\n    if (strMethod == \"addmultisigaddress\"     && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"addmultisigaddress\"     && n > 1) ConvertTo<Array>(params[1]);\n    if (strMethod == \"listunspent\"            && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listunspent\"            && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listunspent\"            && n > 2) ConvertTo<Array>(params[2]);\n    if (strMethod == \"getrawtransaction\"      && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"createrawtransaction\"   && n > 0) ConvertTo<Array>(params[0]);\n    if (strMethod == \"createrawtransaction\"   && n > 1) ConvertTo<Object>(params[1]);\n    if (strMethod == \"signrawtransaction\"     && n > 1) ConvertTo<Array>(params[1], true);\n    if (strMethod == \"signrawtransaction\"     && n > 2) ConvertTo<Array>(params[2], true);\n    if (strMethod == \"keypoolrefill\"          && n > 0) ConvertTo<boost::int64_t>(params[0]);\n\n    if((strMethod == \"importprivkey\")         && (n > 2)) ConvertTo<bool>(params[2]);\n\n    return params;\n}"
        }
      },
      {
        "call_info": {
          "callee": "runtime_error",
          "args": [
            "\"too few parameters\""
          ],
          "line": 1306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsSwitchChar",
          "args": [
            "argv[1][0]"
          ],
          "line": 1298
        },
        "resolved": true,
        "details": {
          "function_name": "IsSwitchChar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "399-406",
          "snippet": "inline bool IsSwitchChar(char c)\n{\n#ifdef WIN32\n    return c == '-' || c == '/';\n#else\n    return c == '-';\n#endif\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline bool IsSwitchChar(char c)\n{\n#ifdef WIN32\n    return c == '-' || c == '/';\n#else\n    return c == '-';\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nint CommandLineRPC(int argc, char *argv[])\n{\n    string strPrint;\n    int nRet = 0;\n    try\n    {\n        // Skip switches\n        while (argc > 1 && IsSwitchChar(argv[1][0]))\n        {\n            argc--;\n            argv++;\n        }\n\n        // Method\n        if (argc < 2)\n            throw runtime_error(\"too few parameters\");\n        string strMethod = argv[1];\n\n        // Parameters default to strings\n        std::vector<std::string> strParams(&argv[2], &argv[argc]);\n        Array params = RPCConvertValues(strMethod, strParams);\n\n        // Execute\n        Object reply = CallRPC(strMethod, params);\n\n        // Parse reply\n        const Value& result = find_value(reply, \"result\");\n        const Value& error  = find_value(reply, \"error\");\n\n        if (error.type() != null_type)\n        {\n            // Error\n            strPrint = \"error: \" + write_string(error, false);\n            int code = find_value(error.get_obj(), \"code\").get_int();\n            nRet = abs(code);\n        }\n        else\n        {\n            // Result\n            if (result.type() == null_type)\n                strPrint = \"\";\n            else if (result.type() == str_type)\n                strPrint = result.get_str();\n            else\n                strPrint = write_string(result, true);\n        }\n    }\n    catch (std::exception& e)\n    {\n        strPrint = string(\"error: \") + e.what();\n        nRet = 87;\n    }\n    catch (...)\n    {\n        PrintException(NULL, \"CommandLineRPC()\");\n    }\n\n    if (strPrint != \"\")\n    {\n        fprintf((nRet == 0 ? stdout : stderr), \"%s\\n\", strPrint.c_str());\n    }\n    return nRet;\n}"
  },
  {
    "function_name": "RPCConvertValues",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "1227-1289",
    "snippet": "Array RPCConvertValues(const std::string &strMethod, const std::vector<std::string> &strParams)\n{\n    Array params;\n    BOOST_FOREACH(const std::string &param, strParams)\n        params.push_back(param);\n\n    int n = params.size();\n\n    //\n    // Special case non-string parameter types\n    //\n    if (strMethod == \"stop\"                   && n > 0) ConvertTo<bool>(params[0]);\n    if (strMethod == \"sendtoaddress\"          && n > 1) ConvertTo<double>(params[1]);\n    if (strMethod == \"settxfee\"               && n > 0) ConvertTo<double>(params[0]);\n    if (strMethod == \"getreceivedbyaddress\"   && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"getreceivedbyaccount\"   && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listreceivedbyaddress\"  && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listreceivedbyaddress\"  && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"listreceivedbyaccount\"  && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listreceivedbyaccount\"  && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getbalance\"             && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"getblock\"               && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getblockbynumber\"       && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"getblockbynumber\"       && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getblockhash\"           && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"move\"                   && n > 2) ConvertTo<double>(params[2]);\n    if (strMethod == \"move\"                   && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"sendfrom\"               && n > 2) ConvertTo<double>(params[2]);\n    if (strMethod == \"sendfrom\"               && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"listtransactions\"       && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listtransactions\"       && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"listaccounts\"           && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"walletpassphrase\"       && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"walletpassphrase\"       && n > 2) ConvertTo<bool>(params[2]);\n    if (strMethod == \"getblocktemplate\"       && n > 0) ConvertTo<Object>(params[0]);\n    if (strMethod == \"listsinceblock\"         && n > 1) ConvertTo<boost::int64_t>(params[1]);\n\n    if (strMethod == \"sendalert\"              && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"sendalert\"              && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"sendalert\"              && n > 4) ConvertTo<boost::int64_t>(params[4]);\n    if (strMethod == \"sendalert\"              && n > 5) ConvertTo<boost::int64_t>(params[5]);\n    if (strMethod == \"sendalert\"              && n > 6) ConvertTo<boost::int64_t>(params[6]);\n\n    if (strMethod == \"sendmany\"               && n > 1) ConvertTo<Object>(params[1]);\n    if (strMethod == \"sendmany\"               && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"reservebalance\"         && n > 0) ConvertTo<bool>(params[0]);\n    if (strMethod == \"reservebalance\"         && n > 1) ConvertTo<double>(params[1]);\n    if (strMethod == \"addmultisigaddress\"     && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"addmultisigaddress\"     && n > 1) ConvertTo<Array>(params[1]);\n    if (strMethod == \"listunspent\"            && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listunspent\"            && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listunspent\"            && n > 2) ConvertTo<Array>(params[2]);\n    if (strMethod == \"getrawtransaction\"      && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"createrawtransaction\"   && n > 0) ConvertTo<Array>(params[0]);\n    if (strMethod == \"createrawtransaction\"   && n > 1) ConvertTo<Object>(params[1]);\n    if (strMethod == \"signrawtransaction\"     && n > 1) ConvertTo<Array>(params[1], true);\n    if (strMethod == \"signrawtransaction\"     && n > 2) ConvertTo<Array>(params[2], true);\n    if (strMethod == \"keypoolrefill\"          && n > 0) ConvertTo<boost::int64_t>(params[0]);\n\n    if((strMethod == \"importprivkey\")         && (n > 2)) ConvertTo<bool>(params[2]);\n\n    return params;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ConvertTo<bool>",
          "args": [
            "params[2]"
          ],
          "line": 1286
        },
        "resolved": true,
        "details": {
          "function_name": "ConvertTo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "1206-1224",
          "snippet": "void ConvertTo(Value& value, bool fAllowNull=false)\n{\n    if (fAllowNull && value.type() == null_type)\n        return;\n    if (value.type() == str_type)\n    {\n        // reinterpret string as unquoted json value\n        Value value2;\n        string strJSON = value.get_str();\n        if (!read_string(strJSON, value2))\n            throw runtime_error(string(\"Error parsing JSON:\")+strJSON);\n        ConvertTo<T>(value2, fAllowNull);\n        value = value2;\n    }\n    else\n    {\n        value = value.get_value<T>();\n    }\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nvoid ConvertTo(Value& value, bool fAllowNull=false)\n{\n    if (fAllowNull && value.type() == null_type)\n        return;\n    if (value.type() == str_type)\n    {\n        // reinterpret string as unquoted json value\n        Value value2;\n        string strJSON = value.get_str();\n        if (!read_string(strJSON, value2))\n            throw runtime_error(string(\"Error parsing JSON:\")+strJSON);\n        ConvertTo<T>(value2, fAllowNull);\n        value = value2;\n    }\n    else\n    {\n        value = value.get_value<T>();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ConvertTo<Array>",
          "args": [
            "params[2]",
            "true"
          ],
          "line": 1283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ConvertTo<Array>",
          "args": [
            "params[1]",
            "true"
          ],
          "line": 1282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.size",
          "args": [],
          "line": 1233
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "params.push_back",
          "args": [
            "param"
          ],
          "line": 1231
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nArray RPCConvertValues(const std::string &strMethod, const std::vector<std::string> &strParams)\n{\n    Array params;\n    BOOST_FOREACH(const std::string &param, strParams)\n        params.push_back(param);\n\n    int n = params.size();\n\n    //\n    // Special case non-string parameter types\n    //\n    if (strMethod == \"stop\"                   && n > 0) ConvertTo<bool>(params[0]);\n    if (strMethod == \"sendtoaddress\"          && n > 1) ConvertTo<double>(params[1]);\n    if (strMethod == \"settxfee\"               && n > 0) ConvertTo<double>(params[0]);\n    if (strMethod == \"getreceivedbyaddress\"   && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"getreceivedbyaccount\"   && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listreceivedbyaddress\"  && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listreceivedbyaddress\"  && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"listreceivedbyaccount\"  && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listreceivedbyaccount\"  && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getbalance\"             && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"getblock\"               && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getblockbynumber\"       && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"getblockbynumber\"       && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getblockhash\"           && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"move\"                   && n > 2) ConvertTo<double>(params[2]);\n    if (strMethod == \"move\"                   && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"sendfrom\"               && n > 2) ConvertTo<double>(params[2]);\n    if (strMethod == \"sendfrom\"               && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"listtransactions\"       && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listtransactions\"       && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"listaccounts\"           && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"walletpassphrase\"       && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"walletpassphrase\"       && n > 2) ConvertTo<bool>(params[2]);\n    if (strMethod == \"getblocktemplate\"       && n > 0) ConvertTo<Object>(params[0]);\n    if (strMethod == \"listsinceblock\"         && n > 1) ConvertTo<boost::int64_t>(params[1]);\n\n    if (strMethod == \"sendalert\"              && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"sendalert\"              && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"sendalert\"              && n > 4) ConvertTo<boost::int64_t>(params[4]);\n    if (strMethod == \"sendalert\"              && n > 5) ConvertTo<boost::int64_t>(params[5]);\n    if (strMethod == \"sendalert\"              && n > 6) ConvertTo<boost::int64_t>(params[6]);\n\n    if (strMethod == \"sendmany\"               && n > 1) ConvertTo<Object>(params[1]);\n    if (strMethod == \"sendmany\"               && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"reservebalance\"         && n > 0) ConvertTo<bool>(params[0]);\n    if (strMethod == \"reservebalance\"         && n > 1) ConvertTo<double>(params[1]);\n    if (strMethod == \"addmultisigaddress\"     && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"addmultisigaddress\"     && n > 1) ConvertTo<Array>(params[1]);\n    if (strMethod == \"listunspent\"            && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listunspent\"            && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listunspent\"            && n > 2) ConvertTo<Array>(params[2]);\n    if (strMethod == \"getrawtransaction\"      && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"createrawtransaction\"   && n > 0) ConvertTo<Array>(params[0]);\n    if (strMethod == \"createrawtransaction\"   && n > 1) ConvertTo<Object>(params[1]);\n    if (strMethod == \"signrawtransaction\"     && n > 1) ConvertTo<Array>(params[1], true);\n    if (strMethod == \"signrawtransaction\"     && n > 2) ConvertTo<Array>(params[2], true);\n    if (strMethod == \"keypoolrefill\"          && n > 0) ConvertTo<boost::int64_t>(params[0]);\n\n    if((strMethod == \"importprivkey\")         && (n > 2)) ConvertTo<bool>(params[2]);\n\n    return params;\n}"
  },
  {
    "function_name": "ConvertTo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "1206-1224",
    "snippet": "void ConvertTo(Value& value, bool fAllowNull=false)\n{\n    if (fAllowNull && value.type() == null_type)\n        return;\n    if (value.type() == str_type)\n    {\n        // reinterpret string as unquoted json value\n        Value value2;\n        string strJSON = value.get_str();\n        if (!read_string(strJSON, value2))\n            throw runtime_error(string(\"Error parsing JSON:\")+strJSON);\n        ConvertTo<T>(value2, fAllowNull);\n        value = value2;\n    }\n    else\n    {\n        value = value.get_value<T>();\n    }\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "value.get_value<T>",
          "args": [],
          "line": 1222
        },
        "resolved": true,
        "details": {
          "function_name": "get_value",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "528-531",
          "snippet": "T Value_impl< Config >::get_value() const\n    {\n        return internal_::get_value( *this, internal_::Type_to_type< T >() );\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  T Value_impl< Config >::get_value() const\n      {\n          return internal_::get_value( *this, internal_::Type_to_type< T >() );\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ConvertTo<T>",
          "args": [
            "value2",
            "fAllowNull"
          ],
          "line": 1217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "runtime_error",
          "args": [
            "string(\"Error parsing JSON:\")+strJSON"
          ],
          "line": 1216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "string",
          "args": [
            "\"Error parsing JSON:\""
          ],
          "line": 1216
        },
        "resolved": true,
        "details": {
          "function_name": "non_printable_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "29-41",
          "snippet": "String_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "read_string",
          "args": [
            "strJSON",
            "value2"
          ],
          "line": 1215
        },
        "resolved": true,
        "details": {
          "function_name": "read_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_reader_template.h",
          "lines": "586-591",
          "snippet": "bool read_string( const String_type& s, Value_type& value )\n    {\n        typename String_type::const_iterator begin = s.begin();\n\n        return read_range( begin, s.end(), value );\n    }",
          "includes": [
            "#include <boost/spirit/iterator/position_iterator.hpp>",
            "#include <boost/spirit/iterator/multi_pass.hpp>",
            "#include <boost/spirit/utility/escape_char.hpp>",
            "#include <boost/spirit/utility/confix.hpp>",
            "#include <boost/spirit/core.hpp>",
            "#include <boost/spirit/include/classic_position_iterator.hpp>",
            "#include <boost/spirit/include/classic_multi_pass.hpp>",
            "#include <boost/spirit/include/classic_escape_char.hpp>",
            "#include <boost/spirit/include/classic_confix.hpp>",
            "#include <boost/spirit/include/classic_core.hpp>",
            "#include <boost/version.hpp>",
            "#include <boost/function.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include \"json_spirit_error_position.h\"",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/spirit/iterator/position_iterator.hpp>\n#include <boost/spirit/iterator/multi_pass.hpp>\n#include <boost/spirit/utility/escape_char.hpp>\n#include <boost/spirit/utility/confix.hpp>\n#include <boost/spirit/core.hpp>\n#include <boost/spirit/include/classic_position_iterator.hpp>\n#include <boost/spirit/include/classic_multi_pass.hpp>\n#include <boost/spirit/include/classic_escape_char.hpp>\n#include <boost/spirit/include/classic_confix.hpp>\n#include <boost/spirit/include/classic_core.hpp>\n#include <boost/version.hpp>\n#include <boost/function.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include \"json_spirit_error_position.h\"\n#include \"json_spirit_value.h\"\n\nbool read_string( const String_type& s, Value_type& value )\n    {\n        typename String_type::const_iterator begin = s.begin();\n\n        return read_range( begin, s.end(), value );\n    }"
        }
      },
      {
        "call_info": {
          "callee": "value.get_str",
          "args": [],
          "line": 1214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.type",
          "args": [],
          "line": 1210
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nvoid ConvertTo(Value& value, bool fAllowNull=false)\n{\n    if (fAllowNull && value.type() == null_type)\n        return;\n    if (value.type() == str_type)\n    {\n        // reinterpret string as unquoted json value\n        Value value2;\n        string strJSON = value.get_str();\n        if (!read_string(strJSON, value2))\n            throw runtime_error(string(\"Error parsing JSON:\")+strJSON);\n        ConvertTo<T>(value2, fAllowNull);\n        value = value2;\n    }\n    else\n    {\n        value = value.get_value<T>();\n    }\n}"
  },
  {
    "function_name": "CallRPC",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "1145-1200",
    "snippet": "Object CallRPC(const string& strMethod, const Array& params)\n{\n    if (mapArgs[\"-rpcuser\"] == \"\" && mapArgs[\"-rpcpassword\"] == \"\")\n        throw runtime_error(strprintf(\n            _(\"You must set rpcpassword=<password> in the configuration file:\\n%s\\n\"\n              \"If the file does not exist, create it with owner-readable-only file permissions.\"),\n                GetConfigFile().string().c_str()));\n\n    // Connect to localhost\n    bool fUseSSL = GetBoolArg(\"-rpcssl\");\n    asio::io_service io_service;\n\n#if (BOOST_VERSION > 106501)\n    ssl::context context(ssl::context::sslv23);\n#else\n    ssl::context context(io_service, ssl::context::sslv23);\n#endif\n\n    context.set_options(ssl::context::no_sslv2);\n    asio::ssl::stream<asio::ip::tcp::socket> sslStream(io_service, context);\n    SSLIOStreamDevice<asio::ip::tcp> d(sslStream, fUseSSL);\n    iostreams::stream< SSLIOStreamDevice<asio::ip::tcp> > stream(d);\n    if (!d.connect(GetArg(\"-rpcconnect\", \"127.0.0.1\"), GetArg(\"-rpcport\", itostr(GetDefaultRPCPort()))))\n        throw runtime_error(\"couldn't connect to server\");\n\n    // HTTP basic authentication\n    string strUserPass64 = EncodeBase64(mapArgs[\"-rpcuser\"] + \":\" + mapArgs[\"-rpcpassword\"]);\n    map<string, string> mapRequestHeaders;\n    mapRequestHeaders[\"Authorization\"] = string(\"Basic \") + strUserPass64;\n\n    // Send request\n    string strRequest = JSONRPCRequest(strMethod, params, 1);\n    string strPost = HTTPPost(strRequest, mapRequestHeaders);\n    stream << strPost << std::flush;\n\n    // Receive reply\n    map<string, string> mapHeaders;\n    string strReply;\n    int nStatus = ReadHTTP(stream, mapHeaders, strReply);\n    if (nStatus == HTTP_UNAUTHORIZED)\n        throw runtime_error(\"incorrect rpcuser or rpcpassword (authorization failed)\");\n    else if (nStatus >= 400 && nStatus != HTTP_BAD_REQUEST && nStatus != HTTP_NOT_FOUND && nStatus != HTTP_INTERNAL_SERVER_ERROR)\n        throw runtime_error(strprintf(\"server returned HTTP error %d\", nStatus));\n    else if (strReply.empty())\n        throw runtime_error(\"no response from server\");\n\n    // Parse reply\n    Value valReply;\n    if (!read_string(strReply, valReply))\n        throw runtime_error(\"couldn't parse reply from server\");\n    const Object& reply = valReply.get_obj();\n    if (reply.empty())\n        throw runtime_error(\"expected reply to have result, error and id properties\");\n\n    return reply;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "runtime_error",
          "args": [
            "\"expected reply to have result, error and id properties\""
          ],
          "line": 1197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.empty",
          "args": [],
          "line": 1196
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "valReply.get_obj",
          "args": [],
          "line": 1195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "runtime_error",
          "args": [
            "\"couldn't parse reply from server\""
          ],
          "line": 1194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read_string",
          "args": [
            "strReply",
            "valReply"
          ],
          "line": 1193
        },
        "resolved": true,
        "details": {
          "function_name": "read_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_reader_template.h",
          "lines": "586-591",
          "snippet": "bool read_string( const String_type& s, Value_type& value )\n    {\n        typename String_type::const_iterator begin = s.begin();\n\n        return read_range( begin, s.end(), value );\n    }",
          "includes": [
            "#include <boost/spirit/iterator/position_iterator.hpp>",
            "#include <boost/spirit/iterator/multi_pass.hpp>",
            "#include <boost/spirit/utility/escape_char.hpp>",
            "#include <boost/spirit/utility/confix.hpp>",
            "#include <boost/spirit/core.hpp>",
            "#include <boost/spirit/include/classic_position_iterator.hpp>",
            "#include <boost/spirit/include/classic_multi_pass.hpp>",
            "#include <boost/spirit/include/classic_escape_char.hpp>",
            "#include <boost/spirit/include/classic_confix.hpp>",
            "#include <boost/spirit/include/classic_core.hpp>",
            "#include <boost/version.hpp>",
            "#include <boost/function.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include \"json_spirit_error_position.h\"",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/spirit/iterator/position_iterator.hpp>\n#include <boost/spirit/iterator/multi_pass.hpp>\n#include <boost/spirit/utility/escape_char.hpp>\n#include <boost/spirit/utility/confix.hpp>\n#include <boost/spirit/core.hpp>\n#include <boost/spirit/include/classic_position_iterator.hpp>\n#include <boost/spirit/include/classic_multi_pass.hpp>\n#include <boost/spirit/include/classic_escape_char.hpp>\n#include <boost/spirit/include/classic_confix.hpp>\n#include <boost/spirit/include/classic_core.hpp>\n#include <boost/version.hpp>\n#include <boost/function.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include \"json_spirit_error_position.h\"\n#include \"json_spirit_value.h\"\n\nbool read_string( const String_type& s, Value_type& value )\n    {\n        typename String_type::const_iterator begin = s.begin();\n\n        return read_range( begin, s.end(), value );\n    }"
        }
      },
      {
        "call_info": {
          "callee": "runtime_error",
          "args": [
            "\"no response from server\""
          ],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "runtime_error",
          "args": [
            "strprintf(\"server returned HTTP error %d\", nStatus)"
          ],
          "line": 1187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"server returned HTTP error %d\"",
            "nStatus"
          ],
          "line": 1187
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "runtime_error",
          "args": [
            "\"incorrect rpcuser or rpcpassword (authorization failed)\""
          ],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReadHTTP",
          "args": [
            "stream",
            "mapHeaders",
            "strReply"
          ],
          "line": 1183
        },
        "resolved": true,
        "details": {
          "function_name": "ReadHTTP",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "458-491",
          "snippet": "int ReadHTTP(std::basic_istream<char>& stream, map<string, string>& mapHeadersRet, string& strMessageRet)\n{\n    mapHeadersRet.clear();\n    strMessageRet = \"\";\n\n    // Read status\n    int nProto = 0;\n    int nStatus = ReadHTTPStatus(stream, nProto);\n\n    // Read header\n    int nLen = ReadHTTPHeader(stream, mapHeadersRet);\n    if (nLen < 0 || nLen > (int)MAX_SIZE)\n        return HTTP_INTERNAL_SERVER_ERROR;\n\n    // Read message\n    if (nLen > 0)\n    {\n        vector<char> vch(nLen);\n        stream.read(&vch[0], nLen);\n        strMessageRet = string(vch.begin(), vch.end());\n    }\n\n    string sConHdr = mapHeadersRet[\"connection\"];\n\n    if ((sConHdr != \"close\") && (sConHdr != \"keep-alive\"))\n    {\n        if (nProto >= 1)\n            mapHeadersRet[\"connection\"] = \"keep-alive\";\n        else\n            mapHeadersRet[\"connection\"] = \"close\";\n    }\n\n    return nStatus;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nint ReadHTTP(std::basic_istream<char>& stream, map<string, string>& mapHeadersRet, string& strMessageRet)\n{\n    mapHeadersRet.clear();\n    strMessageRet = \"\";\n\n    // Read status\n    int nProto = 0;\n    int nStatus = ReadHTTPStatus(stream, nProto);\n\n    // Read header\n    int nLen = ReadHTTPHeader(stream, mapHeadersRet);\n    if (nLen < 0 || nLen > (int)MAX_SIZE)\n        return HTTP_INTERNAL_SERVER_ERROR;\n\n    // Read message\n    if (nLen > 0)\n    {\n        vector<char> vch(nLen);\n        stream.read(&vch[0], nLen);\n        strMessageRet = string(vch.begin(), vch.end());\n    }\n\n    string sConHdr = mapHeadersRet[\"connection\"];\n\n    if ((sConHdr != \"close\") && (sConHdr != \"keep-alive\"))\n    {\n        if (nProto >= 1)\n            mapHeadersRet[\"connection\"] = \"keep-alive\";\n        else\n            mapHeadersRet[\"connection\"] = \"close\";\n    }\n\n    return nStatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "HTTPPost",
          "args": [
            "strRequest",
            "mapRequestHeaders"
          ],
          "line": 1177
        },
        "resolved": true,
        "details": {
          "function_name": "HTTPPost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "344-359",
          "snippet": "string HTTPPost(const string& strMsg, const map<string,string>& mapRequestHeaders)\n{\n    ostringstream s;\n    s << \"POST / HTTP/1.1\\r\\n\"\n      << \"User-Agent: halcyon-json-rpc/\" << FormatFullVersion() << \"\\r\\n\"\n      << \"Host: 127.0.0.1\\r\\n\"\n      << \"Content-Type: application/json\\r\\n\"\n      << \"Content-Length: \" << strMsg.size() << \"\\r\\n\"\n      << \"Connection: close\\r\\n\"\n      << \"Accept: application/json\\r\\n\";\n    BOOST_FOREACH(const PAIRTYPE(string, string)& item, mapRequestHeaders)\n        s << item.first << \": \" << item.second << \"\\r\\n\";\n    s << \"\\r\\n\" << strMsg;\n\n    return s.str();\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstring HTTPPost(const string& strMsg, const map<string,string>& mapRequestHeaders)\n{\n    ostringstream s;\n    s << \"POST / HTTP/1.1\\r\\n\"\n      << \"User-Agent: halcyon-json-rpc/\" << FormatFullVersion() << \"\\r\\n\"\n      << \"Host: 127.0.0.1\\r\\n\"\n      << \"Content-Type: application/json\\r\\n\"\n      << \"Content-Length: \" << strMsg.size() << \"\\r\\n\"\n      << \"Connection: close\\r\\n\"\n      << \"Accept: application/json\\r\\n\";\n    BOOST_FOREACH(const PAIRTYPE(string, string)& item, mapRequestHeaders)\n        s << item.first << \": \" << item.second << \"\\r\\n\";\n    s << \"\\r\\n\" << strMsg;\n\n    return s.str();\n}"
        }
      },
      {
        "call_info": {
          "callee": "JSONRPCRequest",
          "args": [
            "strMethod",
            "params",
            "1"
          ],
          "line": 1176
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCRequest",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "513-520",
          "snippet": "string JSONRPCRequest(const string& strMethod, const Array& params, const Value& id)\n{\n    Object request;\n    request.push_back(Pair(\"method\", strMethod));\n    request.push_back(Pair(\"params\", params));\n    request.push_back(Pair(\"id\", id));\n    return write_string(Value(request), false) + \"\\n\";\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstring JSONRPCRequest(const string& strMethod, const Array& params, const Value& id)\n{\n    Object request;\n    request.push_back(Pair(\"method\", strMethod));\n    request.push_back(Pair(\"params\", params));\n    request.push_back(Pair(\"id\", id));\n    return write_string(Value(request), false) + \"\\n\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "string",
          "args": [
            "\"Basic \""
          ],
          "line": 1173
        },
        "resolved": true,
        "details": {
          "function_name": "non_printable_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "29-41",
          "snippet": "String_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "EncodeBase64",
          "args": [
            "mapArgs[\"-rpcuser\"] + \":\" + mapArgs[\"-rpcpassword\"]"
          ],
          "line": 1171
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeBase64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "643-646",
          "snippet": "string EncodeBase64(const string& str)\n{\n    return EncodeBase64((const unsigned char*)str.c_str(), str.size());\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring EncodeBase64(const string& str)\n{\n    return EncodeBase64((const unsigned char*)str.c_str(), str.size());\n}"
        }
      },
      {
        "call_info": {
          "callee": "runtime_error",
          "args": [
            "\"couldn't connect to server\""
          ],
          "line": 1168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d.connect",
          "args": [
            "GetArg(\"-rpcconnect\", \"127.0.0.1\")",
            "GetArg(\"-rpcport\", itostr(GetDefaultRPCPort()))"
          ],
          "line": 1167
        },
        "resolved": true,
        "details": {
          "function_name": "connect",
          "container": "SSLIOStreamDevice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "604-622",
          "snippet": "bool connect(const std::string &server, const std::string &port) {\n#if (BOOST_VERSION >= 107000)\n        ip::tcp::resolver resolver((boost::asio::io_context &)(stream.get_executor().context()));\n#else\n        ip::tcp::resolver resolver(stream.get_io_service());\n#endif\n        ip::tcp::resolver::query query(server.c_str(), port.c_str());\n        ip::tcp::resolver::iterator endpoint_iterator = resolver.resolve(query);\n        ip::tcp::resolver::iterator end;\n        boost::system::error_code error = asio::error::host_not_found;\n        while (error && endpoint_iterator != end)\n        {\n            stream.lowest_layer().close();\n            stream.lowest_layer().connect(*endpoint_iterator++, error);\n        }\n        if (error)\n            return false;\n        return true;\n    }",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nSSLIOStreamDevice {\n  bool connect(const std::string &server, const std::string &port) {\n  #if (BOOST_VERSION >= 107000)\n          ip::tcp::resolver resolver((boost::asio::io_context &)(stream.get_executor().context()));\n  #else\n          ip::tcp::resolver resolver(stream.get_io_service());\n  #endif\n          ip::tcp::resolver::query query(server.c_str(), port.c_str());\n          ip::tcp::resolver::iterator endpoint_iterator = resolver.resolve(query);\n          ip::tcp::resolver::iterator end;\n          boost::system::error_code error = asio::error::host_not_found;\n          while (error && endpoint_iterator != end)\n          {\n              stream.lowest_layer().close();\n              stream.lowest_layer().connect(*endpoint_iterator++, error);\n          }\n          if (error)\n              return false;\n          return true;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetArg",
          "args": [
            "\"-rpcport\"",
            "itostr(GetDefaultRPCPort())"
          ],
          "line": 1167
        },
        "resolved": true,
        "details": {
          "function_name": "GetArg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "562-567",
          "snippet": "int64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "map<string, string> mapArgs;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nint64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}"
        }
      },
      {
        "call_info": {
          "callee": "itostr",
          "args": [
            "GetDefaultRPCPort()"
          ],
          "line": 1167
        },
        "resolved": true,
        "details": {
          "function_name": "itostr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "269-272",
          "snippet": "inline std::string itostr(int n)\n{\n    return strprintf(\"%d\", n);\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline std::string itostr(int n)\n{\n    return strprintf(\"%d\", n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetDefaultRPCPort",
          "args": [],
          "line": 1167
        },
        "resolved": true,
        "details": {
          "function_name": "GetDefaultRPCPort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "49-52",
          "snippet": "static inline unsigned short GetDefaultRPCPort()\n{\n    return GetBoolArg(\"-testnet\", false) ? 35615 : 21109;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic inline unsigned short GetDefaultRPCPort()\n{\n    return GetBoolArg(\"-testnet\", false) ? 35615 : 21109;\n}"
        }
      },
      {
        "call_info": {
          "callee": "context.set_options",
          "args": [
            "ssl::context::no_sslv2"
          ],
          "line": 1163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetBoolArg",
          "args": [
            "\"-rpcssl\""
          ],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "runtime_error",
          "args": [
            "strprintf(\n            _(\"You must set rpcpassword=<password> in the configuration file:\\n%s\\n\"\n              \"If the file does not exist, create it with owner-readable-only file permissions.\"),\n                GetConfigFile().string().c_str())"
          ],
          "line": 1148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetConfigFile",
          "args": [],
          "line": 1151
        },
        "resolved": true,
        "details": {
          "function_name": "GetConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1072-1085",
          "snippet": "boost::filesystem::path GetConfigFile() {\n    namespace fs = boost::filesystem;\n\n    fs::path pathConfigFile;\n    if(mapArgs.count(\"-conf\")) pathConfigFile = fs::path(mapArgs[\"-conf\"]);\n    else pathConfigFile = fs::path(\"halcyon.conf\");\n    if(!pathConfigFile.is_absolute()) {\n        if(!GetBoolArg(\"-testnet\", false)) \n          pathConfigFile = GetDataDir(false) / pathConfigFile;\n        else\n          pathConfigFile = GetDataDir(false) / \"testnet\" / pathConfigFile;\n    }\n    return(pathConfigFile);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "map<string, string> mapArgs;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nboost::filesystem::path GetConfigFile() {\n    namespace fs = boost::filesystem;\n\n    fs::path pathConfigFile;\n    if(mapArgs.count(\"-conf\")) pathConfigFile = fs::path(mapArgs[\"-conf\"]);\n    else pathConfigFile = fs::path(\"halcyon.conf\");\n    if(!pathConfigFile.is_absolute()) {\n        if(!GetBoolArg(\"-testnet\", false)) \n          pathConfigFile = GetDataDir(false) / pathConfigFile;\n        else\n          pathConfigFile = GetDataDir(false) / \"testnet\" / pathConfigFile;\n    }\n    return(pathConfigFile);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"You must set rpcpassword=<password> in the configuration file:\\n%s\\n\"\n              \"If the file does not exist, create it with owner-readable-only file permissions.\""
          ],
          "line": 1149
        },
        "resolved": true,
        "details": {
          "function_name": "key_error",
          "container": "key_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "44-44",
          "snippet": "explicit key_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nkey_error {\n  explicit key_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject CallRPC(const string& strMethod, const Array& params)\n{\n    if (mapArgs[\"-rpcuser\"] == \"\" && mapArgs[\"-rpcpassword\"] == \"\")\n        throw runtime_error(strprintf(\n            _(\"You must set rpcpassword=<password> in the configuration file:\\n%s\\n\"\n              \"If the file does not exist, create it with owner-readable-only file permissions.\"),\n                GetConfigFile().string().c_str()));\n\n    // Connect to localhost\n    bool fUseSSL = GetBoolArg(\"-rpcssl\");\n    asio::io_service io_service;\n\n#if (BOOST_VERSION > 106501)\n    ssl::context context(ssl::context::sslv23);\n#else\n    ssl::context context(io_service, ssl::context::sslv23);\n#endif\n\n    context.set_options(ssl::context::no_sslv2);\n    asio::ssl::stream<asio::ip::tcp::socket> sslStream(io_service, context);\n    SSLIOStreamDevice<asio::ip::tcp> d(sslStream, fUseSSL);\n    iostreams::stream< SSLIOStreamDevice<asio::ip::tcp> > stream(d);\n    if (!d.connect(GetArg(\"-rpcconnect\", \"127.0.0.1\"), GetArg(\"-rpcport\", itostr(GetDefaultRPCPort()))))\n        throw runtime_error(\"couldn't connect to server\");\n\n    // HTTP basic authentication\n    string strUserPass64 = EncodeBase64(mapArgs[\"-rpcuser\"] + \":\" + mapArgs[\"-rpcpassword\"]);\n    map<string, string> mapRequestHeaders;\n    mapRequestHeaders[\"Authorization\"] = string(\"Basic \") + strUserPass64;\n\n    // Send request\n    string strRequest = JSONRPCRequest(strMethod, params, 1);\n    string strPost = HTTPPost(strRequest, mapRequestHeaders);\n    stream << strPost << std::flush;\n\n    // Receive reply\n    map<string, string> mapHeaders;\n    string strReply;\n    int nStatus = ReadHTTP(stream, mapHeaders, strReply);\n    if (nStatus == HTTP_UNAUTHORIZED)\n        throw runtime_error(\"incorrect rpcuser or rpcpassword (authorization failed)\");\n    else if (nStatus >= 400 && nStatus != HTTP_BAD_REQUEST && nStatus != HTTP_NOT_FOUND && nStatus != HTTP_INTERNAL_SERVER_ERROR)\n        throw runtime_error(strprintf(\"server returned HTTP error %d\", nStatus));\n    else if (strReply.empty())\n        throw runtime_error(\"no response from server\");\n\n    // Parse reply\n    Value valReply;\n    if (!read_string(strReply, valReply))\n        throw runtime_error(\"couldn't parse reply from server\");\n    const Object& reply = valReply.get_obj();\n    if (reply.empty())\n        throw runtime_error(\"expected reply to have result, error and id properties\");\n\n    return reply;\n}"
  },
  {
    "function_name": "execute",
    "container": "CRPCTable",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "1111-1142",
    "snippet": "json_spirit::Value CRPCTable::execute(const std::string &strMethod, const json_spirit::Array &params) const\n{\n    // Find method\n    const CRPCCommand *pcmd = tableRPC[strMethod];\n    if (!pcmd)\n        throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n\n    // Observe safe mode\n    string strWarning = GetWarnings(\"rpc\");\n    if (strWarning != \"\" && !GetBoolArg(\"-disablesafemode\") &&\n        !pcmd->okSafeMode)\n        throw JSONRPCError(RPC_FORBIDDEN_BY_SAFE_MODE, string(\"Safe mode: \") + strWarning);\n\n    try\n    {\n        // Execute\n        Value result;\n        {\n            if (pcmd->unlocked)\n                result = pcmd->actor(params, false);\n            else {\n                LOCK2(cs_main, pwalletMain->cs_wallet);\n                result = pcmd->actor(params, false);\n            }\n        }\n        return result;\n    }\n    catch (std::exception& e)\n    {\n        throw JSONRPCError(RPC_MISC_ERROR, e.what());\n    }\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "JSONRPCError",
          "args": [
            "RPC_MISC_ERROR",
            "e.what()"
          ],
          "line": 1140
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "54-60",
          "snippet": "Object JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 1140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pcmd->actor",
          "args": [
            "params",
            "false"
          ],
          "line": 1133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOCK2",
          "args": [
            "cs_main",
            "pwalletMain->cs_wallet"
          ],
          "line": 1132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pcmd->actor",
          "args": [
            "params",
            "false"
          ],
          "line": 1130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "string",
          "args": [
            "\"Safe mode: \""
          ],
          "line": 1122
        },
        "resolved": true,
        "details": {
          "function_name": "non_printable_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "29-41",
          "snippet": "String_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "GetBoolArg",
          "args": [
            "\"-disablesafemode\""
          ],
          "line": 1120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetWarnings",
          "args": [
            "\"rpc\""
          ],
          "line": 1119
        },
        "resolved": true,
        "details": {
          "function_name": "GetWarnings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "2956-3001",
          "snippet": "string GetWarnings(string strFor)\n{\n    int nPriority = 0;\n    string strStatusBar;\n    string strRPC;\n\n    if (GetBoolArg(\"-testsafemode\"))\n        strRPC = \"test\";\n\n    // Misc warnings like out of disk space and clock is wrong\n    if (strMiscWarning != \"\")\n    {\n        nPriority = 1000;\n        strStatusBar = strMiscWarning;\n    }\n\n    // if detected invalid checkpoint enter safe mode\n    if (Checkpoints::hashInvalidCheckpoint != 0)\n    {\n        nPriority = 3000;\n        strStatusBar = strRPC = _(\"WARNING: Invalid checkpoint found! Displayed transactions may not be correct! You may need to upgrade, or notify developers.\");\n    }\n\n    // Alerts\n    {\n        LOCK(cs_mapAlerts);\n        BOOST_FOREACH(PAIRTYPE(const uint256, CAlert)& item, mapAlerts)\n        {\n            const CAlert& alert = item.second;\n            if (alert.AppliesToMe() && alert.nPriority > nPriority)\n            {\n                nPriority = alert.nPriority;\n                strStatusBar = alert.strStatusBar;\n                if (nPriority > 1000)\n                    strRPC = strStatusBar;\n            }\n        }\n    }\n\n    if (strFor == \"statusbar\")\n        return strStatusBar;\n    else if (strFor == \"rpc\")\n        return strRPC;\n    assert(!\"GetWarnings() : invalid parameter\");\n    return \"error\";\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "CBigNum bnProofOfWorkLimit(~uint256(0) >> 20);",
            "CBigNum bnProofOfStakeLimit(~uint256(0) >> 20);",
            "const CBigNum bnNeoScryptSwitch(~uint256(0) >> 30);",
            "CBigNum bnProofOfWorkLimitTestNet(~uint256(0) >> 16);",
            "CBigNum bnProofOfStakeLimitTestNet(~uint256(0) >> 16);",
            "extern map<uint256, CAlert> mapAlerts;",
            "extern CCriticalSection cs_mapAlerts;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nCBigNum bnProofOfWorkLimit(~uint256(0) >> 20);\nCBigNum bnProofOfStakeLimit(~uint256(0) >> 20);\nconst CBigNum bnNeoScryptSwitch(~uint256(0) >> 30);\nCBigNum bnProofOfWorkLimitTestNet(~uint256(0) >> 16);\nCBigNum bnProofOfStakeLimitTestNet(~uint256(0) >> 16);\nextern map<uint256, CAlert> mapAlerts;\nextern CCriticalSection cs_mapAlerts;\n\nstring GetWarnings(string strFor)\n{\n    int nPriority = 0;\n    string strStatusBar;\n    string strRPC;\n\n    if (GetBoolArg(\"-testsafemode\"))\n        strRPC = \"test\";\n\n    // Misc warnings like out of disk space and clock is wrong\n    if (strMiscWarning != \"\")\n    {\n        nPriority = 1000;\n        strStatusBar = strMiscWarning;\n    }\n\n    // if detected invalid checkpoint enter safe mode\n    if (Checkpoints::hashInvalidCheckpoint != 0)\n    {\n        nPriority = 3000;\n        strStatusBar = strRPC = _(\"WARNING: Invalid checkpoint found! Displayed transactions may not be correct! You may need to upgrade, or notify developers.\");\n    }\n\n    // Alerts\n    {\n        LOCK(cs_mapAlerts);\n        BOOST_FOREACH(PAIRTYPE(const uint256, CAlert)& item, mapAlerts)\n        {\n            const CAlert& alert = item.second;\n            if (alert.AppliesToMe() && alert.nPriority > nPriority)\n            {\n                nPriority = alert.nPriority;\n                strStatusBar = alert.strStatusBar;\n                if (nPriority > 1000)\n                    strRPC = strStatusBar;\n            }\n        }\n    }\n\n    if (strFor == \"statusbar\")\n        return strStatusBar;\n    else if (strFor == \"rpc\")\n        return strRPC;\n    assert(!\"GetWarnings() : invalid parameter\");\n    return \"error\";\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nCRPCTable {\n  json_spirit::Value CRPCTable::execute(const std::string &strMethod, const json_spirit::Array &params) const\n  {\n      // Find method\n      const CRPCCommand *pcmd = tableRPC[strMethod];\n      if (!pcmd)\n          throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n  \n      // Observe safe mode\n      string strWarning = GetWarnings(\"rpc\");\n      if (strWarning != \"\" && !GetBoolArg(\"-disablesafemode\") &&\n          !pcmd->okSafeMode)\n          throw JSONRPCError(RPC_FORBIDDEN_BY_SAFE_MODE, string(\"Safe mode: \") + strWarning);\n  \n      try\n      {\n          // Execute\n          Value result;\n          {\n              if (pcmd->unlocked)\n                  result = pcmd->actor(params, false);\n              else {\n                  LOCK2(cs_main, pwalletMain->cs_wallet);\n                  result = pcmd->actor(params, false);\n              }\n          }\n          return result;\n      }\n      catch (std::exception& e)\n      {\n          throw JSONRPCError(RPC_MISC_ERROR, e.what());\n      }\n  }\n}"
  },
  {
    "function_name": "ThreadRPCServer3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "1015-1109",
    "snippet": "void ThreadRPCServer3(void* parg)\n{\n    // Make this thread recognisable as the RPC handler\n    RenameThread(\"hal-rpchand\");\n\n    {\n        LOCK(cs_THREAD_RPCHANDLER);\n        vnThreadsRunning[THREAD_RPCHANDLER]++;\n    }\n    AcceptedConnection *conn = (AcceptedConnection *) parg;\n\n    bool fRun = true;\n    while (true)\n    {\n        if (fShutdown || !fRun)\n        {\n            conn->close();\n            delete conn;\n            {\n                LOCK(cs_THREAD_RPCHANDLER);\n                --vnThreadsRunning[THREAD_RPCHANDLER];\n            }\n            return;\n        }\n        map<string, string> mapHeaders;\n        string strRequest;\n\n        ReadHTTP(conn->stream(), mapHeaders, strRequest);\n\n        // Check authorization\n        if (mapHeaders.count(\"authorization\") == 0)\n        {\n            conn->stream() << HTTPReply(HTTP_UNAUTHORIZED, \"\", false) << std::flush;\n            break;\n        }\n        if (!HTTPAuthorized(mapHeaders))\n        {\n            printf(\"ThreadRPCServer incorrect password attempt from %s\\n\", conn->peer_address_to_string().c_str());\n            /* Deter brute-forcing short passwords.\n               If this results in a DOS the user really\n               shouldn't have their RPC port exposed.*/\n            if (mapArgs[\"-rpcpassword\"].size() < 20)\n                MilliSleep(250);\n\n            conn->stream() << HTTPReply(HTTP_UNAUTHORIZED, \"\", false) << std::flush;\n            break;\n        }\n        if (mapHeaders[\"connection\"] == \"close\")\n            fRun = false;\n\n        JSONRequest jreq;\n        try\n        {\n            // Parse request\n            Value valRequest;\n            if (!read_string(strRequest, valRequest))\n                throw JSONRPCError(RPC_PARSE_ERROR, \"Parse error\");\n\n            string strReply;\n\n            // singleton request\n            if (valRequest.type() == obj_type) {\n                jreq.parse(valRequest);\n\n                Value result = tableRPC.execute(jreq.strMethod, jreq.params);\n\n                // Send reply\n                strReply = JSONRPCReply(result, Value::null, jreq.id);\n\n            // array of requests\n            } else if (valRequest.type() == array_type)\n                strReply = JSONRPCExecBatch(valRequest.get_array());\n            else\n                throw JSONRPCError(RPC_PARSE_ERROR, \"Top-level object parse error\");\n\n            conn->stream() << HTTPReply(HTTP_OK, strReply, fRun) << std::flush;\n        }\n        catch (Object& objError)\n        {\n            ErrorReply(conn->stream(), objError, jreq.id);\n            break;\n        }\n        catch (std::exception& e)\n        {\n            ErrorReply(conn->stream(), JSONRPCError(RPC_PARSE_ERROR, e.what()), jreq.id);\n            break;\n        }\n    }\n\n    delete conn;\n    {\n        LOCK(cs_THREAD_RPCHANDLER);\n        vnThreadsRunning[THREAD_RPCHANDLER]--;\n    }\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [
      "#define printf OutputDebugStringF"
    ],
    "globals_used": [
      "void ThreadRPCServer2(void* parg);",
      "void ThreadRPCServer3(void* parg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs_THREAD_RPCHANDLER"
          ],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ErrorReply",
          "args": [
            "conn->stream()",
            "JSONRPCError(RPC_PARSE_ERROR, e.what())",
            "jreq.id"
          ],
          "line": 1099
        },
        "resolved": true,
        "details": {
          "function_name": "ErrorReply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "540-549",
          "snippet": "void ErrorReply(std::ostream& stream, const Object& objError, const Value& id)\n{\n    // Send error reply from json-rpc error object\n    int nStatus = HTTP_INTERNAL_SERVER_ERROR;\n    int code = find_value(objError, \"code\").get_int();\n    if (code == RPC_INVALID_REQUEST) nStatus = HTTP_BAD_REQUEST;\n    else if (code == RPC_METHOD_NOT_FOUND) nStatus = HTTP_NOT_FOUND;\n    string strReply = JSONRPCReply(Value::null, objError, id);\n    stream << HTTPReply(nStatus, strReply, false) << std::flush;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nvoid ErrorReply(std::ostream& stream, const Object& objError, const Value& id)\n{\n    // Send error reply from json-rpc error object\n    int nStatus = HTTP_INTERNAL_SERVER_ERROR;\n    int code = find_value(objError, \"code\").get_int();\n    if (code == RPC_INVALID_REQUEST) nStatus = HTTP_BAD_REQUEST;\n    else if (code == RPC_METHOD_NOT_FOUND) nStatus = HTTP_NOT_FOUND;\n    string strReply = JSONRPCReply(Value::null, objError, id);\n    stream << HTTPReply(nStatus, strReply, false) << std::flush;\n}"
        }
      },
      {
        "call_info": {
          "callee": "JSONRPCError",
          "args": [
            "RPC_PARSE_ERROR",
            "e.what()"
          ],
          "line": 1099
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "54-60",
          "snippet": "Object JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 1099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->stream",
          "args": [],
          "line": 1099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->stream",
          "args": [],
          "line": 1094
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HTTPReply",
          "args": [
            "HTTP_OK",
            "strReply",
            "fRun"
          ],
          "line": 1090
        },
        "resolved": true,
        "details": {
          "function_name": "HTTPReply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "374-416",
          "snippet": "static string HTTPReply(int nStatus, const string& strMsg, bool keepalive)\n{\n    if (nStatus == HTTP_UNAUTHORIZED)\n        return strprintf(\"HTTP/1.0 401 Authorization Required\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"WWW-Authenticate: Basic realm=\\\"jsonrpc\\\"\\r\\n\"\n            \"Content-Type: text/html\\r\\n\"\n            \"Content-Length: 296\\r\\n\"\n            \"\\r\\n\"\n            \"<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\"\\r\\n\"\n            \"\\\"http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd\\\">\\r\\n\"\n            \"<HTML>\\r\\n\"\n            \"<HEAD>\\r\\n\"\n            \"<TITLE>Error</TITLE>\\r\\n\"\n            \"<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=ISO-8859-1'>\\r\\n\"\n            \"</HEAD>\\r\\n\"\n            \"<BODY><H1>401 Unauthorized.</H1></BODY>\\r\\n\"\n            \"</HTML>\\r\\n\", rfc1123Time().c_str(), FormatFullVersion().c_str());\n    const char *cStatus;\n         if (nStatus == HTTP_OK) cStatus = \"OK\";\n    else if (nStatus == HTTP_BAD_REQUEST) cStatus = \"Bad Request\";\n    else if (nStatus == HTTP_FORBIDDEN) cStatus = \"Forbidden\";\n    else if (nStatus == HTTP_NOT_FOUND) cStatus = \"Not Found\";\n    else if (nStatus == HTTP_INTERNAL_SERVER_ERROR) cStatus = \"Internal Server Error\";\n    else cStatus = \"\";\n    return strprintf(\n            \"HTTP/1.1 %d %s\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Connection: %s\\r\\n\"\n            \"Content-Length: %\"PRIszu\"\\r\\n\"\n            \"Content-Type: application/json\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"\\r\\n\"\n            \"%s\",\n        nStatus,\n        cStatus,\n        rfc1123Time().c_str(),\n        keepalive ? \"keep-alive\" : \"close\",\n        strMsg.size(),\n        FormatFullVersion().c_str(),\n        strMsg.c_str());\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic string HTTPReply(int nStatus, const string& strMsg, bool keepalive)\n{\n    if (nStatus == HTTP_UNAUTHORIZED)\n        return strprintf(\"HTTP/1.0 401 Authorization Required\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"WWW-Authenticate: Basic realm=\\\"jsonrpc\\\"\\r\\n\"\n            \"Content-Type: text/html\\r\\n\"\n            \"Content-Length: 296\\r\\n\"\n            \"\\r\\n\"\n            \"<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\"\\r\\n\"\n            \"\\\"http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd\\\">\\r\\n\"\n            \"<HTML>\\r\\n\"\n            \"<HEAD>\\r\\n\"\n            \"<TITLE>Error</TITLE>\\r\\n\"\n            \"<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=ISO-8859-1'>\\r\\n\"\n            \"</HEAD>\\r\\n\"\n            \"<BODY><H1>401 Unauthorized.</H1></BODY>\\r\\n\"\n            \"</HTML>\\r\\n\", rfc1123Time().c_str(), FormatFullVersion().c_str());\n    const char *cStatus;\n         if (nStatus == HTTP_OK) cStatus = \"OK\";\n    else if (nStatus == HTTP_BAD_REQUEST) cStatus = \"Bad Request\";\n    else if (nStatus == HTTP_FORBIDDEN) cStatus = \"Forbidden\";\n    else if (nStatus == HTTP_NOT_FOUND) cStatus = \"Not Found\";\n    else if (nStatus == HTTP_INTERNAL_SERVER_ERROR) cStatus = \"Internal Server Error\";\n    else cStatus = \"\";\n    return strprintf(\n            \"HTTP/1.1 %d %s\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Connection: %s\\r\\n\"\n            \"Content-Length: %\"PRIszu\"\\r\\n\"\n            \"Content-Type: application/json\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"\\r\\n\"\n            \"%s\",\n        nStatus,\n        cStatus,\n        rfc1123Time().c_str(),\n        keepalive ? \"keep-alive\" : \"close\",\n        strMsg.size(),\n        FormatFullVersion().c_str(),\n        strMsg.c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "conn->stream",
          "args": [],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "JSONRPCExecBatch",
          "args": [
            "valRequest.get_array()"
          ],
          "line": 1086
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCExecBatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "1004-1011",
          "snippet": "static string JSONRPCExecBatch(const Array& vReq)\n{\n    Array ret;\n    for (unsigned int reqIdx = 0; reqIdx < vReq.size(); reqIdx++)\n        ret.push_back(JSONRPCExecOne(vReq[reqIdx]));\n\n    return write_string(Value(ret), false) + \"\\n\";\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic string JSONRPCExecBatch(const Array& vReq)\n{\n    Array ret;\n    for (unsigned int reqIdx = 0; reqIdx < vReq.size(); reqIdx++)\n        ret.push_back(JSONRPCExecOne(vReq[reqIdx]));\n\n    return write_string(Value(ret), false) + \"\\n\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "valRequest.get_array",
          "args": [],
          "line": 1086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "valRequest.type",
          "args": [],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "JSONRPCReply",
          "args": [
            "result",
            "Value::null",
            "jreq.id"
          ],
          "line": 1082
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCReply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "534-538",
          "snippet": "string JSONRPCReply(const Value& result, const Value& error, const Value& id)\n{\n    Object reply = JSONRPCReplyObj(result, error, id);\n    return write_string(Value(reply), false) + \"\\n\";\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstring JSONRPCReply(const Value& result, const Value& error, const Value& id)\n{\n    Object reply = JSONRPCReplyObj(result, error, id);\n    return write_string(Value(reply), false) + \"\\n\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "tableRPC.execute",
          "args": [
            "jreq.strMethod",
            "jreq.params"
          ],
          "line": 1079
        },
        "resolved": true,
        "details": {
          "function_name": "execute",
          "container": "CRPCTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "1111-1142",
          "snippet": "json_spirit::Value CRPCTable::execute(const std::string &strMethod, const json_spirit::Array &params) const\n{\n    // Find method\n    const CRPCCommand *pcmd = tableRPC[strMethod];\n    if (!pcmd)\n        throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n\n    // Observe safe mode\n    string strWarning = GetWarnings(\"rpc\");\n    if (strWarning != \"\" && !GetBoolArg(\"-disablesafemode\") &&\n        !pcmd->okSafeMode)\n        throw JSONRPCError(RPC_FORBIDDEN_BY_SAFE_MODE, string(\"Safe mode: \") + strWarning);\n\n    try\n    {\n        // Execute\n        Value result;\n        {\n            if (pcmd->unlocked)\n                result = pcmd->actor(params, false);\n            else {\n                LOCK2(cs_main, pwalletMain->cs_wallet);\n                result = pcmd->actor(params, false);\n            }\n        }\n        return result;\n    }\n    catch (std::exception& e)\n    {\n        throw JSONRPCError(RPC_MISC_ERROR, e.what());\n    }\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nCRPCTable {\n  json_spirit::Value CRPCTable::execute(const std::string &strMethod, const json_spirit::Array &params) const\n  {\n      // Find method\n      const CRPCCommand *pcmd = tableRPC[strMethod];\n      if (!pcmd)\n          throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n  \n      // Observe safe mode\n      string strWarning = GetWarnings(\"rpc\");\n      if (strWarning != \"\" && !GetBoolArg(\"-disablesafemode\") &&\n          !pcmd->okSafeMode)\n          throw JSONRPCError(RPC_FORBIDDEN_BY_SAFE_MODE, string(\"Safe mode: \") + strWarning);\n  \n      try\n      {\n          // Execute\n          Value result;\n          {\n              if (pcmd->unlocked)\n                  result = pcmd->actor(params, false);\n              else {\n                  LOCK2(cs_main, pwalletMain->cs_wallet);\n                  result = pcmd->actor(params, false);\n              }\n          }\n          return result;\n      }\n      catch (std::exception& e)\n      {\n          throw JSONRPCError(RPC_MISC_ERROR, e.what());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "jreq.parse",
          "args": [
            "valRequest"
          ],
          "line": 1077
        },
        "resolved": true,
        "details": {
          "function_name": "parse",
          "container": "JSONRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "950-978",
          "snippet": "void JSONRequest::parse(const Value& valRequest)\n{\n    // Parse request\n    if (valRequest.type() != obj_type)\n        throw JSONRPCError(RPC_INVALID_REQUEST, \"Invalid Request object\");\n    const Object& request = valRequest.get_obj();\n\n    // Parse id now so errors from here on will have the id\n    id = find_value(request, \"id\");\n\n    // Parse method\n    Value valMethod = find_value(request, \"method\");\n    if (valMethod.type() == null_type)\n        throw JSONRPCError(RPC_INVALID_REQUEST, \"Missing method\");\n    if (valMethod.type() != str_type)\n        throw JSONRPCError(RPC_INVALID_REQUEST, \"Method must be a string\");\n    strMethod = valMethod.get_str();\n    if (strMethod != \"getwork\" && strMethod != \"getblocktemplate\")\n        printf(\"ThreadRPCServer method=%s\\n\", strMethod.c_str());\n\n    // Parse params\n    Value valParams = find_value(request, \"params\");\n    if (valParams.type() == array_type)\n        params = valParams.get_array();\n    else if (valParams.type() == null_type)\n        params = Array();\n    else\n        throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array\");\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [
            "#define printf OutputDebugStringF"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\n#define printf OutputDebugStringF\n\nJSONRequest {\n  void JSONRequest::parse(const Value& valRequest)\n  {\n      // Parse request\n      if (valRequest.type() != obj_type)\n          throw JSONRPCError(RPC_INVALID_REQUEST, \"Invalid Request object\");\n      const Object& request = valRequest.get_obj();\n  \n      // Parse id now so errors from here on will have the id\n      id = find_value(request, \"id\");\n  \n      // Parse method\n      Value valMethod = find_value(request, \"method\");\n      if (valMethod.type() == null_type)\n          throw JSONRPCError(RPC_INVALID_REQUEST, \"Missing method\");\n      if (valMethod.type() != str_type)\n          throw JSONRPCError(RPC_INVALID_REQUEST, \"Method must be a string\");\n      strMethod = valMethod.get_str();\n      if (strMethod != \"getwork\" && strMethod != \"getblocktemplate\")\n          printf(\"ThreadRPCServer method=%s\\n\", strMethod.c_str());\n  \n      // Parse params\n      Value valParams = find_value(request, \"params\");\n      if (valParams.type() == array_type)\n          params = valParams.get_array();\n      else if (valParams.type() == null_type)\n          params = Array();\n      else\n          throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array\");\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "read_string",
          "args": [
            "strRequest",
            "valRequest"
          ],
          "line": 1070
        },
        "resolved": true,
        "details": {
          "function_name": "read_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_reader_template.h",
          "lines": "586-591",
          "snippet": "bool read_string( const String_type& s, Value_type& value )\n    {\n        typename String_type::const_iterator begin = s.begin();\n\n        return read_range( begin, s.end(), value );\n    }",
          "includes": [
            "#include <boost/spirit/iterator/position_iterator.hpp>",
            "#include <boost/spirit/iterator/multi_pass.hpp>",
            "#include <boost/spirit/utility/escape_char.hpp>",
            "#include <boost/spirit/utility/confix.hpp>",
            "#include <boost/spirit/core.hpp>",
            "#include <boost/spirit/include/classic_position_iterator.hpp>",
            "#include <boost/spirit/include/classic_multi_pass.hpp>",
            "#include <boost/spirit/include/classic_escape_char.hpp>",
            "#include <boost/spirit/include/classic_confix.hpp>",
            "#include <boost/spirit/include/classic_core.hpp>",
            "#include <boost/version.hpp>",
            "#include <boost/function.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include \"json_spirit_error_position.h\"",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/spirit/iterator/position_iterator.hpp>\n#include <boost/spirit/iterator/multi_pass.hpp>\n#include <boost/spirit/utility/escape_char.hpp>\n#include <boost/spirit/utility/confix.hpp>\n#include <boost/spirit/core.hpp>\n#include <boost/spirit/include/classic_position_iterator.hpp>\n#include <boost/spirit/include/classic_multi_pass.hpp>\n#include <boost/spirit/include/classic_escape_char.hpp>\n#include <boost/spirit/include/classic_confix.hpp>\n#include <boost/spirit/include/classic_core.hpp>\n#include <boost/version.hpp>\n#include <boost/function.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include \"json_spirit_error_position.h\"\n#include \"json_spirit_value.h\"\n\nbool read_string( const String_type& s, Value_type& value )\n    {\n        typename String_type::const_iterator begin = s.begin();\n\n        return read_range( begin, s.end(), value );\n    }"
        }
      },
      {
        "call_info": {
          "callee": "conn->stream",
          "args": [],
          "line": 1059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MilliSleep",
          "args": [
            "250"
          ],
          "line": 1057
        },
        "resolved": true,
        "details": {
          "function_name": "MilliSleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "132-139",
          "snippet": "inline void MilliSleep(int64_t n)\n{\n#if BOOST_VERSION >= 105000\n    boost::this_thread::sleep_for(boost::chrono::milliseconds(n));\n#else\n    boost::this_thread::sleep(boost::posix_time::milliseconds(n));\n#endif\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline void MilliSleep(int64_t n)\n{\n#if BOOST_VERSION >= 105000\n    boost::this_thread::sleep_for(boost::chrono::milliseconds(n));\n#else\n    boost::this_thread::sleep(boost::posix_time::milliseconds(n));\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapArgs[\"-rpcpassword\"].size",
          "args": [],
          "line": 1056
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ThreadRPCServer incorrect password attempt from %s\\n\"",
            "conn->peer_address_to_string().c_str()"
          ],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "conn->peer_address_to_string",
          "args": [],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "peer_address_to_string",
          "container": "AcceptedConnectionImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "659-662",
          "snippet": "virtual std::string peer_address_to_string() const\n    {\n        return peer.address().to_string();\n    }",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nAcceptedConnectionImpl {\n  virtual std::string peer_address_to_string() const\n      {\n          return peer.address().to_string();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "HTTPAuthorized",
          "args": [
            "mapHeaders"
          ],
          "line": 1050
        },
        "resolved": true,
        "details": {
          "function_name": "HTTPAuthorized",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "493-501",
          "snippet": "bool HTTPAuthorized(map<string, string>& mapHeaders)\n{\n    string strAuth = mapHeaders[\"authorization\"];\n    if (strAuth.substr(0,6) != \"Basic \")\n        return false;\n    string strUserPass64 = strAuth.substr(6); boost::trim(strUserPass64);\n    string strUserPass = DecodeBase64(strUserPass64);\n    return TimingResistantEqual(strUserPass, strRPCUserColonPass);\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static std::string strRPCUserColonPass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic std::string strRPCUserColonPass;\n\nbool HTTPAuthorized(map<string, string>& mapHeaders)\n{\n    string strAuth = mapHeaders[\"authorization\"];\n    if (strAuth.substr(0,6) != \"Basic \")\n        return false;\n    string strUserPass64 = strAuth.substr(6); boost::trim(strUserPass64);\n    string strUserPass = DecodeBase64(strUserPass64);\n    return TimingResistantEqual(strUserPass, strRPCUserColonPass);\n}"
        }
      },
      {
        "call_info": {
          "callee": "conn->stream",
          "args": [],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapHeaders.count",
          "args": [
            "\"authorization\""
          ],
          "line": 1045
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ReadHTTP",
          "args": [
            "conn->stream()",
            "mapHeaders",
            "strRequest"
          ],
          "line": 1042
        },
        "resolved": true,
        "details": {
          "function_name": "ReadHTTP",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "458-491",
          "snippet": "int ReadHTTP(std::basic_istream<char>& stream, map<string, string>& mapHeadersRet, string& strMessageRet)\n{\n    mapHeadersRet.clear();\n    strMessageRet = \"\";\n\n    // Read status\n    int nProto = 0;\n    int nStatus = ReadHTTPStatus(stream, nProto);\n\n    // Read header\n    int nLen = ReadHTTPHeader(stream, mapHeadersRet);\n    if (nLen < 0 || nLen > (int)MAX_SIZE)\n        return HTTP_INTERNAL_SERVER_ERROR;\n\n    // Read message\n    if (nLen > 0)\n    {\n        vector<char> vch(nLen);\n        stream.read(&vch[0], nLen);\n        strMessageRet = string(vch.begin(), vch.end());\n    }\n\n    string sConHdr = mapHeadersRet[\"connection\"];\n\n    if ((sConHdr != \"close\") && (sConHdr != \"keep-alive\"))\n    {\n        if (nProto >= 1)\n            mapHeadersRet[\"connection\"] = \"keep-alive\";\n        else\n            mapHeadersRet[\"connection\"] = \"close\";\n    }\n\n    return nStatus;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nint ReadHTTP(std::basic_istream<char>& stream, map<string, string>& mapHeadersRet, string& strMessageRet)\n{\n    mapHeadersRet.clear();\n    strMessageRet = \"\";\n\n    // Read status\n    int nProto = 0;\n    int nStatus = ReadHTTPStatus(stream, nProto);\n\n    // Read header\n    int nLen = ReadHTTPHeader(stream, mapHeadersRet);\n    if (nLen < 0 || nLen > (int)MAX_SIZE)\n        return HTTP_INTERNAL_SERVER_ERROR;\n\n    // Read message\n    if (nLen > 0)\n    {\n        vector<char> vch(nLen);\n        stream.read(&vch[0], nLen);\n        strMessageRet = string(vch.begin(), vch.end());\n    }\n\n    string sConHdr = mapHeadersRet[\"connection\"];\n\n    if ((sConHdr != \"close\") && (sConHdr != \"keep-alive\"))\n    {\n        if (nProto >= 1)\n            mapHeadersRet[\"connection\"] = \"keep-alive\";\n        else\n            mapHeadersRet[\"connection\"] = \"close\";\n    }\n\n    return nStatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "conn->stream",
          "args": [],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs_THREAD_RPCHANDLER"
          ],
          "line": 1034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->close",
          "args": [],
          "line": 1031
        },
        "resolved": true,
        "details": {
          "function_name": "close",
          "container": "AcceptedConnectionImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "664-667",
          "snippet": "virtual void close()\n    {\n        _stream.close();\n    }",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nAcceptedConnectionImpl {\n  virtual void close()\n      {\n          _stream.close();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs_THREAD_RPCHANDLER"
          ],
          "line": 1021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RenameThread",
          "args": [
            "\"hal-rpchand\""
          ],
          "line": 1018
        },
        "resolved": true,
        "details": {
          "function_name": "RenameThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1329-1348",
          "snippet": "void RenameThread(const char* name)\n{\n#if defined(PR_SET_NAME)\n    // Only the first 15 characters are used (16 - NUL terminator)\n    ::prctl(PR_SET_NAME, name, 0, 0, 0);\n#elif 0 && (defined(__FreeBSD__) || defined(__OpenBSD__))\n    // TODO: This is currently disabled because it needs to be verified to work\n    //       on FreeBSD or OpenBSD first. When verified the '0 &&' part can be\n    //       removed.\n    pthread_set_name_np(pthread_self(), name);\n\n// This is XCode 10.6-and-later; bring back if we drop 10.5 support:\n// #elif defined(MAC_OSX)\n//    pthread_setname_np(name);\n\n#else\n    // Prevent warnings for unused parameters...\n    (void)name;\n#endif\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvoid RenameThread(const char* name)\n{\n#if defined(PR_SET_NAME)\n    // Only the first 15 characters are used (16 - NUL terminator)\n    ::prctl(PR_SET_NAME, name, 0, 0, 0);\n#elif 0 && (defined(__FreeBSD__) || defined(__OpenBSD__))\n    // TODO: This is currently disabled because it needs to be verified to work\n    //       on FreeBSD or OpenBSD first. When verified the '0 &&' part can be\n    //       removed.\n    pthread_set_name_np(pthread_self(), name);\n\n// This is XCode 10.6-and-later; bring back if we drop 10.5 support:\n// #elif defined(MAC_OSX)\n//    pthread_setname_np(name);\n\n#else\n    // Prevent warnings for unused parameters...\n    (void)name;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\n#define printf OutputDebugStringF\n\nvoid ThreadRPCServer2(void* parg);\nvoid ThreadRPCServer3(void* parg);\n\nvoid ThreadRPCServer3(void* parg)\n{\n    // Make this thread recognisable as the RPC handler\n    RenameThread(\"hal-rpchand\");\n\n    {\n        LOCK(cs_THREAD_RPCHANDLER);\n        vnThreadsRunning[THREAD_RPCHANDLER]++;\n    }\n    AcceptedConnection *conn = (AcceptedConnection *) parg;\n\n    bool fRun = true;\n    while (true)\n    {\n        if (fShutdown || !fRun)\n        {\n            conn->close();\n            delete conn;\n            {\n                LOCK(cs_THREAD_RPCHANDLER);\n                --vnThreadsRunning[THREAD_RPCHANDLER];\n            }\n            return;\n        }\n        map<string, string> mapHeaders;\n        string strRequest;\n\n        ReadHTTP(conn->stream(), mapHeaders, strRequest);\n\n        // Check authorization\n        if (mapHeaders.count(\"authorization\") == 0)\n        {\n            conn->stream() << HTTPReply(HTTP_UNAUTHORIZED, \"\", false) << std::flush;\n            break;\n        }\n        if (!HTTPAuthorized(mapHeaders))\n        {\n            printf(\"ThreadRPCServer incorrect password attempt from %s\\n\", conn->peer_address_to_string().c_str());\n            /* Deter brute-forcing short passwords.\n               If this results in a DOS the user really\n               shouldn't have their RPC port exposed.*/\n            if (mapArgs[\"-rpcpassword\"].size() < 20)\n                MilliSleep(250);\n\n            conn->stream() << HTTPReply(HTTP_UNAUTHORIZED, \"\", false) << std::flush;\n            break;\n        }\n        if (mapHeaders[\"connection\"] == \"close\")\n            fRun = false;\n\n        JSONRequest jreq;\n        try\n        {\n            // Parse request\n            Value valRequest;\n            if (!read_string(strRequest, valRequest))\n                throw JSONRPCError(RPC_PARSE_ERROR, \"Parse error\");\n\n            string strReply;\n\n            // singleton request\n            if (valRequest.type() == obj_type) {\n                jreq.parse(valRequest);\n\n                Value result = tableRPC.execute(jreq.strMethod, jreq.params);\n\n                // Send reply\n                strReply = JSONRPCReply(result, Value::null, jreq.id);\n\n            // array of requests\n            } else if (valRequest.type() == array_type)\n                strReply = JSONRPCExecBatch(valRequest.get_array());\n            else\n                throw JSONRPCError(RPC_PARSE_ERROR, \"Top-level object parse error\");\n\n            conn->stream() << HTTPReply(HTTP_OK, strReply, fRun) << std::flush;\n        }\n        catch (Object& objError)\n        {\n            ErrorReply(conn->stream(), objError, jreq.id);\n            break;\n        }\n        catch (std::exception& e)\n        {\n            ErrorReply(conn->stream(), JSONRPCError(RPC_PARSE_ERROR, e.what()), jreq.id);\n            break;\n        }\n    }\n\n    delete conn;\n    {\n        LOCK(cs_THREAD_RPCHANDLER);\n        vnThreadsRunning[THREAD_RPCHANDLER]--;\n    }\n}"
  },
  {
    "function_name": "JSONRPCExecBatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "1004-1011",
    "snippet": "static string JSONRPCExecBatch(const Array& vReq)\n{\n    Array ret;\n    for (unsigned int reqIdx = 0; reqIdx < vReq.size(); reqIdx++)\n        ret.push_back(JSONRPCExecOne(vReq[reqIdx]));\n\n    return write_string(Value(ret), false) + \"\\n\";\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_string",
          "args": [
            "Value(ret)",
            "false"
          ],
          "line": 1010
        },
        "resolved": true,
        "details": {
          "function_name": "write_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "234-243",
          "snippet": "typename Value_type::String_type write_string( const Value_type& value, bool pretty )\n    {\n        typedef typename Value_type::String_type::value_type Char_type;\n\n        std::basic_ostringstream< Char_type > os;\n\n        write_stream( value, os, pretty );\n\n        return os.str();\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\ntypename Value_type::String_type write_string( const Value_type& value, bool pretty )\n    {\n        typedef typename Value_type::String_type::value_type Char_type;\n\n        std::basic_ostringstream< Char_type > os;\n\n        write_stream( value, os, pretty );\n\n        return os.str();\n    }"
        }
      },
      {
        "call_info": {
          "callee": "Value",
          "args": [
            "ret"
          ],
          "line": 1010
        },
        "resolved": true,
        "details": {
          "function_name": "ValueFromAmount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "113-116",
          "snippet": "Value ValueFromAmount(int64_t amount)\n{\n    return (double)amount / (double)COIN;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nValue ValueFromAmount(int64_t amount)\n{\n    return (double)amount / (double)COIN;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ret.push_back",
          "args": [
            "JSONRPCExecOne(vReq[reqIdx])"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "JSONRPCExecOne",
          "args": [
            "vReq[reqIdx]"
          ],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCExecOne",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "980-1002",
          "snippet": "static Object JSONRPCExecOne(const Value& req)\n{\n    Object rpc_result;\n\n    JSONRequest jreq;\n    try {\n        jreq.parse(req);\n\n        Value result = tableRPC.execute(jreq.strMethod, jreq.params);\n        rpc_result = JSONRPCReplyObj(result, Value::null, jreq.id);\n    }\n    catch (Object& objError)\n    {\n        rpc_result = JSONRPCReplyObj(Value::null, objError, jreq.id);\n    }\n    catch (std::exception& e)\n    {\n        rpc_result = JSONRPCReplyObj(Value::null,\n                                     JSONRPCError(RPC_PARSE_ERROR, e.what()), jreq.id);\n    }\n\n    return rpc_result;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic Object JSONRPCExecOne(const Value& req)\n{\n    Object rpc_result;\n\n    JSONRequest jreq;\n    try {\n        jreq.parse(req);\n\n        Value result = tableRPC.execute(jreq.strMethod, jreq.params);\n        rpc_result = JSONRPCReplyObj(result, Value::null, jreq.id);\n    }\n    catch (Object& objError)\n    {\n        rpc_result = JSONRPCReplyObj(Value::null, objError, jreq.id);\n    }\n    catch (std::exception& e)\n    {\n        rpc_result = JSONRPCReplyObj(Value::null,\n                                     JSONRPCError(RPC_PARSE_ERROR, e.what()), jreq.id);\n    }\n\n    return rpc_result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vReq.size",
          "args": [],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic string JSONRPCExecBatch(const Array& vReq)\n{\n    Array ret;\n    for (unsigned int reqIdx = 0; reqIdx < vReq.size(); reqIdx++)\n        ret.push_back(JSONRPCExecOne(vReq[reqIdx]));\n\n    return write_string(Value(ret), false) + \"\\n\";\n}"
  },
  {
    "function_name": "JSONRPCExecOne",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "980-1002",
    "snippet": "static Object JSONRPCExecOne(const Value& req)\n{\n    Object rpc_result;\n\n    JSONRequest jreq;\n    try {\n        jreq.parse(req);\n\n        Value result = tableRPC.execute(jreq.strMethod, jreq.params);\n        rpc_result = JSONRPCReplyObj(result, Value::null, jreq.id);\n    }\n    catch (Object& objError)\n    {\n        rpc_result = JSONRPCReplyObj(Value::null, objError, jreq.id);\n    }\n    catch (std::exception& e)\n    {\n        rpc_result = JSONRPCReplyObj(Value::null,\n                                     JSONRPCError(RPC_PARSE_ERROR, e.what()), jreq.id);\n    }\n\n    return rpc_result;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "JSONRPCReplyObj",
          "args": [
            "Value::null",
            "JSONRPCError(RPC_PARSE_ERROR, e.what())",
            "jreq.id"
          ],
          "line": 997
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCReplyObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "522-532",
          "snippet": "Object JSONRPCReplyObj(const Value& result, const Value& error, const Value& id)\n{\n    Object reply;\n    if (error.type() != null_type)\n        reply.push_back(Pair(\"result\", Value::null));\n    else\n        reply.push_back(Pair(\"result\", result));\n    reply.push_back(Pair(\"error\", error));\n    reply.push_back(Pair(\"id\", id));\n    return reply;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject JSONRPCReplyObj(const Value& result, const Value& error, const Value& id)\n{\n    Object reply;\n    if (error.type() != null_type)\n        reply.push_back(Pair(\"result\", Value::null));\n    else\n        reply.push_back(Pair(\"result\", result));\n    reply.push_back(Pair(\"error\", error));\n    reply.push_back(Pair(\"id\", id));\n    return reply;\n}"
        }
      },
      {
        "call_info": {
          "callee": "JSONRPCError",
          "args": [
            "RPC_PARSE_ERROR",
            "e.what()"
          ],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "54-60",
          "snippet": "Object JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tableRPC.execute",
          "args": [
            "jreq.strMethod",
            "jreq.params"
          ],
          "line": 988
        },
        "resolved": true,
        "details": {
          "function_name": "execute",
          "container": "CRPCTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "1111-1142",
          "snippet": "json_spirit::Value CRPCTable::execute(const std::string &strMethod, const json_spirit::Array &params) const\n{\n    // Find method\n    const CRPCCommand *pcmd = tableRPC[strMethod];\n    if (!pcmd)\n        throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n\n    // Observe safe mode\n    string strWarning = GetWarnings(\"rpc\");\n    if (strWarning != \"\" && !GetBoolArg(\"-disablesafemode\") &&\n        !pcmd->okSafeMode)\n        throw JSONRPCError(RPC_FORBIDDEN_BY_SAFE_MODE, string(\"Safe mode: \") + strWarning);\n\n    try\n    {\n        // Execute\n        Value result;\n        {\n            if (pcmd->unlocked)\n                result = pcmd->actor(params, false);\n            else {\n                LOCK2(cs_main, pwalletMain->cs_wallet);\n                result = pcmd->actor(params, false);\n            }\n        }\n        return result;\n    }\n    catch (std::exception& e)\n    {\n        throw JSONRPCError(RPC_MISC_ERROR, e.what());\n    }\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nCRPCTable {\n  json_spirit::Value CRPCTable::execute(const std::string &strMethod, const json_spirit::Array &params) const\n  {\n      // Find method\n      const CRPCCommand *pcmd = tableRPC[strMethod];\n      if (!pcmd)\n          throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n  \n      // Observe safe mode\n      string strWarning = GetWarnings(\"rpc\");\n      if (strWarning != \"\" && !GetBoolArg(\"-disablesafemode\") &&\n          !pcmd->okSafeMode)\n          throw JSONRPCError(RPC_FORBIDDEN_BY_SAFE_MODE, string(\"Safe mode: \") + strWarning);\n  \n      try\n      {\n          // Execute\n          Value result;\n          {\n              if (pcmd->unlocked)\n                  result = pcmd->actor(params, false);\n              else {\n                  LOCK2(cs_main, pwalletMain->cs_wallet);\n                  result = pcmd->actor(params, false);\n              }\n          }\n          return result;\n      }\n      catch (std::exception& e)\n      {\n          throw JSONRPCError(RPC_MISC_ERROR, e.what());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "jreq.parse",
          "args": [
            "req"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "parse",
          "container": "JSONRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "950-978",
          "snippet": "void JSONRequest::parse(const Value& valRequest)\n{\n    // Parse request\n    if (valRequest.type() != obj_type)\n        throw JSONRPCError(RPC_INVALID_REQUEST, \"Invalid Request object\");\n    const Object& request = valRequest.get_obj();\n\n    // Parse id now so errors from here on will have the id\n    id = find_value(request, \"id\");\n\n    // Parse method\n    Value valMethod = find_value(request, \"method\");\n    if (valMethod.type() == null_type)\n        throw JSONRPCError(RPC_INVALID_REQUEST, \"Missing method\");\n    if (valMethod.type() != str_type)\n        throw JSONRPCError(RPC_INVALID_REQUEST, \"Method must be a string\");\n    strMethod = valMethod.get_str();\n    if (strMethod != \"getwork\" && strMethod != \"getblocktemplate\")\n        printf(\"ThreadRPCServer method=%s\\n\", strMethod.c_str());\n\n    // Parse params\n    Value valParams = find_value(request, \"params\");\n    if (valParams.type() == array_type)\n        params = valParams.get_array();\n    else if (valParams.type() == null_type)\n        params = Array();\n    else\n        throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array\");\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [
            "#define printf OutputDebugStringF"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\n#define printf OutputDebugStringF\n\nJSONRequest {\n  void JSONRequest::parse(const Value& valRequest)\n  {\n      // Parse request\n      if (valRequest.type() != obj_type)\n          throw JSONRPCError(RPC_INVALID_REQUEST, \"Invalid Request object\");\n      const Object& request = valRequest.get_obj();\n  \n      // Parse id now so errors from here on will have the id\n      id = find_value(request, \"id\");\n  \n      // Parse method\n      Value valMethod = find_value(request, \"method\");\n      if (valMethod.type() == null_type)\n          throw JSONRPCError(RPC_INVALID_REQUEST, \"Missing method\");\n      if (valMethod.type() != str_type)\n          throw JSONRPCError(RPC_INVALID_REQUEST, \"Method must be a string\");\n      strMethod = valMethod.get_str();\n      if (strMethod != \"getwork\" && strMethod != \"getblocktemplate\")\n          printf(\"ThreadRPCServer method=%s\\n\", strMethod.c_str());\n  \n      // Parse params\n      Value valParams = find_value(request, \"params\");\n      if (valParams.type() == array_type)\n          params = valParams.get_array();\n      else if (valParams.type() == null_type)\n          params = Array();\n      else\n          throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array\");\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic Object JSONRPCExecOne(const Value& req)\n{\n    Object rpc_result;\n\n    JSONRequest jreq;\n    try {\n        jreq.parse(req);\n\n        Value result = tableRPC.execute(jreq.strMethod, jreq.params);\n        rpc_result = JSONRPCReplyObj(result, Value::null, jreq.id);\n    }\n    catch (Object& objError)\n    {\n        rpc_result = JSONRPCReplyObj(Value::null, objError, jreq.id);\n    }\n    catch (std::exception& e)\n    {\n        rpc_result = JSONRPCReplyObj(Value::null,\n                                     JSONRPCError(RPC_PARSE_ERROR, e.what()), jreq.id);\n    }\n\n    return rpc_result;\n}"
  },
  {
    "function_name": "parse",
    "container": "JSONRequest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "950-978",
    "snippet": "void JSONRequest::parse(const Value& valRequest)\n{\n    // Parse request\n    if (valRequest.type() != obj_type)\n        throw JSONRPCError(RPC_INVALID_REQUEST, \"Invalid Request object\");\n    const Object& request = valRequest.get_obj();\n\n    // Parse id now so errors from here on will have the id\n    id = find_value(request, \"id\");\n\n    // Parse method\n    Value valMethod = find_value(request, \"method\");\n    if (valMethod.type() == null_type)\n        throw JSONRPCError(RPC_INVALID_REQUEST, \"Missing method\");\n    if (valMethod.type() != str_type)\n        throw JSONRPCError(RPC_INVALID_REQUEST, \"Method must be a string\");\n    strMethod = valMethod.get_str();\n    if (strMethod != \"getwork\" && strMethod != \"getblocktemplate\")\n        printf(\"ThreadRPCServer method=%s\\n\", strMethod.c_str());\n\n    // Parse params\n    Value valParams = find_value(request, \"params\");\n    if (valParams.type() == array_type)\n        params = valParams.get_array();\n    else if (valParams.type() == null_type)\n        params = Array();\n    else\n        throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array\");\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [
      "#define printf OutputDebugStringF"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "JSONRPCError",
          "args": [
            "RPC_INVALID_REQUEST",
            "\"Params must be an array\""
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "54-60",
          "snippet": "Object JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Array",
          "args": [],
          "line": 975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "valParams.type",
          "args": [],
          "line": 974
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "valParams.get_array",
          "args": [],
          "line": 973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [
            "request",
            "\"params\""
          ],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ThreadRPCServer method=%s\\n\"",
            "strMethod.c_str()"
          ],
          "line": 968
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strMethod.c_str",
          "args": [],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "valMethod.get_str",
          "args": [],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [
            "request",
            "\"method\""
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [
            "request",
            "\"id\""
          ],
          "line": 958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "valRequest.get_obj",
          "args": [],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\n#define printf OutputDebugStringF\n\nJSONRequest {\n  void JSONRequest::parse(const Value& valRequest)\n  {\n      // Parse request\n      if (valRequest.type() != obj_type)\n          throw JSONRPCError(RPC_INVALID_REQUEST, \"Invalid Request object\");\n      const Object& request = valRequest.get_obj();\n  \n      // Parse id now so errors from here on will have the id\n      id = find_value(request, \"id\");\n  \n      // Parse method\n      Value valMethod = find_value(request, \"method\");\n      if (valMethod.type() == null_type)\n          throw JSONRPCError(RPC_INVALID_REQUEST, \"Missing method\");\n      if (valMethod.type() != str_type)\n          throw JSONRPCError(RPC_INVALID_REQUEST, \"Method must be a string\");\n      strMethod = valMethod.get_str();\n      if (strMethod != \"getwork\" && strMethod != \"getblocktemplate\")\n          printf(\"ThreadRPCServer method=%s\\n\", strMethod.c_str());\n  \n      // Parse params\n      Value valParams = find_value(request, \"params\");\n      if (valParams.type() == array_type)\n          params = valParams.get_array();\n      else if (valParams.type() == null_type)\n          params = Array();\n      else\n          throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array\");\n  }\n}"
  },
  {
    "function_name": "JSONRequest",
    "container": "JSONRequest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "946-946",
    "snippet": "JSONRequest() { id = Value::null; }",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nJSONRequest {\n  JSONRequest() { id = Value::null; }\n}"
  },
  {
    "function_name": "ThreadRPCServer2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "798-937",
    "snippet": "void ThreadRPCServer2(void* parg)\n{\n    printf(\"ThreadRPCServer started\\n\");\n\n    strRPCUserColonPass = mapArgs[\"-rpcuser\"] + \":\" + mapArgs[\"-rpcpassword\"];\n    if ((mapArgs[\"-rpcpassword\"] == \"\") ||\n        (mapArgs[\"-rpcuser\"] == mapArgs[\"-rpcpassword\"]))\n    {\n        unsigned char rand_pwd[32];\n        RAND_bytes(rand_pwd, 32);\n        string strWhatAmI = \"To use halcyond\";\n        if (mapArgs.count(\"-server\"))\n            strWhatAmI = strprintf(_(\"To use the %s option\"), \"\\\"-server\\\"\");\n        else if (mapArgs.count(\"-daemon\"))\n            strWhatAmI = strprintf(_(\"To use the %s option\"), \"\\\"-daemon\\\"\");\n        uiInterface.ThreadSafeMessageBox(strprintf(\n            _(\"%s, you must set a rpcpassword in the configuration file:\\n %s\\n\"\n              \"It is recommended you use the following random password:\\n\"\n              \"rpcuser=halcyonrpc\\n\"\n              \"rpcpassword=%s\\n\"\n              \"(you do not need to remember this password)\\n\"\n              \"The username and password MUST NOT be the same.\\n\"\n              \"If the file does not exist, create it with owner-readable-only file permissions.\\n\"\n              \"It is also recommended to set alertnotify so you are notified of problems;\\n\"\n              \"for example: alertnotify=echo %%s | mail -s \\\"Halcyon Alert\\\" admin@foo.com\\n\"),\n                strWhatAmI.c_str(),\n                GetConfigFile().string().c_str(),\n                EncodeBase58(&rand_pwd[0],&rand_pwd[0]+32).c_str()),\n            _(\"Error\"), CClientUIInterface::OK | CClientUIInterface::MODAL);\n        StartShutdown();\n        return;\n    }\n\n    const bool fUseSSL = GetBoolArg(\"-rpcssl\");\n\n    asio::io_service io_service;\n\n#if (BOOST_VERSION > 106501)\n    ssl::context context(ssl::context::sslv23);\n#else\n    ssl::context context(io_service, ssl::context::sslv23);\n#endif\n\n    if (fUseSSL)\n    {\n        context.set_options(ssl::context::no_sslv2);\n\n        filesystem::path pathCertFile(GetArg(\"-rpcsslcertificatechainfile\", \"server.cert\"));\n        if (!pathCertFile.is_complete()) pathCertFile = filesystem::path(GetDataDir()) / pathCertFile;\n        if (filesystem::exists(pathCertFile)) context.use_certificate_chain_file(pathCertFile.string());\n        else printf(\"ThreadRPCServer ERROR: missing server certificate file %s\\n\", pathCertFile.string().c_str());\n\n        filesystem::path pathPKFile(GetArg(\"-rpcsslprivatekeyfile\", \"server.pem\"));\n        if (!pathPKFile.is_complete()) pathPKFile = filesystem::path(GetDataDir()) / pathPKFile;\n        if (filesystem::exists(pathPKFile)) context.use_private_key_file(pathPKFile.string(), ssl::context::pem);\n        else printf(\"ThreadRPCServer ERROR: missing server private key file %s\\n\", pathPKFile.string().c_str());\n\n        string strCiphers = GetArg(\"-rpcsslciphers\", \"TLSv1+HIGH:!SSLv2:!aNULL:!eNULL:!AH:!3DES:@STRENGTH\");\n\n#if (BOOST_VERSION > 106501)\n        SSL_CTX_set_cipher_list(context.native_handle(), strCiphers.c_str());\n#else\n        SSL_CTX_set_cipher_list(context.impl(), strCiphers.c_str());\n#endif\n    }\n\n    // Try a dual IPv6/IPv4 socket, falling back to separate IPv4 and IPv6 sockets\n    const bool loopback = !mapArgs.count(\"-rpcallowip\");\n    asio::ip::address bindAddress = loopback ? asio::ip::address_v6::loopback() : asio::ip::address_v6::any();\n    ip::tcp::endpoint endpoint(bindAddress, GetArg(\"-rpcport\", GetDefaultRPCPort()));\n    boost::system::error_code v6_only_error;\n    boost::shared_ptr<ip::tcp::acceptor> acceptor(new ip::tcp::acceptor(io_service));\n\n    boost::signals2::signal<void ()> StopRequests;\n\n    bool fListening = false;\n    std::string strerr;\n    try\n    {\n        acceptor->open(endpoint.protocol());\n        acceptor->set_option(boost::asio::ip::tcp::acceptor::reuse_address(true));\n\n        // Try making the socket dual IPv6/IPv4 (if listening on the \"any\" address)\n        acceptor->set_option(boost::asio::ip::v6_only(loopback), v6_only_error);\n\n        acceptor->bind(endpoint);\n        acceptor->listen(socket_base::max_connections);\n\n        RPCListen(acceptor, context, fUseSSL);\n        // Cancel outstanding listen-requests for this acceptor when shutting down\n        StopRequests.connect(signals2::slot<void ()>(\n                    static_cast<void (ip::tcp::acceptor::*)()>(&ip::tcp::acceptor::close), acceptor.get())\n                .track(acceptor));\n\n        fListening = true;\n    }\n    catch(boost::system::system_error &e)\n    {\n        strerr = strprintf(_(\"An error occurred while setting up the RPC port %u for listening on IPv6, falling back to IPv4: %s\"), endpoint.port(), e.what());\n    }\n\n    try {\n        // If dual IPv6/IPv4 failed (or we're opening loopback interfaces only), open IPv4 separately\n        if (!fListening || loopback || v6_only_error)\n        {\n            bindAddress = loopback ? asio::ip::address_v4::loopback() : asio::ip::address_v4::any();\n            endpoint.address(bindAddress);\n\n            acceptor.reset(new ip::tcp::acceptor(io_service));\n            acceptor->open(endpoint.protocol());\n            acceptor->set_option(boost::asio::ip::tcp::acceptor::reuse_address(true));\n            acceptor->bind(endpoint);\n            acceptor->listen(socket_base::max_connections);\n\n            RPCListen(acceptor, context, fUseSSL);\n            // Cancel outstanding listen-requests for this acceptor when shutting down\n            StopRequests.connect(signals2::slot<void ()>(\n                        static_cast<void (ip::tcp::acceptor::*)()>(&ip::tcp::acceptor::close), acceptor.get())\n                    .track(acceptor));\n\n            fListening = true;\n        }\n    }\n    catch(boost::system::system_error &e)\n    {\n        strerr = strprintf(_(\"An error occurred while setting up the RPC port %u for listening on IPv4: %s\"), endpoint.port(), e.what());\n    }\n\n    if (!fListening) {\n        uiInterface.ThreadSafeMessageBox(strerr, _(\"Error\"), CClientUIInterface::OK | CClientUIInterface::MODAL);\n        StartShutdown();\n        return;\n    }\n\n    vnThreadsRunning[THREAD_RPCLISTENER]--;\n    while (!fShutdown)\n        io_service.run_one();\n    vnThreadsRunning[THREAD_RPCLISTENER]++;\n    StopRequests();\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [
      "#define printf OutputDebugStringF"
    ],
    "globals_used": [
      "void ThreadRPCServer2(void* parg);",
      "static std::string strRPCUserColonPass;",
      "void ThreadRPCServer3(void* parg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "StopRequests",
          "args": [],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "io_service.run_one",
          "args": [],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StartShutdown",
          "args": [],
          "line": 928
        },
        "resolved": true,
        "details": {
          "function_name": "StartShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/init.cpp",
          "lines": "52-61",
          "snippet": "void StartShutdown()\n{\n#ifdef QT_GUI\n    // ensure we leave the Qt main loop for a clean GUI exit (Shutdown() is called in bitcoin.cpp afterwards)\n    uiInterface.QueueShutdown();\n#else\n    // Without UI, Shutdown() can simply be started in a new thread\n    NewThread(Shutdown, NULL);\n#endif\n}",
          "includes": [
            "#include <signal.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/algorithm/string/predicate.hpp>",
            "#include <boost/interprocess/sync/file_lock.hpp>",
            "#include <boost/filesystem/convenience.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"checkpoints.h\"",
            "#include \"ui_interface.h\"",
            "#include \"util.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"walletdb.h\"",
            "#include \"txdb.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "CClientUIInterface uiInterface;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <signal.h>\n#include <openssl/crypto.h>\n#include <boost/algorithm/string/predicate.hpp>\n#include <boost/interprocess/sync/file_lock.hpp>\n#include <boost/filesystem/convenience.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"checkpoints.h\"\n#include \"ui_interface.h\"\n#include \"util.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"bitcoinrpc.h\"\n#include \"walletdb.h\"\n#include \"txdb.h\"\n\nCClientUIInterface uiInterface;\n\nvoid StartShutdown()\n{\n#ifdef QT_GUI\n    // ensure we leave the Qt main loop for a clean GUI exit (Shutdown() is called in bitcoin.cpp afterwards)\n    uiInterface.QueueShutdown();\n#else\n    // Without UI, Shutdown() can simply be started in a new thread\n    NewThread(Shutdown, NULL);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "uiInterface.ThreadSafeMessageBox",
          "args": [
            "strerr",
            "_(\"Error\")",
            "CClientUIInterface::OK | CClientUIInterface::MODAL"
          ],
          "line": 927
        },
        "resolved": true,
        "details": {
          "function_name": "ThreadSafeMessageBox",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoin.cpp",
          "lines": "38-56",
          "snippet": "static void ThreadSafeMessageBox(const std::string& message, const std::string& caption, int style)\n{\n    // Message from network thread\n    if(guiref)\n    {\n        bool modal = (style & CClientUIInterface::MODAL);\n        // in case of modal message, use blocking connection to wait for user to click OK\n        QMetaObject::invokeMethod(guiref, \"error\",\n                                   modal ? GUIUtil::blockingGUIThreadConnection() : Qt::QueuedConnection,\n                                   Q_ARG(QString, QString::fromStdString(caption)),\n                                   Q_ARG(QString, QString::fromStdString(message)),\n                                   Q_ARG(bool, modal));\n    }\n    else\n    {\n        printf(\"%s: %s\\n\", caption.c_str(), message.c_str());\n        fprintf(stderr, \"%s: %s\\n\", caption.c_str(), message.c_str());\n    }\n}",
          "includes": [
            "#include <QtPlugin>",
            "#include <QLibraryInfo>",
            "#include <QSplashScreen>",
            "#include <QTranslator>",
            "#include <QLocale>",
            "#include <QTextCodec>",
            "#include <QMessageBox>",
            "#include <QApplication>",
            "#include \"qtipcserver.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"guiconstants.h\"",
            "#include \"guiutil.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"clientmodel.h\"",
            "#include \"bitcoingui.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static BitcoinGUI *guiref;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <QtPlugin>\n#include <QLibraryInfo>\n#include <QSplashScreen>\n#include <QTranslator>\n#include <QLocale>\n#include <QTextCodec>\n#include <QMessageBox>\n#include <QApplication>\n#include \"qtipcserver.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"clientmodel.h\"\n#include \"bitcoingui.h\"\n\nstatic BitcoinGUI *guiref;\n\nstatic void ThreadSafeMessageBox(const std::string& message, const std::string& caption, int style)\n{\n    // Message from network thread\n    if(guiref)\n    {\n        bool modal = (style & CClientUIInterface::MODAL);\n        // in case of modal message, use blocking connection to wait for user to click OK\n        QMetaObject::invokeMethod(guiref, \"error\",\n                                   modal ? GUIUtil::blockingGUIThreadConnection() : Qt::QueuedConnection,\n                                   Q_ARG(QString, QString::fromStdString(caption)),\n                                   Q_ARG(QString, QString::fromStdString(message)),\n                                   Q_ARG(bool, modal));\n    }\n    else\n    {\n        printf(\"%s: %s\\n\", caption.c_str(), message.c_str());\n        fprintf(stderr, \"%s: %s\\n\", caption.c_str(), message.c_str());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Error\""
          ],
          "line": 927
        },
        "resolved": true,
        "details": {
          "function_name": "key_error",
          "container": "key_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "44-44",
          "snippet": "explicit key_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nkey_error {\n  explicit key_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "_(\"An error occurred while setting up the RPC port %u for listening on IPv4: %s\")",
            "endpoint.port()",
            "e.what()"
          ],
          "line": 923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "endpoint.port",
          "args": [],
          "line": 923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StopRequests.connect",
          "args": [
            "signals2::slot<void ()>(\n                        static_cast<void (ip::tcp::acceptor::*)()>(&ip::tcp::acceptor::close), acceptor.get())\n                    .track(acceptor)"
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "signals2::slot<void",
          "args": [
            "acceptor"
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "signals2::slot<void ()>",
          "args": [
            "static_cast<void (ip::tcp::acceptor::*)()>(&ip::tcp::acceptor::close)",
            "acceptor.get()"
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor.get",
          "args": [],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<void",
          "args": [
            "&ip::tcp::acceptor::close"
          ],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "void",
          "args": [],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "void",
          "args": [
            "ip::tcp::acceptor::*"
          ],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RPCListen",
          "args": [
            "acceptor",
            "context",
            "fUseSSL"
          ],
          "line": 912
        },
        "resolved": true,
        "details": {
          "function_name": "RPCListen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "716-745",
          "snippet": "static void RPCListen(boost::shared_ptr< basic_socket_acceptor<Protocol> > acceptor,\n#else\ntemplate <typename Protocol, typename SocketAcceptorService>\nstatic void RPCListen(boost::shared_ptr< basic_socket_acceptor<Protocol, SocketAcceptorService> > acceptor,\n#endif\n                   ssl::context& context,\n                   const bool fUseSSL)\n{\n    // Accept connection\n    AcceptedConnectionImpl<Protocol> *conn = new AcceptedConnectionImpl<Protocol>\n#if (BOOST_VERSION >= 107000)\n      ((boost::asio::io_context &)(acceptor->get_executor().context()), context, fUseSSL);\n#else\n      (acceptor->get_io_service(), context, fUseSSL);\n#endif\n\n    acceptor->async_accept(\n            conn->sslStream.lowest_layer(),\n            conn->peer,\n#if (BOOST_VERSION > 106501)\n            boost::bind(&RPCAcceptHandler<Protocol>,\n#else\n            boost::bind(&RPCAcceptHandler<Protocol, SocketAcceptorService>,\n#endif\n                acceptor,\n                boost::ref(context),\n                fUseSSL,\n                conn,\n                boost::asio::placeholders::error));\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic void RPCListen(boost::shared_ptr< basic_socket_acceptor<Protocol> > acceptor,\n#else\ntemplate <typename Protocol, typename SocketAcceptorService>\nstatic void RPCListen(boost::shared_ptr< basic_socket_acceptor<Protocol, SocketAcceptorService> > acceptor,\n#endif\n                   ssl::context& context,\n                   const bool fUseSSL)\n{\n    // Accept connection\n    AcceptedConnectionImpl<Protocol> *conn = new AcceptedConnectionImpl<Protocol>\n#if (BOOST_VERSION >= 107000)\n      ((boost::asio::io_context &)(acceptor->get_executor().context()), context, fUseSSL);\n#else\n      (acceptor->get_io_service(), context, fUseSSL);\n#endif\n\n    acceptor->async_accept(\n            conn->sslStream.lowest_layer(),\n            conn->peer,\n#if (BOOST_VERSION > 106501)\n            boost::bind(&RPCAcceptHandler<Protocol>,\n#else\n            boost::bind(&RPCAcceptHandler<Protocol, SocketAcceptorService>,\n#endif\n                acceptor,\n                boost::ref(context),\n                fUseSSL,\n                conn,\n                boost::asio::placeholders::error));\n}"
        }
      },
      {
        "call_info": {
          "callee": "acceptor->listen",
          "args": [
            "socket_base::max_connections"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor->bind",
          "args": [
            "endpoint"
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor->set_option",
          "args": [
            "boost::asio::ip::tcp::acceptor::reuse_address(true)"
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::asio::ip::tcp::acceptor::reuse_address",
          "args": [
            "true"
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor->open",
          "args": [
            "endpoint.protocol()"
          ],
          "line": 907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "endpoint.protocol",
          "args": [],
          "line": 907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor.reset",
          "args": [
            "new ip::tcp::acceptor(io_service)"
          ],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "endpoint.address",
          "args": [
            "bindAddress"
          ],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asio::ip::address_v4::any",
          "args": [],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asio::ip::address_v4::loopback",
          "args": [],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "_(\"An error occurred while setting up the RPC port %u for listening on IPv6, falling back to IPv4: %s\")",
            "endpoint.port()",
            "e.what()"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "endpoint.port",
          "args": [],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StopRequests.connect",
          "args": [
            "signals2::slot<void ()>(\n                    static_cast<void (ip::tcp::acceptor::*)()>(&ip::tcp::acceptor::close), acceptor.get())\n                .track(acceptor)"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "signals2::slot<void",
          "args": [
            "acceptor"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "signals2::slot<void ()>",
          "args": [
            "static_cast<void (ip::tcp::acceptor::*)()>(&ip::tcp::acceptor::close)",
            "acceptor.get()"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor.get",
          "args": [],
          "line": 889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<void",
          "args": [
            "&ip::tcp::acceptor::close"
          ],
          "line": 889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "void",
          "args": [],
          "line": 889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "void",
          "args": [
            "ip::tcp::acceptor::*"
          ],
          "line": 889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor->listen",
          "args": [
            "socket_base::max_connections"
          ],
          "line": 884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor->bind",
          "args": [
            "endpoint"
          ],
          "line": 883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor->set_option",
          "args": [
            "boost::asio::ip::v6_only(loopback)",
            "v6_only_error"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::asio::ip::v6_only",
          "args": [
            "loopback"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor->set_option",
          "args": [
            "boost::asio::ip::tcp::acceptor::reuse_address(true)"
          ],
          "line": 878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::asio::ip::tcp::acceptor::reuse_address",
          "args": [
            "true"
          ],
          "line": 878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor->open",
          "args": [
            "endpoint.protocol()"
          ],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "endpoint.protocol",
          "args": [],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetArg",
          "args": [
            "\"-rpcport\"",
            "GetDefaultRPCPort()"
          ],
          "line": 867
        },
        "resolved": true,
        "details": {
          "function_name": "GetArg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "562-567",
          "snippet": "int64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "map<string, string> mapArgs;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nint64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetDefaultRPCPort",
          "args": [],
          "line": 867
        },
        "resolved": true,
        "details": {
          "function_name": "GetDefaultRPCPort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "49-52",
          "snippet": "static inline unsigned short GetDefaultRPCPort()\n{\n    return GetBoolArg(\"-testnet\", false) ? 35615 : 21109;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic inline unsigned short GetDefaultRPCPort()\n{\n    return GetBoolArg(\"-testnet\", false) ? 35615 : 21109;\n}"
        }
      },
      {
        "call_info": {
          "callee": "asio::ip::address_v6::any",
          "args": [],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asio::ip::address_v6::loopback",
          "args": [],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapArgs.count",
          "args": [
            "\"-rpcallowip\""
          ],
          "line": 865
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSL_CTX_set_cipher_list",
          "args": [
            "context.impl()",
            "strCiphers.c_str()"
          ],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strCiphers.c_str",
          "args": [],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "context.impl",
          "args": [],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_CTX_set_cipher_list",
          "args": [
            "context.native_handle()",
            "strCiphers.c_str()"
          ],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strCiphers.c_str",
          "args": [],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "context.native_handle",
          "args": [],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ThreadRPCServer ERROR: missing server private key file %s\\n\"",
            "pathPKFile.string().c_str()"
          ],
          "line": 853
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathPKFile.string",
          "args": [],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathPKFile.string",
          "args": [],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "context.use_private_key_file",
          "args": [
            "pathPKFile.string()",
            "ssl::context::pem"
          ],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathPKFile.string",
          "args": [],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filesystem::exists",
          "args": [
            "pathPKFile"
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "exists",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1697-1700",
          "snippet": "bool exists(uint256 hash)\n    {\n        return (mapTx.count(hash) != 0);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  bool exists(uint256 hash)\n      {\n          return (mapTx.count(hash) != 0);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "filesystem::path",
          "args": [
            "GetDataDir()"
          ],
          "line": 851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetDataDir",
          "args": [],
          "line": 851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathPKFile.is_complete",
          "args": [],
          "line": 851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathCertFile.string",
          "args": [],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathCertFile.string",
          "args": [],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "context.use_certificate_chain_file",
          "args": [
            "pathCertFile.string()"
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathCertFile.string",
          "args": [],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filesystem::path",
          "args": [
            "GetDataDir()"
          ],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetDataDir",
          "args": [],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathCertFile.is_complete",
          "args": [],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "context.set_options",
          "args": [
            "ssl::context::no_sslv2"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetBoolArg",
          "args": [
            "\"-rpcssl\""
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "_(\"%s, you must set a rpcpassword in the configuration file:\\n %s\\n\"\n              \"It is recommended you use the following random password:\\n\"\n              \"rpcuser=halcyonrpc\\n\"\n              \"rpcpassword=%s\\n\"\n              \"(you do not need to remember this password)\\n\"\n              \"The username and password MUST NOT be the same.\\n\"\n              \"If the file does not exist, create it with owner-readable-only file permissions.\\n\"\n              \"It is also recommended to set alertnotify so you are notified of problems;\\n\"\n              \"for example: alertnotify=echo %%s | mail -s \\\"Halcyon Alert\\\" admin@foo.com\\n\")",
            "strWhatAmI.c_str()",
            "GetConfigFile().string().c_str()",
            "EncodeBase58(&rand_pwd[0],&rand_pwd[0]+32).c_str()"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EncodeBase58",
          "args": [],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EncodeBase58",
          "args": [
            "&rand_pwd[0]",
            "&rand_pwd[0]+32"
          ],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeBase58",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "27-65",
          "snippet": "inline std::string EncodeBase58(const unsigned char* pbegin, const unsigned char* pend)\n{\n    CAutoBN_CTX pctx;\n    CBigNum bn58 = 58;\n    CBigNum bn0 = 0;\n\n    // Convert big endian data to little endian\n    // Extra zero at the end make sure bignum will interpret as a positive number\n    std::vector<unsigned char> vchTmp(pend-pbegin+1, 0);\n    reverse_copy(pbegin, pend, vchTmp.begin());\n\n    // Convert little endian data to bignum\n    CBigNum bn;\n    bn.setvch(vchTmp);\n\n    // Convert bignum to std::string\n    std::string str;\n    // Expected size increase from base58 conversion is approximately 137%\n    // use 138% to be safe\n    str.reserve((pend - pbegin) * 138 / 100 + 1);\n    CBigNum dv;\n    CBigNum rem;\n    while (bn > bn0)\n    {\n        if (!BN_div(&dv, &rem, &bn, &bn58, pctx))\n            throw bignum_error(\"EncodeBase58 : BN_div failed\");\n        bn = dv;\n        unsigned int c = rem.getulong();\n        str += pszBase58[c];\n    }\n\n    // Leading zeroes encoded as base58 zeros\n    for (const unsigned char* p = pbegin; p < pend && *p == 0; p++)\n        str += pszBase58[0];\n\n    // Convert little endian std::string to big endian\n    reverse(str.begin(), str.end());\n    return str;\n}",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\ninline std::string EncodeBase58(const unsigned char* pbegin, const unsigned char* pend)\n{\n    CAutoBN_CTX pctx;\n    CBigNum bn58 = 58;\n    CBigNum bn0 = 0;\n\n    // Convert big endian data to little endian\n    // Extra zero at the end make sure bignum will interpret as a positive number\n    std::vector<unsigned char> vchTmp(pend-pbegin+1, 0);\n    reverse_copy(pbegin, pend, vchTmp.begin());\n\n    // Convert little endian data to bignum\n    CBigNum bn;\n    bn.setvch(vchTmp);\n\n    // Convert bignum to std::string\n    std::string str;\n    // Expected size increase from base58 conversion is approximately 137%\n    // use 138% to be safe\n    str.reserve((pend - pbegin) * 138 / 100 + 1);\n    CBigNum dv;\n    CBigNum rem;\n    while (bn > bn0)\n    {\n        if (!BN_div(&dv, &rem, &bn, &bn58, pctx))\n            throw bignum_error(\"EncodeBase58 : BN_div failed\");\n        bn = dv;\n        unsigned int c = rem.getulong();\n        str += pszBase58[c];\n    }\n\n    // Leading zeroes encoded as base58 zeros\n    for (const unsigned char* p = pbegin; p < pend && *p == 0; p++)\n        str += pszBase58[0];\n\n    // Convert little endian std::string to big endian\n    reverse(str.begin(), str.end());\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetConfigFile",
          "args": [],
          "line": 824
        },
        "resolved": true,
        "details": {
          "function_name": "GetConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1072-1085",
          "snippet": "boost::filesystem::path GetConfigFile() {\n    namespace fs = boost::filesystem;\n\n    fs::path pathConfigFile;\n    if(mapArgs.count(\"-conf\")) pathConfigFile = fs::path(mapArgs[\"-conf\"]);\n    else pathConfigFile = fs::path(\"halcyon.conf\");\n    if(!pathConfigFile.is_absolute()) {\n        if(!GetBoolArg(\"-testnet\", false)) \n          pathConfigFile = GetDataDir(false) / pathConfigFile;\n        else\n          pathConfigFile = GetDataDir(false) / \"testnet\" / pathConfigFile;\n    }\n    return(pathConfigFile);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "map<string, string> mapArgs;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nboost::filesystem::path GetConfigFile() {\n    namespace fs = boost::filesystem;\n\n    fs::path pathConfigFile;\n    if(mapArgs.count(\"-conf\")) pathConfigFile = fs::path(mapArgs[\"-conf\"]);\n    else pathConfigFile = fs::path(\"halcyon.conf\");\n    if(!pathConfigFile.is_absolute()) {\n        if(!GetBoolArg(\"-testnet\", false)) \n          pathConfigFile = GetDataDir(false) / pathConfigFile;\n        else\n          pathConfigFile = GetDataDir(false) / \"testnet\" / pathConfigFile;\n    }\n    return(pathConfigFile);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strWhatAmI.c_str",
          "args": [],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RAND_bytes",
          "args": [
            "rand_pwd",
            "32"
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ThreadRPCServer started\\n\""
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\n#define printf OutputDebugStringF\n\nvoid ThreadRPCServer2(void* parg);\nstatic std::string strRPCUserColonPass;\nvoid ThreadRPCServer3(void* parg);\n\nvoid ThreadRPCServer2(void* parg)\n{\n    printf(\"ThreadRPCServer started\\n\");\n\n    strRPCUserColonPass = mapArgs[\"-rpcuser\"] + \":\" + mapArgs[\"-rpcpassword\"];\n    if ((mapArgs[\"-rpcpassword\"] == \"\") ||\n        (mapArgs[\"-rpcuser\"] == mapArgs[\"-rpcpassword\"]))\n    {\n        unsigned char rand_pwd[32];\n        RAND_bytes(rand_pwd, 32);\n        string strWhatAmI = \"To use halcyond\";\n        if (mapArgs.count(\"-server\"))\n            strWhatAmI = strprintf(_(\"To use the %s option\"), \"\\\"-server\\\"\");\n        else if (mapArgs.count(\"-daemon\"))\n            strWhatAmI = strprintf(_(\"To use the %s option\"), \"\\\"-daemon\\\"\");\n        uiInterface.ThreadSafeMessageBox(strprintf(\n            _(\"%s, you must set a rpcpassword in the configuration file:\\n %s\\n\"\n              \"It is recommended you use the following random password:\\n\"\n              \"rpcuser=halcyonrpc\\n\"\n              \"rpcpassword=%s\\n\"\n              \"(you do not need to remember this password)\\n\"\n              \"The username and password MUST NOT be the same.\\n\"\n              \"If the file does not exist, create it with owner-readable-only file permissions.\\n\"\n              \"It is also recommended to set alertnotify so you are notified of problems;\\n\"\n              \"for example: alertnotify=echo %%s | mail -s \\\"Halcyon Alert\\\" admin@foo.com\\n\"),\n                strWhatAmI.c_str(),\n                GetConfigFile().string().c_str(),\n                EncodeBase58(&rand_pwd[0],&rand_pwd[0]+32).c_str()),\n            _(\"Error\"), CClientUIInterface::OK | CClientUIInterface::MODAL);\n        StartShutdown();\n        return;\n    }\n\n    const bool fUseSSL = GetBoolArg(\"-rpcssl\");\n\n    asio::io_service io_service;\n\n#if (BOOST_VERSION > 106501)\n    ssl::context context(ssl::context::sslv23);\n#else\n    ssl::context context(io_service, ssl::context::sslv23);\n#endif\n\n    if (fUseSSL)\n    {\n        context.set_options(ssl::context::no_sslv2);\n\n        filesystem::path pathCertFile(GetArg(\"-rpcsslcertificatechainfile\", \"server.cert\"));\n        if (!pathCertFile.is_complete()) pathCertFile = filesystem::path(GetDataDir()) / pathCertFile;\n        if (filesystem::exists(pathCertFile)) context.use_certificate_chain_file(pathCertFile.string());\n        else printf(\"ThreadRPCServer ERROR: missing server certificate file %s\\n\", pathCertFile.string().c_str());\n\n        filesystem::path pathPKFile(GetArg(\"-rpcsslprivatekeyfile\", \"server.pem\"));\n        if (!pathPKFile.is_complete()) pathPKFile = filesystem::path(GetDataDir()) / pathPKFile;\n        if (filesystem::exists(pathPKFile)) context.use_private_key_file(pathPKFile.string(), ssl::context::pem);\n        else printf(\"ThreadRPCServer ERROR: missing server private key file %s\\n\", pathPKFile.string().c_str());\n\n        string strCiphers = GetArg(\"-rpcsslciphers\", \"TLSv1+HIGH:!SSLv2:!aNULL:!eNULL:!AH:!3DES:@STRENGTH\");\n\n#if (BOOST_VERSION > 106501)\n        SSL_CTX_set_cipher_list(context.native_handle(), strCiphers.c_str());\n#else\n        SSL_CTX_set_cipher_list(context.impl(), strCiphers.c_str());\n#endif\n    }\n\n    // Try a dual IPv6/IPv4 socket, falling back to separate IPv4 and IPv6 sockets\n    const bool loopback = !mapArgs.count(\"-rpcallowip\");\n    asio::ip::address bindAddress = loopback ? asio::ip::address_v6::loopback() : asio::ip::address_v6::any();\n    ip::tcp::endpoint endpoint(bindAddress, GetArg(\"-rpcport\", GetDefaultRPCPort()));\n    boost::system::error_code v6_only_error;\n    boost::shared_ptr<ip::tcp::acceptor> acceptor(new ip::tcp::acceptor(io_service));\n\n    boost::signals2::signal<void ()> StopRequests;\n\n    bool fListening = false;\n    std::string strerr;\n    try\n    {\n        acceptor->open(endpoint.protocol());\n        acceptor->set_option(boost::asio::ip::tcp::acceptor::reuse_address(true));\n\n        // Try making the socket dual IPv6/IPv4 (if listening on the \"any\" address)\n        acceptor->set_option(boost::asio::ip::v6_only(loopback), v6_only_error);\n\n        acceptor->bind(endpoint);\n        acceptor->listen(socket_base::max_connections);\n\n        RPCListen(acceptor, context, fUseSSL);\n        // Cancel outstanding listen-requests for this acceptor when shutting down\n        StopRequests.connect(signals2::slot<void ()>(\n                    static_cast<void (ip::tcp::acceptor::*)()>(&ip::tcp::acceptor::close), acceptor.get())\n                .track(acceptor));\n\n        fListening = true;\n    }\n    catch(boost::system::system_error &e)\n    {\n        strerr = strprintf(_(\"An error occurred while setting up the RPC port %u for listening on IPv6, falling back to IPv4: %s\"), endpoint.port(), e.what());\n    }\n\n    try {\n        // If dual IPv6/IPv4 failed (or we're opening loopback interfaces only), open IPv4 separately\n        if (!fListening || loopback || v6_only_error)\n        {\n            bindAddress = loopback ? asio::ip::address_v4::loopback() : asio::ip::address_v4::any();\n            endpoint.address(bindAddress);\n\n            acceptor.reset(new ip::tcp::acceptor(io_service));\n            acceptor->open(endpoint.protocol());\n            acceptor->set_option(boost::asio::ip::tcp::acceptor::reuse_address(true));\n            acceptor->bind(endpoint);\n            acceptor->listen(socket_base::max_connections);\n\n            RPCListen(acceptor, context, fUseSSL);\n            // Cancel outstanding listen-requests for this acceptor when shutting down\n            StopRequests.connect(signals2::slot<void ()>(\n                        static_cast<void (ip::tcp::acceptor::*)()>(&ip::tcp::acceptor::close), acceptor.get())\n                    .track(acceptor));\n\n            fListening = true;\n        }\n    }\n    catch(boost::system::system_error &e)\n    {\n        strerr = strprintf(_(\"An error occurred while setting up the RPC port %u for listening on IPv4: %s\"), endpoint.port(), e.what());\n    }\n\n    if (!fListening) {\n        uiInterface.ThreadSafeMessageBox(strerr, _(\"Error\"), CClientUIInterface::OK | CClientUIInterface::MODAL);\n        StartShutdown();\n        return;\n    }\n\n    vnThreadsRunning[THREAD_RPCLISTENER]--;\n    while (!fShutdown)\n        io_service.run_one();\n    vnThreadsRunning[THREAD_RPCLISTENER]++;\n    StopRequests();\n}"
  },
  {
    "function_name": "RPCAcceptHandler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "752-796",
    "snippet": "static void RPCAcceptHandler(boost::shared_ptr< basic_socket_acceptor<Protocol> > acceptor,\n#else\ntemplate <typename Protocol, typename SocketAcceptorService>\nstatic void RPCAcceptHandler(boost::shared_ptr< basic_socket_acceptor<Protocol, SocketAcceptorService> > acceptor,\n#endif\n                             ssl::context& context,\n                             const bool fUseSSL,\n                             AcceptedConnection* conn,\n                             const boost::system::error_code& error)\n{\n    vnThreadsRunning[THREAD_RPCLISTENER]++;\n\n    // Immediately start accepting new connections, except when we're cancelled or our socket is closed.\n    if (error != asio::error::operation_aborted\n     && acceptor->is_open())\n        RPCListen(acceptor, context, fUseSSL);\n\n    AcceptedConnectionImpl<ip::tcp>* tcp_conn = dynamic_cast< AcceptedConnectionImpl<ip::tcp>* >(conn);\n\n    // TODO: Actually handle errors\n    if (error)\n    {\n        delete conn;\n    }\n\n    // Restrict callers by IP.  It is important to\n    // do this before starting client thread, to filter out\n    // certain DoS and misbehaving clients.\n    else if (tcp_conn\n          && !ClientAllowed(tcp_conn->peer.address()))\n    {\n        // Only send a 403 if we're not using SSL to prevent a DoS during the SSL handshake.\n        if (!fUseSSL)\n            conn->stream() << HTTPReply(HTTP_FORBIDDEN, \"\", false) << std::flush;\n        delete conn;\n    }\n\n    // start HTTP client thread\n    else if (!NewThread(ThreadRPCServer3, conn)) {\n        printf(\"Failed to create RPC server client thread\\n\");\n        delete conn;\n    }\n\n    vnThreadsRunning[THREAD_RPCLISTENER]--;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [
      "#define printf OutputDebugStringF"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Failed to create RPC server client thread\\n\""
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NewThread",
          "args": [
            "ThreadRPCServer3",
            "conn"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "NewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1350-1360",
          "snippet": "bool NewThread(void(*pfn)(void*), void* parg)\n{\n    try\n    {\n        boost::thread(pfn, parg); // thread detaches when out of scope\n    } catch(boost::thread_resource_error &e) {\n        printf(\"Error creating thread: %s\\n\", e.what());\n        return false;\n    }\n    return true;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool NewThread(void(*pfn)(void*), void* parg)\n{\n    try\n    {\n        boost::thread(pfn, parg); // thread detaches when out of scope\n    } catch(boost::thread_resource_error &e) {\n        printf(\"Error creating thread: %s\\n\", e.what());\n        return false;\n    }\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "HTTPReply",
          "args": [
            "HTTP_FORBIDDEN",
            "\"\"",
            "false"
          ],
          "line": 785
        },
        "resolved": true,
        "details": {
          "function_name": "HTTPReply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "374-416",
          "snippet": "static string HTTPReply(int nStatus, const string& strMsg, bool keepalive)\n{\n    if (nStatus == HTTP_UNAUTHORIZED)\n        return strprintf(\"HTTP/1.0 401 Authorization Required\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"WWW-Authenticate: Basic realm=\\\"jsonrpc\\\"\\r\\n\"\n            \"Content-Type: text/html\\r\\n\"\n            \"Content-Length: 296\\r\\n\"\n            \"\\r\\n\"\n            \"<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\"\\r\\n\"\n            \"\\\"http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd\\\">\\r\\n\"\n            \"<HTML>\\r\\n\"\n            \"<HEAD>\\r\\n\"\n            \"<TITLE>Error</TITLE>\\r\\n\"\n            \"<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=ISO-8859-1'>\\r\\n\"\n            \"</HEAD>\\r\\n\"\n            \"<BODY><H1>401 Unauthorized.</H1></BODY>\\r\\n\"\n            \"</HTML>\\r\\n\", rfc1123Time().c_str(), FormatFullVersion().c_str());\n    const char *cStatus;\n         if (nStatus == HTTP_OK) cStatus = \"OK\";\n    else if (nStatus == HTTP_BAD_REQUEST) cStatus = \"Bad Request\";\n    else if (nStatus == HTTP_FORBIDDEN) cStatus = \"Forbidden\";\n    else if (nStatus == HTTP_NOT_FOUND) cStatus = \"Not Found\";\n    else if (nStatus == HTTP_INTERNAL_SERVER_ERROR) cStatus = \"Internal Server Error\";\n    else cStatus = \"\";\n    return strprintf(\n            \"HTTP/1.1 %d %s\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Connection: %s\\r\\n\"\n            \"Content-Length: %\"PRIszu\"\\r\\n\"\n            \"Content-Type: application/json\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"\\r\\n\"\n            \"%s\",\n        nStatus,\n        cStatus,\n        rfc1123Time().c_str(),\n        keepalive ? \"keep-alive\" : \"close\",\n        strMsg.size(),\n        FormatFullVersion().c_str(),\n        strMsg.c_str());\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic string HTTPReply(int nStatus, const string& strMsg, bool keepalive)\n{\n    if (nStatus == HTTP_UNAUTHORIZED)\n        return strprintf(\"HTTP/1.0 401 Authorization Required\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"WWW-Authenticate: Basic realm=\\\"jsonrpc\\\"\\r\\n\"\n            \"Content-Type: text/html\\r\\n\"\n            \"Content-Length: 296\\r\\n\"\n            \"\\r\\n\"\n            \"<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\"\\r\\n\"\n            \"\\\"http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd\\\">\\r\\n\"\n            \"<HTML>\\r\\n\"\n            \"<HEAD>\\r\\n\"\n            \"<TITLE>Error</TITLE>\\r\\n\"\n            \"<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=ISO-8859-1'>\\r\\n\"\n            \"</HEAD>\\r\\n\"\n            \"<BODY><H1>401 Unauthorized.</H1></BODY>\\r\\n\"\n            \"</HTML>\\r\\n\", rfc1123Time().c_str(), FormatFullVersion().c_str());\n    const char *cStatus;\n         if (nStatus == HTTP_OK) cStatus = \"OK\";\n    else if (nStatus == HTTP_BAD_REQUEST) cStatus = \"Bad Request\";\n    else if (nStatus == HTTP_FORBIDDEN) cStatus = \"Forbidden\";\n    else if (nStatus == HTTP_NOT_FOUND) cStatus = \"Not Found\";\n    else if (nStatus == HTTP_INTERNAL_SERVER_ERROR) cStatus = \"Internal Server Error\";\n    else cStatus = \"\";\n    return strprintf(\n            \"HTTP/1.1 %d %s\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Connection: %s\\r\\n\"\n            \"Content-Length: %\"PRIszu\"\\r\\n\"\n            \"Content-Type: application/json\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"\\r\\n\"\n            \"%s\",\n        nStatus,\n        cStatus,\n        rfc1123Time().c_str(),\n        keepalive ? \"keep-alive\" : \"close\",\n        strMsg.size(),\n        FormatFullVersion().c_str(),\n        strMsg.c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "conn->stream",
          "args": [],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ClientAllowed",
          "args": [
            "tcp_conn->peer.address()"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "ClientAllowed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "551-572",
          "snippet": "bool ClientAllowed(const boost::asio::ip::address& address)\n{\n    // Make sure that IPv4-compatible and IPv4-mapped IPv6 addresses are treated as IPv4 addresses\n    if (address.is_v6()\n     && (address.to_v6().is_v4_compatible()\n      || address.to_v6().is_v4_mapped()))\n        return ClientAllowed(address.to_v6().to_v4());\n\n    if (address == asio::ip::address_v4::loopback()\n     || address == asio::ip::address_v6::loopback()\n     || (address.is_v4()\n         // Check whether IPv4 addresses match 127.0.0.0/8 (loopback subnet)\n      && (address.to_v4().to_ulong() & 0xff000000) == 0x7f000000))\n        return true;\n\n    const string strAddress = address.to_string();\n    const vector<string>& vAllow = mapMultiArgs[\"-rpcallowip\"];\n    BOOST_FOREACH(string strAllow, vAllow)\n        if (WildcardMatch(strAddress, strAllow))\n            return true;\n    return false;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nbool ClientAllowed(const boost::asio::ip::address& address)\n{\n    // Make sure that IPv4-compatible and IPv4-mapped IPv6 addresses are treated as IPv4 addresses\n    if (address.is_v6()\n     && (address.to_v6().is_v4_compatible()\n      || address.to_v6().is_v4_mapped()))\n        return ClientAllowed(address.to_v6().to_v4());\n\n    if (address == asio::ip::address_v4::loopback()\n     || address == asio::ip::address_v6::loopback()\n     || (address.is_v4()\n         // Check whether IPv4 addresses match 127.0.0.0/8 (loopback subnet)\n      && (address.to_v4().to_ulong() & 0xff000000) == 0x7f000000))\n        return true;\n\n    const string strAddress = address.to_string();\n    const vector<string>& vAllow = mapMultiArgs[\"-rpcallowip\"];\n    BOOST_FOREACH(string strAllow, vAllow)\n        if (WildcardMatch(strAddress, strAllow))\n            return true;\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "tcp_conn->peer.address",
          "args": [],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dynamic_cast< AcceptedConnectionImpl<ip::tcp>* >",
          "args": [
            "conn"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RPCListen",
          "args": [
            "acceptor",
            "context",
            "fUseSSL"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "RPCListen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "716-745",
          "snippet": "static void RPCListen(boost::shared_ptr< basic_socket_acceptor<Protocol> > acceptor,\n#else\ntemplate <typename Protocol, typename SocketAcceptorService>\nstatic void RPCListen(boost::shared_ptr< basic_socket_acceptor<Protocol, SocketAcceptorService> > acceptor,\n#endif\n                   ssl::context& context,\n                   const bool fUseSSL)\n{\n    // Accept connection\n    AcceptedConnectionImpl<Protocol> *conn = new AcceptedConnectionImpl<Protocol>\n#if (BOOST_VERSION >= 107000)\n      ((boost::asio::io_context &)(acceptor->get_executor().context()), context, fUseSSL);\n#else\n      (acceptor->get_io_service(), context, fUseSSL);\n#endif\n\n    acceptor->async_accept(\n            conn->sslStream.lowest_layer(),\n            conn->peer,\n#if (BOOST_VERSION > 106501)\n            boost::bind(&RPCAcceptHandler<Protocol>,\n#else\n            boost::bind(&RPCAcceptHandler<Protocol, SocketAcceptorService>,\n#endif\n                acceptor,\n                boost::ref(context),\n                fUseSSL,\n                conn,\n                boost::asio::placeholders::error));\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic void RPCListen(boost::shared_ptr< basic_socket_acceptor<Protocol> > acceptor,\n#else\ntemplate <typename Protocol, typename SocketAcceptorService>\nstatic void RPCListen(boost::shared_ptr< basic_socket_acceptor<Protocol, SocketAcceptorService> > acceptor,\n#endif\n                   ssl::context& context,\n                   const bool fUseSSL)\n{\n    // Accept connection\n    AcceptedConnectionImpl<Protocol> *conn = new AcceptedConnectionImpl<Protocol>\n#if (BOOST_VERSION >= 107000)\n      ((boost::asio::io_context &)(acceptor->get_executor().context()), context, fUseSSL);\n#else\n      (acceptor->get_io_service(), context, fUseSSL);\n#endif\n\n    acceptor->async_accept(\n            conn->sslStream.lowest_layer(),\n            conn->peer,\n#if (BOOST_VERSION > 106501)\n            boost::bind(&RPCAcceptHandler<Protocol>,\n#else\n            boost::bind(&RPCAcceptHandler<Protocol, SocketAcceptorService>,\n#endif\n                acceptor,\n                boost::ref(context),\n                fUseSSL,\n                conn,\n                boost::asio::placeholders::error));\n}"
        }
      },
      {
        "call_info": {
          "callee": "acceptor->is_open",
          "args": [],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\n#define printf OutputDebugStringF\n\nstatic void RPCAcceptHandler(boost::shared_ptr< basic_socket_acceptor<Protocol> > acceptor,\n#else\ntemplate <typename Protocol, typename SocketAcceptorService>\nstatic void RPCAcceptHandler(boost::shared_ptr< basic_socket_acceptor<Protocol, SocketAcceptorService> > acceptor,\n#endif\n                             ssl::context& context,\n                             const bool fUseSSL,\n                             AcceptedConnection* conn,\n                             const boost::system::error_code& error)\n{\n    vnThreadsRunning[THREAD_RPCLISTENER]++;\n\n    // Immediately start accepting new connections, except when we're cancelled or our socket is closed.\n    if (error != asio::error::operation_aborted\n     && acceptor->is_open())\n        RPCListen(acceptor, context, fUseSSL);\n\n    AcceptedConnectionImpl<ip::tcp>* tcp_conn = dynamic_cast< AcceptedConnectionImpl<ip::tcp>* >(conn);\n\n    // TODO: Actually handle errors\n    if (error)\n    {\n        delete conn;\n    }\n\n    // Restrict callers by IP.  It is important to\n    // do this before starting client thread, to filter out\n    // certain DoS and misbehaving clients.\n    else if (tcp_conn\n          && !ClientAllowed(tcp_conn->peer.address()))\n    {\n        // Only send a 403 if we're not using SSL to prevent a DoS during the SSL handshake.\n        if (!fUseSSL)\n            conn->stream() << HTTPReply(HTTP_FORBIDDEN, \"\", false) << std::flush;\n        delete conn;\n    }\n\n    // start HTTP client thread\n    else if (!NewThread(ThreadRPCServer3, conn)) {\n        printf(\"Failed to create RPC server client thread\\n\");\n        delete conn;\n    }\n\n    vnThreadsRunning[THREAD_RPCLISTENER]--;\n}"
  },
  {
    "function_name": "RPCListen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "716-745",
    "snippet": "static void RPCListen(boost::shared_ptr< basic_socket_acceptor<Protocol> > acceptor,\n#else\ntemplate <typename Protocol, typename SocketAcceptorService>\nstatic void RPCListen(boost::shared_ptr< basic_socket_acceptor<Protocol, SocketAcceptorService> > acceptor,\n#endif\n                   ssl::context& context,\n                   const bool fUseSSL)\n{\n    // Accept connection\n    AcceptedConnectionImpl<Protocol> *conn = new AcceptedConnectionImpl<Protocol>\n#if (BOOST_VERSION >= 107000)\n      ((boost::asio::io_context &)(acceptor->get_executor().context()), context, fUseSSL);\n#else\n      (acceptor->get_io_service(), context, fUseSSL);\n#endif\n\n    acceptor->async_accept(\n            conn->sslStream.lowest_layer(),\n            conn->peer,\n#if (BOOST_VERSION > 106501)\n            boost::bind(&RPCAcceptHandler<Protocol>,\n#else\n            boost::bind(&RPCAcceptHandler<Protocol, SocketAcceptorService>,\n#endif\n                acceptor,\n                boost::ref(context),\n                fUseSSL,\n                conn,\n                boost::asio::placeholders::error));\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "acceptor->async_accept",
          "args": [
            "conn->sslStream.lowest_layer()",
            "conn->peer",
            "#if (BOOST_VERSION > 106501)boost::bind(&RPCAcceptHandler<Protocol>,\n#else\n            boost::bind(&RPCAcceptHandler<Protocol, SocketAcceptorService>,\n#endif\n                acceptor,\n                boost::ref(context),\n                fUseSSL,\n                conn,\n                boost::asio::placeholders::error))"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::bind",
          "args": [
            "&RPCAcceptHandler<Protocol>",
            "#elseboost::bind(&RPCAcceptHandler<Protocol, SocketAcceptorService>,\n#endif\n                acceptor,\n                boost::ref(context),\n                fUseSSL,\n                conn,\n                boost::asio::placeholders::error)"
          ],
          "line": 736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::bind",
          "args": [
            "&RPCAcceptHandler<Protocol, SocketAcceptorService>",
            "#endifacceptor",
            "boost::ref(context)",
            "fUseSSL",
            "conn",
            "boost::asio::placeholders::error"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::ref",
          "args": [
            "context"
          ],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->sslStream.lowest_layer",
          "args": [],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor->get_io_service",
          "args": [],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new AcceptedConnectionImpl<Protocol>\n#if",
          "args": [
            "(boost::asio::io_context &)(acceptor->get_executor().context())",
            "context",
            "fUseSSL"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor->get_executor",
          "args": [],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acceptor->get_executor",
          "args": [],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic void RPCListen(boost::shared_ptr< basic_socket_acceptor<Protocol> > acceptor,\n#else\ntemplate <typename Protocol, typename SocketAcceptorService>\nstatic void RPCListen(boost::shared_ptr< basic_socket_acceptor<Protocol, SocketAcceptorService> > acceptor,\n#endif\n                   ssl::context& context,\n                   const bool fUseSSL)\n{\n    // Accept connection\n    AcceptedConnectionImpl<Protocol> *conn = new AcceptedConnectionImpl<Protocol>\n#if (BOOST_VERSION >= 107000)\n      ((boost::asio::io_context &)(acceptor->get_executor().context()), context, fUseSSL);\n#else\n      (acceptor->get_io_service(), context, fUseSSL);\n#endif\n\n    acceptor->async_accept(\n            conn->sslStream.lowest_layer(),\n            conn->peer,\n#if (BOOST_VERSION > 106501)\n            boost::bind(&RPCAcceptHandler<Protocol>,\n#else\n            boost::bind(&RPCAcceptHandler<Protocol, SocketAcceptorService>,\n#endif\n                acceptor,\n                boost::ref(context),\n                fUseSSL,\n                conn,\n                boost::asio::placeholders::error));\n}"
  },
  {
    "function_name": "ThreadRPCServer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "677-696",
    "snippet": "void ThreadRPCServer(void* parg)\n{\n    // Make this thread recognisable as the RPC listener\n    RenameThread(\"hal-rpclist\");\n\n    try\n    {\n        vnThreadsRunning[THREAD_RPCLISTENER]++;\n        ThreadRPCServer2(parg);\n        vnThreadsRunning[THREAD_RPCLISTENER]--;\n    }\n    catch (std::exception& e) {\n        vnThreadsRunning[THREAD_RPCLISTENER]--;\n        PrintException(&e, \"ThreadRPCServer()\");\n    } catch (...) {\n        vnThreadsRunning[THREAD_RPCLISTENER]--;\n        PrintException(NULL, \"ThreadRPCServer()\");\n    }\n    printf(\"ThreadRPCServer exited\\n\");\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [
      "#define printf OutputDebugStringF"
    ],
    "globals_used": [
      "void ThreadRPCServer2(void* parg);",
      "void ThreadRPCServer3(void* parg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ThreadRPCServer exited\\n\""
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PrintException",
          "args": [
            "NULL",
            "\"ThreadRPCServer()\""
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "PrintExceptionContinue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1005-1011",
          "snippet": "void PrintExceptionContinue(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n\\n************************\\n%s\\n\", message.c_str());\n    fprintf(stderr, \"\\n\\n************************\\n%s\\n\", message.c_str());\n    strMiscWarning = message;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "string strMiscWarning;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring strMiscWarning;\n\nvoid PrintExceptionContinue(std::exception* pex, const char* pszThread)\n{\n    std::string message = FormatException(pex, pszThread);\n    printf(\"\\n\\n************************\\n%s\\n\", message.c_str());\n    fprintf(stderr, \"\\n\\n************************\\n%s\\n\", message.c_str());\n    strMiscWarning = message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ThreadRPCServer2",
          "args": [
            "parg"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "ThreadRPCServer2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "798-937",
          "snippet": "void ThreadRPCServer2(void* parg)\n{\n    printf(\"ThreadRPCServer started\\n\");\n\n    strRPCUserColonPass = mapArgs[\"-rpcuser\"] + \":\" + mapArgs[\"-rpcpassword\"];\n    if ((mapArgs[\"-rpcpassword\"] == \"\") ||\n        (mapArgs[\"-rpcuser\"] == mapArgs[\"-rpcpassword\"]))\n    {\n        unsigned char rand_pwd[32];\n        RAND_bytes(rand_pwd, 32);\n        string strWhatAmI = \"To use halcyond\";\n        if (mapArgs.count(\"-server\"))\n            strWhatAmI = strprintf(_(\"To use the %s option\"), \"\\\"-server\\\"\");\n        else if (mapArgs.count(\"-daemon\"))\n            strWhatAmI = strprintf(_(\"To use the %s option\"), \"\\\"-daemon\\\"\");\n        uiInterface.ThreadSafeMessageBox(strprintf(\n            _(\"%s, you must set a rpcpassword in the configuration file:\\n %s\\n\"\n              \"It is recommended you use the following random password:\\n\"\n              \"rpcuser=halcyonrpc\\n\"\n              \"rpcpassword=%s\\n\"\n              \"(you do not need to remember this password)\\n\"\n              \"The username and password MUST NOT be the same.\\n\"\n              \"If the file does not exist, create it with owner-readable-only file permissions.\\n\"\n              \"It is also recommended to set alertnotify so you are notified of problems;\\n\"\n              \"for example: alertnotify=echo %%s | mail -s \\\"Halcyon Alert\\\" admin@foo.com\\n\"),\n                strWhatAmI.c_str(),\n                GetConfigFile().string().c_str(),\n                EncodeBase58(&rand_pwd[0],&rand_pwd[0]+32).c_str()),\n            _(\"Error\"), CClientUIInterface::OK | CClientUIInterface::MODAL);\n        StartShutdown();\n        return;\n    }\n\n    const bool fUseSSL = GetBoolArg(\"-rpcssl\");\n\n    asio::io_service io_service;\n\n#if (BOOST_VERSION > 106501)\n    ssl::context context(ssl::context::sslv23);\n#else\n    ssl::context context(io_service, ssl::context::sslv23);\n#endif\n\n    if (fUseSSL)\n    {\n        context.set_options(ssl::context::no_sslv2);\n\n        filesystem::path pathCertFile(GetArg(\"-rpcsslcertificatechainfile\", \"server.cert\"));\n        if (!pathCertFile.is_complete()) pathCertFile = filesystem::path(GetDataDir()) / pathCertFile;\n        if (filesystem::exists(pathCertFile)) context.use_certificate_chain_file(pathCertFile.string());\n        else printf(\"ThreadRPCServer ERROR: missing server certificate file %s\\n\", pathCertFile.string().c_str());\n\n        filesystem::path pathPKFile(GetArg(\"-rpcsslprivatekeyfile\", \"server.pem\"));\n        if (!pathPKFile.is_complete()) pathPKFile = filesystem::path(GetDataDir()) / pathPKFile;\n        if (filesystem::exists(pathPKFile)) context.use_private_key_file(pathPKFile.string(), ssl::context::pem);\n        else printf(\"ThreadRPCServer ERROR: missing server private key file %s\\n\", pathPKFile.string().c_str());\n\n        string strCiphers = GetArg(\"-rpcsslciphers\", \"TLSv1+HIGH:!SSLv2:!aNULL:!eNULL:!AH:!3DES:@STRENGTH\");\n\n#if (BOOST_VERSION > 106501)\n        SSL_CTX_set_cipher_list(context.native_handle(), strCiphers.c_str());\n#else\n        SSL_CTX_set_cipher_list(context.impl(), strCiphers.c_str());\n#endif\n    }\n\n    // Try a dual IPv6/IPv4 socket, falling back to separate IPv4 and IPv6 sockets\n    const bool loopback = !mapArgs.count(\"-rpcallowip\");\n    asio::ip::address bindAddress = loopback ? asio::ip::address_v6::loopback() : asio::ip::address_v6::any();\n    ip::tcp::endpoint endpoint(bindAddress, GetArg(\"-rpcport\", GetDefaultRPCPort()));\n    boost::system::error_code v6_only_error;\n    boost::shared_ptr<ip::tcp::acceptor> acceptor(new ip::tcp::acceptor(io_service));\n\n    boost::signals2::signal<void ()> StopRequests;\n\n    bool fListening = false;\n    std::string strerr;\n    try\n    {\n        acceptor->open(endpoint.protocol());\n        acceptor->set_option(boost::asio::ip::tcp::acceptor::reuse_address(true));\n\n        // Try making the socket dual IPv6/IPv4 (if listening on the \"any\" address)\n        acceptor->set_option(boost::asio::ip::v6_only(loopback), v6_only_error);\n\n        acceptor->bind(endpoint);\n        acceptor->listen(socket_base::max_connections);\n\n        RPCListen(acceptor, context, fUseSSL);\n        // Cancel outstanding listen-requests for this acceptor when shutting down\n        StopRequests.connect(signals2::slot<void ()>(\n                    static_cast<void (ip::tcp::acceptor::*)()>(&ip::tcp::acceptor::close), acceptor.get())\n                .track(acceptor));\n\n        fListening = true;\n    }\n    catch(boost::system::system_error &e)\n    {\n        strerr = strprintf(_(\"An error occurred while setting up the RPC port %u for listening on IPv6, falling back to IPv4: %s\"), endpoint.port(), e.what());\n    }\n\n    try {\n        // If dual IPv6/IPv4 failed (or we're opening loopback interfaces only), open IPv4 separately\n        if (!fListening || loopback || v6_only_error)\n        {\n            bindAddress = loopback ? asio::ip::address_v4::loopback() : asio::ip::address_v4::any();\n            endpoint.address(bindAddress);\n\n            acceptor.reset(new ip::tcp::acceptor(io_service));\n            acceptor->open(endpoint.protocol());\n            acceptor->set_option(boost::asio::ip::tcp::acceptor::reuse_address(true));\n            acceptor->bind(endpoint);\n            acceptor->listen(socket_base::max_connections);\n\n            RPCListen(acceptor, context, fUseSSL);\n            // Cancel outstanding listen-requests for this acceptor when shutting down\n            StopRequests.connect(signals2::slot<void ()>(\n                        static_cast<void (ip::tcp::acceptor::*)()>(&ip::tcp::acceptor::close), acceptor.get())\n                    .track(acceptor));\n\n            fListening = true;\n        }\n    }\n    catch(boost::system::system_error &e)\n    {\n        strerr = strprintf(_(\"An error occurred while setting up the RPC port %u for listening on IPv4: %s\"), endpoint.port(), e.what());\n    }\n\n    if (!fListening) {\n        uiInterface.ThreadSafeMessageBox(strerr, _(\"Error\"), CClientUIInterface::OK | CClientUIInterface::MODAL);\n        StartShutdown();\n        return;\n    }\n\n    vnThreadsRunning[THREAD_RPCLISTENER]--;\n    while (!fShutdown)\n        io_service.run_one();\n    vnThreadsRunning[THREAD_RPCLISTENER]++;\n    StopRequests();\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [
            "#define printf OutputDebugStringF"
          ],
          "globals_used": [
            "void ThreadRPCServer2(void* parg);",
            "static std::string strRPCUserColonPass;",
            "void ThreadRPCServer3(void* parg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\n#define printf OutputDebugStringF\n\nvoid ThreadRPCServer2(void* parg);\nstatic std::string strRPCUserColonPass;\nvoid ThreadRPCServer3(void* parg);\n\nvoid ThreadRPCServer2(void* parg)\n{\n    printf(\"ThreadRPCServer started\\n\");\n\n    strRPCUserColonPass = mapArgs[\"-rpcuser\"] + \":\" + mapArgs[\"-rpcpassword\"];\n    if ((mapArgs[\"-rpcpassword\"] == \"\") ||\n        (mapArgs[\"-rpcuser\"] == mapArgs[\"-rpcpassword\"]))\n    {\n        unsigned char rand_pwd[32];\n        RAND_bytes(rand_pwd, 32);\n        string strWhatAmI = \"To use halcyond\";\n        if (mapArgs.count(\"-server\"))\n            strWhatAmI = strprintf(_(\"To use the %s option\"), \"\\\"-server\\\"\");\n        else if (mapArgs.count(\"-daemon\"))\n            strWhatAmI = strprintf(_(\"To use the %s option\"), \"\\\"-daemon\\\"\");\n        uiInterface.ThreadSafeMessageBox(strprintf(\n            _(\"%s, you must set a rpcpassword in the configuration file:\\n %s\\n\"\n              \"It is recommended you use the following random password:\\n\"\n              \"rpcuser=halcyonrpc\\n\"\n              \"rpcpassword=%s\\n\"\n              \"(you do not need to remember this password)\\n\"\n              \"The username and password MUST NOT be the same.\\n\"\n              \"If the file does not exist, create it with owner-readable-only file permissions.\\n\"\n              \"It is also recommended to set alertnotify so you are notified of problems;\\n\"\n              \"for example: alertnotify=echo %%s | mail -s \\\"Halcyon Alert\\\" admin@foo.com\\n\"),\n                strWhatAmI.c_str(),\n                GetConfigFile().string().c_str(),\n                EncodeBase58(&rand_pwd[0],&rand_pwd[0]+32).c_str()),\n            _(\"Error\"), CClientUIInterface::OK | CClientUIInterface::MODAL);\n        StartShutdown();\n        return;\n    }\n\n    const bool fUseSSL = GetBoolArg(\"-rpcssl\");\n\n    asio::io_service io_service;\n\n#if (BOOST_VERSION > 106501)\n    ssl::context context(ssl::context::sslv23);\n#else\n    ssl::context context(io_service, ssl::context::sslv23);\n#endif\n\n    if (fUseSSL)\n    {\n        context.set_options(ssl::context::no_sslv2);\n\n        filesystem::path pathCertFile(GetArg(\"-rpcsslcertificatechainfile\", \"server.cert\"));\n        if (!pathCertFile.is_complete()) pathCertFile = filesystem::path(GetDataDir()) / pathCertFile;\n        if (filesystem::exists(pathCertFile)) context.use_certificate_chain_file(pathCertFile.string());\n        else printf(\"ThreadRPCServer ERROR: missing server certificate file %s\\n\", pathCertFile.string().c_str());\n\n        filesystem::path pathPKFile(GetArg(\"-rpcsslprivatekeyfile\", \"server.pem\"));\n        if (!pathPKFile.is_complete()) pathPKFile = filesystem::path(GetDataDir()) / pathPKFile;\n        if (filesystem::exists(pathPKFile)) context.use_private_key_file(pathPKFile.string(), ssl::context::pem);\n        else printf(\"ThreadRPCServer ERROR: missing server private key file %s\\n\", pathPKFile.string().c_str());\n\n        string strCiphers = GetArg(\"-rpcsslciphers\", \"TLSv1+HIGH:!SSLv2:!aNULL:!eNULL:!AH:!3DES:@STRENGTH\");\n\n#if (BOOST_VERSION > 106501)\n        SSL_CTX_set_cipher_list(context.native_handle(), strCiphers.c_str());\n#else\n        SSL_CTX_set_cipher_list(context.impl(), strCiphers.c_str());\n#endif\n    }\n\n    // Try a dual IPv6/IPv4 socket, falling back to separate IPv4 and IPv6 sockets\n    const bool loopback = !mapArgs.count(\"-rpcallowip\");\n    asio::ip::address bindAddress = loopback ? asio::ip::address_v6::loopback() : asio::ip::address_v6::any();\n    ip::tcp::endpoint endpoint(bindAddress, GetArg(\"-rpcport\", GetDefaultRPCPort()));\n    boost::system::error_code v6_only_error;\n    boost::shared_ptr<ip::tcp::acceptor> acceptor(new ip::tcp::acceptor(io_service));\n\n    boost::signals2::signal<void ()> StopRequests;\n\n    bool fListening = false;\n    std::string strerr;\n    try\n    {\n        acceptor->open(endpoint.protocol());\n        acceptor->set_option(boost::asio::ip::tcp::acceptor::reuse_address(true));\n\n        // Try making the socket dual IPv6/IPv4 (if listening on the \"any\" address)\n        acceptor->set_option(boost::asio::ip::v6_only(loopback), v6_only_error);\n\n        acceptor->bind(endpoint);\n        acceptor->listen(socket_base::max_connections);\n\n        RPCListen(acceptor, context, fUseSSL);\n        // Cancel outstanding listen-requests for this acceptor when shutting down\n        StopRequests.connect(signals2::slot<void ()>(\n                    static_cast<void (ip::tcp::acceptor::*)()>(&ip::tcp::acceptor::close), acceptor.get())\n                .track(acceptor));\n\n        fListening = true;\n    }\n    catch(boost::system::system_error &e)\n    {\n        strerr = strprintf(_(\"An error occurred while setting up the RPC port %u for listening on IPv6, falling back to IPv4: %s\"), endpoint.port(), e.what());\n    }\n\n    try {\n        // If dual IPv6/IPv4 failed (or we're opening loopback interfaces only), open IPv4 separately\n        if (!fListening || loopback || v6_only_error)\n        {\n            bindAddress = loopback ? asio::ip::address_v4::loopback() : asio::ip::address_v4::any();\n            endpoint.address(bindAddress);\n\n            acceptor.reset(new ip::tcp::acceptor(io_service));\n            acceptor->open(endpoint.protocol());\n            acceptor->set_option(boost::asio::ip::tcp::acceptor::reuse_address(true));\n            acceptor->bind(endpoint);\n            acceptor->listen(socket_base::max_connections);\n\n            RPCListen(acceptor, context, fUseSSL);\n            // Cancel outstanding listen-requests for this acceptor when shutting down\n            StopRequests.connect(signals2::slot<void ()>(\n                        static_cast<void (ip::tcp::acceptor::*)()>(&ip::tcp::acceptor::close), acceptor.get())\n                    .track(acceptor));\n\n            fListening = true;\n        }\n    }\n    catch(boost::system::system_error &e)\n    {\n        strerr = strprintf(_(\"An error occurred while setting up the RPC port %u for listening on IPv4: %s\"), endpoint.port(), e.what());\n    }\n\n    if (!fListening) {\n        uiInterface.ThreadSafeMessageBox(strerr, _(\"Error\"), CClientUIInterface::OK | CClientUIInterface::MODAL);\n        StartShutdown();\n        return;\n    }\n\n    vnThreadsRunning[THREAD_RPCLISTENER]--;\n    while (!fShutdown)\n        io_service.run_one();\n    vnThreadsRunning[THREAD_RPCLISTENER]++;\n    StopRequests();\n}"
        }
      },
      {
        "call_info": {
          "callee": "RenameThread",
          "args": [
            "\"hal-rpclist\""
          ],
          "line": 680
        },
        "resolved": true,
        "details": {
          "function_name": "RenameThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1329-1348",
          "snippet": "void RenameThread(const char* name)\n{\n#if defined(PR_SET_NAME)\n    // Only the first 15 characters are used (16 - NUL terminator)\n    ::prctl(PR_SET_NAME, name, 0, 0, 0);\n#elif 0 && (defined(__FreeBSD__) || defined(__OpenBSD__))\n    // TODO: This is currently disabled because it needs to be verified to work\n    //       on FreeBSD or OpenBSD first. When verified the '0 &&' part can be\n    //       removed.\n    pthread_set_name_np(pthread_self(), name);\n\n// This is XCode 10.6-and-later; bring back if we drop 10.5 support:\n// #elif defined(MAC_OSX)\n//    pthread_setname_np(name);\n\n#else\n    // Prevent warnings for unused parameters...\n    (void)name;\n#endif\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvoid RenameThread(const char* name)\n{\n#if defined(PR_SET_NAME)\n    // Only the first 15 characters are used (16 - NUL terminator)\n    ::prctl(PR_SET_NAME, name, 0, 0, 0);\n#elif 0 && (defined(__FreeBSD__) || defined(__OpenBSD__))\n    // TODO: This is currently disabled because it needs to be verified to work\n    //       on FreeBSD or OpenBSD first. When verified the '0 &&' part can be\n    //       removed.\n    pthread_set_name_np(pthread_self(), name);\n\n// This is XCode 10.6-and-later; bring back if we drop 10.5 support:\n// #elif defined(MAC_OSX)\n//    pthread_setname_np(name);\n\n#else\n    // Prevent warnings for unused parameters...\n    (void)name;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\n#define printf OutputDebugStringF\n\nvoid ThreadRPCServer2(void* parg);\nvoid ThreadRPCServer3(void* parg);\n\nvoid ThreadRPCServer(void* parg)\n{\n    // Make this thread recognisable as the RPC listener\n    RenameThread(\"hal-rpclist\");\n\n    try\n    {\n        vnThreadsRunning[THREAD_RPCLISTENER]++;\n        ThreadRPCServer2(parg);\n        vnThreadsRunning[THREAD_RPCLISTENER]--;\n    }\n    catch (std::exception& e) {\n        vnThreadsRunning[THREAD_RPCLISTENER]--;\n        PrintException(&e, \"ThreadRPCServer()\");\n    } catch (...) {\n        vnThreadsRunning[THREAD_RPCLISTENER]--;\n        PrintException(NULL, \"ThreadRPCServer()\");\n    }\n    printf(\"ThreadRPCServer exited\\n\");\n}"
  },
  {
    "function_name": "close",
    "container": "AcceptedConnectionImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "664-667",
    "snippet": "virtual void close()\n    {\n        _stream.close();\n    }",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_stream.close",
          "args": [],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "close",
          "container": "AcceptedConnectionImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "664-667",
          "snippet": "virtual void close()\n    {\n        _stream.close();\n    }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nAcceptedConnectionImpl {\n  virtual void close()\n      {\n          _stream.close();\n      }\n}"
  },
  {
    "function_name": "peer_address_to_string",
    "container": "AcceptedConnectionImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "659-662",
    "snippet": "virtual std::string peer_address_to_string() const\n    {\n        return peer.address().to_string();\n    }",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "peer.address",
          "args": [],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "peer.address",
          "args": [],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nAcceptedConnectionImpl {\n  virtual std::string peer_address_to_string() const\n      {\n          return peer.address().to_string();\n      }\n}"
  },
  {
    "function_name": "AcceptedConnectionImpl",
    "container": "AcceptedConnectionImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "644-652",
    "snippet": "AcceptedConnectionImpl(\n            asio::io_service& io_service,\n            ssl::context &context,\n            bool fUseSSL) :\n        sslStream(io_service, context),\n        _d(sslStream, fUseSSL),\n        _stream(_d)\n    {\n    }",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nAcceptedConnectionImpl {\n  AcceptedConnectionImpl(\n              asio::io_service& io_service,\n              ssl::context &context,\n              bool fUseSSL) :\n          sslStream(io_service, context),\n          _d(sslStream, fUseSSL),\n          _stream(_d)\n      {\n      }\n}"
  },
  {
    "function_name": "connect",
    "container": "SSLIOStreamDevice",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "604-622",
    "snippet": "bool connect(const std::string &server, const std::string &port) {\n#if (BOOST_VERSION >= 107000)\n        ip::tcp::resolver resolver((boost::asio::io_context &)(stream.get_executor().context()));\n#else\n        ip::tcp::resolver resolver(stream.get_io_service());\n#endif\n        ip::tcp::resolver::query query(server.c_str(), port.c_str());\n        ip::tcp::resolver::iterator endpoint_iterator = resolver.resolve(query);\n        ip::tcp::resolver::iterator end;\n        boost::system::error_code error = asio::error::host_not_found;\n        while (error && endpoint_iterator != end)\n        {\n            stream.lowest_layer().close();\n            stream.lowest_layer().connect(*endpoint_iterator++, error);\n        }\n        if (error)\n            return false;\n        return true;\n    }",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stream.lowest_layer",
          "args": [
            "*endpoint_iterator++",
            "error"
          ],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream.lowest_layer",
          "args": [],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream.lowest_layer",
          "args": [],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream.lowest_layer",
          "args": [],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resolver.resolve",
          "args": [
            "query"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "port.c_str",
          "args": [],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "server.c_str",
          "args": [],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream.get_io_service",
          "args": [],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream.get_executor",
          "args": [],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream.get_executor",
          "args": [],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nSSLIOStreamDevice {\n  bool connect(const std::string &server, const std::string &port) {\n  #if (BOOST_VERSION >= 107000)\n          ip::tcp::resolver resolver((boost::asio::io_context &)(stream.get_executor().context()));\n  #else\n          ip::tcp::resolver resolver(stream.get_io_service());\n  #endif\n          ip::tcp::resolver::query query(server.c_str(), port.c_str());\n          ip::tcp::resolver::iterator endpoint_iterator = resolver.resolve(query);\n          ip::tcp::resolver::iterator end;\n          boost::system::error_code error = asio::error::host_not_found;\n          while (error && endpoint_iterator != end)\n          {\n              stream.lowest_layer().close();\n              stream.lowest_layer().connect(*endpoint_iterator++, error);\n          }\n          if (error)\n              return false;\n          return true;\n      }\n}"
  },
  {
    "function_name": "write",
    "container": "SSLIOStreamDevice",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "598-603",
    "snippet": "std::streamsize write(const char* s, std::streamsize n)\n    {\n        handshake(ssl::stream_base::client); // HTTPS clients write first\n        if (fUseSSL) return asio::write(stream, asio::buffer(s, n));\n        return asio::write(stream.next_layer(), asio::buffer(s, n));\n    }",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "asio::write",
          "args": [
            "stream.next_layer()",
            "asio::buffer(s, n)"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "SSLIOStreamDevice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "598-603",
          "snippet": "std::streamsize write(const char* s, std::streamsize n)\n    {\n        handshake(ssl::stream_base::client); // HTTPS clients write first\n        if (fUseSSL) return asio::write(stream, asio::buffer(s, n));\n        return asio::write(stream.next_layer(), asio::buffer(s, n));\n    }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "asio::buffer",
          "args": [
            "s",
            "n"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream.next_layer",
          "args": [],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asio::buffer",
          "args": [
            "s",
            "n"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "handshake",
          "args": [
            "ssl::stream_base::client"
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "handshake",
          "container": "SSLIOStreamDevice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "586-591",
          "snippet": "void handshake(ssl::stream_base::handshake_type role)\n    {\n        if (!fNeedHandshake) return;\n        fNeedHandshake = false;\n        stream.handshake(role);\n    }",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nSSLIOStreamDevice {\n  void handshake(ssl::stream_base::handshake_type role)\n      {\n          if (!fNeedHandshake) return;\n          fNeedHandshake = false;\n          stream.handshake(role);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nSSLIOStreamDevice {\n  std::streamsize write(const char* s, std::streamsize n)\n      {\n          handshake(ssl::stream_base::client); // HTTPS clients write first\n          if (fUseSSL) return asio::write(stream, asio::buffer(s, n));\n          return asio::write(stream.next_layer(), asio::buffer(s, n));\n      }\n}"
  },
  {
    "function_name": "read",
    "container": "SSLIOStreamDevice",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "592-597",
    "snippet": "std::streamsize read(char* s, std::streamsize n)\n    {\n        handshake(ssl::stream_base::server); // HTTPS servers read first\n        if (fUseSSL) return stream.read_some(asio::buffer(s, n));\n        return stream.next_layer().read_some(asio::buffer(s, n));\n    }",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stream.next_layer",
          "args": [
            "asio::buffer(s, n)"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asio::buffer",
          "args": [
            "s",
            "n"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream.next_layer",
          "args": [],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream.read_some",
          "args": [
            "asio::buffer(s, n)"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asio::buffer",
          "args": [
            "s",
            "n"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "handshake",
          "args": [
            "ssl::stream_base::server"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "handshake",
          "container": "SSLIOStreamDevice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "586-591",
          "snippet": "void handshake(ssl::stream_base::handshake_type role)\n    {\n        if (!fNeedHandshake) return;\n        fNeedHandshake = false;\n        stream.handshake(role);\n    }",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nSSLIOStreamDevice {\n  void handshake(ssl::stream_base::handshake_type role)\n      {\n          if (!fNeedHandshake) return;\n          fNeedHandshake = false;\n          stream.handshake(role);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nSSLIOStreamDevice {\n  std::streamsize read(char* s, std::streamsize n)\n      {\n          handshake(ssl::stream_base::server); // HTTPS servers read first\n          if (fUseSSL) return stream.read_some(asio::buffer(s, n));\n          return stream.next_layer().read_some(asio::buffer(s, n));\n      }\n}"
  },
  {
    "function_name": "handshake",
    "container": "SSLIOStreamDevice",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "586-591",
    "snippet": "void handshake(ssl::stream_base::handshake_type role)\n    {\n        if (!fNeedHandshake) return;\n        fNeedHandshake = false;\n        stream.handshake(role);\n    }",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stream.handshake",
          "args": [
            "role"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "handshake",
          "container": "SSLIOStreamDevice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "586-591",
          "snippet": "void handshake(ssl::stream_base::handshake_type role)\n    {\n        if (!fNeedHandshake) return;\n        fNeedHandshake = false;\n        stream.handshake(role);\n    }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nSSLIOStreamDevice {\n  void handshake(ssl::stream_base::handshake_type role)\n      {\n          if (!fNeedHandshake) return;\n          fNeedHandshake = false;\n          stream.handshake(role);\n      }\n}"
  },
  {
    "function_name": "SSLIOStreamDevice",
    "container": "SSLIOStreamDevice",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "580-584",
    "snippet": "SSLIOStreamDevice(asio::ssl::stream<typename Protocol::socket> &streamIn, bool fUseSSLIn) : stream(streamIn)\n    {\n        fUseSSL = fUseSSLIn;\n        fNeedHandshake = fUseSSLIn;\n    }",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nSSLIOStreamDevice {\n  SSLIOStreamDevice(asio::ssl::stream<typename Protocol::socket> &streamIn, bool fUseSSLIn) : stream(streamIn)\n      {\n          fUseSSL = fUseSSLIn;\n          fNeedHandshake = fUseSSLIn;\n      }\n}"
  },
  {
    "function_name": "ClientAllowed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "551-572",
    "snippet": "bool ClientAllowed(const boost::asio::ip::address& address)\n{\n    // Make sure that IPv4-compatible and IPv4-mapped IPv6 addresses are treated as IPv4 addresses\n    if (address.is_v6()\n     && (address.to_v6().is_v4_compatible()\n      || address.to_v6().is_v4_mapped()))\n        return ClientAllowed(address.to_v6().to_v4());\n\n    if (address == asio::ip::address_v4::loopback()\n     || address == asio::ip::address_v6::loopback()\n     || (address.is_v4()\n         // Check whether IPv4 addresses match 127.0.0.0/8 (loopback subnet)\n      && (address.to_v4().to_ulong() & 0xff000000) == 0x7f000000))\n        return true;\n\n    const string strAddress = address.to_string();\n    const vector<string>& vAllow = mapMultiArgs[\"-rpcallowip\"];\n    BOOST_FOREACH(string strAllow, vAllow)\n        if (WildcardMatch(strAddress, strAllow))\n            return true;\n    return false;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WildcardMatch",
          "args": [
            "strAddress",
            "strAllow"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "WildcardMatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "949-952",
          "snippet": "bool WildcardMatch(const string& str, const string& mask)\n{\n    return WildcardMatch(str.c_str(), mask.c_str());\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool WildcardMatch(const string& str, const string& mask)\n{\n    return WildcardMatch(str.c_str(), mask.c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "address.to_string",
          "args": [],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "address.to_v4",
          "args": [],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "address.to_v4",
          "args": [],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "address.is_v4",
          "args": [],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asio::ip::address_v6::loopback",
          "args": [],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asio::ip::address_v4::loopback",
          "args": [],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ClientAllowed",
          "args": [
            "address.to_v6().to_v4()"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "ClientAllowed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "551-572",
          "snippet": "bool ClientAllowed(const boost::asio::ip::address& address)\n{\n    // Make sure that IPv4-compatible and IPv4-mapped IPv6 addresses are treated as IPv4 addresses\n    if (address.is_v6()\n     && (address.to_v6().is_v4_compatible()\n      || address.to_v6().is_v4_mapped()))\n        return ClientAllowed(address.to_v6().to_v4());\n\n    if (address == asio::ip::address_v4::loopback()\n     || address == asio::ip::address_v6::loopback()\n     || (address.is_v4()\n         // Check whether IPv4 addresses match 127.0.0.0/8 (loopback subnet)\n      && (address.to_v4().to_ulong() & 0xff000000) == 0x7f000000))\n        return true;\n\n    const string strAddress = address.to_string();\n    const vector<string>& vAllow = mapMultiArgs[\"-rpcallowip\"];\n    BOOST_FOREACH(string strAllow, vAllow)\n        if (WildcardMatch(strAddress, strAllow))\n            return true;\n    return false;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "address.to_v6",
          "args": [],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "address.to_v6",
          "args": [],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "address.to_v6",
          "args": [],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "address.to_v6",
          "args": [],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "address.to_v6",
          "args": [],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "address.to_v6",
          "args": [],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "address.is_v6",
          "args": [],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nbool ClientAllowed(const boost::asio::ip::address& address)\n{\n    // Make sure that IPv4-compatible and IPv4-mapped IPv6 addresses are treated as IPv4 addresses\n    if (address.is_v6()\n     && (address.to_v6().is_v4_compatible()\n      || address.to_v6().is_v4_mapped()))\n        return ClientAllowed(address.to_v6().to_v4());\n\n    if (address == asio::ip::address_v4::loopback()\n     || address == asio::ip::address_v6::loopback()\n     || (address.is_v4()\n         // Check whether IPv4 addresses match 127.0.0.0/8 (loopback subnet)\n      && (address.to_v4().to_ulong() & 0xff000000) == 0x7f000000))\n        return true;\n\n    const string strAddress = address.to_string();\n    const vector<string>& vAllow = mapMultiArgs[\"-rpcallowip\"];\n    BOOST_FOREACH(string strAllow, vAllow)\n        if (WildcardMatch(strAddress, strAllow))\n            return true;\n    return false;\n}"
  },
  {
    "function_name": "ErrorReply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "540-549",
    "snippet": "void ErrorReply(std::ostream& stream, const Object& objError, const Value& id)\n{\n    // Send error reply from json-rpc error object\n    int nStatus = HTTP_INTERNAL_SERVER_ERROR;\n    int code = find_value(objError, \"code\").get_int();\n    if (code == RPC_INVALID_REQUEST) nStatus = HTTP_BAD_REQUEST;\n    else if (code == RPC_METHOD_NOT_FOUND) nStatus = HTTP_NOT_FOUND;\n    string strReply = JSONRPCReply(Value::null, objError, id);\n    stream << HTTPReply(nStatus, strReply, false) << std::flush;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HTTPReply",
          "args": [
            "nStatus",
            "strReply",
            "false"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "HTTPReply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "374-416",
          "snippet": "static string HTTPReply(int nStatus, const string& strMsg, bool keepalive)\n{\n    if (nStatus == HTTP_UNAUTHORIZED)\n        return strprintf(\"HTTP/1.0 401 Authorization Required\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"WWW-Authenticate: Basic realm=\\\"jsonrpc\\\"\\r\\n\"\n            \"Content-Type: text/html\\r\\n\"\n            \"Content-Length: 296\\r\\n\"\n            \"\\r\\n\"\n            \"<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\"\\r\\n\"\n            \"\\\"http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd\\\">\\r\\n\"\n            \"<HTML>\\r\\n\"\n            \"<HEAD>\\r\\n\"\n            \"<TITLE>Error</TITLE>\\r\\n\"\n            \"<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=ISO-8859-1'>\\r\\n\"\n            \"</HEAD>\\r\\n\"\n            \"<BODY><H1>401 Unauthorized.</H1></BODY>\\r\\n\"\n            \"</HTML>\\r\\n\", rfc1123Time().c_str(), FormatFullVersion().c_str());\n    const char *cStatus;\n         if (nStatus == HTTP_OK) cStatus = \"OK\";\n    else if (nStatus == HTTP_BAD_REQUEST) cStatus = \"Bad Request\";\n    else if (nStatus == HTTP_FORBIDDEN) cStatus = \"Forbidden\";\n    else if (nStatus == HTTP_NOT_FOUND) cStatus = \"Not Found\";\n    else if (nStatus == HTTP_INTERNAL_SERVER_ERROR) cStatus = \"Internal Server Error\";\n    else cStatus = \"\";\n    return strprintf(\n            \"HTTP/1.1 %d %s\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Connection: %s\\r\\n\"\n            \"Content-Length: %\"PRIszu\"\\r\\n\"\n            \"Content-Type: application/json\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"\\r\\n\"\n            \"%s\",\n        nStatus,\n        cStatus,\n        rfc1123Time().c_str(),\n        keepalive ? \"keep-alive\" : \"close\",\n        strMsg.size(),\n        FormatFullVersion().c_str(),\n        strMsg.c_str());\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic string HTTPReply(int nStatus, const string& strMsg, bool keepalive)\n{\n    if (nStatus == HTTP_UNAUTHORIZED)\n        return strprintf(\"HTTP/1.0 401 Authorization Required\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"WWW-Authenticate: Basic realm=\\\"jsonrpc\\\"\\r\\n\"\n            \"Content-Type: text/html\\r\\n\"\n            \"Content-Length: 296\\r\\n\"\n            \"\\r\\n\"\n            \"<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\"\\r\\n\"\n            \"\\\"http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd\\\">\\r\\n\"\n            \"<HTML>\\r\\n\"\n            \"<HEAD>\\r\\n\"\n            \"<TITLE>Error</TITLE>\\r\\n\"\n            \"<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=ISO-8859-1'>\\r\\n\"\n            \"</HEAD>\\r\\n\"\n            \"<BODY><H1>401 Unauthorized.</H1></BODY>\\r\\n\"\n            \"</HTML>\\r\\n\", rfc1123Time().c_str(), FormatFullVersion().c_str());\n    const char *cStatus;\n         if (nStatus == HTTP_OK) cStatus = \"OK\";\n    else if (nStatus == HTTP_BAD_REQUEST) cStatus = \"Bad Request\";\n    else if (nStatus == HTTP_FORBIDDEN) cStatus = \"Forbidden\";\n    else if (nStatus == HTTP_NOT_FOUND) cStatus = \"Not Found\";\n    else if (nStatus == HTTP_INTERNAL_SERVER_ERROR) cStatus = \"Internal Server Error\";\n    else cStatus = \"\";\n    return strprintf(\n            \"HTTP/1.1 %d %s\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Connection: %s\\r\\n\"\n            \"Content-Length: %\"PRIszu\"\\r\\n\"\n            \"Content-Type: application/json\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"\\r\\n\"\n            \"%s\",\n        nStatus,\n        cStatus,\n        rfc1123Time().c_str(),\n        keepalive ? \"keep-alive\" : \"close\",\n        strMsg.size(),\n        FormatFullVersion().c_str(),\n        strMsg.c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "JSONRPCReply",
          "args": [
            "Value::null",
            "objError",
            "id"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCReply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "534-538",
          "snippet": "string JSONRPCReply(const Value& result, const Value& error, const Value& id)\n{\n    Object reply = JSONRPCReplyObj(result, error, id);\n    return write_string(Value(reply), false) + \"\\n\";\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstring JSONRPCReply(const Value& result, const Value& error, const Value& id)\n{\n    Object reply = JSONRPCReplyObj(result, error, id);\n    return write_string(Value(reply), false) + \"\\n\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [
            "objError",
            "\"code\""
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nvoid ErrorReply(std::ostream& stream, const Object& objError, const Value& id)\n{\n    // Send error reply from json-rpc error object\n    int nStatus = HTTP_INTERNAL_SERVER_ERROR;\n    int code = find_value(objError, \"code\").get_int();\n    if (code == RPC_INVALID_REQUEST) nStatus = HTTP_BAD_REQUEST;\n    else if (code == RPC_METHOD_NOT_FOUND) nStatus = HTTP_NOT_FOUND;\n    string strReply = JSONRPCReply(Value::null, objError, id);\n    stream << HTTPReply(nStatus, strReply, false) << std::flush;\n}"
  },
  {
    "function_name": "JSONRPCReply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "534-538",
    "snippet": "string JSONRPCReply(const Value& result, const Value& error, const Value& id)\n{\n    Object reply = JSONRPCReplyObj(result, error, id);\n    return write_string(Value(reply), false) + \"\\n\";\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_string",
          "args": [
            "Value(reply)",
            "false"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "write_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "234-243",
          "snippet": "typename Value_type::String_type write_string( const Value_type& value, bool pretty )\n    {\n        typedef typename Value_type::String_type::value_type Char_type;\n\n        std::basic_ostringstream< Char_type > os;\n\n        write_stream( value, os, pretty );\n\n        return os.str();\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\ntypename Value_type::String_type write_string( const Value_type& value, bool pretty )\n    {\n        typedef typename Value_type::String_type::value_type Char_type;\n\n        std::basic_ostringstream< Char_type > os;\n\n        write_stream( value, os, pretty );\n\n        return os.str();\n    }"
        }
      },
      {
        "call_info": {
          "callee": "Value",
          "args": [
            "reply"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "ValueFromAmount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "113-116",
          "snippet": "Value ValueFromAmount(int64_t amount)\n{\n    return (double)amount / (double)COIN;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nValue ValueFromAmount(int64_t amount)\n{\n    return (double)amount / (double)COIN;\n}"
        }
      },
      {
        "call_info": {
          "callee": "JSONRPCReplyObj",
          "args": [
            "result",
            "error",
            "id"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCReplyObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "522-532",
          "snippet": "Object JSONRPCReplyObj(const Value& result, const Value& error, const Value& id)\n{\n    Object reply;\n    if (error.type() != null_type)\n        reply.push_back(Pair(\"result\", Value::null));\n    else\n        reply.push_back(Pair(\"result\", result));\n    reply.push_back(Pair(\"error\", error));\n    reply.push_back(Pair(\"id\", id));\n    return reply;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject JSONRPCReplyObj(const Value& result, const Value& error, const Value& id)\n{\n    Object reply;\n    if (error.type() != null_type)\n        reply.push_back(Pair(\"result\", Value::null));\n    else\n        reply.push_back(Pair(\"result\", result));\n    reply.push_back(Pair(\"error\", error));\n    reply.push_back(Pair(\"id\", id));\n    return reply;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstring JSONRPCReply(const Value& result, const Value& error, const Value& id)\n{\n    Object reply = JSONRPCReplyObj(result, error, id);\n    return write_string(Value(reply), false) + \"\\n\";\n}"
  },
  {
    "function_name": "JSONRPCReplyObj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "522-532",
    "snippet": "Object JSONRPCReplyObj(const Value& result, const Value& error, const Value& id)\n{\n    Object reply;\n    if (error.type() != null_type)\n        reply.push_back(Pair(\"result\", Value::null));\n    else\n        reply.push_back(Pair(\"result\", result));\n    reply.push_back(Pair(\"error\", error));\n    reply.push_back(Pair(\"id\", id));\n    return reply;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reply.push_back",
          "args": [
            "Pair(\"id\", id)"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Pair",
          "args": [
            "\"id\"",
            "id"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "Pair_impl",
          "container": "Pair_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "439-443",
          "snippet": "Pair_impl< Config >::Pair_impl( const String_type& name, const Value_type& value )\n    :   name_( name )\n    ,   value_( value )\n    {\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nPair_impl< Config > {\n  Pair_impl< Config >::Pair_impl( const String_type& name, const Value_type& value )\n      :   name_( name )\n      ,   value_( value )\n      {\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reply.push_back",
          "args": [
            "Pair(\"error\", error)"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.push_back",
          "args": [
            "Pair(\"result\", result)"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.push_back",
          "args": [
            "Pair(\"result\", Value::null)"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error.type",
          "args": [],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject JSONRPCReplyObj(const Value& result, const Value& error, const Value& id)\n{\n    Object reply;\n    if (error.type() != null_type)\n        reply.push_back(Pair(\"result\", Value::null));\n    else\n        reply.push_back(Pair(\"result\", result));\n    reply.push_back(Pair(\"error\", error));\n    reply.push_back(Pair(\"id\", id));\n    return reply;\n}"
  },
  {
    "function_name": "JSONRPCRequest",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "513-520",
    "snippet": "string JSONRPCRequest(const string& strMethod, const Array& params, const Value& id)\n{\n    Object request;\n    request.push_back(Pair(\"method\", strMethod));\n    request.push_back(Pair(\"params\", params));\n    request.push_back(Pair(\"id\", id));\n    return write_string(Value(request), false) + \"\\n\";\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_string",
          "args": [
            "Value(request)",
            "false"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "write_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "234-243",
          "snippet": "typename Value_type::String_type write_string( const Value_type& value, bool pretty )\n    {\n        typedef typename Value_type::String_type::value_type Char_type;\n\n        std::basic_ostringstream< Char_type > os;\n\n        write_stream( value, os, pretty );\n\n        return os.str();\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\ntypename Value_type::String_type write_string( const Value_type& value, bool pretty )\n    {\n        typedef typename Value_type::String_type::value_type Char_type;\n\n        std::basic_ostringstream< Char_type > os;\n\n        write_stream( value, os, pretty );\n\n        return os.str();\n    }"
        }
      },
      {
        "call_info": {
          "callee": "Value",
          "args": [
            "request"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "ValueFromAmount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "113-116",
          "snippet": "Value ValueFromAmount(int64_t amount)\n{\n    return (double)amount / (double)COIN;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nValue ValueFromAmount(int64_t amount)\n{\n    return (double)amount / (double)COIN;\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.push_back",
          "args": [
            "Pair(\"id\", id)"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Pair",
          "args": [
            "\"id\"",
            "id"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "Pair_impl",
          "container": "Pair_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "439-443",
          "snippet": "Pair_impl< Config >::Pair_impl( const String_type& name, const Value_type& value )\n    :   name_( name )\n    ,   value_( value )\n    {\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nPair_impl< Config > {\n  Pair_impl< Config >::Pair_impl( const String_type& name, const Value_type& value )\n      :   name_( name )\n      ,   value_( value )\n      {\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.push_back",
          "args": [
            "Pair(\"params\", params)"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.push_back",
          "args": [
            "Pair(\"method\", strMethod)"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstring JSONRPCRequest(const string& strMethod, const Array& params, const Value& id)\n{\n    Object request;\n    request.push_back(Pair(\"method\", strMethod));\n    request.push_back(Pair(\"params\", params));\n    request.push_back(Pair(\"id\", id));\n    return write_string(Value(request), false) + \"\\n\";\n}"
  },
  {
    "function_name": "HTTPAuthorized",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "493-501",
    "snippet": "bool HTTPAuthorized(map<string, string>& mapHeaders)\n{\n    string strAuth = mapHeaders[\"authorization\"];\n    if (strAuth.substr(0,6) != \"Basic \")\n        return false;\n    string strUserPass64 = strAuth.substr(6); boost::trim(strUserPass64);\n    string strUserPass = DecodeBase64(strUserPass64);\n    return TimingResistantEqual(strUserPass, strRPCUserColonPass);\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static std::string strRPCUserColonPass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "TimingResistantEqual",
          "args": [
            "strUserPass",
            "strRPCUserColonPass"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "TimingResistantEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "569-576",
          "snippet": "bool TimingResistantEqual(const T& a, const T& b)\n{\n    if (b.size() == 0) return a.size() == 0;\n    size_t accumulator = a.size() ^ b.size();\n    for (size_t i = 0; i < a.size(); i++)\n        accumulator |= a[i] ^ b[i%b.size()];\n    return accumulator == 0;\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nbool TimingResistantEqual(const T& a, const T& b)\n{\n    if (b.size() == 0) return a.size() == 0;\n    size_t accumulator = a.size() ^ b.size();\n    for (size_t i = 0; i < a.size(); i++)\n        accumulator |= a[i] ^ b[i%b.size()];\n    return accumulator == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DecodeBase64",
          "args": [
            "strUserPass64"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeBase64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "731-735",
          "snippet": "string DecodeBase64(const string& str)\n{\n    vector<unsigned char> vchRet = DecodeBase64(str.c_str());\n    return string((const char*)&vchRet[0], vchRet.size());\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring DecodeBase64(const string& str)\n{\n    vector<unsigned char> vchRet = DecodeBase64(str.c_str());\n    return string((const char*)&vchRet[0], vchRet.size());\n}"
        }
      },
      {
        "call_info": {
          "callee": "boost::trim",
          "args": [
            "strUserPass64"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strAuth.substr",
          "args": [
            "6"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strAuth.substr",
          "args": [
            "0",
            "6"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic std::string strRPCUserColonPass;\n\nbool HTTPAuthorized(map<string, string>& mapHeaders)\n{\n    string strAuth = mapHeaders[\"authorization\"];\n    if (strAuth.substr(0,6) != \"Basic \")\n        return false;\n    string strUserPass64 = strAuth.substr(6); boost::trim(strUserPass64);\n    string strUserPass = DecodeBase64(strUserPass64);\n    return TimingResistantEqual(strUserPass, strRPCUserColonPass);\n}"
  },
  {
    "function_name": "ReadHTTP",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "458-491",
    "snippet": "int ReadHTTP(std::basic_istream<char>& stream, map<string, string>& mapHeadersRet, string& strMessageRet)\n{\n    mapHeadersRet.clear();\n    strMessageRet = \"\";\n\n    // Read status\n    int nProto = 0;\n    int nStatus = ReadHTTPStatus(stream, nProto);\n\n    // Read header\n    int nLen = ReadHTTPHeader(stream, mapHeadersRet);\n    if (nLen < 0 || nLen > (int)MAX_SIZE)\n        return HTTP_INTERNAL_SERVER_ERROR;\n\n    // Read message\n    if (nLen > 0)\n    {\n        vector<char> vch(nLen);\n        stream.read(&vch[0], nLen);\n        strMessageRet = string(vch.begin(), vch.end());\n    }\n\n    string sConHdr = mapHeadersRet[\"connection\"];\n\n    if ((sConHdr != \"close\") && (sConHdr != \"keep-alive\"))\n    {\n        if (nProto >= 1)\n            mapHeadersRet[\"connection\"] = \"keep-alive\";\n        else\n            mapHeadersRet[\"connection\"] = \"close\";\n    }\n\n    return nStatus;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "string",
          "args": [
            "vch.begin()",
            "vch.end()"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "read_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_reader_template.h",
          "lines": "586-591",
          "snippet": "bool read_string( const String_type& s, Value_type& value )\n    {\n        typename String_type::const_iterator begin = s.begin();\n\n        return read_range( begin, s.end(), value );\n    }",
          "includes": [
            "#include <boost/spirit/iterator/position_iterator.hpp>",
            "#include <boost/spirit/iterator/multi_pass.hpp>",
            "#include <boost/spirit/utility/escape_char.hpp>",
            "#include <boost/spirit/utility/confix.hpp>",
            "#include <boost/spirit/core.hpp>",
            "#include <boost/spirit/include/classic_position_iterator.hpp>",
            "#include <boost/spirit/include/classic_multi_pass.hpp>",
            "#include <boost/spirit/include/classic_escape_char.hpp>",
            "#include <boost/spirit/include/classic_confix.hpp>",
            "#include <boost/spirit/include/classic_core.hpp>",
            "#include <boost/version.hpp>",
            "#include <boost/function.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include \"json_spirit_error_position.h\"",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/spirit/iterator/position_iterator.hpp>\n#include <boost/spirit/iterator/multi_pass.hpp>\n#include <boost/spirit/utility/escape_char.hpp>\n#include <boost/spirit/utility/confix.hpp>\n#include <boost/spirit/core.hpp>\n#include <boost/spirit/include/classic_position_iterator.hpp>\n#include <boost/spirit/include/classic_multi_pass.hpp>\n#include <boost/spirit/include/classic_escape_char.hpp>\n#include <boost/spirit/include/classic_confix.hpp>\n#include <boost/spirit/include/classic_core.hpp>\n#include <boost/version.hpp>\n#include <boost/function.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include \"json_spirit_error_position.h\"\n#include \"json_spirit_value.h\"\n\nbool read_string( const String_type& s, Value_type& value )\n    {\n        typename String_type::const_iterator begin = s.begin();\n\n        return read_range( begin, s.end(), value );\n    }"
        }
      },
      {
        "call_info": {
          "callee": "vch.end",
          "args": [],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vch.begin",
          "args": [],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "stream.read",
          "args": [
            "&vch[0]",
            "nLen"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "read",
          "container": "SSLIOStreamDevice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "592-597",
          "snippet": "std::streamsize read(char* s, std::streamsize n)\n    {\n        handshake(ssl::stream_base::server); // HTTPS servers read first\n        if (fUseSSL) return stream.read_some(asio::buffer(s, n));\n        return stream.next_layer().read_some(asio::buffer(s, n));\n    }",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nSSLIOStreamDevice {\n  std::streamsize read(char* s, std::streamsize n)\n      {\n          handshake(ssl::stream_base::server); // HTTPS servers read first\n          if (fUseSSL) return stream.read_some(asio::buffer(s, n));\n          return stream.next_layer().read_some(asio::buffer(s, n));\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ReadHTTPHeader",
          "args": [
            "stream",
            "mapHeadersRet"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "ReadHTTPHeader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "433-456",
          "snippet": "int ReadHTTPHeader(std::basic_istream<char>& stream, map<string, string>& mapHeadersRet)\n{\n    int nLen = 0;\n    while (true)\n    {\n        string str;\n        std::getline(stream, str);\n        if (str.empty() || str == \"\\r\")\n            break;\n        string::size_type nColon = str.find(\":\");\n        if (nColon != string::npos)\n        {\n            string strHeader = str.substr(0, nColon);\n            boost::trim(strHeader);\n            boost::to_lower(strHeader);\n            string strValue = str.substr(nColon+1);\n            boost::trim(strValue);\n            mapHeadersRet[strHeader] = strValue;\n            if (strHeader == \"content-length\")\n                nLen = atoi(strValue.c_str());\n        }\n    }\n    return nLen;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nint ReadHTTPHeader(std::basic_istream<char>& stream, map<string, string>& mapHeadersRet)\n{\n    int nLen = 0;\n    while (true)\n    {\n        string str;\n        std::getline(stream, str);\n        if (str.empty() || str == \"\\r\")\n            break;\n        string::size_type nColon = str.find(\":\");\n        if (nColon != string::npos)\n        {\n            string strHeader = str.substr(0, nColon);\n            boost::trim(strHeader);\n            boost::to_lower(strHeader);\n            string strValue = str.substr(nColon+1);\n            boost::trim(strValue);\n            mapHeadersRet[strHeader] = strValue;\n            if (strHeader == \"content-length\")\n                nLen = atoi(strValue.c_str());\n        }\n    }\n    return nLen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ReadHTTPStatus",
          "args": [
            "stream",
            "nProto"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "ReadHTTPStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "418-431",
          "snippet": "int ReadHTTPStatus(std::basic_istream<char>& stream, int &proto)\n{\n    string str;\n    getline(stream, str);\n    vector<string> vWords;\n    boost::split(vWords, str, boost::is_any_of(\" \"));\n    if (vWords.size() < 2)\n        return HTTP_INTERNAL_SERVER_ERROR;\n    proto = 0;\n    const char *ver = strstr(str.c_str(), \"HTTP/1.\");\n    if (ver != NULL)\n        proto = atoi(ver+7);\n    return atoi(vWords[1].c_str());\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nint ReadHTTPStatus(std::basic_istream<char>& stream, int &proto)\n{\n    string str;\n    getline(stream, str);\n    vector<string> vWords;\n    boost::split(vWords, str, boost::is_any_of(\" \"));\n    if (vWords.size() < 2)\n        return HTTP_INTERNAL_SERVER_ERROR;\n    proto = 0;\n    const char *ver = strstr(str.c_str(), \"HTTP/1.\");\n    if (ver != NULL)\n        proto = atoi(ver+7);\n    return atoi(vWords[1].c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapHeadersRet.clear",
          "args": [],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nint ReadHTTP(std::basic_istream<char>& stream, map<string, string>& mapHeadersRet, string& strMessageRet)\n{\n    mapHeadersRet.clear();\n    strMessageRet = \"\";\n\n    // Read status\n    int nProto = 0;\n    int nStatus = ReadHTTPStatus(stream, nProto);\n\n    // Read header\n    int nLen = ReadHTTPHeader(stream, mapHeadersRet);\n    if (nLen < 0 || nLen > (int)MAX_SIZE)\n        return HTTP_INTERNAL_SERVER_ERROR;\n\n    // Read message\n    if (nLen > 0)\n    {\n        vector<char> vch(nLen);\n        stream.read(&vch[0], nLen);\n        strMessageRet = string(vch.begin(), vch.end());\n    }\n\n    string sConHdr = mapHeadersRet[\"connection\"];\n\n    if ((sConHdr != \"close\") && (sConHdr != \"keep-alive\"))\n    {\n        if (nProto >= 1)\n            mapHeadersRet[\"connection\"] = \"keep-alive\";\n        else\n            mapHeadersRet[\"connection\"] = \"close\";\n    }\n\n    return nStatus;\n}"
  },
  {
    "function_name": "ReadHTTPHeader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "433-456",
    "snippet": "int ReadHTTPHeader(std::basic_istream<char>& stream, map<string, string>& mapHeadersRet)\n{\n    int nLen = 0;\n    while (true)\n    {\n        string str;\n        std::getline(stream, str);\n        if (str.empty() || str == \"\\r\")\n            break;\n        string::size_type nColon = str.find(\":\");\n        if (nColon != string::npos)\n        {\n            string strHeader = str.substr(0, nColon);\n            boost::trim(strHeader);\n            boost::to_lower(strHeader);\n            string strValue = str.substr(nColon+1);\n            boost::trim(strValue);\n            mapHeadersRet[strHeader] = strValue;\n            if (strHeader == \"content-length\")\n                nLen = atoi(strValue.c_str());\n        }\n    }\n    return nLen;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "strValue.c_str()"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "atoi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "292-295",
          "snippet": "inline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "strValue.c_str",
          "args": [],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::trim",
          "args": [
            "strValue"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.substr",
          "args": [
            "nColon+1"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::to_lower",
          "args": [
            "strHeader"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::trim",
          "args": [
            "strHeader"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.substr",
          "args": [
            "0",
            "nColon"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.find",
          "args": [
            "\":\""
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.empty",
          "args": [],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::getline",
          "args": [
            "stream",
            "str"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nint ReadHTTPHeader(std::basic_istream<char>& stream, map<string, string>& mapHeadersRet)\n{\n    int nLen = 0;\n    while (true)\n    {\n        string str;\n        std::getline(stream, str);\n        if (str.empty() || str == \"\\r\")\n            break;\n        string::size_type nColon = str.find(\":\");\n        if (nColon != string::npos)\n        {\n            string strHeader = str.substr(0, nColon);\n            boost::trim(strHeader);\n            boost::to_lower(strHeader);\n            string strValue = str.substr(nColon+1);\n            boost::trim(strValue);\n            mapHeadersRet[strHeader] = strValue;\n            if (strHeader == \"content-length\")\n                nLen = atoi(strValue.c_str());\n        }\n    }\n    return nLen;\n}"
  },
  {
    "function_name": "ReadHTTPStatus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "418-431",
    "snippet": "int ReadHTTPStatus(std::basic_istream<char>& stream, int &proto)\n{\n    string str;\n    getline(stream, str);\n    vector<string> vWords;\n    boost::split(vWords, str, boost::is_any_of(\" \"));\n    if (vWords.size() < 2)\n        return HTTP_INTERNAL_SERVER_ERROR;\n    proto = 0;\n    const char *ver = strstr(str.c_str(), \"HTTP/1.\");\n    if (ver != NULL)\n        proto = atoi(ver+7);\n    return atoi(vWords[1].c_str());\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "vWords[1].c_str()"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "atoi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "292-295",
          "snippet": "inline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "vWords[1].c_str",
          "args": [],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "str.c_str()",
            "\"HTTP/1.\""
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vWords.size",
          "args": [],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "boost::split",
          "args": [
            "vWords",
            "str",
            "boost::is_any_of(\" \")"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::is_any_of",
          "args": [
            "\" \""
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getline",
          "args": [
            "stream",
            "str"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nint ReadHTTPStatus(std::basic_istream<char>& stream, int &proto)\n{\n    string str;\n    getline(stream, str);\n    vector<string> vWords;\n    boost::split(vWords, str, boost::is_any_of(\" \"));\n    if (vWords.size() < 2)\n        return HTTP_INTERNAL_SERVER_ERROR;\n    proto = 0;\n    const char *ver = strstr(str.c_str(), \"HTTP/1.\");\n    if (ver != NULL)\n        proto = atoi(ver+7);\n    return atoi(vWords[1].c_str());\n}"
  },
  {
    "function_name": "HTTPReply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "374-416",
    "snippet": "static string HTTPReply(int nStatus, const string& strMsg, bool keepalive)\n{\n    if (nStatus == HTTP_UNAUTHORIZED)\n        return strprintf(\"HTTP/1.0 401 Authorization Required\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"WWW-Authenticate: Basic realm=\\\"jsonrpc\\\"\\r\\n\"\n            \"Content-Type: text/html\\r\\n\"\n            \"Content-Length: 296\\r\\n\"\n            \"\\r\\n\"\n            \"<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\"\\r\\n\"\n            \"\\\"http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd\\\">\\r\\n\"\n            \"<HTML>\\r\\n\"\n            \"<HEAD>\\r\\n\"\n            \"<TITLE>Error</TITLE>\\r\\n\"\n            \"<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=ISO-8859-1'>\\r\\n\"\n            \"</HEAD>\\r\\n\"\n            \"<BODY><H1>401 Unauthorized.</H1></BODY>\\r\\n\"\n            \"</HTML>\\r\\n\", rfc1123Time().c_str(), FormatFullVersion().c_str());\n    const char *cStatus;\n         if (nStatus == HTTP_OK) cStatus = \"OK\";\n    else if (nStatus == HTTP_BAD_REQUEST) cStatus = \"Bad Request\";\n    else if (nStatus == HTTP_FORBIDDEN) cStatus = \"Forbidden\";\n    else if (nStatus == HTTP_NOT_FOUND) cStatus = \"Not Found\";\n    else if (nStatus == HTTP_INTERNAL_SERVER_ERROR) cStatus = \"Internal Server Error\";\n    else cStatus = \"\";\n    return strprintf(\n            \"HTTP/1.1 %d %s\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Connection: %s\\r\\n\"\n            \"Content-Length: %\"PRIszu\"\\r\\n\"\n            \"Content-Type: application/json\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"\\r\\n\"\n            \"%s\",\n        nStatus,\n        cStatus,\n        rfc1123Time().c_str(),\n        keepalive ? \"keep-alive\" : \"close\",\n        strMsg.size(),\n        FormatFullVersion().c_str(),\n        strMsg.c_str());\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"HTTP/1.1 %d %s\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Connection: %s\\r\\n\"\n            \"Content-Length: %\"PRIszu\"\\r\\n\"\n            \"Content-Type: application/json\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"\\r\\n\"\n            \"%s\"",
            "nStatus",
            "cStatus",
            "rfc1123Time().c_str()",
            "keepalive ? \"keep-alive\" : \"close\"",
            "strMsg.size()",
            "FormatFullVersion().c_str()",
            "strMsg.c_str()"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strMsg.c_str",
          "args": [],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatFullVersion",
          "args": [],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "FormatFullVersion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1288-1291",
          "snippet": "string FormatFullVersion()\n{\n    return CLIENT_BUILD;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring FormatFullVersion()\n{\n    return CLIENT_BUILD;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strMsg.size",
          "args": [],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rfc1123Time",
          "args": [],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "rfc1123Time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "361-372",
          "snippet": "string rfc1123Time()\n{\n    char buffer[64];\n    time_t now;\n    time(&now);\n    struct tm* now_gmt = gmtime(&now);\n    string locale(setlocale(LC_TIME, NULL));\n    setlocale(LC_TIME, \"C\"); // we want POSIX (aka \"C\") weekday/month strings\n    strftime(buffer, sizeof(buffer), \"%a, %d %b %Y %H:%M:%S +0000\", now_gmt);\n    setlocale(LC_TIME, locale.c_str());\n    return string(buffer);\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstring rfc1123Time()\n{\n    char buffer[64];\n    time_t now;\n    time(&now);\n    struct tm* now_gmt = gmtime(&now);\n    string locale(setlocale(LC_TIME, NULL));\n    setlocale(LC_TIME, \"C\"); // we want POSIX (aka \"C\") weekday/month strings\n    strftime(buffer, sizeof(buffer), \"%a, %d %b %Y %H:%M:%S +0000\", now_gmt);\n    setlocale(LC_TIME, locale.c_str());\n    return string(buffer);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"HTTP/1.0 401 Authorization Required\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"WWW-Authenticate: Basic realm=\\\"jsonrpc\\\"\\r\\n\"\n            \"Content-Type: text/html\\r\\n\"\n            \"Content-Length: 296\\r\\n\"\n            \"\\r\\n\"\n            \"<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\"\\r\\n\"\n            \"\\\"http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd\\\">\\r\\n\"\n            \"<HTML>\\r\\n\"\n            \"<HEAD>\\r\\n\"\n            \"<TITLE>Error</TITLE>\\r\\n\"\n            \"<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=ISO-8859-1'>\\r\\n\"\n            \"</HEAD>\\r\\n\"\n            \"<BODY><H1>401 Unauthorized.</H1></BODY>\\r\\n\"\n            \"</HTML>\\r\\n\"",
            "rfc1123Time().c_str()",
            "FormatFullVersion().c_str()"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic string HTTPReply(int nStatus, const string& strMsg, bool keepalive)\n{\n    if (nStatus == HTTP_UNAUTHORIZED)\n        return strprintf(\"HTTP/1.0 401 Authorization Required\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"WWW-Authenticate: Basic realm=\\\"jsonrpc\\\"\\r\\n\"\n            \"Content-Type: text/html\\r\\n\"\n            \"Content-Length: 296\\r\\n\"\n            \"\\r\\n\"\n            \"<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\"\\r\\n\"\n            \"\\\"http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd\\\">\\r\\n\"\n            \"<HTML>\\r\\n\"\n            \"<HEAD>\\r\\n\"\n            \"<TITLE>Error</TITLE>\\r\\n\"\n            \"<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=ISO-8859-1'>\\r\\n\"\n            \"</HEAD>\\r\\n\"\n            \"<BODY><H1>401 Unauthorized.</H1></BODY>\\r\\n\"\n            \"</HTML>\\r\\n\", rfc1123Time().c_str(), FormatFullVersion().c_str());\n    const char *cStatus;\n         if (nStatus == HTTP_OK) cStatus = \"OK\";\n    else if (nStatus == HTTP_BAD_REQUEST) cStatus = \"Bad Request\";\n    else if (nStatus == HTTP_FORBIDDEN) cStatus = \"Forbidden\";\n    else if (nStatus == HTTP_NOT_FOUND) cStatus = \"Not Found\";\n    else if (nStatus == HTTP_INTERNAL_SERVER_ERROR) cStatus = \"Internal Server Error\";\n    else cStatus = \"\";\n    return strprintf(\n            \"HTTP/1.1 %d %s\\r\\n\"\n            \"Date: %s\\r\\n\"\n            \"Connection: %s\\r\\n\"\n            \"Content-Length: %\"PRIszu\"\\r\\n\"\n            \"Content-Type: application/json\\r\\n\"\n            \"Server: halcyon-json-rpc/%s\\r\\n\"\n            \"\\r\\n\"\n            \"%s\",\n        nStatus,\n        cStatus,\n        rfc1123Time().c_str(),\n        keepalive ? \"keep-alive\" : \"close\",\n        strMsg.size(),\n        FormatFullVersion().c_str(),\n        strMsg.c_str());\n}"
  },
  {
    "function_name": "rfc1123Time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "361-372",
    "snippet": "string rfc1123Time()\n{\n    char buffer[64];\n    time_t now;\n    time(&now);\n    struct tm* now_gmt = gmtime(&now);\n    string locale(setlocale(LC_TIME, NULL));\n    setlocale(LC_TIME, \"C\"); // we want POSIX (aka \"C\") weekday/month strings\n    strftime(buffer, sizeof(buffer), \"%a, %d %b %Y %H:%M:%S +0000\", now_gmt);\n    setlocale(LC_TIME, locale.c_str());\n    return string(buffer);\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "string",
          "args": [
            "buffer"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "non_printable_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "29-41",
          "snippet": "String_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "setlocale",
          "args": [
            "LC_TIME",
            "locale.c_str()"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locale.c_str",
          "args": [],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strftime",
          "args": [
            "buffer",
            "sizeof(buffer)",
            "\"%a, %d %b %Y %H:%M:%S +0000\"",
            "now_gmt"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setlocale",
          "args": [
            "LC_TIME",
            "\"C\""
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gmtime",
          "args": [
            "&now"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&now"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "pt_to_time_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/rpcdump.cpp",
          "lines": "38-43",
          "snippet": "std::time_t pt_to_time_t(const bt::ptime& pt)\n{\n    bt::ptime timet_start(boost::gregorian::date(1970,1,1));\n    bt::time_duration diff = pt - timet_start;\n    return diff.ticks()/bt::time_duration::rep_type::ticks_per_second;\n}",
          "includes": [
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/variant/get.hpp>",
            "#include <boost/date_time/posix_time/posix_time.hpp>",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"init.h\" // for pwalletMain",
            "#include <fstream>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string.hpp>\n#include <boost/variant/get.hpp>\n#include <boost/date_time/posix_time/posix_time.hpp>\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"bitcoinrpc.h\"\n#include \"init.h\" // for pwalletMain\n#include <fstream>\n#include <iostream>\n\nstd::time_t pt_to_time_t(const bt::ptime& pt)\n{\n    bt::ptime timet_start(boost::gregorian::date(1970,1,1));\n    bt::time_duration diff = pt - timet_start;\n    return diff.ticks()/bt::time_duration::rep_type::ticks_per_second;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstring rfc1123Time()\n{\n    char buffer[64];\n    time_t now;\n    time(&now);\n    struct tm* now_gmt = gmtime(&now);\n    string locale(setlocale(LC_TIME, NULL));\n    setlocale(LC_TIME, \"C\"); // we want POSIX (aka \"C\") weekday/month strings\n    strftime(buffer, sizeof(buffer), \"%a, %d %b %Y %H:%M:%S +0000\", now_gmt);\n    setlocale(LC_TIME, locale.c_str());\n    return string(buffer);\n}"
  },
  {
    "function_name": "HTTPPost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "344-359",
    "snippet": "string HTTPPost(const string& strMsg, const map<string,string>& mapRequestHeaders)\n{\n    ostringstream s;\n    s << \"POST / HTTP/1.1\\r\\n\"\n      << \"User-Agent: halcyon-json-rpc/\" << FormatFullVersion() << \"\\r\\n\"\n      << \"Host: 127.0.0.1\\r\\n\"\n      << \"Content-Type: application/json\\r\\n\"\n      << \"Content-Length: \" << strMsg.size() << \"\\r\\n\"\n      << \"Connection: close\\r\\n\"\n      << \"Accept: application/json\\r\\n\";\n    BOOST_FOREACH(const PAIRTYPE(string, string)& item, mapRequestHeaders)\n        s << item.first << \": \" << item.second << \"\\r\\n\";\n    s << \"\\r\\n\" << strMsg;\n\n    return s.str();\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s.str",
          "args": [],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "789-792",
          "snippet": "std::string str() const\n    {\n        return (std::string(begin(), end()));\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  std::string str() const\n      {\n          return (std::string(begin(), end()));\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strMsg.size",
          "args": [],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FormatFullVersion",
          "args": [],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "FormatFullVersion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1288-1291",
          "snippet": "string FormatFullVersion()\n{\n    return CLIENT_BUILD;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring FormatFullVersion()\n{\n    return CLIENT_BUILD;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstring HTTPPost(const string& strMsg, const map<string,string>& mapRequestHeaders)\n{\n    ostringstream s;\n    s << \"POST / HTTP/1.1\\r\\n\"\n      << \"User-Agent: halcyon-json-rpc/\" << FormatFullVersion() << \"\\r\\n\"\n      << \"Host: 127.0.0.1\\r\\n\"\n      << \"Content-Type: application/json\\r\\n\"\n      << \"Content-Length: \" << strMsg.size() << \"\\r\\n\"\n      << \"Connection: close\\r\\n\"\n      << \"Accept: application/json\\r\\n\";\n    BOOST_FOREACH(const PAIRTYPE(string, string)& item, mapRequestHeaders)\n        s << item.first << \": \" << item.second << \"\\r\\n\";\n    s << \"\\r\\n\" << strMsg;\n\n    return s.str();\n}"
  },
  {
    "function_name": "CRPCTable",
    "container": "CRPCTable",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "317-327",
    "snippet": "CRPCTable::CRPCTable()\n{\n    unsigned int vcidx;\n    for (vcidx = 0; vcidx < (sizeof(vRPCCommands) / sizeof(vRPCCommands[0])); vcidx++)\n    {\n        const CRPCCommand *pcmd;\n\n        pcmd = &vRPCCommands[vcidx];\n        mapCommands[pcmd->name] = pcmd;\n    }\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const CRPCCommand vRPCCommands[] =\n{ //  name                      function                 safemd  unlocked\n  //  ------------------------  -----------------------  ------  --------\n    { \"help\",                   &help,                   true,   true },\n    { \"stop\",                   &stop,                   true,   true },\n    { \"getbestblockhash\",       &getbestblockhash,       true,   false },\n    { \"getblockcount\",          &getblockcount,          true,   false },\n    { \"getconnectioncount\",     &getconnectioncount,     true,   false },\n    { \"getpeerinfo\",            &getpeerinfo,            true,   false },\n    { \"addnode\",                &addnode,                true,   true  },\n    { \"getdifficulty\",          &getdifficulty,          true,   false },\n    { \"getinfo\",                &getinfo,                true,   false },\n    { \"getmininginfo\",          &getmininginfo,          true,   false },\n    { \"getstakinginfo\",         &getstakinginfo,         true,   false },\n    { \"getnewaddress\",          &getnewaddress,          true,   false },\n    { \"getnewpubkey\",           &getnewpubkey,           true,   false },\n    { \"getaccountaddress\",      &getaccountaddress,      true,   false },\n    { \"setaccount\",             &setaccount,             true,   false },\n    { \"getaccount\",             &getaccount,             false,  false },\n    { \"getaddressesbyaccount\",  &getaddressesbyaccount,  true,   false },\n    { \"sendtoaddress\",          &sendtoaddress,          false,  false },\n    { \"getreceivedbyaddress\",   &getreceivedbyaddress,   false,  false },\n    { \"getreceivedbyaccount\",   &getreceivedbyaccount,   false,  false },\n    { \"listreceivedbyaddress\",  &listreceivedbyaddress,  false,  false },\n    { \"listreceivedbyaccount\",  &listreceivedbyaccount,  false,  false },\n    { \"backupwallet\",           &backupwallet,           true,   false },\n    { \"keypoolrefill\",          &keypoolrefill,          true,   false },\n    { \"walletpassphrase\",       &walletpassphrase,       true,   false },\n    { \"walletpassphrasechange\", &walletpassphrasechange, false,  false },\n    { \"walletlock\",             &walletlock,             true,   false },\n    { \"encryptwallet\",          &encryptwallet,          false,  false },\n    { \"validateaddress\",        &validateaddress,        true,   false },\n    { \"validatepubkey\",         &validatepubkey,         true,   false },\n    { \"getbalance\",             &getbalance,             false,  false },\n    { \"move\",                   &movecmd,                false,  false },\n    { \"sendfrom\",               &sendfrom,               false,  false },\n    { \"sendmany\",               &sendmany,               false,  false },\n    { \"addmultisigaddress\",     &addmultisigaddress,     false,  false },\n    { \"addredeemscript\",        &addredeemscript,        false,  false },\n    { \"getrawmempool\",          &getrawmempool,          true,   false },\n    { \"getblock\",               &getblock,               false,  false },\n    { \"getblockbynumber\",       &getblockbynumber,       false,  false },\n    { \"getblockhash\",           &getblockhash,           false,  false },\n    { \"gettransaction\",         &gettransaction,         false,  false },\n    { \"listtransactions\",       &listtransactions,       false,  false },\n    { \"listaddressgroupings\",   &listaddressgroupings,   false,  false },\n    { \"signmessage\",            &signmessage,            false,  false },\n    { \"verifymessage\",          &verifymessage,          false,  false },\n    { \"getwork\",                &getwork,                true,   false },\n    { \"listaccounts\",           &listaccounts,           false,  false },\n    { \"settxfee\",               &settxfee,               false,  false },\n    { \"getblocktemplate\",       &getblocktemplate,       true,   false },\n    { \"submitblock\",            &submitblock,            false,  false },\n    { \"listsinceblock\",         &listsinceblock,         false,  false },\n    { \"dumpprivkey\",            &dumpprivkey,            false,  false },\n    { \"dumpwallet\",             &dumpwallet,             true,   false },\n    { \"importwallet\",           &importwallet,           false,  false },\n    { \"importprivkey\",          &importprivkey,          false,  false },\n    { \"listunspent\",            &listunspent,            false,  false },\n    { \"getrawtransaction\",      &getrawtransaction,      false,  false },\n    { \"createrawtransaction\",   &createrawtransaction,   false,  false },\n    { \"decoderawtransaction\",   &decoderawtransaction,   false,  false },\n    { \"decodescript\",           &decodescript,           false,  false },\n    { \"signrawtransaction\",     &signrawtransaction,     false,  false },\n    { \"sendrawtransaction\",     &sendrawtransaction,     false,  false },\n    { \"getcheckpoint\",          &getcheckpoint,          true,   false },\n    { \"reservebalance\",         &reservebalance,         false,  true},\n    { \"checkwallet\",            &checkwallet,            false,  true},\n    { \"repairwallet\",           &repairwallet,           false,  true},\n    { \"resendtx\",               &resendtx,               false,  true},\n    { \"makekeypair\",            &makekeypair,            false,  true},\n    { \"sendalert\",              &sendalert,              false,  false},\n    { \"ntptime\",                &ntptime,                true,   true  },\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic const CRPCCommand vRPCCommands[] =\n{ //  name                      function                 safemd  unlocked\n  //  ------------------------  -----------------------  ------  --------\n    { \"help\",                   &help,                   true,   true },\n    { \"stop\",                   &stop,                   true,   true },\n    { \"getbestblockhash\",       &getbestblockhash,       true,   false },\n    { \"getblockcount\",          &getblockcount,          true,   false },\n    { \"getconnectioncount\",     &getconnectioncount,     true,   false },\n    { \"getpeerinfo\",            &getpeerinfo,            true,   false },\n    { \"addnode\",                &addnode,                true,   true  },\n    { \"getdifficulty\",          &getdifficulty,          true,   false },\n    { \"getinfo\",                &getinfo,                true,   false },\n    { \"getmininginfo\",          &getmininginfo,          true,   false },\n    { \"getstakinginfo\",         &getstakinginfo,         true,   false },\n    { \"getnewaddress\",          &getnewaddress,          true,   false },\n    { \"getnewpubkey\",           &getnewpubkey,           true,   false },\n    { \"getaccountaddress\",      &getaccountaddress,      true,   false },\n    { \"setaccount\",             &setaccount,             true,   false },\n    { \"getaccount\",             &getaccount,             false,  false },\n    { \"getaddressesbyaccount\",  &getaddressesbyaccount,  true,   false },\n    { \"sendtoaddress\",          &sendtoaddress,          false,  false },\n    { \"getreceivedbyaddress\",   &getreceivedbyaddress,   false,  false },\n    { \"getreceivedbyaccount\",   &getreceivedbyaccount,   false,  false },\n    { \"listreceivedbyaddress\",  &listreceivedbyaddress,  false,  false },\n    { \"listreceivedbyaccount\",  &listreceivedbyaccount,  false,  false },\n    { \"backupwallet\",           &backupwallet,           true,   false },\n    { \"keypoolrefill\",          &keypoolrefill,          true,   false },\n    { \"walletpassphrase\",       &walletpassphrase,       true,   false },\n    { \"walletpassphrasechange\", &walletpassphrasechange, false,  false },\n    { \"walletlock\",             &walletlock,             true,   false },\n    { \"encryptwallet\",          &encryptwallet,          false,  false },\n    { \"validateaddress\",        &validateaddress,        true,   false },\n    { \"validatepubkey\",         &validatepubkey,         true,   false },\n    { \"getbalance\",             &getbalance,             false,  false },\n    { \"move\",                   &movecmd,                false,  false },\n    { \"sendfrom\",               &sendfrom,               false,  false },\n    { \"sendmany\",               &sendmany,               false,  false },\n    { \"addmultisigaddress\",     &addmultisigaddress,     false,  false },\n    { \"addredeemscript\",        &addredeemscript,        false,  false },\n    { \"getrawmempool\",          &getrawmempool,          true,   false },\n    { \"getblock\",               &getblock,               false,  false },\n    { \"getblockbynumber\",       &getblockbynumber,       false,  false },\n    { \"getblockhash\",           &getblockhash,           false,  false },\n    { \"gettransaction\",         &gettransaction,         false,  false },\n    { \"listtransactions\",       &listtransactions,       false,  false },\n    { \"listaddressgroupings\",   &listaddressgroupings,   false,  false },\n    { \"signmessage\",            &signmessage,            false,  false },\n    { \"verifymessage\",          &verifymessage,          false,  false },\n    { \"getwork\",                &getwork,                true,   false },\n    { \"listaccounts\",           &listaccounts,           false,  false },\n    { \"settxfee\",               &settxfee,               false,  false },\n    { \"getblocktemplate\",       &getblocktemplate,       true,   false },\n    { \"submitblock\",            &submitblock,            false,  false },\n    { \"listsinceblock\",         &listsinceblock,         false,  false },\n    { \"dumpprivkey\",            &dumpprivkey,            false,  false },\n    { \"dumpwallet\",             &dumpwallet,             true,   false },\n    { \"importwallet\",           &importwallet,           false,  false },\n    { \"importprivkey\",          &importprivkey,          false,  false },\n    { \"listunspent\",            &listunspent,            false,  false },\n    { \"getrawtransaction\",      &getrawtransaction,      false,  false },\n    { \"createrawtransaction\",   &createrawtransaction,   false,  false },\n    { \"decoderawtransaction\",   &decoderawtransaction,   false,  false },\n    { \"decodescript\",           &decodescript,           false,  false },\n    { \"signrawtransaction\",     &signrawtransaction,     false,  false },\n    { \"sendrawtransaction\",     &sendrawtransaction,     false,  false },\n    { \"getcheckpoint\",          &getcheckpoint,          true,   false },\n    { \"reservebalance\",         &reservebalance,         false,  true},\n    { \"checkwallet\",            &checkwallet,            false,  true},\n    { \"repairwallet\",           &repairwallet,           false,  true},\n    { \"resendtx\",               &resendtx,               false,  true},\n    { \"makekeypair\",            &makekeypair,            false,  true},\n    { \"sendalert\",              &sendalert,              false,  false},\n    { \"ntptime\",                &ntptime,                true,   true  },\n};\n\nCRPCTable {\n  CRPCTable::CRPCTable()\n  {\n      unsigned int vcidx;\n      for (vcidx = 0; vcidx < (sizeof(vRPCCommands) / sizeof(vRPCCommands[0])); vcidx++)\n      {\n          const CRPCCommand *pcmd;\n  \n          pcmd = &vRPCCommands[vcidx];\n          mapCommands[pcmd->name] = pcmd;\n      }\n  }\n}"
  },
  {
    "function_name": "stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "221-233",
    "snippet": "Value stop(const Array& params, bool fHelp)\n{\n    if (fHelp || params.size() > 1)\n        throw runtime_error(\n            \"stop <detach>\\n\"\n            \"<detach> is true or false to detach the database or not for this stop only\\n\"\n            \"Stop Halcyon server (and possibly override the detachdb config value).\");\n    // Shutdown will take long enough that the response should get back\n    if (params.size() > 0)\n        bitdb.SetDetach(params[0].get_bool());\n    StartShutdown();\n    return \"Halcyon server stopping\";\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "StartShutdown",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "StartShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/init.cpp",
          "lines": "52-61",
          "snippet": "void StartShutdown()\n{\n#ifdef QT_GUI\n    // ensure we leave the Qt main loop for a clean GUI exit (Shutdown() is called in bitcoin.cpp afterwards)\n    uiInterface.QueueShutdown();\n#else\n    // Without UI, Shutdown() can simply be started in a new thread\n    NewThread(Shutdown, NULL);\n#endif\n}",
          "includes": [
            "#include <signal.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/algorithm/string/predicate.hpp>",
            "#include <boost/interprocess/sync/file_lock.hpp>",
            "#include <boost/filesystem/convenience.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"checkpoints.h\"",
            "#include \"ui_interface.h\"",
            "#include \"util.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"walletdb.h\"",
            "#include \"txdb.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "CClientUIInterface uiInterface;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <signal.h>\n#include <openssl/crypto.h>\n#include <boost/algorithm/string/predicate.hpp>\n#include <boost/interprocess/sync/file_lock.hpp>\n#include <boost/filesystem/convenience.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"checkpoints.h\"\n#include \"ui_interface.h\"\n#include \"util.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"bitcoinrpc.h\"\n#include \"walletdb.h\"\n#include \"txdb.h\"\n\nCClientUIInterface uiInterface;\n\nvoid StartShutdown()\n{\n#ifdef QT_GUI\n    // ensure we leave the Qt main loop for a clean GUI exit (Shutdown() is called in bitcoin.cpp afterwards)\n    uiInterface.QueueShutdown();\n#else\n    // Without UI, Shutdown() can simply be started in a new thread\n    NewThread(Shutdown, NULL);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "bitdb.SetDetach",
          "args": [
            "params[0].get_bool()"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "SetDetach",
          "container": "CDBEnv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
          "lines": "77-77",
          "snippet": "void SetDetach(bool fDetachDB_) { fDetachDB = fDetachDB_; }",
          "includes": [
            "#include <db_cxx.h>",
            "#include <vector>",
            "#include <string>",
            "#include <map>",
            "#include \"main.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDBEnv {\n  void SetDetach(bool fDetachDB_) { fDetachDB = fDetachDB_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "params[0].get_bool",
          "args": [],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "get_bool",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "377-382",
          "snippet": "bool Value_impl< Config >::get_bool() const\n    {\n        check_type(  bool_type );\n\n        return boost::get< bool >( v_ );\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  bool Value_impl< Config >::get_bool() const\n      {\n          check_type(  bool_type );\n  \n          return boost::get< bool >( v_ );\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "params.size",
          "args": [],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "runtime_error",
          "args": [
            "\"stop <detach>\\n\"\n            \"<detach> is true or false to detach the database or not for this stop only\\n\"\n            \"Stop Halcyon server (and possibly override the detachdb config value).\""
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nValue stop(const Array& params, bool fHelp)\n{\n    if (fHelp || params.size() > 1)\n        throw runtime_error(\n            \"stop <detach>\\n\"\n            \"<detach> is true or false to detach the database or not for this stop only\\n\"\n            \"Stop Halcyon server (and possibly override the detachdb config value).\");\n    // Shutdown will take long enough that the response should get back\n    if (params.size() > 0)\n        bitdb.SetDetach(params[0].get_bool());\n    StartShutdown();\n    return \"Halcyon server stopping\";\n}"
  },
  {
    "function_name": "help",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "206-218",
    "snippet": "Value help(const Array& params, bool fHelp)\n{\n    if (fHelp || params.size() > 1)\n        throw runtime_error(\n            \"help [command]\\n\"\n            \"List commands, or get help for a command.\");\n\n    string strCommand;\n    if (params.size() > 0)\n        strCommand = params[0].get_str();\n\n    return tableRPC.help(strCommand);\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tableRPC.help",
          "args": [
            "strCommand"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "help",
          "container": "CRPCTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "170-204",
          "snippet": "string CRPCTable::help(string strCommand) const\n{\n    string strRet;\n    set<rpcfn_type> setDone;\n    for (map<string, const CRPCCommand*>::const_iterator mi = mapCommands.begin(); mi != mapCommands.end(); ++mi)\n    {\n        const CRPCCommand *pcmd = mi->second;\n        string strMethod = mi->first;\n        // We already filter duplicates, but these deprecated screw up the sort order\n        if (strMethod.find(\"label\") != string::npos)\n            continue;\n        if (strCommand != \"\" && strMethod != strCommand)\n            continue;\n        try\n        {\n            Array params;\n            rpcfn_type pfn = pcmd->actor;\n            if (setDone.insert(pfn).second)\n                (*pfn)(params, true);\n        }\n        catch (std::exception& e)\n        {\n            // Help text is returned in an exception\n            string strHelp = string(e.what());\n            if (strCommand == \"\")\n                if (strHelp.find('\\n') != string::npos)\n                    strHelp = strHelp.substr(0, strHelp.find('\\n'));\n            strRet += strHelp + \"\\n\";\n        }\n    }\n    if (strRet == \"\")\n        strRet = strprintf(\"help: unknown command: %s\\n\", strCommand.c_str());\n    strRet = strRet.substr(0,strRet.size()-1);\n    return strRet;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nCRPCTable {\n  string CRPCTable::help(string strCommand) const\n  {\n      string strRet;\n      set<rpcfn_type> setDone;\n      for (map<string, const CRPCCommand*>::const_iterator mi = mapCommands.begin(); mi != mapCommands.end(); ++mi)\n      {\n          const CRPCCommand *pcmd = mi->second;\n          string strMethod = mi->first;\n          // We already filter duplicates, but these deprecated screw up the sort order\n          if (strMethod.find(\"label\") != string::npos)\n              continue;\n          if (strCommand != \"\" && strMethod != strCommand)\n              continue;\n          try\n          {\n              Array params;\n              rpcfn_type pfn = pcmd->actor;\n              if (setDone.insert(pfn).second)\n                  (*pfn)(params, true);\n          }\n          catch (std::exception& e)\n          {\n              // Help text is returned in an exception\n              string strHelp = string(e.what());\n              if (strCommand == \"\")\n                  if (strHelp.find('\\n') != string::npos)\n                      strHelp = strHelp.substr(0, strHelp.find('\\n'));\n              strRet += strHelp + \"\\n\";\n          }\n      }\n      if (strRet == \"\")\n          strRet = strprintf(\"help: unknown command: %s\\n\", strCommand.c_str());\n      strRet = strRet.substr(0,strRet.size()-1);\n      return strRet;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "params[0].get_str",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.size",
          "args": [],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "runtime_error",
          "args": [
            "\"help [command]\\n\"\n            \"List commands, or get help for a command.\""
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nValue help(const Array& params, bool fHelp)\n{\n    if (fHelp || params.size() > 1)\n        throw runtime_error(\n            \"help [command]\\n\"\n            \"List commands, or get help for a command.\");\n\n    string strCommand;\n    if (params.size() > 0)\n        strCommand = params[0].get_str();\n\n    return tableRPC.help(strCommand);\n}"
  },
  {
    "function_name": "help",
    "container": "CRPCTable",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "170-204",
    "snippet": "string CRPCTable::help(string strCommand) const\n{\n    string strRet;\n    set<rpcfn_type> setDone;\n    for (map<string, const CRPCCommand*>::const_iterator mi = mapCommands.begin(); mi != mapCommands.end(); ++mi)\n    {\n        const CRPCCommand *pcmd = mi->second;\n        string strMethod = mi->first;\n        // We already filter duplicates, but these deprecated screw up the sort order\n        if (strMethod.find(\"label\") != string::npos)\n            continue;\n        if (strCommand != \"\" && strMethod != strCommand)\n            continue;\n        try\n        {\n            Array params;\n            rpcfn_type pfn = pcmd->actor;\n            if (setDone.insert(pfn).second)\n                (*pfn)(params, true);\n        }\n        catch (std::exception& e)\n        {\n            // Help text is returned in an exception\n            string strHelp = string(e.what());\n            if (strCommand == \"\")\n                if (strHelp.find('\\n') != string::npos)\n                    strHelp = strHelp.substr(0, strHelp.find('\\n'));\n            strRet += strHelp + \"\\n\";\n        }\n    }\n    if (strRet == \"\")\n        strRet = strprintf(\"help: unknown command: %s\\n\", strCommand.c_str());\n    strRet = strRet.substr(0,strRet.size()-1);\n    return strRet;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strRet.substr",
          "args": [
            "0",
            "strRet.size()-1"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strRet.size",
          "args": [],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"help: unknown command: %s\\n\"",
            "strCommand.c_str()"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strCommand.c_str",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strHelp.substr",
          "args": [
            "0",
            "strHelp.find('\\n')"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strHelp.find",
          "args": [
            "'\\n'"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "string",
          "args": [
            "e.what()"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "non_printable_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "29-41",
          "snippet": "String_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "params",
            "true"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setDone.insert",
          "args": [
            "pfn"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "61-65",
          "snippet": "void CBloomFilter::insert(const uint256& hash)\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    insert(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  void CBloomFilter::insert(const uint256& hash)\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      insert(data);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapCommands.end",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapCommands.begin",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nCRPCTable {\n  string CRPCTable::help(string strCommand) const\n  {\n      string strRet;\n      set<rpcfn_type> setDone;\n      for (map<string, const CRPCCommand*>::const_iterator mi = mapCommands.begin(); mi != mapCommands.end(); ++mi)\n      {\n          const CRPCCommand *pcmd = mi->second;\n          string strMethod = mi->first;\n          // We already filter duplicates, but these deprecated screw up the sort order\n          if (strMethod.find(\"label\") != string::npos)\n              continue;\n          if (strCommand != \"\" && strMethod != strCommand)\n              continue;\n          try\n          {\n              Array params;\n              rpcfn_type pfn = pcmd->actor;\n              if (setDone.insert(pfn).second)\n                  (*pfn)(params, true);\n          }\n          catch (std::exception& e)\n          {\n              // Help text is returned in an exception\n              string strHelp = string(e.what());\n              if (strCommand == \"\")\n                  if (strHelp.find('\\n') != string::npos)\n                      strHelp = strHelp.substr(0, strHelp.find('\\n'));\n              strRet += strHelp + \"\\n\";\n          }\n      }\n      if (strRet == \"\")\n          strRet = strprintf(\"help: unknown command: %s\\n\", strCommand.c_str());\n      strRet = strRet.substr(0,strRet.size()-1);\n      return strRet;\n  }\n}"
  },
  {
    "function_name": "ParseHexO",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "160-163",
    "snippet": "vector<unsigned char> ParseHexO(const Object& o, string strKey)\n{\n    return ParseHexV(find_value(o, strKey), strKey);\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ParseHexV",
          "args": [
            "find_value(o, strKey)",
            "strKey"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "ParseHexV",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "150-158",
          "snippet": "vector<unsigned char> ParseHexV(const Value& v, string strName)\n{\n    string strHex;\n    if (v.type() == str_type)\n        strHex = v.get_str();\n    if (!IsHex(strHex))\n        throw JSONRPCError(RPC_INVALID_PARAMETER, strName+\" must be hexadecimal string (not '\"+strHex+\"')\");\n    return ParseHex(strHex);\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nvector<unsigned char> ParseHexV(const Value& v, string strName)\n{\n    string strHex;\n    if (v.type() == str_type)\n        strHex = v.get_str();\n    if (!IsHex(strHex))\n        throw JSONRPCError(RPC_INVALID_PARAMETER, strName+\" must be hexadecimal string (not '\"+strHex+\"')\");\n    return ParseHex(strHex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [
            "o",
            "strKey"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nvector<unsigned char> ParseHexO(const Object& o, string strKey)\n{\n    return ParseHexV(find_value(o, strKey), strKey);\n}"
  },
  {
    "function_name": "ParseHexV",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "150-158",
    "snippet": "vector<unsigned char> ParseHexV(const Value& v, string strName)\n{\n    string strHex;\n    if (v.type() == str_type)\n        strHex = v.get_str();\n    if (!IsHex(strHex))\n        throw JSONRPCError(RPC_INVALID_PARAMETER, strName+\" must be hexadecimal string (not '\"+strHex+\"')\");\n    return ParseHex(strHex);\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ParseHex",
          "args": [
            "strHex"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "ParseHex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "490-493",
          "snippet": "vector<unsigned char> ParseHex(const string& str)\n{\n    return ParseHex(str.c_str());\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvector<unsigned char> ParseHex(const string& str)\n{\n    return ParseHex(str.c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "JSONRPCError",
          "args": [
            "RPC_INVALID_PARAMETER",
            "strName+\" must be hexadecimal string (not '\"+strHex+\"')\""
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "54-60",
          "snippet": "Object JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsHex",
          "args": [
            "strHex"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "IsHex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "459-467",
          "snippet": "bool IsHex(const string& str)\n{\n    BOOST_FOREACH(unsigned char c, str)\n    {\n        if (phexdigit[c] < 0)\n            return false;\n    }\n    return (str.size() > 0) && (str.size()%2 == 0);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const signed char phexdigit[256] =\n{ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic const signed char phexdigit[256] =\n{ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, };\n\nbool IsHex(const string& str)\n{\n    BOOST_FOREACH(unsigned char c, str)\n    {\n        if (phexdigit[c] < 0)\n            return false;\n    }\n    return (str.size() > 0) && (str.size()%2 == 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "v.get_str",
          "args": [],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.type",
          "args": [],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nvector<unsigned char> ParseHexV(const Value& v, string strName)\n{\n    string strHex;\n    if (v.type() == str_type)\n        strHex = v.get_str();\n    if (!IsHex(strHex))\n        throw JSONRPCError(RPC_INVALID_PARAMETER, strName+\" must be hexadecimal string (not '\"+strHex+\"')\");\n    return ParseHex(strHex);\n}"
  },
  {
    "function_name": "ParseHashO",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "145-148",
    "snippet": "uint256 ParseHashO(const Object& o, string strKey)\n{\n    return ParseHashV(find_value(o, strKey), strKey);\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ParseHashV",
          "args": [
            "find_value(o, strKey)",
            "strKey"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "ParseHashV",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "133-143",
          "snippet": "uint256 ParseHashV(const Value& v, string strName)\n{\n    string strHex;\n    if (v.type() == str_type)\n        strHex = v.get_str();\n    if (!IsHex(strHex)) // Note: IsHex(\"\") is false\n        throw JSONRPCError(RPC_INVALID_PARAMETER, strName+\" must be hexadecimal string (not '\"+strHex+\"')\");\n    uint256 result;\n    result.SetHex(strHex);\n    return result;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nuint256 ParseHashV(const Value& v, string strName)\n{\n    string strHex;\n    if (v.type() == str_type)\n        strHex = v.get_str();\n    if (!IsHex(strHex)) // Note: IsHex(\"\") is false\n        throw JSONRPCError(RPC_INVALID_PARAMETER, strName+\" must be hexadecimal string (not '\"+strHex+\"')\");\n    uint256 result;\n    result.SetHex(strHex);\n    return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [
            "o",
            "strKey"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nuint256 ParseHashO(const Object& o, string strKey)\n{\n    return ParseHashV(find_value(o, strKey), strKey);\n}"
  },
  {
    "function_name": "ParseHashV",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "133-143",
    "snippet": "uint256 ParseHashV(const Value& v, string strName)\n{\n    string strHex;\n    if (v.type() == str_type)\n        strHex = v.get_str();\n    if (!IsHex(strHex)) // Note: IsHex(\"\") is false\n        throw JSONRPCError(RPC_INVALID_PARAMETER, strName+\" must be hexadecimal string (not '\"+strHex+\"')\");\n    uint256 result;\n    result.SetHex(strHex);\n    return result;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result.SetHex",
          "args": [
            "strHex"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "SetHex",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "346-374",
          "snippet": "void SetHex(const std::string& str)\n    {\n        // skip 0x\n        const char* psz = str.c_str();\n        while (isspace(*psz))\n            psz++;\n        bool fNegative = false;\n        if (*psz == '-')\n        {\n            fNegative = true;\n            psz++;\n        }\n        if (psz[0] == '0' && tolower(psz[1]) == 'x')\n            psz += 2;\n        while (isspace(*psz))\n            psz++;\n\n        // hex string to bignum\n        static const signed char phexdigit[256] = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0 };\n        *this = 0;\n        while (isxdigit(*psz))\n        {\n            *this <<= 4;\n            int n = phexdigit[(unsigned char)*psz++];\n            *this += n;\n        }\n        if (fNegative)\n            *this = 0 - *this;\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void SetHex(const std::string& str)\n      {\n          // skip 0x\n          const char* psz = str.c_str();\n          while (isspace(*psz))\n              psz++;\n          bool fNegative = false;\n          if (*psz == '-')\n          {\n              fNegative = true;\n              psz++;\n          }\n          if (psz[0] == '0' && tolower(psz[1]) == 'x')\n              psz += 2;\n          while (isspace(*psz))\n              psz++;\n  \n          // hex string to bignum\n          static const signed char phexdigit[256] = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0 };\n          *this = 0;\n          while (isxdigit(*psz))\n          {\n              *this <<= 4;\n              int n = phexdigit[(unsigned char)*psz++];\n              *this += n;\n          }\n          if (fNegative)\n              *this = 0 - *this;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "JSONRPCError",
          "args": [
            "RPC_INVALID_PARAMETER",
            "strName+\" must be hexadecimal string (not '\"+strHex+\"')\""
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "54-60",
          "snippet": "Object JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsHex",
          "args": [
            "strHex"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "IsHex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "459-467",
          "snippet": "bool IsHex(const string& str)\n{\n    BOOST_FOREACH(unsigned char c, str)\n    {\n        if (phexdigit[c] < 0)\n            return false;\n    }\n    return (str.size() > 0) && (str.size()%2 == 0);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const signed char phexdigit[256] =\n{ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstatic const signed char phexdigit[256] =\n{ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,0xa,0xb,0xc,0xd,0xe,0xf,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,\n  -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, };\n\nbool IsHex(const string& str)\n{\n    BOOST_FOREACH(unsigned char c, str)\n    {\n        if (phexdigit[c] < 0)\n            return false;\n    }\n    return (str.size() > 0) && (str.size()%2 == 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "v.get_str",
          "args": [],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.type",
          "args": [],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nuint256 ParseHashV(const Value& v, string strName)\n{\n    string strHex;\n    if (v.type() == str_type)\n        strHex = v.get_str();\n    if (!IsHex(strHex)) // Note: IsHex(\"\") is false\n        throw JSONRPCError(RPC_INVALID_PARAMETER, strName+\" must be hexadecimal string (not '\"+strHex+\"')\");\n    uint256 result;\n    result.SetHex(strHex);\n    return result;\n}"
  },
  {
    "function_name": "HexBits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "118-126",
    "snippet": "std::string HexBits(unsigned int nBits)\n{\n    union {\n        int32_t nBits;\n        char cBits[4];\n    } uBits;\n    uBits.nBits = htonl((int32_t)nBits);\n    return HexStr(BEGIN(uBits.cBits), END(uBits.cBits));\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HexStr",
          "args": [
            "BEGIN(uBits.cBits)",
            "END(uBits.cBits)"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "HexStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "323-339",
          "snippet": "std::string HexStr(const T itbegin, const T itend, bool fSpaces=false)\n{\n    std::string rv;\n    static const char hexmap[16] = { '0', '1', '2', '3', '4', '5', '6', '7',\n                                     '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };\n    rv.reserve((itend-itbegin)*3);\n    for(T it = itbegin; it < itend; ++it)\n    {\n        unsigned char val = (unsigned char)(*it);\n        if(fSpaces && it != itbegin)\n            rv.push_back(' ');\n        rv.push_back(hexmap[val>>4]);\n        rv.push_back(hexmap[val&15]);\n    }\n\n    return rv;\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nstd::string HexStr(const T itbegin, const T itend, bool fSpaces=false)\n{\n    std::string rv;\n    static const char hexmap[16] = { '0', '1', '2', '3', '4', '5', '6', '7',\n                                     '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };\n    rv.reserve((itend-itbegin)*3);\n    for(T it = itbegin; it < itend; ++it)\n    {\n        unsigned char val = (unsigned char)(*it);\n        if(fSpaces && it != itbegin)\n            rv.push_back(' ');\n        rv.push_back(hexmap[val>>4]);\n        rv.push_back(hexmap[val&15]);\n    }\n\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "END",
          "args": [
            "uBits.cBits"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BEGIN",
          "args": [
            "uBits.cBits"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "(int32_t)nBits"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstd::string HexBits(unsigned int nBits)\n{\n    union {\n        int32_t nBits;\n        char cBits[4];\n    } uBits;\n    uBits.nBits = htonl((int32_t)nBits);\n    return HexStr(BEGIN(uBits.cBits), END(uBits.cBits));\n}"
  },
  {
    "function_name": "ValueFromAmount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "113-116",
    "snippet": "Value ValueFromAmount(int64_t amount)\n{\n    return (double)amount / (double)COIN;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nValue ValueFromAmount(int64_t amount)\n{\n    return (double)amount / (double)COIN;\n}"
  },
  {
    "function_name": "AmountFromValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "102-111",
    "snippet": "int64_t AmountFromValue(const Value& value)\n{\n    double dAmount = value.get_real();\n    if (dAmount <= 0.0 || dAmount > MAX_MONEY)\n        throw JSONRPCError(RPC_TYPE_ERROR, \"Invalid amount\");\n    int64_t nAmount = roundint64(dAmount * COIN);\n    if (!MoneyRange(nAmount))\n        throw JSONRPCError(RPC_TYPE_ERROR, \"Invalid amount\");\n    return nAmount;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "JSONRPCError",
          "args": [
            "RPC_TYPE_ERROR",
            "\"Invalid amount\""
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "54-60",
          "snippet": "Object JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MoneyRange",
          "args": [
            "nAmount"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "MoneyRange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "48-48",
          "snippet": "inline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\ninline bool MoneyRange(int64_t nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }"
        }
      },
      {
        "call_info": {
          "callee": "roundint64",
          "args": [
            "dAmount * COIN"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "roundint64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "302-305",
          "snippet": "inline int64_t roundint64(double d)\n{\n    return (int64_t)(d > 0 ? d + 0.5 : d - 0.5);\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t roundint64(double d)\n{\n    return (int64_t)(d > 0 ? d + 0.5 : d - 0.5);\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.get_real",
          "args": [],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "get_real",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "409-420",
          "snippet": "double Value_impl< Config >::get_real() const\n    {\n        if( type() == int_type )\n        {\n            return is_uint64() ? static_cast< double >( get_uint64() )\n                               : static_cast< double >( get_int64() );\n        }\n\n        check_type(  real_type );\n\n        return boost::get< double >( v_ );\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  double Value_impl< Config >::get_real() const\n      {\n          if( type() == int_type )\n          {\n              return is_uint64() ? static_cast< double >( get_uint64() )\n                                 : static_cast< double >( get_int64() );\n          }\n  \n          check_type(  real_type );\n  \n          return boost::get< double >( v_ );\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nint64_t AmountFromValue(const Value& value)\n{\n    double dAmount = value.get_real();\n    if (dAmount <= 0.0 || dAmount > MAX_MONEY)\n        throw JSONRPCError(RPC_TYPE_ERROR, \"Invalid amount\");\n    int64_t nAmount = roundint64(dAmount * COIN);\n    if (!MoneyRange(nAmount))\n        throw JSONRPCError(RPC_TYPE_ERROR, \"Invalid amount\");\n    return nAmount;\n}"
  },
  {
    "function_name": "RPCTypeCheck",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "83-100",
    "snippet": "void RPCTypeCheck(const Object& o,\n                  const map<string, Value_type>& typesExpected,\n                  bool fAllowNull)\n{\n    BOOST_FOREACH(const PAIRTYPE(string, Value_type)& t, typesExpected)\n    {\n        const Value& v = find_value(o, t.first);\n        if (!fAllowNull && v.type() == null_type)\n            throw JSONRPCError(RPC_TYPE_ERROR, strprintf(\"Missing %s\", t.first.c_str()));\n\n        if (!((v.type() == t.second) || (fAllowNull && (v.type() == null_type))))\n        {\n            string err = strprintf(\"Expected type %s for %s, got %s\",\n                                   Value_type_name[t.second], t.first.c_str(), Value_type_name[v.type()]);\n            throw JSONRPCError(RPC_TYPE_ERROR, err);\n        }\n    }\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "JSONRPCError",
          "args": [
            "RPC_TYPE_ERROR",
            "err"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "54-60",
          "snippet": "Object JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"Expected type %s for %s, got %s\"",
            "Value_type_name[t.second]",
            "t.first.c_str()",
            "Value_type_name[v.type()]"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.type",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "t.first.c_str",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"Missing %s\"",
            "t.first.c_str()"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "t.first.c_str",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [
            "o",
            "t.first"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nvoid RPCTypeCheck(const Object& o,\n                  const map<string, Value_type>& typesExpected,\n                  bool fAllowNull)\n{\n    BOOST_FOREACH(const PAIRTYPE(string, Value_type)& t, typesExpected)\n    {\n        const Value& v = find_value(o, t.first);\n        if (!fAllowNull && v.type() == null_type)\n            throw JSONRPCError(RPC_TYPE_ERROR, strprintf(\"Missing %s\", t.first.c_str()));\n\n        if (!((v.type() == t.second) || (fAllowNull && (v.type() == null_type))))\n        {\n            string err = strprintf(\"Expected type %s for %s, got %s\",\n                                   Value_type_name[t.second], t.first.c_str(), Value_type_name[v.type()]);\n            throw JSONRPCError(RPC_TYPE_ERROR, err);\n        }\n    }\n}"
  },
  {
    "function_name": "RPCTypeCheck",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "62-81",
    "snippet": "void RPCTypeCheck(const Array& params,\n                  const list<Value_type>& typesExpected,\n                  bool fAllowNull)\n{\n    unsigned int i = 0;\n    BOOST_FOREACH(Value_type t, typesExpected)\n    {\n        if (params.size() <= i)\n            break;\n\n        const Value& v = params[i];\n        if (!((v.type() == t) || (fAllowNull && (v.type() == null_type))))\n        {\n            string err = strprintf(\"Expected type %s, got %s\",\n                                   Value_type_name[t], Value_type_name[v.type()]);\n            throw JSONRPCError(RPC_TYPE_ERROR, err);\n        }\n        i++;\n    }\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "JSONRPCError",
          "args": [
            "RPC_TYPE_ERROR",
            "err"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "JSONRPCError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "54-60",
          "snippet": "Object JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"Expected type %s, got %s\"",
            "Value_type_name[t]",
            "Value_type_name[v.type()]"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.type",
          "args": [],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "params.size",
          "args": [],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nvoid RPCTypeCheck(const Array& params,\n                  const list<Value_type>& typesExpected,\n                  bool fAllowNull)\n{\n    unsigned int i = 0;\n    BOOST_FOREACH(Value_type t, typesExpected)\n    {\n        if (params.size() <= i)\n            break;\n\n        const Value& v = params[i];\n        if (!((v.type() == t) || (fAllowNull && (v.type() == null_type))))\n        {\n            string err = strprintf(\"Expected type %s, got %s\",\n                                   Value_type_name[t], Value_type_name[v.type()]);\n            throw JSONRPCError(RPC_TYPE_ERROR, err);\n        }\n        i++;\n    }\n}"
  },
  {
    "function_name": "JSONRPCError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "54-60",
    "snippet": "Object JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "error.push_back",
          "args": [
            "Pair(\"message\", message)"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Pair",
          "args": [
            "\"message\"",
            "message"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "Pair_impl",
          "container": "Pair_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "439-443",
          "snippet": "Pair_impl< Config >::Pair_impl( const String_type& name, const Value_type& value )\n    :   name_( name )\n    ,   value_( value )\n    {\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nPair_impl< Config > {\n  Pair_impl< Config >::Pair_impl( const String_type& name, const Value_type& value )\n      :   name_( name )\n      ,   value_( value )\n      {\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "error.push_back",
          "args": [
            "Pair(\"code\", code)"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nObject JSONRPCError(int code, const string& message)\n{\n    Object error;\n    error.push_back(Pair(\"code\", code));\n    error.push_back(Pair(\"message\", message));\n    return error;\n}"
  },
  {
    "function_name": "GetDefaultRPCPort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
    "lines": "49-52",
    "snippet": "static inline unsigned short GetDefaultRPCPort()\n{\n    return GetBoolArg(\"-testnet\", false) ? 35615 : 21109;\n}",
    "includes": [
      "#include <list>",
      "#include <boost/shared_ptr.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/asio/ssl.hpp>",
      "#include <boost/algorithm/string.hpp>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/concepts.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/bind.hpp>",
      "#include <boost/bind/bind.hpp>",
      "#include <boost/asio/ip/v6_only.hpp>",
      "#include <boost/asio.hpp>",
      "#include \"db.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"base58.h\"",
      "#include \"ui_interface.h\"",
      "#include \"sync.h\"",
      "#include \"util.h\"",
      "#include \"init.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetBoolArg",
          "args": [
            "\"-testnet\"",
            "false"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "GetBoolArg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "569-578",
          "snippet": "bool GetBoolArg(const std::string& strArg, bool fDefault)\n{\n    if (mapArgs.count(strArg))\n    {\n        if (mapArgs[strArg].empty())\n            return true;\n        return (atoi(mapArgs[strArg]) != 0);\n    }\n    return fDefault;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "map<string, string> mapArgs;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nbool GetBoolArg(const std::string& strArg, bool fDefault)\n{\n    if (mapArgs.count(strArg))\n    {\n        if (mapArgs[strArg].empty())\n            return true;\n        return (atoi(mapArgs[strArg]) != 0);\n    }\n    return fDefault;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nstatic inline unsigned short GetDefaultRPCPort()\n{\n    return GetBoolArg(\"-testnet\", false) ? 35615 : 21109;\n}"
  }
]