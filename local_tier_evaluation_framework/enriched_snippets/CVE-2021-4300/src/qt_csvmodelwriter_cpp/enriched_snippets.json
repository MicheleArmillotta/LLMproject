[
  {
    "function_name": "write",
    "container": "CSVModelWriter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
    "lines": "45-87",
    "snippet": "bool CSVModelWriter::write()\n{\n    QFile file(filename);\n    if(!file.open(QIODevice::WriteOnly | QIODevice::Text))\n        return false;\n    QTextStream out(&file);\n\n    int numRows = 0;\n    if(model)\n    {\n        numRows = model->rowCount();\n    }\n\n    // Header row\n    for(int i=0; i<columns.size(); ++i)\n    {\n        if(i!=0)\n        {\n            writeSep(out);\n        }\n        writeValue(out, columns[i].title);\n    }\n    writeNewline(out);\n\n    // Data rows\n    for(int j=0; j<numRows; ++j)\n    {\n        for(int i=0; i<columns.size(); ++i)\n        {\n            if(i!=0)\n            {\n                writeSep(out);\n            }\n            QVariant data = model->index(j, columns[i].column).data(columns[i].role);\n            writeValue(out, data.toString());\n        }\n        writeNewline(out);\n    }\n\n    file.close();\n\n    return file.error() == QFile::NoError;\n}",
    "includes": [
      "#include <QTextStream>",
      "#include <QFile>",
      "#include <QAbstractItemModel>",
      "#include \"csvmodelwriter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file.error",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file.close",
          "args": [],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "close",
          "container": "AcceptedConnectionImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "664-667",
          "snippet": "virtual void close()\n    {\n        _stream.close();\n    }",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nAcceptedConnectionImpl {\n  virtual void close()\n      {\n          _stream.close();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeNewline",
          "args": [
            "out"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "writeNewline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
          "lines": "40-43",
          "snippet": "static void writeNewline(QTextStream &f)\n{\n    f << \"\\n\";\n}",
          "includes": [
            "#include <QTextStream>",
            "#include <QFile>",
            "#include <QAbstractItemModel>",
            "#include \"csvmodelwriter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nstatic void writeNewline(QTextStream &f)\n{\n    f << \"\\n\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeValue",
          "args": [
            "out",
            "data.toString()"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "writeValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
          "lines": "28-33",
          "snippet": "static void writeValue(QTextStream &f, const QString &value)\n{\n    QString escaped = value;\n    escaped.replace('\"', \"\\\"\\\"\");\n    f << \"\\\"\" << escaped << \"\\\"\";\n}",
          "includes": [
            "#include <QTextStream>",
            "#include <QFile>",
            "#include <QAbstractItemModel>",
            "#include \"csvmodelwriter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nstatic void writeValue(QTextStream &f, const QString &value)\n{\n    QString escaped = value;\n    escaped.replace('\"', \"\\\"\\\"\");\n    f << \"\\\"\" << escaped << \"\\\"\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.toString",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->index",
          "args": [
            "columns[i].role"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->index",
          "args": [
            "j",
            "columns[i].column"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writeSep",
          "args": [
            "out"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "writeSep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
          "lines": "35-38",
          "snippet": "static void writeSep(QTextStream &f)\n{\n    f << \",\";\n}",
          "includes": [
            "#include <QTextStream>",
            "#include <QFile>",
            "#include <QAbstractItemModel>",
            "#include \"csvmodelwriter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nstatic void writeSep(QTextStream &f)\n{\n    f << \",\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "columns.size",
          "args": [],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->rowCount",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file.open",
          "args": [
            "QIODevice::WriteOnly | QIODevice::Text"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nCSVModelWriter {\n  bool CSVModelWriter::write()\n  {\n      QFile file(filename);\n      if(!file.open(QIODevice::WriteOnly | QIODevice::Text))\n          return false;\n      QTextStream out(&file);\n  \n      int numRows = 0;\n      if(model)\n      {\n          numRows = model->rowCount();\n      }\n  \n      // Header row\n      for(int i=0; i<columns.size(); ++i)\n      {\n          if(i!=0)\n          {\n              writeSep(out);\n          }\n          writeValue(out, columns[i].title);\n      }\n      writeNewline(out);\n  \n      // Data rows\n      for(int j=0; j<numRows; ++j)\n      {\n          for(int i=0; i<columns.size(); ++i)\n          {\n              if(i!=0)\n              {\n                  writeSep(out);\n              }\n              QVariant data = model->index(j, columns[i].column).data(columns[i].role);\n              writeValue(out, data.toString());\n          }\n          writeNewline(out);\n      }\n  \n      file.close();\n  \n      return file.error() == QFile::NoError;\n  }\n}"
  },
  {
    "function_name": "writeNewline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
    "lines": "40-43",
    "snippet": "static void writeNewline(QTextStream &f)\n{\n    f << \"\\n\";\n}",
    "includes": [
      "#include <QTextStream>",
      "#include <QFile>",
      "#include <QAbstractItemModel>",
      "#include \"csvmodelwriter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nstatic void writeNewline(QTextStream &f)\n{\n    f << \"\\n\";\n}"
  },
  {
    "function_name": "writeSep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
    "lines": "35-38",
    "snippet": "static void writeSep(QTextStream &f)\n{\n    f << \",\";\n}",
    "includes": [
      "#include <QTextStream>",
      "#include <QFile>",
      "#include <QAbstractItemModel>",
      "#include \"csvmodelwriter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nstatic void writeSep(QTextStream &f)\n{\n    f << \",\";\n}"
  },
  {
    "function_name": "writeValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
    "lines": "28-33",
    "snippet": "static void writeValue(QTextStream &f, const QString &value)\n{\n    QString escaped = value;\n    escaped.replace('\"', \"\\\"\\\"\");\n    f << \"\\\"\" << escaped << \"\\\"\";\n}",
    "includes": [
      "#include <QTextStream>",
      "#include <QFile>",
      "#include <QAbstractItemModel>",
      "#include \"csvmodelwriter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "escaped.replace",
          "args": [
            "'\"'",
            "\"\\\"\\\"\""
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nstatic void writeValue(QTextStream &f, const QString &value)\n{\n    QString escaped = value;\n    escaped.replace('\"', \"\\\"\\\"\");\n    f << \"\\\"\" << escaped << \"\\\"\";\n}"
  },
  {
    "function_name": "addColumn",
    "container": "CSVModelWriter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
    "lines": "18-26",
    "snippet": "void CSVModelWriter::addColumn(const QString &title, int column, int role)\n{\n    Column col;\n    col.title = title;\n    col.column = column;\n    col.role = role;\n\n    columns.append(col);\n}",
    "includes": [
      "#include <QTextStream>",
      "#include <QFile>",
      "#include <QAbstractItemModel>",
      "#include \"csvmodelwriter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "columns.append",
          "args": [
            "col"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nCSVModelWriter {\n  void CSVModelWriter::addColumn(const QString &title, int column, int role)\n  {\n      Column col;\n      col.title = title;\n      col.column = column;\n      col.role = role;\n  \n      columns.append(col);\n  }\n}"
  },
  {
    "function_name": "setModel",
    "container": "CSVModelWriter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
    "lines": "13-16",
    "snippet": "void CSVModelWriter::setModel(const QAbstractItemModel *model)\n{\n    this->model = model;\n}",
    "includes": [
      "#include <QTextStream>",
      "#include <QFile>",
      "#include <QAbstractItemModel>",
      "#include \"csvmodelwriter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nCSVModelWriter {\n  void CSVModelWriter::setModel(const QAbstractItemModel *model)\n  {\n      this->model = model;\n  }\n}"
  },
  {
    "function_name": "CSVModelWriter",
    "container": "CSVModelWriter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
    "lines": "7-11",
    "snippet": "CSVModelWriter::CSVModelWriter(const QString &filename, QObject *parent) :\n    QObject(parent),\n    filename(filename), model(0)\n{\n}",
    "includes": [
      "#include <QTextStream>",
      "#include <QFile>",
      "#include <QAbstractItemModel>",
      "#include \"csvmodelwriter.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nCSVModelWriter {\n  CSVModelWriter::CSVModelWriter(const QString &filename, QObject *parent) :\n      QObject(parent),\n      filename(filename), model(0)\n  {\n  }\n}"
  }
]