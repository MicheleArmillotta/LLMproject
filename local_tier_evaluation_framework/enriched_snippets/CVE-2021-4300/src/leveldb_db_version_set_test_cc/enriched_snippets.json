[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
    "lines": "177-179",
    "snippet": "int main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/version_set.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "leveldb::test::RunAllTests",
          "args": [],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "RunAllTests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "36-58",
          "snippet": "int RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nint main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
    "lines": "157-173",
    "snippet": "TEST(FindFileTest, OverlappingFiles) {\n  Add(\"150\", \"600\");\n  Add(\"400\", \"500\");\n  disjoint_sorted_files_ = false;\n  ASSERT_TRUE(! Overlaps(\"100\", \"149\"));\n  ASSERT_TRUE(! Overlaps(\"601\", \"700\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"150\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"200\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"300\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"400\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"500\"));\n  ASSERT_TRUE(Overlaps(\"375\", \"400\"));\n  ASSERT_TRUE(Overlaps(\"450\", \"450\"));\n  ASSERT_TRUE(Overlaps(\"450\", \"500\"));\n  ASSERT_TRUE(Overlaps(\"450\", \"700\"));\n  ASSERT_TRUE(Overlaps(\"600\", \"700\"));\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/version_set.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"600\", \"700\")"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Overlaps",
          "args": [
            "\"600\"",
            "\"700\""
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "Overlaps",
          "container": "FindFileTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
          "lines": "41-48",
          "snippet": "bool Overlaps(const char* smallest, const char* largest) {\n    InternalKeyComparator cmp(BytewiseComparator());\n    Slice s(smallest != NULL ? smallest : \"\");\n    Slice l(largest != NULL ? largest : \"\");\n    return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                 (smallest != NULL ? &s : NULL),\n                                 (largest != NULL ? &l : NULL));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  bool Overlaps(const char* smallest, const char* largest) {\n      InternalKeyComparator cmp(BytewiseComparator());\n      Slice s(smallest != NULL ? smallest : \"\");\n      Slice l(largest != NULL ? largest : \"\");\n      return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                   (smallest != NULL ? &s : NULL),\n                                   (largest != NULL ? &l : NULL));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"450\", \"700\")"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"450\", \"500\")"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"450\", \"450\")"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"375\", \"400\")"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"100\", \"500\")"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"100\", \"400\")"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"100\", \"300\")"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"100\", \"200\")"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"100\", \"150\")"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"601\", \"700\")"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"100\", \"149\")"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Add",
          "args": [
            "\"400\"",
            "\"500\""
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "FindFileTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
          "lines": "25-33",
          "snippet": "void Add(const char* smallest, const char* largest,\n           SequenceNumber smallest_seq = 100,\n           SequenceNumber largest_seq = 100) {\n    FileMetaData* f = new FileMetaData;\n    f->number = files_.size() + 1;\n    f->smallest = InternalKey(smallest, smallest_seq, kTypeValue);\n    f->largest = InternalKey(largest, largest_seq, kTypeValue);\n    files_.push_back(f);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  void Add(const char* smallest, const char* largest,\n             SequenceNumber smallest_seq = 100,\n             SequenceNumber largest_seq = 100) {\n      FileMetaData* f = new FileMetaData;\n      f->number = files_.size() + 1;\n      f->smallest = InternalKey(smallest, smallest_seq, kTypeValue);\n      f->largest = InternalKey(largest, largest_seq, kTypeValue);\n      files_.push_back(f);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nTEST(FindFileTest, OverlappingFiles) {\n  Add(\"150\", \"600\");\n  Add(\"400\", \"500\");\n  disjoint_sorted_files_ = false;\n  ASSERT_TRUE(! Overlaps(\"100\", \"149\"));\n  ASSERT_TRUE(! Overlaps(\"601\", \"700\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"150\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"200\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"300\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"400\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"500\"));\n  ASSERT_TRUE(Overlaps(\"375\", \"400\"));\n  ASSERT_TRUE(Overlaps(\"450\", \"450\"));\n  ASSERT_TRUE(Overlaps(\"450\", \"500\"));\n  ASSERT_TRUE(Overlaps(\"450\", \"700\"));\n  ASSERT_TRUE(Overlaps(\"600\", \"700\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
    "lines": "148-155",
    "snippet": "TEST(FindFileTest, OverlapSequenceChecks) {\n  Add(\"200\", \"200\", 5000, 3000);\n  ASSERT_TRUE(! Overlaps(\"199\", \"199\"));\n  ASSERT_TRUE(! Overlaps(\"201\", \"300\"));\n  ASSERT_TRUE(Overlaps(\"200\", \"200\"));\n  ASSERT_TRUE(Overlaps(\"190\", \"200\"));\n  ASSERT_TRUE(Overlaps(\"200\", \"210\"));\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/version_set.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"200\", \"210\")"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Overlaps",
          "args": [
            "\"200\"",
            "\"210\""
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "Overlaps",
          "container": "FindFileTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
          "lines": "41-48",
          "snippet": "bool Overlaps(const char* smallest, const char* largest) {\n    InternalKeyComparator cmp(BytewiseComparator());\n    Slice s(smallest != NULL ? smallest : \"\");\n    Slice l(largest != NULL ? largest : \"\");\n    return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                 (smallest != NULL ? &s : NULL),\n                                 (largest != NULL ? &l : NULL));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  bool Overlaps(const char* smallest, const char* largest) {\n      InternalKeyComparator cmp(BytewiseComparator());\n      Slice s(smallest != NULL ? smallest : \"\");\n      Slice l(largest != NULL ? largest : \"\");\n      return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                   (smallest != NULL ? &s : NULL),\n                                   (largest != NULL ? &l : NULL));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"190\", \"200\")"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"200\", \"200\")"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"201\", \"300\")"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"199\", \"199\")"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Add",
          "args": [
            "\"200\"",
            "\"200\"",
            "5000",
            "3000"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "MemTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/memtable.cc",
          "lines": "82-106",
          "snippet": "void MemTable::Add(SequenceNumber s, ValueType type,\n                   const Slice& key,\n                   const Slice& value) {\n  // Format of an entry is concatenation of:\n  //  key_size     : varint32 of internal_key.size()\n  //  key bytes    : char[internal_key.size()]\n  //  value_size   : varint32 of value.size()\n  //  value bytes  : char[value.size()]\n  size_t key_size = key.size();\n  size_t val_size = value.size();\n  size_t internal_key_size = key_size + 8;\n  const size_t encoded_len =\n      VarintLength(internal_key_size) + internal_key_size +\n      VarintLength(val_size) + val_size;\n  char* buf = arena_.Allocate(encoded_len);\n  char* p = EncodeVarint32(buf, internal_key_size);\n  memcpy(p, key.data(), key_size);\n  p += key_size;\n  EncodeFixed64(p, (s << 8) | type);\n  p += 8;\n  p = EncodeVarint32(p, val_size);\n  memcpy(p, value.data(), val_size);\n  assert((p + val_size) - buf == encoded_len);\n  table_.Insert(buf);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/memtable.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/comparator.h\"\n#include \"db/dbformat.h\"\n#include \"db/memtable.h\"\n\nMemTable {\n  void MemTable::Add(SequenceNumber s, ValueType type,\n                     const Slice& key,\n                     const Slice& value) {\n    // Format of an entry is concatenation of:\n    //  key_size     : varint32 of internal_key.size()\n    //  key bytes    : char[internal_key.size()]\n    //  value_size   : varint32 of value.size()\n    //  value bytes  : char[value.size()]\n    size_t key_size = key.size();\n    size_t val_size = value.size();\n    size_t internal_key_size = key_size + 8;\n    const size_t encoded_len =\n        VarintLength(internal_key_size) + internal_key_size +\n        VarintLength(val_size) + val_size;\n    char* buf = arena_.Allocate(encoded_len);\n    char* p = EncodeVarint32(buf, internal_key_size);\n    memcpy(p, key.data(), key_size);\n    p += key_size;\n    EncodeFixed64(p, (s << 8) | type);\n    p += 8;\n    p = EncodeVarint32(p, val_size);\n    memcpy(p, value.data(), val_size);\n    assert((p + val_size) - buf == encoded_len);\n    table_.Insert(buf);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nTEST(FindFileTest, OverlapSequenceChecks) {\n  Add(\"200\", \"200\", 5000, 3000);\n  ASSERT_TRUE(! Overlaps(\"199\", \"199\"));\n  ASSERT_TRUE(! Overlaps(\"201\", \"300\"));\n  ASSERT_TRUE(Overlaps(\"200\", \"200\"));\n  ASSERT_TRUE(Overlaps(\"190\", \"200\"));\n  ASSERT_TRUE(Overlaps(\"200\", \"210\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
    "lines": "128-146",
    "snippet": "TEST(FindFileTest, MultipleNullBoundaries) {\n  Add(\"150\", \"200\");\n  Add(\"200\", \"250\");\n  Add(\"300\", \"350\");\n  Add(\"400\", \"450\");\n  ASSERT_TRUE(! Overlaps(NULL, \"149\"));\n  ASSERT_TRUE(! Overlaps(\"451\", NULL));\n  ASSERT_TRUE(Overlaps(NULL, NULL));\n  ASSERT_TRUE(Overlaps(NULL, \"150\"));\n  ASSERT_TRUE(Overlaps(NULL, \"199\"));\n  ASSERT_TRUE(Overlaps(NULL, \"200\"));\n  ASSERT_TRUE(Overlaps(NULL, \"201\"));\n  ASSERT_TRUE(Overlaps(NULL, \"400\"));\n  ASSERT_TRUE(Overlaps(NULL, \"800\"));\n  ASSERT_TRUE(Overlaps(\"100\", NULL));\n  ASSERT_TRUE(Overlaps(\"200\", NULL));\n  ASSERT_TRUE(Overlaps(\"449\", NULL));\n  ASSERT_TRUE(Overlaps(\"450\", NULL));\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/version_set.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"450\", NULL)"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Overlaps",
          "args": [
            "\"450\"",
            "NULL"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "Overlaps",
          "container": "FindFileTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
          "lines": "41-48",
          "snippet": "bool Overlaps(const char* smallest, const char* largest) {\n    InternalKeyComparator cmp(BytewiseComparator());\n    Slice s(smallest != NULL ? smallest : \"\");\n    Slice l(largest != NULL ? largest : \"\");\n    return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                 (smallest != NULL ? &s : NULL),\n                                 (largest != NULL ? &l : NULL));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  bool Overlaps(const char* smallest, const char* largest) {\n      InternalKeyComparator cmp(BytewiseComparator());\n      Slice s(smallest != NULL ? smallest : \"\");\n      Slice l(largest != NULL ? largest : \"\");\n      return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                   (smallest != NULL ? &s : NULL),\n                                   (largest != NULL ? &l : NULL));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"449\", NULL)"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"200\", NULL)"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"100\", NULL)"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(NULL, \"800\")"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(NULL, \"400\")"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(NULL, \"201\")"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(NULL, \"200\")"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(NULL, \"199\")"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(NULL, \"150\")"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(NULL, NULL)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"451\", NULL)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(NULL, \"149\")"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Add",
          "args": [
            "\"400\"",
            "\"450\""
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "FindFileTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
          "lines": "25-33",
          "snippet": "void Add(const char* smallest, const char* largest,\n           SequenceNumber smallest_seq = 100,\n           SequenceNumber largest_seq = 100) {\n    FileMetaData* f = new FileMetaData;\n    f->number = files_.size() + 1;\n    f->smallest = InternalKey(smallest, smallest_seq, kTypeValue);\n    f->largest = InternalKey(largest, largest_seq, kTypeValue);\n    files_.push_back(f);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  void Add(const char* smallest, const char* largest,\n             SequenceNumber smallest_seq = 100,\n             SequenceNumber largest_seq = 100) {\n      FileMetaData* f = new FileMetaData;\n      f->number = files_.size() + 1;\n      f->smallest = InternalKey(smallest, smallest_seq, kTypeValue);\n      f->largest = InternalKey(largest, largest_seq, kTypeValue);\n      files_.push_back(f);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nTEST(FindFileTest, MultipleNullBoundaries) {\n  Add(\"150\", \"200\");\n  Add(\"200\", \"250\");\n  Add(\"300\", \"350\");\n  Add(\"400\", \"450\");\n  ASSERT_TRUE(! Overlaps(NULL, \"149\"));\n  ASSERT_TRUE(! Overlaps(\"451\", NULL));\n  ASSERT_TRUE(Overlaps(NULL, NULL));\n  ASSERT_TRUE(Overlaps(NULL, \"150\"));\n  ASSERT_TRUE(Overlaps(NULL, \"199\"));\n  ASSERT_TRUE(Overlaps(NULL, \"200\"));\n  ASSERT_TRUE(Overlaps(NULL, \"201\"));\n  ASSERT_TRUE(Overlaps(NULL, \"400\"));\n  ASSERT_TRUE(Overlaps(NULL, \"800\"));\n  ASSERT_TRUE(Overlaps(\"100\", NULL));\n  ASSERT_TRUE(Overlaps(\"200\", NULL));\n  ASSERT_TRUE(Overlaps(\"449\", NULL));\n  ASSERT_TRUE(Overlaps(\"450\", NULL));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
    "lines": "90-126",
    "snippet": "TEST(FindFileTest, Multiple) {\n  Add(\"150\", \"200\");\n  Add(\"200\", \"250\");\n  Add(\"300\", \"350\");\n  Add(\"400\", \"450\");\n  ASSERT_EQ(0, Find(\"100\"));\n  ASSERT_EQ(0, Find(\"150\"));\n  ASSERT_EQ(0, Find(\"151\"));\n  ASSERT_EQ(0, Find(\"199\"));\n  ASSERT_EQ(0, Find(\"200\"));\n  ASSERT_EQ(1, Find(\"201\"));\n  ASSERT_EQ(1, Find(\"249\"));\n  ASSERT_EQ(1, Find(\"250\"));\n  ASSERT_EQ(2, Find(\"251\"));\n  ASSERT_EQ(2, Find(\"299\"));\n  ASSERT_EQ(2, Find(\"300\"));\n  ASSERT_EQ(2, Find(\"349\"));\n  ASSERT_EQ(2, Find(\"350\"));\n  ASSERT_EQ(3, Find(\"351\"));\n  ASSERT_EQ(3, Find(\"400\"));\n  ASSERT_EQ(3, Find(\"450\"));\n  ASSERT_EQ(4, Find(\"451\"));\n\n  ASSERT_TRUE(! Overlaps(\"100\", \"149\"));\n  ASSERT_TRUE(! Overlaps(\"251\", \"299\"));\n  ASSERT_TRUE(! Overlaps(\"451\", \"500\"));\n  ASSERT_TRUE(! Overlaps(\"351\", \"399\"));\n\n  ASSERT_TRUE(Overlaps(\"100\", \"150\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"200\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"300\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"400\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"500\"));\n  ASSERT_TRUE(Overlaps(\"375\", \"400\"));\n  ASSERT_TRUE(Overlaps(\"450\", \"450\"));\n  ASSERT_TRUE(Overlaps(\"450\", \"500\"));\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/version_set.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"450\", \"500\")"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Overlaps",
          "args": [
            "\"450\"",
            "\"500\""
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "Overlaps",
          "container": "FindFileTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
          "lines": "41-48",
          "snippet": "bool Overlaps(const char* smallest, const char* largest) {\n    InternalKeyComparator cmp(BytewiseComparator());\n    Slice s(smallest != NULL ? smallest : \"\");\n    Slice l(largest != NULL ? largest : \"\");\n    return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                 (smallest != NULL ? &s : NULL),\n                                 (largest != NULL ? &l : NULL));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  bool Overlaps(const char* smallest, const char* largest) {\n      InternalKeyComparator cmp(BytewiseComparator());\n      Slice s(smallest != NULL ? smallest : \"\");\n      Slice l(largest != NULL ? largest : \"\");\n      return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                   (smallest != NULL ? &s : NULL),\n                                   (largest != NULL ? &l : NULL));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"450\", \"450\")"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"375\", \"400\")"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"100\", \"500\")"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"100\", \"400\")"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"100\", \"300\")"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"100\", \"200\")"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"100\", \"150\")"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"351\", \"399\")"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"451\", \"500\")"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"251\", \"299\")"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"100\", \"149\")"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "4",
            "Find(\"451\")"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Find",
          "args": [
            "\"451\""
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "Find",
          "container": "FindFileTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
          "lines": "35-39",
          "snippet": "int Find(const char* key) {\n    InternalKey target(key, 100, kTypeValue);\n    InternalKeyComparator cmp(BytewiseComparator());\n    return FindFile(cmp, files_, target.Encode());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  int Find(const char* key) {\n      InternalKey target(key, 100, kTypeValue);\n      InternalKeyComparator cmp(BytewiseComparator());\n      return FindFile(cmp, files_, target.Encode());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "3",
            "Find(\"450\")"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "3",
            "Find(\"400\")"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "3",
            "Find(\"351\")"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2",
            "Find(\"350\")"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2",
            "Find(\"349\")"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2",
            "Find(\"300\")"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2",
            "Find(\"299\")"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2",
            "Find(\"251\")"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1",
            "Find(\"250\")"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1",
            "Find(\"249\")"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1",
            "Find(\"201\")"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "Find(\"200\")"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "Find(\"199\")"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "Find(\"151\")"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "Find(\"150\")"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "Find(\"100\")"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Add",
          "args": [
            "\"400\"",
            "\"450\""
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "FindFileTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
          "lines": "25-33",
          "snippet": "void Add(const char* smallest, const char* largest,\n           SequenceNumber smallest_seq = 100,\n           SequenceNumber largest_seq = 100) {\n    FileMetaData* f = new FileMetaData;\n    f->number = files_.size() + 1;\n    f->smallest = InternalKey(smallest, smallest_seq, kTypeValue);\n    f->largest = InternalKey(largest, largest_seq, kTypeValue);\n    files_.push_back(f);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  void Add(const char* smallest, const char* largest,\n             SequenceNumber smallest_seq = 100,\n             SequenceNumber largest_seq = 100) {\n      FileMetaData* f = new FileMetaData;\n      f->number = files_.size() + 1;\n      f->smallest = InternalKey(smallest, smallest_seq, kTypeValue);\n      f->largest = InternalKey(largest, largest_seq, kTypeValue);\n      files_.push_back(f);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nTEST(FindFileTest, Multiple) {\n  Add(\"150\", \"200\");\n  Add(\"200\", \"250\");\n  Add(\"300\", \"350\");\n  Add(\"400\", \"450\");\n  ASSERT_EQ(0, Find(\"100\"));\n  ASSERT_EQ(0, Find(\"150\"));\n  ASSERT_EQ(0, Find(\"151\"));\n  ASSERT_EQ(0, Find(\"199\"));\n  ASSERT_EQ(0, Find(\"200\"));\n  ASSERT_EQ(1, Find(\"201\"));\n  ASSERT_EQ(1, Find(\"249\"));\n  ASSERT_EQ(1, Find(\"250\"));\n  ASSERT_EQ(2, Find(\"251\"));\n  ASSERT_EQ(2, Find(\"299\"));\n  ASSERT_EQ(2, Find(\"300\"));\n  ASSERT_EQ(2, Find(\"349\"));\n  ASSERT_EQ(2, Find(\"350\"));\n  ASSERT_EQ(3, Find(\"351\"));\n  ASSERT_EQ(3, Find(\"400\"));\n  ASSERT_EQ(3, Find(\"450\"));\n  ASSERT_EQ(4, Find(\"451\"));\n\n  ASSERT_TRUE(! Overlaps(\"100\", \"149\"));\n  ASSERT_TRUE(! Overlaps(\"251\", \"299\"));\n  ASSERT_TRUE(! Overlaps(\"451\", \"500\"));\n  ASSERT_TRUE(! Overlaps(\"351\", \"399\"));\n\n  ASSERT_TRUE(Overlaps(\"100\", \"150\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"200\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"300\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"400\"));\n  ASSERT_TRUE(Overlaps(\"100\", \"500\"));\n  ASSERT_TRUE(Overlaps(\"375\", \"400\"));\n  ASSERT_TRUE(Overlaps(\"450\", \"450\"));\n  ASSERT_TRUE(Overlaps(\"450\", \"500\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
    "lines": "59-87",
    "snippet": "TEST(FindFileTest, Single) {\n  Add(\"p\", \"q\");\n  ASSERT_EQ(0, Find(\"a\"));\n  ASSERT_EQ(0, Find(\"p\"));\n  ASSERT_EQ(0, Find(\"p1\"));\n  ASSERT_EQ(0, Find(\"q\"));\n  ASSERT_EQ(1, Find(\"q1\"));\n  ASSERT_EQ(1, Find(\"z\"));\n\n  ASSERT_TRUE(! Overlaps(\"a\", \"b\"));\n  ASSERT_TRUE(! Overlaps(\"z1\", \"z2\"));\n  ASSERT_TRUE(Overlaps(\"a\", \"p\"));\n  ASSERT_TRUE(Overlaps(\"a\", \"q\"));\n  ASSERT_TRUE(Overlaps(\"a\", \"z\"));\n  ASSERT_TRUE(Overlaps(\"p\", \"p1\"));\n  ASSERT_TRUE(Overlaps(\"p\", \"q\"));\n  ASSERT_TRUE(Overlaps(\"p\", \"z\"));\n  ASSERT_TRUE(Overlaps(\"p1\", \"p2\"));\n  ASSERT_TRUE(Overlaps(\"p1\", \"z\"));\n  ASSERT_TRUE(Overlaps(\"q\", \"q\"));\n  ASSERT_TRUE(Overlaps(\"q\", \"q1\"));\n\n  ASSERT_TRUE(! Overlaps(NULL, \"j\"));\n  ASSERT_TRUE(! Overlaps(\"r\", NULL));\n  ASSERT_TRUE(Overlaps(NULL, \"p\"));\n  ASSERT_TRUE(Overlaps(NULL, \"p1\"));\n  ASSERT_TRUE(Overlaps(\"q\", NULL));\n  ASSERT_TRUE(Overlaps(NULL, NULL));\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/version_set.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(NULL, NULL)"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Overlaps",
          "args": [
            "NULL",
            "NULL"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "Overlaps",
          "container": "FindFileTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
          "lines": "41-48",
          "snippet": "bool Overlaps(const char* smallest, const char* largest) {\n    InternalKeyComparator cmp(BytewiseComparator());\n    Slice s(smallest != NULL ? smallest : \"\");\n    Slice l(largest != NULL ? largest : \"\");\n    return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                 (smallest != NULL ? &s : NULL),\n                                 (largest != NULL ? &l : NULL));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  bool Overlaps(const char* smallest, const char* largest) {\n      InternalKeyComparator cmp(BytewiseComparator());\n      Slice s(smallest != NULL ? smallest : \"\");\n      Slice l(largest != NULL ? largest : \"\");\n      return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                   (smallest != NULL ? &s : NULL),\n                                   (largest != NULL ? &l : NULL));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"q\", NULL)"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(NULL, \"p1\")"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(NULL, \"p\")"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"r\", NULL)"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(NULL, \"j\")"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"q\", \"q1\")"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"q\", \"q\")"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"p1\", \"z\")"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"p1\", \"p2\")"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"p\", \"z\")"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"p\", \"q\")"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"p\", \"p1\")"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"a\", \"z\")"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"a\", \"q\")"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Overlaps(\"a\", \"p\")"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"z1\", \"z2\")"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"a\", \"b\")"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1",
            "Find(\"z\")"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Find",
          "args": [
            "\"z\""
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "Find",
          "container": "FindFileTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
          "lines": "35-39",
          "snippet": "int Find(const char* key) {\n    InternalKey target(key, 100, kTypeValue);\n    InternalKeyComparator cmp(BytewiseComparator());\n    return FindFile(cmp, files_, target.Encode());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  int Find(const char* key) {\n      InternalKey target(key, 100, kTypeValue);\n      InternalKeyComparator cmp(BytewiseComparator());\n      return FindFile(cmp, files_, target.Encode());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1",
            "Find(\"q1\")"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "Find(\"q\")"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "Find(\"p1\")"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "Find(\"p\")"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "Find(\"a\")"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Add",
          "args": [
            "\"p\"",
            "\"q\""
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "FindFileTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
          "lines": "25-33",
          "snippet": "void Add(const char* smallest, const char* largest,\n           SequenceNumber smallest_seq = 100,\n           SequenceNumber largest_seq = 100) {\n    FileMetaData* f = new FileMetaData;\n    f->number = files_.size() + 1;\n    f->smallest = InternalKey(smallest, smallest_seq, kTypeValue);\n    f->largest = InternalKey(largest, largest_seq, kTypeValue);\n    files_.push_back(f);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  void Add(const char* smallest, const char* largest,\n             SequenceNumber smallest_seq = 100,\n             SequenceNumber largest_seq = 100) {\n      FileMetaData* f = new FileMetaData;\n      f->number = files_.size() + 1;\n      f->smallest = InternalKey(smallest, smallest_seq, kTypeValue);\n      f->largest = InternalKey(largest, largest_seq, kTypeValue);\n      files_.push_back(f);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nTEST(FindFileTest, Single) {\n  Add(\"p\", \"q\");\n  ASSERT_EQ(0, Find(\"a\"));\n  ASSERT_EQ(0, Find(\"p\"));\n  ASSERT_EQ(0, Find(\"p1\"));\n  ASSERT_EQ(0, Find(\"q\"));\n  ASSERT_EQ(1, Find(\"q1\"));\n  ASSERT_EQ(1, Find(\"z\"));\n\n  ASSERT_TRUE(! Overlaps(\"a\", \"b\"));\n  ASSERT_TRUE(! Overlaps(\"z1\", \"z2\"));\n  ASSERT_TRUE(Overlaps(\"a\", \"p\"));\n  ASSERT_TRUE(Overlaps(\"a\", \"q\"));\n  ASSERT_TRUE(Overlaps(\"a\", \"z\"));\n  ASSERT_TRUE(Overlaps(\"p\", \"p1\"));\n  ASSERT_TRUE(Overlaps(\"p\", \"q\"));\n  ASSERT_TRUE(Overlaps(\"p\", \"z\"));\n  ASSERT_TRUE(Overlaps(\"p1\", \"p2\"));\n  ASSERT_TRUE(Overlaps(\"p1\", \"z\"));\n  ASSERT_TRUE(Overlaps(\"q\", \"q\"));\n  ASSERT_TRUE(Overlaps(\"q\", \"q1\"));\n\n  ASSERT_TRUE(! Overlaps(NULL, \"j\"));\n  ASSERT_TRUE(! Overlaps(\"r\", NULL));\n  ASSERT_TRUE(Overlaps(NULL, \"p\"));\n  ASSERT_TRUE(Overlaps(NULL, \"p1\"));\n  ASSERT_TRUE(Overlaps(\"q\", NULL));\n  ASSERT_TRUE(Overlaps(NULL, NULL));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
    "lines": "51-57",
    "snippet": "TEST(FindFileTest, Empty) {\n  ASSERT_EQ(0, Find(\"foo\"));\n  ASSERT_TRUE(! Overlaps(\"a\", \"z\"));\n  ASSERT_TRUE(! Overlaps(NULL, \"z\"));\n  ASSERT_TRUE(! Overlaps(\"a\", NULL));\n  ASSERT_TRUE(! Overlaps(NULL, NULL));\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/version_set.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(NULL, NULL)"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Overlaps",
          "args": [
            "NULL",
            "NULL"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "Overlaps",
          "container": "FindFileTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
          "lines": "41-48",
          "snippet": "bool Overlaps(const char* smallest, const char* largest) {\n    InternalKeyComparator cmp(BytewiseComparator());\n    Slice s(smallest != NULL ? smallest : \"\");\n    Slice l(largest != NULL ? largest : \"\");\n    return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                 (smallest != NULL ? &s : NULL),\n                                 (largest != NULL ? &l : NULL));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  bool Overlaps(const char* smallest, const char* largest) {\n      InternalKeyComparator cmp(BytewiseComparator());\n      Slice s(smallest != NULL ? smallest : \"\");\n      Slice l(largest != NULL ? largest : \"\");\n      return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                   (smallest != NULL ? &s : NULL),\n                                   (largest != NULL ? &l : NULL));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"a\", NULL)"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(NULL, \"z\")"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Overlaps(\"a\", \"z\")"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "Find(\"foo\")"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Find",
          "args": [
            "\"foo\""
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "Find",
          "container": "FindFileTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
          "lines": "35-39",
          "snippet": "int Find(const char* key) {\n    InternalKey target(key, 100, kTypeValue);\n    InternalKeyComparator cmp(BytewiseComparator());\n    return FindFile(cmp, files_, target.Encode());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  int Find(const char* key) {\n      InternalKey target(key, 100, kTypeValue);\n      InternalKeyComparator cmp(BytewiseComparator());\n      return FindFile(cmp, files_, target.Encode());\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nTEST(FindFileTest, Empty) {\n  ASSERT_EQ(0, Find(\"foo\"));\n  ASSERT_TRUE(! Overlaps(\"a\", \"z\"));\n  ASSERT_TRUE(! Overlaps(NULL, \"z\"));\n  ASSERT_TRUE(! Overlaps(\"a\", NULL));\n  ASSERT_TRUE(! Overlaps(NULL, NULL));\n}"
  },
  {
    "function_name": "Overlaps",
    "container": "FindFileTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
    "lines": "41-48",
    "snippet": "bool Overlaps(const char* smallest, const char* largest) {\n    InternalKeyComparator cmp(BytewiseComparator());\n    Slice s(smallest != NULL ? smallest : \"\");\n    Slice l(largest != NULL ? largest : \"\");\n    return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                 (smallest != NULL ? &s : NULL),\n                                 (largest != NULL ? &l : NULL));\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/version_set.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SomeFileOverlapsRange",
          "args": [
            "cmp",
            "disjoint_sorted_files_",
            "files_",
            "(smallest != NULL ? &s : NULL)",
            "(largest != NULL ? &l : NULL)"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "SomeFileOverlapsRange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set.cc",
          "lines": "126-161",
          "snippet": "bool SomeFileOverlapsRange(\n    const InternalKeyComparator& icmp,\n    bool disjoint_sorted_files,\n    const std::vector<FileMetaData*>& files,\n    const Slice* smallest_user_key,\n    const Slice* largest_user_key) {\n  const Comparator* ucmp = icmp.user_comparator();\n  if (!disjoint_sorted_files) {\n    // Need to check against all files\n    for (size_t i = 0; i < files.size(); i++) {\n      const FileMetaData* f = files[i];\n      if (AfterFile(ucmp, smallest_user_key, f) ||\n          BeforeFile(ucmp, largest_user_key, f)) {\n        // No overlap\n      } else {\n        return true;  // Overlap\n      }\n    }\n    return false;\n  }\n\n  // Binary search over file list\n  uint32_t index = 0;\n  if (smallest_user_key != NULL) {\n    // Find the earliest possible internal key for smallest_user_key\n    InternalKey small(*smallest_user_key, kMaxSequenceNumber,kValueTypeForSeek);\n    index = FindFile(icmp, files, small.Encode());\n  }\n\n  if (index >= files.size()) {\n    // beginning of range is after all files, so no overlap.\n    return false;\n  }\n\n  return !BeforeFile(ucmp, largest_user_key, files[index]);\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <algorithm>",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/env.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <algorithm>\n#include \"db/version_set.h\"\n\nbool SomeFileOverlapsRange(\n    const InternalKeyComparator& icmp,\n    bool disjoint_sorted_files,\n    const std::vector<FileMetaData*>& files,\n    const Slice* smallest_user_key,\n    const Slice* largest_user_key) {\n  const Comparator* ucmp = icmp.user_comparator();\n  if (!disjoint_sorted_files) {\n    // Need to check against all files\n    for (size_t i = 0; i < files.size(); i++) {\n      const FileMetaData* f = files[i];\n      if (AfterFile(ucmp, smallest_user_key, f) ||\n          BeforeFile(ucmp, largest_user_key, f)) {\n        // No overlap\n      } else {\n        return true;  // Overlap\n      }\n    }\n    return false;\n  }\n\n  // Binary search over file list\n  uint32_t index = 0;\n  if (smallest_user_key != NULL) {\n    // Find the earliest possible internal key for smallest_user_key\n    InternalKey small(*smallest_user_key, kMaxSequenceNumber,kValueTypeForSeek);\n    index = FindFile(icmp, files, small.Encode());\n  }\n\n  if (index >= files.size()) {\n    // beginning of range is after all files, so no overlap.\n    return false;\n  }\n\n  return !BeforeFile(ucmp, largest_user_key, files[index]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  bool Overlaps(const char* smallest, const char* largest) {\n      InternalKeyComparator cmp(BytewiseComparator());\n      Slice s(smallest != NULL ? smallest : \"\");\n      Slice l(largest != NULL ? largest : \"\");\n      return SomeFileOverlapsRange(cmp, disjoint_sorted_files_, files_,\n                                   (smallest != NULL ? &s : NULL),\n                                   (largest != NULL ? &l : NULL));\n    }\n}"
  },
  {
    "function_name": "Find",
    "container": "FindFileTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
    "lines": "35-39",
    "snippet": "int Find(const char* key) {\n    InternalKey target(key, 100, kTypeValue);\n    InternalKeyComparator cmp(BytewiseComparator());\n    return FindFile(cmp, files_, target.Encode());\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/version_set.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FindFile",
          "args": [
            "cmp",
            "files_",
            "target.Encode()"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "FindFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set.cc",
          "lines": "91-110",
          "snippet": "int FindFile(const InternalKeyComparator& icmp,\n             const std::vector<FileMetaData*>& files,\n             const Slice& key) {\n  uint32_t left = 0;\n  uint32_t right = files.size();\n  while (left < right) {\n    uint32_t mid = (left + right) / 2;\n    const FileMetaData* f = files[mid];\n    if (icmp.InternalKeyComparator::Compare(f->largest.Encode(), key) < 0) {\n      // Key at \"mid.largest\" is < \"target\".  Therefore all\n      // files at or before \"mid\" are uninteresting.\n      left = mid + 1;\n    } else {\n      // Key at \"mid.largest\" is >= \"target\".  Therefore all files\n      // after \"mid\" are uninteresting.\n      right = mid;\n    }\n  }\n  return right;\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <algorithm>",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/env.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <algorithm>\n#include \"db/version_set.h\"\n\nint FindFile(const InternalKeyComparator& icmp,\n             const std::vector<FileMetaData*>& files,\n             const Slice& key) {\n  uint32_t left = 0;\n  uint32_t right = files.size();\n  while (left < right) {\n    uint32_t mid = (left + right) / 2;\n    const FileMetaData* f = files[mid];\n    if (icmp.InternalKeyComparator::Compare(f->largest.Encode(), key) < 0) {\n      // Key at \"mid.largest\" is < \"target\".  Therefore all\n      // files at or before \"mid\" are uninteresting.\n      left = mid + 1;\n    } else {\n      // Key at \"mid.largest\" is >= \"target\".  Therefore all files\n      // after \"mid\" are uninteresting.\n      right = mid;\n    }\n  }\n  return right;\n}"
        }
      },
      {
        "call_info": {
          "callee": "target.Encode",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "Encode",
          "container": "InternalKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "154-157",
          "snippet": "Slice Encode() const {\n    assert(!rep_.empty());\n    return rep_;\n  }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\nInternalKey {\n  Slice Encode() const {\n      assert(!rep_.empty());\n      return rep_;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  int Find(const char* key) {\n      InternalKey target(key, 100, kTypeValue);\n      InternalKeyComparator cmp(BytewiseComparator());\n      return FindFile(cmp, files_, target.Encode());\n    }\n}"
  },
  {
    "function_name": "Add",
    "container": "FindFileTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
    "lines": "25-33",
    "snippet": "void Add(const char* smallest, const char* largest,\n           SequenceNumber smallest_seq = 100,\n           SequenceNumber largest_seq = 100) {\n    FileMetaData* f = new FileMetaData;\n    f->number = files_.size() + 1;\n    f->smallest = InternalKey(smallest, smallest_seq, kTypeValue);\n    f->largest = InternalKey(largest, largest_seq, kTypeValue);\n    files_.push_back(f);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/version_set.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "files_.push_back",
          "args": [
            "f"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InternalKey",
          "args": [
            "largest",
            "largest_seq",
            "kTypeValue"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "InternalKey",
          "container": "InternalKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "149-151",
          "snippet": "InternalKey(const Slice& user_key, SequenceNumber s, ValueType t) {\n    AppendInternalKey(&rep_, ParsedInternalKey(user_key, s, t));\n  }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\nInternalKey {\n  InternalKey(const Slice& user_key, SequenceNumber s, ValueType t) {\n      AppendInternalKey(&rep_, ParsedInternalKey(user_key, s, t));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "files_.size",
          "args": [],
          "line": 29
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  void Add(const char* smallest, const char* largest,\n             SequenceNumber smallest_seq = 100,\n             SequenceNumber largest_seq = 100) {\n      FileMetaData* f = new FileMetaData;\n      f->number = files_.size() + 1;\n      f->smallest = InternalKey(smallest, smallest_seq, kTypeValue);\n      f->largest = InternalKey(largest, largest_seq, kTypeValue);\n      files_.push_back(f);\n    }\n}"
  },
  {
    "function_name": "FindFileTest",
    "container": "FindFileTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set_test.cc",
    "lines": "17-17",
    "snippet": "FindFileTest() : disjoint_sorted_files_(true) { }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"db/version_set.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"db/version_set.h\"\n\nFindFileTest {\n  FindFileTest() : disjoint_sorted_files_(true) { }\n}"
  }
]