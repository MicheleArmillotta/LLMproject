[
  {
    "function_name": "RelayInventory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "643-651",
    "snippet": "inline void RelayInventory(const CInv& inv)\n{\n    // Put on lists to offer to the other nodes\n    {\n        LOCK(cs_vNodes);\n        BOOST_FOREACH(CNode* pnode, vNodes)\n            pnode->PushInventory(inv);\n    }\n}",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pnode->PushInventory",
          "args": [
            "inv"
          ],
          "line": 649
        },
        "resolved": true,
        "details": {
          "function_name": "PushInventory",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "306-313",
          "snippet": "void PushInventory(const CInv& inv)\n    {\n        {\n            LOCK(cs_inventory);\n            if (!setInventoryKnown.count(inv))\n                vInventoryToSend.push_back(inv);\n        }\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushInventory(const CInv& inv)\n      {\n          {\n              LOCK(cs_inventory);\n              if (!setInventoryKnown.count(inv))\n                  vInventoryToSend.push_back(inv);\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs_vNodes"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\ninline void RelayInventory(const CInv& inv)\n{\n    // Put on lists to offer to the other nodes\n    {\n        LOCK(cs_vNodes);\n        BOOST_FOREACH(CNode* pnode, vNodes)\n            pnode->PushInventory(inv);\n    }\n}"
  },
  {
    "function_name": "PushRequest",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "599-611",
    "snippet": "void PushRequest(const char* pszCommand, const T1& a1, const T2& a2,\n                     void (*fn)(void*, CDataStream&), void* param1)\n    {\n        uint256 hashReply;\n        RAND_bytes((unsigned char*)&hashReply, sizeof(hashReply));\n\n        {\n            LOCK(cs_mapRequests);\n            mapRequests[hashReply] = CRequestTracker(fn, param1);\n        }\n\n        PushMessage(pszCommand, hashReply, a1, a2);\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PushMessage",
          "args": [
            "pszCommand",
            "hashReply",
            "a1",
            "a2"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "PushMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "457-470",
          "snippet": "void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            vSend << a1 << a2 << a3;\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              vSend << a1 << a2 << a3;\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CRequestTracker",
          "args": [
            "fn",
            "param1"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs_mapRequests"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RAND_bytes",
          "args": [
            "(unsigned char*)&hashReply",
            "sizeof(hashReply)"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushRequest(const char* pszCommand, const T1& a1, const T2& a2,\n                       void (*fn)(void*, CDataStream&), void* param1)\n      {\n          uint256 hashReply;\n          RAND_bytes((unsigned char*)&hashReply, sizeof(hashReply));\n  \n          {\n              LOCK(cs_mapRequests);\n              mapRequests[hashReply] = CRequestTracker(fn, param1);\n          }\n  \n          PushMessage(pszCommand, hashReply, a1, a2);\n      }\n}"
  },
  {
    "function_name": "PushRequest",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "584-596",
    "snippet": "void PushRequest(const char* pszCommand, const T1& a1,\n                     void (*fn)(void*, CDataStream&), void* param1)\n    {\n        uint256 hashReply;\n        RAND_bytes((unsigned char*)&hashReply, sizeof(hashReply));\n\n        {\n            LOCK(cs_mapRequests);\n            mapRequests[hashReply] = CRequestTracker(fn, param1);\n        }\n\n        PushMessage(pszCommand, hashReply, a1);\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PushMessage",
          "args": [
            "pszCommand",
            "hashReply",
            "a1"
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "PushMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "441-454",
          "snippet": "void PushMessage(const char* pszCommand, const T1& a1, const T2& a2)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            vSend << a1 << a2;\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand, const T1& a1, const T2& a2)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              vSend << a1 << a2;\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CRequestTracker",
          "args": [
            "fn",
            "param1"
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs_mapRequests"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RAND_bytes",
          "args": [
            "(unsigned char*)&hashReply",
            "sizeof(hashReply)"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushRequest(const char* pszCommand, const T1& a1,\n                       void (*fn)(void*, CDataStream&), void* param1)\n      {\n          uint256 hashReply;\n          RAND_bytes((unsigned char*)&hashReply, sizeof(hashReply));\n  \n          {\n              LOCK(cs_mapRequests);\n              mapRequests[hashReply] = CRequestTracker(fn, param1);\n          }\n  \n          PushMessage(pszCommand, hashReply, a1);\n      }\n}"
  },
  {
    "function_name": "PushRequest",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "569-581",
    "snippet": "void PushRequest(const char* pszCommand,\n                     void (*fn)(void*, CDataStream&), void* param1)\n    {\n        uint256 hashReply;\n        RAND_bytes((unsigned char*)&hashReply, sizeof(hashReply));\n\n        {\n            LOCK(cs_mapRequests);\n            mapRequests[hashReply] = CRequestTracker(fn, param1);\n        }\n\n        PushMessage(pszCommand, hashReply);\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PushMessage",
          "args": [
            "pszCommand",
            "hashReply"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "PushMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "425-438",
          "snippet": "void PushMessage(const char* pszCommand, const T1& a1)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            vSend << a1;\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand, const T1& a1)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              vSend << a1;\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CRequestTracker",
          "args": [
            "fn",
            "param1"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs_mapRequests"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RAND_bytes",
          "args": [
            "(unsigned char*)&hashReply",
            "sizeof(hashReply)"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushRequest(const char* pszCommand,\n                       void (*fn)(void*, CDataStream&), void* param1)\n      {\n          uint256 hashReply;\n          RAND_bytes((unsigned char*)&hashReply, sizeof(hashReply));\n  \n          {\n              LOCK(cs_mapRequests);\n              mapRequests[hashReply] = CRequestTracker(fn, param1);\n          }\n  \n          PushMessage(pszCommand, hashReply);\n      }\n}"
  },
  {
    "function_name": "PushMessage",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "553-566",
    "snippet": "void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3, const T4& a4, const T5& a5, const T6& a6, const T7& a7, const T8& a8, const T9& a9)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            vSend << a1 << a2 << a3 << a4 << a5 << a6 << a7 << a8 << a9;\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AbortMessage",
          "args": [],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "AbortMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "349-360",
          "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EndMessage",
          "args": [],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "EndMessageAbortIfEmpty",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "394-403",
          "snippet": "void EndMessageAbortIfEmpty()\n    {\n        if (nHeaderStart < 0)\n            return;\n        int nSize = vSend.size() - nMessageStart;\n        if (nSize > 0)\n            EndMessage();\n        else\n            AbortMessage();\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void EndMessageAbortIfEmpty()\n      {\n          if (nHeaderStart < 0)\n              return;\n          int nSize = vSend.size() - nMessageStart;\n          if (nSize > 0)\n              EndMessage();\n          else\n              AbortMessage();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BeginMessage",
          "args": [
            "pszCommand"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "BeginMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "337-347",
          "snippet": "void BeginMessage(const char* pszCommand)\n    {\n        ENTER_CRITICAL_SECTION(cs_vSend);\n        if (nHeaderStart != -1)\n            AbortMessage();\n        nHeaderStart = vSend.size();\n        vSend << CMessageHeader(pszCommand, 0);\n        nMessageStart = vSend.size();\n        if (fDebug)\n            printf(\"sending: %s \", pszCommand);\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void BeginMessage(const char* pszCommand)\n      {\n          ENTER_CRITICAL_SECTION(cs_vSend);\n          if (nHeaderStart != -1)\n              AbortMessage();\n          nHeaderStart = vSend.size();\n          vSend << CMessageHeader(pszCommand, 0);\n          nMessageStart = vSend.size();\n          if (fDebug)\n              printf(\"sending: %s \", pszCommand);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3, const T4& a4, const T5& a5, const T6& a6, const T7& a7, const T8& a8, const T9& a9)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              vSend << a1 << a2 << a3 << a4 << a5 << a6 << a7 << a8 << a9;\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
  },
  {
    "function_name": "PushMessage",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "537-550",
    "snippet": "void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3, const T4& a4, const T5& a5, const T6& a6, const T7& a7, const T8& a8)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            vSend << a1 << a2 << a3 << a4 << a5 << a6 << a7 << a8;\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AbortMessage",
          "args": [],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "AbortMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "349-360",
          "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EndMessage",
          "args": [],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "EndMessageAbortIfEmpty",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "394-403",
          "snippet": "void EndMessageAbortIfEmpty()\n    {\n        if (nHeaderStart < 0)\n            return;\n        int nSize = vSend.size() - nMessageStart;\n        if (nSize > 0)\n            EndMessage();\n        else\n            AbortMessage();\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void EndMessageAbortIfEmpty()\n      {\n          if (nHeaderStart < 0)\n              return;\n          int nSize = vSend.size() - nMessageStart;\n          if (nSize > 0)\n              EndMessage();\n          else\n              AbortMessage();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BeginMessage",
          "args": [
            "pszCommand"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "BeginMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "337-347",
          "snippet": "void BeginMessage(const char* pszCommand)\n    {\n        ENTER_CRITICAL_SECTION(cs_vSend);\n        if (nHeaderStart != -1)\n            AbortMessage();\n        nHeaderStart = vSend.size();\n        vSend << CMessageHeader(pszCommand, 0);\n        nMessageStart = vSend.size();\n        if (fDebug)\n            printf(\"sending: %s \", pszCommand);\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void BeginMessage(const char* pszCommand)\n      {\n          ENTER_CRITICAL_SECTION(cs_vSend);\n          if (nHeaderStart != -1)\n              AbortMessage();\n          nHeaderStart = vSend.size();\n          vSend << CMessageHeader(pszCommand, 0);\n          nMessageStart = vSend.size();\n          if (fDebug)\n              printf(\"sending: %s \", pszCommand);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3, const T4& a4, const T5& a5, const T6& a6, const T7& a7, const T8& a8)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              vSend << a1 << a2 << a3 << a4 << a5 << a6 << a7 << a8;\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
  },
  {
    "function_name": "PushMessage",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "521-534",
    "snippet": "void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3, const T4& a4, const T5& a5, const T6& a6, const T7& a7)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            vSend << a1 << a2 << a3 << a4 << a5 << a6 << a7;\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AbortMessage",
          "args": [],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "AbortMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "349-360",
          "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EndMessage",
          "args": [],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "EndMessageAbortIfEmpty",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "394-403",
          "snippet": "void EndMessageAbortIfEmpty()\n    {\n        if (nHeaderStart < 0)\n            return;\n        int nSize = vSend.size() - nMessageStart;\n        if (nSize > 0)\n            EndMessage();\n        else\n            AbortMessage();\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void EndMessageAbortIfEmpty()\n      {\n          if (nHeaderStart < 0)\n              return;\n          int nSize = vSend.size() - nMessageStart;\n          if (nSize > 0)\n              EndMessage();\n          else\n              AbortMessage();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BeginMessage",
          "args": [
            "pszCommand"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "BeginMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "337-347",
          "snippet": "void BeginMessage(const char* pszCommand)\n    {\n        ENTER_CRITICAL_SECTION(cs_vSend);\n        if (nHeaderStart != -1)\n            AbortMessage();\n        nHeaderStart = vSend.size();\n        vSend << CMessageHeader(pszCommand, 0);\n        nMessageStart = vSend.size();\n        if (fDebug)\n            printf(\"sending: %s \", pszCommand);\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void BeginMessage(const char* pszCommand)\n      {\n          ENTER_CRITICAL_SECTION(cs_vSend);\n          if (nHeaderStart != -1)\n              AbortMessage();\n          nHeaderStart = vSend.size();\n          vSend << CMessageHeader(pszCommand, 0);\n          nMessageStart = vSend.size();\n          if (fDebug)\n              printf(\"sending: %s \", pszCommand);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3, const T4& a4, const T5& a5, const T6& a6, const T7& a7)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              vSend << a1 << a2 << a3 << a4 << a5 << a6 << a7;\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
  },
  {
    "function_name": "PushMessage",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "505-518",
    "snippet": "void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3, const T4& a4, const T5& a5, const T6& a6)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            vSend << a1 << a2 << a3 << a4 << a5 << a6;\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AbortMessage",
          "args": [],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "AbortMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "349-360",
          "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EndMessage",
          "args": [],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "EndMessageAbortIfEmpty",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "394-403",
          "snippet": "void EndMessageAbortIfEmpty()\n    {\n        if (nHeaderStart < 0)\n            return;\n        int nSize = vSend.size() - nMessageStart;\n        if (nSize > 0)\n            EndMessage();\n        else\n            AbortMessage();\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void EndMessageAbortIfEmpty()\n      {\n          if (nHeaderStart < 0)\n              return;\n          int nSize = vSend.size() - nMessageStart;\n          if (nSize > 0)\n              EndMessage();\n          else\n              AbortMessage();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BeginMessage",
          "args": [
            "pszCommand"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "BeginMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "337-347",
          "snippet": "void BeginMessage(const char* pszCommand)\n    {\n        ENTER_CRITICAL_SECTION(cs_vSend);\n        if (nHeaderStart != -1)\n            AbortMessage();\n        nHeaderStart = vSend.size();\n        vSend << CMessageHeader(pszCommand, 0);\n        nMessageStart = vSend.size();\n        if (fDebug)\n            printf(\"sending: %s \", pszCommand);\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void BeginMessage(const char* pszCommand)\n      {\n          ENTER_CRITICAL_SECTION(cs_vSend);\n          if (nHeaderStart != -1)\n              AbortMessage();\n          nHeaderStart = vSend.size();\n          vSend << CMessageHeader(pszCommand, 0);\n          nMessageStart = vSend.size();\n          if (fDebug)\n              printf(\"sending: %s \", pszCommand);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3, const T4& a4, const T5& a5, const T6& a6)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              vSend << a1 << a2 << a3 << a4 << a5 << a6;\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
  },
  {
    "function_name": "PushMessage",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "489-502",
    "snippet": "void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3, const T4& a4, const T5& a5)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            vSend << a1 << a2 << a3 << a4 << a5;\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AbortMessage",
          "args": [],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "AbortMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "349-360",
          "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EndMessage",
          "args": [],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "EndMessageAbortIfEmpty",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "394-403",
          "snippet": "void EndMessageAbortIfEmpty()\n    {\n        if (nHeaderStart < 0)\n            return;\n        int nSize = vSend.size() - nMessageStart;\n        if (nSize > 0)\n            EndMessage();\n        else\n            AbortMessage();\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void EndMessageAbortIfEmpty()\n      {\n          if (nHeaderStart < 0)\n              return;\n          int nSize = vSend.size() - nMessageStart;\n          if (nSize > 0)\n              EndMessage();\n          else\n              AbortMessage();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BeginMessage",
          "args": [
            "pszCommand"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "BeginMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "337-347",
          "snippet": "void BeginMessage(const char* pszCommand)\n    {\n        ENTER_CRITICAL_SECTION(cs_vSend);\n        if (nHeaderStart != -1)\n            AbortMessage();\n        nHeaderStart = vSend.size();\n        vSend << CMessageHeader(pszCommand, 0);\n        nMessageStart = vSend.size();\n        if (fDebug)\n            printf(\"sending: %s \", pszCommand);\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void BeginMessage(const char* pszCommand)\n      {\n          ENTER_CRITICAL_SECTION(cs_vSend);\n          if (nHeaderStart != -1)\n              AbortMessage();\n          nHeaderStart = vSend.size();\n          vSend << CMessageHeader(pszCommand, 0);\n          nMessageStart = vSend.size();\n          if (fDebug)\n              printf(\"sending: %s \", pszCommand);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3, const T4& a4, const T5& a5)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              vSend << a1 << a2 << a3 << a4 << a5;\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
  },
  {
    "function_name": "PushMessage",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "473-486",
    "snippet": "void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3, const T4& a4)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            vSend << a1 << a2 << a3 << a4;\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AbortMessage",
          "args": [],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "AbortMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "349-360",
          "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EndMessage",
          "args": [],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "EndMessageAbortIfEmpty",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "394-403",
          "snippet": "void EndMessageAbortIfEmpty()\n    {\n        if (nHeaderStart < 0)\n            return;\n        int nSize = vSend.size() - nMessageStart;\n        if (nSize > 0)\n            EndMessage();\n        else\n            AbortMessage();\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void EndMessageAbortIfEmpty()\n      {\n          if (nHeaderStart < 0)\n              return;\n          int nSize = vSend.size() - nMessageStart;\n          if (nSize > 0)\n              EndMessage();\n          else\n              AbortMessage();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BeginMessage",
          "args": [
            "pszCommand"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "BeginMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "337-347",
          "snippet": "void BeginMessage(const char* pszCommand)\n    {\n        ENTER_CRITICAL_SECTION(cs_vSend);\n        if (nHeaderStart != -1)\n            AbortMessage();\n        nHeaderStart = vSend.size();\n        vSend << CMessageHeader(pszCommand, 0);\n        nMessageStart = vSend.size();\n        if (fDebug)\n            printf(\"sending: %s \", pszCommand);\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void BeginMessage(const char* pszCommand)\n      {\n          ENTER_CRITICAL_SECTION(cs_vSend);\n          if (nHeaderStart != -1)\n              AbortMessage();\n          nHeaderStart = vSend.size();\n          vSend << CMessageHeader(pszCommand, 0);\n          nMessageStart = vSend.size();\n          if (fDebug)\n              printf(\"sending: %s \", pszCommand);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3, const T4& a4)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              vSend << a1 << a2 << a3 << a4;\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
  },
  {
    "function_name": "PushMessage",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "457-470",
    "snippet": "void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            vSend << a1 << a2 << a3;\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AbortMessage",
          "args": [],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "AbortMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "349-360",
          "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EndMessage",
          "args": [],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "EndMessageAbortIfEmpty",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "394-403",
          "snippet": "void EndMessageAbortIfEmpty()\n    {\n        if (nHeaderStart < 0)\n            return;\n        int nSize = vSend.size() - nMessageStart;\n        if (nSize > 0)\n            EndMessage();\n        else\n            AbortMessage();\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void EndMessageAbortIfEmpty()\n      {\n          if (nHeaderStart < 0)\n              return;\n          int nSize = vSend.size() - nMessageStart;\n          if (nSize > 0)\n              EndMessage();\n          else\n              AbortMessage();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BeginMessage",
          "args": [
            "pszCommand"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "BeginMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "337-347",
          "snippet": "void BeginMessage(const char* pszCommand)\n    {\n        ENTER_CRITICAL_SECTION(cs_vSend);\n        if (nHeaderStart != -1)\n            AbortMessage();\n        nHeaderStart = vSend.size();\n        vSend << CMessageHeader(pszCommand, 0);\n        nMessageStart = vSend.size();\n        if (fDebug)\n            printf(\"sending: %s \", pszCommand);\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void BeginMessage(const char* pszCommand)\n      {\n          ENTER_CRITICAL_SECTION(cs_vSend);\n          if (nHeaderStart != -1)\n              AbortMessage();\n          nHeaderStart = vSend.size();\n          vSend << CMessageHeader(pszCommand, 0);\n          nMessageStart = vSend.size();\n          if (fDebug)\n              printf(\"sending: %s \", pszCommand);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand, const T1& a1, const T2& a2, const T3& a3)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              vSend << a1 << a2 << a3;\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
  },
  {
    "function_name": "PushMessage",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "441-454",
    "snippet": "void PushMessage(const char* pszCommand, const T1& a1, const T2& a2)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            vSend << a1 << a2;\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AbortMessage",
          "args": [],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "AbortMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "349-360",
          "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EndMessage",
          "args": [],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "EndMessageAbortIfEmpty",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "394-403",
          "snippet": "void EndMessageAbortIfEmpty()\n    {\n        if (nHeaderStart < 0)\n            return;\n        int nSize = vSend.size() - nMessageStart;\n        if (nSize > 0)\n            EndMessage();\n        else\n            AbortMessage();\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void EndMessageAbortIfEmpty()\n      {\n          if (nHeaderStart < 0)\n              return;\n          int nSize = vSend.size() - nMessageStart;\n          if (nSize > 0)\n              EndMessage();\n          else\n              AbortMessage();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BeginMessage",
          "args": [
            "pszCommand"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "BeginMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "337-347",
          "snippet": "void BeginMessage(const char* pszCommand)\n    {\n        ENTER_CRITICAL_SECTION(cs_vSend);\n        if (nHeaderStart != -1)\n            AbortMessage();\n        nHeaderStart = vSend.size();\n        vSend << CMessageHeader(pszCommand, 0);\n        nMessageStart = vSend.size();\n        if (fDebug)\n            printf(\"sending: %s \", pszCommand);\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void BeginMessage(const char* pszCommand)\n      {\n          ENTER_CRITICAL_SECTION(cs_vSend);\n          if (nHeaderStart != -1)\n              AbortMessage();\n          nHeaderStart = vSend.size();\n          vSend << CMessageHeader(pszCommand, 0);\n          nMessageStart = vSend.size();\n          if (fDebug)\n              printf(\"sending: %s \", pszCommand);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand, const T1& a1, const T2& a2)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              vSend << a1 << a2;\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
  },
  {
    "function_name": "PushMessage",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "425-438",
    "snippet": "void PushMessage(const char* pszCommand, const T1& a1)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            vSend << a1;\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AbortMessage",
          "args": [],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "AbortMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "349-360",
          "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EndMessage",
          "args": [],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "EndMessageAbortIfEmpty",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "394-403",
          "snippet": "void EndMessageAbortIfEmpty()\n    {\n        if (nHeaderStart < 0)\n            return;\n        int nSize = vSend.size() - nMessageStart;\n        if (nSize > 0)\n            EndMessage();\n        else\n            AbortMessage();\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void EndMessageAbortIfEmpty()\n      {\n          if (nHeaderStart < 0)\n              return;\n          int nSize = vSend.size() - nMessageStart;\n          if (nSize > 0)\n              EndMessage();\n          else\n              AbortMessage();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BeginMessage",
          "args": [
            "pszCommand"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "BeginMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "337-347",
          "snippet": "void BeginMessage(const char* pszCommand)\n    {\n        ENTER_CRITICAL_SECTION(cs_vSend);\n        if (nHeaderStart != -1)\n            AbortMessage();\n        nHeaderStart = vSend.size();\n        vSend << CMessageHeader(pszCommand, 0);\n        nMessageStart = vSend.size();\n        if (fDebug)\n            printf(\"sending: %s \", pszCommand);\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void BeginMessage(const char* pszCommand)\n      {\n          ENTER_CRITICAL_SECTION(cs_vSend);\n          if (nHeaderStart != -1)\n              AbortMessage();\n          nHeaderStart = vSend.size();\n          vSend << CMessageHeader(pszCommand, 0);\n          nMessageStart = vSend.size();\n          if (fDebug)\n              printf(\"sending: %s \", pszCommand);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand, const T1& a1)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              vSend << a1;\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
  },
  {
    "function_name": "PushMessage",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "410-422",
    "snippet": "void PushMessage(const char* pszCommand)\n    {\n        try\n        {\n            BeginMessage(pszCommand);\n            EndMessage();\n        }\n        catch (...)\n        {\n            AbortMessage();\n            throw;\n        }\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AbortMessage",
          "args": [],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "AbortMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "349-360",
          "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EndMessage",
          "args": [],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "EndMessageAbortIfEmpty",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "394-403",
          "snippet": "void EndMessageAbortIfEmpty()\n    {\n        if (nHeaderStart < 0)\n            return;\n        int nSize = vSend.size() - nMessageStart;\n        if (nSize > 0)\n            EndMessage();\n        else\n            AbortMessage();\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void EndMessageAbortIfEmpty()\n      {\n          if (nHeaderStart < 0)\n              return;\n          int nSize = vSend.size() - nMessageStart;\n          if (nSize > 0)\n              EndMessage();\n          else\n              AbortMessage();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BeginMessage",
          "args": [
            "pszCommand"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "BeginMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "337-347",
          "snippet": "void BeginMessage(const char* pszCommand)\n    {\n        ENTER_CRITICAL_SECTION(cs_vSend);\n        if (nHeaderStart != -1)\n            AbortMessage();\n        nHeaderStart = vSend.size();\n        vSend << CMessageHeader(pszCommand, 0);\n        nMessageStart = vSend.size();\n        if (fDebug)\n            printf(\"sending: %s \", pszCommand);\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void BeginMessage(const char* pszCommand)\n      {\n          ENTER_CRITICAL_SECTION(cs_vSend);\n          if (nHeaderStart != -1)\n              AbortMessage();\n          nHeaderStart = vSend.size();\n          vSend << CMessageHeader(pszCommand, 0);\n          nMessageStart = vSend.size();\n          if (fDebug)\n              printf(\"sending: %s \", pszCommand);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushMessage(const char* pszCommand)\n      {\n          try\n          {\n              BeginMessage(pszCommand);\n              EndMessage();\n          }\n          catch (...)\n          {\n              AbortMessage();\n              throw;\n          }\n      }\n}"
  },
  {
    "function_name": "EndMessageAbortIfEmpty",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "394-403",
    "snippet": "void EndMessageAbortIfEmpty()\n    {\n        if (nHeaderStart < 0)\n            return;\n        int nSize = vSend.size() - nMessageStart;\n        if (nSize > 0)\n            EndMessage();\n        else\n            AbortMessage();\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AbortMessage",
          "args": [],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "AbortMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "349-360",
          "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EndMessage",
          "args": [],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "EndMessageAbortIfEmpty",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "394-403",
          "snippet": "void EndMessageAbortIfEmpty()\n    {\n        if (nHeaderStart < 0)\n            return;\n        int nSize = vSend.size() - nMessageStart;\n        if (nSize > 0)\n            EndMessage();\n        else\n            AbortMessage();\n    }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "vSend.size",
          "args": [],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void EndMessageAbortIfEmpty()\n      {\n          if (nHeaderStart < 0)\n              return;\n          int nSize = vSend.size() - nMessageStart;\n          if (nSize > 0)\n              EndMessage();\n          else\n              AbortMessage();\n      }\n}"
  },
  {
    "function_name": "EndMessage",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "362-392",
    "snippet": "void EndMessage()\n    {\n        if (mapArgs.count(\"-dropmessagestest\") && GetRand(atoi(mapArgs[\"-dropmessagestest\"])) == 0)\n        {\n            printf(\"dropmessages DROPPING SEND MESSAGE\\n\");\n            AbortMessage();\n            return;\n        }\n\n        if (nHeaderStart < 0)\n            return;\n\n        // Set the size\n        unsigned int nSize = vSend.size() - nMessageStart;\n        memcpy((char*)&vSend[nHeaderStart] + CMessageHeader::MESSAGE_SIZE_OFFSET, &nSize, sizeof(nSize));\n\n        // Set the checksum\n        uint256 hash = Hash(vSend.begin() + nMessageStart, vSend.end());\n        unsigned int nChecksum = 0;\n        memcpy(&nChecksum, &hash, sizeof(nChecksum));\n        assert(nMessageStart - nHeaderStart >= CMessageHeader::CHECKSUM_OFFSET + sizeof(nChecksum));\n        memcpy((char*)&vSend[nHeaderStart] + CMessageHeader::CHECKSUM_OFFSET, &nChecksum, sizeof(nChecksum));\n\n        if (fDebug) {\n            printf(\"(%d bytes)\\n\", nSize);\n        }\n\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "LEAVE_CRITICAL_SECTION",
          "args": [
            "cs_vSend"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"(%d bytes)\\n\"",
            "nSize"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "(char*)&vSend[nHeaderStart] + CMessageHeader::CHECKSUM_OFFSET",
            "&nChecksum",
            "sizeof(nChecksum)"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "nMessageStart - nHeaderStart >= CMessageHeader::CHECKSUM_OFFSET + sizeof(nChecksum)"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&nChecksum",
            "&hash",
            "sizeof(nChecksum)"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Hash",
          "args": [
            "vSend.begin() + nMessageStart",
            "vSend.end()"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "Hash",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "34-38",
          "snippet": "inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n{\n    // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n    return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n  {\n      // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n      return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vSend.end",
          "args": [],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vSend.begin",
          "args": [],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "(char*)&vSend[nHeaderStart] + CMessageHeader::MESSAGE_SIZE_OFFSET",
            "&nSize",
            "sizeof(nSize)"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vSend.size",
          "args": [],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "AbortMessage",
          "args": [],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "AbortMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "349-360",
          "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"dropmessages DROPPING SEND MESSAGE\\n\""
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetRand",
          "args": [
            "atoi(mapArgs[\"-dropmessagestest\"])"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "GetRandInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "188-191",
          "snippet": "int GetRandInt(int nMax)\n{\n    return GetRand(nMax);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nint GetRandInt(int nMax)\n{\n    return GetRand(nMax);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "mapArgs[\"-dropmessagestest\"]"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "atoi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "292-295",
          "snippet": "inline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapArgs.count",
          "args": [
            "\"-dropmessagestest\""
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void EndMessage()\n      {\n          if (mapArgs.count(\"-dropmessagestest\") && GetRand(atoi(mapArgs[\"-dropmessagestest\"])) == 0)\n          {\n              printf(\"dropmessages DROPPING SEND MESSAGE\\n\");\n              AbortMessage();\n              return;\n          }\n  \n          if (nHeaderStart < 0)\n              return;\n  \n          // Set the size\n          unsigned int nSize = vSend.size() - nMessageStart;\n          memcpy((char*)&vSend[nHeaderStart] + CMessageHeader::MESSAGE_SIZE_OFFSET, &nSize, sizeof(nSize));\n  \n          // Set the checksum\n          uint256 hash = Hash(vSend.begin() + nMessageStart, vSend.end());\n          unsigned int nChecksum = 0;\n          memcpy(&nChecksum, &hash, sizeof(nChecksum));\n          assert(nMessageStart - nHeaderStart >= CMessageHeader::CHECKSUM_OFFSET + sizeof(nChecksum));\n          memcpy((char*)&vSend[nHeaderStart] + CMessageHeader::CHECKSUM_OFFSET, &nChecksum, sizeof(nChecksum));\n  \n          if (fDebug) {\n              printf(\"(%d bytes)\\n\", nSize);\n          }\n  \n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n      }\n}"
  },
  {
    "function_name": "AbortMessage",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "349-360",
    "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"(aborted)\\n\""
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LEAVE_CRITICAL_SECTION",
          "args": [
            "cs_vSend"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vSend.resize",
          "args": [
            "nHeaderStart"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
  },
  {
    "function_name": "BeginMessage",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "337-347",
    "snippet": "void BeginMessage(const char* pszCommand)\n    {\n        ENTER_CRITICAL_SECTION(cs_vSend);\n        if (nHeaderStart != -1)\n            AbortMessage();\n        nHeaderStart = vSend.size();\n        vSend << CMessageHeader(pszCommand, 0);\n        nMessageStart = vSend.size();\n        if (fDebug)\n            printf(\"sending: %s \", pszCommand);\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"sending: %s \"",
            "pszCommand"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vSend.size",
          "args": [],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CMessageHeader",
          "args": [
            "pszCommand",
            "0"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "CMessageHeader",
          "container": "CMessageHeader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
          "lines": "30-36",
          "snippet": "CMessageHeader::CMessageHeader(const char* pszCommand, unsigned int nMessageSizeIn)\n{\n    memcpy(pchMessageStart, ::pchMessageStart, sizeof(pchMessageStart));\n    strncpy(pchCommand, pszCommand, COMMAND_SIZE);\n    nMessageSize = nMessageSizeIn;\n    nChecksum = 0;\n}",
          "includes": [
            "# include <arpa/inet.h>",
            "#include \"netbase.h\"",
            "#include \"util.h\"",
            "#include \"protocol.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCMessageHeader {\n  CMessageHeader::CMessageHeader(const char* pszCommand, unsigned int nMessageSizeIn)\n  {\n      memcpy(pchMessageStart, ::pchMessageStart, sizeof(pchMessageStart));\n      strncpy(pchCommand, pszCommand, COMMAND_SIZE);\n      nMessageSize = nMessageSizeIn;\n      nChecksum = 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "AbortMessage",
          "args": [],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "AbortMessage",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "349-360",
          "snippet": "void AbortMessage()\n    {\n        if (nHeaderStart < 0)\n            return;\n        vSend.resize(nHeaderStart);\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        LEAVE_CRITICAL_SECTION(cs_vSend);\n\n        if (fDebug)\n            printf(\"(aborted)\\n\");\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AbortMessage()\n      {\n          if (nHeaderStart < 0)\n              return;\n          vSend.resize(nHeaderStart);\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          LEAVE_CRITICAL_SECTION(cs_vSend);\n  \n          if (fDebug)\n              printf(\"(aborted)\\n\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ENTER_CRITICAL_SECTION",
          "args": [
            "cs_vSend"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void BeginMessage(const char* pszCommand)\n      {\n          ENTER_CRITICAL_SECTION(cs_vSend);\n          if (nHeaderStart != -1)\n              AbortMessage();\n          nHeaderStart = vSend.size();\n          vSend << CMessageHeader(pszCommand, 0);\n          nMessageStart = vSend.size();\n          if (fDebug)\n              printf(\"sending: %s \", pszCommand);\n      }\n}"
  },
  {
    "function_name": "AskFor",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "315-333",
    "snippet": "void AskFor(const CInv& inv)\n    {\n        // We're using mapAskFor as a priority queue,\n        // the key is the earliest time the request can be sent\n        int64_t& nRequestTime = mapAlreadyAskedFor[inv];\n        if (fDebugNet)\n            printf(\"askfor %s   %\"PRId64\" (%s)\\n\", inv.ToString().c_str(), nRequestTime, DateTimeStrFormat(\"%H:%M:%S\", nRequestTime/1000000).c_str());\n\n        // Make sure not to reuse time indexes to keep things in the same order\n        int64_t nNow = (GetTime() - 1) * 1000000;\n        static int64_t nLastTime;\n        ++nLastTime;\n        nNow = std::max(nNow, nLastTime);\n        nLastTime = nNow;\n\n        // Each retry is 2 minutes after the last\n        nRequestTime = std::max(nRequestTime + 2 * 60 * 1000000, nNow);\n        mapAskFor.insert(std::make_pair(nRequestTime, inv));\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mapAskFor.insert",
          "args": [
            "std::make_pair(nRequestTime, inv)"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "61-65",
          "snippet": "void CBloomFilter::insert(const uint256& hash)\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    insert(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  void CBloomFilter::insert(const uint256& hash)\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      insert(data);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "nRequestTime",
            "inv"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::max",
          "args": [
            "nRequestTime + 2 * 60 * 1000000",
            "nNow"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::max",
          "args": [
            "nNow",
            "nLastTime"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetTime",
          "args": [],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "GetTimeMillis",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "370-374",
          "snippet": "inline int64_t GetTimeMillis()\n{\n    return (boost::posix_time::ptime(boost::posix_time::microsec_clock::universal_time()) -\n            boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_milliseconds();\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t GetTimeMillis()\n{\n    return (boost::posix_time::ptime(boost::posix_time::microsec_clock::universal_time()) -\n            boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_milliseconds();\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"askfor %s   %\"PRId64\" (%s)\\n\"",
            "inv.ToString().c_str()",
            "nRequestTime",
            "DateTimeStrFormat(\"%H:%M:%S\", nRequestTime/1000000).c_str()"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DateTimeStrFormat",
          "args": [],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DateTimeStrFormat",
          "args": [
            "\"%H:%M:%S\"",
            "nRequestTime/1000000"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "DateTimeStrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "376-383",
          "snippet": "inline std::string DateTimeStrFormat(const char* pszFormat, int64_t nTime)\n{\n    time_t n = nTime;\n    struct tm* ptmTime = gmtime(&n);\n    char pszTime[200];\n    strftime(pszTime, sizeof(pszTime), pszFormat, ptmTime);\n    return pszTime;\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline std::string DateTimeStrFormat(const char* pszFormat, int64_t nTime)\n{\n    time_t n = nTime;\n    struct tm* ptmTime = gmtime(&n);\n    char pszTime[200];\n    strftime(pszTime, sizeof(pszTime), pszFormat, ptmTime);\n    return pszTime;\n}"
        }
      },
      {
        "call_info": {
          "callee": "inv.ToString",
          "args": [],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AskFor(const CInv& inv)\n      {\n          // We're using mapAskFor as a priority queue,\n          // the key is the earliest time the request can be sent\n          int64_t& nRequestTime = mapAlreadyAskedFor[inv];\n          if (fDebugNet)\n              printf(\"askfor %s   %\"PRId64\" (%s)\\n\", inv.ToString().c_str(), nRequestTime, DateTimeStrFormat(\"%H:%M:%S\", nRequestTime/1000000).c_str());\n  \n          // Make sure not to reuse time indexes to keep things in the same order\n          int64_t nNow = (GetTime() - 1) * 1000000;\n          static int64_t nLastTime;\n          ++nLastTime;\n          nNow = std::max(nNow, nLastTime);\n          nLastTime = nNow;\n  \n          // Each retry is 2 minutes after the last\n          nRequestTime = std::max(nRequestTime + 2 * 60 * 1000000, nNow);\n          mapAskFor.insert(std::make_pair(nRequestTime, inv));\n      }\n}"
  },
  {
    "function_name": "PushInventory",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "306-313",
    "snippet": "void PushInventory(const CInv& inv)\n    {\n        {\n            LOCK(cs_inventory);\n            if (!setInventoryKnown.count(inv))\n                vInventoryToSend.push_back(inv);\n        }\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vInventoryToSend.push_back",
          "args": [
            "inv"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setInventoryKnown.count",
          "args": [
            "inv"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs_inventory"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushInventory(const CInv& inv)\n      {\n          {\n              LOCK(cs_inventory);\n              if (!setInventoryKnown.count(inv))\n                  vInventoryToSend.push_back(inv);\n          }\n      }\n}"
  },
  {
    "function_name": "AddInventoryKnown",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "298-304",
    "snippet": "void AddInventoryKnown(const CInv& inv)\n    {\n        {\n            LOCK(cs_inventory);\n            setInventoryKnown.insert(inv);\n        }\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setInventoryKnown.insert",
          "args": [
            "inv"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "61-65",
          "snippet": "void CBloomFilter::insert(const uint256& hash)\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    insert(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  void CBloomFilter::insert(const uint256& hash)\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      insert(data);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "cs_inventory"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AddInventoryKnown(const CInv& inv)\n      {\n          {\n              LOCK(cs_inventory);\n              setInventoryKnown.insert(inv);\n          }\n      }\n}"
  },
  {
    "function_name": "PushAddress",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "288-295",
    "snippet": "void PushAddress(const CAddress& addr)\n    {\n        // Known checking here is only to save space from duplicates.\n        // SendMessages will filter it again for knowns that were added\n        // after addresses were pushed.\n        if (addr.IsValid() && !setAddrKnown.count(addr))\n            vAddrToSend.push_back(addr);\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vAddrToSend.push_back",
          "args": [
            "addr"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setAddrKnown.count",
          "args": [
            "addr"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "addr.IsValid",
          "args": [],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "IsValid",
          "container": "CNetAddr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "725-759",
          "snippet": "bool CNetAddr::IsValid() const\n{\n    // Cleanup 3-byte shifted addresses caused by garbage in size field\n    // of addr messages from versions before 0.2.9 checksum.\n    // Two consecutive addr messages look like this:\n    // header20 vectorlen3 addr26 addr26 addr26 header20 vectorlen3 addr26 addr26 addr26...\n    // so if the first length field is garbled, it reads the second batch\n    // of addr misaligned by 3 bytes.\n    if (memcmp(ip, pchIPv4+3, sizeof(pchIPv4)-3) == 0)\n        return false;\n\n    // unspecified IPv6 address (::/128)\n    unsigned char ipNone[16] = {};\n    if (memcmp(ip, ipNone, 16) == 0)\n        return false;\n\n    // documentation IPv6 address\n    if (IsRFC3849())\n        return false;\n\n    if (IsIPv4())\n    {\n        // INADDR_NONE\n        uint32_t ipNone = INADDR_NONE;\n        if (memcmp(ip+12, &ipNone, 4) == 0)\n            return false;\n\n        // 0\n        ipNone = 0;\n        if (memcmp(ip+12, &ipNone, 4) == 0)\n            return false;\n    }\n\n    return true;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const unsigned char pchIPv4[12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nstatic const unsigned char pchIPv4[12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff };\n\nCNetAddr {\n  bool CNetAddr::IsValid() const\n  {\n      // Cleanup 3-byte shifted addresses caused by garbage in size field\n      // of addr messages from versions before 0.2.9 checksum.\n      // Two consecutive addr messages look like this:\n      // header20 vectorlen3 addr26 addr26 addr26 header20 vectorlen3 addr26 addr26 addr26...\n      // so if the first length field is garbled, it reads the second batch\n      // of addr misaligned by 3 bytes.\n      if (memcmp(ip, pchIPv4+3, sizeof(pchIPv4)-3) == 0)\n          return false;\n  \n      // unspecified IPv6 address (::/128)\n      unsigned char ipNone[16] = {};\n      if (memcmp(ip, ipNone, 16) == 0)\n          return false;\n  \n      // documentation IPv6 address\n      if (IsRFC3849())\n          return false;\n  \n      if (IsIPv4())\n      {\n          // INADDR_NONE\n          uint32_t ipNone = INADDR_NONE;\n          if (memcmp(ip+12, &ipNone, 4) == 0)\n              return false;\n  \n          // 0\n          ipNone = 0;\n          if (memcmp(ip+12, &ipNone, 4) == 0)\n              return false;\n      }\n  \n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void PushAddress(const CAddress& addr)\n      {\n          // Known checking here is only to save space from duplicates.\n          // SendMessages will filter it again for knowns that were added\n          // after addresses were pushed.\n          if (addr.IsValid() && !setAddrKnown.count(addr))\n              vAddrToSend.push_back(addr);\n      }\n}"
  },
  {
    "function_name": "AddAddressKnown",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "283-286",
    "snippet": "void AddAddressKnown(const CAddress& addr)\n    {\n        setAddrKnown.insert(addr);\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setAddrKnown.insert",
          "args": [
            "addr"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "61-65",
          "snippet": "void CBloomFilter::insert(const uint256& hash)\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    insert(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  void CBloomFilter::insert(const uint256& hash)\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      insert(data);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void AddAddressKnown(const CAddress& addr)\n      {\n          setAddrKnown.insert(addr);\n      }\n}"
  },
  {
    "function_name": "Release",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "276-279",
    "snippet": "void Release()\n    {\n        nRefCount--;\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void Release()\n      {\n          nRefCount--;\n      }\n}"
  },
  {
    "function_name": "GetRefCount",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "264-268",
    "snippet": "int GetRefCount()\n    {\n        assert(nRefCount >= 0);\n        return nRefCount;\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "nRefCount >= 0"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  int GetRefCount()\n      {\n          assert(nRefCount >= 0);\n          return nRefCount;\n      }\n}"
  },
  {
    "function_name": "CNode",
    "container": "CNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "214-247",
    "snippet": "CNode(SOCKET hSocketIn, CAddress addrIn, std::string addrNameIn = \"\", bool fInboundIn=false) : vSend(SER_NETWORK, MIN_PROTO_VERSION), vRecv(SER_NETWORK, MIN_PROTO_VERSION)\n    {\n        nServices = 0;\n        hSocket = hSocketIn;\n        nLastSend = 0;\n        nLastRecv = 0;\n        nLastSendEmpty = GetTime();\n        nTimeConnected = GetTime();\n        nHeaderStart = -1;\n        nMessageStart = -1;\n        addr = addrIn;\n        addrName = addrNameIn == \"\" ? addr.ToStringIPPort() : addrNameIn;\n        nVersion = 0;\n        strSubVer = \"\";\n        fOneShot = false;\n        fClient = false; // set by version message\n        fInbound = fInboundIn;\n        fNetworkNode = false;\n        fSuccessfullyConnected = false;\n        fDisconnect = false;\n        nRefCount = 0;\n        hashContinue = 0;\n        pindexLastGetBlocksBegin = 0;\n        hashLastGetBlocksEnd = 0;\n        nStartingHeight = -1;\n        fGetAddr = false;\n        nMisbehavior = 0;\n        hashCheckpointKnown = 0;\n        setInventoryKnown.max_size(SendBufferSize() / 1000);\n\n        // Be shy and don't send version until we hear\n        if (hSocket != INVALID_SOCKET && !fInbound)\n            PushVersion();\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PushVersion",
          "args": [],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "PushVersion",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.cpp",
          "lines": "567-576",
          "snippet": "void CNode::PushVersion()\n{\n    int64 nTime = GetAdjustedTime();\n    CAddress addrYou = (addr.IsRoutable() && !IsProxy(addr) ? addr : CAddress(CService(\"0.0.0.0\",0)));\n    CAddress addrMe = GetLocalAddress(&addr);\n    RAND_bytes((unsigned char*)&nLocalHostNonce, sizeof(nLocalHostNonce));\n    printf(\"send version message: version %d, blocks=%d, us=%s, them=%s, peer=%s\\n\", PROTOCOL_VERSION, nBestHeight, addrMe.ToString().c_str(), addrYou.ToString().c_str(), addr.ToString().c_str());\n    PushMessage(\"version\", PROTOCOL_VERSION, nLocalServices, nTime, addrYou, addrMe,\n                nLocalHostNonce, FormatSubVersion(CLIENT_NAME, CLIENT_VERSION, std::vector<string>()), nBestHeight);\n}",
          "includes": [
            "#include <miniupnpc/upnperrors.h>",
            "#include <miniupnpc/upnpcommands.h>",
            "#include <miniupnpc/miniupnpc.h>",
            "#include <miniupnpc/miniwget.h>",
            "#include <string.h>",
            "#include \"ui_interface.h\"",
            "#include \"addrman.h\"",
            "#include \"strlcpy.h\"",
            "#include \"init.h\"",
            "#include \"ntp.h\"",
            "#include \"net.h\"",
            "#include \"db.h\"",
            "#include \"irc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "uint64_t nLocalServices = (fClient ? 0 : NODE_NETWORK);",
            "CAddress addrSeenByPeer(CService(\"0.0.0.0\", 0), nLocalServices);",
            "uint64_t nLocalHostNonce = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <miniupnpc/upnperrors.h>\n#include <miniupnpc/upnpcommands.h>\n#include <miniupnpc/miniupnpc.h>\n#include <miniupnpc/miniwget.h>\n#include <string.h>\n#include \"ui_interface.h\"\n#include \"addrman.h\"\n#include \"strlcpy.h\"\n#include \"init.h\"\n#include \"ntp.h\"\n#include \"net.h\"\n#include \"db.h\"\n#include \"irc.h\"\n\nuint64_t nLocalServices = (fClient ? 0 : NODE_NETWORK);\nCAddress addrSeenByPeer(CService(\"0.0.0.0\", 0), nLocalServices);\nuint64_t nLocalHostNonce = 0;\n\nCNode {\n  void CNode::PushVersion()\n  {\n      int64 nTime = GetAdjustedTime();\n      CAddress addrYou = (addr.IsRoutable() && !IsProxy(addr) ? addr : CAddress(CService(\"0.0.0.0\",0)));\n      CAddress addrMe = GetLocalAddress(&addr);\n      RAND_bytes((unsigned char*)&nLocalHostNonce, sizeof(nLocalHostNonce));\n      printf(\"send version message: version %d, blocks=%d, us=%s, them=%s, peer=%s\\n\", PROTOCOL_VERSION, nBestHeight, addrMe.ToString().c_str(), addrYou.ToString().c_str(), addr.ToString().c_str());\n      PushMessage(\"version\", PROTOCOL_VERSION, nLocalServices, nTime, addrYou, addrMe,\n                  nLocalHostNonce, FormatSubVersion(CLIENT_NAME, CLIENT_VERSION, std::vector<string>()), nBestHeight);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setInventoryKnown.max_size",
          "args": [
            "SendBufferSize() / 1000"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "max_size",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "87-97",
          "snippet": "size_type max_size(size_type s)\n    {\n        if (s)\n            while (map.size() > s)\n            {\n                map.erase(rmap.begin()->second);\n                rmap.erase(rmap.begin());\n            }\n        nMaxSize = s;\n        return nMaxSize;\n    }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type max_size(size_type s)\n      {\n          if (s)\n              while (map.size() > s)\n              {\n                  map.erase(rmap.begin()->second);\n                  rmap.erase(rmap.begin());\n              }\n          nMaxSize = s;\n          return nMaxSize;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SendBufferSize",
          "args": [],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "SendBufferSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "30-30",
          "snippet": "inline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\ninline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }"
        }
      },
      {
        "call_info": {
          "callee": "addr.ToStringIPPort",
          "args": [],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "ToStringIPPort",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1163-1170",
          "snippet": "std::string CService::ToStringIPPort() const\n{\n    if (IsIPv4() || IsTor() || IsI2P()) {\n        return ToStringIP() + \":\" + ToStringPort();\n    } else {\n        return \"[\" + ToStringIP() + \"]:\" + ToStringPort();\n    }\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToStringIPPort() const\n  {\n      if (IsIPv4() || IsTor() || IsI2P()) {\n          return ToStringIP() + \":\" + ToStringPort();\n      } else {\n          return \"[\" + ToStringIP() + \"]:\" + ToStringPort();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetTime",
          "args": [],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "GetTimeMillis",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "370-374",
          "snippet": "inline int64_t GetTimeMillis()\n{\n    return (boost::posix_time::ptime(boost::posix_time::microsec_clock::universal_time()) -\n            boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_milliseconds();\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t GetTimeMillis()\n{\n    return (boost::posix_time::ptime(boost::posix_time::microsec_clock::universal_time()) -\n            boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_milliseconds();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  CNode(SOCKET hSocketIn, CAddress addrIn, std::string addrNameIn = \"\", bool fInboundIn=false) : vSend(SER_NETWORK, MIN_PROTO_VERSION), vRecv(SER_NETWORK, MIN_PROTO_VERSION)\n      {\n          nServices = 0;\n          hSocket = hSocketIn;\n          nLastSend = 0;\n          nLastRecv = 0;\n          nLastSendEmpty = GetTime();\n          nTimeConnected = GetTime();\n          nHeaderStart = -1;\n          nMessageStart = -1;\n          addr = addrIn;\n          addrName = addrNameIn == \"\" ? addr.ToStringIPPort() : addrNameIn;\n          nVersion = 0;\n          strSubVer = \"\";\n          fOneShot = false;\n          fClient = false; // set by version message\n          fInbound = fInboundIn;\n          fNetworkNode = false;\n          fSuccessfullyConnected = false;\n          fDisconnect = false;\n          nRefCount = 0;\n          hashContinue = 0;\n          pindexLastGetBlocksBegin = 0;\n          hashLastGetBlocksEnd = 0;\n          nStartingHeight = -1;\n          fGetAddr = false;\n          nMisbehavior = 0;\n          hashCheckpointKnown = 0;\n          setInventoryKnown.max_size(SendBufferSize() / 1000);\n  \n          // Be shy and don't send version until we hear\n          if (hSocket != INVALID_SOCKET && !fInbound)\n              PushVersion();\n      }\n}"
  },
  {
    "function_name": "IsNull",
    "container": "CRequestTracker",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "89-92",
    "snippet": "bool IsNull()\n    {\n        return fn == NULL;\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCRequestTracker {\n  bool IsNull()\n      {\n          return fn == NULL;\n      }\n}"
  },
  {
    "function_name": "CRequestTracker",
    "container": "CRequestTracker",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "83-87",
    "snippet": "explicit CRequestTracker(void (*fnIn)(void*, CDataStream&)=NULL, void* param1In=NULL)\n    {\n        fn = fnIn;\n        param1 = param1In;\n    }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCRequestTracker {\n  explicit CRequestTracker(void (*fnIn)(void*, CDataStream&)=NULL, void* param1In=NULL)\n      {\n          fn = fnIn;\n          param1 = param1In;\n      }\n}"
  },
  {
    "function_name": "SendBufferSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "30-30",
    "snippet": "inline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetArg",
          "args": [
            "\"-maxsendbuffer\"",
            "1*1000"
          ],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "GetArg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "562-567",
          "snippet": "int64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "map<string, string> mapArgs;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nint64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\ninline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }"
  },
  {
    "function_name": "ReceiveBufferSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
    "lines": "29-29",
    "snippet": "inline unsigned int ReceiveBufferSize() { return 1000*GetArg(\"-maxreceivebuffer\", 5*1000); }",
    "includes": [
      "#include \"addrman.h\"",
      "#include \"protocol.h\"",
      "#include \"netbase.h\"",
      "#include \"mruset.h\"",
      "#include <arpa/inet.h>",
      "#include <openssl/rand.h>",
      "#include <boost/foreach.hpp>",
      "#include <boost/array.hpp>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetArg",
          "args": [
            "\"-maxreceivebuffer\"",
            "5*1000"
          ],
          "line": 29
        },
        "resolved": true,
        "details": {
          "function_name": "GetArg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "562-567",
          "snippet": "int64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "map<string, string> mapArgs;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nint64_t GetArg(const std::string& strArg, int64_t nDefault)\n{\n    if (mapArgs.count(strArg))\n        return atoi64(mapArgs[strArg]);\n    return nDefault;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\ninline unsigned int ReceiveBufferSize() { return 1000*GetArg(\"-maxreceivebuffer\", 5*1000); }"
  }
]