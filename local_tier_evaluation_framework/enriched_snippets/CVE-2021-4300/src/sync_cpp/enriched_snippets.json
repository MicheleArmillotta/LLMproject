[
  {
    "function_name": "LeaveCritical",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
    "lines": "123-126",
    "snippet": "void LeaveCritical()\n{\n    pop_lock();\n}",
    "includes": [
      "#include <boost/foreach.hpp>",
      "#include \"util.h\"",
      "#include \"sync.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pop_lock",
          "args": [],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "pop_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
          "lines": "106-116",
          "snippet": "static void pop_lock()\n{\n    if (fDebug)\n    {\n        const CLockLocation& locklocation = (*lockstack).rbegin()->second;\n        printf(\"Unlocked: %s\\n\", locklocation.ToString().c_str());\n    }\n    dd_mutex.lock();\n    (*lockstack).pop_back();\n    dd_mutex.unlock();\n}",
          "includes": [
            "#include <boost/foreach.hpp>",
            "#include \"util.h\"",
            "#include \"sync.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nstatic void pop_lock()\n{\n    if (fDebug)\n    {\n        const CLockLocation& locklocation = (*lockstack).rbegin()->second;\n        printf(\"Unlocked: %s\\n\", locklocation.ToString().c_str());\n    }\n    dd_mutex.lock();\n    (*lockstack).pop_back();\n    dd_mutex.unlock();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nvoid LeaveCritical()\n{\n    pop_lock();\n}"
  },
  {
    "function_name": "EnterCritical",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
    "lines": "118-121",
    "snippet": "void EnterCritical(const char* pszName, const char* pszFile, int nLine, void* cs, bool fTry)\n{\n    push_lock(cs, CLockLocation(pszName, pszFile, nLine), fTry);\n}",
    "includes": [
      "#include <boost/foreach.hpp>",
      "#include \"util.h\"",
      "#include \"sync.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "push_lock",
          "args": [
            "cs",
            "CLockLocation(pszName, pszFile, nLine)",
            "fTry"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "push_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
          "lines": "76-104",
          "snippet": "static void push_lock(void* c, const CLockLocation& locklocation, bool fTry)\n{\n    if (lockstack.get() == NULL)\n        lockstack.reset(new LockStack);\n\n    if (fDebug) printf(\"Locking: %s\\n\", locklocation.ToString().c_str());\n    dd_mutex.lock();\n\n    (*lockstack).push_back(std::make_pair(c, locklocation));\n\n    if (!fTry) {\n        BOOST_FOREACH(const PAIRTYPE(void*, CLockLocation)& i, (*lockstack)) {\n            if (i.first == c) break;\n\n            std::pair<void*, void*> p1 = std::make_pair(i.first, c);\n            if (lockorders.count(p1))\n                continue;\n            lockorders[p1] = (*lockstack);\n\n            std::pair<void*, void*> p2 = std::make_pair(c, i.first);\n            if (lockorders.count(p2))\n            {\n                potential_deadlock_detected(p1, lockorders[p2], lockorders[p1]);\n                break;\n            }\n        }\n    }\n    dd_mutex.unlock();\n}",
          "includes": [
            "#include <boost/foreach.hpp>",
            "#include \"util.h\"",
            "#include \"sync.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nstatic void push_lock(void* c, const CLockLocation& locklocation, bool fTry)\n{\n    if (lockstack.get() == NULL)\n        lockstack.reset(new LockStack);\n\n    if (fDebug) printf(\"Locking: %s\\n\", locklocation.ToString().c_str());\n    dd_mutex.lock();\n\n    (*lockstack).push_back(std::make_pair(c, locklocation));\n\n    if (!fTry) {\n        BOOST_FOREACH(const PAIRTYPE(void*, CLockLocation)& i, (*lockstack)) {\n            if (i.first == c) break;\n\n            std::pair<void*, void*> p1 = std::make_pair(i.first, c);\n            if (lockorders.count(p1))\n                continue;\n            lockorders[p1] = (*lockstack);\n\n            std::pair<void*, void*> p2 = std::make_pair(c, i.first);\n            if (lockorders.count(p2))\n            {\n                potential_deadlock_detected(p1, lockorders[p2], lockorders[p1]);\n                break;\n            }\n        }\n    }\n    dd_mutex.unlock();\n}"
        }
      },
      {
        "call_info": {
          "callee": "CLockLocation",
          "args": [
            "pszName",
            "pszFile",
            "nLine"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "CLockLocation",
          "container": "CLockLocation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
          "lines": "32-37",
          "snippet": "CLockLocation(const char* pszName, const char* pszFile, int nLine)\n    {\n        mutexName = pszName;\n        sourceFile = pszFile;\n        sourceLine = nLine;\n    }",
          "includes": [
            "#include <boost/foreach.hpp>",
            "#include \"util.h\"",
            "#include \"sync.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nCLockLocation {\n  CLockLocation(const char* pszName, const char* pszFile, int nLine)\n      {\n          mutexName = pszName;\n          sourceFile = pszFile;\n          sourceLine = nLine;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nvoid EnterCritical(const char* pszName, const char* pszFile, int nLine, void* cs, bool fTry)\n{\n    push_lock(cs, CLockLocation(pszName, pszFile, nLine), fTry);\n}"
  },
  {
    "function_name": "pop_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
    "lines": "106-116",
    "snippet": "static void pop_lock()\n{\n    if (fDebug)\n    {\n        const CLockLocation& locklocation = (*lockstack).rbegin()->second;\n        printf(\"Unlocked: %s\\n\", locklocation.ToString().c_str());\n    }\n    dd_mutex.lock();\n    (*lockstack).pop_back();\n    dd_mutex.unlock();\n}",
    "includes": [
      "#include <boost/foreach.hpp>",
      "#include \"util.h\"",
      "#include \"sync.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dd_mutex.unlock",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dd_mutex.lock",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Unlocked: %s\\n\"",
            "locklocation.ToString().c_str()"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "locklocation.ToString",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CLockLocation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
          "lines": "39-42",
          "snippet": "std::string ToString() const\n    {\n        return mutexName+\"  \"+sourceFile+\":\"+itostr(sourceLine);\n    }",
          "includes": [
            "#include <boost/foreach.hpp>",
            "#include \"util.h\"",
            "#include \"sync.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nCLockLocation {\n  std::string ToString() const\n      {\n          return mutexName+\"  \"+sourceFile+\":\"+itostr(sourceLine);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nstatic void pop_lock()\n{\n    if (fDebug)\n    {\n        const CLockLocation& locklocation = (*lockstack).rbegin()->second;\n        printf(\"Unlocked: %s\\n\", locklocation.ToString().c_str());\n    }\n    dd_mutex.lock();\n    (*lockstack).pop_back();\n    dd_mutex.unlock();\n}"
  },
  {
    "function_name": "push_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
    "lines": "76-104",
    "snippet": "static void push_lock(void* c, const CLockLocation& locklocation, bool fTry)\n{\n    if (lockstack.get() == NULL)\n        lockstack.reset(new LockStack);\n\n    if (fDebug) printf(\"Locking: %s\\n\", locklocation.ToString().c_str());\n    dd_mutex.lock();\n\n    (*lockstack).push_back(std::make_pair(c, locklocation));\n\n    if (!fTry) {\n        BOOST_FOREACH(const PAIRTYPE(void*, CLockLocation)& i, (*lockstack)) {\n            if (i.first == c) break;\n\n            std::pair<void*, void*> p1 = std::make_pair(i.first, c);\n            if (lockorders.count(p1))\n                continue;\n            lockorders[p1] = (*lockstack);\n\n            std::pair<void*, void*> p2 = std::make_pair(c, i.first);\n            if (lockorders.count(p2))\n            {\n                potential_deadlock_detected(p1, lockorders[p2], lockorders[p1]);\n                break;\n            }\n        }\n    }\n    dd_mutex.unlock();\n}",
    "includes": [
      "#include <boost/foreach.hpp>",
      "#include \"util.h\"",
      "#include \"sync.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dd_mutex.unlock",
          "args": [],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "potential_deadlock_detected",
          "args": [
            "p1",
            "lockorders[p2]",
            "lockorders[p1]"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "potential_deadlock_detected",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
          "lines": "57-74",
          "snippet": "static void potential_deadlock_detected(const std::pair<void*, void*>& mismatch, const LockStack& s1, const LockStack& s2)\n{\n    printf(\"POTENTIAL DEADLOCK DETECTED\\n\");\n    printf(\"Previous lock order was:\\n\");\n    BOOST_FOREACH(const PAIRTYPE(void*, CLockLocation)& i, s2)\n    {\n        if (i.first == mismatch.first) printf(\" (1)\");\n        if (i.first == mismatch.second) printf(\" (2)\");\n        printf(\" %s\\n\", i.second.ToString().c_str());\n    }\n    printf(\"Current lock order is:\\n\");\n    BOOST_FOREACH(const PAIRTYPE(void*, CLockLocation)& i, s1)\n    {\n        if (i.first == mismatch.first) printf(\" (1)\");\n        if (i.first == mismatch.second) printf(\" (2)\");\n        printf(\" %s\\n\", i.second.ToString().c_str());\n    }\n}",
          "includes": [
            "#include <boost/foreach.hpp>",
            "#include \"util.h\"",
            "#include \"sync.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nstatic void potential_deadlock_detected(const std::pair<void*, void*>& mismatch, const LockStack& s1, const LockStack& s2)\n{\n    printf(\"POTENTIAL DEADLOCK DETECTED\\n\");\n    printf(\"Previous lock order was:\\n\");\n    BOOST_FOREACH(const PAIRTYPE(void*, CLockLocation)& i, s2)\n    {\n        if (i.first == mismatch.first) printf(\" (1)\");\n        if (i.first == mismatch.second) printf(\" (2)\");\n        printf(\" %s\\n\", i.second.ToString().c_str());\n    }\n    printf(\"Current lock order is:\\n\");\n    BOOST_FOREACH(const PAIRTYPE(void*, CLockLocation)& i, s1)\n    {\n        if (i.first == mismatch.first) printf(\" (1)\");\n        if (i.first == mismatch.second) printf(\" (2)\");\n        printf(\" %s\\n\", i.second.ToString().c_str());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockorders.count",
          "args": [
            "p2"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "c",
            "i.first"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "i.first",
            "c"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "std::make_pair(c, locklocation)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "c",
            "locklocation"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dd_mutex.lock",
          "args": [],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Locking: %s\\n\"",
            "locklocation.ToString().c_str()"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "locklocation.ToString",
          "args": [],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CLockLocation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
          "lines": "39-42",
          "snippet": "std::string ToString() const\n    {\n        return mutexName+\"  \"+sourceFile+\":\"+itostr(sourceLine);\n    }",
          "includes": [
            "#include <boost/foreach.hpp>",
            "#include \"util.h\"",
            "#include \"sync.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nCLockLocation {\n  std::string ToString() const\n      {\n          return mutexName+\"  \"+sourceFile+\":\"+itostr(sourceLine);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockstack.reset",
          "args": [
            "new LockStack"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockstack.get",
          "args": [],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nstatic void push_lock(void* c, const CLockLocation& locklocation, bool fTry)\n{\n    if (lockstack.get() == NULL)\n        lockstack.reset(new LockStack);\n\n    if (fDebug) printf(\"Locking: %s\\n\", locklocation.ToString().c_str());\n    dd_mutex.lock();\n\n    (*lockstack).push_back(std::make_pair(c, locklocation));\n\n    if (!fTry) {\n        BOOST_FOREACH(const PAIRTYPE(void*, CLockLocation)& i, (*lockstack)) {\n            if (i.first == c) break;\n\n            std::pair<void*, void*> p1 = std::make_pair(i.first, c);\n            if (lockorders.count(p1))\n                continue;\n            lockorders[p1] = (*lockstack);\n\n            std::pair<void*, void*> p2 = std::make_pair(c, i.first);\n            if (lockorders.count(p2))\n            {\n                potential_deadlock_detected(p1, lockorders[p2], lockorders[p1]);\n                break;\n            }\n        }\n    }\n    dd_mutex.unlock();\n}"
  },
  {
    "function_name": "potential_deadlock_detected",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
    "lines": "57-74",
    "snippet": "static void potential_deadlock_detected(const std::pair<void*, void*>& mismatch, const LockStack& s1, const LockStack& s2)\n{\n    printf(\"POTENTIAL DEADLOCK DETECTED\\n\");\n    printf(\"Previous lock order was:\\n\");\n    BOOST_FOREACH(const PAIRTYPE(void*, CLockLocation)& i, s2)\n    {\n        if (i.first == mismatch.first) printf(\" (1)\");\n        if (i.first == mismatch.second) printf(\" (2)\");\n        printf(\" %s\\n\", i.second.ToString().c_str());\n    }\n    printf(\"Current lock order is:\\n\");\n    BOOST_FOREACH(const PAIRTYPE(void*, CLockLocation)& i, s1)\n    {\n        if (i.first == mismatch.first) printf(\" (1)\");\n        if (i.first == mismatch.second) printf(\" (2)\");\n        printf(\" %s\\n\", i.second.ToString().c_str());\n    }\n}",
    "includes": [
      "#include <boost/foreach.hpp>",
      "#include \"util.h\"",
      "#include \"sync.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\" %s\\n\"",
            "i.second.ToString().c_str()"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "i.second.ToString",
          "args": [],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CLockLocation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
          "lines": "39-42",
          "snippet": "std::string ToString() const\n    {\n        return mutexName+\"  \"+sourceFile+\":\"+itostr(sourceLine);\n    }",
          "includes": [
            "#include <boost/foreach.hpp>",
            "#include \"util.h\"",
            "#include \"sync.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nCLockLocation {\n  std::string ToString() const\n      {\n          return mutexName+\"  \"+sourceFile+\":\"+itostr(sourceLine);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\" (2)\""
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\" (1)\""
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Current lock order is:\\n\""
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\" (2)\""
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\" (1)\""
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Previous lock order was:\\n\""
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"POTENTIAL DEADLOCK DETECTED\\n\""
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nstatic void potential_deadlock_detected(const std::pair<void*, void*>& mismatch, const LockStack& s1, const LockStack& s2)\n{\n    printf(\"POTENTIAL DEADLOCK DETECTED\\n\");\n    printf(\"Previous lock order was:\\n\");\n    BOOST_FOREACH(const PAIRTYPE(void*, CLockLocation)& i, s2)\n    {\n        if (i.first == mismatch.first) printf(\" (1)\");\n        if (i.first == mismatch.second) printf(\" (2)\");\n        printf(\" %s\\n\", i.second.ToString().c_str());\n    }\n    printf(\"Current lock order is:\\n\");\n    BOOST_FOREACH(const PAIRTYPE(void*, CLockLocation)& i, s1)\n    {\n        if (i.first == mismatch.first) printf(\" (1)\");\n        if (i.first == mismatch.second) printf(\" (2)\");\n        printf(\" %s\\n\", i.second.ToString().c_str());\n    }\n}"
  },
  {
    "function_name": "ToString",
    "container": "CLockLocation",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
    "lines": "39-42",
    "snippet": "std::string ToString() const\n    {\n        return mutexName+\"  \"+sourceFile+\":\"+itostr(sourceLine);\n    }",
    "includes": [
      "#include <boost/foreach.hpp>",
      "#include \"util.h\"",
      "#include \"sync.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "itostr",
          "args": [
            "sourceLine"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "itostr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "269-272",
          "snippet": "inline std::string itostr(int n)\n{\n    return strprintf(\"%d\", n);\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline std::string itostr(int n)\n{\n    return strprintf(\"%d\", n);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nCLockLocation {\n  std::string ToString() const\n      {\n          return mutexName+\"  \"+sourceFile+\":\"+itostr(sourceLine);\n      }\n}"
  },
  {
    "function_name": "CLockLocation",
    "container": "CLockLocation",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
    "lines": "32-37",
    "snippet": "CLockLocation(const char* pszName, const char* pszFile, int nLine)\n    {\n        mutexName = pszName;\n        sourceFile = pszFile;\n        sourceLine = nLine;\n    }",
    "includes": [
      "#include <boost/foreach.hpp>",
      "#include \"util.h\"",
      "#include \"sync.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nCLockLocation {\n  CLockLocation(const char* pszName, const char* pszFile, int nLine)\n      {\n          mutexName = pszName;\n          sourceFile = pszFile;\n          sourceLine = nLine;\n      }\n}"
  },
  {
    "function_name": "PrintLockContention",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/sync.cpp",
    "lines": "11-15",
    "snippet": "void PrintLockContention(const char* pszName, const char* pszFile, int nLine)\n{\n    printf(\"LOCKCONTENTION: %s\\n\", pszName);\n    printf(\"Locker: %s:%d\\n\", pszFile, nLine);\n}",
    "includes": [
      "#include <boost/foreach.hpp>",
      "#include \"util.h\"",
      "#include \"sync.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Locker: %s:%d\\n\"",
            "pszFile",
            "nLine"
          ],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"LOCKCONTENTION: %s\\n\"",
            "pszName"
          ],
          "line": 13
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <boost/foreach.hpp>\n#include \"util.h\"\n#include \"sync.h\"\n\nvoid PrintLockContention(const char* pszName, const char* pszFile, int nLine)\n{\n    printf(\"LOCKCONTENTION: %s\\n\", pszName);\n    printf(\"Locker: %s:%d\\n\", pszFile, nLine);\n}"
  }
]