[
  {
    "function_name": "isOne",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "538-540",
    "snippet": "bool isOne() const {\n        return BN_is_one(this);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_is_one",
          "args": [
            "this"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  bool isOne() const {\n          return BN_is_one(this);\n      }\n}"
  },
  {
    "function_name": "isPrime",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "529-536",
    "snippet": "bool isPrime(const int checks=BN_prime_checks) const {\n        CAutoBN_CTX pctx;\n        int ret = BN_is_prime(this, checks, NULL, pctx, NULL);\n        if(ret < 0){\n            throw bignum_error(\"CBigNum::isPrime :BN_is_prime\");\n        }\n        return ret;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"CBigNum::isPrime :BN_is_prime\""
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_is_prime",
          "args": [
            "this",
            "checks",
            "NULL",
            "pctx",
            "NULL"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  bool isPrime(const int checks=BN_prime_checks) const {\n          CAutoBN_CTX pctx;\n          int ret = BN_is_prime(this, checks, NULL, pctx, NULL);\n          if(ret < 0){\n              throw bignum_error(\"CBigNum::isPrime :BN_is_prime\");\n          }\n          return ret;\n      }\n}"
  },
  {
    "function_name": "gcd",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "515-521",
    "snippet": "CBigNum gcd( const CBigNum& b) const{\n        CAutoBN_CTX pctx;\n        CBigNum ret;\n        if (!BN_gcd(&ret, this, &b, pctx))\n            throw bignum_error(\"CBigNum::gcd*= :BN_gcd\");\n        return ret;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"CBigNum::gcd*= :BN_gcd\""
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_gcd",
          "args": [
            "&ret",
            "this",
            "&b",
            "pctx"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum gcd( const CBigNum& b) const{\n          CAutoBN_CTX pctx;\n          CBigNum ret;\n          if (!BN_gcd(&ret, this, &b, pctx))\n              throw bignum_error(\"CBigNum::gcd*= :BN_gcd\");\n          return ret;\n      }\n}"
  },
  {
    "function_name": "generatePrime",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "503-508",
    "snippet": "static CBigNum generatePrime(const unsigned int numBits, bool safe = false) {\n        CBigNum ret;\n        if(!BN_generate_prime_ex(&ret, numBits, (safe == true), NULL, NULL, NULL))\n            throw bignum_error(\"CBigNum::generatePrime*= :BN_generate_prime_ex\");\n        return ret;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"CBigNum::generatePrime*= :BN_generate_prime_ex\""
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_generate_prime_ex",
          "args": [
            "&ret",
            "numBits",
            "(safe == true)",
            "NULL",
            "NULL",
            "NULL"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  static CBigNum generatePrime(const unsigned int numBits, bool safe = false) {\n          CBigNum ret;\n          if(!BN_generate_prime_ex(&ret, numBits, (safe == true), NULL, NULL, NULL))\n              throw bignum_error(\"CBigNum::generatePrime*= :BN_generate_prime_ex\");\n          return ret;\n      }\n}"
  },
  {
    "function_name": "inverse",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "489-495",
    "snippet": "CBigNum inverse(const CBigNum& m) const {\n        CAutoBN_CTX pctx;\n        CBigNum ret;\n        if (!BN_mod_inverse(&ret, this, &m, pctx))\n            throw bignum_error(\"CBigNum::inverse*= :BN_mod_inverse\");\n        return ret;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"CBigNum::inverse*= :BN_mod_inverse\""
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_mod_inverse",
          "args": [
            "&ret",
            "this",
            "&m",
            "pctx"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum inverse(const CBigNum& m) const {\n          CAutoBN_CTX pctx;\n          CBigNum ret;\n          if (!BN_mod_inverse(&ret, this, &m, pctx))\n              throw bignum_error(\"CBigNum::inverse*= :BN_mod_inverse\");\n          return ret;\n      }\n}"
  },
  {
    "function_name": "pow_mod",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "467-481",
    "snippet": "CBigNum pow_mod(const CBigNum& e, const CBigNum& m) const {\n        CAutoBN_CTX pctx;\n        CBigNum ret;\n        if( e < 0){\n            // g^-x = (g^-1)^x\n            CBigNum inv = this->inverse(m);\n            CBigNum posE = e * -1;\n            if (!BN_mod_exp(&ret, &inv, &posE, &m, pctx))\n                throw bignum_error(\"CBigNum::pow_mod: BN_mod_exp failed on negative exponent\");\n        }else\n            if (!BN_mod_exp(&ret, this, &e, &m, pctx))\n                throw bignum_error(\"CBigNum::pow_mod : BN_mod_exp failed\");\n\n        return ret;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"CBigNum::pow_mod : BN_mod_exp failed\""
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_mod_exp",
          "args": [
            "&ret",
            "this",
            "&e",
            "&m",
            "pctx"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_mod_exp",
          "args": [
            "&ret",
            "&inv",
            "&posE",
            "&m",
            "pctx"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->inverse",
          "args": [
            "m"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "inverse",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "489-495",
          "snippet": "CBigNum inverse(const CBigNum& m) const {\n        CAutoBN_CTX pctx;\n        CBigNum ret;\n        if (!BN_mod_inverse(&ret, this, &m, pctx))\n            throw bignum_error(\"CBigNum::inverse*= :BN_mod_inverse\");\n        return ret;\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum inverse(const CBigNum& m) const {\n          CAutoBN_CTX pctx;\n          CBigNum ret;\n          if (!BN_mod_inverse(&ret, this, &m, pctx))\n              throw bignum_error(\"CBigNum::inverse*= :BN_mod_inverse\");\n          return ret;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum pow_mod(const CBigNum& e, const CBigNum& m) const {\n          CAutoBN_CTX pctx;\n          CBigNum ret;\n          if( e < 0){\n              // g^-x = (g^-1)^x\n              CBigNum inv = this->inverse(m);\n              CBigNum posE = e * -1;\n              if (!BN_mod_exp(&ret, &inv, &posE, &m, pctx))\n                  throw bignum_error(\"CBigNum::pow_mod: BN_mod_exp failed on negative exponent\");\n          }else\n              if (!BN_mod_exp(&ret, this, &e, &m, pctx))\n                  throw bignum_error(\"CBigNum::pow_mod : BN_mod_exp failed\");\n  \n          return ret;\n      }\n}"
  },
  {
    "function_name": "mul_mod",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "453-460",
    "snippet": "CBigNum mul_mod(const CBigNum& b, const CBigNum& m) const {\n        CAutoBN_CTX pctx;\n        CBigNum ret;\n        if (!BN_mod_mul(&ret, this, &b, &m, pctx))\n            throw bignum_error(\"CBigNum::mul_mod : BN_mod_mul failed\");\n        \n        return ret;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"CBigNum::mul_mod : BN_mod_mul failed\""
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_mod_mul",
          "args": [
            "&ret",
            "this",
            "&b",
            "&m",
            "pctx"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum mul_mod(const CBigNum& b, const CBigNum& m) const {\n          CAutoBN_CTX pctx;\n          CBigNum ret;\n          if (!BN_mod_mul(&ret, this, &b, &m, pctx))\n              throw bignum_error(\"CBigNum::mul_mod : BN_mod_mul failed\");\n          \n          return ret;\n      }\n}"
  },
  {
    "function_name": "pow",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "440-446",
    "snippet": "CBigNum pow(const CBigNum& e) const {\n        CAutoBN_CTX pctx;\n        CBigNum ret;\n        if (!BN_exp(&ret, this, &e, pctx))\n            throw bignum_error(\"CBigNum::pow : BN_exp failed\");\n        return ret;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"CBigNum::pow : BN_exp failed\""
          ],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_exp",
          "args": [
            "&ret",
            "this",
            "&e",
            "pctx"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum pow(const CBigNum& e) const {\n          CAutoBN_CTX pctx;\n          CBigNum ret;\n          if (!BN_exp(&ret, this, &e, pctx))\n              throw bignum_error(\"CBigNum::pow : BN_exp failed\");\n          return ret;\n      }\n}"
  },
  {
    "function_name": "pow",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "431-433",
    "snippet": "CBigNum pow(const int e) const {\n        return this->pow(CBigNum(e));\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->pow",
          "args": [
            "CBigNum(e)"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "pow",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "440-446",
          "snippet": "CBigNum pow(const CBigNum& e) const {\n        CAutoBN_CTX pctx;\n        CBigNum ret;\n        if (!BN_exp(&ret, this, &e, pctx))\n            throw bignum_error(\"CBigNum::pow : BN_exp failed\");\n        return ret;\n    }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "CBigNum",
          "args": [
            "e"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "gcd",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "515-521",
          "snippet": "CBigNum gcd( const CBigNum& b) const{\n        CAutoBN_CTX pctx;\n        CBigNum ret;\n        if (!BN_gcd(&ret, this, &b, pctx))\n            throw bignum_error(\"CBigNum::gcd*= :BN_gcd\");\n        return ret;\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum gcd( const CBigNum& b) const{\n          CAutoBN_CTX pctx;\n          CBigNum ret;\n          if (!BN_gcd(&ret, this, &b, pctx))\n              throw bignum_error(\"CBigNum::gcd*= :BN_gcd\");\n          return ret;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum pow(const int e) const {\n          return this->pow(CBigNum(e));\n      }\n}"
  },
  {
    "function_name": "Unserialize",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "419-424",
    "snippet": "void Unserialize(Stream& s, int nType=0, int nVersion=PROTOCOL_VERSION)\n    {\n        std::vector<unsigned char> vch;\n        ::Unserialize(s, vch, nType, nVersion);\n        setvch(vch);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setvch",
          "args": [
            "vch"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "setvch",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "294-307",
          "snippet": "void setvch(const std::vector<unsigned char>& vch)\n    {\n        std::vector<unsigned char> vch2(vch.size() + 4);\n        unsigned int nSize = vch.size();\n        // BIGNUM's byte stream format expects 4 bytes of\n        // big endian size data info at the front\n        vch2[0] = (nSize >> 24) & 0xff;\n        vch2[1] = (nSize >> 16) & 0xff;\n        vch2[2] = (nSize >> 8) & 0xff;\n        vch2[3] = (nSize >> 0) & 0xff;\n        // swap data to big endian\n        reverse_copy(vch.begin(), vch.end(), vch2.begin() + 4);\n        BN_mpi2bn(&vch2[0], vch2.size(), this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setvch(const std::vector<unsigned char>& vch)\n      {\n          std::vector<unsigned char> vch2(vch.size() + 4);\n          unsigned int nSize = vch.size();\n          // BIGNUM's byte stream format expects 4 bytes of\n          // big endian size data info at the front\n          vch2[0] = (nSize >> 24) & 0xff;\n          vch2[1] = (nSize >> 16) & 0xff;\n          vch2[2] = (nSize >> 8) & 0xff;\n          vch2[3] = (nSize >> 0) & 0xff;\n          // swap data to big endian\n          reverse_copy(vch.begin(), vch.end(), vch2.begin() + 4);\n          BN_mpi2bn(&vch2[0], vch2.size(), this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "::Unserialize",
          "args": [
            "s",
            "vch",
            "nType",
            "nVersion"
          ],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "Unserialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "649-660",
          "snippet": "void Unserialize(Stream& is, std::set<K, Pred, A>& m, int nType, int nVersion)\n{\n    m.clear();\n    unsigned int nSize = ReadCompactSize(is);\n    typename std::set<K, Pred, A>::iterator it = m.begin();\n    for (unsigned int i = 0; i < nSize; i++)\n    {\n        K key;\n        Unserialize(is, key, nType, nVersion);\n        it = m.insert(it, key);\n    }\n}",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nvoid Unserialize(Stream& is, std::set<K, Pred, A>& m, int nType, int nVersion)\n{\n    m.clear();\n    unsigned int nSize = ReadCompactSize(is);\n    typename std::set<K, Pred, A>::iterator it = m.begin();\n    for (unsigned int i = 0; i < nSize; i++)\n    {\n        K key;\n        Unserialize(is, key, nType, nVersion);\n        it = m.insert(it, key);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void Unserialize(Stream& s, int nType=0, int nVersion=PROTOCOL_VERSION)\n      {\n          std::vector<unsigned char> vch;\n          ::Unserialize(s, vch, nType, nVersion);\n          setvch(vch);\n      }\n}"
  },
  {
    "function_name": "Serialize",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "413-416",
    "snippet": "void Serialize(Stream& s, int nType=0, int nVersion=PROTOCOL_VERSION) const\n    {\n        ::Serialize(s, getvch(), nType, nVersion);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::Serialize",
          "args": [
            "s",
            "getvch()",
            "nType",
            "nVersion"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "Serialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "641-646",
          "snippet": "void Serialize(Stream& os, const std::set<K, Pred, A>& m, int nType, int nVersion)\n{\n    WriteCompactSize(os, m.size());\n    for (typename std::set<K, Pred, A>::const_iterator it = m.begin(); it != m.end(); ++it)\n        Serialize(os, (*it), nType, nVersion);\n}",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nvoid Serialize(Stream& os, const std::set<K, Pred, A>& m, int nType, int nVersion)\n{\n    WriteCompactSize(os, m.size());\n    for (typename std::set<K, Pred, A>::const_iterator it = m.begin(); it != m.end(); ++it)\n        Serialize(os, (*it), nType, nVersion);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getvch",
          "args": [],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "getvch",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "309-319",
          "snippet": "std::vector<unsigned char> getvch() const\n    {\n        unsigned int nSize = BN_bn2mpi(this, NULL);\n        if (nSize <= 4)\n            return std::vector<unsigned char>();\n        std::vector<unsigned char> vch(nSize);\n        BN_bn2mpi(this, &vch[0]);\n        vch.erase(vch.begin(), vch.begin() + 4);\n        reverse(vch.begin(), vch.end());\n        return vch;\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  std::vector<unsigned char> getvch() const\n      {\n          unsigned int nSize = BN_bn2mpi(this, NULL);\n          if (nSize <= 4)\n              return std::vector<unsigned char>();\n          std::vector<unsigned char> vch(nSize);\n          BN_bn2mpi(this, &vch[0]);\n          vch.erase(vch.begin(), vch.begin() + 4);\n          reverse(vch.begin(), vch.end());\n          return vch;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void Serialize(Stream& s, int nType=0, int nVersion=PROTOCOL_VERSION) const\n      {\n          ::Serialize(s, getvch(), nType, nVersion);\n      }\n}"
  },
  {
    "function_name": "GetSerializeSize",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "407-410",
    "snippet": "unsigned int GetSerializeSize(int nType=0, int nVersion=PROTOCOL_VERSION) const\n    {\n        return ::GetSerializeSize(getvch(), nType, nVersion);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::GetSerializeSize",
          "args": [
            "getvch()",
            "nType",
            "nVersion"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "GetSerializeSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "632-638",
          "snippet": "unsigned int GetSerializeSize(const std::set<K, Pred, A>& m, int nType, int nVersion)\n{\n    unsigned int nSize = GetSizeOfCompactSize(m.size());\n    for (typename std::set<K, Pred, A>::const_iterator it = m.begin(); it != m.end(); ++it)\n        nSize += GetSerializeSize((*it), nType, nVersion);\n    return nSize;\n}",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nunsigned int GetSerializeSize(const std::set<K, Pred, A>& m, int nType, int nVersion)\n{\n    unsigned int nSize = GetSizeOfCompactSize(m.size());\n    for (typename std::set<K, Pred, A>::const_iterator it = m.begin(); it != m.end(); ++it)\n        nSize += GetSerializeSize((*it), nType, nVersion);\n    return nSize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getvch",
          "args": [],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "getvch",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "309-319",
          "snippet": "std::vector<unsigned char> getvch() const\n    {\n        unsigned int nSize = BN_bn2mpi(this, NULL);\n        if (nSize <= 4)\n            return std::vector<unsigned char>();\n        std::vector<unsigned char> vch(nSize);\n        BN_bn2mpi(this, &vch[0]);\n        vch.erase(vch.begin(), vch.begin() + 4);\n        reverse(vch.begin(), vch.end());\n        return vch;\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  std::vector<unsigned char> getvch() const\n      {\n          unsigned int nSize = BN_bn2mpi(this, NULL);\n          if (nSize <= 4)\n              return std::vector<unsigned char>();\n          std::vector<unsigned char> vch(nSize);\n          BN_bn2mpi(this, &vch[0]);\n          vch.erase(vch.begin(), vch.begin() + 4);\n          reverse(vch.begin(), vch.end());\n          return vch;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  unsigned int GetSerializeSize(int nType=0, int nVersion=PROTOCOL_VERSION) const\n      {\n          return ::GetSerializeSize(getvch(), nType, nVersion);\n      }\n}"
  },
  {
    "function_name": "GetHex",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "402-405",
    "snippet": "std::string GetHex() const\n    {\n        return ToString(16);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ToString",
          "args": [
            "16"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "NumberToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
          "lines": "36-40",
          "snippet": "std::string NumberToString(uint64_t num) {\n  std::string r;\n  AppendNumberTo(&r, num);\n  return r;\n}",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"util/logging.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nstd::string NumberToString(uint64_t num) {\n  std::string r;\n  AppendNumberTo(&r, num);\n  return r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  std::string GetHex() const\n      {\n          return ToString(16);\n      }\n}"
  },
  {
    "function_name": "ToString",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "376-400",
    "snippet": "std::string ToString(int nBase=10) const\n    {\n        CAutoBN_CTX pctx;\n        CBigNum bnBase = nBase;\n        CBigNum bn0 = 0;\n        std::string str;\n        CBigNum bn = *this;\n        BN_set_negative(&bn, false);\n        CBigNum dv;\n        CBigNum rem;\n        if (BN_cmp(&bn, &bn0) == 0)\n            return \"0\";\n        while (BN_cmp(&bn, &bn0) > 0)\n        {\n            if (!BN_div(&dv, &rem, &bn, &bnBase, pctx))\n                throw bignum_error(\"CBigNum::ToString() : BN_div failed\");\n            bn = dv;\n            unsigned int c = rem.getulong();\n            str += \"0123456789abcdef\"[c];\n        }\n        if (BN_is_negative(this))\n            str += \"-\";\n        reverse(str.begin(), str.end());\n        return str;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reverse",
          "args": [
            "str.begin()",
            "str.end()"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.end",
          "args": [],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.begin",
          "args": [],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_is_negative",
          "args": [
            "this"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rem.getulong",
          "args": [],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "getulong",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "146-149",
          "snippet": "unsigned long getulong() const\n    {\n        return BN_get_word(this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  unsigned long getulong() const\n      {\n          return BN_get_word(this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"CBigNum::ToString() : BN_div failed\""
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_div",
          "args": [
            "&dv",
            "&rem",
            "&bn",
            "&bnBase",
            "pctx"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_cmp",
          "args": [
            "&bn",
            "&bn0"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_cmp",
          "args": [
            "&bn",
            "&bn0"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_set_negative",
          "args": [
            "&bn",
            "false"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  std::string ToString(int nBase=10) const\n      {\n          CAutoBN_CTX pctx;\n          CBigNum bnBase = nBase;\n          CBigNum bn0 = 0;\n          std::string str;\n          CBigNum bn = *this;\n          BN_set_negative(&bn, false);\n          CBigNum dv;\n          CBigNum rem;\n          if (BN_cmp(&bn, &bn0) == 0)\n              return \"0\";\n          while (BN_cmp(&bn, &bn0) > 0)\n          {\n              if (!BN_div(&dv, &rem, &bn, &bnBase, pctx))\n                  throw bignum_error(\"CBigNum::ToString() : BN_div failed\");\n              bn = dv;\n              unsigned int c = rem.getulong();\n              str += \"0123456789abcdef\"[c];\n          }\n          if (BN_is_negative(this))\n              str += \"-\";\n          reverse(str.begin(), str.end());\n          return str;\n      }\n}"
  },
  {
    "function_name": "SetHex",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "346-374",
    "snippet": "void SetHex(const std::string& str)\n    {\n        // skip 0x\n        const char* psz = str.c_str();\n        while (isspace(*psz))\n            psz++;\n        bool fNegative = false;\n        if (*psz == '-')\n        {\n            fNegative = true;\n            psz++;\n        }\n        if (psz[0] == '0' && tolower(psz[1]) == 'x')\n            psz += 2;\n        while (isspace(*psz))\n            psz++;\n\n        // hex string to bignum\n        static const signed char phexdigit[256] = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0 };\n        *this = 0;\n        while (isxdigit(*psz))\n        {\n            *this <<= 4;\n            int n = phexdigit[(unsigned char)*psz++];\n            *this += n;\n        }\n        if (fNegative)\n            *this = 0 - *this;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "isxdigit",
          "args": [
            "*psz"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "*psz"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tolower",
          "args": [
            "psz[1]"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "*psz"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void SetHex(const std::string& str)\n      {\n          // skip 0x\n          const char* psz = str.c_str();\n          while (isspace(*psz))\n              psz++;\n          bool fNegative = false;\n          if (*psz == '-')\n          {\n              fNegative = true;\n              psz++;\n          }\n          if (psz[0] == '0' && tolower(psz[1]) == 'x')\n              psz += 2;\n          while (isspace(*psz))\n              psz++;\n  \n          // hex string to bignum\n          static const signed char phexdigit[256] = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0xa,0xb,0xc,0xd,0xe,0xf,0,0,0,0,0,0,0,0,0 };\n          *this = 0;\n          while (isxdigit(*psz))\n          {\n              *this <<= 4;\n              int n = phexdigit[(unsigned char)*psz++];\n              *this += n;\n          }\n          if (fNegative)\n              *this = 0 - *this;\n      }\n}"
  },
  {
    "function_name": "GetCompact",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "333-344",
    "snippet": "unsigned int GetCompact() const\n    {\n        unsigned int nSize = BN_bn2mpi(this, NULL);\n        std::vector<unsigned char> vch(nSize);\n        nSize -= 4;\n        BN_bn2mpi(this, &vch[0]);\n        unsigned int nCompact = nSize << 24;\n        if (nSize >= 1) nCompact |= (vch[4] << 16);\n        if (nSize >= 2) nCompact |= (vch[5] << 8);\n        if (nSize >= 3) nCompact |= (vch[6] << 0);\n        return nCompact;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_bn2mpi",
          "args": [
            "this",
            "&vch[0]"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_bn2mpi",
          "args": [
            "this",
            "NULL"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  unsigned int GetCompact() const\n      {\n          unsigned int nSize = BN_bn2mpi(this, NULL);\n          std::vector<unsigned char> vch(nSize);\n          nSize -= 4;\n          BN_bn2mpi(this, &vch[0]);\n          unsigned int nCompact = nSize << 24;\n          if (nSize >= 1) nCompact |= (vch[4] << 16);\n          if (nSize >= 2) nCompact |= (vch[5] << 8);\n          if (nSize >= 3) nCompact |= (vch[6] << 0);\n          return nCompact;\n      }\n}"
  },
  {
    "function_name": "getvch",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "309-319",
    "snippet": "std::vector<unsigned char> getvch() const\n    {\n        unsigned int nSize = BN_bn2mpi(this, NULL);\n        if (nSize <= 4)\n            return std::vector<unsigned char>();\n        std::vector<unsigned char> vch(nSize);\n        BN_bn2mpi(this, &vch[0]);\n        vch.erase(vch.begin(), vch.begin() + 4);\n        reverse(vch.begin(), vch.end());\n        return vch;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reverse",
          "args": [
            "vch.begin()",
            "vch.end()"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vch.end",
          "args": [],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vch.begin",
          "args": [],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vch.erase",
          "args": [
            "vch.begin()",
            "vch.begin() + 4"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "870-888",
          "snippet": "iterator erase(iterator first, iterator last)\n    {\n        if (first == vch.begin() + nReadPos)\n        {\n            // special case for erasing from the front\n            if (last == vch.end())\n            {\n                nReadPos = 0;\n                return vch.erase(vch.begin(), vch.end());\n            }\n            else\n            {\n                nReadPos = (last - vch.begin());\n                return last;\n            }\n        }\n        else\n            return vch.erase(first, last);\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  iterator erase(iterator first, iterator last)\n      {\n          if (first == vch.begin() + nReadPos)\n          {\n              // special case for erasing from the front\n              if (last == vch.end())\n              {\n                  nReadPos = 0;\n                  return vch.erase(vch.begin(), vch.end());\n              }\n              else\n              {\n                  nReadPos = (last - vch.begin());\n                  return last;\n              }\n          }\n          else\n              return vch.erase(first, last);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_bn2mpi",
          "args": [
            "this",
            "&vch[0]"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::vector<unsigned char>",
          "args": [],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_bn2mpi",
          "args": [
            "this",
            "NULL"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  std::vector<unsigned char> getvch() const\n      {\n          unsigned int nSize = BN_bn2mpi(this, NULL);\n          if (nSize <= 4)\n              return std::vector<unsigned char>();\n          std::vector<unsigned char> vch(nSize);\n          BN_bn2mpi(this, &vch[0]);\n          vch.erase(vch.begin(), vch.begin() + 4);\n          reverse(vch.begin(), vch.end());\n          return vch;\n      }\n}"
  },
  {
    "function_name": "setvch",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "294-307",
    "snippet": "void setvch(const std::vector<unsigned char>& vch)\n    {\n        std::vector<unsigned char> vch2(vch.size() + 4);\n        unsigned int nSize = vch.size();\n        // BIGNUM's byte stream format expects 4 bytes of\n        // big endian size data info at the front\n        vch2[0] = (nSize >> 24) & 0xff;\n        vch2[1] = (nSize >> 16) & 0xff;\n        vch2[2] = (nSize >> 8) & 0xff;\n        vch2[3] = (nSize >> 0) & 0xff;\n        // swap data to big endian\n        reverse_copy(vch.begin(), vch.end(), vch2.begin() + 4);\n        BN_mpi2bn(&vch2[0], vch2.size(), this);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_mpi2bn",
          "args": [
            "&vch2[0]",
            "vch2.size()",
            "this"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vch2.size",
          "args": [],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reverse_copy",
          "args": [
            "vch.begin()",
            "vch.end()",
            "vch2.begin() + 4"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vch2.begin",
          "args": [],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vch.end",
          "args": [],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setvch(const std::vector<unsigned char>& vch)\n      {\n          std::vector<unsigned char> vch2(vch.size() + 4);\n          unsigned int nSize = vch.size();\n          // BIGNUM's byte stream format expects 4 bytes of\n          // big endian size data info at the front\n          vch2[0] = (nSize >> 24) & 0xff;\n          vch2[1] = (nSize >> 16) & 0xff;\n          vch2[2] = (nSize >> 8) & 0xff;\n          vch2[3] = (nSize >> 0) & 0xff;\n          // swap data to big endian\n          reverse_copy(vch.begin(), vch.end(), vch2.begin() + 4);\n          BN_mpi2bn(&vch2[0], vch2.size(), this);\n      }\n}"
  },
  {
    "function_name": "getuint256",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "278-291",
    "snippet": "uint256 getuint256() const\n    {\n        unsigned int nSize = BN_bn2mpi(this, NULL);\n        if (nSize < 4)\n            return 0;\n        std::vector<unsigned char> vch(nSize);\n        BN_bn2mpi(this, &vch[0]);\n        if (vch.size() > 4)\n            vch[4] &= 0x7f;\n        uint256 n = 0;\n        for (unsigned int i = 0, j = vch.size()-1; i < sizeof(n) && j >= 4; i++, j--)\n            ((unsigned char*)&n)[i] = vch[j];\n        return n;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vch.size",
          "args": [],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_bn2mpi",
          "args": [
            "this",
            "&vch[0]"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_bn2mpi",
          "args": [
            "this",
            "NULL"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  uint256 getuint256() const\n      {\n          unsigned int nSize = BN_bn2mpi(this, NULL);\n          if (nSize < 4)\n              return 0;\n          std::vector<unsigned char> vch(nSize);\n          BN_bn2mpi(this, &vch[0]);\n          if (vch.size() > 4)\n              vch[4] &= 0x7f;\n          uint256 n = 0;\n          for (unsigned int i = 0, j = vch.size()-1; i < sizeof(n) && j >= 4; i++, j--)\n              ((unsigned char*)&n)[i] = vch[j];\n          return n;\n      }\n}"
  },
  {
    "function_name": "setuint256",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "250-276",
    "snippet": "void setuint256(uint256 n)\n    {\n        unsigned char pch[sizeof(n) + 6];\n        unsigned char* p = pch + 4;\n        bool fLeadingZeroes = true;\n        unsigned char* pbegin = (unsigned char*)&n;\n        unsigned char* psrc = pbegin + sizeof(n);\n        while (psrc != pbegin)\n        {\n            unsigned char c = *(--psrc);\n            if (fLeadingZeroes)\n            {\n                if (c == 0)\n                    continue;\n                if (c & 0x80)\n                    *p++ = 0;\n                fLeadingZeroes = false;\n            }\n            *p++ = c;\n        }\n        unsigned int nSize = p - (pch + 4);\n        pch[0] = (nSize >> 24) & 0xff;\n        pch[1] = (nSize >> 16) & 0xff;\n        pch[2] = (nSize >> 8) & 0xff;\n        pch[3] = (nSize >> 0) & 0xff;\n        BN_mpi2bn(pch, p - pch, this);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_mpi2bn",
          "args": [
            "pch",
            "p - pch",
            "this"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setuint256(uint256 n)\n      {\n          unsigned char pch[sizeof(n) + 6];\n          unsigned char* p = pch + 4;\n          bool fLeadingZeroes = true;\n          unsigned char* pbegin = (unsigned char*)&n;\n          unsigned char* psrc = pbegin + sizeof(n);\n          while (psrc != pbegin)\n          {\n              unsigned char c = *(--psrc);\n              if (fLeadingZeroes)\n              {\n                  if (c == 0)\n                      continue;\n                  if (c & 0x80)\n                      *p++ = 0;\n                  fLeadingZeroes = false;\n              }\n              *p++ = c;\n          }\n          unsigned int nSize = p - (pch + 4);\n          pch[0] = (nSize >> 24) & 0xff;\n          pch[1] = (nSize >> 16) & 0xff;\n          pch[2] = (nSize >> 8) & 0xff;\n          pch[3] = (nSize >> 0) & 0xff;\n          BN_mpi2bn(pch, p - pch, this);\n      }\n}"
  },
  {
    "function_name": "setuint64",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "223-248",
    "snippet": "void setuint64(uint64_t n)\n    {\n        unsigned char pch[sizeof(n) + 6];\n        unsigned char* p = pch + 4;\n        bool fLeadingZeroes = true;\n        for (int i = 0; i < 8; i++)\n        {\n            unsigned char c = (n >> 56) & 0xff;\n            n <<= 8;\n            if (fLeadingZeroes)\n            {\n                if (c == 0)\n                    continue;\n                if (c & 0x80)\n                    *p++ = 0;\n                fLeadingZeroes = false;\n            }\n            *p++ = c;\n        }\n        unsigned int nSize = p - (pch + 4);\n        pch[0] = (nSize >> 24) & 0xff;\n        pch[1] = (nSize >> 16) & 0xff;\n        pch[2] = (nSize >> 8) & 0xff;\n        pch[3] = (nSize) & 0xff;\n        BN_mpi2bn(pch, p - pch, this);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_mpi2bn",
          "args": [
            "pch",
            "p - pch",
            "this"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setuint64(uint64_t n)\n      {\n          unsigned char pch[sizeof(n) + 6];\n          unsigned char* p = pch + 4;\n          bool fLeadingZeroes = true;\n          for (int i = 0; i < 8; i++)\n          {\n              unsigned char c = (n >> 56) & 0xff;\n              n <<= 8;\n              if (fLeadingZeroes)\n              {\n                  if (c == 0)\n                      continue;\n                  if (c & 0x80)\n                      *p++ = 0;\n                  fLeadingZeroes = false;\n              }\n              *p++ = c;\n          }\n          unsigned int nSize = p - (pch + 4);\n          pch[0] = (nSize >> 24) & 0xff;\n          pch[1] = (nSize >> 16) & 0xff;\n          pch[2] = (nSize >> 8) & 0xff;\n          pch[3] = (nSize) & 0xff;\n          BN_mpi2bn(pch, p - pch, this);\n      }\n}"
  },
  {
    "function_name": "getuint64",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "208-221",
    "snippet": "uint64_t getuint64()\n    {\n        unsigned int nSize = BN_bn2mpi(this, NULL);\n        if (nSize < 4)\n            return 0;\n        std::vector<unsigned char> vch(nSize);\n        BN_bn2mpi(this, &vch[0]);\n        if (vch.size() > 4)\n            vch[4] &= 0x7f;\n        uint64_t n = 0;\n        for (unsigned int i = 0, j = vch.size()-1; i < sizeof(n) && j >= 4; i++, j--)\n            ((unsigned char*)&n)[i] = vch[j];\n        return n;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vch.size",
          "args": [],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_bn2mpi",
          "args": [
            "this",
            "&vch[0]"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_bn2mpi",
          "args": [
            "this",
            "NULL"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  uint64_t getuint64()\n      {\n          unsigned int nSize = BN_bn2mpi(this, NULL);\n          if (nSize < 4)\n              return 0;\n          std::vector<unsigned char> vch(nSize);\n          BN_bn2mpi(this, &vch[0]);\n          if (vch.size() > 4)\n              vch[4] &= 0x7f;\n          uint64_t n = 0;\n          for (unsigned int i = 0, j = vch.size()-1; i < sizeof(n) && j >= 4; i++, j--)\n              ((unsigned char*)&n)[i] = vch[j];\n          return n;\n      }\n}"
  },
  {
    "function_name": "setint64",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "165-206",
    "snippet": "void setint64(int64_t sn)\n    {\n        unsigned char pch[sizeof(sn) + 6];\n        unsigned char* p = pch + 4;\n        bool fNegative;\n        uint64_t n;\n\n        if (sn < (int64_t)0)\n        {\n            // Since the minimum signed integer cannot be represented as positive so long as its type is signed, and it's not well-defined what happens if you make it unsigned before negating it, we instead increment the negative integer by 1, convert it, then increment the (now positive) unsigned integer by 1 to compensate\n            n = -(sn + 1);\n            ++n;\n            fNegative = true;\n        } else {\n            n = sn;\n            fNegative = false;\n        }\n\n        bool fLeadingZeroes = true;\n        for (int i = 0; i < 8; i++)\n        {\n            unsigned char c = (n >> 56) & 0xff;\n            n <<= 8;\n            if (fLeadingZeroes)\n            {\n                if (c == 0)\n                    continue;\n                if (c & 0x80)\n                    *p++ = (fNegative ? 0x80 : 0);\n                else if (fNegative)\n                    c |= 0x80;\n                fLeadingZeroes = false;\n            }\n            *p++ = c;\n        }\n        unsigned int nSize = p - (pch + 4);\n        pch[0] = (nSize >> 24) & 0xff;\n        pch[1] = (nSize >> 16) & 0xff;\n        pch[2] = (nSize >> 8) & 0xff;\n        pch[3] = (nSize) & 0xff;\n        BN_mpi2bn(pch, p - pch, this);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_mpi2bn",
          "args": [
            "pch",
            "p - pch",
            "this"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setint64(int64_t sn)\n      {\n          unsigned char pch[sizeof(sn) + 6];\n          unsigned char* p = pch + 4;\n          bool fNegative;\n          uint64_t n;\n  \n          if (sn < (int64_t)0)\n          {\n              // Since the minimum signed integer cannot be represented as positive so long as its type is signed, and it's not well-defined what happens if you make it unsigned before negating it, we instead increment the negative integer by 1, convert it, then increment the (now positive) unsigned integer by 1 to compensate\n              n = -(sn + 1);\n              ++n;\n              fNegative = true;\n          } else {\n              n = sn;\n              fNegative = false;\n          }\n  \n          bool fLeadingZeroes = true;\n          for (int i = 0; i < 8; i++)\n          {\n              unsigned char c = (n >> 56) & 0xff;\n              n <<= 8;\n              if (fLeadingZeroes)\n              {\n                  if (c == 0)\n                      continue;\n                  if (c & 0x80)\n                      *p++ = (fNegative ? 0x80 : 0);\n                  else if (fNegative)\n                      c |= 0x80;\n                  fLeadingZeroes = false;\n              }\n              *p++ = c;\n          }\n          unsigned int nSize = p - (pch + 4);\n          pch[0] = (nSize >> 24) & 0xff;\n          pch[1] = (nSize >> 16) & 0xff;\n          pch[2] = (nSize >> 8) & 0xff;\n          pch[3] = (nSize) & 0xff;\n          BN_mpi2bn(pch, p - pch, this);\n      }\n}"
  },
  {
    "function_name": "getint",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "156-163",
    "snippet": "int getint() const\n    {\n        unsigned long n = BN_get_word(this);\n        if (!BN_is_negative(this))\n            return (n > (unsigned long)std::numeric_limits<int>::max() ? std::numeric_limits<int>::max() : n);\n        else\n            return (n > (unsigned long)std::numeric_limits<int>::max() ? std::numeric_limits<int>::min() : -(int)n);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::numeric_limits<int>::min",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::numeric_limits<int>::max",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::numeric_limits<int>::max",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::numeric_limits<int>::max",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_is_negative",
          "args": [
            "this"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_get_word",
          "args": [
            "this"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  int getint() const\n      {\n          unsigned long n = BN_get_word(this);\n          if (!BN_is_negative(this))\n              return (n > (unsigned long)std::numeric_limits<int>::max() ? std::numeric_limits<int>::max() : n);\n          else\n              return (n > (unsigned long)std::numeric_limits<int>::max() ? std::numeric_limits<int>::min() : -(int)n);\n      }\n}"
  },
  {
    "function_name": "getuint",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "151-154",
    "snippet": "unsigned int getuint() const\n    {\n        return BN_get_word(this);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_get_word",
          "args": [
            "this"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  unsigned int getuint() const\n      {\n          return BN_get_word(this);\n      }\n}"
  },
  {
    "function_name": "getulong",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "146-149",
    "snippet": "unsigned long getulong() const\n    {\n        return BN_get_word(this);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_get_word",
          "args": [
            "this"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  unsigned long getulong() const\n      {\n          return BN_get_word(this);\n      }\n}"
  },
  {
    "function_name": "setulong",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "140-144",
    "snippet": "void setulong(unsigned long n)\n    {\n        if (!BN_set_word(this, n))\n            throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"CBigNum conversion from unsigned long : BN_set_word failed\""
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_set_word",
          "args": [
            "this",
            "n"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setulong(unsigned long n)\n      {\n          if (!BN_set_word(this, n))\n              throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n      }\n}"
  },
  {
    "function_name": "bitSize",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "135-137",
    "snippet": "int bitSize() const{\n        return  BN_num_bits(this);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "this"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  int bitSize() const{\n          return  BN_num_bits(this);\n      }\n}"
  },
  {
    "function_name": "RandKBitBigum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "123-129",
    "snippet": "static CBigNum RandKBitBigum(const uint32_t k){\n        CBigNum ret;\n        if(!BN_rand(&ret, k, -1, 0)){\n            throw bignum_error(\"CBigNum:rand element : BN_rand failed\");\n        }\n        return ret;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"CBigNum:rand element : BN_rand failed\""
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_rand",
          "args": [
            "&ret",
            "k",
            "-1",
            "0"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  static CBigNum RandKBitBigum(const uint32_t k){\n          CBigNum ret;\n          if(!BN_rand(&ret, k, -1, 0)){\n              throw bignum_error(\"CBigNum:rand element : BN_rand failed\");\n          }\n          return ret;\n      }\n}"
  },
  {
    "function_name": "randBignum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "111-117",
    "snippet": "static CBigNum  randBignum(const CBigNum& range) {\n        CBigNum ret;\n        if(!BN_rand_range(&ret, &range)){\n            throw bignum_error(\"CBigNum:rand element : BN_rand_range failed\");\n        }\n        return ret;\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"CBigNum:rand element : BN_rand_range failed\""
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_rand_range",
          "args": [
            "&ret",
            "&range"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  static CBigNum  randBignum(const CBigNum& range) {\n          CBigNum ret;\n          if(!BN_rand_range(&ret, &range)){\n              throw bignum_error(\"CBigNum:rand element : BN_rand_range failed\");\n          }\n          return ret;\n      }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "100-104",
    "snippet": "explicit CBigNum(const std::vector<unsigned char>& vch)\n    {\n        BN_init(this);\n        setvch(vch);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setvch",
          "args": [
            "vch"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "setvch",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "294-307",
          "snippet": "void setvch(const std::vector<unsigned char>& vch)\n    {\n        std::vector<unsigned char> vch2(vch.size() + 4);\n        unsigned int nSize = vch.size();\n        // BIGNUM's byte stream format expects 4 bytes of\n        // big endian size data info at the front\n        vch2[0] = (nSize >> 24) & 0xff;\n        vch2[1] = (nSize >> 16) & 0xff;\n        vch2[2] = (nSize >> 8) & 0xff;\n        vch2[3] = (nSize >> 0) & 0xff;\n        // swap data to big endian\n        reverse_copy(vch.begin(), vch.end(), vch2.begin() + 4);\n        BN_mpi2bn(&vch2[0], vch2.size(), this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setvch(const std::vector<unsigned char>& vch)\n      {\n          std::vector<unsigned char> vch2(vch.size() + 4);\n          unsigned int nSize = vch.size();\n          // BIGNUM's byte stream format expects 4 bytes of\n          // big endian size data info at the front\n          vch2[0] = (nSize >> 24) & 0xff;\n          vch2[1] = (nSize >> 16) & 0xff;\n          vch2[2] = (nSize >> 8) & 0xff;\n          vch2[3] = (nSize >> 0) & 0xff;\n          // swap data to big endian\n          reverse_copy(vch.begin(), vch.end(), vch2.begin() + 4);\n          BN_mpi2bn(&vch2[0], vch2.size(), this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  explicit CBigNum(const std::vector<unsigned char>& vch)\n      {\n          BN_init(this);\n          setvch(vch);\n      }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "98-98",
    "snippet": "explicit CBigNum(uint256 n)   { BN_init(this); setuint256(n); }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setuint256",
          "args": [
            "n"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "setuint256",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "250-276",
          "snippet": "void setuint256(uint256 n)\n    {\n        unsigned char pch[sizeof(n) + 6];\n        unsigned char* p = pch + 4;\n        bool fLeadingZeroes = true;\n        unsigned char* pbegin = (unsigned char*)&n;\n        unsigned char* psrc = pbegin + sizeof(n);\n        while (psrc != pbegin)\n        {\n            unsigned char c = *(--psrc);\n            if (fLeadingZeroes)\n            {\n                if (c == 0)\n                    continue;\n                if (c & 0x80)\n                    *p++ = 0;\n                fLeadingZeroes = false;\n            }\n            *p++ = c;\n        }\n        unsigned int nSize = p - (pch + 4);\n        pch[0] = (nSize >> 24) & 0xff;\n        pch[1] = (nSize >> 16) & 0xff;\n        pch[2] = (nSize >> 8) & 0xff;\n        pch[3] = (nSize >> 0) & 0xff;\n        BN_mpi2bn(pch, p - pch, this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setuint256(uint256 n)\n      {\n          unsigned char pch[sizeof(n) + 6];\n          unsigned char* p = pch + 4;\n          bool fLeadingZeroes = true;\n          unsigned char* pbegin = (unsigned char*)&n;\n          unsigned char* psrc = pbegin + sizeof(n);\n          while (psrc != pbegin)\n          {\n              unsigned char c = *(--psrc);\n              if (fLeadingZeroes)\n              {\n                  if (c == 0)\n                      continue;\n                  if (c & 0x80)\n                      *p++ = 0;\n                  fLeadingZeroes = false;\n              }\n              *p++ = c;\n          }\n          unsigned int nSize = p - (pch + 4);\n          pch[0] = (nSize >> 24) & 0xff;\n          pch[1] = (nSize >> 16) & 0xff;\n          pch[2] = (nSize >> 8) & 0xff;\n          pch[3] = (nSize >> 0) & 0xff;\n          BN_mpi2bn(pch, p - pch, this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  explicit CBigNum(uint256 n)   { BN_init(this); setuint256(n); }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "97-97",
    "snippet": "CBigNum(unsigned long long n) { BN_init(this); setuint64(n); }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setuint64",
          "args": [
            "n"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "setuint64",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "223-248",
          "snippet": "void setuint64(uint64_t n)\n    {\n        unsigned char pch[sizeof(n) + 6];\n        unsigned char* p = pch + 4;\n        bool fLeadingZeroes = true;\n        for (int i = 0; i < 8; i++)\n        {\n            unsigned char c = (n >> 56) & 0xff;\n            n <<= 8;\n            if (fLeadingZeroes)\n            {\n                if (c == 0)\n                    continue;\n                if (c & 0x80)\n                    *p++ = 0;\n                fLeadingZeroes = false;\n            }\n            *p++ = c;\n        }\n        unsigned int nSize = p - (pch + 4);\n        pch[0] = (nSize >> 24) & 0xff;\n        pch[1] = (nSize >> 16) & 0xff;\n        pch[2] = (nSize >> 8) & 0xff;\n        pch[3] = (nSize) & 0xff;\n        BN_mpi2bn(pch, p - pch, this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setuint64(uint64_t n)\n      {\n          unsigned char pch[sizeof(n) + 6];\n          unsigned char* p = pch + 4;\n          bool fLeadingZeroes = true;\n          for (int i = 0; i < 8; i++)\n          {\n              unsigned char c = (n >> 56) & 0xff;\n              n <<= 8;\n              if (fLeadingZeroes)\n              {\n                  if (c == 0)\n                      continue;\n                  if (c & 0x80)\n                      *p++ = 0;\n                  fLeadingZeroes = false;\n              }\n              *p++ = c;\n          }\n          unsigned int nSize = p - (pch + 4);\n          pch[0] = (nSize >> 24) & 0xff;\n          pch[1] = (nSize >> 16) & 0xff;\n          pch[2] = (nSize >> 8) & 0xff;\n          pch[3] = (nSize) & 0xff;\n          BN_mpi2bn(pch, p - pch, this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum(unsigned long long n) { BN_init(this); setuint64(n); }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "96-96",
    "snippet": "CBigNum(unsigned long n)      { BN_init(this); setulong(n); }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setulong",
          "args": [
            "n"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "setulong",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "140-144",
          "snippet": "void setulong(unsigned long n)\n    {\n        if (!BN_set_word(this, n))\n            throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setulong(unsigned long n)\n      {\n          if (!BN_set_word(this, n))\n              throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum(unsigned long n)      { BN_init(this); setulong(n); }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "95-95",
    "snippet": "CBigNum(unsigned int n)       { BN_init(this); setulong(n); }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setulong",
          "args": [
            "n"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "setulong",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "140-144",
          "snippet": "void setulong(unsigned long n)\n    {\n        if (!BN_set_word(this, n))\n            throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setulong(unsigned long n)\n      {\n          if (!BN_set_word(this, n))\n              throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum(unsigned int n)       { BN_init(this); setulong(n); }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "94-94",
    "snippet": "CBigNum(unsigned short n)     { BN_init(this); setulong(n); }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setulong",
          "args": [
            "n"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "setulong",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "140-144",
          "snippet": "void setulong(unsigned long n)\n    {\n        if (!BN_set_word(this, n))\n            throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setulong(unsigned long n)\n      {\n          if (!BN_set_word(this, n))\n              throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum(unsigned short n)     { BN_init(this); setulong(n); }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "93-93",
    "snippet": "CBigNum(unsigned char n)      { BN_init(this); setulong(n); }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setulong",
          "args": [
            "n"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "setulong",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "140-144",
          "snippet": "void setulong(unsigned long n)\n    {\n        if (!BN_set_word(this, n))\n            throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setulong(unsigned long n)\n      {\n          if (!BN_set_word(this, n))\n              throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum(unsigned char n)      { BN_init(this); setulong(n); }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "92-92",
    "snippet": "CBigNum(long long n)          { BN_init(this); setint64(n); }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setint64",
          "args": [
            "n"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "setint64",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "165-206",
          "snippet": "void setint64(int64_t sn)\n    {\n        unsigned char pch[sizeof(sn) + 6];\n        unsigned char* p = pch + 4;\n        bool fNegative;\n        uint64_t n;\n\n        if (sn < (int64_t)0)\n        {\n            // Since the minimum signed integer cannot be represented as positive so long as its type is signed, and it's not well-defined what happens if you make it unsigned before negating it, we instead increment the negative integer by 1, convert it, then increment the (now positive) unsigned integer by 1 to compensate\n            n = -(sn + 1);\n            ++n;\n            fNegative = true;\n        } else {\n            n = sn;\n            fNegative = false;\n        }\n\n        bool fLeadingZeroes = true;\n        for (int i = 0; i < 8; i++)\n        {\n            unsigned char c = (n >> 56) & 0xff;\n            n <<= 8;\n            if (fLeadingZeroes)\n            {\n                if (c == 0)\n                    continue;\n                if (c & 0x80)\n                    *p++ = (fNegative ? 0x80 : 0);\n                else if (fNegative)\n                    c |= 0x80;\n                fLeadingZeroes = false;\n            }\n            *p++ = c;\n        }\n        unsigned int nSize = p - (pch + 4);\n        pch[0] = (nSize >> 24) & 0xff;\n        pch[1] = (nSize >> 16) & 0xff;\n        pch[2] = (nSize >> 8) & 0xff;\n        pch[3] = (nSize) & 0xff;\n        BN_mpi2bn(pch, p - pch, this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setint64(int64_t sn)\n      {\n          unsigned char pch[sizeof(sn) + 6];\n          unsigned char* p = pch + 4;\n          bool fNegative;\n          uint64_t n;\n  \n          if (sn < (int64_t)0)\n          {\n              // Since the minimum signed integer cannot be represented as positive so long as its type is signed, and it's not well-defined what happens if you make it unsigned before negating it, we instead increment the negative integer by 1, convert it, then increment the (now positive) unsigned integer by 1 to compensate\n              n = -(sn + 1);\n              ++n;\n              fNegative = true;\n          } else {\n              n = sn;\n              fNegative = false;\n          }\n  \n          bool fLeadingZeroes = true;\n          for (int i = 0; i < 8; i++)\n          {\n              unsigned char c = (n >> 56) & 0xff;\n              n <<= 8;\n              if (fLeadingZeroes)\n              {\n                  if (c == 0)\n                      continue;\n                  if (c & 0x80)\n                      *p++ = (fNegative ? 0x80 : 0);\n                  else if (fNegative)\n                      c |= 0x80;\n                  fLeadingZeroes = false;\n              }\n              *p++ = c;\n          }\n          unsigned int nSize = p - (pch + 4);\n          pch[0] = (nSize >> 24) & 0xff;\n          pch[1] = (nSize >> 16) & 0xff;\n          pch[2] = (nSize >> 8) & 0xff;\n          pch[3] = (nSize) & 0xff;\n          BN_mpi2bn(pch, p - pch, this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum(long long n)          { BN_init(this); setint64(n); }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "91-91",
    "snippet": "CBigNum(long n)               { BN_init(this); if (n >= 0) setulong(n); else setint64(n); }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setint64",
          "args": [
            "n"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "setint64",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "165-206",
          "snippet": "void setint64(int64_t sn)\n    {\n        unsigned char pch[sizeof(sn) + 6];\n        unsigned char* p = pch + 4;\n        bool fNegative;\n        uint64_t n;\n\n        if (sn < (int64_t)0)\n        {\n            // Since the minimum signed integer cannot be represented as positive so long as its type is signed, and it's not well-defined what happens if you make it unsigned before negating it, we instead increment the negative integer by 1, convert it, then increment the (now positive) unsigned integer by 1 to compensate\n            n = -(sn + 1);\n            ++n;\n            fNegative = true;\n        } else {\n            n = sn;\n            fNegative = false;\n        }\n\n        bool fLeadingZeroes = true;\n        for (int i = 0; i < 8; i++)\n        {\n            unsigned char c = (n >> 56) & 0xff;\n            n <<= 8;\n            if (fLeadingZeroes)\n            {\n                if (c == 0)\n                    continue;\n                if (c & 0x80)\n                    *p++ = (fNegative ? 0x80 : 0);\n                else if (fNegative)\n                    c |= 0x80;\n                fLeadingZeroes = false;\n            }\n            *p++ = c;\n        }\n        unsigned int nSize = p - (pch + 4);\n        pch[0] = (nSize >> 24) & 0xff;\n        pch[1] = (nSize >> 16) & 0xff;\n        pch[2] = (nSize >> 8) & 0xff;\n        pch[3] = (nSize) & 0xff;\n        BN_mpi2bn(pch, p - pch, this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setint64(int64_t sn)\n      {\n          unsigned char pch[sizeof(sn) + 6];\n          unsigned char* p = pch + 4;\n          bool fNegative;\n          uint64_t n;\n  \n          if (sn < (int64_t)0)\n          {\n              // Since the minimum signed integer cannot be represented as positive so long as its type is signed, and it's not well-defined what happens if you make it unsigned before negating it, we instead increment the negative integer by 1, convert it, then increment the (now positive) unsigned integer by 1 to compensate\n              n = -(sn + 1);\n              ++n;\n              fNegative = true;\n          } else {\n              n = sn;\n              fNegative = false;\n          }\n  \n          bool fLeadingZeroes = true;\n          for (int i = 0; i < 8; i++)\n          {\n              unsigned char c = (n >> 56) & 0xff;\n              n <<= 8;\n              if (fLeadingZeroes)\n              {\n                  if (c == 0)\n                      continue;\n                  if (c & 0x80)\n                      *p++ = (fNegative ? 0x80 : 0);\n                  else if (fNegative)\n                      c |= 0x80;\n                  fLeadingZeroes = false;\n              }\n              *p++ = c;\n          }\n          unsigned int nSize = p - (pch + 4);\n          pch[0] = (nSize >> 24) & 0xff;\n          pch[1] = (nSize >> 16) & 0xff;\n          pch[2] = (nSize >> 8) & 0xff;\n          pch[3] = (nSize) & 0xff;\n          BN_mpi2bn(pch, p - pch, this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setulong",
          "args": [
            "n"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "setulong",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "140-144",
          "snippet": "void setulong(unsigned long n)\n    {\n        if (!BN_set_word(this, n))\n            throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setulong(unsigned long n)\n      {\n          if (!BN_set_word(this, n))\n              throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum(long n)               { BN_init(this); if (n >= 0) setulong(n); else setint64(n); }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "90-90",
    "snippet": "CBigNum(int n)                { BN_init(this); if (n >= 0) setulong(n); else setint64(n); }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setint64",
          "args": [
            "n"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "setint64",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "165-206",
          "snippet": "void setint64(int64_t sn)\n    {\n        unsigned char pch[sizeof(sn) + 6];\n        unsigned char* p = pch + 4;\n        bool fNegative;\n        uint64_t n;\n\n        if (sn < (int64_t)0)\n        {\n            // Since the minimum signed integer cannot be represented as positive so long as its type is signed, and it's not well-defined what happens if you make it unsigned before negating it, we instead increment the negative integer by 1, convert it, then increment the (now positive) unsigned integer by 1 to compensate\n            n = -(sn + 1);\n            ++n;\n            fNegative = true;\n        } else {\n            n = sn;\n            fNegative = false;\n        }\n\n        bool fLeadingZeroes = true;\n        for (int i = 0; i < 8; i++)\n        {\n            unsigned char c = (n >> 56) & 0xff;\n            n <<= 8;\n            if (fLeadingZeroes)\n            {\n                if (c == 0)\n                    continue;\n                if (c & 0x80)\n                    *p++ = (fNegative ? 0x80 : 0);\n                else if (fNegative)\n                    c |= 0x80;\n                fLeadingZeroes = false;\n            }\n            *p++ = c;\n        }\n        unsigned int nSize = p - (pch + 4);\n        pch[0] = (nSize >> 24) & 0xff;\n        pch[1] = (nSize >> 16) & 0xff;\n        pch[2] = (nSize >> 8) & 0xff;\n        pch[3] = (nSize) & 0xff;\n        BN_mpi2bn(pch, p - pch, this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setint64(int64_t sn)\n      {\n          unsigned char pch[sizeof(sn) + 6];\n          unsigned char* p = pch + 4;\n          bool fNegative;\n          uint64_t n;\n  \n          if (sn < (int64_t)0)\n          {\n              // Since the minimum signed integer cannot be represented as positive so long as its type is signed, and it's not well-defined what happens if you make it unsigned before negating it, we instead increment the negative integer by 1, convert it, then increment the (now positive) unsigned integer by 1 to compensate\n              n = -(sn + 1);\n              ++n;\n              fNegative = true;\n          } else {\n              n = sn;\n              fNegative = false;\n          }\n  \n          bool fLeadingZeroes = true;\n          for (int i = 0; i < 8; i++)\n          {\n              unsigned char c = (n >> 56) & 0xff;\n              n <<= 8;\n              if (fLeadingZeroes)\n              {\n                  if (c == 0)\n                      continue;\n                  if (c & 0x80)\n                      *p++ = (fNegative ? 0x80 : 0);\n                  else if (fNegative)\n                      c |= 0x80;\n                  fLeadingZeroes = false;\n              }\n              *p++ = c;\n          }\n          unsigned int nSize = p - (pch + 4);\n          pch[0] = (nSize >> 24) & 0xff;\n          pch[1] = (nSize >> 16) & 0xff;\n          pch[2] = (nSize >> 8) & 0xff;\n          pch[3] = (nSize) & 0xff;\n          BN_mpi2bn(pch, p - pch, this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setulong",
          "args": [
            "n"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "setulong",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "140-144",
          "snippet": "void setulong(unsigned long n)\n    {\n        if (!BN_set_word(this, n))\n            throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setulong(unsigned long n)\n      {\n          if (!BN_set_word(this, n))\n              throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum(int n)                { BN_init(this); if (n >= 0) setulong(n); else setint64(n); }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "89-89",
    "snippet": "CBigNum(short n)              { BN_init(this); if (n >= 0) setulong(n); else setint64(n); }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setint64",
          "args": [
            "n"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "setint64",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "165-206",
          "snippet": "void setint64(int64_t sn)\n    {\n        unsigned char pch[sizeof(sn) + 6];\n        unsigned char* p = pch + 4;\n        bool fNegative;\n        uint64_t n;\n\n        if (sn < (int64_t)0)\n        {\n            // Since the minimum signed integer cannot be represented as positive so long as its type is signed, and it's not well-defined what happens if you make it unsigned before negating it, we instead increment the negative integer by 1, convert it, then increment the (now positive) unsigned integer by 1 to compensate\n            n = -(sn + 1);\n            ++n;\n            fNegative = true;\n        } else {\n            n = sn;\n            fNegative = false;\n        }\n\n        bool fLeadingZeroes = true;\n        for (int i = 0; i < 8; i++)\n        {\n            unsigned char c = (n >> 56) & 0xff;\n            n <<= 8;\n            if (fLeadingZeroes)\n            {\n                if (c == 0)\n                    continue;\n                if (c & 0x80)\n                    *p++ = (fNegative ? 0x80 : 0);\n                else if (fNegative)\n                    c |= 0x80;\n                fLeadingZeroes = false;\n            }\n            *p++ = c;\n        }\n        unsigned int nSize = p - (pch + 4);\n        pch[0] = (nSize >> 24) & 0xff;\n        pch[1] = (nSize >> 16) & 0xff;\n        pch[2] = (nSize >> 8) & 0xff;\n        pch[3] = (nSize) & 0xff;\n        BN_mpi2bn(pch, p - pch, this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setint64(int64_t sn)\n      {\n          unsigned char pch[sizeof(sn) + 6];\n          unsigned char* p = pch + 4;\n          bool fNegative;\n          uint64_t n;\n  \n          if (sn < (int64_t)0)\n          {\n              // Since the minimum signed integer cannot be represented as positive so long as its type is signed, and it's not well-defined what happens if you make it unsigned before negating it, we instead increment the negative integer by 1, convert it, then increment the (now positive) unsigned integer by 1 to compensate\n              n = -(sn + 1);\n              ++n;\n              fNegative = true;\n          } else {\n              n = sn;\n              fNegative = false;\n          }\n  \n          bool fLeadingZeroes = true;\n          for (int i = 0; i < 8; i++)\n          {\n              unsigned char c = (n >> 56) & 0xff;\n              n <<= 8;\n              if (fLeadingZeroes)\n              {\n                  if (c == 0)\n                      continue;\n                  if (c & 0x80)\n                      *p++ = (fNegative ? 0x80 : 0);\n                  else if (fNegative)\n                      c |= 0x80;\n                  fLeadingZeroes = false;\n              }\n              *p++ = c;\n          }\n          unsigned int nSize = p - (pch + 4);\n          pch[0] = (nSize >> 24) & 0xff;\n          pch[1] = (nSize >> 16) & 0xff;\n          pch[2] = (nSize >> 8) & 0xff;\n          pch[3] = (nSize) & 0xff;\n          BN_mpi2bn(pch, p - pch, this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setulong",
          "args": [
            "n"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "setulong",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "140-144",
          "snippet": "void setulong(unsigned long n)\n    {\n        if (!BN_set_word(this, n))\n            throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setulong(unsigned long n)\n      {\n          if (!BN_set_word(this, n))\n              throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum(short n)              { BN_init(this); if (n >= 0) setulong(n); else setint64(n); }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "88-88",
    "snippet": "CBigNum(signed char n)        { BN_init(this); if (n >= 0) setulong(n); else setint64(n); }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setint64",
          "args": [
            "n"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "setint64",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "165-206",
          "snippet": "void setint64(int64_t sn)\n    {\n        unsigned char pch[sizeof(sn) + 6];\n        unsigned char* p = pch + 4;\n        bool fNegative;\n        uint64_t n;\n\n        if (sn < (int64_t)0)\n        {\n            // Since the minimum signed integer cannot be represented as positive so long as its type is signed, and it's not well-defined what happens if you make it unsigned before negating it, we instead increment the negative integer by 1, convert it, then increment the (now positive) unsigned integer by 1 to compensate\n            n = -(sn + 1);\n            ++n;\n            fNegative = true;\n        } else {\n            n = sn;\n            fNegative = false;\n        }\n\n        bool fLeadingZeroes = true;\n        for (int i = 0; i < 8; i++)\n        {\n            unsigned char c = (n >> 56) & 0xff;\n            n <<= 8;\n            if (fLeadingZeroes)\n            {\n                if (c == 0)\n                    continue;\n                if (c & 0x80)\n                    *p++ = (fNegative ? 0x80 : 0);\n                else if (fNegative)\n                    c |= 0x80;\n                fLeadingZeroes = false;\n            }\n            *p++ = c;\n        }\n        unsigned int nSize = p - (pch + 4);\n        pch[0] = (nSize >> 24) & 0xff;\n        pch[1] = (nSize >> 16) & 0xff;\n        pch[2] = (nSize >> 8) & 0xff;\n        pch[3] = (nSize) & 0xff;\n        BN_mpi2bn(pch, p - pch, this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setint64(int64_t sn)\n      {\n          unsigned char pch[sizeof(sn) + 6];\n          unsigned char* p = pch + 4;\n          bool fNegative;\n          uint64_t n;\n  \n          if (sn < (int64_t)0)\n          {\n              // Since the minimum signed integer cannot be represented as positive so long as its type is signed, and it's not well-defined what happens if you make it unsigned before negating it, we instead increment the negative integer by 1, convert it, then increment the (now positive) unsigned integer by 1 to compensate\n              n = -(sn + 1);\n              ++n;\n              fNegative = true;\n          } else {\n              n = sn;\n              fNegative = false;\n          }\n  \n          bool fLeadingZeroes = true;\n          for (int i = 0; i < 8; i++)\n          {\n              unsigned char c = (n >> 56) & 0xff;\n              n <<= 8;\n              if (fLeadingZeroes)\n              {\n                  if (c == 0)\n                      continue;\n                  if (c & 0x80)\n                      *p++ = (fNegative ? 0x80 : 0);\n                  else if (fNegative)\n                      c |= 0x80;\n                  fLeadingZeroes = false;\n              }\n              *p++ = c;\n          }\n          unsigned int nSize = p - (pch + 4);\n          pch[0] = (nSize >> 24) & 0xff;\n          pch[1] = (nSize >> 16) & 0xff;\n          pch[2] = (nSize >> 8) & 0xff;\n          pch[3] = (nSize) & 0xff;\n          BN_mpi2bn(pch, p - pch, this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setulong",
          "args": [
            "n"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "setulong",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "140-144",
          "snippet": "void setulong(unsigned long n)\n    {\n        if (!BN_set_word(this, n))\n            throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setulong(unsigned long n)\n      {\n          if (!BN_set_word(this, n))\n              throw bignum_error(\"CBigNum conversion from unsigned long : BN_set_word failed\");\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum(signed char n)        { BN_init(this); if (n >= 0) setulong(n); else setint64(n); }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "65-73",
    "snippet": "CBigNum(const CBigNum& b)\n    {\n        BN_init(this);\n        if (!BN_copy(this, &b))\n        {\n            BN_clear_free(this);\n            throw bignum_error(\"CBigNum::CBigNum(const CBigNum&) : BN_copy failed\");\n        }\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"CBigNum::CBigNum(const CBigNum&) : BN_copy failed\""
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "this"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_copy",
          "args": [
            "this",
            "&b"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum(const CBigNum& b)\n      {\n          BN_init(this);\n          if (!BN_copy(this, &b))\n          {\n              BN_clear_free(this);\n              throw bignum_error(\"CBigNum::CBigNum(const CBigNum&) : BN_copy failed\");\n          }\n      }\n}"
  },
  {
    "function_name": "CBigNum",
    "container": "CBigNum",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "60-63",
    "snippet": "CBigNum()\n    {\n        BN_init(this);\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_init",
          "args": [
            "this"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum()\n      {\n          BN_init(this);\n      }\n}"
  },
  {
    "function_name": "CAutoBN_CTX",
    "container": "CAutoBN_CTX",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "36-41",
    "snippet": "CAutoBN_CTX()\n    {\n        pctx = BN_CTX_new();\n        if (pctx == NULL)\n            throw bignum_error(\"CAutoBN_CTX : BN_CTX_new() returned NULL\");\n    }",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bignum_error",
          "args": [
            "\"CAutoBN_CTX : BN_CTX_new() returned NULL\""
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "bignum_error",
          "container": "bignum_error",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "24-24",
          "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_CTX_new",
          "args": [],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCAutoBN_CTX {\n  CAutoBN_CTX()\n      {\n          pctx = BN_CTX_new();\n          if (pctx == NULL)\n              throw bignum_error(\"CAutoBN_CTX : BN_CTX_new() returned NULL\");\n      }\n}"
  },
  {
    "function_name": "bignum_error",
    "container": "bignum_error",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
    "lines": "24-24",
    "snippet": "explicit bignum_error(const std::string& str) : std::runtime_error(str) {}",
    "includes": [
      "#include <stdint.h>",
      "#include <vector>",
      "#include <stdexcept>",
      "#include <openssl/bn.h>",
      "#include \"version.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nbignum_error {\n  explicit bignum_error(const std::string& str) : std::runtime_error(str) {}\n}"
  }
]