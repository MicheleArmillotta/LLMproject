[
  {
    "function_name": "NewLogger",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "366-369",
    "snippet": "virtual Status NewLogger(const std::string& fname, Logger** result) {\n    *result = new NoOpLogger;\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual Status NewLogger(const std::string& fname, Logger** result) {\n      *result = new NoOpLogger;\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "GetTestDirectory",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "361-364",
    "snippet": "virtual Status GetTestDirectory(std::string* path) {\n    *path = \"/test\";\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual Status GetTestDirectory(std::string* path) {\n      *path = \"/test\";\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "UnlockFile",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "356-359",
    "snippet": "virtual Status UnlockFile(FileLock* lock) {\n    delete lock;\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual Status UnlockFile(FileLock* lock) {\n      delete lock;\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "LockFile",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "351-354",
    "snippet": "virtual Status LockFile(const std::string& fname, FileLock** lock) {\n    *lock = new FileLock;\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual Status LockFile(const std::string& fname, FileLock** lock) {\n      *lock = new FileLock;\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "RenameFile",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "338-349",
    "snippet": "virtual Status RenameFile(const std::string& src,\n                            const std::string& target) {\n    MutexLock lock(&mutex_);\n    if (file_map_.find(src) == file_map_.end()) {\n      return Status::IOError(src, \"File not found\");\n    }\n\n    DeleteFileInternal(target);\n    file_map_[target] = file_map_[src];\n    file_map_.erase(src);\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.erase",
          "args": [
            "src"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "49-65",
          "snippet": "void erase(const key_type& k)\n    {\n        iterator itTarget = map.find(k);\n        if (itTarget == map.end())\n            return;\n        std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n        for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n            if (it->second == itTarget)\n            {\n                rmap.erase(it);\n                map.erase(itTarget);\n                return;\n            }\n        // Shouldn't ever get here\n        assert(0); //TODO remove me\n        map.erase(itTarget);\n    }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  void erase(const key_type& k)\n      {\n          iterator itTarget = map.find(k);\n          if (itTarget == map.end())\n              return;\n          std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n          for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n              if (it->second == itTarget)\n              {\n                  rmap.erase(it);\n                  map.erase(itTarget);\n                  return;\n              }\n          // Shouldn't ever get here\n          assert(0); //TODO remove me\n          map.erase(itTarget);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DeleteFileInternal",
          "args": [
            "target"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "DeleteFileInternal",
          "container": "InMemoryEnv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "301-308",
          "snippet": "void DeleteFileInternal(const std::string& fname) {\n    if (file_map_.find(fname) == file_map_.end()) {\n      return;\n    }\n\n    file_map_[fname]->Unref();\n    file_map_.erase(fname);\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  void DeleteFileInternal(const std::string& fname) {\n      if (file_map_.find(fname) == file_map_.end()) {\n        return;\n      }\n  \n      file_map_[fname]->Unref();\n      file_map_.erase(fname);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "src",
            "\"File not found\""
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.end",
          "args": [],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.find",
          "args": [
            "src"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual Status RenameFile(const std::string& src,\n                              const std::string& target) {\n      MutexLock lock(&mutex_);\n      if (file_map_.find(src) == file_map_.end()) {\n        return Status::IOError(src, \"File not found\");\n      }\n  \n      DeleteFileInternal(target);\n      file_map_[target] = file_map_[src];\n      file_map_.erase(src);\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "GetFileSize",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "328-336",
    "snippet": "virtual Status GetFileSize(const std::string& fname, uint64_t* file_size) {\n    MutexLock lock(&mutex_);\n    if (file_map_.find(fname) == file_map_.end()) {\n      return Status::IOError(fname, \"File not found\");\n    }\n\n    *file_size = file_map_[fname]->Size();\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_[fname]->Size",
          "args": [],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "Size",
          "container": "FileState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "50-50",
          "snippet": "uint64_t Size() const { return size_; }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  uint64_t Size() const { return size_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "fname",
            "\"File not found\""
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.end",
          "args": [],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.find",
          "args": [
            "fname"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual Status GetFileSize(const std::string& fname, uint64_t* file_size) {\n      MutexLock lock(&mutex_);\n      if (file_map_.find(fname) == file_map_.end()) {\n        return Status::IOError(fname, \"File not found\");\n      }\n  \n      *file_size = file_map_[fname]->Size();\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "DeleteDir",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "324-326",
    "snippet": "virtual Status DeleteDir(const std::string& dirname) {\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual Status DeleteDir(const std::string& dirname) {\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "CreateDir",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "320-322",
    "snippet": "virtual Status CreateDir(const std::string& dirname) {\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual Status CreateDir(const std::string& dirname) {\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "DeleteFile",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "310-318",
    "snippet": "virtual Status DeleteFile(const std::string& fname) {\n    MutexLock lock(&mutex_);\n    if (file_map_.find(fname) == file_map_.end()) {\n      return Status::IOError(fname, \"File not found\");\n    }\n\n    DeleteFileInternal(fname);\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DeleteFileInternal",
          "args": [
            "fname"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "DeleteFileInternal",
          "container": "InMemoryEnv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "301-308",
          "snippet": "void DeleteFileInternal(const std::string& fname) {\n    if (file_map_.find(fname) == file_map_.end()) {\n      return;\n    }\n\n    file_map_[fname]->Unref();\n    file_map_.erase(fname);\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  void DeleteFileInternal(const std::string& fname) {\n      if (file_map_.find(fname) == file_map_.end()) {\n        return;\n      }\n  \n      file_map_[fname]->Unref();\n      file_map_.erase(fname);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "fname",
            "\"File not found\""
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.end",
          "args": [],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.find",
          "args": [
            "fname"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual Status DeleteFile(const std::string& fname) {\n      MutexLock lock(&mutex_);\n      if (file_map_.find(fname) == file_map_.end()) {\n        return Status::IOError(fname, \"File not found\");\n      }\n  \n      DeleteFileInternal(fname);\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "DeleteFileInternal",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "301-308",
    "snippet": "void DeleteFileInternal(const std::string& fname) {\n    if (file_map_.find(fname) == file_map_.end()) {\n      return;\n    }\n\n    file_map_[fname]->Unref();\n    file_map_.erase(fname);\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file_map_.erase",
          "args": [
            "fname"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "49-65",
          "snippet": "void erase(const key_type& k)\n    {\n        iterator itTarget = map.find(k);\n        if (itTarget == map.end())\n            return;\n        std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n        for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n            if (it->second == itTarget)\n            {\n                rmap.erase(it);\n                map.erase(itTarget);\n                return;\n            }\n        // Shouldn't ever get here\n        assert(0); //TODO remove me\n        map.erase(itTarget);\n    }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  void erase(const key_type& k)\n      {\n          iterator itTarget = map.find(k);\n          if (itTarget == map.end())\n              return;\n          std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n          for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n              if (it->second == itTarget)\n              {\n                  rmap.erase(it);\n                  map.erase(itTarget);\n                  return;\n              }\n          // Shouldn't ever get here\n          assert(0); //TODO remove me\n          map.erase(itTarget);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_[fname]->Unref",
          "args": [],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "Unref",
          "container": "FileState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "33-48",
          "snippet": "void Unref() {\n    bool do_delete = false;\n\n    {\n      MutexLock lock(&refs_mutex_);\n      --refs_;\n      assert(refs_ >= 0);\n      if (refs_ <= 0) {\n        do_delete = true;\n      }\n    }\n\n    if (do_delete) {\n      delete this;\n    }\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  void Unref() {\n      bool do_delete = false;\n  \n      {\n        MutexLock lock(&refs_mutex_);\n        --refs_;\n        assert(refs_ >= 0);\n        if (refs_ <= 0) {\n          do_delete = true;\n        }\n      }\n  \n      if (do_delete) {\n        delete this;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.end",
          "args": [],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.find",
          "args": [
            "fname"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  void DeleteFileInternal(const std::string& fname) {\n      if (file_map_.find(fname) == file_map_.end()) {\n        return;\n      }\n  \n      file_map_[fname]->Unref();\n      file_map_.erase(fname);\n    }\n}"
  },
  {
    "function_name": "GetChildren",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "284-299",
    "snippet": "virtual Status GetChildren(const std::string& dir,\n                             std::vector<std::string>* result) {\n    MutexLock lock(&mutex_);\n    result->clear();\n\n    for (FileSystem::iterator i = file_map_.begin(); i != file_map_.end(); ++i){\n      const std::string& filename = i->first;\n\n      if (filename.size() >= dir.size() + 1 && filename[dir.size()] == '/' &&\n          Slice(filename).starts_with(Slice(dir))) {\n        result->push_back(filename.substr(dir.size() + 1));\n      }\n    }\n\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result->push_back",
          "args": [
            "filename.substr(dir.size() + 1)"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.substr",
          "args": [
            "dir.size() + 1"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dir.size",
          "args": [],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "Slice(dir)"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "HashSlice",
          "container": "ShardedLRUCache",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "276-278",
          "snippet": "static inline uint32_t HashSlice(const Slice& s) {\n    return Hash(s.data(), s.size(), 0);\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nShardedLRUCache {\n  static inline uint32_t HashSlice(const Slice& s) {\n      return Hash(s.data(), s.size(), 0);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.end",
          "args": [],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.begin",
          "args": [],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result->clear",
          "args": [],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual Status GetChildren(const std::string& dir,\n                               std::vector<std::string>* result) {\n      MutexLock lock(&mutex_);\n      result->clear();\n  \n      for (FileSystem::iterator i = file_map_.begin(); i != file_map_.end(); ++i){\n        const std::string& filename = i->first;\n  \n        if (filename.size() >= dir.size() + 1 && filename[dir.size()] == '/' &&\n            Slice(filename).starts_with(Slice(dir))) {\n          result->push_back(filename.substr(dir.size() + 1));\n        }\n      }\n  \n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "FileExists",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "279-282",
    "snippet": "virtual bool FileExists(const std::string& fname) {\n    MutexLock lock(&mutex_);\n    return file_map_.find(fname) != file_map_.end();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file_map_.end",
          "args": [],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.find",
          "args": [
            "fname"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual bool FileExists(const std::string& fname) {\n      MutexLock lock(&mutex_);\n      return file_map_.find(fname) != file_map_.end();\n    }\n}"
  },
  {
    "function_name": "NewWritableFile",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "264-277",
    "snippet": "virtual Status NewWritableFile(const std::string& fname,\n                                 WritableFile** result) {\n    MutexLock lock(&mutex_);\n    if (file_map_.find(fname) != file_map_.end()) {\n      DeleteFileInternal(fname);\n    }\n\n    FileState* file = new FileState();\n    file->Ref();\n    file_map_[fname] = file;\n\n    *result = new WritableFileImpl(file);\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file->Ref",
          "args": [],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "Ref",
          "container": "FileState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "27-30",
          "snippet": "void Ref() {\n    MutexLock lock(&refs_mutex_);\n    ++refs_;\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  void Ref() {\n      MutexLock lock(&refs_mutex_);\n      ++refs_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DeleteFileInternal",
          "args": [
            "fname"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "DeleteFileInternal",
          "container": "InMemoryEnv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "301-308",
          "snippet": "void DeleteFileInternal(const std::string& fname) {\n    if (file_map_.find(fname) == file_map_.end()) {\n      return;\n    }\n\n    file_map_[fname]->Unref();\n    file_map_.erase(fname);\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  void DeleteFileInternal(const std::string& fname) {\n      if (file_map_.find(fname) == file_map_.end()) {\n        return;\n      }\n  \n      file_map_[fname]->Unref();\n      file_map_.erase(fname);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.end",
          "args": [],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.find",
          "args": [
            "fname"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual Status NewWritableFile(const std::string& fname,\n                                   WritableFile** result) {\n      MutexLock lock(&mutex_);\n      if (file_map_.find(fname) != file_map_.end()) {\n        DeleteFileInternal(fname);\n      }\n  \n      FileState* file = new FileState();\n      file->Ref();\n      file_map_[fname] = file;\n  \n      *result = new WritableFileImpl(file);\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "NewRandomAccessFile",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "252-262",
    "snippet": "virtual Status NewRandomAccessFile(const std::string& fname,\n                                     RandomAccessFile** result) {\n    MutexLock lock(&mutex_);\n    if (file_map_.find(fname) == file_map_.end()) {\n      *result = NULL;\n      return Status::IOError(fname, \"File not found\");\n    }\n\n    *result = new RandomAccessFileImpl(file_map_[fname]);\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "fname",
            "\"File not found\""
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.end",
          "args": [],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.find",
          "args": [
            "fname"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual Status NewRandomAccessFile(const std::string& fname,\n                                       RandomAccessFile** result) {\n      MutexLock lock(&mutex_);\n      if (file_map_.find(fname) == file_map_.end()) {\n        *result = NULL;\n        return Status::IOError(fname, \"File not found\");\n      }\n  \n      *result = new RandomAccessFileImpl(file_map_[fname]);\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "NewSequentialFile",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "240-250",
    "snippet": "virtual Status NewSequentialFile(const std::string& fname,\n                                   SequentialFile** result) {\n    MutexLock lock(&mutex_);\n    if (file_map_.find(fname) == file_map_.end()) {\n      *result = NULL;\n      return Status::IOError(fname, \"File not found\");\n    }\n\n    *result = new SequentialFileImpl(file_map_[fname]);\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "fname",
            "\"File not found\""
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.end",
          "args": [],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_map_.find",
          "args": [
            "fname"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  virtual Status NewSequentialFile(const std::string& fname,\n                                     SequentialFile** result) {\n      MutexLock lock(&mutex_);\n      if (file_map_.find(fname) == file_map_.end()) {\n        *result = NULL;\n        return Status::IOError(fname, \"File not found\");\n      }\n  \n      *result = new SequentialFileImpl(file_map_[fname]);\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "InMemoryEnv",
    "container": "InMemoryEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "231-231",
    "snippet": "explicit InMemoryEnv(Env* base_env) : EnvWrapper(base_env) { }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nInMemoryEnv {\n  explicit InMemoryEnv(Env* base_env) : EnvWrapper(base_env) { }\n}"
  },
  {
    "function_name": "Logv",
    "container": "NoOpLogger",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "226-226",
    "snippet": "virtual void Logv(const char* format, va_list ap) { }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nNoOpLogger {\n  virtual void Logv(const char* format, va_list ap) { }\n}"
  },
  {
    "function_name": "Sync",
    "container": "WritableFileImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "218-218",
    "snippet": "virtual Status Sync() { return Status::OK(); }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nWritableFileImpl {\n  virtual Status Sync() { return Status::OK(); }\n}"
  },
  {
    "function_name": "Flush",
    "container": "WritableFileImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "217-217",
    "snippet": "virtual Status Flush() { return Status::OK(); }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nWritableFileImpl {\n  virtual Status Flush() { return Status::OK(); }\n}"
  },
  {
    "function_name": "Close",
    "container": "WritableFileImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "216-216",
    "snippet": "virtual Status Close() { return Status::OK(); }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nWritableFileImpl {\n  virtual Status Close() { return Status::OK(); }\n}"
  },
  {
    "function_name": "Append",
    "container": "WritableFileImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "212-214",
    "snippet": "virtual Status Append(const Slice& data) {\n    return file_->Append(data);\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file_->Append",
          "args": [
            "data"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "Append",
          "container": "WritableFileImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "212-214",
          "snippet": "virtual Status Append(const Slice& data) {\n    return file_->Append(data);\n  }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nWritableFileImpl {\n  virtual Status Append(const Slice& data) {\n      return file_->Append(data);\n    }\n}"
  },
  {
    "function_name": "WritableFileImpl",
    "container": "WritableFileImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "204-206",
    "snippet": "WritableFileImpl(FileState* file) : file_(file) {\n    file_->Ref();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file_->Ref",
          "args": [],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "Ref",
          "container": "FileState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "27-30",
          "snippet": "void Ref() {\n    MutexLock lock(&refs_mutex_);\n    ++refs_;\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  void Ref() {\n      MutexLock lock(&refs_mutex_);\n      ++refs_;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nWritableFileImpl {\n  WritableFileImpl(FileState* file) : file_(file) {\n      file_->Ref();\n    }\n}"
  },
  {
    "function_name": "Read",
    "container": "RandomAccessFileImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "193-196",
    "snippet": "virtual Status Read(uint64_t offset, size_t n, Slice* result,\n                      char* scratch) const {\n    return file_->Read(offset, n, result, scratch);\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file_->Read",
          "args": [
            "offset",
            "n",
            "result",
            "scratch"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "RandomAccessFileImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "193-196",
          "snippet": "virtual Status Read(uint64_t offset, size_t n, Slice* result,\n                      char* scratch) const {\n    return file_->Read(offset, n, result, scratch);\n  }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nRandomAccessFileImpl {\n  virtual Status Read(uint64_t offset, size_t n, Slice* result,\n                        char* scratch) const {\n      return file_->Read(offset, n, result, scratch);\n    }\n}"
  },
  {
    "function_name": "RandomAccessFileImpl",
    "container": "RandomAccessFileImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "185-187",
    "snippet": "explicit RandomAccessFileImpl(FileState* file) : file_(file) {\n    file_->Ref();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file_->Ref",
          "args": [],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "Ref",
          "container": "FileState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "27-30",
          "snippet": "void Ref() {\n    MutexLock lock(&refs_mutex_);\n    ++refs_;\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  void Ref() {\n      MutexLock lock(&refs_mutex_);\n      ++refs_;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nRandomAccessFileImpl {\n  explicit RandomAccessFileImpl(FileState* file) : file_(file) {\n      file_->Ref();\n    }\n}"
  },
  {
    "function_name": "Skip",
    "container": "SequentialFileImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "166-176",
    "snippet": "virtual Status Skip(uint64_t n) {\n    if (pos_ > file_->Size()) {\n      return Status::IOError(\"pos_ > file_->Size()\");\n    }\n    const size_t available = file_->Size() - pos_;\n    if (n > available) {\n      n = available;\n    }\n    pos_ += n;\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_->Size",
          "args": [],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "Size",
          "container": "FileState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "50-50",
          "snippet": "uint64_t Size() const { return size_; }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  uint64_t Size() const { return size_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "\"pos_ > file_->Size()\""
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "47-49",
          "snippet": "static Status IOError(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kIOError, msg, msg2);\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status IOError(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kIOError, msg, msg2);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nSequentialFileImpl {\n  virtual Status Skip(uint64_t n) {\n      if (pos_ > file_->Size()) {\n        return Status::IOError(\"pos_ > file_->Size()\");\n      }\n      const size_t available = file_->Size() - pos_;\n      if (n > available) {\n        n = available;\n      }\n      pos_ += n;\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "Read",
    "container": "SequentialFileImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "158-164",
    "snippet": "virtual Status Read(size_t n, Slice* result, char* scratch) {\n    Status s = file_->Read(pos_, n, result, scratch);\n    if (s.ok()) {\n      pos_ += result->size();\n    }\n    return s;\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result->size",
          "args": [],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_->Read",
          "args": [
            "pos_",
            "n",
            "result",
            "scratch"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "RandomAccessFileImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "193-196",
          "snippet": "virtual Status Read(uint64_t offset, size_t n, Slice* result,\n                      char* scratch) const {\n    return file_->Read(offset, n, result, scratch);\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nRandomAccessFileImpl {\n  virtual Status Read(uint64_t offset, size_t n, Slice* result,\n                        char* scratch) const {\n      return file_->Read(offset, n, result, scratch);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nSequentialFileImpl {\n  virtual Status Read(size_t n, Slice* result, char* scratch) {\n      Status s = file_->Read(pos_, n, result, scratch);\n      if (s.ok()) {\n        pos_ += result->size();\n      }\n      return s;\n    }\n}"
  },
  {
    "function_name": "SequentialFileImpl",
    "container": "SequentialFileImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "150-152",
    "snippet": "explicit SequentialFileImpl(FileState* file) : file_(file), pos_(0) {\n    file_->Ref();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file_->Ref",
          "args": [],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "Ref",
          "container": "FileState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
          "lines": "27-30",
          "snippet": "void Ref() {\n    MutexLock lock(&refs_mutex_);\n    ++refs_;\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <map>",
            "#include \"util/mutexlock.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"helpers/memenv/memenv.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  void Ref() {\n      MutexLock lock(&refs_mutex_);\n      ++refs_;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nSequentialFileImpl {\n  explicit SequentialFileImpl(FileState* file) : file_(file), pos_(0) {\n      file_->Ref();\n    }\n}"
  },
  {
    "function_name": "Append",
    "container": "FileState",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "94-121",
    "snippet": "Status Append(const Slice& data) {\n    const char* src = data.data();\n    size_t src_len = data.size();\n\n    while (src_len > 0) {\n      size_t avail;\n      size_t offset = size_ % kBlockSize;\n\n      if (offset != 0) {\n        // There is some room in the last block.\n        avail = kBlockSize - offset;\n      } else {\n        // No room in the last block; push new one.\n        blocks_.push_back(new char[kBlockSize]);\n        avail = kBlockSize;\n      }\n\n      if (avail > src_len) {\n        avail = src_len;\n      }\n      memcpy(blocks_.back() + offset, src, avail);\n      src_len -= avail;\n      src += avail;\n      size_ += avail;\n    }\n\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "blocks_.back() + offset",
            "src",
            "avail"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "blocks_.back",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "blocks_.push_back",
          "args": [
            "new char[kBlockSize]"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.size",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.data",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  Status Append(const Slice& data) {\n      const char* src = data.data();\n      size_t src_len = data.size();\n  \n      while (src_len > 0) {\n        size_t avail;\n        size_t offset = size_ % kBlockSize;\n  \n        if (offset != 0) {\n          // There is some room in the last block.\n          avail = kBlockSize - offset;\n        } else {\n          // No room in the last block; push new one.\n          blocks_.push_back(new char[kBlockSize]);\n          avail = kBlockSize;\n        }\n  \n        if (avail > src_len) {\n          avail = src_len;\n        }\n        memcpy(blocks_.back() + offset, src, avail);\n        src_len -= avail;\n        src += avail;\n        size_ += avail;\n      }\n  \n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "Read",
    "container": "FileState",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "52-92",
    "snippet": "Status Read(uint64_t offset, size_t n, Slice* result, char* scratch) const {\n    if (offset > size_) {\n      return Status::IOError(\"Offset greater than file size.\");\n    }\n    const uint64_t available = size_ - offset;\n    if (n > available) {\n      n = available;\n    }\n    if (n == 0) {\n      *result = Slice();\n      return Status::OK();\n    }\n\n    size_t block = offset / kBlockSize;\n    size_t block_offset = offset % kBlockSize;\n\n    if (n <= kBlockSize - block_offset) {\n      // The requested bytes are all in the first block.\n      *result = Slice(blocks_[block] + block_offset, n);\n      return Status::OK();\n    }\n\n    size_t bytes_to_copy = n;\n    char* dst = scratch;\n\n    while (bytes_to_copy > 0) {\n      size_t avail = kBlockSize - block_offset;\n      if (avail > bytes_to_copy) {\n        avail = bytes_to_copy;\n      }\n      memcpy(dst, blocks_[block] + block_offset, avail);\n\n      bytes_to_copy -= avail;\n      dst += avail;\n      block++;\n      block_offset = 0;\n    }\n\n    *result = Slice(scratch, n);\n    return Status::OK();\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "scratch",
            "n"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst",
            "blocks_[block] + block_offset",
            "avail"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "66-66",
          "snippet": "std::string ToString() const { return std::string(data_, size_); }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  std::string ToString() const { return std::string(data_, size_); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "\"Offset greater than file size.\""
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "47-49",
          "snippet": "static Status IOError(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kIOError, msg, msg2);\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status IOError(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kIOError, msg, msg2);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  Status Read(uint64_t offset, size_t n, Slice* result, char* scratch) const {\n      if (offset > size_) {\n        return Status::IOError(\"Offset greater than file size.\");\n      }\n      const uint64_t available = size_ - offset;\n      if (n > available) {\n        n = available;\n      }\n      if (n == 0) {\n        *result = Slice();\n        return Status::OK();\n      }\n  \n      size_t block = offset / kBlockSize;\n      size_t block_offset = offset % kBlockSize;\n  \n      if (n <= kBlockSize - block_offset) {\n        // The requested bytes are all in the first block.\n        *result = Slice(blocks_[block] + block_offset, n);\n        return Status::OK();\n      }\n  \n      size_t bytes_to_copy = n;\n      char* dst = scratch;\n  \n      while (bytes_to_copy > 0) {\n        size_t avail = kBlockSize - block_offset;\n        if (avail > bytes_to_copy) {\n          avail = bytes_to_copy;\n        }\n        memcpy(dst, blocks_[block] + block_offset, avail);\n  \n        bytes_to_copy -= avail;\n        dst += avail;\n        block++;\n        block_offset = 0;\n      }\n  \n      *result = Slice(scratch, n);\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "Size",
    "container": "FileState",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "50-50",
    "snippet": "uint64_t Size() const { return size_; }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  uint64_t Size() const { return size_; }\n}"
  },
  {
    "function_name": "Unref",
    "container": "FileState",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "33-48",
    "snippet": "void Unref() {\n    bool do_delete = false;\n\n    {\n      MutexLock lock(&refs_mutex_);\n      --refs_;\n      assert(refs_ >= 0);\n      if (refs_ <= 0) {\n        do_delete = true;\n      }\n    }\n\n    if (do_delete) {\n      delete this;\n    }\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "refs_ >= 0"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  void Unref() {\n      bool do_delete = false;\n  \n      {\n        MutexLock lock(&refs_mutex_);\n        --refs_;\n        assert(refs_ >= 0);\n        if (refs_ <= 0) {\n          do_delete = true;\n        }\n      }\n  \n      if (do_delete) {\n        delete this;\n      }\n    }\n}"
  },
  {
    "function_name": "Ref",
    "container": "FileState",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "27-30",
    "snippet": "void Ref() {\n    MutexLock lock(&refs_mutex_);\n    ++refs_;\n  }",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  void Ref() {\n      MutexLock lock(&refs_mutex_);\n      ++refs_;\n    }\n}"
  },
  {
    "function_name": "FileState",
    "container": "FileState",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/helpers/memenv/memenv.cc",
    "lines": "24-24",
    "snippet": "FileState() : refs_(0), size_(0) {}",
    "includes": [
      "#include <vector>",
      "#include <string>",
      "#include <string.h>",
      "#include <map>",
      "#include \"util/mutexlock.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"helpers/memenv/memenv.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <map>\n#include \"util/mutexlock.h\"\n#include \"port/port.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"helpers/memenv/memenv.h\"\n\nFileState {\n  FileState() : refs_(0), size_(0) {}\n}"
  }
]