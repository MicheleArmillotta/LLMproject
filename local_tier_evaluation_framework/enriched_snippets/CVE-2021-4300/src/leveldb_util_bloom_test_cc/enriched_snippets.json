[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "159-161",
    "snippet": "int main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "leveldb::test::RunAllTests",
          "args": [],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "RunAllTests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "36-58",
          "snippet": "int RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nint main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "115-153",
    "snippet": "TEST(BloomTest, VaryingLengths) {\n  char buffer[sizeof(int)];\n\n  // Count number of filters that significantly exceed the false positive rate\n  int mediocre_filters = 0;\n  int good_filters = 0;\n\n  for (int length = 1; length <= 10000; length = NextLength(length)) {\n    Reset();\n    for (int i = 0; i < length; i++) {\n      Add(Key(i, buffer));\n    }\n    Build();\n\n    ASSERT_LE(FilterSize(), static_cast<size_t>((length * 10 / 8) + 40))\n        << length;\n\n    // All added keys must match\n    for (int i = 0; i < length; i++) {\n      ASSERT_TRUE(Matches(Key(i, buffer)))\n          << \"Length \" << length << \"; key \" << i;\n    }\n\n    // Check false positive rate\n    double rate = FalsePositiveRate();\n    if (kVerbose >= 1) {\n      fprintf(stderr, \"False positives: %5.2f%% @ length = %6d ; bytes = %6d\\n\",\n              rate*100.0, length, static_cast<int>(FilterSize()));\n    }\n    ASSERT_LE(rate, 0.02);   // Must not be over 2%\n    if (rate > 0.0125) mediocre_filters++;  // Allowed, but not too often\n    else good_filters++;\n  }\n  if (kVerbose >= 1) {\n    fprintf(stderr, \"Filters: %d good, %d mediocre\\n\",\n            good_filters, mediocre_filters);\n  }\n  ASSERT_LE(mediocre_filters, good_filters/5);\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "mediocre_filters",
            "good_filters/5"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Filters: %d good, %d mediocre\\n\"",
            "good_filters",
            "mediocre_filters"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "rate",
            "0.02"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"False positives: %5.2f%% @ length = %6d ; bytes = %6d\\n\"",
            "rate*100.0",
            "length",
            "static_cast<int>(FilterSize())"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "FilterSize()"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FilterSize",
          "args": [],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "FilterSize",
          "container": "BloomTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "54-56",
          "snippet": "size_t FilterSize() const {\n    return filter_.size();\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  size_t FilterSize() const {\n      return filter_.size();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FalsePositiveRate",
          "args": [],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "FalsePositiveRate",
          "container": "BloomTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "76-85",
          "snippet": "double FalsePositiveRate() {\n    char buffer[sizeof(int)];\n    int result = 0;\n    for (int i = 0; i < 10000; i++) {\n      if (Matches(Key(i + 1000000000, buffer))) {\n        result++;\n      }\n    }\n    return result / 10000.0;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  double FalsePositiveRate() {\n      char buffer[sizeof(int)];\n      int result = 0;\n      for (int i = 0; i < 10000; i++) {\n        if (Matches(Key(i + 1000000000, buffer))) {\n          result++;\n        }\n      }\n      return result / 10000.0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Matches(Key(i, buffer))"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Matches",
          "args": [
            "Key(i, buffer)"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "Matches",
          "container": "BloomTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "69-74",
          "snippet": "bool Matches(const Slice& s) {\n    if (!keys_.empty()) {\n      Build();\n    }\n    return policy_->KeyMayMatch(s, filter_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  bool Matches(const Slice& s) {\n      if (!keys_.empty()) {\n        Build();\n      }\n      return policy_->KeyMayMatch(s, filter_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Key",
          "args": [
            "i",
            "buffer"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "Key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "16-19",
          "snippet": "static Slice Key(int i, char* buffer) {\n  EncodeFixed32(buffer, i);\n  return Slice(buffer, sizeof(uint32_t));\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nstatic Slice Key(int i, char* buffer) {\n  EncodeFixed32(buffer, i);\n  return Slice(buffer, sizeof(uint32_t));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "FilterSize()",
            "static_cast<size_t>((length * 10 / 8) + 40)"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<size_t>",
          "args": [
            "(length * 10 / 8) + 40"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Build",
          "args": [],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "Build",
          "container": "BloomTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "43-52",
          "snippet": "void Build() {\n    std::vector<Slice> key_slices;\n    for (size_t i = 0; i < keys_.size(); i++) {\n      key_slices.push_back(Slice(keys_[i]));\n    }\n    filter_.clear();\n    policy_->CreateFilter(&key_slices[0], key_slices.size(), &filter_);\n    keys_.clear();\n    if (kVerbose >= 2) DumpFilter();\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  void Build() {\n      std::vector<Slice> key_slices;\n      for (size_t i = 0; i < keys_.size(); i++) {\n        key_slices.push_back(Slice(keys_[i]));\n      }\n      filter_.clear();\n      policy_->CreateFilter(&key_slices[0], key_slices.size(), &filter_);\n      keys_.clear();\n      if (kVerbose >= 2) DumpFilter();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Add",
          "args": [
            "Key(i, buffer)"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "BloomTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "39-41",
          "snippet": "void Add(const Slice& s) {\n    keys_.push_back(s.ToString());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  void Add(const Slice& s) {\n      keys_.push_back(s.ToString());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Reset",
          "args": [],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "Reset",
          "container": "BloomTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "34-37",
          "snippet": "void Reset() {\n    keys_.clear();\n    filter_.clear();\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  void Reset() {\n      keys_.clear();\n      filter_.clear();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "NextLength",
          "args": [
            "length"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "NextLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "102-113",
          "snippet": "static int NextLength(int length) {\n  if (length < 10) {\n    length += 1;\n  } else if (length < 100) {\n    length += 10;\n  } else if (length < 1000) {\n    length += 100;\n  } else {\n    length += 1000;\n  }\n  return length;\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nstatic int NextLength(int length) {\n  if (length < 10) {\n    length += 1;\n  } else if (length < 100) {\n    length += 10;\n  } else if (length < 1000) {\n    length += 100;\n  } else {\n    length += 1000;\n  }\n  return length;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nTEST(BloomTest, VaryingLengths) {\n  char buffer[sizeof(int)];\n\n  // Count number of filters that significantly exceed the false positive rate\n  int mediocre_filters = 0;\n  int good_filters = 0;\n\n  for (int length = 1; length <= 10000; length = NextLength(length)) {\n    Reset();\n    for (int i = 0; i < length; i++) {\n      Add(Key(i, buffer));\n    }\n    Build();\n\n    ASSERT_LE(FilterSize(), static_cast<size_t>((length * 10 / 8) + 40))\n        << length;\n\n    // All added keys must match\n    for (int i = 0; i < length; i++) {\n      ASSERT_TRUE(Matches(Key(i, buffer)))\n          << \"Length \" << length << \"; key \" << i;\n    }\n\n    // Check false positive rate\n    double rate = FalsePositiveRate();\n    if (kVerbose >= 1) {\n      fprintf(stderr, \"False positives: %5.2f%% @ length = %6d ; bytes = %6d\\n\",\n              rate*100.0, length, static_cast<int>(FilterSize()));\n    }\n    ASSERT_LE(rate, 0.02);   // Must not be over 2%\n    if (rate > 0.0125) mediocre_filters++;  // Allowed, but not too often\n    else good_filters++;\n  }\n  if (kVerbose >= 1) {\n    fprintf(stderr, \"Filters: %d good, %d mediocre\\n\",\n            good_filters, mediocre_filters);\n  }\n  ASSERT_LE(mediocre_filters, good_filters/5);\n}"
  },
  {
    "function_name": "NextLength",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "102-113",
    "snippet": "static int NextLength(int length) {\n  if (length < 10) {\n    length += 1;\n  } else if (length < 100) {\n    length += 10;\n  } else if (length < 1000) {\n    length += 100;\n  } else {\n    length += 1000;\n  }\n  return length;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nstatic int NextLength(int length) {\n  if (length < 10) {\n    length += 1;\n  } else if (length < 100) {\n    length += 10;\n  } else if (length < 1000) {\n    length += 100;\n  } else {\n    length += 1000;\n  }\n  return length;\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "93-100",
    "snippet": "TEST(BloomTest, Small) {\n  Add(\"hello\");\n  Add(\"world\");\n  ASSERT_TRUE(Matches(\"hello\"));\n  ASSERT_TRUE(Matches(\"world\"));\n  ASSERT_TRUE(! Matches(\"x\"));\n  ASSERT_TRUE(! Matches(\"foo\"));\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Matches(\"foo\")"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Matches",
          "args": [
            "\"foo\""
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "Matches",
          "container": "BloomTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "69-74",
          "snippet": "bool Matches(const Slice& s) {\n    if (!keys_.empty()) {\n      Build();\n    }\n    return policy_->KeyMayMatch(s, filter_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  bool Matches(const Slice& s) {\n      if (!keys_.empty()) {\n        Build();\n      }\n      return policy_->KeyMayMatch(s, filter_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Matches(\"x\")"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Matches(\"world\")"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Matches(\"hello\")"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Add",
          "args": [
            "\"world\""
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "BloomTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "39-41",
          "snippet": "void Add(const Slice& s) {\n    keys_.push_back(s.ToString());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  void Add(const Slice& s) {\n      keys_.push_back(s.ToString());\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nTEST(BloomTest, Small) {\n  Add(\"hello\");\n  Add(\"world\");\n  ASSERT_TRUE(Matches(\"hello\"));\n  ASSERT_TRUE(Matches(\"world\"));\n  ASSERT_TRUE(! Matches(\"x\"));\n  ASSERT_TRUE(! Matches(\"foo\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "88-91",
    "snippet": "TEST(BloomTest, EmptyFilter) {\n  ASSERT_TRUE(! Matches(\"hello\"));\n  ASSERT_TRUE(! Matches(\"world\"));\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Matches(\"world\")"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Matches",
          "args": [
            "\"world\""
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "Matches",
          "container": "BloomTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "69-74",
          "snippet": "bool Matches(const Slice& s) {\n    if (!keys_.empty()) {\n      Build();\n    }\n    return policy_->KeyMayMatch(s, filter_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  bool Matches(const Slice& s) {\n      if (!keys_.empty()) {\n        Build();\n      }\n      return policy_->KeyMayMatch(s, filter_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "! Matches(\"hello\")"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nTEST(BloomTest, EmptyFilter) {\n  ASSERT_TRUE(! Matches(\"hello\"));\n  ASSERT_TRUE(! Matches(\"world\"));\n}"
  },
  {
    "function_name": "FalsePositiveRate",
    "container": "BloomTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "76-85",
    "snippet": "double FalsePositiveRate() {\n    char buffer[sizeof(int)];\n    int result = 0;\n    for (int i = 0; i < 10000; i++) {\n      if (Matches(Key(i + 1000000000, buffer))) {\n        result++;\n      }\n    }\n    return result / 10000.0;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Matches",
          "args": [
            "Key(i + 1000000000, buffer)"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "Matches",
          "container": "BloomTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "69-74",
          "snippet": "bool Matches(const Slice& s) {\n    if (!keys_.empty()) {\n      Build();\n    }\n    return policy_->KeyMayMatch(s, filter_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  bool Matches(const Slice& s) {\n      if (!keys_.empty()) {\n        Build();\n      }\n      return policy_->KeyMayMatch(s, filter_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Key",
          "args": [
            "i + 1000000000",
            "buffer"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "Key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "16-19",
          "snippet": "static Slice Key(int i, char* buffer) {\n  EncodeFixed32(buffer, i);\n  return Slice(buffer, sizeof(uint32_t));\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nstatic Slice Key(int i, char* buffer) {\n  EncodeFixed32(buffer, i);\n  return Slice(buffer, sizeof(uint32_t));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  double FalsePositiveRate() {\n      char buffer[sizeof(int)];\n      int result = 0;\n      for (int i = 0; i < 10000; i++) {\n        if (Matches(Key(i + 1000000000, buffer))) {\n          result++;\n        }\n      }\n      return result / 10000.0;\n    }\n}"
  },
  {
    "function_name": "Matches",
    "container": "BloomTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "69-74",
    "snippet": "bool Matches(const Slice& s) {\n    if (!keys_.empty()) {\n      Build();\n    }\n    return policy_->KeyMayMatch(s, filter_);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "policy_->KeyMayMatch",
          "args": [
            "s",
            "filter_"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "KeyMayMatch",
          "container": "leveldb_filterpolicy_t",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "121-124",
          "snippet": "virtual bool KeyMayMatch(const Slice& key, const Slice& filter) const {\n    return (*key_match_)(state_, key.data(), key.size(),\n                         filter.data(), filter.size());\n  }",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nleveldb_filterpolicy_t {\n  virtual bool KeyMayMatch(const Slice& key, const Slice& filter) const {\n      return (*key_match_)(state_, key.data(), key.size(),\n                           filter.data(), filter.size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Build",
          "args": [],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "Build",
          "container": "BloomTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "43-52",
          "snippet": "void Build() {\n    std::vector<Slice> key_slices;\n    for (size_t i = 0; i < keys_.size(); i++) {\n      key_slices.push_back(Slice(keys_[i]));\n    }\n    filter_.clear();\n    policy_->CreateFilter(&key_slices[0], key_slices.size(), &filter_);\n    keys_.clear();\n    if (kVerbose >= 2) DumpFilter();\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  void Build() {\n      std::vector<Slice> key_slices;\n      for (size_t i = 0; i < keys_.size(); i++) {\n        key_slices.push_back(Slice(keys_[i]));\n      }\n      filter_.clear();\n      policy_->CreateFilter(&key_slices[0], key_slices.size(), &filter_);\n      keys_.clear();\n      if (kVerbose >= 2) DumpFilter();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "keys_.empty",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  bool Matches(const Slice& s) {\n      if (!keys_.empty()) {\n        Build();\n      }\n      return policy_->KeyMayMatch(s, filter_);\n    }\n}"
  },
  {
    "function_name": "DumpFilter",
    "container": "BloomTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "58-67",
    "snippet": "void DumpFilter() {\n    fprintf(stderr, \"F(\");\n    for (size_t i = 0; i+1 < filter_.size(); i++) {\n      const unsigned int c = static_cast<unsigned int>(filter_[i]);\n      for (int j = 0; j < 8; j++) {\n        fprintf(stderr, \"%c\", (c & (1 <<j)) ? '1' : '.');\n      }\n    }\n    fprintf(stderr, \")\\n\");\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\")\\n\""
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%c\"",
            "(c & (1 <<j)) ? '1' : '.'"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<unsigned int>",
          "args": [
            "filter_[i]"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter_.size",
          "args": [],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"F(\""
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  void DumpFilter() {\n      fprintf(stderr, \"F(\");\n      for (size_t i = 0; i+1 < filter_.size(); i++) {\n        const unsigned int c = static_cast<unsigned int>(filter_[i]);\n        for (int j = 0; j < 8; j++) {\n          fprintf(stderr, \"%c\", (c & (1 <<j)) ? '1' : '.');\n        }\n      }\n      fprintf(stderr, \")\\n\");\n    }\n}"
  },
  {
    "function_name": "FilterSize",
    "container": "BloomTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "54-56",
    "snippet": "size_t FilterSize() const {\n    return filter_.size();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "filter_.size",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  size_t FilterSize() const {\n      return filter_.size();\n    }\n}"
  },
  {
    "function_name": "Build",
    "container": "BloomTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "43-52",
    "snippet": "void Build() {\n    std::vector<Slice> key_slices;\n    for (size_t i = 0; i < keys_.size(); i++) {\n      key_slices.push_back(Slice(keys_[i]));\n    }\n    filter_.clear();\n    policy_->CreateFilter(&key_slices[0], key_slices.size(), &filter_);\n    keys_.clear();\n    if (kVerbose >= 2) DumpFilter();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DumpFilter",
          "args": [],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "DumpFilter",
          "container": "BloomTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
          "lines": "58-67",
          "snippet": "void DumpFilter() {\n    fprintf(stderr, \"F(\");\n    for (size_t i = 0; i+1 < filter_.size(); i++) {\n      const unsigned int c = static_cast<unsigned int>(filter_[i]);\n      for (int j = 0; j < 8; j++) {\n        fprintf(stderr, \"%c\", (c & (1 <<j)) ? '1' : '.');\n      }\n    }\n    fprintf(stderr, \")\\n\");\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/filter_policy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  void DumpFilter() {\n      fprintf(stderr, \"F(\");\n      for (size_t i = 0; i+1 < filter_.size(); i++) {\n        const unsigned int c = static_cast<unsigned int>(filter_[i]);\n        for (int j = 0; j < 8; j++) {\n          fprintf(stderr, \"%c\", (c & (1 <<j)) ? '1' : '.');\n        }\n      }\n      fprintf(stderr, \")\\n\");\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "keys_.clear",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "policy_->CreateFilter",
          "args": [
            "&key_slices[0]",
            "key_slices.size()",
            "&filter_"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "CreateFilter",
          "container": "leveldb_filterpolicy_t",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "108-119",
          "snippet": "virtual void CreateFilter(const Slice* keys, int n, std::string* dst) const {\n    std::vector<const char*> key_pointers(n);\n    std::vector<size_t> key_sizes(n);\n    for (int i = 0; i < n; i++) {\n      key_pointers[i] = keys[i].data();\n      key_sizes[i] = keys[i].size();\n    }\n    size_t len;\n    char* filter = (*create_)(state_, &key_pointers[0], &key_sizes[0], n, &len);\n    dst->append(filter, len);\n    free(filter);\n  }",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nleveldb_filterpolicy_t {\n  virtual void CreateFilter(const Slice* keys, int n, std::string* dst) const {\n      std::vector<const char*> key_pointers(n);\n      std::vector<size_t> key_sizes(n);\n      for (int i = 0; i < n; i++) {\n        key_pointers[i] = keys[i].data();\n        key_sizes[i] = keys[i].size();\n      }\n      size_t len;\n      char* filter = (*create_)(state_, &key_pointers[0], &key_sizes[0], n, &len);\n      dst->append(filter, len);\n      free(filter);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "key_slices.size",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "key_slices.push_back",
          "args": [
            "Slice(keys_[i])"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "keys_[i]"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "HashSlice",
          "container": "ShardedLRUCache",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "276-278",
          "snippet": "static inline uint32_t HashSlice(const Slice& s) {\n    return Hash(s.data(), s.size(), 0);\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nShardedLRUCache {\n  static inline uint32_t HashSlice(const Slice& s) {\n      return Hash(s.data(), s.size(), 0);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  void Build() {\n      std::vector<Slice> key_slices;\n      for (size_t i = 0; i < keys_.size(); i++) {\n        key_slices.push_back(Slice(keys_[i]));\n      }\n      filter_.clear();\n      policy_->CreateFilter(&key_slices[0], key_slices.size(), &filter_);\n      keys_.clear();\n      if (kVerbose >= 2) DumpFilter();\n    }\n}"
  },
  {
    "function_name": "Add",
    "container": "BloomTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "39-41",
    "snippet": "void Add(const Slice& s) {\n    keys_.push_back(s.ToString());\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "keys_.push_back",
          "args": [
            "s.ToString()"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ToString",
          "args": [],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Histogram",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/histogram.cc",
          "lines": "105-137",
          "snippet": "std::string Histogram::ToString() const {\n  std::string r;\n  char buf[200];\n  snprintf(buf, sizeof(buf),\n           \"Count: %.0f  Average: %.4f  StdDev: %.2f\\n\",\n           num_, Average(), StandardDeviation());\n  r.append(buf);\n  snprintf(buf, sizeof(buf),\n           \"Min: %.4f  Median: %.4f  Max: %.4f\\n\",\n           (num_ == 0.0 ? 0.0 : min_), Median(), max_);\n  r.append(buf);\n  r.append(\"------------------------------------------------------\\n\");\n  const double mult = 100.0 / num_;\n  double sum = 0;\n  for (int b = 0; b < kNumBuckets; b++) {\n    if (buckets_[b] <= 0.0) continue;\n    sum += buckets_[b];\n    snprintf(buf, sizeof(buf),\n             \"[ %7.0f, %7.0f ) %7.0f %7.3f%% %7.3f%% \",\n             ((b == 0) ? 0.0 : kBucketLimit[b-1]),      // left\n             kBucketLimit[b],                           // right\n             buckets_[b],                               // count\n             mult * buckets_[b],                        // percentage\n             mult * sum);                               // cumulative percentage\n    r.append(buf);\n\n    // Add hash marks based on percentage; 20 marks for 100%.\n    int marks = static_cast<int>(20*(buckets_[b] / num_) + 0.5);\n    r.append(marks, '#');\n    r.push_back('\\n');\n  }\n  return r;\n}",
          "includes": [
            "#include \"util/histogram.h\"",
            "#include \"port/port.h\"",
            "#include <stdio.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/histogram.h\"\n#include \"port/port.h\"\n#include <stdio.h>\n#include <math.h>\n\nHistogram {\n  std::string Histogram::ToString() const {\n    std::string r;\n    char buf[200];\n    snprintf(buf, sizeof(buf),\n             \"Count: %.0f  Average: %.4f  StdDev: %.2f\\n\",\n             num_, Average(), StandardDeviation());\n    r.append(buf);\n    snprintf(buf, sizeof(buf),\n             \"Min: %.4f  Median: %.4f  Max: %.4f\\n\",\n             (num_ == 0.0 ? 0.0 : min_), Median(), max_);\n    r.append(buf);\n    r.append(\"------------------------------------------------------\\n\");\n    const double mult = 100.0 / num_;\n    double sum = 0;\n    for (int b = 0; b < kNumBuckets; b++) {\n      if (buckets_[b] <= 0.0) continue;\n      sum += buckets_[b];\n      snprintf(buf, sizeof(buf),\n               \"[ %7.0f, %7.0f ) %7.0f %7.3f%% %7.3f%% \",\n               ((b == 0) ? 0.0 : kBucketLimit[b-1]),      // left\n               kBucketLimit[b],                           // right\n               buckets_[b],                               // count\n               mult * buckets_[b],                        // percentage\n               mult * sum);                               // cumulative percentage\n      r.append(buf);\n  \n      // Add hash marks based on percentage; 20 marks for 100%.\n      int marks = static_cast<int>(20*(buckets_[b] / num_) + 0.5);\n      r.append(marks, '#');\n      r.push_back('\\n');\n    }\n    return r;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  void Add(const Slice& s) {\n      keys_.push_back(s.ToString());\n    }\n}"
  },
  {
    "function_name": "Reset",
    "container": "BloomTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "34-37",
    "snippet": "void Reset() {\n    keys_.clear();\n    filter_.clear();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "filter_.clear",
          "args": [],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  void Reset() {\n      keys_.clear();\n      filter_.clear();\n    }\n}"
  },
  {
    "function_name": "BloomTest",
    "container": "BloomTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "28-28",
    "snippet": "BloomTest() : policy_(NewBloomFilterPolicy(10)) { }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NewBloomFilterPolicy",
          "args": [
            "10"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nBloomTest {\n  BloomTest() : policy_(NewBloomFilterPolicy(10)) { }\n}"
  },
  {
    "function_name": "Key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/bloom_test.cc",
    "lines": "16-19",
    "snippet": "static Slice Key(int i, char* buffer) {\n  EncodeFixed32(buffer, i);\n  return Slice(buffer, sizeof(uint32_t));\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/coding.h\"",
      "#include \"leveldb/filter_policy.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "buffer",
            "sizeof(uint32_t)"
          ],
          "line": 18
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EncodeFixed32",
          "args": [
            "buffer",
            "i"
          ],
          "line": 17
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeFixed32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "9-18",
          "snippet": "void EncodeFixed32(char* buf, uint32_t value) {\n  if (port::kLittleEndian) {\n    memcpy(buf, &value, sizeof(value));\n  } else {\n    buf[0] = value & 0xff;\n    buf[1] = (value >> 8) & 0xff;\n    buf[2] = (value >> 16) & 0xff;\n    buf[3] = (value >> 24) & 0xff;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid EncodeFixed32(char* buf, uint32_t value) {\n  if (port::kLittleEndian) {\n    memcpy(buf, &value, sizeof(value));\n  } else {\n    buf[0] = value & 0xff;\n    buf[1] = (value >> 8) & 0xff;\n    buf[2] = (value >> 16) & 0xff;\n    buf[3] = (value >> 24) & 0xff;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/filter_policy.h\"\n\nstatic Slice Key(int i, char* buffer) {\n  EncodeFixed32(buffer, i);\n  return Slice(buffer, sizeof(uint32_t));\n}"
  }
]