[
  {
    "function_name": "NoBarrier_Store",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "142-144",
    "snippet": "void AtomicPointer::NoBarrier_Store(void* v) {\n  rep_ = v;\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nAtomicPointer {\n  void AtomicPointer::NoBarrier_Store(void* v) {\n    rep_ = v;\n  }\n}"
  },
  {
    "function_name": "Release_Store",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "134-136",
    "snippet": "void AtomicPointer::Release_Store(void* v) {\n  InterlockedExchangePointer(&rep_, v);\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "InterlockedExchangePointer",
          "args": [
            "&rep_",
            "v"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nAtomicPointer {\n  void AtomicPointer::Release_Store(void* v) {\n    InterlockedExchangePointer(&rep_, v);\n  }\n}"
  },
  {
    "function_name": "InitOnce",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "124-126",
    "snippet": "void InitOnce(OnceType* once, void (*initializer)()) {\n  once->InitOnce(initializer);\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "once->InitOnce",
          "args": [
            "initializer"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "InitOnce",
          "container": "OnceType",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.h",
          "lines": "103-110",
          "snippet": "void InitOnce(void (*initializer)()) {\n        mutex_.Lock();\n        if (!init_) {\n            init_ = true;\n            initializer();\n        }\n        mutex_.Unlock();\n    }",
          "includes": [
            "#include <snappy.h>",
            "#include <stdint.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <snappy.h>\n#include <stdint.h>\n#include <string>\n\nOnceType {\n  void InitOnce(void (*initializer)()) {\n          mutex_.Lock();\n          if (!init_) {\n              init_ = true;\n              initializer();\n          }\n          mutex_.Unlock();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nvoid InitOnce(OnceType* once, void (*initializer)()) {\n  once->InitOnce(initializer);\n}"
  },
  {
    "function_name": "AtomicPointer",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "120-122",
    "snippet": "AtomicPointer::AtomicPointer(void* v) {\n  Release_Store(v);\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Release_Store",
          "args": [
            "v"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "134-136",
          "snippet": "void AtomicPointer::Release_Store(void* v) {\n  InterlockedExchangePointer(&rep_, v);\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nAtomicPointer {\n  void AtomicPointer::Release_Store(void* v) {\n    InterlockedExchangePointer(&rep_, v);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nAtomicPointer {\n  AtomicPointer::AtomicPointer(void* v) {\n    Release_Store(v);\n  }\n}"
  },
  {
    "function_name": "SignalAll",
    "container": "CondVar",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "110-118",
    "snippet": "void CondVar::SignalAll() {\n  wait_mtx_.Lock();\n  ::ReleaseSemaphore(sem1_, waiting_, NULL);\n  while(waiting_ > 0) {\n    --waiting_;\n    ::WaitForSingleObject(sem2_, INFINITE);\n  }\n  wait_mtx_.Unlock();\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_mtx_.Unlock",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "Unlock",
          "container": "Mutex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "60-63",
          "snippet": "void Mutex::Unlock() {\n  assert(cs_);\n  ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Unlock() {\n    assert(cs_);\n    ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "::WaitForSingleObject",
          "args": [
            "sem2_",
            "INFINITE"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::ReleaseSemaphore",
          "args": [
            "sem1_",
            "waiting_",
            "NULL"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wait_mtx_.Lock",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "Lock",
          "container": "Mutex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "55-58",
          "snippet": "void Mutex::Lock() {\n  assert(cs_);\n  ::EnterCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Lock() {\n    assert(cs_);\n    ::EnterCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nCondVar {\n  void CondVar::SignalAll() {\n    wait_mtx_.Lock();\n    ::ReleaseSemaphore(sem1_, waiting_, NULL);\n    while(waiting_ > 0) {\n      --waiting_;\n      ::WaitForSingleObject(sem2_, INFINITE);\n    }\n    wait_mtx_.Unlock();\n  }\n}"
  },
  {
    "function_name": "Signal",
    "container": "CondVar",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "98-108",
    "snippet": "void CondVar::Signal() {\n  wait_mtx_.Lock();\n  if (waiting_ > 0) {\n    --waiting_;\n\n    // finalize handshake\n    ::ReleaseSemaphore(sem1_, 1, NULL);\n    ::WaitForSingleObject(sem2_, INFINITE);\n  }\n  wait_mtx_.Unlock();\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_mtx_.Unlock",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "Unlock",
          "container": "Mutex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "60-63",
          "snippet": "void Mutex::Unlock() {\n  assert(cs_);\n  ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Unlock() {\n    assert(cs_);\n    ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "::WaitForSingleObject",
          "args": [
            "sem2_",
            "INFINITE"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::ReleaseSemaphore",
          "args": [
            "sem1_",
            "1",
            "NULL"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wait_mtx_.Lock",
          "args": [],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "Lock",
          "container": "Mutex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "55-58",
          "snippet": "void Mutex::Lock() {\n  assert(cs_);\n  ::EnterCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Lock() {\n    assert(cs_);\n    ::EnterCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nCondVar {\n  void CondVar::Signal() {\n    wait_mtx_.Lock();\n    if (waiting_ > 0) {\n      --waiting_;\n  \n      // finalize handshake\n      ::ReleaseSemaphore(sem1_, 1, NULL);\n      ::WaitForSingleObject(sem2_, INFINITE);\n    }\n    wait_mtx_.Unlock();\n  }\n}"
  },
  {
    "function_name": "Wait",
    "container": "CondVar",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "83-96",
    "snippet": "void CondVar::Wait() {\n  mu_->AssertHeld();\n\n  wait_mtx_.Lock();\n  ++waiting_;\n  wait_mtx_.Unlock();\n\n  mu_->Unlock();\n\n  // initiate handshake\n  ::WaitForSingleObject(sem1_, INFINITE);\n  ::ReleaseSemaphore(sem2_, 1, NULL);\n  mu_->Lock();\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mu_->Lock",
          "args": [],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "Lock",
          "container": "Mutex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "55-58",
          "snippet": "void Mutex::Lock() {\n  assert(cs_);\n  ::EnterCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Lock() {\n    assert(cs_);\n    ::EnterCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "::ReleaseSemaphore",
          "args": [
            "sem2_",
            "1",
            "NULL"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::WaitForSingleObject",
          "args": [
            "sem1_",
            "INFINITE"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mu_->Unlock",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "Unlock",
          "container": "Mutex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "60-63",
          "snippet": "void Mutex::Unlock() {\n  assert(cs_);\n  ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Unlock() {\n    assert(cs_);\n    ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mu_->AssertHeld",
          "args": [],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "AssertHeld",
          "container": "Mutex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "65-68",
          "snippet": "void Mutex::AssertHeld() {\n  assert(cs_);\n  assert(1);\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::AssertHeld() {\n    assert(cs_);\n    assert(1);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nCondVar {\n  void CondVar::Wait() {\n    mu_->AssertHeld();\n  \n    wait_mtx_.Lock();\n    ++waiting_;\n    wait_mtx_.Unlock();\n  \n    mu_->Unlock();\n  \n    // initiate handshake\n    ::WaitForSingleObject(sem1_, INFINITE);\n    ::ReleaseSemaphore(sem2_, 1, NULL);\n    mu_->Lock();\n  }\n}"
  },
  {
    "function_name": "~CondVar",
    "container": "CondVar",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "78-81",
    "snippet": "CondVar::~CondVar() {\n  ::CloseHandle(sem1_);\n  ::CloseHandle(sem2_);\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::CloseHandle",
          "args": [
            "sem2_"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::CloseHandle",
          "args": [
            "sem1_"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nCondVar {\n  CondVar::~CondVar() {\n    ::CloseHandle(sem1_);\n    ::CloseHandle(sem2_);\n  }\n}"
  },
  {
    "function_name": "CondVar",
    "container": "CondVar",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "70-76",
    "snippet": "CondVar::CondVar(Mutex* mu) :\n    waiting_(0), \n    mu_(mu), \n    sem1_(::CreateSemaphore(NULL, 0, 10000, NULL)), \n    sem2_(::CreateSemaphore(NULL, 0, 10000, NULL)) {\n  assert(mu_);\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "mu_"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::CreateSemaphore",
          "args": [
            "NULL",
            "0",
            "10000",
            "NULL"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::CreateSemaphore",
          "args": [
            "NULL",
            "0",
            "10000",
            "NULL"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nCondVar {\n  CondVar::CondVar(Mutex* mu) :\n      waiting_(0), \n      mu_(mu), \n      sem1_(::CreateSemaphore(NULL, 0, 10000, NULL)), \n      sem2_(::CreateSemaphore(NULL, 0, 10000, NULL)) {\n    assert(mu_);\n  }\n}"
  },
  {
    "function_name": "AssertHeld",
    "container": "Mutex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "65-68",
    "snippet": "void Mutex::AssertHeld() {\n  assert(cs_);\n  assert(1);\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "1"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "cs_"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::AssertHeld() {\n    assert(cs_);\n    assert(1);\n  }\n}"
  },
  {
    "function_name": "Unlock",
    "container": "Mutex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "60-63",
    "snippet": "void Mutex::Unlock() {\n  assert(cs_);\n  ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::LeaveCriticalSection",
          "args": [
            "static_cast<CRITICAL_SECTION *>(cs_)"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<CRITICAL_SECTION *>",
          "args": [
            "cs_"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "cs_"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Unlock() {\n    assert(cs_);\n    ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
  },
  {
    "function_name": "Lock",
    "container": "Mutex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "55-58",
    "snippet": "void Mutex::Lock() {\n  assert(cs_);\n  ::EnterCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::EnterCriticalSection",
          "args": [
            "static_cast<CRITICAL_SECTION *>(cs_)"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<CRITICAL_SECTION *>",
          "args": [
            "cs_"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "cs_"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Lock() {\n    assert(cs_);\n    ::EnterCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
  },
  {
    "function_name": "~Mutex",
    "container": "Mutex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "47-53",
    "snippet": "Mutex::~Mutex() {\n  assert(cs_);\n  ::DeleteCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  delete static_cast<CRITICAL_SECTION *>(cs_);\n  cs_ = NULL;\n  assert(!cs_);\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!cs_"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<CRITICAL_SECTION *>",
          "args": [
            "cs_"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::DeleteCriticalSection",
          "args": [
            "static_cast<CRITICAL_SECTION *>(cs_)"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<CRITICAL_SECTION *>",
          "args": [
            "cs_"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "cs_"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  Mutex::~Mutex() {\n    assert(cs_);\n    ::DeleteCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n    delete static_cast<CRITICAL_SECTION *>(cs_);\n    cs_ = NULL;\n    assert(!cs_);\n  }\n}"
  },
  {
    "function_name": "Mutex",
    "container": "Mutex",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
    "lines": "39-45",
    "snippet": "Mutex::Mutex() :\n    cs_(NULL) {\n  assert(!cs_);\n  cs_ = static_cast<void *>(new CRITICAL_SECTION());\n  ::InitializeCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  assert(cs_);\n}",
    "includes": [
      "#include <cassert>",
      "#include <windows.h>",
      "#include \"port/port_win.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "cs_"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::InitializeCriticalSection",
          "args": [
            "static_cast<CRITICAL_SECTION *>(cs_)"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<CRITICAL_SECTION *>",
          "args": [
            "cs_"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<void *>",
          "args": [
            "new CRITICAL_SECTION()"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!cs_"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  Mutex::Mutex() :\n      cs_(NULL) {\n    assert(!cs_);\n    cs_ = static_cast<void *>(new CRITICAL_SECTION());\n    ::InitializeCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n    assert(cs_);\n  }\n}"
  }
]