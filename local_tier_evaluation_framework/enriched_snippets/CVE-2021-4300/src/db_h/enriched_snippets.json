[
  {
    "function_name": "WriteVersion",
    "container": "CDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
    "lines": "306-309",
    "snippet": "bool WriteVersion(int nVersion)\n    {\n        return Write(std::string(\"version\"), nVersion);\n    }",
    "includes": [
      "#include <db_cxx.h>",
      "#include <vector>",
      "#include <string>",
      "#include <map>",
      "#include \"main.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::string(\"version\")",
            "nVersion"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "CDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
          "lines": "150-176",
          "snippet": "bool Write(const K& key, const T& value, bool fOverwrite=true)\n    {\n        if (!pdb)\n            return false;\n        if (fReadOnly)\n            assert(!\"Write called on database in read-only mode\");\n\n        // Key\n        CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n        ssKey.reserve(1000);\n        ssKey << key;\n        Dbt datKey(&ssKey[0], ssKey.size());\n\n        // Value\n        CDataStream ssValue(SER_DISK, CLIENT_VERSION);\n        ssValue.reserve(10000);\n        ssValue << value;\n        Dbt datValue(&ssValue[0], ssValue.size());\n\n        // Write\n        int ret = pdb->put(activeTxn, &datKey, &datValue, (fOverwrite ? 0 : DB_NOOVERWRITE));\n\n        // Clear memory in case it was a private key\n        memset(datKey.get_data(), 0, datKey.get_size());\n        memset(datValue.get_data(), 0, datValue.get_size());\n        return (ret == 0);\n    }",
          "includes": [
            "#include <db_cxx.h>",
            "#include <vector>",
            "#include <string>",
            "#include <map>",
            "#include \"main.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDB {\n  bool Write(const K& key, const T& value, bool fOverwrite=true)\n      {\n          if (!pdb)\n              return false;\n          if (fReadOnly)\n              assert(!\"Write called on database in read-only mode\");\n  \n          // Key\n          CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n          ssKey.reserve(1000);\n          ssKey << key;\n          Dbt datKey(&ssKey[0], ssKey.size());\n  \n          // Value\n          CDataStream ssValue(SER_DISK, CLIENT_VERSION);\n          ssValue.reserve(10000);\n          ssValue << value;\n          Dbt datValue(&ssValue[0], ssValue.size());\n  \n          // Write\n          int ret = pdb->put(activeTxn, &datKey, &datValue, (fOverwrite ? 0 : DB_NOOVERWRITE));\n  \n          // Clear memory in case it was a private key\n          memset(datKey.get_data(), 0, datKey.get_size());\n          memset(datValue.get_data(), 0, datValue.get_size());\n          return (ret == 0);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"version\""
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDB {\n  bool WriteVersion(int nVersion)\n      {\n          return Write(std::string(\"version\"), nVersion);\n      }\n}"
  },
  {
    "function_name": "ReadVersion",
    "container": "CDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
    "lines": "300-304",
    "snippet": "bool ReadVersion(int& nVersion)\n    {\n        nVersion = 0;\n        return Read(std::string(\"version\"), nVersion);\n    }",
    "includes": [
      "#include <db_cxx.h>",
      "#include <vector>",
      "#include <string>",
      "#include <map>",
      "#include \"main.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Read",
          "args": [
            "std::string(\"version\")",
            "nVersion"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "CDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
          "lines": "115-147",
          "snippet": "bool Read(const K& key, T& value)\n    {\n        if (!pdb)\n            return false;\n\n        // Key\n        CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n        ssKey.reserve(1000);\n        ssKey << key;\n        Dbt datKey(&ssKey[0], ssKey.size());\n\n        // Read\n        Dbt datValue;\n        datValue.set_flags(DB_DBT_MALLOC);\n        int ret = pdb->get(activeTxn, &datKey, &datValue, 0);\n        memset(datKey.get_data(), 0, datKey.get_size());\n        if (datValue.get_data() == NULL)\n            return false;\n\n        // Unserialize value\n        try {\n            CDataStream ssValue((char*)datValue.get_data(), (char*)datValue.get_data() + datValue.get_size(), SER_DISK, CLIENT_VERSION);\n            ssValue >> value;\n        }\n        catch (std::exception &e) {\n            return false;\n        }\n\n        // Clear and free memory\n        memset(datValue.get_data(), 0, datValue.get_size());\n        free(datValue.get_data());\n        return (ret == 0);\n    }",
          "includes": [
            "#include <db_cxx.h>",
            "#include <vector>",
            "#include <string>",
            "#include <map>",
            "#include \"main.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDB {\n  bool Read(const K& key, T& value)\n      {\n          if (!pdb)\n              return false;\n  \n          // Key\n          CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n          ssKey.reserve(1000);\n          ssKey << key;\n          Dbt datKey(&ssKey[0], ssKey.size());\n  \n          // Read\n          Dbt datValue;\n          datValue.set_flags(DB_DBT_MALLOC);\n          int ret = pdb->get(activeTxn, &datKey, &datValue, 0);\n          memset(datKey.get_data(), 0, datKey.get_size());\n          if (datValue.get_data() == NULL)\n              return false;\n  \n          // Unserialize value\n          try {\n              CDataStream ssValue((char*)datValue.get_data(), (char*)datValue.get_data() + datValue.get_size(), SER_DISK, CLIENT_VERSION);\n              ssValue >> value;\n          }\n          catch (std::exception &e) {\n              return false;\n          }\n  \n          // Clear and free memory\n          memset(datValue.get_data(), 0, datValue.get_size());\n          free(datValue.get_data());\n          return (ret == 0);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"version\""
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDB {\n  bool ReadVersion(int& nVersion)\n      {\n          nVersion = 0;\n          return Read(std::string(\"version\"), nVersion);\n      }\n}"
  },
  {
    "function_name": "TxnAbort",
    "container": "CDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
    "lines": "291-298",
    "snippet": "bool TxnAbort()\n    {\n        if (!pdb || !activeTxn)\n            return false;\n        int ret = activeTxn->abort();\n        activeTxn = NULL;\n        return (ret == 0);\n    }",
    "includes": [
      "#include <db_cxx.h>",
      "#include <vector>",
      "#include <string>",
      "#include <map>",
      "#include \"main.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "activeTxn->abort",
          "args": [],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDB {\n  bool TxnAbort()\n      {\n          if (!pdb || !activeTxn)\n              return false;\n          int ret = activeTxn->abort();\n          activeTxn = NULL;\n          return (ret == 0);\n      }\n}"
  },
  {
    "function_name": "TxnCommit",
    "container": "CDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
    "lines": "282-289",
    "snippet": "bool TxnCommit()\n    {\n        if (!pdb || !activeTxn)\n            return false;\n        int ret = activeTxn->commit(0);\n        activeTxn = NULL;\n        return (ret == 0);\n    }",
    "includes": [
      "#include <db_cxx.h>",
      "#include <vector>",
      "#include <string>",
      "#include <map>",
      "#include \"main.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "activeTxn->commit",
          "args": [
            "0"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDB {\n  bool TxnCommit()\n      {\n          if (!pdb || !activeTxn)\n              return false;\n          int ret = activeTxn->commit(0);\n          activeTxn = NULL;\n          return (ret == 0);\n      }\n}"
  },
  {
    "function_name": "TxnBegin",
    "container": "CDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
    "lines": "271-280",
    "snippet": "bool TxnBegin()\n    {\n        if (!pdb || activeTxn)\n            return false;\n        DbTxn* ptxn = bitdb.TxnBegin();\n        if (!ptxn)\n            return false;\n        activeTxn = ptxn;\n        return true;\n    }",
    "includes": [
      "#include <db_cxx.h>",
      "#include <vector>",
      "#include <string>",
      "#include <map>",
      "#include \"main.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bitdb.TxnBegin",
          "args": [],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "TxnBegin",
          "container": "CDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
          "lines": "271-280",
          "snippet": "bool TxnBegin()\n    {\n        if (!pdb || activeTxn)\n            return false;\n        DbTxn* ptxn = bitdb.TxnBegin();\n        if (!ptxn)\n            return false;\n        activeTxn = ptxn;\n        return true;\n    }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDB {\n  bool TxnBegin()\n      {\n          if (!pdb || activeTxn)\n              return false;\n          DbTxn* ptxn = bitdb.TxnBegin();\n          if (!ptxn)\n              return false;\n          activeTxn = ptxn;\n          return true;\n      }\n}"
  },
  {
    "function_name": "ReadAtCursor",
    "container": "CDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
    "lines": "231-268",
    "snippet": "int ReadAtCursor(Dbc* pcursor, CDataStream& ssKey, CDataStream& ssValue, unsigned int fFlags=DB_NEXT)\n    {\n        // Read at cursor\n        Dbt datKey;\n        if (fFlags == DB_SET || fFlags == DB_SET_RANGE || fFlags == DB_GET_BOTH || fFlags == DB_GET_BOTH_RANGE)\n        {\n            datKey.set_data(&ssKey[0]);\n            datKey.set_size(ssKey.size());\n        }\n        Dbt datValue;\n        if (fFlags == DB_GET_BOTH || fFlags == DB_GET_BOTH_RANGE)\n        {\n            datValue.set_data(&ssValue[0]);\n            datValue.set_size(ssValue.size());\n        }\n        datKey.set_flags(DB_DBT_MALLOC);\n        datValue.set_flags(DB_DBT_MALLOC);\n        int ret = pcursor->get(&datKey, &datValue, fFlags);\n        if (ret != 0)\n            return ret;\n        else if (datKey.get_data() == NULL || datValue.get_data() == NULL)\n            return 99999;\n\n        // Convert to streams\n        ssKey.SetType(SER_DISK);\n        ssKey.clear();\n        ssKey.write((char*)datKey.get_data(), datKey.get_size());\n        ssValue.SetType(SER_DISK);\n        ssValue.clear();\n        ssValue.write((char*)datValue.get_data(), datValue.get_size());\n\n        // Clear and free memory\n        memset(datKey.get_data(), 0, datKey.get_size());\n        memset(datValue.get_data(), 0, datValue.get_size());\n        free(datKey.get_data());\n        free(datValue.get_data());\n        return 0;\n    }",
    "includes": [
      "#include <db_cxx.h>",
      "#include <vector>",
      "#include <string>",
      "#include <map>",
      "#include \"main.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "datValue.get_data()"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "zero_after_free_allocator",
          "container": "zero_after_free_allocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/allocators.h",
          "lines": "241-241",
          "snippet": "zero_after_free_allocator(const zero_after_free_allocator<U>& a) throw() : base(a) {}",
          "includes": [
            "#include <unistd.h> // for sysconf",
            "#include <limits.h> // for PAGESIZE",
            "#include <sys/mman.h>",
            "#include <windows.h>",
            "#include <map>",
            "#include <boost/thread/mutex.hpp>",
            "#include <string>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h> // for sysconf\n#include <limits.h> // for PAGESIZE\n#include <sys/mman.h>\n#include <windows.h>\n#include <map>\n#include <boost/thread/mutex.hpp>\n#include <string>\n#include <string.h>\n\nzero_after_free_allocator {\n  zero_after_free_allocator(const zero_after_free_allocator<U>& a) throw() : base(a) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "datValue.get_data",
          "args": [],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.get_data",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "datValue.get_data()",
            "0",
            "datValue.get_size()"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.get_size",
          "args": [],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.get_data",
          "args": [],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "datKey.get_data()",
            "0",
            "datKey.get_size()"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.get_size",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.get_data",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssValue.write",
          "args": [
            "(char*)datValue.get_data()",
            "datValue.get_size()"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "SSLIOStreamDevice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "598-603",
          "snippet": "std::streamsize write(const char* s, std::streamsize n)\n    {\n        handshake(ssl::stream_base::client); // HTTPS clients write first\n        if (fUseSSL) return asio::write(stream, asio::buffer(s, n));\n        return asio::write(stream.next_layer(), asio::buffer(s, n));\n    }",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nSSLIOStreamDevice {\n  std::streamsize write(const char* s, std::streamsize n)\n      {\n          handshake(ssl::stream_base::client); // HTTPS clients write first\n          if (fUseSSL) return asio::write(stream, asio::buffer(s, n));\n          return asio::write(stream.next_layer(), asio::buffer(s, n));\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "datValue.get_size",
          "args": [],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.get_data",
          "args": [],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssValue.clear",
          "args": [],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssValue.SetType",
          "args": [
            "SER_DISK"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "SetType",
          "container": "CAutoFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "1083-1083",
          "snippet": "void SetType(int n)          { nType = n; }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCAutoFile {\n  void SetType(int n)          { nType = n; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "datKey.get_size",
          "args": [],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.get_data",
          "args": [],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.get_data",
          "args": [],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.get_data",
          "args": [],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pcursor->get",
          "args": [
            "&datKey",
            "&datValue",
            "fFlags"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.set_flags",
          "args": [
            "DB_DBT_MALLOC"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.set_flags",
          "args": [
            "DB_DBT_MALLOC"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.set_size",
          "args": [
            "ssValue.size()"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "set_size",
          "container": "BlockHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/format.h",
          "lines": "32-32",
          "snippet": "void set_size(uint64_t size) { size_ = size; }",
          "includes": [
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <stdint.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/table_builder.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/slice.h\"\n#include <stdint.h>\n#include <string>\n\nBlockHandle {\n  void set_size(uint64_t size) { size_ = size; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssValue.size",
          "args": [],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "datValue.set_data",
          "args": [
            "&ssValue[0]"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.set_data",
          "args": [
            "&ssKey[0]"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDB {\n  int ReadAtCursor(Dbc* pcursor, CDataStream& ssKey, CDataStream& ssValue, unsigned int fFlags=DB_NEXT)\n      {\n          // Read at cursor\n          Dbt datKey;\n          if (fFlags == DB_SET || fFlags == DB_SET_RANGE || fFlags == DB_GET_BOTH || fFlags == DB_GET_BOTH_RANGE)\n          {\n              datKey.set_data(&ssKey[0]);\n              datKey.set_size(ssKey.size());\n          }\n          Dbt datValue;\n          if (fFlags == DB_GET_BOTH || fFlags == DB_GET_BOTH_RANGE)\n          {\n              datValue.set_data(&ssValue[0]);\n              datValue.set_size(ssValue.size());\n          }\n          datKey.set_flags(DB_DBT_MALLOC);\n          datValue.set_flags(DB_DBT_MALLOC);\n          int ret = pcursor->get(&datKey, &datValue, fFlags);\n          if (ret != 0)\n              return ret;\n          else if (datKey.get_data() == NULL || datValue.get_data() == NULL)\n              return 99999;\n  \n          // Convert to streams\n          ssKey.SetType(SER_DISK);\n          ssKey.clear();\n          ssKey.write((char*)datKey.get_data(), datKey.get_size());\n          ssValue.SetType(SER_DISK);\n          ssValue.clear();\n          ssValue.write((char*)datValue.get_data(), datValue.get_size());\n  \n          // Clear and free memory\n          memset(datKey.get_data(), 0, datKey.get_size());\n          memset(datValue.get_data(), 0, datValue.get_size());\n          free(datKey.get_data());\n          free(datValue.get_data());\n          return 0;\n      }\n}"
  },
  {
    "function_name": "Exists",
    "container": "CDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
    "lines": "201-218",
    "snippet": "bool Exists(const K& key)\n    {\n        if (!pdb)\n            return false;\n\n        // Key\n        CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n        ssKey.reserve(1000);\n        ssKey << key;\n        Dbt datKey(&ssKey[0], ssKey.size());\n\n        // Exists\n        int ret = pdb->exists(activeTxn, &datKey, 0);\n\n        // Clear memory\n        memset(datKey.get_data(), 0, datKey.get_size());\n        return (ret == 0);\n    }",
    "includes": [
      "#include <db_cxx.h>",
      "#include <vector>",
      "#include <string>",
      "#include <map>",
      "#include \"main.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "datKey.get_data()",
            "0",
            "datKey.get_size()"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.get_size",
          "args": [],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.get_data",
          "args": [],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pdb->exists",
          "args": [
            "activeTxn",
            "&datKey",
            "0"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssKey.size",
          "args": [],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssKey.reserve",
          "args": [
            "1000"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "805-805",
          "snippet": "void reserve(size_type n)                        { vch.reserve(n + nReadPos); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void reserve(size_type n)                        { vch.reserve(n + nReadPos); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDB {\n  bool Exists(const K& key)\n      {\n          if (!pdb)\n              return false;\n  \n          // Key\n          CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n          ssKey.reserve(1000);\n          ssKey << key;\n          Dbt datKey(&ssKey[0], ssKey.size());\n  \n          // Exists\n          int ret = pdb->exists(activeTxn, &datKey, 0);\n  \n          // Clear memory\n          memset(datKey.get_data(), 0, datKey.get_size());\n          return (ret == 0);\n      }\n}"
  },
  {
    "function_name": "Erase",
    "container": "CDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
    "lines": "179-198",
    "snippet": "bool Erase(const K& key)\n    {\n        if (!pdb)\n            return false;\n        if (fReadOnly)\n            assert(!\"Erase called on database in read-only mode\");\n\n        // Key\n        CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n        ssKey.reserve(1000);\n        ssKey << key;\n        Dbt datKey(&ssKey[0], ssKey.size());\n\n        // Erase\n        int ret = pdb->del(activeTxn, &datKey, 0);\n\n        // Clear memory\n        memset(datKey.get_data(), 0, datKey.get_size());\n        return (ret == 0 || ret == DB_NOTFOUND);\n    }",
    "includes": [
      "#include <db_cxx.h>",
      "#include <vector>",
      "#include <string>",
      "#include <map>",
      "#include \"main.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "datKey.get_data()",
            "0",
            "datKey.get_size()"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.get_size",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.get_data",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pdb->del",
          "args": [
            "activeTxn",
            "&datKey",
            "0"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssKey.size",
          "args": [],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssKey.reserve",
          "args": [
            "1000"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "805-805",
          "snippet": "void reserve(size_type n)                        { vch.reserve(n + nReadPos); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void reserve(size_type n)                        { vch.reserve(n + nReadPos); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!\"Erase called on database in read-only mode\""
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDB {\n  bool Erase(const K& key)\n      {\n          if (!pdb)\n              return false;\n          if (fReadOnly)\n              assert(!\"Erase called on database in read-only mode\");\n  \n          // Key\n          CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n          ssKey.reserve(1000);\n          ssKey << key;\n          Dbt datKey(&ssKey[0], ssKey.size());\n  \n          // Erase\n          int ret = pdb->del(activeTxn, &datKey, 0);\n  \n          // Clear memory\n          memset(datKey.get_data(), 0, datKey.get_size());\n          return (ret == 0 || ret == DB_NOTFOUND);\n      }\n}"
  },
  {
    "function_name": "Write",
    "container": "CDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
    "lines": "150-176",
    "snippet": "bool Write(const K& key, const T& value, bool fOverwrite=true)\n    {\n        if (!pdb)\n            return false;\n        if (fReadOnly)\n            assert(!\"Write called on database in read-only mode\");\n\n        // Key\n        CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n        ssKey.reserve(1000);\n        ssKey << key;\n        Dbt datKey(&ssKey[0], ssKey.size());\n\n        // Value\n        CDataStream ssValue(SER_DISK, CLIENT_VERSION);\n        ssValue.reserve(10000);\n        ssValue << value;\n        Dbt datValue(&ssValue[0], ssValue.size());\n\n        // Write\n        int ret = pdb->put(activeTxn, &datKey, &datValue, (fOverwrite ? 0 : DB_NOOVERWRITE));\n\n        // Clear memory in case it was a private key\n        memset(datKey.get_data(), 0, datKey.get_size());\n        memset(datValue.get_data(), 0, datValue.get_size());\n        return (ret == 0);\n    }",
    "includes": [
      "#include <db_cxx.h>",
      "#include <vector>",
      "#include <string>",
      "#include <map>",
      "#include \"main.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "datValue.get_data()",
            "0",
            "datValue.get_size()"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.get_size",
          "args": [],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.get_data",
          "args": [],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "datKey.get_data()",
            "0",
            "datKey.get_size()"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.get_size",
          "args": [],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.get_data",
          "args": [],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pdb->put",
          "args": [
            "activeTxn",
            "&datKey",
            "&datValue",
            "(fOverwrite ? 0 : DB_NOOVERWRITE)"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssValue.size",
          "args": [],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssValue.reserve",
          "args": [
            "10000"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "805-805",
          "snippet": "void reserve(size_type n)                        { vch.reserve(n + nReadPos); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void reserve(size_type n)                        { vch.reserve(n + nReadPos); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!\"Write called on database in read-only mode\""
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDB {\n  bool Write(const K& key, const T& value, bool fOverwrite=true)\n      {\n          if (!pdb)\n              return false;\n          if (fReadOnly)\n              assert(!\"Write called on database in read-only mode\");\n  \n          // Key\n          CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n          ssKey.reserve(1000);\n          ssKey << key;\n          Dbt datKey(&ssKey[0], ssKey.size());\n  \n          // Value\n          CDataStream ssValue(SER_DISK, CLIENT_VERSION);\n          ssValue.reserve(10000);\n          ssValue << value;\n          Dbt datValue(&ssValue[0], ssValue.size());\n  \n          // Write\n          int ret = pdb->put(activeTxn, &datKey, &datValue, (fOverwrite ? 0 : DB_NOOVERWRITE));\n  \n          // Clear memory in case it was a private key\n          memset(datKey.get_data(), 0, datKey.get_size());\n          memset(datValue.get_data(), 0, datValue.get_size());\n          return (ret == 0);\n      }\n}"
  },
  {
    "function_name": "Read",
    "container": "CDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
    "lines": "115-147",
    "snippet": "bool Read(const K& key, T& value)\n    {\n        if (!pdb)\n            return false;\n\n        // Key\n        CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n        ssKey.reserve(1000);\n        ssKey << key;\n        Dbt datKey(&ssKey[0], ssKey.size());\n\n        // Read\n        Dbt datValue;\n        datValue.set_flags(DB_DBT_MALLOC);\n        int ret = pdb->get(activeTxn, &datKey, &datValue, 0);\n        memset(datKey.get_data(), 0, datKey.get_size());\n        if (datValue.get_data() == NULL)\n            return false;\n\n        // Unserialize value\n        try {\n            CDataStream ssValue((char*)datValue.get_data(), (char*)datValue.get_data() + datValue.get_size(), SER_DISK, CLIENT_VERSION);\n            ssValue >> value;\n        }\n        catch (std::exception &e) {\n            return false;\n        }\n\n        // Clear and free memory\n        memset(datValue.get_data(), 0, datValue.get_size());\n        free(datValue.get_data());\n        return (ret == 0);\n    }",
    "includes": [
      "#include <db_cxx.h>",
      "#include <vector>",
      "#include <string>",
      "#include <map>",
      "#include \"main.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "datValue.get_data()"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "zero_after_free_allocator",
          "container": "zero_after_free_allocator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/allocators.h",
          "lines": "241-241",
          "snippet": "zero_after_free_allocator(const zero_after_free_allocator<U>& a) throw() : base(a) {}",
          "includes": [
            "#include <unistd.h> // for sysconf",
            "#include <limits.h> // for PAGESIZE",
            "#include <sys/mman.h>",
            "#include <windows.h>",
            "#include <map>",
            "#include <boost/thread/mutex.hpp>",
            "#include <string>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h> // for sysconf\n#include <limits.h> // for PAGESIZE\n#include <sys/mman.h>\n#include <windows.h>\n#include <map>\n#include <boost/thread/mutex.hpp>\n#include <string>\n#include <string.h>\n\nzero_after_free_allocator {\n  zero_after_free_allocator(const zero_after_free_allocator<U>& a) throw() : base(a) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "datValue.get_data",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "datValue.get_data()",
            "0",
            "datValue.get_size()"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.get_size",
          "args": [],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.get_data",
          "args": [],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.get_size",
          "args": [],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.get_data",
          "args": [],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.get_data",
          "args": [],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.get_data",
          "args": [],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "datKey.get_data()",
            "0",
            "datKey.get_size()"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.get_size",
          "args": [],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datKey.get_data",
          "args": [],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pdb->get",
          "args": [
            "activeTxn",
            "&datKey",
            "&datValue",
            "0"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "datValue.set_flags",
          "args": [
            "DB_DBT_MALLOC"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssKey.size",
          "args": [],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssKey.reserve",
          "args": [
            "1000"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "805-805",
          "snippet": "void reserve(size_type n)                        { vch.reserve(n + nReadPos); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void reserve(size_type n)                        { vch.reserve(n + nReadPos); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDB {\n  bool Read(const K& key, T& value)\n      {\n          if (!pdb)\n              return false;\n  \n          // Key\n          CDataStream ssKey(SER_DISK, CLIENT_VERSION);\n          ssKey.reserve(1000);\n          ssKey << key;\n          Dbt datKey(&ssKey[0], ssKey.size());\n  \n          // Read\n          Dbt datValue;\n          datValue.set_flags(DB_DBT_MALLOC);\n          int ret = pdb->get(activeTxn, &datKey, &datValue, 0);\n          memset(datKey.get_data(), 0, datKey.get_size());\n          if (datValue.get_data() == NULL)\n              return false;\n  \n          // Unserialize value\n          try {\n              CDataStream ssValue((char*)datValue.get_data(), (char*)datValue.get_data() + datValue.get_size(), SER_DISK, CLIENT_VERSION);\n              ssValue >> value;\n          }\n          catch (std::exception &e) {\n              return false;\n          }\n  \n          // Clear and free memory\n          memset(datValue.get_data(), 0, datValue.get_size());\n          free(datValue.get_data());\n          return (ret == 0);\n      }\n}"
  },
  {
    "function_name": "GetDetach",
    "container": "CDBEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
    "lines": "78-78",
    "snippet": "bool GetDetach() { return fDetachDB; }",
    "includes": [
      "#include <db_cxx.h>",
      "#include <vector>",
      "#include <string>",
      "#include <map>",
      "#include \"main.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDBEnv {\n  bool GetDetach() { return fDetachDB; }\n}"
  },
  {
    "function_name": "SetDetach",
    "container": "CDBEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
    "lines": "77-77",
    "snippet": "void SetDetach(bool fDetachDB_) { fDetachDB = fDetachDB_; }",
    "includes": [
      "#include <db_cxx.h>",
      "#include <vector>",
      "#include <string>",
      "#include <map>",
      "#include \"main.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDBEnv {\n  void SetDetach(bool fDetachDB_) { fDetachDB = fDetachDB_; }\n}"
  },
  {
    "function_name": "IsMock",
    "container": "CDBEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
    "lines": "53-53",
    "snippet": "bool IsMock() { return fMockDb; }",
    "includes": [
      "#include <db_cxx.h>",
      "#include <vector>",
      "#include <string>",
      "#include <map>",
      "#include \"main.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDBEnv {\n  bool IsMock() { return fMockDb; }\n}"
  }
]