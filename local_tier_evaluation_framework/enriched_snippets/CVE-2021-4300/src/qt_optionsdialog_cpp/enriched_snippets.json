[
  {
    "function_name": "eventFilter",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "246-258",
    "snippet": "bool OptionsDialog::eventFilter(QObject *object, QEvent *event)\n{\n    if(event->type() == QEvent::FocusOut)\n    {\n        if(object == ui->proxyIp)\n        {\n            CService addr;\n            /* Check proxyIp for a valid IPv4/IPv6 address and emit the proxyIpValid signal */\n            emit proxyIpValid(ui->proxyIp, LookupNumeric(ui->proxyIp->text().toStdString().c_str(), addr));\n        }\n    }\n    return QDialog::eventFilter(object, event);\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QDialog::eventFilter",
          "args": [
            "object",
            "event"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "eventFilter",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "246-258",
          "snippet": "bool OptionsDialog::eventFilter(QObject *object, QEvent *event)\n{\n    if(event->type() == QEvent::FocusOut)\n    {\n        if(object == ui->proxyIp)\n        {\n            CService addr;\n            /* Check proxyIp for a valid IPv4/IPv6 address and emit the proxyIpValid signal */\n            emit proxyIpValid(ui->proxyIp, LookupNumeric(ui->proxyIp->text().toStdString().c_str(), addr));\n        }\n    }\n    return QDialog::eventFilter(object, event);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "LookupNumeric",
          "args": [
            "ui->proxyIp->text().toStdString().c_str()",
            "addr"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->proxyIp->text",
          "args": [],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "event->type",
          "args": [],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  bool OptionsDialog::eventFilter(QObject *object, QEvent *event)\n  {\n      if(event->type() == QEvent::FocusOut)\n      {\n          if(object == ui->proxyIp)\n          {\n              CService addr;\n              /* Check proxyIp for a valid IPv4/IPv6 address and emit the proxyIpValid signal */\n              emit proxyIpValid(ui->proxyIp, LookupNumeric(ui->proxyIp->text().toStdString().c_str(), addr));\n          }\n      }\n      return QDialog::eventFilter(object, event);\n  }\n}"
  },
  {
    "function_name": "handleProxyIpValid",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "227-244",
    "snippet": "void OptionsDialog::handleProxyIpValid(QValidatedLineEdit *object, bool fState)\n{\n    // this is used in a check before re-enabling the save buttons\n    fProxyIpValid = fState;\n\n    if(fProxyIpValid)\n    {\n        enableSaveButtons();\n        ui->statusLabel->clear();\n    }\n    else\n    {\n        disableSaveButtons();\n        object->setValid(fProxyIpValid);\n        ui->statusLabel->setStyleSheet(\"QLabel { color: red; }\");\n        ui->statusLabel->setText(tr(\"The supplied proxy address is invalid.\"));\n    }\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->statusLabel->setText",
          "args": [
            "tr(\"The supplied proxy address is invalid.\")"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"The supplied proxy address is invalid.\""
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->statusLabel->setStyleSheet",
          "args": [
            "\"QLabel { color: red; }\""
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "object->setValid",
          "args": [
            "fProxyIpValid"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "setValid",
          "container": "QValidatedLineEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qvalidatedlineedit.cpp",
          "lines": "11-27",
          "snippet": "void QValidatedLineEdit::setValid(bool valid)\n{\n    if(valid == this->valid)\n    {\n        return;\n    }\n\n    if(valid)\n    {\n        setStyleSheet(\"\");\n    }\n    else\n    {\n        setStyleSheet(STYLE_INVALID);\n    }\n    this->valid = valid;\n}",
          "includes": [
            "#include \"guiconstants.h\"",
            "#include \"qvalidatedlineedit.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"guiconstants.h\"\n#include \"qvalidatedlineedit.h\"\n\nQValidatedLineEdit {\n  void QValidatedLineEdit::setValid(bool valid)\n  {\n      if(valid == this->valid)\n      {\n          return;\n      }\n  \n      if(valid)\n      {\n          setStyleSheet(\"\");\n      }\n      else\n      {\n          setStyleSheet(STYLE_INVALID);\n      }\n      this->valid = valid;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "disableSaveButtons",
          "args": [],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "disableSaveButtons",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "172-175",
          "snippet": "void OptionsDialog::disableSaveButtons()\n{\n    setSaveButtonState(false);\n}",
          "includes": [
            "#include <QRegExpValidator>",
            "#include <QRegExp>",
            "#include <QMessageBox>",
            "#include <QLocale>",
            "#include <QIntValidator>",
            "#include <QDir>",
            "#include \"optionsmodel.h\"",
            "#include \"netbase.h\"",
            "#include \"monitoreddatamapper.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_optionsdialog.h\"",
            "#include \"optionsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::disableSaveButtons()\n  {\n      setSaveButtonState(false);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->statusLabel->clear",
          "args": [],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "enableSaveButtons",
          "args": [],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "enableSaveButtons",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "165-170",
          "snippet": "void OptionsDialog::enableSaveButtons()\n{\n    /* prevent enabling of the save buttons when data modified, if there is an invalid proxy address present */\n    if(fProxyIpValid)\n        setSaveButtonState(true);\n}",
          "includes": [
            "#include <QRegExpValidator>",
            "#include <QRegExp>",
            "#include <QMessageBox>",
            "#include <QLocale>",
            "#include <QIntValidator>",
            "#include <QDir>",
            "#include \"optionsmodel.h\"",
            "#include \"netbase.h\"",
            "#include \"monitoreddatamapper.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_optionsdialog.h\"",
            "#include \"optionsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::enableSaveButtons()\n  {\n      /* prevent enabling of the save buttons when data modified, if there is an invalid proxy address present */\n      if(fProxyIpValid)\n          setSaveButtonState(true);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::handleProxyIpValid(QValidatedLineEdit *object, bool fState)\n  {\n      // this is used in a check before re-enabling the save buttons\n      fProxyIpValid = fState;\n  \n      if(fProxyIpValid)\n      {\n          enableSaveButtons();\n          ui->statusLabel->clear();\n      }\n      else\n      {\n          disableSaveButtons();\n          object->setValid(fProxyIpValid);\n          ui->statusLabel->setStyleSheet(\"QLabel { color: red; }\");\n          ui->statusLabel->setText(tr(\"The supplied proxy address is invalid.\"));\n      }\n  }\n}"
  },
  {
    "function_name": "updateDisplayUnit",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "218-225",
    "snippet": "void OptionsDialog::updateDisplayUnit()\n{\n    if(model)\n    {\n        /* Update transactionFee with the current unit */\n        ui->transactionFee->setDisplayUnit(model->getDisplayUnit());\n    }\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->transactionFee->setDisplayUnit",
          "args": [
            "model->getDisplayUnit()"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "setDisplayUnit",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "165-168",
          "snippet": "void BitcoinAmountField::setDisplayUnit(int newUnit)\n{\n    unit->setValue(newUnit);\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setDisplayUnit(int newUnit)\n  {\n      unit->setValue(newUnit);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getDisplayUnit",
          "args": [],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "getDisplayUnit",
          "container": "OptionsModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
          "lines": "313-316",
          "snippet": "int OptionsModel::getDisplayUnit()\n{\n    return nDisplayUnit;\n}",
          "includes": [
            "#include \"guiutil.h\"",
            "#include \"walletdb.h\"",
            "#include \"init.h\"",
            "#include <QSettings>",
            "#include \"bitcoinunits.h\"",
            "#include \"optionsmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  int OptionsModel::getDisplayUnit()\n  {\n      return nDisplayUnit;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::updateDisplayUnit()\n  {\n      if(model)\n      {\n          /* Update transactionFee with the current unit */\n          ui->transactionFee->setDisplayUnit(model->getDisplayUnit());\n      }\n  }\n}"
  },
  {
    "function_name": "showRestartWarning_Lang",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "209-216",
    "snippet": "void OptionsDialog::showRestartWarning_Lang()\n{\n    if(!fRestartWarningDisplayed_Lang)\n    {\n        QMessageBox::warning(this, tr(\"Warning\"), tr(\"This setting will take effect after restarting Halcyon.\"), QMessageBox::Ok);\n        fRestartWarningDisplayed_Lang = true;\n    }\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QMessageBox::warning",
          "args": [
            "this",
            "tr(\"Warning\")",
            "tr(\"This setting will take effect after restarting Halcyon.\")",
            "QMessageBox::Ok"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"This setting will take effect after restarting Halcyon.\""
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::showRestartWarning_Lang()\n  {\n      if(!fRestartWarningDisplayed_Lang)\n      {\n          QMessageBox::warning(this, tr(\"Warning\"), tr(\"This setting will take effect after restarting Halcyon.\"), QMessageBox::Ok);\n          fRestartWarningDisplayed_Lang = true;\n      }\n  }\n}"
  },
  {
    "function_name": "showRestartWarning_Proxy",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "200-207",
    "snippet": "void OptionsDialog::showRestartWarning_Proxy()\n{\n    if(!fRestartWarningDisplayed_Proxy)\n    {\n        QMessageBox::warning(this, tr(\"Warning\"), tr(\"This setting will take effect after restarting Halcyon.\"), QMessageBox::Ok);\n        fRestartWarningDisplayed_Proxy = true;\n    }\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QMessageBox::warning",
          "args": [
            "this",
            "tr(\"Warning\")",
            "tr(\"This setting will take effect after restarting Halcyon.\")",
            "QMessageBox::Ok"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"This setting will take effect after restarting Halcyon.\""
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::showRestartWarning_Proxy()\n  {\n      if(!fRestartWarningDisplayed_Proxy)\n      {\n          QMessageBox::warning(this, tr(\"Warning\"), tr(\"This setting will take effect after restarting Halcyon.\"), QMessageBox::Ok);\n          fRestartWarningDisplayed_Proxy = true;\n      }\n  }\n}"
  },
  {
    "function_name": "on_applyButton_clicked",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "194-198",
    "snippet": "void OptionsDialog::on_applyButton_clicked()\n{\n    mapper->submit();\n    disableApplyButton();\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "disableApplyButton",
          "args": [],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "disableApplyButton",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "160-163",
          "snippet": "void OptionsDialog::disableApplyButton()\n{\n    ui->applyButton->setEnabled(false);\n}",
          "includes": [
            "#include <QRegExpValidator>",
            "#include <QRegExp>",
            "#include <QMessageBox>",
            "#include <QLocale>",
            "#include <QIntValidator>",
            "#include <QDir>",
            "#include \"optionsmodel.h\"",
            "#include \"netbase.h\"",
            "#include \"monitoreddatamapper.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_optionsdialog.h\"",
            "#include \"optionsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::disableApplyButton()\n  {\n      ui->applyButton->setEnabled(false);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapper->submit",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::on_applyButton_clicked()\n  {\n      mapper->submit();\n      disableApplyButton();\n  }\n}"
  },
  {
    "function_name": "on_cancelButton_clicked",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "189-192",
    "snippet": "void OptionsDialog::on_cancelButton_clicked()\n{\n    reject();\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reject",
          "args": [],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "reject",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "242-245",
          "snippet": "void SendCoinsDialog::reject()\n{\n    clear();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::reject()\n  {\n      clear();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::on_cancelButton_clicked()\n  {\n      reject();\n  }\n}"
  },
  {
    "function_name": "on_okButton_clicked",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "183-187",
    "snippet": "void OptionsDialog::on_okButton_clicked()\n{\n    mapper->submit();\n    accept();\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "accept",
          "args": [],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "accept",
          "container": "EditAddressDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
          "lines": "85-125",
          "snippet": "void EditAddressDialog::accept()\n{\n    if(!model)\n        return;\n\n    if(!saveCurrentRow())\n    {\n        switch(model->getEditStatus())\n        {\n        case AddressTableModel::OK:\n            // Failed with unknown reason. Just reject.\n            break;\n        case AddressTableModel::NO_CHANGES:\n            // No changes were made during edit operation. Just reject.\n            break;\n        case AddressTableModel::INVALID_ADDRESS:\n            QMessageBox::warning(this, windowTitle(),\n                tr(\"The entered address \\\"%1\\\" is not a valid Halcyon address.\").arg(ui->addressEdit->text()),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n        case AddressTableModel::DUPLICATE_ADDRESS:\n            QMessageBox::warning(this, windowTitle(),\n                tr(\"The entered address \\\"%1\\\" is already in the address book.\").arg(ui->addressEdit->text()),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n        case AddressTableModel::WALLET_UNLOCK_FAILURE:\n            QMessageBox::critical(this, windowTitle(),\n                tr(\"Could not unlock wallet.\"),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n        case AddressTableModel::KEY_GENERATION_FAILURE:\n            QMessageBox::critical(this, windowTitle(),\n                tr(\"New key generation failed.\"),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n\n        }\n        return;\n    }\n    QDialog::accept();\n}",
          "includes": [
            "#include <QMessageBox>",
            "#include <QDataWidgetMapper>",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_editaddressdialog.h\"",
            "#include \"editaddressdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  void EditAddressDialog::accept()\n  {\n      if(!model)\n          return;\n  \n      if(!saveCurrentRow())\n      {\n          switch(model->getEditStatus())\n          {\n          case AddressTableModel::OK:\n              // Failed with unknown reason. Just reject.\n              break;\n          case AddressTableModel::NO_CHANGES:\n              // No changes were made during edit operation. Just reject.\n              break;\n          case AddressTableModel::INVALID_ADDRESS:\n              QMessageBox::warning(this, windowTitle(),\n                  tr(\"The entered address \\\"%1\\\" is not a valid Halcyon address.\").arg(ui->addressEdit->text()),\n                  QMessageBox::Ok, QMessageBox::Ok);\n              break;\n          case AddressTableModel::DUPLICATE_ADDRESS:\n              QMessageBox::warning(this, windowTitle(),\n                  tr(\"The entered address \\\"%1\\\" is already in the address book.\").arg(ui->addressEdit->text()),\n                  QMessageBox::Ok, QMessageBox::Ok);\n              break;\n          case AddressTableModel::WALLET_UNLOCK_FAILURE:\n              QMessageBox::critical(this, windowTitle(),\n                  tr(\"Could not unlock wallet.\"),\n                  QMessageBox::Ok, QMessageBox::Ok);\n              break;\n          case AddressTableModel::KEY_GENERATION_FAILURE:\n              QMessageBox::critical(this, windowTitle(),\n                  tr(\"New key generation failed.\"),\n                  QMessageBox::Ok, QMessageBox::Ok);\n              break;\n  \n          }\n          return;\n      }\n      QDialog::accept();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapper->submit",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::on_okButton_clicked()\n  {\n      mapper->submit();\n      accept();\n  }\n}"
  },
  {
    "function_name": "setSaveButtonState",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "177-181",
    "snippet": "void OptionsDialog::setSaveButtonState(bool fState)\n{\n    ui->applyButton->setEnabled(fState);\n    ui->okButton->setEnabled(fState);\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->okButton->setEnabled",
          "args": [
            "fState"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->applyButton->setEnabled",
          "args": [
            "fState"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::setSaveButtonState(bool fState)\n  {\n      ui->applyButton->setEnabled(fState);\n      ui->okButton->setEnabled(fState);\n  }\n}"
  },
  {
    "function_name": "disableSaveButtons",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "172-175",
    "snippet": "void OptionsDialog::disableSaveButtons()\n{\n    setSaveButtonState(false);\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setSaveButtonState",
          "args": [
            "false"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "setSaveButtonState",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "177-181",
          "snippet": "void OptionsDialog::setSaveButtonState(bool fState)\n{\n    ui->applyButton->setEnabled(fState);\n    ui->okButton->setEnabled(fState);\n}",
          "includes": [
            "#include <QRegExpValidator>",
            "#include <QRegExp>",
            "#include <QMessageBox>",
            "#include <QLocale>",
            "#include <QIntValidator>",
            "#include <QDir>",
            "#include \"optionsmodel.h\"",
            "#include \"netbase.h\"",
            "#include \"monitoreddatamapper.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_optionsdialog.h\"",
            "#include \"optionsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::setSaveButtonState(bool fState)\n  {\n      ui->applyButton->setEnabled(fState);\n      ui->okButton->setEnabled(fState);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::disableSaveButtons()\n  {\n      setSaveButtonState(false);\n  }\n}"
  },
  {
    "function_name": "enableSaveButtons",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "165-170",
    "snippet": "void OptionsDialog::enableSaveButtons()\n{\n    /* prevent enabling of the save buttons when data modified, if there is an invalid proxy address present */\n    if(fProxyIpValid)\n        setSaveButtonState(true);\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setSaveButtonState",
          "args": [
            "true"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "setSaveButtonState",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "177-181",
          "snippet": "void OptionsDialog::setSaveButtonState(bool fState)\n{\n    ui->applyButton->setEnabled(fState);\n    ui->okButton->setEnabled(fState);\n}",
          "includes": [
            "#include <QRegExpValidator>",
            "#include <QRegExp>",
            "#include <QMessageBox>",
            "#include <QLocale>",
            "#include <QIntValidator>",
            "#include <QDir>",
            "#include \"optionsmodel.h\"",
            "#include \"netbase.h\"",
            "#include \"monitoreddatamapper.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_optionsdialog.h\"",
            "#include \"optionsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::setSaveButtonState(bool fState)\n  {\n      ui->applyButton->setEnabled(fState);\n      ui->okButton->setEnabled(fState);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::enableSaveButtons()\n  {\n      /* prevent enabling of the save buttons when data modified, if there is an invalid proxy address present */\n      if(fProxyIpValid)\n          setSaveButtonState(true);\n  }\n}"
  },
  {
    "function_name": "disableApplyButton",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "160-163",
    "snippet": "void OptionsDialog::disableApplyButton()\n{\n    ui->applyButton->setEnabled(false);\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->applyButton->setEnabled",
          "args": [
            "false"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::disableApplyButton()\n  {\n      ui->applyButton->setEnabled(false);\n  }\n}"
  },
  {
    "function_name": "enableApplyButton",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "155-158",
    "snippet": "void OptionsDialog::enableApplyButton()\n{\n    ui->applyButton->setEnabled(true);\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->applyButton->setEnabled",
          "args": [
            "true"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::enableApplyButton()\n  {\n      ui->applyButton->setEnabled(true);\n  }\n}"
  },
  {
    "function_name": "setMapper",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "126-153",
    "snippet": "void OptionsDialog::setMapper()\n{\n    /* Main */\n    mapper->addMapping(ui->transactionFee, OptionsModel::Fee);\n    mapper->addMapping(ui->reserveBalance, OptionsModel::ReserveBalance);\n    mapper->addMapping(ui->bitcoinAtStartup, OptionsModel::StartAtStartup);\n    mapper->addMapping(ui->detachDatabases, OptionsModel::DetachDatabases);\n\n    /* Network */\n    mapper->addMapping(ui->mapPortUpnp, OptionsModel::MapPortUPnP);\n\n    mapper->addMapping(ui->connectSocks, OptionsModel::ProxyUse);\n    mapper->addMapping(ui->proxyIp, OptionsModel::ProxyIP);\n    mapper->addMapping(ui->proxyPort, OptionsModel::ProxyPort);\n    mapper->addMapping(ui->socksVersion, OptionsModel::ProxySocksVersion);\n\n    /* Window */\n#ifndef Q_OS_MAC\n    mapper->addMapping(ui->minimizeToTray, OptionsModel::MinimizeToTray);\n    mapper->addMapping(ui->minimizeOnClose, OptionsModel::MinimizeOnClose);\n#endif\n\n    /* Display */\n    mapper->addMapping(ui->lang, OptionsModel::Language);\n    mapper->addMapping(ui->unit, OptionsModel::DisplayUnit);\n    mapper->addMapping(ui->displayAddresses, OptionsModel::DisplayAddresses);\n    mapper->addMapping(ui->coinControlFeatures, OptionsModel::CoinControlFeatures);\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mapper->addMapping",
          "args": [
            "ui->coinControlFeatures",
            "OptionsModel::CoinControlFeatures"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "addMapping",
          "container": "MonitoredDataMapper",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/monitoreddatamapper.cpp",
          "lines": "13-17",
          "snippet": "void MonitoredDataMapper::addMapping(QWidget *widget, int section)\n{\n    QDataWidgetMapper::addMapping(widget, section);\n    addChangeMonitor(widget);\n}",
          "includes": [
            "#include <QMetaProperty>",
            "#include <QMetaObject>",
            "#include <QWidget>",
            "#include \"monitoreddatamapper.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QMetaProperty>\n#include <QMetaObject>\n#include <QWidget>\n#include \"monitoreddatamapper.h\"\n\nMonitoredDataMapper {\n  void MonitoredDataMapper::addMapping(QWidget *widget, int section)\n  {\n      QDataWidgetMapper::addMapping(widget, section);\n      addChangeMonitor(widget);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::setMapper()\n  {\n      /* Main */\n      mapper->addMapping(ui->transactionFee, OptionsModel::Fee);\n      mapper->addMapping(ui->reserveBalance, OptionsModel::ReserveBalance);\n      mapper->addMapping(ui->bitcoinAtStartup, OptionsModel::StartAtStartup);\n      mapper->addMapping(ui->detachDatabases, OptionsModel::DetachDatabases);\n  \n      /* Network */\n      mapper->addMapping(ui->mapPortUpnp, OptionsModel::MapPortUPnP);\n  \n      mapper->addMapping(ui->connectSocks, OptionsModel::ProxyUse);\n      mapper->addMapping(ui->proxyIp, OptionsModel::ProxyIP);\n      mapper->addMapping(ui->proxyPort, OptionsModel::ProxyPort);\n      mapper->addMapping(ui->socksVersion, OptionsModel::ProxySocksVersion);\n  \n      /* Window */\n  #ifndef Q_OS_MAC\n      mapper->addMapping(ui->minimizeToTray, OptionsModel::MinimizeToTray);\n      mapper->addMapping(ui->minimizeOnClose, OptionsModel::MinimizeOnClose);\n  #endif\n  \n      /* Display */\n      mapper->addMapping(ui->lang, OptionsModel::Language);\n      mapper->addMapping(ui->unit, OptionsModel::DisplayUnit);\n      mapper->addMapping(ui->displayAddresses, OptionsModel::DisplayAddresses);\n      mapper->addMapping(ui->coinControlFeatures, OptionsModel::CoinControlFeatures);\n  }\n}"
  },
  {
    "function_name": "setModel",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "103-124",
    "snippet": "void OptionsDialog::setModel(OptionsModel *model)\n{\n    this->model = model;\n\n    if(model)\n    {\n        connect(model, SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n\n        mapper->setModel(model);\n        setMapper();\n        mapper->toFirst();\n    }\n\n    /* update the display unit, to not use the default (\"BTC\") */\n    updateDisplayUnit();\n\n    /* warn only when language selection changes by user action (placed here so init via mapper doesn't trigger this) */\n    connect(ui->lang, SIGNAL(valueChanged()), this, SLOT(showRestartWarning_Lang()));\n\n    /* disable apply button after settings are loaded as there is nothing to save */\n    disableApplyButton();\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "disableApplyButton",
          "args": [],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "disableApplyButton",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "160-163",
          "snippet": "void OptionsDialog::disableApplyButton()\n{\n    ui->applyButton->setEnabled(false);\n}",
          "includes": [
            "#include <QRegExpValidator>",
            "#include <QRegExp>",
            "#include <QMessageBox>",
            "#include <QLocale>",
            "#include <QIntValidator>",
            "#include <QDir>",
            "#include \"optionsmodel.h\"",
            "#include \"netbase.h\"",
            "#include \"monitoreddatamapper.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_optionsdialog.h\"",
            "#include \"optionsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::disableApplyButton()\n  {\n      ui->applyButton->setEnabled(false);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->lang",
            "SIGNAL(valueChanged())",
            "this",
            "SLOT(showRestartWarning_Lang())"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "showRestartWarning_Lang()"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "showRestartWarning_Lang",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "showRestartWarning_Lang",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "209-216",
          "snippet": "void OptionsDialog::showRestartWarning_Lang()\n{\n    if(!fRestartWarningDisplayed_Lang)\n    {\n        QMessageBox::warning(this, tr(\"Warning\"), tr(\"This setting will take effect after restarting Halcyon.\"), QMessageBox::Ok);\n        fRestartWarningDisplayed_Lang = true;\n    }\n}",
          "includes": [
            "#include <QRegExpValidator>",
            "#include <QRegExp>",
            "#include <QMessageBox>",
            "#include <QLocale>",
            "#include <QIntValidator>",
            "#include <QDir>",
            "#include \"optionsmodel.h\"",
            "#include \"netbase.h\"",
            "#include \"monitoreddatamapper.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_optionsdialog.h\"",
            "#include \"optionsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::showRestartWarning_Lang()\n  {\n      if(!fRestartWarningDisplayed_Lang)\n      {\n          QMessageBox::warning(this, tr(\"Warning\"), tr(\"This setting will take effect after restarting Halcyon.\"), QMessageBox::Ok);\n          fRestartWarningDisplayed_Lang = true;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "valueChanged()"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "valueChanged",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "updateDisplayUnit",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "updateDisplayUnit",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "218-225",
          "snippet": "void OptionsDialog::updateDisplayUnit()\n{\n    if(model)\n    {\n        /* Update transactionFee with the current unit */\n        ui->transactionFee->setDisplayUnit(model->getDisplayUnit());\n    }\n}",
          "includes": [
            "#include <QRegExpValidator>",
            "#include <QRegExp>",
            "#include <QMessageBox>",
            "#include <QLocale>",
            "#include <QIntValidator>",
            "#include <QDir>",
            "#include \"optionsmodel.h\"",
            "#include \"netbase.h\"",
            "#include \"monitoreddatamapper.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_optionsdialog.h\"",
            "#include \"optionsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::updateDisplayUnit()\n  {\n      if(model)\n      {\n          /* Update transactionFee with the current unit */\n          ui->transactionFee->setDisplayUnit(model->getDisplayUnit());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapper->toFirst",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setMapper",
          "args": [],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "setMapper",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "126-153",
          "snippet": "void OptionsDialog::setMapper()\n{\n    /* Main */\n    mapper->addMapping(ui->transactionFee, OptionsModel::Fee);\n    mapper->addMapping(ui->reserveBalance, OptionsModel::ReserveBalance);\n    mapper->addMapping(ui->bitcoinAtStartup, OptionsModel::StartAtStartup);\n    mapper->addMapping(ui->detachDatabases, OptionsModel::DetachDatabases);\n\n    /* Network */\n    mapper->addMapping(ui->mapPortUpnp, OptionsModel::MapPortUPnP);\n\n    mapper->addMapping(ui->connectSocks, OptionsModel::ProxyUse);\n    mapper->addMapping(ui->proxyIp, OptionsModel::ProxyIP);\n    mapper->addMapping(ui->proxyPort, OptionsModel::ProxyPort);\n    mapper->addMapping(ui->socksVersion, OptionsModel::ProxySocksVersion);\n\n    /* Window */\n#ifndef Q_OS_MAC\n    mapper->addMapping(ui->minimizeToTray, OptionsModel::MinimizeToTray);\n    mapper->addMapping(ui->minimizeOnClose, OptionsModel::MinimizeOnClose);\n#endif\n\n    /* Display */\n    mapper->addMapping(ui->lang, OptionsModel::Language);\n    mapper->addMapping(ui->unit, OptionsModel::DisplayUnit);\n    mapper->addMapping(ui->displayAddresses, OptionsModel::DisplayAddresses);\n    mapper->addMapping(ui->coinControlFeatures, OptionsModel::CoinControlFeatures);\n}",
          "includes": [
            "#include <QRegExpValidator>",
            "#include <QRegExp>",
            "#include <QMessageBox>",
            "#include <QLocale>",
            "#include <QIntValidator>",
            "#include <QDir>",
            "#include \"optionsmodel.h\"",
            "#include \"netbase.h\"",
            "#include \"monitoreddatamapper.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_optionsdialog.h\"",
            "#include \"optionsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::setMapper()\n  {\n      /* Main */\n      mapper->addMapping(ui->transactionFee, OptionsModel::Fee);\n      mapper->addMapping(ui->reserveBalance, OptionsModel::ReserveBalance);\n      mapper->addMapping(ui->bitcoinAtStartup, OptionsModel::StartAtStartup);\n      mapper->addMapping(ui->detachDatabases, OptionsModel::DetachDatabases);\n  \n      /* Network */\n      mapper->addMapping(ui->mapPortUpnp, OptionsModel::MapPortUPnP);\n  \n      mapper->addMapping(ui->connectSocks, OptionsModel::ProxyUse);\n      mapper->addMapping(ui->proxyIp, OptionsModel::ProxyIP);\n      mapper->addMapping(ui->proxyPort, OptionsModel::ProxyPort);\n      mapper->addMapping(ui->socksVersion, OptionsModel::ProxySocksVersion);\n  \n      /* Window */\n  #ifndef Q_OS_MAC\n      mapper->addMapping(ui->minimizeToTray, OptionsModel::MinimizeToTray);\n      mapper->addMapping(ui->minimizeOnClose, OptionsModel::MinimizeOnClose);\n  #endif\n  \n      /* Display */\n      mapper->addMapping(ui->lang, OptionsModel::Language);\n      mapper->addMapping(ui->unit, OptionsModel::DisplayUnit);\n      mapper->addMapping(ui->displayAddresses, OptionsModel::DisplayAddresses);\n      mapper->addMapping(ui->coinControlFeatures, OptionsModel::CoinControlFeatures);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapper->setModel",
          "args": [
            "model"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "103-124",
          "snippet": "void OptionsDialog::setModel(OptionsModel *model)\n{\n    this->model = model;\n\n    if(model)\n    {\n        connect(model, SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n\n        mapper->setModel(model);\n        setMapper();\n        mapper->toFirst();\n    }\n\n    /* update the display unit, to not use the default (\"BTC\") */\n    updateDisplayUnit();\n\n    /* warn only when language selection changes by user action (placed here so init via mapper doesn't trigger this) */\n    connect(ui->lang, SIGNAL(valueChanged()), this, SLOT(showRestartWarning_Lang()));\n\n    /* disable apply button after settings are loaded as there is nothing to save */\n    disableApplyButton();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::setModel(OptionsModel *model)\n  {\n      this->model = model;\n  \n      if(model)\n      {\n          connect(model, SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n  \n          mapper->setModel(model);\n          setMapper();\n          mapper->toFirst();\n      }\n  \n      /* update the display unit, to not use the default (\"BTC\") */\n      updateDisplayUnit();\n  \n      /* warn only when language selection changes by user action (placed here so init via mapper doesn't trigger this) */\n      connect(ui->lang, SIGNAL(valueChanged()), this, SLOT(showRestartWarning_Lang()));\n  \n      /* disable apply button after settings are loaded as there is nothing to save */\n      disableApplyButton();\n  }\n}"
  },
  {
    "function_name": "~OptionsDialog",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "98-101",
    "snippet": "OptionsDialog::~OptionsDialog()\n{\n    delete ui;\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  OptionsDialog::~OptionsDialog()\n  {\n      delete ui;\n  }\n}"
  },
  {
    "function_name": "OptionsDialog",
    "container": "OptionsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
    "lines": "16-96",
    "snippet": "OptionsDialog::OptionsDialog(QWidget *parent) :\n    QDialog(parent),\n    ui(new Ui::OptionsDialog),\n    model(0),\n    mapper(0),\n    fRestartWarningDisplayed_Proxy(false),\n    fRestartWarningDisplayed_Lang(false),\n    fProxyIpValid(true)\n{\n    ui->setupUi(this);\n\n    /* Network elements init */\n#ifndef USE_UPNP\n    ui->mapPortUpnp->setEnabled(false);\n#endif\n\n    ui->proxyIp->setEnabled(false);\n    ui->proxyPort->setEnabled(false);\n    ui->proxyPort->setValidator(new QIntValidator(1, 65535, this));\n\n    ui->socksVersion->setEnabled(false);\n    ui->socksVersion->addItem(\"5\", 5);\n    ui->socksVersion->addItem(\"4\", 4);\n    ui->socksVersion->setCurrentIndex(0);\n\n    connect(ui->connectSocks, SIGNAL(toggled(bool)), ui->proxyIp, SLOT(setEnabled(bool)));\n    connect(ui->connectSocks, SIGNAL(toggled(bool)), ui->proxyPort, SLOT(setEnabled(bool)));\n    connect(ui->connectSocks, SIGNAL(toggled(bool)), ui->socksVersion, SLOT(setEnabled(bool)));\n    connect(ui->connectSocks, SIGNAL(clicked(bool)), this, SLOT(showRestartWarning_Proxy()));\n\n    ui->proxyIp->installEventFilter(this);\n\n    /* Window elements init */\n#ifdef Q_OS_MAC\n    ui->tabWindow->setVisible(false);\n#endif\n\n    /* Display elements init */\n    QDir translations(\":translations\");\n    ui->lang->addItem(QString(\"(\") + tr(\"default\") + QString(\")\"), QVariant(\"\"));\n    foreach(const QString &langStr, translations.entryList())\n    {\n        QLocale locale(langStr);\n\n        /** check if the locale name consists of 2 parts (language_country) */\n        if(langStr.contains(\"_\"))\n        {\n#if QT_VERSION >= 0x040800\n            /** display language strings as \"native language - native country (locale name)\", e.g. \"Deutsch - Deutschland (de)\" */\n            ui->lang->addItem(locale.nativeLanguageName() + QString(\" - \") + locale.nativeCountryName() + QString(\" (\") + langStr + QString(\")\"), QVariant(langStr));\n#else\n            /** display language strings as \"language - country (locale name)\", e.g. \"German - Germany (de)\" */\n            ui->lang->addItem(QLocale::languageToString(locale.language()) + QString(\" - \") + QLocale::countryToString(locale.country()) + QString(\" (\") + langStr + QString(\")\"), QVariant(langStr));\n#endif\n        }\n        else\n        {\n#if QT_VERSION >= 0x040800\n            /** display language strings as \"native language (locale name)\", e.g. \"Deutsch (de)\" */\n            ui->lang->addItem(locale.nativeLanguageName() + QString(\" (\") + langStr + QString(\")\"), QVariant(langStr));\n#else\n            /** display language strings as \"language (locale name)\", e.g. \"German (de)\" */\n            ui->lang->addItem(QLocale::languageToString(locale.language()) + QString(\" (\") + langStr + QString(\")\"), QVariant(langStr));\n#endif\n        }\n    }\n\n    ui->unit->setModel(new BitcoinUnits(this));\n\n    /* Widget-to-option mapper */\n    mapper = new MonitoredDataMapper(this);\n    mapper->setSubmitPolicy(QDataWidgetMapper::ManualSubmit);\n    mapper->setOrientation(Qt::Vertical);\n\n    /* enable apply button when data modified */\n    connect(mapper, SIGNAL(viewModified()), this, SLOT(enableApplyButton()));\n    /* disable apply button when new data loaded */\n    connect(mapper, SIGNAL(currentIndexChanged(int)), this, SLOT(disableApplyButton()));\n    /* setup/change UI elements when proxy IP is invalid/valid */\n    connect(this, SIGNAL(proxyIpValid(QValidatedLineEdit *, bool)), this, SLOT(handleProxyIpValid(QValidatedLineEdit *, bool)));\n}",
    "includes": [
      "#include <QRegExpValidator>",
      "#include <QRegExp>",
      "#include <QMessageBox>",
      "#include <QLocale>",
      "#include <QIntValidator>",
      "#include <QDir>",
      "#include \"optionsmodel.h\"",
      "#include \"netbase.h\"",
      "#include \"monitoreddatamapper.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"ui_optionsdialog.h\"",
      "#include \"optionsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "mapper",
            "SIGNAL(viewModified())",
            "this",
            "SLOT(enableApplyButton())"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "enableApplyButton()"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enableApplyButton",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "enableApplyButton",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "155-158",
          "snippet": "void OptionsDialog::enableApplyButton()\n{\n    ui->applyButton->setEnabled(true);\n}",
          "includes": [
            "#include <QRegExpValidator>",
            "#include <QRegExp>",
            "#include <QMessageBox>",
            "#include <QLocale>",
            "#include <QIntValidator>",
            "#include <QDir>",
            "#include \"optionsmodel.h\"",
            "#include \"netbase.h\"",
            "#include \"monitoreddatamapper.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_optionsdialog.h\"",
            "#include \"optionsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::enableApplyButton()\n  {\n      ui->applyButton->setEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "viewModified()"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewModified",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapper->setOrientation",
          "args": [
            "Qt::Vertical"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapper->setSubmitPolicy",
          "args": [
            "QDataWidgetMapper::ManualSubmit"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->unit->setModel",
          "args": [
            "new BitcoinUnits(this)"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "103-124",
          "snippet": "void OptionsDialog::setModel(OptionsModel *model)\n{\n    this->model = model;\n\n    if(model)\n    {\n        connect(model, SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n\n        mapper->setModel(model);\n        setMapper();\n        mapper->toFirst();\n    }\n\n    /* update the display unit, to not use the default (\"BTC\") */\n    updateDisplayUnit();\n\n    /* warn only when language selection changes by user action (placed here so init via mapper doesn't trigger this) */\n    connect(ui->lang, SIGNAL(valueChanged()), this, SLOT(showRestartWarning_Lang()));\n\n    /* disable apply button after settings are loaded as there is nothing to save */\n    disableApplyButton();\n}",
          "includes": [
            "#include <QRegExpValidator>",
            "#include <QRegExp>",
            "#include <QMessageBox>",
            "#include <QLocale>",
            "#include <QIntValidator>",
            "#include <QDir>",
            "#include \"optionsmodel.h\"",
            "#include \"netbase.h\"",
            "#include \"monitoreddatamapper.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_optionsdialog.h\"",
            "#include \"optionsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::setModel(OptionsModel *model)\n  {\n      this->model = model;\n  \n      if(model)\n      {\n          connect(model, SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n  \n          mapper->setModel(model);\n          setMapper();\n          mapper->toFirst();\n      }\n  \n      /* update the display unit, to not use the default (\"BTC\") */\n      updateDisplayUnit();\n  \n      /* warn only when language selection changes by user action (placed here so init via mapper doesn't trigger this) */\n      connect(ui->lang, SIGNAL(valueChanged()), this, SLOT(showRestartWarning_Lang()));\n  \n      /* disable apply button after settings are loaded as there is nothing to save */\n      disableApplyButton();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->lang->addItem",
          "args": [
            "QLocale::languageToString(locale.language()) + QString(\" (\") + langStr + QString(\")\")",
            "QVariant(langStr)"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "langStr"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\")\""
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" (\""
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLocale::languageToString",
          "args": [
            "locale.language()"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locale.language",
          "args": [],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lang->addItem",
          "args": [
            "locale.nativeLanguageName() + QString(\" (\") + langStr + QString(\")\")",
            "QVariant(langStr)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "langStr"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\")\""
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" (\""
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locale.nativeLanguageName",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lang->addItem",
          "args": [
            "QLocale::languageToString(locale.language()) + QString(\" - \") + QLocale::countryToString(locale.country()) + QString(\" (\") + langStr + QString(\")\")",
            "QVariant(langStr)"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "langStr"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\")\""
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" (\""
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLocale::countryToString",
          "args": [
            "locale.country()"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locale.country",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" - \""
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLocale::languageToString",
          "args": [
            "locale.language()"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locale.language",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lang->addItem",
          "args": [
            "locale.nativeLanguageName() + QString(\" - \") + locale.nativeCountryName() + QString(\" (\") + langStr + QString(\")\")",
            "QVariant(langStr)"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "langStr"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\")\""
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" (\""
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locale.nativeCountryName",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" - \""
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locale.nativeLanguageName",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "langStr.contains",
          "args": [
            "\"_\""
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "contains",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "91-95",
          "snippet": "bool CBloomFilter::contains(const uint256& hash) const\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    return contains(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  bool CBloomFilter::contains(const uint256& hash) const\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      return contains(data);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->lang->addItem",
          "args": [
            "QString(\"(\") + tr(\"default\") + QString(\")\")",
            "QVariant(\"\")"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "\"\""
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\")\""
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"default\""
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"(\""
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tabWindow->setVisible",
          "args": [
            "false"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->proxyIp->installEventFilter",
          "args": [
            "this"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->connectSocks",
            "SIGNAL(clicked(bool))",
            "this",
            "SLOT(showRestartWarning_Proxy())"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "showRestartWarning_Proxy()"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "showRestartWarning_Proxy",
          "args": [],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "showRestartWarning_Proxy",
          "container": "OptionsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsdialog.cpp",
          "lines": "200-207",
          "snippet": "void OptionsDialog::showRestartWarning_Proxy()\n{\n    if(!fRestartWarningDisplayed_Proxy)\n    {\n        QMessageBox::warning(this, tr(\"Warning\"), tr(\"This setting will take effect after restarting Halcyon.\"), QMessageBox::Ok);\n        fRestartWarningDisplayed_Proxy = true;\n    }\n}",
          "includes": [
            "#include <QRegExpValidator>",
            "#include <QRegExp>",
            "#include <QMessageBox>",
            "#include <QLocale>",
            "#include <QIntValidator>",
            "#include <QDir>",
            "#include \"optionsmodel.h\"",
            "#include \"netbase.h\"",
            "#include \"monitoreddatamapper.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_optionsdialog.h\"",
            "#include \"optionsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  void OptionsDialog::showRestartWarning_Proxy()\n  {\n      if(!fRestartWarningDisplayed_Proxy)\n      {\n          QMessageBox::warning(this, tr(\"Warning\"), tr(\"This setting will take effect after restarting Halcyon.\"), QMessageBox::Ok);\n          fRestartWarningDisplayed_Proxy = true;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "clicked(bool)"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clicked",
          "args": [
            "bool"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->connectSocks",
            "SIGNAL(toggled(bool))",
            "ui->socksVersion",
            "SLOT(setEnabled(bool))"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "setEnabled(bool)"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setEnabled",
          "args": [
            "bool"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "toggled(bool)"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toggled",
          "args": [
            "bool"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "on_chkReqPayment_toggled",
          "container": "QRCodeDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
          "lines": "155-162",
          "snippet": "void QRCodeDialog::on_chkReqPayment_toggled(bool fChecked)\n{\n    if (!fChecked)\n        // if chkReqPayment is not active, don't display lnReqAmount as invalid\n        ui->lnReqAmount->setValid(true);\n\n    genCode();\n}",
          "includes": [
            "#include <qrencode.h>",
            "#include <QUrl>",
            "#include <QPixmap>",
            "#include \"optionsmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_qrcodedialog.h\"",
            "#include \"qrcodedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::on_chkReqPayment_toggled(bool fChecked)\n  {\n      if (!fChecked)\n          // if chkReqPayment is not active, don't display lnReqAmount as invalid\n          ui->lnReqAmount->setValid(true);\n  \n      genCode();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->connectSocks",
            "SIGNAL(toggled(bool))",
            "ui->proxyPort",
            "SLOT(setEnabled(bool))"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "setEnabled(bool)"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setEnabled",
          "args": [
            "bool"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "toggled(bool)"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->connectSocks",
            "SIGNAL(toggled(bool))",
            "ui->proxyIp",
            "SLOT(setEnabled(bool))"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "setEnabled(bool)"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setEnabled",
          "args": [
            "bool"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "toggled(bool)"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->socksVersion->setCurrentIndex",
          "args": [
            "0"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->socksVersion->addItem",
          "args": [
            "\"4\"",
            "4"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->socksVersion->addItem",
          "args": [
            "\"5\"",
            "5"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->socksVersion->setEnabled",
          "args": [
            "false"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->proxyPort->setValidator",
          "args": [
            "new QIntValidator(1, 65535, this)"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->proxyPort->setEnabled",
          "args": [
            "false"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->proxyIp->setEnabled",
          "args": [
            "false"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->mapPortUpnp->setEnabled",
          "args": [
            "false"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->setupUi",
          "args": [
            "this"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QRegExpValidator>\n#include <QRegExp>\n#include <QMessageBox>\n#include <QLocale>\n#include <QIntValidator>\n#include <QDir>\n#include \"optionsmodel.h\"\n#include \"netbase.h\"\n#include \"monitoreddatamapper.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_optionsdialog.h\"\n#include \"optionsdialog.h\"\n\nOptionsDialog {\n  OptionsDialog::OptionsDialog(QWidget *parent) :\n      QDialog(parent),\n      ui(new Ui::OptionsDialog),\n      model(0),\n      mapper(0),\n      fRestartWarningDisplayed_Proxy(false),\n      fRestartWarningDisplayed_Lang(false),\n      fProxyIpValid(true)\n  {\n      ui->setupUi(this);\n  \n      /* Network elements init */\n  #ifndef USE_UPNP\n      ui->mapPortUpnp->setEnabled(false);\n  #endif\n  \n      ui->proxyIp->setEnabled(false);\n      ui->proxyPort->setEnabled(false);\n      ui->proxyPort->setValidator(new QIntValidator(1, 65535, this));\n  \n      ui->socksVersion->setEnabled(false);\n      ui->socksVersion->addItem(\"5\", 5);\n      ui->socksVersion->addItem(\"4\", 4);\n      ui->socksVersion->setCurrentIndex(0);\n  \n      connect(ui->connectSocks, SIGNAL(toggled(bool)), ui->proxyIp, SLOT(setEnabled(bool)));\n      connect(ui->connectSocks, SIGNAL(toggled(bool)), ui->proxyPort, SLOT(setEnabled(bool)));\n      connect(ui->connectSocks, SIGNAL(toggled(bool)), ui->socksVersion, SLOT(setEnabled(bool)));\n      connect(ui->connectSocks, SIGNAL(clicked(bool)), this, SLOT(showRestartWarning_Proxy()));\n  \n      ui->proxyIp->installEventFilter(this);\n  \n      /* Window elements init */\n  #ifdef Q_OS_MAC\n      ui->tabWindow->setVisible(false);\n  #endif\n  \n      /* Display elements init */\n      QDir translations(\":translations\");\n      ui->lang->addItem(QString(\"(\") + tr(\"default\") + QString(\")\"), QVariant(\"\"));\n      foreach(const QString &langStr, translations.entryList())\n      {\n          QLocale locale(langStr);\n  \n          /** check if the locale name consists of 2 parts (language_country) */\n          if(langStr.contains(\"_\"))\n          {\n  #if QT_VERSION >= 0x040800\n              /** display language strings as \"native language - native country (locale name)\", e.g. \"Deutsch - Deutschland (de)\" */\n              ui->lang->addItem(locale.nativeLanguageName() + QString(\" - \") + locale.nativeCountryName() + QString(\" (\") + langStr + QString(\")\"), QVariant(langStr));\n  #else\n              /** display language strings as \"language - country (locale name)\", e.g. \"German - Germany (de)\" */\n              ui->lang->addItem(QLocale::languageToString(locale.language()) + QString(\" - \") + QLocale::countryToString(locale.country()) + QString(\" (\") + langStr + QString(\")\"), QVariant(langStr));\n  #endif\n          }\n          else\n          {\n  #if QT_VERSION >= 0x040800\n              /** display language strings as \"native language (locale name)\", e.g. \"Deutsch (de)\" */\n              ui->lang->addItem(locale.nativeLanguageName() + QString(\" (\") + langStr + QString(\")\"), QVariant(langStr));\n  #else\n              /** display language strings as \"language (locale name)\", e.g. \"German (de)\" */\n              ui->lang->addItem(QLocale::languageToString(locale.language()) + QString(\" (\") + langStr + QString(\")\"), QVariant(langStr));\n  #endif\n          }\n      }\n  \n      ui->unit->setModel(new BitcoinUnits(this));\n  \n      /* Widget-to-option mapper */\n      mapper = new MonitoredDataMapper(this);\n      mapper->setSubmitPolicy(QDataWidgetMapper::ManualSubmit);\n      mapper->setOrientation(Qt::Vertical);\n  \n      /* enable apply button when data modified */\n      connect(mapper, SIGNAL(viewModified()), this, SLOT(enableApplyButton()));\n      /* disable apply button when new data loaded */\n      connect(mapper, SIGNAL(currentIndexChanged(int)), this, SLOT(disableApplyButton()));\n      /* setup/change UI elements when proxy IP is invalid/valid */\n      connect(this, SIGNAL(proxyIpValid(QValidatedLineEdit *, bool)), this, SLOT(handleProxyIpValid(QValidatedLineEdit *, bool)));\n  }\n}"
  }
]