[
  {
    "function_name": "coinControlUpdateLabels",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "490-520",
    "snippet": "void SendCoinsDialog::coinControlUpdateLabels()\n{\n    if (!model || !model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n        return;\n\n    // set pay amounts\n    CoinControlDialog::payAmounts.clear();\n    for(int i = 0; i < ui->entries->count(); ++i)\n    {\n        SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n        if(entry)\n            CoinControlDialog::payAmounts.append(entry->getValue().amount);\n    }\n\n    if (CoinControlDialog::coinControl->HasSelected())\n    {\n        // actual coin control calculation\n        CoinControlDialog::updateLabels(model, this);\n\n        // show coin control stats\n        ui->labelCoinControlAutomaticallySelected->hide();\n        ui->widgetCoinControl->show();\n    }\n    else\n    {\n        // hide coin control stats\n        ui->labelCoinControlAutomaticallySelected->show();\n        ui->widgetCoinControl->hide();\n        ui->labelCoinControlInsuffFunds->hide();\n    }\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->labelCoinControlInsuffFunds->hide",
          "args": [],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->widgetCoinControl->hide",
          "args": [],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAutomaticallySelected->show",
          "args": [],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->widgetCoinControl->show",
          "args": [],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAutomaticallySelected->hide",
          "args": [],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CoinControlDialog::updateLabels",
          "args": [
            "model",
            "this"
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "updateLabels",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "413-574",
          "snippet": "void CoinControlDialog::updateLabels(WalletModel *model, QDialog* dialog)\n{\n    if (!model) return;\n\n    // nPayAmount\n    qint64 nPayAmount = 0;\n    bool fLowOutput = false;\n    bool fDust = false;\n    CTransaction txDummy;\n    foreach(const qint64 &amount, CoinControlDialog::payAmounts)\n    {\n        nPayAmount += amount;\n\n        if (amount > 0)\n        {\n            if (amount < CENT)\n                fLowOutput = true;\n\n            CTxOut txout(amount, (CScript)vector<unsigned char>(24, 0));\n            txDummy.vout.push_back(txout);\n        }\n    }\n\n    QString sPriorityLabel      = \"\";\n    int64_t nAmount             = 0;\n    int64_t nPayFee             = 0;\n    int64_t nAfterFee           = 0;\n    int64_t nChange             = 0;\n    unsigned int nBytes         = 0;\n    unsigned int nBytesInputs   = 0;\n    double dPriority            = 0;\n    double dPriorityInputs      = 0;\n    unsigned int nQuantity      = 0;\n    \n    vector<COutPoint> vCoinControl;\n    vector<COutput>   vOutputs;\n    coinControl->ListSelected(vCoinControl);\n    model->getOutputs(vCoinControl, vOutputs);\n\n    BOOST_FOREACH(const COutput& out, vOutputs)\n    {\n        // Quantity\n        nQuantity++;\n            \n        // Amount\n        nAmount += out.tx->vout[out.i].nValue;\n        \n        // Priority\n        dPriorityInputs += (double)out.tx->vout[out.i].nValue * (out.nDepth+1);\n        \n        // Bytes\n        CTxDestination address;\n        if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, address))\n        {\n            CPubKey pubkey;\n            CKeyID *keyid = boost::get< CKeyID >(&address);\n            if (keyid && model->getPubKey(*keyid, pubkey))\n                nBytesInputs += (pubkey.IsCompressed() ? 148 : 180);\n            else\n                nBytesInputs += 148; // in all error cases, simply assume 148 here\n        }\n        else nBytesInputs += 148;\n    }\n    \n    // calculation\n    if (nQuantity > 0)\n    {\n        // Bytes\n        nBytes = nBytesInputs + ((CoinControlDialog::payAmounts.size() > 0 ? CoinControlDialog::payAmounts.size() + 1 : 2) * 34) + 10; // always assume +1 output for change here\n        \n        // Priority\n        dPriority = dPriorityInputs / nBytes;\n        sPriorityLabel = CoinControlDialog::getPriorityLabel(dPriority);\n        \n        // Fee\n        int64_t nFee = nTransactionFee * (1 + (int64_t)nBytes / 1000);\n        \n        // Min Fee\n        int64_t nMinFee = txDummy.GetMinFee(1, GMF_SEND, nBytes);\n        \n        nPayFee = max(nFee, nMinFee);\n        \n        if (nPayAmount > 0)\n        {\n            nChange = nAmount - nPayFee - nPayAmount;\n            \n            // if sub-cent change is required, the fee must be raised to at least CTransaction::nMinTxFee   \n            if (nPayFee < CENT && nChange > 0 && nChange < CENT)\n            {\n                if (nChange < CENT) // change < 0.01 => simply move all change to fees\n                {\n                    nPayFee = nChange;\n                    nChange = 0;\n                }\n                else\n                {\n                    nChange = nChange + nPayFee - CENT;\n                    nPayFee = CENT;\n                }  \n            }\n            \n            if (nChange == 0)\n                nBytes -= 34;\n        }\n        \n        // after fee\n        nAfterFee = nAmount - nPayFee;\n        if (nAfterFee < 0)\n            nAfterFee = 0;\n    }\n    \n    // actually update labels\n    int nDisplayUnit = BitcoinUnits::BTC;\n    if (model && model->getOptionsModel())\n        nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n            \n    QLabel *l1 = dialog->findChild<QLabel *>(\"labelCoinControlQuantity\");\n    QLabel *l2 = dialog->findChild<QLabel *>(\"labelCoinControlAmount\");\n    QLabel *l3 = dialog->findChild<QLabel *>(\"labelCoinControlFee\");\n    QLabel *l4 = dialog->findChild<QLabel *>(\"labelCoinControlAfterFee\");\n    QLabel *l5 = dialog->findChild<QLabel *>(\"labelCoinControlBytes\");\n    QLabel *l6 = dialog->findChild<QLabel *>(\"labelCoinControlPriority\");\n    QLabel *l7 = dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\");\n    QLabel *l8 = dialog->findChild<QLabel *>(\"labelCoinControlChange\");\n    \n    // enable/disable \"low output\" and \"change\"\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\")    ->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlChange\")       ->setEnabled(nPayAmount > 0);\n    \n    // stats\n    l1->setText(QString::number(nQuantity));                                 // Quantity        \n    l2->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAmount));        // Amount\n    l3->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nPayFee));        // Fee\n    l4->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAfterFee));      // After Fee\n    l5->setText(((nBytes > 0) ? \"~\" : \"\") + QString::number(nBytes));                                    // Bytes\n    l6->setText(sPriorityLabel);                                             // Priority\n    l7->setText((fLowOutput ? (fDust ? tr(\"DUST\") : tr(\"yes\")) : tr(\"no\"))); // Low Output / Dust\n    l8->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nChange));        // Change\n    \n    // turn labels \"red\"\n    l5->setStyleSheet((nBytes >= 10000) ? \"color:red;\" : \"\");               // Bytes >= 10000\n    l6->setStyleSheet((dPriority <= 576000) ? \"color:red;\" : \"\");         // Priority < \"medium\"\n    l7->setStyleSheet((fLowOutput) ? \"color:red;\" : \"\");                    // Low Output = \"yes\"\n    l8->setStyleSheet((nChange > 0 && nChange < CENT) ? \"color:red;\" : \"\"); // Change < 0.01BTC\n        \n    // tool tips\n    l5->setToolTip(tr(\"This label turns red, if the transaction size is bigger than 10000 bytes.\\n\\n This means a fee of at least %1 per kb is required.\\n\\n Can vary +/- 1 Byte per input.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l6->setToolTip(tr(\"Transactions with higher priority get more likely into a block.\\n\\nThis label turns red, if the priority is smaller than \\\"medium\\\".\\n\\n This means a fee of at least %1 per kb is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l7->setToolTip(tr(\"This label turns red, if any recipient receives an amount smaller than %1.\\n\\n This means a fee of at least %2 is required. \\n\\n Amounts below 0.546 times the minimum relay fee are shown as DUST.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l8->setToolTip(tr(\"This label turns red, if the change is smaller than %1.\\n\\n This means a fee of at least %2 is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    dialog->findChild<QLabel *>(\"labelCoinControlBytesText\")    ->setToolTip(l5->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlPriorityText\") ->setToolTip(l6->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setToolTip(l7->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setToolTip(l8->toolTip());\n   \n    // Insufficient funds\n    QLabel *label = dialog->findChild<QLabel *>(\"labelCoinControlInsuffFunds\");\n    if (label)\n        label->setVisible(nChange < 0);\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QList<qint64> CoinControlDialog::payAmounts;",
            "CCoinControl* CoinControlDialog::coinControl = new CCoinControl();"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nQList<qint64> CoinControlDialog::payAmounts;\nCCoinControl* CoinControlDialog::coinControl = new CCoinControl();\n\nCoinControlDialog {\n  void CoinControlDialog::updateLabels(WalletModel *model, QDialog* dialog)\n  {\n      if (!model) return;\n  \n      // nPayAmount\n      qint64 nPayAmount = 0;\n      bool fLowOutput = false;\n      bool fDust = false;\n      CTransaction txDummy;\n      foreach(const qint64 &amount, CoinControlDialog::payAmounts)\n      {\n          nPayAmount += amount;\n  \n          if (amount > 0)\n          {\n              if (amount < CENT)\n                  fLowOutput = true;\n  \n              CTxOut txout(amount, (CScript)vector<unsigned char>(24, 0));\n              txDummy.vout.push_back(txout);\n          }\n      }\n  \n      QString sPriorityLabel      = \"\";\n      int64_t nAmount             = 0;\n      int64_t nPayFee             = 0;\n      int64_t nAfterFee           = 0;\n      int64_t nChange             = 0;\n      unsigned int nBytes         = 0;\n      unsigned int nBytesInputs   = 0;\n      double dPriority            = 0;\n      double dPriorityInputs      = 0;\n      unsigned int nQuantity      = 0;\n      \n      vector<COutPoint> vCoinControl;\n      vector<COutput>   vOutputs;\n      coinControl->ListSelected(vCoinControl);\n      model->getOutputs(vCoinControl, vOutputs);\n  \n      BOOST_FOREACH(const COutput& out, vOutputs)\n      {\n          // Quantity\n          nQuantity++;\n              \n          // Amount\n          nAmount += out.tx->vout[out.i].nValue;\n          \n          // Priority\n          dPriorityInputs += (double)out.tx->vout[out.i].nValue * (out.nDepth+1);\n          \n          // Bytes\n          CTxDestination address;\n          if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, address))\n          {\n              CPubKey pubkey;\n              CKeyID *keyid = boost::get< CKeyID >(&address);\n              if (keyid && model->getPubKey(*keyid, pubkey))\n                  nBytesInputs += (pubkey.IsCompressed() ? 148 : 180);\n              else\n                  nBytesInputs += 148; // in all error cases, simply assume 148 here\n          }\n          else nBytesInputs += 148;\n      }\n      \n      // calculation\n      if (nQuantity > 0)\n      {\n          // Bytes\n          nBytes = nBytesInputs + ((CoinControlDialog::payAmounts.size() > 0 ? CoinControlDialog::payAmounts.size() + 1 : 2) * 34) + 10; // always assume +1 output for change here\n          \n          // Priority\n          dPriority = dPriorityInputs / nBytes;\n          sPriorityLabel = CoinControlDialog::getPriorityLabel(dPriority);\n          \n          // Fee\n          int64_t nFee = nTransactionFee * (1 + (int64_t)nBytes / 1000);\n          \n          // Min Fee\n          int64_t nMinFee = txDummy.GetMinFee(1, GMF_SEND, nBytes);\n          \n          nPayFee = max(nFee, nMinFee);\n          \n          if (nPayAmount > 0)\n          {\n              nChange = nAmount - nPayFee - nPayAmount;\n              \n              // if sub-cent change is required, the fee must be raised to at least CTransaction::nMinTxFee   \n              if (nPayFee < CENT && nChange > 0 && nChange < CENT)\n              {\n                  if (nChange < CENT) // change < 0.01 => simply move all change to fees\n                  {\n                      nPayFee = nChange;\n                      nChange = 0;\n                  }\n                  else\n                  {\n                      nChange = nChange + nPayFee - CENT;\n                      nPayFee = CENT;\n                  }  \n              }\n              \n              if (nChange == 0)\n                  nBytes -= 34;\n          }\n          \n          // after fee\n          nAfterFee = nAmount - nPayFee;\n          if (nAfterFee < 0)\n              nAfterFee = 0;\n      }\n      \n      // actually update labels\n      int nDisplayUnit = BitcoinUnits::BTC;\n      if (model && model->getOptionsModel())\n          nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n              \n      QLabel *l1 = dialog->findChild<QLabel *>(\"labelCoinControlQuantity\");\n      QLabel *l2 = dialog->findChild<QLabel *>(\"labelCoinControlAmount\");\n      QLabel *l3 = dialog->findChild<QLabel *>(\"labelCoinControlFee\");\n      QLabel *l4 = dialog->findChild<QLabel *>(\"labelCoinControlAfterFee\");\n      QLabel *l5 = dialog->findChild<QLabel *>(\"labelCoinControlBytes\");\n      QLabel *l6 = dialog->findChild<QLabel *>(\"labelCoinControlPriority\");\n      QLabel *l7 = dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\");\n      QLabel *l8 = dialog->findChild<QLabel *>(\"labelCoinControlChange\");\n      \n      // enable/disable \"low output\" and \"change\"\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\")    ->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlChange\")       ->setEnabled(nPayAmount > 0);\n      \n      // stats\n      l1->setText(QString::number(nQuantity));                                 // Quantity        \n      l2->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAmount));        // Amount\n      l3->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nPayFee));        // Fee\n      l4->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAfterFee));      // After Fee\n      l5->setText(((nBytes > 0) ? \"~\" : \"\") + QString::number(nBytes));                                    // Bytes\n      l6->setText(sPriorityLabel);                                             // Priority\n      l7->setText((fLowOutput ? (fDust ? tr(\"DUST\") : tr(\"yes\")) : tr(\"no\"))); // Low Output / Dust\n      l8->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nChange));        // Change\n      \n      // turn labels \"red\"\n      l5->setStyleSheet((nBytes >= 10000) ? \"color:red;\" : \"\");               // Bytes >= 10000\n      l6->setStyleSheet((dPriority <= 576000) ? \"color:red;\" : \"\");         // Priority < \"medium\"\n      l7->setStyleSheet((fLowOutput) ? \"color:red;\" : \"\");                    // Low Output = \"yes\"\n      l8->setStyleSheet((nChange > 0 && nChange < CENT) ? \"color:red;\" : \"\"); // Change < 0.01BTC\n          \n      // tool tips\n      l5->setToolTip(tr(\"This label turns red, if the transaction size is bigger than 10000 bytes.\\n\\n This means a fee of at least %1 per kb is required.\\n\\n Can vary +/- 1 Byte per input.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l6->setToolTip(tr(\"Transactions with higher priority get more likely into a block.\\n\\nThis label turns red, if the priority is smaller than \\\"medium\\\".\\n\\n This means a fee of at least %1 per kb is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l7->setToolTip(tr(\"This label turns red, if any recipient receives an amount smaller than %1.\\n\\n This means a fee of at least %2 is required. \\n\\n Amounts below 0.546 times the minimum relay fee are shown as DUST.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l8->setToolTip(tr(\"This label turns red, if the change is smaller than %1.\\n\\n This means a fee of at least %2 is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      dialog->findChild<QLabel *>(\"labelCoinControlBytesText\")    ->setToolTip(l5->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlPriorityText\") ->setToolTip(l6->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setToolTip(l7->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setToolTip(l8->toolTip());\n     \n      // Insufficient funds\n      QLabel *label = dialog->findChild<QLabel *>(\"labelCoinControlInsuffFunds\");\n      if (label)\n          label->setVisible(nChange < 0);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CoinControlDialog::coinControl->HasSelected",
          "args": [],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "HasSelected",
          "container": "CCoinControl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/coincontrol.h",
          "lines": "21-24",
          "snippet": "bool HasSelected() const\n    {\n        return (setSelected.size() > 0);\n    }",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "CCoinControl {\n  bool HasSelected() const\n      {\n          return (setSelected.size() > 0);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CoinControlDialog::payAmounts.append",
          "args": [
            "entry->getValue().amount"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entry->getValue",
          "args": [],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "getValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "129-138",
          "snippet": "SendCoinsRecipient SendCoinsEntry::getValue()\n{\n    SendCoinsRecipient rv;\n\n    rv.address = ui->payTo->text();\n    rv.label = ui->addAsLabel->text();\n    rv.amount = ui->payAmount->value();\n\n    return rv;\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  SendCoinsRecipient SendCoinsEntry::getValue()\n  {\n      SendCoinsRecipient rv;\n  \n      rv.address = ui->payTo->text();\n      rv.label = ui->addAsLabel->text();\n      rv.amount = ui->payAmount->value();\n  \n      return rv;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "qobject_cast<SendCoinsEntry*>",
          "args": [
            "ui->entries->itemAt(i)->widget()"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->itemAt",
          "args": [],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->itemAt",
          "args": [
            "i"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->count",
          "args": [],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CoinControlDialog::payAmounts.clear",
          "args": [],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "228-240",
          "snippet": "void SendCoinsDialog::clear()\n{\n    // Remove entries until only one left\n    while(ui->entries->count())\n    {\n        delete ui->entries->takeAt(0)->widget();\n    }\n    addEntry();\n\n    updateRemoveEnabled();\n\n    ui->sendButton->setDefault(true);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::clear()\n  {\n      // Remove entries until only one left\n      while(ui->entries->count())\n      {\n          delete ui->entries->takeAt(0)->widget();\n      }\n      addEntry();\n  \n      updateRemoveEnabled();\n  \n      ui->sendButton->setDefault(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlUpdateLabels()\n  {\n      if (!model || !model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n          return;\n  \n      // set pay amounts\n      CoinControlDialog::payAmounts.clear();\n      for(int i = 0; i < ui->entries->count(); ++i)\n      {\n          SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n          if(entry)\n              CoinControlDialog::payAmounts.append(entry->getValue().amount);\n      }\n  \n      if (CoinControlDialog::coinControl->HasSelected())\n      {\n          // actual coin control calculation\n          CoinControlDialog::updateLabels(model, this);\n  \n          // show coin control stats\n          ui->labelCoinControlAutomaticallySelected->hide();\n          ui->widgetCoinControl->show();\n      }\n      else\n      {\n          // hide coin control stats\n          ui->labelCoinControlAutomaticallySelected->show();\n          ui->widgetCoinControl->hide();\n          ui->labelCoinControlInsuffFunds->hide();\n      }\n  }\n}"
  },
  {
    "function_name": "coinControlChangeEdited",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "452-487",
    "snippet": "void SendCoinsDialog::coinControlChangeEdited(const QString & text)\n{\n    if (model)\n    {\n        CoinControlDialog::coinControl->destChange = CBitcoinAddress(text.toStdString()).Get();\n\n        // label for the change address\n        ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:black;}\");\n        if (text.isEmpty())\n            ui->labelCoinControlChangeLabel->setText(\"\");\n        else if (!CBitcoinAddress(text.toStdString()).IsValid())\n        {\n            ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n            ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: Invalid Halcyon address\"));\n        }\n        else\n        {\n            QString associatedLabel = model->getAddressTableModel()->labelForAddress(text);\n            if (!associatedLabel.isEmpty())\n                ui->labelCoinControlChangeLabel->setText(associatedLabel);\n            else\n            {\n                CPubKey pubkey;\n                CKeyID keyid;\n                CBitcoinAddress(text.toStdString()).GetKeyID(keyid);   \n                if (model->getPubKey(keyid, pubkey))\n                    ui->labelCoinControlChangeLabel->setText(tr(\"(no label)\"));\n                else\n                {\n                    ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n                    ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: unknown change address\"));\n                }\n            }\n        }\n    }\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->labelCoinControlChangeLabel->setText",
          "args": [
            "tr(\"WARNING: unknown change address\")"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"WARNING: unknown change address\""
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlChangeEdited",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "452-487",
          "snippet": "void SendCoinsDialog::coinControlChangeEdited(const QString & text)\n{\n    if (model)\n    {\n        CoinControlDialog::coinControl->destChange = CBitcoinAddress(text.toStdString()).Get();\n\n        // label for the change address\n        ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:black;}\");\n        if (text.isEmpty())\n            ui->labelCoinControlChangeLabel->setText(\"\");\n        else if (!CBitcoinAddress(text.toStdString()).IsValid())\n        {\n            ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n            ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: Invalid Halcyon address\"));\n        }\n        else\n        {\n            QString associatedLabel = model->getAddressTableModel()->labelForAddress(text);\n            if (!associatedLabel.isEmpty())\n                ui->labelCoinControlChangeLabel->setText(associatedLabel);\n            else\n            {\n                CPubKey pubkey;\n                CKeyID keyid;\n                CBitcoinAddress(text.toStdString()).GetKeyID(keyid);   \n                if (model->getPubKey(keyid, pubkey))\n                    ui->labelCoinControlChangeLabel->setText(tr(\"(no label)\"));\n                else\n                {\n                    ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n                    ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: unknown change address\"));\n                }\n            }\n        }\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlChangeLabel->setStyleSheet",
          "args": [
            "\"QLabel{color:red;}\""
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getPubKey",
          "args": [
            "keyid",
            "pubkey"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "getPubKey",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "407-410",
          "snippet": "bool WalletModel::getPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) const\n{\n    return wallet->GetPubKey(address, vchPubKeyOut);   \n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  bool WalletModel::getPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) const\n  {\n      return wallet->GetPubKey(address, vchPubKeyOut);   \n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [
            "keyid"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "operator()",
          "container": "CBitcoinAddressVisitor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "399-399",
          "snippet": "bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddressVisitor {\n  bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "text.toStdString",
          "args": [],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "associatedLabel.isEmpty",
          "args": [],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [
            "text"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlChangeLabel->setStyleSheet",
          "args": [
            "\"QLabel{color:red;}\""
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "IsScript",
          "container": "CBitcoinAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "384-394",
          "snippet": "bool IsScript() const {\n        if (!IsValid())\n            return false;\n        switch (nVersion) {\n        case SCRIPT_ADDRESS:\n        case SCRIPT_ADDRESS_TEST: {\n            return true;\n        }\n        default: return false;\n        }\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool IsScript() const {\n          if (!IsValid())\n              return false;\n          switch (nVersion) {\n          case SCRIPT_ADDRESS:\n          case SCRIPT_ADDRESS_TEST: {\n              return true;\n          }\n          default: return false;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "text.toStdString",
          "args": [],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text.isEmpty",
          "args": [],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlChangeLabel->setStyleSheet",
          "args": [
            "\"QLabel{color:black;}\""
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text.toStdString",
          "args": [],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlChangeEdited(const QString & text)\n  {\n      if (model)\n      {\n          CoinControlDialog::coinControl->destChange = CBitcoinAddress(text.toStdString()).Get();\n  \n          // label for the change address\n          ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:black;}\");\n          if (text.isEmpty())\n              ui->labelCoinControlChangeLabel->setText(\"\");\n          else if (!CBitcoinAddress(text.toStdString()).IsValid())\n          {\n              ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n              ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: Invalid Halcyon address\"));\n          }\n          else\n          {\n              QString associatedLabel = model->getAddressTableModel()->labelForAddress(text);\n              if (!associatedLabel.isEmpty())\n                  ui->labelCoinControlChangeLabel->setText(associatedLabel);\n              else\n              {\n                  CPubKey pubkey;\n                  CKeyID keyid;\n                  CBitcoinAddress(text.toStdString()).GetKeyID(keyid);   \n                  if (model->getPubKey(keyid, pubkey))\n                      ui->labelCoinControlChangeLabel->setText(tr(\"(no label)\"));\n                  else\n                  {\n                      ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n                      ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: unknown change address\"));\n                  }\n              }\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "coinControlChangeChecked",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "437-449",
    "snippet": "void SendCoinsDialog::coinControlChangeChecked(int state)\n{\n    if (model)\n    {\n        if (state == Qt::Checked)\n            CoinControlDialog::coinControl->destChange = CBitcoinAddress(ui->lineEditCoinControlChange->text().toStdString()).Get();\n        else\n            CoinControlDialog::coinControl->destChange = CNoDestination();\n    }\n\n    ui->lineEditCoinControlChange->setEnabled((state == Qt::Checked));\n    ui->labelCoinControlChangeLabel->setEnabled((state == Qt::Checked));\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->labelCoinControlChangeLabel->setEnabled",
          "args": [
            "(state == Qt::Checked)"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lineEditCoinControlChange->setEnabled",
          "args": [
            "(state == Qt::Checked)"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CNoDestination",
          "args": [],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "IsScript",
          "container": "CBitcoinAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "384-394",
          "snippet": "bool IsScript() const {\n        if (!IsValid())\n            return false;\n        switch (nVersion) {\n        case SCRIPT_ADDRESS:\n        case SCRIPT_ADDRESS_TEST: {\n            return true;\n        }\n        default: return false;\n        }\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool IsScript() const {\n          if (!IsValid())\n              return false;\n          switch (nVersion) {\n          case SCRIPT_ADDRESS:\n          case SCRIPT_ADDRESS_TEST: {\n              return true;\n          }\n          default: return false;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [
            "ui->lineEditCoinControlChange->text().toStdString()"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "operator()",
          "container": "CBitcoinAddressVisitor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "399-399",
          "snippet": "bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddressVisitor {\n  bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->lineEditCoinControlChange->text",
          "args": [],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlChangeChecked(int state)\n  {\n      if (model)\n      {\n          if (state == Qt::Checked)\n              CoinControlDialog::coinControl->destChange = CBitcoinAddress(ui->lineEditCoinControlChange->text().toStdString()).Get();\n          else\n              CoinControlDialog::coinControl->destChange = CNoDestination();\n      }\n  \n      ui->lineEditCoinControlChange->setEnabled((state == Qt::Checked));\n      ui->labelCoinControlChangeLabel->setEnabled((state == Qt::Checked));\n  }\n}"
  },
  {
    "function_name": "coinControlButtonClicked",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "428-434",
    "snippet": "void SendCoinsDialog::coinControlButtonClicked()\n{\n    CoinControlDialog dlg;\n    dlg.setModel(model);\n    dlg.exec();\n    coinControlUpdateLabels();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "coinControlUpdateLabels",
          "args": [],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlUpdateLabels",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "490-520",
          "snippet": "void SendCoinsDialog::coinControlUpdateLabels()\n{\n    if (!model || !model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n        return;\n\n    // set pay amounts\n    CoinControlDialog::payAmounts.clear();\n    for(int i = 0; i < ui->entries->count(); ++i)\n    {\n        SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n        if(entry)\n            CoinControlDialog::payAmounts.append(entry->getValue().amount);\n    }\n\n    if (CoinControlDialog::coinControl->HasSelected())\n    {\n        // actual coin control calculation\n        CoinControlDialog::updateLabels(model, this);\n\n        // show coin control stats\n        ui->labelCoinControlAutomaticallySelected->hide();\n        ui->widgetCoinControl->show();\n    }\n    else\n    {\n        // hide coin control stats\n        ui->labelCoinControlAutomaticallySelected->show();\n        ui->widgetCoinControl->hide();\n        ui->labelCoinControlInsuffFunds->hide();\n    }\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlUpdateLabels()\n  {\n      if (!model || !model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n          return;\n  \n      // set pay amounts\n      CoinControlDialog::payAmounts.clear();\n      for(int i = 0; i < ui->entries->count(); ++i)\n      {\n          SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n          if(entry)\n              CoinControlDialog::payAmounts.append(entry->getValue().amount);\n      }\n  \n      if (CoinControlDialog::coinControl->HasSelected())\n      {\n          // actual coin control calculation\n          CoinControlDialog::updateLabels(model, this);\n  \n          // show coin control stats\n          ui->labelCoinControlAutomaticallySelected->hide();\n          ui->widgetCoinControl->show();\n      }\n      else\n      {\n          // hide coin control stats\n          ui->labelCoinControlAutomaticallySelected->show();\n          ui->widgetCoinControl->hide();\n          ui->labelCoinControlInsuffFunds->hide();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlg.exec",
          "args": [],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlg.setModel",
          "args": [
            "model"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "83-108",
          "snippet": "void SendCoinsDialog::setModel(WalletModel *model)\n{\n    this->model = model;\n\n    for(int i = 0; i < ui->entries->count(); ++i)\n    {\n        SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n        if(entry)\n        {\n            entry->setModel(model);\n        }\n    }\n    if(model && model->getOptionsModel())\n    {\n        setBalance(model->getBalance(), model->getStake(), model->getUnconfirmedBalance(), model->getImmatureBalance());\n        connect(model, SIGNAL(balanceChanged(qint64, qint64, qint64, qint64)), this, SLOT(setBalance(qint64, qint64, qint64, qint64)));\n        connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n\n        // Coin Control\n        connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(coinControlUpdateLabels()));\n        connect(model->getOptionsModel(), SIGNAL(coinControlFeaturesChanged(bool)), this, SLOT(coinControlFeatureChanged(bool)));\n        connect(model->getOptionsModel(), SIGNAL(transactionFeeChanged(qint64)), this, SLOT(coinControlUpdateLabels()));\n        ui->frameCoinControl->setVisible(model->getOptionsModel()->getCoinControlFeatures());\n        coinControlUpdateLabels();\n    }\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::setModel(WalletModel *model)\n  {\n      this->model = model;\n  \n      for(int i = 0; i < ui->entries->count(); ++i)\n      {\n          SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n          if(entry)\n          {\n              entry->setModel(model);\n          }\n      }\n      if(model && model->getOptionsModel())\n      {\n          setBalance(model->getBalance(), model->getStake(), model->getUnconfirmedBalance(), model->getImmatureBalance());\n          connect(model, SIGNAL(balanceChanged(qint64, qint64, qint64, qint64)), this, SLOT(setBalance(qint64, qint64, qint64, qint64)));\n          connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n  \n          // Coin Control\n          connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(coinControlUpdateLabels()));\n          connect(model->getOptionsModel(), SIGNAL(coinControlFeaturesChanged(bool)), this, SLOT(coinControlFeatureChanged(bool)));\n          connect(model->getOptionsModel(), SIGNAL(transactionFeeChanged(qint64)), this, SLOT(coinControlUpdateLabels()));\n          ui->frameCoinControl->setVisible(model->getOptionsModel()->getCoinControlFeatures());\n          coinControlUpdateLabels();\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlButtonClicked()\n  {\n      CoinControlDialog dlg;\n      dlg.setModel(model);\n      dlg.exec();\n      coinControlUpdateLabels();\n  }\n}"
  },
  {
    "function_name": "coinControlFeatureChanged",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "419-425",
    "snippet": "void SendCoinsDialog::coinControlFeatureChanged(bool checked)\n{\n    ui->frameCoinControl->setVisible(checked);\n\n    if (!checked && model) // coin control features disabled\n        CoinControlDialog::coinControl->SetNull();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CoinControlDialog::coinControl->SetNull",
          "args": [],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CKeyMetadata",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "50-54",
          "snippet": "void SetNull()\n    {\n        nVersion = CKeyMetadata::CURRENT_VERSION;\n        nCreateTime = 0;\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCKeyMetadata {\n  void SetNull()\n      {\n          nVersion = CKeyMetadata::CURRENT_VERSION;\n          nCreateTime = 0;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->frameCoinControl->setVisible",
          "args": [
            "checked"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlFeatureChanged(bool checked)\n  {\n      ui->frameCoinControl->setVisible(checked);\n  \n      if (!checked && model) // coin control features disabled\n          CoinControlDialog::coinControl->SetNull();\n  }\n}"
  },
  {
    "function_name": "coinControlClipboardChange",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "413-416",
    "snippet": "void SendCoinsDialog::coinControlClipboardChange()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlChange->text().left(ui->labelCoinControlChange->text().indexOf(\" \")));\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlChange->text().left(ui->labelCoinControlChange->text().indexOf(\" \"))"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlChange->text",
          "args": [
            "ui->labelCoinControlChange->text().indexOf(\" \")"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlChange->text",
          "args": [
            "\" \""
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlChange->text",
          "args": [],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardChange()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlChange->text().left(ui->labelCoinControlChange->text().indexOf(\" \")));\n  }\n}"
  },
  {
    "function_name": "coinControlClipboardLowOutput",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "407-410",
    "snippet": "void SendCoinsDialog::coinControlClipboardLowOutput()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlLowOutput->text());\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlLowOutput->text()"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlLowOutput->text",
          "args": [],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardLowOutput()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlLowOutput->text());\n  }\n}"
  },
  {
    "function_name": "coinControlClipboardPriority",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "401-404",
    "snippet": "void SendCoinsDialog::coinControlClipboardPriority()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlPriority->text());\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlPriority->text()"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlPriority->text",
          "args": [],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardPriority()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlPriority->text());\n  }\n}"
  },
  {
    "function_name": "coinControlClipboardBytes",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "395-398",
    "snippet": "void SendCoinsDialog::coinControlClipboardBytes()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlBytes->text());\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlBytes->text()"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlBytes->text",
          "args": [],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardBytes()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlBytes->text());\n  }\n}"
  },
  {
    "function_name": "coinControlClipboardAfterFee",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "389-392",
    "snippet": "void SendCoinsDialog::coinControlClipboardAfterFee()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlAfterFee->text().left(ui->labelCoinControlAfterFee->text().indexOf(\" \")));\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlAfterFee->text().left(ui->labelCoinControlAfterFee->text().indexOf(\" \"))"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAfterFee->text",
          "args": [
            "ui->labelCoinControlAfterFee->text().indexOf(\" \")"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAfterFee->text",
          "args": [
            "\" \""
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAfterFee->text",
          "args": [],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardAfterFee()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlAfterFee->text().left(ui->labelCoinControlAfterFee->text().indexOf(\" \")));\n  }\n}"
  },
  {
    "function_name": "coinControlClipboardFee",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "383-386",
    "snippet": "void SendCoinsDialog::coinControlClipboardFee()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlFee->text().left(ui->labelCoinControlFee->text().indexOf(\" \")));\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlFee->text().left(ui->labelCoinControlFee->text().indexOf(\" \"))"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlFee->text",
          "args": [
            "ui->labelCoinControlFee->text().indexOf(\" \")"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlFee->text",
          "args": [
            "\" \""
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlFee->text",
          "args": [],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardFee()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlFee->text().left(ui->labelCoinControlFee->text().indexOf(\" \")));\n  }\n}"
  },
  {
    "function_name": "coinControlClipboardAmount",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "377-380",
    "snippet": "void SendCoinsDialog::coinControlClipboardAmount()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlAmount->text().left(ui->labelCoinControlAmount->text().indexOf(\" \")));\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlAmount->text().left(ui->labelCoinControlAmount->text().indexOf(\" \"))"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAmount->text",
          "args": [
            "ui->labelCoinControlAmount->text().indexOf(\" \")"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAmount->text",
          "args": [
            "\" \""
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAmount->text",
          "args": [],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardAmount()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlAmount->text().left(ui->labelCoinControlAmount->text().indexOf(\" \")));\n  }\n}"
  },
  {
    "function_name": "coinControlClipboardQuantity",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "371-374",
    "snippet": "void SendCoinsDialog::coinControlClipboardQuantity()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlQuantity->text());\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlQuantity->text()"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlQuantity->text",
          "args": [],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardQuantity()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlQuantity->text());\n  }\n}"
  },
  {
    "function_name": "updateDisplayUnit",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "361-368",
    "snippet": "void SendCoinsDialog::updateDisplayUnit()\n{\n    if(model && model->getOptionsModel())\n    {\n        // Update labelBalance with the current balance and the current unit\n        ui->labelBalance->setText(BitcoinUnits::formatWithUnit(model->getOptionsModel()->getDisplayUnit(), model->getBalance()));\n    }\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->labelBalance->setText",
          "args": [
            "BitcoinUnits::formatWithUnit(model->getOptionsModel()->getDisplayUnit(), model->getBalance())"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "model->getOptionsModel()->getDisplayUnit()",
            "model->getBalance()"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getBalance",
          "args": [],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "getBalance",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "39-42",
          "snippet": "qint64 WalletModel::getBalance() const\n{\n    return wallet->GetBalance();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  qint64 WalletModel::getBalance() const\n  {\n      return wallet->GetBalance();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::updateDisplayUnit()\n  {\n      if(model && model->getOptionsModel())\n      {\n          // Update labelBalance with the current balance and the current unit\n          ui->labelBalance->setText(BitcoinUnits::formatWithUnit(model->getOptionsModel()->getDisplayUnit(), model->getBalance()));\n      }\n  }\n}"
  },
  {
    "function_name": "setBalance",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "349-359",
    "snippet": "void SendCoinsDialog::setBalance(qint64 balance, qint64 stake, qint64 unconfirmedBalance, qint64 immatureBalance)\n{\n    Q_UNUSED(stake);\n    Q_UNUSED(unconfirmedBalance);\n    Q_UNUSED(immatureBalance);\n    if(!model || !model->getOptionsModel())\n        return;\n\n    int unit = model->getOptionsModel()->getDisplayUnit();\n    ui->labelBalance->setText(BitcoinUnits::formatWithUnit(unit, balance));\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->labelBalance->setText",
          "args": [
            "BitcoinUnits::formatWithUnit(unit, balance)"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "unit",
            "balance"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_UNUSED",
          "args": [
            "immatureBalance"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_UNUSED",
          "args": [
            "unconfirmedBalance"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_UNUSED",
          "args": [
            "stake"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::setBalance(qint64 balance, qint64 stake, qint64 unconfirmedBalance, qint64 immatureBalance)\n  {\n      Q_UNUSED(stake);\n      Q_UNUSED(unconfirmedBalance);\n      Q_UNUSED(immatureBalance);\n      if(!model || !model->getOptionsModel())\n          return;\n  \n      int unit = model->getOptionsModel()->getDisplayUnit();\n      ui->labelBalance->setText(BitcoinUnits::formatWithUnit(unit, balance));\n  }\n}"
  },
  {
    "function_name": "handleURI",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "333-347",
    "snippet": "bool SendCoinsDialog::handleURI(const QString &uri)\n{\n    SendCoinsRecipient rv;\n    // URI has to be valid\n    if (GUIUtil::parseBitcoinURI(uri, &rv))\n    {\n        CBitcoinAddress address(rv.address.toStdString());\n        if (!address.IsValid())\n            return false;\n        pasteEntry(rv);\n        return true;\n    }\n\n    return false;\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pasteEntry",
          "args": [
            "rv"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "pasteEntry",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "310-331",
          "snippet": "void SendCoinsDialog::pasteEntry(const SendCoinsRecipient &rv)\n{\n    if(!fNewRecipientAllowed)\n        return;\n\n    SendCoinsEntry *entry = 0;\n    // Replace the first entry if it is still unused\n    if(ui->entries->count() == 1)\n    {\n        SendCoinsEntry *first = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(0)->widget());\n        if(first->isClear())\n        {\n            entry = first;\n        }\n    }\n    if(!entry)\n    {\n        entry = addEntry();\n    }\n\n    entry->setValue(rv);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::pasteEntry(const SendCoinsRecipient &rv)\n  {\n      if(!fNewRecipientAllowed)\n          return;\n  \n      SendCoinsEntry *entry = 0;\n      // Replace the first entry if it is still unused\n      if(ui->entries->count() == 1)\n      {\n          SendCoinsEntry *first = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(0)->widget());\n          if(first->isClear())\n          {\n              entry = first;\n          }\n      }\n      if(!entry)\n      {\n          entry = addEntry();\n      }\n  \n      entry->setValue(rv);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "address.IsValid",
          "args": [],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "IsValid",
          "container": "CNetAddr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "725-759",
          "snippet": "bool CNetAddr::IsValid() const\n{\n    // Cleanup 3-byte shifted addresses caused by garbage in size field\n    // of addr messages from versions before 0.2.9 checksum.\n    // Two consecutive addr messages look like this:\n    // header20 vectorlen3 addr26 addr26 addr26 header20 vectorlen3 addr26 addr26 addr26...\n    // so if the first length field is garbled, it reads the second batch\n    // of addr misaligned by 3 bytes.\n    if (memcmp(ip, pchIPv4+3, sizeof(pchIPv4)-3) == 0)\n        return false;\n\n    // unspecified IPv6 address (::/128)\n    unsigned char ipNone[16] = {};\n    if (memcmp(ip, ipNone, 16) == 0)\n        return false;\n\n    // documentation IPv6 address\n    if (IsRFC3849())\n        return false;\n\n    if (IsIPv4())\n    {\n        // INADDR_NONE\n        uint32_t ipNone = INADDR_NONE;\n        if (memcmp(ip+12, &ipNone, 4) == 0)\n            return false;\n\n        // 0\n        ipNone = 0;\n        if (memcmp(ip+12, &ipNone, 4) == 0)\n            return false;\n    }\n\n    return true;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const unsigned char pchIPv4[12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nstatic const unsigned char pchIPv4[12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff };\n\nCNetAddr {\n  bool CNetAddr::IsValid() const\n  {\n      // Cleanup 3-byte shifted addresses caused by garbage in size field\n      // of addr messages from versions before 0.2.9 checksum.\n      // Two consecutive addr messages look like this:\n      // header20 vectorlen3 addr26 addr26 addr26 header20 vectorlen3 addr26 addr26 addr26...\n      // so if the first length field is garbled, it reads the second batch\n      // of addr misaligned by 3 bytes.\n      if (memcmp(ip, pchIPv4+3, sizeof(pchIPv4)-3) == 0)\n          return false;\n  \n      // unspecified IPv6 address (::/128)\n      unsigned char ipNone[16] = {};\n      if (memcmp(ip, ipNone, 16) == 0)\n          return false;\n  \n      // documentation IPv6 address\n      if (IsRFC3849())\n          return false;\n  \n      if (IsIPv4())\n      {\n          // INADDR_NONE\n          uint32_t ipNone = INADDR_NONE;\n          if (memcmp(ip+12, &ipNone, 4) == 0)\n              return false;\n  \n          // 0\n          ipNone = 0;\n          if (memcmp(ip+12, &ipNone, 4) == 0)\n              return false;\n      }\n  \n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rv.address.toStdString",
          "args": [],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::parseBitcoinURI",
          "args": [
            "uri",
            "&rv"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "parseBitcoinURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "124-136",
          "snippet": "bool parseBitcoinURI(QString uri, SendCoinsRecipient *out)\n{\n    // Convert halcyon:// to halcyon:\n    //\n    //    Cannot handle this later, because bitcoin:// will cause Qt to see the part after // as host,\n    //    which will lower-case it (and thus invalidate the address).\n    if(uri.startsWith(\"halcyon://\"))\n    {\n        uri.replace(0, 12, \"halcyon:\");\n    }\n    QUrl uriInstance(uri);\n    return parseBitcoinURI(uriInstance, out);\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool parseBitcoinURI(QString uri, SendCoinsRecipient *out)\n{\n    // Convert halcyon:// to halcyon:\n    //\n    //    Cannot handle this later, because bitcoin:// will cause Qt to see the part after // as host,\n    //    which will lower-case it (and thus invalidate the address).\n    if(uri.startsWith(\"halcyon://\"))\n    {\n        uri.replace(0, 12, \"halcyon:\");\n    }\n    QUrl uriInstance(uri);\n    return parseBitcoinURI(uriInstance, out);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  bool SendCoinsDialog::handleURI(const QString &uri)\n  {\n      SendCoinsRecipient rv;\n      // URI has to be valid\n      if (GUIUtil::parseBitcoinURI(uri, &rv))\n      {\n          CBitcoinAddress address(rv.address.toStdString());\n          if (!address.IsValid())\n              return false;\n          pasteEntry(rv);\n          return true;\n      }\n  \n      return false;\n  }\n}"
  },
  {
    "function_name": "pasteEntry",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "310-331",
    "snippet": "void SendCoinsDialog::pasteEntry(const SendCoinsRecipient &rv)\n{\n    if(!fNewRecipientAllowed)\n        return;\n\n    SendCoinsEntry *entry = 0;\n    // Replace the first entry if it is still unused\n    if(ui->entries->count() == 1)\n    {\n        SendCoinsEntry *first = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(0)->widget());\n        if(first->isClear())\n        {\n            entry = first;\n        }\n    }\n    if(!entry)\n    {\n        entry = addEntry();\n    }\n\n    entry->setValue(rv);\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "entry->setValue",
          "args": [
            "rv"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "addEntry",
          "args": [],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "first->isClear",
          "args": [],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "isClear",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "157-160",
          "snippet": "bool SendCoinsEntry::isClear()\n{\n    return ui->payTo->text().isEmpty();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  bool SendCoinsEntry::isClear()\n  {\n      return ui->payTo->text().isEmpty();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "qobject_cast<SendCoinsEntry*>",
          "args": [
            "ui->entries->itemAt(0)->widget()"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->itemAt",
          "args": [],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->itemAt",
          "args": [
            "0"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->count",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::pasteEntry(const SendCoinsRecipient &rv)\n  {\n      if(!fNewRecipientAllowed)\n          return;\n  \n      SendCoinsEntry *entry = 0;\n      // Replace the first entry if it is still unused\n      if(ui->entries->count() == 1)\n      {\n          SendCoinsEntry *first = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(0)->widget());\n          if(first->isClear())\n          {\n              entry = first;\n          }\n      }\n      if(!entry)\n      {\n          entry = addEntry();\n      }\n  \n      entry->setValue(rv);\n  }\n}"
  },
  {
    "function_name": "removeEntry",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "289-293",
    "snippet": "void SendCoinsDialog::removeEntry(SendCoinsEntry* entry)\n{\n    delete entry;\n    updateRemoveEnabled();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "updateRemoveEnabled",
          "args": [],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "updateRemoveEnabled",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "273-287",
          "snippet": "void SendCoinsDialog::updateRemoveEnabled()\n{\n    // Remove buttons are enabled as soon as there is more than one send-entry\n    bool enabled = (ui->entries->count() > 1);\n    for(int i = 0; i < ui->entries->count(); ++i)\n    {\n        SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n        if(entry)\n        {\n            entry->setRemoveEnabled(enabled);\n        }\n    }\n    setupTabChain(0);\n    coinControlUpdateLabels();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::updateRemoveEnabled()\n  {\n      // Remove buttons are enabled as soon as there is more than one send-entry\n      bool enabled = (ui->entries->count() > 1);\n      for(int i = 0; i < ui->entries->count(); ++i)\n      {\n          SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n          if(entry)\n          {\n              entry->setRemoveEnabled(enabled);\n          }\n      }\n      setupTabChain(0);\n      coinControlUpdateLabels();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::removeEntry(SendCoinsEntry* entry)\n  {\n      delete entry;\n      updateRemoveEnabled();\n  }\n}"
  },
  {
    "function_name": "updateRemoveEnabled",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "273-287",
    "snippet": "void SendCoinsDialog::updateRemoveEnabled()\n{\n    // Remove buttons are enabled as soon as there is more than one send-entry\n    bool enabled = (ui->entries->count() > 1);\n    for(int i = 0; i < ui->entries->count(); ++i)\n    {\n        SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n        if(entry)\n        {\n            entry->setRemoveEnabled(enabled);\n        }\n    }\n    setupTabChain(0);\n    coinControlUpdateLabels();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "coinControlUpdateLabels",
          "args": [],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlUpdateLabels",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "490-520",
          "snippet": "void SendCoinsDialog::coinControlUpdateLabels()\n{\n    if (!model || !model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n        return;\n\n    // set pay amounts\n    CoinControlDialog::payAmounts.clear();\n    for(int i = 0; i < ui->entries->count(); ++i)\n    {\n        SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n        if(entry)\n            CoinControlDialog::payAmounts.append(entry->getValue().amount);\n    }\n\n    if (CoinControlDialog::coinControl->HasSelected())\n    {\n        // actual coin control calculation\n        CoinControlDialog::updateLabels(model, this);\n\n        // show coin control stats\n        ui->labelCoinControlAutomaticallySelected->hide();\n        ui->widgetCoinControl->show();\n    }\n    else\n    {\n        // hide coin control stats\n        ui->labelCoinControlAutomaticallySelected->show();\n        ui->widgetCoinControl->hide();\n        ui->labelCoinControlInsuffFunds->hide();\n    }\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlUpdateLabels()\n  {\n      if (!model || !model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n          return;\n  \n      // set pay amounts\n      CoinControlDialog::payAmounts.clear();\n      for(int i = 0; i < ui->entries->count(); ++i)\n      {\n          SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n          if(entry)\n              CoinControlDialog::payAmounts.append(entry->getValue().amount);\n      }\n  \n      if (CoinControlDialog::coinControl->HasSelected())\n      {\n          // actual coin control calculation\n          CoinControlDialog::updateLabels(model, this);\n  \n          // show coin control stats\n          ui->labelCoinControlAutomaticallySelected->hide();\n          ui->widgetCoinControl->show();\n      }\n      else\n      {\n          // hide coin control stats\n          ui->labelCoinControlAutomaticallySelected->show();\n          ui->widgetCoinControl->hide();\n          ui->labelCoinControlInsuffFunds->hide();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setupTabChain",
          "args": [
            "0"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entry->setRemoveEnabled",
          "args": [
            "enabled"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "setRemoveEnabled",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "80-83",
          "snippet": "void SendCoinsEntry::setRemoveEnabled(bool enabled)\n{\n    ui->deleteButton->setEnabled(enabled);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setRemoveEnabled(bool enabled)\n  {\n      ui->deleteButton->setEnabled(enabled);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "qobject_cast<SendCoinsEntry*>",
          "args": [
            "ui->entries->itemAt(i)->widget()"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->itemAt",
          "args": [],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->itemAt",
          "args": [
            "i"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->count",
          "args": [],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->count",
          "args": [],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::updateRemoveEnabled()\n  {\n      // Remove buttons are enabled as soon as there is more than one send-entry\n      bool enabled = (ui->entries->count() > 1);\n      for(int i = 0; i < ui->entries->count(); ++i)\n      {\n          SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n          if(entry)\n          {\n              entry->setRemoveEnabled(enabled);\n          }\n      }\n      setupTabChain(0);\n      coinControlUpdateLabels();\n  }\n}"
  },
  {
    "function_name": "accept",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "247-250",
    "snippet": "void SendCoinsDialog::accept()\n{\n    clear();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear",
          "args": [],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "228-240",
          "snippet": "void SendCoinsDialog::clear()\n{\n    // Remove entries until only one left\n    while(ui->entries->count())\n    {\n        delete ui->entries->takeAt(0)->widget();\n    }\n    addEntry();\n\n    updateRemoveEnabled();\n\n    ui->sendButton->setDefault(true);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::clear()\n  {\n      // Remove entries until only one left\n      while(ui->entries->count())\n      {\n          delete ui->entries->takeAt(0)->widget();\n      }\n      addEntry();\n  \n      updateRemoveEnabled();\n  \n      ui->sendButton->setDefault(true);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::accept()\n  {\n      clear();\n  }\n}"
  },
  {
    "function_name": "reject",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "242-245",
    "snippet": "void SendCoinsDialog::reject()\n{\n    clear();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear",
          "args": [],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "228-240",
          "snippet": "void SendCoinsDialog::clear()\n{\n    // Remove entries until only one left\n    while(ui->entries->count())\n    {\n        delete ui->entries->takeAt(0)->widget();\n    }\n    addEntry();\n\n    updateRemoveEnabled();\n\n    ui->sendButton->setDefault(true);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::clear()\n  {\n      // Remove entries until only one left\n      while(ui->entries->count())\n      {\n          delete ui->entries->takeAt(0)->widget();\n      }\n      addEntry();\n  \n      updateRemoveEnabled();\n  \n      ui->sendButton->setDefault(true);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::reject()\n  {\n      clear();\n  }\n}"
  },
  {
    "function_name": "clear",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "228-240",
    "snippet": "void SendCoinsDialog::clear()\n{\n    // Remove entries until only one left\n    while(ui->entries->count())\n    {\n        delete ui->entries->takeAt(0)->widget();\n    }\n    addEntry();\n\n    updateRemoveEnabled();\n\n    ui->sendButton->setDefault(true);\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->sendButton->setDefault",
          "args": [
            "true"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "updateRemoveEnabled",
          "args": [],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "updateRemoveEnabled",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "273-287",
          "snippet": "void SendCoinsDialog::updateRemoveEnabled()\n{\n    // Remove buttons are enabled as soon as there is more than one send-entry\n    bool enabled = (ui->entries->count() > 1);\n    for(int i = 0; i < ui->entries->count(); ++i)\n    {\n        SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n        if(entry)\n        {\n            entry->setRemoveEnabled(enabled);\n        }\n    }\n    setupTabChain(0);\n    coinControlUpdateLabels();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::updateRemoveEnabled()\n  {\n      // Remove buttons are enabled as soon as there is more than one send-entry\n      bool enabled = (ui->entries->count() > 1);\n      for(int i = 0; i < ui->entries->count(); ++i)\n      {\n          SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n          if(entry)\n          {\n              entry->setRemoveEnabled(enabled);\n          }\n      }\n      setupTabChain(0);\n      coinControlUpdateLabels();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "addEntry",
          "args": [],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->takeAt",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->takeAt",
          "args": [
            "0"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->count",
          "args": [],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::clear()\n  {\n      // Remove entries until only one left\n      while(ui->entries->count())\n      {\n          delete ui->entries->takeAt(0)->widget();\n      }\n      addEntry();\n  \n      updateRemoveEnabled();\n  \n      ui->sendButton->setDefault(true);\n  }\n}"
  },
  {
    "function_name": "on_sendButton_clicked",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "115-226",
    "snippet": "void SendCoinsDialog::on_sendButton_clicked()\n{\n    QList<SendCoinsRecipient> recipients;\n    bool valid = true;\n\n    if(!model)\n        return;\n\n    for(int i = 0; i < ui->entries->count(); ++i)\n    {\n        SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n        if(entry)\n        {\n            if(entry->validate())\n            {\n                recipients.append(entry->getValue());\n            }\n            else\n            {\n                valid = false;\n            }\n        }\n    }\n\n    if(!valid || recipients.isEmpty())\n    {\n        return;\n    }\n\n    // Format confirmation message\n    QStringList formatted;\n    foreach(const SendCoinsRecipient &rcp, recipients)\n    {\n        formatted.append(tr(\"<b>%1</b> to %2 (%3)\").arg(BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, rcp.amount), Qt::escape(rcp.label), rcp.address));\n    }\n\n    fNewRecipientAllowed = false;\n\n    QMessageBox::StandardButton retval = QMessageBox::question(this, tr(\"Confirm send coins\"),\n                          tr(\"Are you sure you want to send %1?\").arg(formatted.join(tr(\" and \"))),\n          QMessageBox::Yes|QMessageBox::Cancel,\n          QMessageBox::Cancel);\n\n    if(retval != QMessageBox::Yes)\n    {\n        fNewRecipientAllowed = true;\n        return;\n    }\n\n    WalletModel::UnlockContext ctx(model->requestUnlock());\n    if(!ctx.isValid())\n    {\n        // Unlock wallet was cancelled\n        fNewRecipientAllowed = true;\n        return;\n    }\n\n    WalletModel::SendCoinsReturn sendstatus;\n\n    if (!model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n        sendstatus = model->sendCoins(recipients);\n    else\n        sendstatus = model->sendCoins(recipients, CoinControlDialog::coinControl);\n\n    switch(sendstatus.status)\n    {\n    case WalletModel::InvalidAddress:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"The recipient address is not valid, please recheck.\"),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::InvalidAmount:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"The amount to pay must be larger than 0.\"),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::AmountExceedsBalance:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"The amount exceeds your balance.\"),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::AmountWithFeeExceedsBalance:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"The total exceeds your balance when the %1 transaction fee is included.\").\n            arg(BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, sendstatus.fee)),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::DuplicateAddress:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"Duplicate address found, can only send to each address once per send operation.\"),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::TransactionCreationFailed:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"Error: Transaction creation failed.\"),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::TransactionCommitFailed:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"Error: The transaction was rejected. This might happen if some of the coins in your wallet were already spent, such as if you used a copy of wallet.dat and coins were spent in the copy but not marked as spent here.\"),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::Aborted: // User aborted, nothing to do\n        break;\n    case WalletModel::OK:\n        accept();\n        CoinControlDialog::coinControl->UnSelectAll();\n        coinControlUpdateLabels();\n        break;\n    }\n    fNewRecipientAllowed = true;\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "coinControlUpdateLabels",
          "args": [],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlUpdateLabels",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "490-520",
          "snippet": "void SendCoinsDialog::coinControlUpdateLabels()\n{\n    if (!model || !model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n        return;\n\n    // set pay amounts\n    CoinControlDialog::payAmounts.clear();\n    for(int i = 0; i < ui->entries->count(); ++i)\n    {\n        SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n        if(entry)\n            CoinControlDialog::payAmounts.append(entry->getValue().amount);\n    }\n\n    if (CoinControlDialog::coinControl->HasSelected())\n    {\n        // actual coin control calculation\n        CoinControlDialog::updateLabels(model, this);\n\n        // show coin control stats\n        ui->labelCoinControlAutomaticallySelected->hide();\n        ui->widgetCoinControl->show();\n    }\n    else\n    {\n        // hide coin control stats\n        ui->labelCoinControlAutomaticallySelected->show();\n        ui->widgetCoinControl->hide();\n        ui->labelCoinControlInsuffFunds->hide();\n    }\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlUpdateLabels()\n  {\n      if (!model || !model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n          return;\n  \n      // set pay amounts\n      CoinControlDialog::payAmounts.clear();\n      for(int i = 0; i < ui->entries->count(); ++i)\n      {\n          SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n          if(entry)\n              CoinControlDialog::payAmounts.append(entry->getValue().amount);\n      }\n  \n      if (CoinControlDialog::coinControl->HasSelected())\n      {\n          // actual coin control calculation\n          CoinControlDialog::updateLabels(model, this);\n  \n          // show coin control stats\n          ui->labelCoinControlAutomaticallySelected->hide();\n          ui->widgetCoinControl->show();\n      }\n      else\n      {\n          // hide coin control stats\n          ui->labelCoinControlAutomaticallySelected->show();\n          ui->widgetCoinControl->hide();\n          ui->labelCoinControlInsuffFunds->hide();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CoinControlDialog::coinControl->UnSelectAll",
          "args": [],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "UnSelectAll",
          "container": "CCoinControl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/coincontrol.h",
          "lines": "42-45",
          "snippet": "void UnSelectAll()\n    {\n        setSelected.clear();\n    }",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "CCoinControl {\n  void UnSelectAll()\n      {\n          setSelected.clear();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "accept",
          "args": [],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "accept",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "247-250",
          "snippet": "void SendCoinsDialog::accept()\n{\n    clear();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::accept()\n  {\n      clear();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QMessageBox::warning",
          "args": [
            "this",
            "tr(\"Send Coins\")",
            "tr(\"Error: The transaction was rejected. This might happen if some of the coins in your wallet were already spent, such as if you used a copy of wallet.dat and coins were spent in the copy but not marked as spent here.\")",
            "QMessageBox::Ok",
            "QMessageBox::Ok"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Error: The transaction was rejected. This might happen if some of the coins in your wallet were already spent, such as if you used a copy of wallet.dat and coins were spent in the copy but not marked as spent here.\""
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlChangeEdited",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "452-487",
          "snippet": "void SendCoinsDialog::coinControlChangeEdited(const QString & text)\n{\n    if (model)\n    {\n        CoinControlDialog::coinControl->destChange = CBitcoinAddress(text.toStdString()).Get();\n\n        // label for the change address\n        ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:black;}\");\n        if (text.isEmpty())\n            ui->labelCoinControlChangeLabel->setText(\"\");\n        else if (!CBitcoinAddress(text.toStdString()).IsValid())\n        {\n            ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n            ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: Invalid Halcyon address\"));\n        }\n        else\n        {\n            QString associatedLabel = model->getAddressTableModel()->labelForAddress(text);\n            if (!associatedLabel.isEmpty())\n                ui->labelCoinControlChangeLabel->setText(associatedLabel);\n            else\n            {\n                CPubKey pubkey;\n                CKeyID keyid;\n                CBitcoinAddress(text.toStdString()).GetKeyID(keyid);   \n                if (model->getPubKey(keyid, pubkey))\n                    ui->labelCoinControlChangeLabel->setText(tr(\"(no label)\"));\n                else\n                {\n                    ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n                    ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: unknown change address\"));\n                }\n            }\n        }\n    }\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlChangeEdited(const QString & text)\n  {\n      if (model)\n      {\n          CoinControlDialog::coinControl->destChange = CBitcoinAddress(text.toStdString()).Get();\n  \n          // label for the change address\n          ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:black;}\");\n          if (text.isEmpty())\n              ui->labelCoinControlChangeLabel->setText(\"\");\n          else if (!CBitcoinAddress(text.toStdString()).IsValid())\n          {\n              ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n              ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: Invalid Halcyon address\"));\n          }\n          else\n          {\n              QString associatedLabel = model->getAddressTableModel()->labelForAddress(text);\n              if (!associatedLabel.isEmpty())\n                  ui->labelCoinControlChangeLabel->setText(associatedLabel);\n              else\n              {\n                  CPubKey pubkey;\n                  CKeyID keyid;\n                  CBitcoinAddress(text.toStdString()).GetKeyID(keyid);   \n                  if (model->getPubKey(keyid, pubkey))\n                      ui->labelCoinControlChangeLabel->setText(tr(\"(no label)\"));\n                  else\n                  {\n                      ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n                      ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: unknown change address\"));\n                  }\n              }\n          }\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QMessageBox::warning",
          "args": [
            "this",
            "tr(\"Send Coins\")",
            "tr(\"Error: Transaction creation failed.\")",
            "QMessageBox::Ok",
            "QMessageBox::Ok"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QMessageBox::warning",
          "args": [
            "this",
            "tr(\"Send Coins\")",
            "tr(\"Duplicate address found, can only send to each address once per send operation.\")",
            "QMessageBox::Ok",
            "QMessageBox::Ok"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QMessageBox::warning",
          "args": [
            "this",
            "tr(\"Send Coins\")",
            "tr(\"The total exceeds your balance when the %1 transaction fee is included.\").\n            arg(BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, sendstatus.fee))",
            "QMessageBox::Ok",
            "QMessageBox::Ok"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "BitcoinUnits::BTC",
            "sendstatus.fee"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QMessageBox::warning",
          "args": [
            "this",
            "tr(\"Send Coins\")",
            "tr(\"The amount exceeds your balance.\")",
            "QMessageBox::Ok",
            "QMessageBox::Ok"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QMessageBox::warning",
          "args": [
            "this",
            "tr(\"Send Coins\")",
            "tr(\"The amount to pay must be larger than 0.\")",
            "QMessageBox::Ok",
            "QMessageBox::Ok"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QMessageBox::warning",
          "args": [
            "this",
            "tr(\"Send Coins\")",
            "tr(\"The recipient address is not valid, please recheck.\")",
            "QMessageBox::Ok",
            "QMessageBox::Ok"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->sendCoins",
          "args": [
            "recipients",
            "CoinControlDialog::coinControl"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "sendCoins",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "132-237",
          "snippet": "WalletModel::SendCoinsReturn WalletModel::sendCoins(const QList<SendCoinsRecipient> &recipients, const CCoinControl *coinControl)\n{\n    qint64 total = 0;\n    QSet<QString> setAddress;\n    QString hex;\n\n    if(recipients.empty())\n    {\n        return OK;\n    }\n\n    // Pre-check input data for validity\n    foreach(const SendCoinsRecipient &rcp, recipients)\n    {\n        if(!validateAddress(rcp.address))\n        {\n            return InvalidAddress;\n        }\n        setAddress.insert(rcp.address);\n\n        if(rcp.amount <= 0)\n        {\n            return InvalidAmount;\n        }\n        total += rcp.amount;\n    }\n\n    if(recipients.size() > setAddress.size())\n    {\n        return DuplicateAddress;\n    }\n\n    int64_t nBalance = 0;\n    std::vector<COutput> vCoins;\n    wallet->AvailableCoins(vCoins, true, coinControl);\n\n    BOOST_FOREACH(const COutput& out, vCoins)\n        nBalance += out.tx->vout[out.i].nValue;\n\n    if(total > nBalance)\n    {\n        return AmountExceedsBalance;\n    }\n\n    if((total + nTransactionFee) > nBalance)\n    {\n        return SendCoinsReturn(AmountWithFeeExceedsBalance, nTransactionFee);\n    }\n\n    {\n        LOCK2(cs_main, wallet->cs_wallet);\n\n        // Sendmany\n        std::vector<std::pair<CScript, int64_t> > vecSend;\n        foreach(const SendCoinsRecipient &rcp, recipients)\n        {\n            CScript scriptPubKey;\n            scriptPubKey.SetDestination(CBitcoinAddress(rcp.address.toStdString()).Get());\n            vecSend.push_back(make_pair(scriptPubKey, rcp.amount));\n        }\n\n        CWalletTx wtx;\n        CReserveKey keyChange(wallet);\n        int64_t nFeeRequired = 0;\n        bool fCreated = wallet->CreateTransaction(vecSend, wtx, keyChange, nFeeRequired, coinControl);\n\n        if(!fCreated)\n        {\n            if((total + nFeeRequired) > nBalance) // FIXME: could cause collisions in the future\n            {\n                return SendCoinsReturn(AmountWithFeeExceedsBalance, nFeeRequired);\n            }\n            return TransactionCreationFailed;\n        }\n        if(!uiInterface.ThreadSafeAskFee(nFeeRequired, tr(\"Sending...\").toStdString()))\n        {\n            return Aborted;\n        }\n        if(!wallet->CommitTransaction(wtx, keyChange))\n        {\n            return TransactionCommitFailed;\n        }\n        hex = QString::fromStdString(wtx.GetHash().GetHex());\n    }\n\n    // Add addresses / update labels that we've sent to to the address book\n    foreach(const SendCoinsRecipient &rcp, recipients)\n    {\n        std::string strAddress = rcp.address.toStdString();\n        CTxDestination dest = CBitcoinAddress(strAddress).Get();\n        std::string strLabel = rcp.label.toStdString();\n        {\n            LOCK(wallet->cs_wallet);\n\n            std::map<CTxDestination, std::string>::iterator mi = wallet->mapAddressBook.find(dest);\n\n            // Check if we have a new address or an updated label\n            if (mi == wallet->mapAddressBook.end() || mi->second != strLabel)\n            {\n                wallet->SetAddressBookName(dest, strLabel);\n            }\n        }\n    }\n\n    return SendCoinsReturn(OK, 0, hex);\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  WalletModel::SendCoinsReturn WalletModel::sendCoins(const QList<SendCoinsRecipient> &recipients, const CCoinControl *coinControl)\n  {\n      qint64 total = 0;\n      QSet<QString> setAddress;\n      QString hex;\n  \n      if(recipients.empty())\n      {\n          return OK;\n      }\n  \n      // Pre-check input data for validity\n      foreach(const SendCoinsRecipient &rcp, recipients)\n      {\n          if(!validateAddress(rcp.address))\n          {\n              return InvalidAddress;\n          }\n          setAddress.insert(rcp.address);\n  \n          if(rcp.amount <= 0)\n          {\n              return InvalidAmount;\n          }\n          total += rcp.amount;\n      }\n  \n      if(recipients.size() > setAddress.size())\n      {\n          return DuplicateAddress;\n      }\n  \n      int64_t nBalance = 0;\n      std::vector<COutput> vCoins;\n      wallet->AvailableCoins(vCoins, true, coinControl);\n  \n      BOOST_FOREACH(const COutput& out, vCoins)\n          nBalance += out.tx->vout[out.i].nValue;\n  \n      if(total > nBalance)\n      {\n          return AmountExceedsBalance;\n      }\n  \n      if((total + nTransactionFee) > nBalance)\n      {\n          return SendCoinsReturn(AmountWithFeeExceedsBalance, nTransactionFee);\n      }\n  \n      {\n          LOCK2(cs_main, wallet->cs_wallet);\n  \n          // Sendmany\n          std::vector<std::pair<CScript, int64_t> > vecSend;\n          foreach(const SendCoinsRecipient &rcp, recipients)\n          {\n              CScript scriptPubKey;\n              scriptPubKey.SetDestination(CBitcoinAddress(rcp.address.toStdString()).Get());\n              vecSend.push_back(make_pair(scriptPubKey, rcp.amount));\n          }\n  \n          CWalletTx wtx;\n          CReserveKey keyChange(wallet);\n          int64_t nFeeRequired = 0;\n          bool fCreated = wallet->CreateTransaction(vecSend, wtx, keyChange, nFeeRequired, coinControl);\n  \n          if(!fCreated)\n          {\n              if((total + nFeeRequired) > nBalance) // FIXME: could cause collisions in the future\n              {\n                  return SendCoinsReturn(AmountWithFeeExceedsBalance, nFeeRequired);\n              }\n              return TransactionCreationFailed;\n          }\n          if(!uiInterface.ThreadSafeAskFee(nFeeRequired, tr(\"Sending...\").toStdString()))\n          {\n              return Aborted;\n          }\n          if(!wallet->CommitTransaction(wtx, keyChange))\n          {\n              return TransactionCommitFailed;\n          }\n          hex = QString::fromStdString(wtx.GetHash().GetHex());\n      }\n  \n      // Add addresses / update labels that we've sent to to the address book\n      foreach(const SendCoinsRecipient &rcp, recipients)\n      {\n          std::string strAddress = rcp.address.toStdString();\n          CTxDestination dest = CBitcoinAddress(strAddress).Get();\n          std::string strLabel = rcp.label.toStdString();\n          {\n              LOCK(wallet->cs_wallet);\n  \n              std::map<CTxDestination, std::string>::iterator mi = wallet->mapAddressBook.find(dest);\n  \n              // Check if we have a new address or an updated label\n              if (mi == wallet->mapAddressBook.end() || mi->second != strLabel)\n              {\n                  wallet->SetAddressBookName(dest, strLabel);\n              }\n          }\n      }\n  \n      return SendCoinsReturn(OK, 0, hex);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->sendCoins",
          "args": [
            "recipients"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ctx.isValid",
          "args": [],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "WalletModel::UnlockContext",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.h",
          "lines": "106-106",
          "snippet": "bool isValid() const { return valid; }",
          "includes": [
            "#include \"allocators.h\" /* for SecureString */",
            "#include <map>",
            "#include <vector>",
            "#include <QObject>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"allocators.h\" /* for SecureString */\n#include <map>\n#include <vector>\n#include <QObject>\n\nWalletModel {\n  UnlockContext {\n    bool isValid() const { return valid; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->requestUnlock",
          "args": [],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "requestUnlock",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "364-383",
          "snippet": "WalletModel::UnlockContext WalletModel::requestUnlock()\n{\n    bool was_locked = getEncryptionStatus() == Locked;\n    \n    if ((!was_locked) && fWalletUnlockStakingOnly)\n    {\n       setWalletLocked(true);\n       was_locked = getEncryptionStatus() == Locked;\n\n    }\n    if(was_locked)\n    {\n        // Request UI to unlock wallet\n        emit requireUnlock();\n    }\n    // If wallet is still locked, unlock was failed or cancelled, mark context as invalid\n    bool valid = getEncryptionStatus() != Locked;\n\n    return UnlockContext(this, valid, was_locked && !fWalletUnlockStakingOnly);\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  WalletModel::UnlockContext WalletModel::requestUnlock()\n  {\n      bool was_locked = getEncryptionStatus() == Locked;\n      \n      if ((!was_locked) && fWalletUnlockStakingOnly)\n      {\n         setWalletLocked(true);\n         was_locked = getEncryptionStatus() == Locked;\n  \n      }\n      if(was_locked)\n      {\n          // Request UI to unlock wallet\n          emit requireUnlock();\n      }\n      // If wallet is still locked, unlock was failed or cancelled, mark context as invalid\n      bool valid = getEncryptionStatus() != Locked;\n  \n      return UnlockContext(this, valid, was_locked && !fWalletUnlockStakingOnly);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QMessageBox::question",
          "args": [
            "this",
            "tr(\"Confirm send coins\")",
            "tr(\"Are you sure you want to send %1?\").arg(formatted.join(tr(\" and \")))",
            "QMessageBox::Yes|QMessageBox::Cancel",
            "QMessageBox::Cancel"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "formatted.join",
          "args": [
            "tr(\" and \")"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "formatted.append",
          "args": [
            "tr(\"<b>%1</b> to %2 (%3)\").arg(BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, rcp.amount), Qt::escape(rcp.label), rcp.address)"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, rcp.amount)",
            "Qt::escape(rcp.label)",
            "rcp.address"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "copyEntryData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "153-164",
          "snippet": "void copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Qt::escape",
          "args": [
            "rcp.label"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "BitcoinUnits::BTC",
            "rcp.amount"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "recipients.isEmpty",
          "args": [],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "recipients.append",
          "args": [
            "entry->getValue()"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entry->getValue",
          "args": [],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "getValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "129-138",
          "snippet": "SendCoinsRecipient SendCoinsEntry::getValue()\n{\n    SendCoinsRecipient rv;\n\n    rv.address = ui->payTo->text();\n    rv.label = ui->addAsLabel->text();\n    rv.amount = ui->payAmount->value();\n\n    return rv;\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  SendCoinsRecipient SendCoinsEntry::getValue()\n  {\n      SendCoinsRecipient rv;\n  \n      rv.address = ui->payTo->text();\n      rv.label = ui->addAsLabel->text();\n      rv.amount = ui->payAmount->value();\n  \n      return rv;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "entry->validate",
          "args": [],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "validate",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "100-127",
          "snippet": "bool SendCoinsEntry::validate()\n{\n    // Check input validity\n    bool retval = true;\n\n    if(!ui->payAmount->validate())\n    {\n        retval = false;\n    }\n    else\n    {\n        if(ui->payAmount->value() <= 0)\n        {\n            // Cannot send 0 coins or less\n            ui->payAmount->setValid(false);\n            retval = false;\n        }\n    }\n\n    if(!ui->payTo->hasAcceptableInput() ||\n       (model && !model->validateAddress(ui->payTo->text())))\n    {\n        ui->payTo->setValid(false);\n        retval = false;\n    }\n\n    return retval;\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  bool SendCoinsEntry::validate()\n  {\n      // Check input validity\n      bool retval = true;\n  \n      if(!ui->payAmount->validate())\n      {\n          retval = false;\n      }\n      else\n      {\n          if(ui->payAmount->value() <= 0)\n          {\n              // Cannot send 0 coins or less\n              ui->payAmount->setValid(false);\n              retval = false;\n          }\n      }\n  \n      if(!ui->payTo->hasAcceptableInput() ||\n         (model && !model->validateAddress(ui->payTo->text())))\n      {\n          ui->payTo->setValid(false);\n          retval = false;\n      }\n  \n      return retval;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "qobject_cast<SendCoinsEntry*>",
          "args": [
            "ui->entries->itemAt(i)->widget()"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->itemAt",
          "args": [],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->itemAt",
          "args": [
            "i"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->count",
          "args": [],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::on_sendButton_clicked()\n  {\n      QList<SendCoinsRecipient> recipients;\n      bool valid = true;\n  \n      if(!model)\n          return;\n  \n      for(int i = 0; i < ui->entries->count(); ++i)\n      {\n          SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n          if(entry)\n          {\n              if(entry->validate())\n              {\n                  recipients.append(entry->getValue());\n              }\n              else\n              {\n                  valid = false;\n              }\n          }\n      }\n  \n      if(!valid || recipients.isEmpty())\n      {\n          return;\n      }\n  \n      // Format confirmation message\n      QStringList formatted;\n      foreach(const SendCoinsRecipient &rcp, recipients)\n      {\n          formatted.append(tr(\"<b>%1</b> to %2 (%3)\").arg(BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, rcp.amount), Qt::escape(rcp.label), rcp.address));\n      }\n  \n      fNewRecipientAllowed = false;\n  \n      QMessageBox::StandardButton retval = QMessageBox::question(this, tr(\"Confirm send coins\"),\n                            tr(\"Are you sure you want to send %1?\").arg(formatted.join(tr(\" and \"))),\n            QMessageBox::Yes|QMessageBox::Cancel,\n            QMessageBox::Cancel);\n  \n      if(retval != QMessageBox::Yes)\n      {\n          fNewRecipientAllowed = true;\n          return;\n      }\n  \n      WalletModel::UnlockContext ctx(model->requestUnlock());\n      if(!ctx.isValid())\n      {\n          // Unlock wallet was cancelled\n          fNewRecipientAllowed = true;\n          return;\n      }\n  \n      WalletModel::SendCoinsReturn sendstatus;\n  \n      if (!model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n          sendstatus = model->sendCoins(recipients);\n      else\n          sendstatus = model->sendCoins(recipients, CoinControlDialog::coinControl);\n  \n      switch(sendstatus.status)\n      {\n      case WalletModel::InvalidAddress:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"The recipient address is not valid, please recheck.\"),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::InvalidAmount:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"The amount to pay must be larger than 0.\"),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::AmountExceedsBalance:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"The amount exceeds your balance.\"),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::AmountWithFeeExceedsBalance:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"The total exceeds your balance when the %1 transaction fee is included.\").\n              arg(BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, sendstatus.fee)),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::DuplicateAddress:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"Duplicate address found, can only send to each address once per send operation.\"),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::TransactionCreationFailed:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"Error: Transaction creation failed.\"),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::TransactionCommitFailed:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"Error: The transaction was rejected. This might happen if some of the coins in your wallet were already spent, such as if you used a copy of wallet.dat and coins were spent in the copy but not marked as spent here.\"),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::Aborted: // User aborted, nothing to do\n          break;\n      case WalletModel::OK:\n          accept();\n          CoinControlDialog::coinControl->UnSelectAll();\n          coinControlUpdateLabels();\n          break;\n      }\n      fNewRecipientAllowed = true;\n  }\n}"
  },
  {
    "function_name": "~SendCoinsDialog",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "110-113",
    "snippet": "SendCoinsDialog::~SendCoinsDialog()\n{\n    delete ui;\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  SendCoinsDialog::~SendCoinsDialog()\n  {\n      delete ui;\n  }\n}"
  },
  {
    "function_name": "setModel",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "83-108",
    "snippet": "void SendCoinsDialog::setModel(WalletModel *model)\n{\n    this->model = model;\n\n    for(int i = 0; i < ui->entries->count(); ++i)\n    {\n        SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n        if(entry)\n        {\n            entry->setModel(model);\n        }\n    }\n    if(model && model->getOptionsModel())\n    {\n        setBalance(model->getBalance(), model->getStake(), model->getUnconfirmedBalance(), model->getImmatureBalance());\n        connect(model, SIGNAL(balanceChanged(qint64, qint64, qint64, qint64)), this, SLOT(setBalance(qint64, qint64, qint64, qint64)));\n        connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n\n        // Coin Control\n        connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(coinControlUpdateLabels()));\n        connect(model->getOptionsModel(), SIGNAL(coinControlFeaturesChanged(bool)), this, SLOT(coinControlFeatureChanged(bool)));\n        connect(model->getOptionsModel(), SIGNAL(transactionFeeChanged(qint64)), this, SLOT(coinControlUpdateLabels()));\n        ui->frameCoinControl->setVisible(model->getOptionsModel()->getCoinControlFeatures());\n        coinControlUpdateLabels();\n    }\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "coinControlUpdateLabels",
          "args": [],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlUpdateLabels",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "490-520",
          "snippet": "void SendCoinsDialog::coinControlUpdateLabels()\n{\n    if (!model || !model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n        return;\n\n    // set pay amounts\n    CoinControlDialog::payAmounts.clear();\n    for(int i = 0; i < ui->entries->count(); ++i)\n    {\n        SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n        if(entry)\n            CoinControlDialog::payAmounts.append(entry->getValue().amount);\n    }\n\n    if (CoinControlDialog::coinControl->HasSelected())\n    {\n        // actual coin control calculation\n        CoinControlDialog::updateLabels(model, this);\n\n        // show coin control stats\n        ui->labelCoinControlAutomaticallySelected->hide();\n        ui->widgetCoinControl->show();\n    }\n    else\n    {\n        // hide coin control stats\n        ui->labelCoinControlAutomaticallySelected->show();\n        ui->widgetCoinControl->hide();\n        ui->labelCoinControlInsuffFunds->hide();\n    }\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlUpdateLabels()\n  {\n      if (!model || !model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n          return;\n  \n      // set pay amounts\n      CoinControlDialog::payAmounts.clear();\n      for(int i = 0; i < ui->entries->count(); ++i)\n      {\n          SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n          if(entry)\n              CoinControlDialog::payAmounts.append(entry->getValue().amount);\n      }\n  \n      if (CoinControlDialog::coinControl->HasSelected())\n      {\n          // actual coin control calculation\n          CoinControlDialog::updateLabels(model, this);\n  \n          // show coin control stats\n          ui->labelCoinControlAutomaticallySelected->hide();\n          ui->widgetCoinControl->show();\n      }\n      else\n      {\n          // hide coin control stats\n          ui->labelCoinControlAutomaticallySelected->show();\n          ui->widgetCoinControl->hide();\n          ui->labelCoinControlInsuffFunds->hide();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->frameCoinControl->setVisible",
          "args": [
            "model->getOptionsModel()->getCoinControlFeatures()"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "model->getOptionsModel()",
            "SIGNAL(transactionFeeChanged(qint64))",
            "this",
            "SLOT(coinControlUpdateLabels())"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlUpdateLabels()"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "transactionFeeChanged(qint64)"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "transactionFeeChanged",
          "args": [
            "qint64"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "model->getOptionsModel()",
            "SIGNAL(coinControlFeaturesChanged(bool))",
            "this",
            "SLOT(coinControlFeatureChanged(bool))"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlFeatureChanged(bool)"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControlFeatureChanged",
          "args": [
            "bool"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlFeatureChanged",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "419-425",
          "snippet": "void SendCoinsDialog::coinControlFeatureChanged(bool checked)\n{\n    ui->frameCoinControl->setVisible(checked);\n\n    if (!checked && model) // coin control features disabled\n        CoinControlDialog::coinControl->SetNull();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlFeatureChanged(bool checked)\n  {\n      ui->frameCoinControl->setVisible(checked);\n  \n      if (!checked && model) // coin control features disabled\n          CoinControlDialog::coinControl->SetNull();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "coinControlFeaturesChanged(bool)"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControlFeaturesChanged",
          "args": [
            "bool"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "model->getOptionsModel()",
            "SIGNAL(displayUnitChanged(int))",
            "this",
            "SLOT(coinControlUpdateLabels())"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlUpdateLabels()"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "displayUnitChanged(int)"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "displayUnitChanged",
          "args": [
            "int"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "model->getOptionsModel()",
            "SIGNAL(displayUnitChanged(int))",
            "this",
            "SLOT(updateDisplayUnit())"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "updateDisplayUnit()"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "updateDisplayUnit",
          "args": [],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "updateDisplayUnit",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "361-368",
          "snippet": "void SendCoinsDialog::updateDisplayUnit()\n{\n    if(model && model->getOptionsModel())\n    {\n        // Update labelBalance with the current balance and the current unit\n        ui->labelBalance->setText(BitcoinUnits::formatWithUnit(model->getOptionsModel()->getDisplayUnit(), model->getBalance()));\n    }\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::updateDisplayUnit()\n  {\n      if(model && model->getOptionsModel())\n      {\n          // Update labelBalance with the current balance and the current unit\n          ui->labelBalance->setText(BitcoinUnits::formatWithUnit(model->getOptionsModel()->getDisplayUnit(), model->getBalance()));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "displayUnitChanged(int)"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "displayUnitChanged",
          "args": [
            "int"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "model",
            "SIGNAL(balanceChanged(qint64, qint64, qint64, qint64))",
            "this",
            "SLOT(setBalance(qint64, qint64, qint64, qint64))"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "setBalance(qint64, qint64, qint64, qint64)"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setBalance",
          "args": [
            "qint64",
            "qint64",
            "qint64",
            "qint64"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "setBalance",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "349-359",
          "snippet": "void SendCoinsDialog::setBalance(qint64 balance, qint64 stake, qint64 unconfirmedBalance, qint64 immatureBalance)\n{\n    Q_UNUSED(stake);\n    Q_UNUSED(unconfirmedBalance);\n    Q_UNUSED(immatureBalance);\n    if(!model || !model->getOptionsModel())\n        return;\n\n    int unit = model->getOptionsModel()->getDisplayUnit();\n    ui->labelBalance->setText(BitcoinUnits::formatWithUnit(unit, balance));\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::setBalance(qint64 balance, qint64 stake, qint64 unconfirmedBalance, qint64 immatureBalance)\n  {\n      Q_UNUSED(stake);\n      Q_UNUSED(unconfirmedBalance);\n      Q_UNUSED(immatureBalance);\n      if(!model || !model->getOptionsModel())\n          return;\n  \n      int unit = model->getOptionsModel()->getDisplayUnit();\n      ui->labelBalance->setText(BitcoinUnits::formatWithUnit(unit, balance));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "balanceChanged(qint64, qint64, qint64, qint64)"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "balanceChanged",
          "args": [
            "qint64",
            "qint64",
            "qint64",
            "qint64"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getImmatureBalance",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "getImmatureBalance",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "54-57",
          "snippet": "qint64 WalletModel::getImmatureBalance() const\n{\n    return wallet->GetImmatureBalance();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  qint64 WalletModel::getImmatureBalance() const\n  {\n      return wallet->GetImmatureBalance();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getUnconfirmedBalance",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "getUnconfirmedBalance",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "44-47",
          "snippet": "qint64 WalletModel::getUnconfirmedBalance() const\n{\n    return wallet->GetUnconfirmedBalance();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  qint64 WalletModel::getUnconfirmedBalance() const\n  {\n      return wallet->GetUnconfirmedBalance();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getStake",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "getStake",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "49-52",
          "snippet": "qint64 WalletModel::getStake() const\n{\n    return wallet->GetStake();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  qint64 WalletModel::getStake() const\n  {\n      return wallet->GetStake();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getBalance",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "getBalance",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "39-42",
          "snippet": "qint64 WalletModel::getBalance() const\n{\n    return wallet->GetBalance();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  qint64 WalletModel::getBalance() const\n  {\n      return wallet->GetBalance();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entry->setModel",
          "args": [
            "model"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "83-108",
          "snippet": "void SendCoinsDialog::setModel(WalletModel *model)\n{\n    this->model = model;\n\n    for(int i = 0; i < ui->entries->count(); ++i)\n    {\n        SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n        if(entry)\n        {\n            entry->setModel(model);\n        }\n    }\n    if(model && model->getOptionsModel())\n    {\n        setBalance(model->getBalance(), model->getStake(), model->getUnconfirmedBalance(), model->getImmatureBalance());\n        connect(model, SIGNAL(balanceChanged(qint64, qint64, qint64, qint64)), this, SLOT(setBalance(qint64, qint64, qint64, qint64)));\n        connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n\n        // Coin Control\n        connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(coinControlUpdateLabels()));\n        connect(model->getOptionsModel(), SIGNAL(coinControlFeaturesChanged(bool)), this, SLOT(coinControlFeatureChanged(bool)));\n        connect(model->getOptionsModel(), SIGNAL(transactionFeeChanged(qint64)), this, SLOT(coinControlUpdateLabels()));\n        ui->frameCoinControl->setVisible(model->getOptionsModel()->getCoinControlFeatures());\n        coinControlUpdateLabels();\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "qobject_cast<SendCoinsEntry*>",
          "args": [
            "ui->entries->itemAt(i)->widget()"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->itemAt",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->itemAt",
          "args": [
            "i"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->entries->count",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::setModel(WalletModel *model)\n  {\n      this->model = model;\n  \n      for(int i = 0; i < ui->entries->count(); ++i)\n      {\n          SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n          if(entry)\n          {\n              entry->setModel(model);\n          }\n      }\n      if(model && model->getOptionsModel())\n      {\n          setBalance(model->getBalance(), model->getStake(), model->getUnconfirmedBalance(), model->getImmatureBalance());\n          connect(model, SIGNAL(balanceChanged(qint64, qint64, qint64, qint64)), this, SLOT(setBalance(qint64, qint64, qint64, qint64)));\n          connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n  \n          // Coin Control\n          connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(coinControlUpdateLabels()));\n          connect(model->getOptionsModel(), SIGNAL(coinControlFeaturesChanged(bool)), this, SLOT(coinControlFeatureChanged(bool)));\n          connect(model->getOptionsModel(), SIGNAL(transactionFeeChanged(qint64)), this, SLOT(coinControlUpdateLabels()));\n          ui->frameCoinControl->setVisible(model->getOptionsModel()->getCoinControlFeatures());\n          coinControlUpdateLabels();\n      }\n  }\n}"
  },
  {
    "function_name": "SendCoinsDialog",
    "container": "SendCoinsDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
    "lines": "25-81",
    "snippet": "SendCoinsDialog::SendCoinsDialog(QWidget *parent) :\n    QDialog(parent),\n    ui(new Ui::SendCoinsDialog),\n    model(0)\n{\n    ui->setupUi(this);\n\n#ifdef Q_OS_MAC // Icons on push buttons are very uncommon on Mac\n    ui->addButton->setIcon(QIcon());\n    ui->clearButton->setIcon(QIcon());\n    ui->sendButton->setIcon(QIcon());\n#endif\n\n#if QT_VERSION >= 0x040700\n    /* Do not move this to the XML file, Qt before 4.7 will choke on it */\n    ui->lineEditCoinControlChange->setPlaceholderText(tr(\"Enter a Halcyon address (e.g. halcyonfwYhBmGXcFP2Po1NpRUEiK8km2)\"));\n#endif\n\n    addEntry();\n\n    connect(ui->addButton, SIGNAL(clicked()), this, SLOT(addEntry()));\n    connect(ui->clearButton, SIGNAL(clicked()), this, SLOT(clear()));\n\n    // Coin Control\n    ui->lineEditCoinControlChange->setFont(GUIUtil::bitcoinAddressFont());\n    connect(ui->pushButtonCoinControl, SIGNAL(clicked()), this, SLOT(coinControlButtonClicked()));\n    connect(ui->checkBoxCoinControlChange, SIGNAL(stateChanged(int)), this, SLOT(coinControlChangeChecked(int)));\n    connect(ui->lineEditCoinControlChange, SIGNAL(textEdited(const QString &)), this, SLOT(coinControlChangeEdited(const QString &)));\n\n    // Coin Control: clipboard actions\n    QAction *clipboardQuantityAction = new QAction(tr(\"Copy quantity\"), this);\n    QAction *clipboardAmountAction = new QAction(tr(\"Copy amount\"), this);\n    QAction *clipboardFeeAction = new QAction(tr(\"Copy fee\"), this);\n    QAction *clipboardAfterFeeAction = new QAction(tr(\"Copy after fee\"), this);\n    QAction *clipboardBytesAction = new QAction(tr(\"Copy bytes\"), this);\n    QAction *clipboardPriorityAction = new QAction(tr(\"Copy priority\"), this);\n    QAction *clipboardLowOutputAction = new QAction(tr(\"Copy low output\"), this);\n    QAction *clipboardChangeAction = new QAction(tr(\"Copy change\"), this);\n    connect(clipboardQuantityAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardQuantity()));\n    connect(clipboardAmountAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardAmount()));\n    connect(clipboardFeeAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardFee()));\n    connect(clipboardAfterFeeAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardAfterFee()));\n    connect(clipboardBytesAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardBytes()));\n    connect(clipboardPriorityAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardPriority()));\n    connect(clipboardLowOutputAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardLowOutput()));\n    connect(clipboardChangeAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardChange()));\n    ui->labelCoinControlQuantity->addAction(clipboardQuantityAction);\n    ui->labelCoinControlAmount->addAction(clipboardAmountAction);\n    ui->labelCoinControlFee->addAction(clipboardFeeAction);\n    ui->labelCoinControlAfterFee->addAction(clipboardAfterFeeAction);\n    ui->labelCoinControlBytes->addAction(clipboardBytesAction);\n    ui->labelCoinControlPriority->addAction(clipboardPriorityAction);\n    ui->labelCoinControlLowOutput->addAction(clipboardLowOutputAction);\n    ui->labelCoinControlChange->addAction(clipboardChangeAction);\n\n    fNewRecipientAllowed = true;\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QScrollBar>",
      "#include <QTextDocument>",
      "#include <QLocale>",
      "#include <QMessageBox>",
      "#include \"coincontroldialog.h\"",
      "#include \"coincontrol.h\"",
      "#include \"askpassphrasedialog.h\"",
      "#include \"guiutil.h\"",
      "#include \"sendcoinsentry.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"init.h\"",
      "#include \"ui_sendcoinsdialog.h\"",
      "#include \"sendcoinsdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->labelCoinControlChange->addAction",
          "args": [
            "clipboardChangeAction"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlLowOutput->addAction",
          "args": [
            "clipboardLowOutputAction"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlPriority->addAction",
          "args": [
            "clipboardPriorityAction"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlBytes->addAction",
          "args": [
            "clipboardBytesAction"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAfterFee->addAction",
          "args": [
            "clipboardAfterFeeAction"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlFee->addAction",
          "args": [
            "clipboardFeeAction"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAmount->addAction",
          "args": [
            "clipboardAmountAction"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlQuantity->addAction",
          "args": [
            "clipboardQuantityAction"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardChangeAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(coinControlClipboardChange())"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlClipboardChange()"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControlClipboardChange",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlClipboardChange",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "413-416",
          "snippet": "void SendCoinsDialog::coinControlClipboardChange()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlChange->text().left(ui->labelCoinControlChange->text().indexOf(\" \")));\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardChange()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlChange->text().left(ui->labelCoinControlChange->text().indexOf(\" \")));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardLowOutputAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(coinControlClipboardLowOutput())"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlClipboardLowOutput()"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControlClipboardLowOutput",
          "args": [],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlClipboardLowOutput",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "407-410",
          "snippet": "void SendCoinsDialog::coinControlClipboardLowOutput()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlLowOutput->text());\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardLowOutput()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlLowOutput->text());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardPriorityAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(coinControlClipboardPriority())"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlClipboardPriority()"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControlClipboardPriority",
          "args": [],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlClipboardPriority",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "401-404",
          "snippet": "void SendCoinsDialog::coinControlClipboardPriority()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlPriority->text());\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardPriority()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlPriority->text());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardBytesAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(coinControlClipboardBytes())"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlClipboardBytes()"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControlClipboardBytes",
          "args": [],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlClipboardBytes",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "395-398",
          "snippet": "void SendCoinsDialog::coinControlClipboardBytes()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlBytes->text());\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardBytes()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlBytes->text());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardAfterFeeAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(coinControlClipboardAfterFee())"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlClipboardAfterFee()"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControlClipboardAfterFee",
          "args": [],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlClipboardAfterFee",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "389-392",
          "snippet": "void SendCoinsDialog::coinControlClipboardAfterFee()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlAfterFee->text().left(ui->labelCoinControlAfterFee->text().indexOf(\" \")));\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardAfterFee()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlAfterFee->text().left(ui->labelCoinControlAfterFee->text().indexOf(\" \")));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardFeeAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(coinControlClipboardFee())"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlClipboardFee()"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControlClipboardFee",
          "args": [],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlClipboardFee",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "383-386",
          "snippet": "void SendCoinsDialog::coinControlClipboardFee()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlFee->text().left(ui->labelCoinControlFee->text().indexOf(\" \")));\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardFee()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlFee->text().left(ui->labelCoinControlFee->text().indexOf(\" \")));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardAmountAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(coinControlClipboardAmount())"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlClipboardAmount()"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControlClipboardAmount",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlClipboardAmount",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "377-380",
          "snippet": "void SendCoinsDialog::coinControlClipboardAmount()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlAmount->text().left(ui->labelCoinControlAmount->text().indexOf(\" \")));\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardAmount()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlAmount->text().left(ui->labelCoinControlAmount->text().indexOf(\" \")));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardQuantityAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(coinControlClipboardQuantity())"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlClipboardQuantity()"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControlClipboardQuantity",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlClipboardQuantity",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "371-374",
          "snippet": "void SendCoinsDialog::coinControlClipboardQuantity()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlQuantity->text());\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlClipboardQuantity()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlQuantity->text());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Copy change\""
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlChangeEdited",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "452-487",
          "snippet": "void SendCoinsDialog::coinControlChangeEdited(const QString & text)\n{\n    if (model)\n    {\n        CoinControlDialog::coinControl->destChange = CBitcoinAddress(text.toStdString()).Get();\n\n        // label for the change address\n        ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:black;}\");\n        if (text.isEmpty())\n            ui->labelCoinControlChangeLabel->setText(\"\");\n        else if (!CBitcoinAddress(text.toStdString()).IsValid())\n        {\n            ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n            ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: Invalid Halcyon address\"));\n        }\n        else\n        {\n            QString associatedLabel = model->getAddressTableModel()->labelForAddress(text);\n            if (!associatedLabel.isEmpty())\n                ui->labelCoinControlChangeLabel->setText(associatedLabel);\n            else\n            {\n                CPubKey pubkey;\n                CKeyID keyid;\n                CBitcoinAddress(text.toStdString()).GetKeyID(keyid);   \n                if (model->getPubKey(keyid, pubkey))\n                    ui->labelCoinControlChangeLabel->setText(tr(\"(no label)\"));\n                else\n                {\n                    ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n                    ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: unknown change address\"));\n                }\n            }\n        }\n    }\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlChangeEdited(const QString & text)\n  {\n      if (model)\n      {\n          CoinControlDialog::coinControl->destChange = CBitcoinAddress(text.toStdString()).Get();\n  \n          // label for the change address\n          ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:black;}\");\n          if (text.isEmpty())\n              ui->labelCoinControlChangeLabel->setText(\"\");\n          else if (!CBitcoinAddress(text.toStdString()).IsValid())\n          {\n              ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n              ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: Invalid Halcyon address\"));\n          }\n          else\n          {\n              QString associatedLabel = model->getAddressTableModel()->labelForAddress(text);\n              if (!associatedLabel.isEmpty())\n                  ui->labelCoinControlChangeLabel->setText(associatedLabel);\n              else\n              {\n                  CPubKey pubkey;\n                  CKeyID keyid;\n                  CBitcoinAddress(text.toStdString()).GetKeyID(keyid);   \n                  if (model->getPubKey(keyid, pubkey))\n                      ui->labelCoinControlChangeLabel->setText(tr(\"(no label)\"));\n                  else\n                  {\n                      ui->labelCoinControlChangeLabel->setStyleSheet(\"QLabel{color:red;}\");\n                      ui->labelCoinControlChangeLabel->setText(tr(\"WARNING: unknown change address\"));\n                  }\n              }\n          }\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->lineEditCoinControlChange",
            "SIGNAL(textEdited(const QString &))",
            "this",
            "SLOT(coinControlChangeEdited(const QString &))"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlChangeEdited(const QString &)"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "textEdited(const QString &)"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "textEdited",
          "args": [
            "const QString &"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->checkBoxCoinControlChange",
            "SIGNAL(stateChanged(int))",
            "this",
            "SLOT(coinControlChangeChecked(int))"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlChangeChecked(int)"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControlChangeChecked",
          "args": [
            "int"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlChangeChecked",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "437-449",
          "snippet": "void SendCoinsDialog::coinControlChangeChecked(int state)\n{\n    if (model)\n    {\n        if (state == Qt::Checked)\n            CoinControlDialog::coinControl->destChange = CBitcoinAddress(ui->lineEditCoinControlChange->text().toStdString()).Get();\n        else\n            CoinControlDialog::coinControl->destChange = CNoDestination();\n    }\n\n    ui->lineEditCoinControlChange->setEnabled((state == Qt::Checked));\n    ui->labelCoinControlChangeLabel->setEnabled((state == Qt::Checked));\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlChangeChecked(int state)\n  {\n      if (model)\n      {\n          if (state == Qt::Checked)\n              CoinControlDialog::coinControl->destChange = CBitcoinAddress(ui->lineEditCoinControlChange->text().toStdString()).Get();\n          else\n              CoinControlDialog::coinControl->destChange = CNoDestination();\n      }\n  \n      ui->lineEditCoinControlChange->setEnabled((state == Qt::Checked));\n      ui->labelCoinControlChangeLabel->setEnabled((state == Qt::Checked));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "stateChanged(int)"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stateChanged",
          "args": [
            "int"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->pushButtonCoinControl",
            "SIGNAL(clicked())",
            "this",
            "SLOT(coinControlButtonClicked())"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "coinControlButtonClicked()"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControlButtonClicked",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "coinControlButtonClicked",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "428-434",
          "snippet": "void SendCoinsDialog::coinControlButtonClicked()\n{\n    CoinControlDialog dlg;\n    dlg.setModel(model);\n    dlg.exec();\n    coinControlUpdateLabels();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::coinControlButtonClicked()\n  {\n      CoinControlDialog dlg;\n      dlg.setModel(model);\n      dlg.exec();\n      coinControlUpdateLabels();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "clicked()"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clicked",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "on_sendButton_clicked",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "115-226",
          "snippet": "void SendCoinsDialog::on_sendButton_clicked()\n{\n    QList<SendCoinsRecipient> recipients;\n    bool valid = true;\n\n    if(!model)\n        return;\n\n    for(int i = 0; i < ui->entries->count(); ++i)\n    {\n        SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n        if(entry)\n        {\n            if(entry->validate())\n            {\n                recipients.append(entry->getValue());\n            }\n            else\n            {\n                valid = false;\n            }\n        }\n    }\n\n    if(!valid || recipients.isEmpty())\n    {\n        return;\n    }\n\n    // Format confirmation message\n    QStringList formatted;\n    foreach(const SendCoinsRecipient &rcp, recipients)\n    {\n        formatted.append(tr(\"<b>%1</b> to %2 (%3)\").arg(BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, rcp.amount), Qt::escape(rcp.label), rcp.address));\n    }\n\n    fNewRecipientAllowed = false;\n\n    QMessageBox::StandardButton retval = QMessageBox::question(this, tr(\"Confirm send coins\"),\n                          tr(\"Are you sure you want to send %1?\").arg(formatted.join(tr(\" and \"))),\n          QMessageBox::Yes|QMessageBox::Cancel,\n          QMessageBox::Cancel);\n\n    if(retval != QMessageBox::Yes)\n    {\n        fNewRecipientAllowed = true;\n        return;\n    }\n\n    WalletModel::UnlockContext ctx(model->requestUnlock());\n    if(!ctx.isValid())\n    {\n        // Unlock wallet was cancelled\n        fNewRecipientAllowed = true;\n        return;\n    }\n\n    WalletModel::SendCoinsReturn sendstatus;\n\n    if (!model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n        sendstatus = model->sendCoins(recipients);\n    else\n        sendstatus = model->sendCoins(recipients, CoinControlDialog::coinControl);\n\n    switch(sendstatus.status)\n    {\n    case WalletModel::InvalidAddress:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"The recipient address is not valid, please recheck.\"),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::InvalidAmount:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"The amount to pay must be larger than 0.\"),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::AmountExceedsBalance:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"The amount exceeds your balance.\"),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::AmountWithFeeExceedsBalance:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"The total exceeds your balance when the %1 transaction fee is included.\").\n            arg(BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, sendstatus.fee)),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::DuplicateAddress:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"Duplicate address found, can only send to each address once per send operation.\"),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::TransactionCreationFailed:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"Error: Transaction creation failed.\"),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::TransactionCommitFailed:\n        QMessageBox::warning(this, tr(\"Send Coins\"),\n            tr(\"Error: The transaction was rejected. This might happen if some of the coins in your wallet were already spent, such as if you used a copy of wallet.dat and coins were spent in the copy but not marked as spent here.\"),\n            QMessageBox::Ok, QMessageBox::Ok);\n        break;\n    case WalletModel::Aborted: // User aborted, nothing to do\n        break;\n    case WalletModel::OK:\n        accept();\n        CoinControlDialog::coinControl->UnSelectAll();\n        coinControlUpdateLabels();\n        break;\n    }\n    fNewRecipientAllowed = true;\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::on_sendButton_clicked()\n  {\n      QList<SendCoinsRecipient> recipients;\n      bool valid = true;\n  \n      if(!model)\n          return;\n  \n      for(int i = 0; i < ui->entries->count(); ++i)\n      {\n          SendCoinsEntry *entry = qobject_cast<SendCoinsEntry*>(ui->entries->itemAt(i)->widget());\n          if(entry)\n          {\n              if(entry->validate())\n              {\n                  recipients.append(entry->getValue());\n              }\n              else\n              {\n                  valid = false;\n              }\n          }\n      }\n  \n      if(!valid || recipients.isEmpty())\n      {\n          return;\n      }\n  \n      // Format confirmation message\n      QStringList formatted;\n      foreach(const SendCoinsRecipient &rcp, recipients)\n      {\n          formatted.append(tr(\"<b>%1</b> to %2 (%3)\").arg(BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, rcp.amount), Qt::escape(rcp.label), rcp.address));\n      }\n  \n      fNewRecipientAllowed = false;\n  \n      QMessageBox::StandardButton retval = QMessageBox::question(this, tr(\"Confirm send coins\"),\n                            tr(\"Are you sure you want to send %1?\").arg(formatted.join(tr(\" and \"))),\n            QMessageBox::Yes|QMessageBox::Cancel,\n            QMessageBox::Cancel);\n  \n      if(retval != QMessageBox::Yes)\n      {\n          fNewRecipientAllowed = true;\n          return;\n      }\n  \n      WalletModel::UnlockContext ctx(model->requestUnlock());\n      if(!ctx.isValid())\n      {\n          // Unlock wallet was cancelled\n          fNewRecipientAllowed = true;\n          return;\n      }\n  \n      WalletModel::SendCoinsReturn sendstatus;\n  \n      if (!model->getOptionsModel() || !model->getOptionsModel()->getCoinControlFeatures())\n          sendstatus = model->sendCoins(recipients);\n      else\n          sendstatus = model->sendCoins(recipients, CoinControlDialog::coinControl);\n  \n      switch(sendstatus.status)\n      {\n      case WalletModel::InvalidAddress:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"The recipient address is not valid, please recheck.\"),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::InvalidAmount:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"The amount to pay must be larger than 0.\"),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::AmountExceedsBalance:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"The amount exceeds your balance.\"),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::AmountWithFeeExceedsBalance:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"The total exceeds your balance when the %1 transaction fee is included.\").\n              arg(BitcoinUnits::formatWithUnit(BitcoinUnits::BTC, sendstatus.fee)),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::DuplicateAddress:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"Duplicate address found, can only send to each address once per send operation.\"),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::TransactionCreationFailed:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"Error: Transaction creation failed.\"),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::TransactionCommitFailed:\n          QMessageBox::warning(this, tr(\"Send Coins\"),\n              tr(\"Error: The transaction was rejected. This might happen if some of the coins in your wallet were already spent, such as if you used a copy of wallet.dat and coins were spent in the copy but not marked as spent here.\"),\n              QMessageBox::Ok, QMessageBox::Ok);\n          break;\n      case WalletModel::Aborted: // User aborted, nothing to do\n          break;\n      case WalletModel::OK:\n          accept();\n          CoinControlDialog::coinControl->UnSelectAll();\n          coinControlUpdateLabels();\n          break;\n      }\n      fNewRecipientAllowed = true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->lineEditCoinControlChange->setFont",
          "args": [
            "GUIUtil::bitcoinAddressFont()"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::bitcoinAddressFont",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "bitcoinAddressFont",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "55-60",
          "snippet": "QFont bitcoinAddressFont()\n{\n    QFont font(\"Monospace\");\n    font.setStyleHint(QFont::TypeWriter);\n    return font;\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQFont bitcoinAddressFont()\n{\n    QFont font(\"Monospace\");\n    font.setStyleHint(QFont::TypeWriter);\n    return font;\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->clearButton",
            "SIGNAL(clicked())",
            "this",
            "SLOT(clear())"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "clear()"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "SendCoinsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsdialog.cpp",
          "lines": "228-240",
          "snippet": "void SendCoinsDialog::clear()\n{\n    // Remove entries until only one left\n    while(ui->entries->count())\n    {\n        delete ui->entries->takeAt(0)->widget();\n    }\n    addEntry();\n\n    updateRemoveEnabled();\n\n    ui->sendButton->setDefault(true);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QScrollBar>",
            "#include <QTextDocument>",
            "#include <QLocale>",
            "#include <QMessageBox>",
            "#include \"coincontroldialog.h\"",
            "#include \"coincontrol.h\"",
            "#include \"askpassphrasedialog.h\"",
            "#include \"guiutil.h\"",
            "#include \"sendcoinsentry.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"init.h\"",
            "#include \"ui_sendcoinsdialog.h\"",
            "#include \"sendcoinsdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  void SendCoinsDialog::clear()\n  {\n      // Remove entries until only one left\n      while(ui->entries->count())\n      {\n          delete ui->entries->takeAt(0)->widget();\n      }\n      addEntry();\n  \n      updateRemoveEnabled();\n  \n      ui->sendButton->setDefault(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "clicked()"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->addButton",
            "SIGNAL(clicked())",
            "this",
            "SLOT(addEntry())"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "addEntry()"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addEntry",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "clicked()"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addEntry",
          "args": [],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lineEditCoinControlChange->setPlaceholderText",
          "args": [
            "tr(\"Enter a Halcyon address (e.g. halcyonfwYhBmGXcFP2Po1NpRUEiK8km2)\")"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->sendButton->setIcon",
          "args": [
            "QIcon()"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->clearButton->setIcon",
          "args": [
            "QIcon()"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->addButton->setIcon",
          "args": [
            "QIcon()"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->setupUi",
          "args": [
            "this"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QScrollBar>\n#include <QTextDocument>\n#include <QLocale>\n#include <QMessageBox>\n#include \"coincontroldialog.h\"\n#include \"coincontrol.h\"\n#include \"askpassphrasedialog.h\"\n#include \"guiutil.h\"\n#include \"sendcoinsentry.h\"\n#include \"optionsmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"addressbookpage.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"init.h\"\n#include \"ui_sendcoinsdialog.h\"\n#include \"sendcoinsdialog.h\"\n\nSendCoinsDialog {\n  SendCoinsDialog::SendCoinsDialog(QWidget *parent) :\n      QDialog(parent),\n      ui(new Ui::SendCoinsDialog),\n      model(0)\n  {\n      ui->setupUi(this);\n  \n  #ifdef Q_OS_MAC // Icons on push buttons are very uncommon on Mac\n      ui->addButton->setIcon(QIcon());\n      ui->clearButton->setIcon(QIcon());\n      ui->sendButton->setIcon(QIcon());\n  #endif\n  \n  #if QT_VERSION >= 0x040700\n      /* Do not move this to the XML file, Qt before 4.7 will choke on it */\n      ui->lineEditCoinControlChange->setPlaceholderText(tr(\"Enter a Halcyon address (e.g. halcyonfwYhBmGXcFP2Po1NpRUEiK8km2)\"));\n  #endif\n  \n      addEntry();\n  \n      connect(ui->addButton, SIGNAL(clicked()), this, SLOT(addEntry()));\n      connect(ui->clearButton, SIGNAL(clicked()), this, SLOT(clear()));\n  \n      // Coin Control\n      ui->lineEditCoinControlChange->setFont(GUIUtil::bitcoinAddressFont());\n      connect(ui->pushButtonCoinControl, SIGNAL(clicked()), this, SLOT(coinControlButtonClicked()));\n      connect(ui->checkBoxCoinControlChange, SIGNAL(stateChanged(int)), this, SLOT(coinControlChangeChecked(int)));\n      connect(ui->lineEditCoinControlChange, SIGNAL(textEdited(const QString &)), this, SLOT(coinControlChangeEdited(const QString &)));\n  \n      // Coin Control: clipboard actions\n      QAction *clipboardQuantityAction = new QAction(tr(\"Copy quantity\"), this);\n      QAction *clipboardAmountAction = new QAction(tr(\"Copy amount\"), this);\n      QAction *clipboardFeeAction = new QAction(tr(\"Copy fee\"), this);\n      QAction *clipboardAfterFeeAction = new QAction(tr(\"Copy after fee\"), this);\n      QAction *clipboardBytesAction = new QAction(tr(\"Copy bytes\"), this);\n      QAction *clipboardPriorityAction = new QAction(tr(\"Copy priority\"), this);\n      QAction *clipboardLowOutputAction = new QAction(tr(\"Copy low output\"), this);\n      QAction *clipboardChangeAction = new QAction(tr(\"Copy change\"), this);\n      connect(clipboardQuantityAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardQuantity()));\n      connect(clipboardAmountAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardAmount()));\n      connect(clipboardFeeAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardFee()));\n      connect(clipboardAfterFeeAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardAfterFee()));\n      connect(clipboardBytesAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardBytes()));\n      connect(clipboardPriorityAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardPriority()));\n      connect(clipboardLowOutputAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardLowOutput()));\n      connect(clipboardChangeAction, SIGNAL(triggered()), this, SLOT(coinControlClipboardChange()));\n      ui->labelCoinControlQuantity->addAction(clipboardQuantityAction);\n      ui->labelCoinControlAmount->addAction(clipboardAmountAction);\n      ui->labelCoinControlFee->addAction(clipboardFeeAction);\n      ui->labelCoinControlAfterFee->addAction(clipboardAfterFeeAction);\n      ui->labelCoinControlBytes->addAction(clipboardBytesAction);\n      ui->labelCoinControlPriority->addAction(clipboardPriorityAction);\n      ui->labelCoinControlLowOutput->addAction(clipboardLowOutputAction);\n      ui->labelCoinControlChange->addAction(clipboardChangeAction);\n  \n      fNewRecipientAllowed = true;\n  }\n}"
  }
]