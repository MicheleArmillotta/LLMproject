[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "376-378",
    "snippet": "int main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "leveldb::test::RunAllTests",
          "args": [],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "RunAllTests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "36-58",
          "snippet": "int RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nint main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "372-372",
    "snippet": "TEST(SkipTest, Concurrent5) { RunConcurrent(5); }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RunConcurrent",
          "args": [
            "5"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "RunConcurrent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "348-366",
          "snippet": "static void RunConcurrent(int run) {\n  const int seed = test::RandomSeed() + (run * 100);\n  Random rnd(seed);\n  const int N = 1000;\n  const int kSize = 1000;\n  for (int i = 0; i < N; i++) {\n    if ((i % 100) == 0) {\n      fprintf(stderr, \"Run %d of %d\\n\", i, N);\n    }\n    TestState state(seed + 1);\n    Env::Default()->Schedule(ConcurrentReader, &state);\n    state.Wait(TestState::RUNNING);\n    for (int i = 0; i < kSize; i++) {\n      state.t_.WriteStep(&rnd);\n    }\n    state.quit_flag_.Release_Store(&state);  // Any non-NULL arg will do\n    state.Wait(TestState::DONE);\n  }\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nstatic void RunConcurrent(int run) {\n  const int seed = test::RandomSeed() + (run * 100);\n  Random rnd(seed);\n  const int N = 1000;\n  const int kSize = 1000;\n  for (int i = 0; i < N; i++) {\n    if ((i % 100) == 0) {\n      fprintf(stderr, \"Run %d of %d\\n\", i, N);\n    }\n    TestState state(seed + 1);\n    Env::Default()->Schedule(ConcurrentReader, &state);\n    state.Wait(TestState::RUNNING);\n    for (int i = 0; i < kSize; i++) {\n      state.t_.WriteStep(&rnd);\n    }\n    state.quit_flag_.Release_Store(&state);  // Any non-NULL arg will do\n    state.Wait(TestState::DONE);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nTEST(SkipTest, Concurrent5) { RunConcurrent(5); }"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "371-371",
    "snippet": "TEST(SkipTest, Concurrent4) { RunConcurrent(4); }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RunConcurrent",
          "args": [
            "4"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "RunConcurrent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "348-366",
          "snippet": "static void RunConcurrent(int run) {\n  const int seed = test::RandomSeed() + (run * 100);\n  Random rnd(seed);\n  const int N = 1000;\n  const int kSize = 1000;\n  for (int i = 0; i < N; i++) {\n    if ((i % 100) == 0) {\n      fprintf(stderr, \"Run %d of %d\\n\", i, N);\n    }\n    TestState state(seed + 1);\n    Env::Default()->Schedule(ConcurrentReader, &state);\n    state.Wait(TestState::RUNNING);\n    for (int i = 0; i < kSize; i++) {\n      state.t_.WriteStep(&rnd);\n    }\n    state.quit_flag_.Release_Store(&state);  // Any non-NULL arg will do\n    state.Wait(TestState::DONE);\n  }\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nstatic void RunConcurrent(int run) {\n  const int seed = test::RandomSeed() + (run * 100);\n  Random rnd(seed);\n  const int N = 1000;\n  const int kSize = 1000;\n  for (int i = 0; i < N; i++) {\n    if ((i % 100) == 0) {\n      fprintf(stderr, \"Run %d of %d\\n\", i, N);\n    }\n    TestState state(seed + 1);\n    Env::Default()->Schedule(ConcurrentReader, &state);\n    state.Wait(TestState::RUNNING);\n    for (int i = 0; i < kSize; i++) {\n      state.t_.WriteStep(&rnd);\n    }\n    state.quit_flag_.Release_Store(&state);  // Any non-NULL arg will do\n    state.Wait(TestState::DONE);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nTEST(SkipTest, Concurrent4) { RunConcurrent(4); }"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "370-370",
    "snippet": "TEST(SkipTest, Concurrent3) { RunConcurrent(3); }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RunConcurrent",
          "args": [
            "3"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "RunConcurrent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "348-366",
          "snippet": "static void RunConcurrent(int run) {\n  const int seed = test::RandomSeed() + (run * 100);\n  Random rnd(seed);\n  const int N = 1000;\n  const int kSize = 1000;\n  for (int i = 0; i < N; i++) {\n    if ((i % 100) == 0) {\n      fprintf(stderr, \"Run %d of %d\\n\", i, N);\n    }\n    TestState state(seed + 1);\n    Env::Default()->Schedule(ConcurrentReader, &state);\n    state.Wait(TestState::RUNNING);\n    for (int i = 0; i < kSize; i++) {\n      state.t_.WriteStep(&rnd);\n    }\n    state.quit_flag_.Release_Store(&state);  // Any non-NULL arg will do\n    state.Wait(TestState::DONE);\n  }\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nstatic void RunConcurrent(int run) {\n  const int seed = test::RandomSeed() + (run * 100);\n  Random rnd(seed);\n  const int N = 1000;\n  const int kSize = 1000;\n  for (int i = 0; i < N; i++) {\n    if ((i % 100) == 0) {\n      fprintf(stderr, \"Run %d of %d\\n\", i, N);\n    }\n    TestState state(seed + 1);\n    Env::Default()->Schedule(ConcurrentReader, &state);\n    state.Wait(TestState::RUNNING);\n    for (int i = 0; i < kSize; i++) {\n      state.t_.WriteStep(&rnd);\n    }\n    state.quit_flag_.Release_Store(&state);  // Any non-NULL arg will do\n    state.Wait(TestState::DONE);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nTEST(SkipTest, Concurrent3) { RunConcurrent(3); }"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "369-369",
    "snippet": "TEST(SkipTest, Concurrent2) { RunConcurrent(2); }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RunConcurrent",
          "args": [
            "2"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "RunConcurrent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "348-366",
          "snippet": "static void RunConcurrent(int run) {\n  const int seed = test::RandomSeed() + (run * 100);\n  Random rnd(seed);\n  const int N = 1000;\n  const int kSize = 1000;\n  for (int i = 0; i < N; i++) {\n    if ((i % 100) == 0) {\n      fprintf(stderr, \"Run %d of %d\\n\", i, N);\n    }\n    TestState state(seed + 1);\n    Env::Default()->Schedule(ConcurrentReader, &state);\n    state.Wait(TestState::RUNNING);\n    for (int i = 0; i < kSize; i++) {\n      state.t_.WriteStep(&rnd);\n    }\n    state.quit_flag_.Release_Store(&state);  // Any non-NULL arg will do\n    state.Wait(TestState::DONE);\n  }\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nstatic void RunConcurrent(int run) {\n  const int seed = test::RandomSeed() + (run * 100);\n  Random rnd(seed);\n  const int N = 1000;\n  const int kSize = 1000;\n  for (int i = 0; i < N; i++) {\n    if ((i % 100) == 0) {\n      fprintf(stderr, \"Run %d of %d\\n\", i, N);\n    }\n    TestState state(seed + 1);\n    Env::Default()->Schedule(ConcurrentReader, &state);\n    state.Wait(TestState::RUNNING);\n    for (int i = 0; i < kSize; i++) {\n      state.t_.WriteStep(&rnd);\n    }\n    state.quit_flag_.Release_Store(&state);  // Any non-NULL arg will do\n    state.Wait(TestState::DONE);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nTEST(SkipTest, Concurrent2) { RunConcurrent(2); }"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "368-368",
    "snippet": "TEST(SkipTest, Concurrent1) { RunConcurrent(1); }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RunConcurrent",
          "args": [
            "1"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "RunConcurrent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "348-366",
          "snippet": "static void RunConcurrent(int run) {\n  const int seed = test::RandomSeed() + (run * 100);\n  Random rnd(seed);\n  const int N = 1000;\n  const int kSize = 1000;\n  for (int i = 0; i < N; i++) {\n    if ((i % 100) == 0) {\n      fprintf(stderr, \"Run %d of %d\\n\", i, N);\n    }\n    TestState state(seed + 1);\n    Env::Default()->Schedule(ConcurrentReader, &state);\n    state.Wait(TestState::RUNNING);\n    for (int i = 0; i < kSize; i++) {\n      state.t_.WriteStep(&rnd);\n    }\n    state.quit_flag_.Release_Store(&state);  // Any non-NULL arg will do\n    state.Wait(TestState::DONE);\n  }\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nstatic void RunConcurrent(int run) {\n  const int seed = test::RandomSeed() + (run * 100);\n  Random rnd(seed);\n  const int N = 1000;\n  const int kSize = 1000;\n  for (int i = 0; i < N; i++) {\n    if ((i % 100) == 0) {\n      fprintf(stderr, \"Run %d of %d\\n\", i, N);\n    }\n    TestState state(seed + 1);\n    Env::Default()->Schedule(ConcurrentReader, &state);\n    state.Wait(TestState::RUNNING);\n    for (int i = 0; i < kSize; i++) {\n      state.t_.WriteStep(&rnd);\n    }\n    state.quit_flag_.Release_Store(&state);  // Any non-NULL arg will do\n    state.Wait(TestState::DONE);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nTEST(SkipTest, Concurrent1) { RunConcurrent(1); }"
  },
  {
    "function_name": "RunConcurrent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "348-366",
    "snippet": "static void RunConcurrent(int run) {\n  const int seed = test::RandomSeed() + (run * 100);\n  Random rnd(seed);\n  const int N = 1000;\n  const int kSize = 1000;\n  for (int i = 0; i < N; i++) {\n    if ((i % 100) == 0) {\n      fprintf(stderr, \"Run %d of %d\\n\", i, N);\n    }\n    TestState state(seed + 1);\n    Env::Default()->Schedule(ConcurrentReader, &state);\n    state.Wait(TestState::RUNNING);\n    for (int i = 0; i < kSize; i++) {\n      state.t_.WriteStep(&rnd);\n    }\n    state.quit_flag_.Release_Store(&state);  // Any non-NULL arg will do\n    state.Wait(TestState::DONE);\n  }\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "state.Wait",
          "args": [
            "TestState::DONE"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "Wait",
          "container": "TestState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "315-321",
          "snippet": "void Wait(ReaderState s) {\n    mu_.Lock();\n    while (state_ != s) {\n      state_cv_.Wait();\n    }\n    mu_.Unlock();\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nTestState {\n  void Wait(ReaderState s) {\n      mu_.Lock();\n      while (state_ != s) {\n        state_cv_.Wait();\n      }\n      mu_.Unlock();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "state.quit_flag_.Release_Store",
          "args": [
            "&state"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "state.t_.WriteStep",
          "args": [
            "&rnd"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "WriteStep",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "217-223",
          "snippet": "void WriteStep(Random* rnd) {\n    const uint32_t k = rnd->Next() % K;\n    const intptr_t g = current_.Get(k) + 1;\n    const Key key = MakeKey(k, g);\n    list_.Insert(key);\n    current_.Set(k, g);\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  void WriteStep(Random* rnd) {\n      const uint32_t k = rnd->Next() % K;\n      const intptr_t g = current_.Get(k) + 1;\n      const Key key = MakeKey(k, g);\n      list_.Insert(key);\n      current_.Set(k, g);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [
            "ConcurrentReader",
            "&state"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Run %d of %d\\n\"",
            "i",
            "N"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test::RandomSeed",
          "args": [],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "RandomSeed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "67-74",
          "snippet": "int RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nstatic void RunConcurrent(int run) {\n  const int seed = test::RandomSeed() + (run * 100);\n  Random rnd(seed);\n  const int N = 1000;\n  const int kSize = 1000;\n  for (int i = 0; i < N; i++) {\n    if ((i % 100) == 0) {\n      fprintf(stderr, \"Run %d of %d\\n\", i, N);\n    }\n    TestState state(seed + 1);\n    Env::Default()->Schedule(ConcurrentReader, &state);\n    state.Wait(TestState::RUNNING);\n    for (int i = 0; i < kSize; i++) {\n      state.t_.WriteStep(&rnd);\n    }\n    state.quit_flag_.Release_Store(&state);  // Any non-NULL arg will do\n    state.Wait(TestState::DONE);\n  }\n}"
  },
  {
    "function_name": "ConcurrentReader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "336-346",
    "snippet": "static void ConcurrentReader(void* arg) {\n  TestState* state = reinterpret_cast<TestState*>(arg);\n  Random rnd(state->seed_);\n  int64_t reads = 0;\n  state->Change(TestState::RUNNING);\n  while (!state->quit_flag_.Acquire_Load()) {\n    state->t_.ReadStep(&rnd);\n    ++reads;\n  }\n  state->Change(TestState::DONE);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "state->Change",
          "args": [
            "TestState::DONE"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "Change",
          "container": "TestState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "323-328",
          "snippet": "void Change(ReaderState s) {\n    mu_.Lock();\n    state_ = s;\n    state_cv_.Signal();\n    mu_.Unlock();\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nTestState {\n  void Change(ReaderState s) {\n      mu_.Lock();\n      state_ = s;\n      state_cv_.Signal();\n      mu_.Unlock();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "state->t_.ReadStep",
          "args": [
            "&rnd"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "ReadStep",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "225-282",
          "snippet": "void ReadStep(Random* rnd) {\n    // Remember the initial committed state of the skiplist.\n    State initial_state;\n    for (int k = 0; k < K; k++) {\n      initial_state.Set(k, current_.Get(k));\n    }\n\n    Key pos = RandomTarget(rnd);\n    SkipList<Key, Comparator>::Iterator iter(&list_);\n    iter.Seek(pos);\n    while (true) {\n      Key current;\n      if (!iter.Valid()) {\n        current = MakeKey(K, 0);\n      } else {\n        current = iter.key();\n        ASSERT_TRUE(IsValidKey(current)) << current;\n      }\n      ASSERT_LE(pos, current) << \"should not go backwards\";\n\n      // Verify that everything in [pos,current) was not present in\n      // initial_state.\n      while (pos < current) {\n        ASSERT_LT(key(pos), K) << pos;\n\n        // Note that generation 0 is never inserted, so it is ok if\n        // <*,0,*> is missing.\n        ASSERT_TRUE((gen(pos) == 0) ||\n                    (gen(pos) > initial_state.Get(key(pos)))\n                    ) << \"key: \" << key(pos)\n                      << \"; gen: \" << gen(pos)\n                      << \"; initgen: \"\n                      << initial_state.Get(key(pos));\n\n        // Advance to next key in the valid key space\n        if (key(pos) < key(current)) {\n          pos = MakeKey(key(pos) + 1, 0);\n        } else {\n          pos = MakeKey(key(pos), gen(pos) + 1);\n        }\n      }\n\n      if (!iter.Valid()) {\n        break;\n      }\n\n      if (rnd->Next() % 2) {\n        iter.Next();\n        pos = MakeKey(key(pos), gen(pos) + 1);\n      } else {\n        Key new_target = RandomTarget(rnd);\n        if (new_target > pos) {\n          pos = new_target;\n          iter.Seek(new_target);\n        }\n      }\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  void ReadStep(Random* rnd) {\n      // Remember the initial committed state of the skiplist.\n      State initial_state;\n      for (int k = 0; k < K; k++) {\n        initial_state.Set(k, current_.Get(k));\n      }\n  \n      Key pos = RandomTarget(rnd);\n      SkipList<Key, Comparator>::Iterator iter(&list_);\n      iter.Seek(pos);\n      while (true) {\n        Key current;\n        if (!iter.Valid()) {\n          current = MakeKey(K, 0);\n        } else {\n          current = iter.key();\n          ASSERT_TRUE(IsValidKey(current)) << current;\n        }\n        ASSERT_LE(pos, current) << \"should not go backwards\";\n  \n        // Verify that everything in [pos,current) was not present in\n        // initial_state.\n        while (pos < current) {\n          ASSERT_LT(key(pos), K) << pos;\n  \n          // Note that generation 0 is never inserted, so it is ok if\n          // <*,0,*> is missing.\n          ASSERT_TRUE((gen(pos) == 0) ||\n                      (gen(pos) > initial_state.Get(key(pos)))\n                      ) << \"key: \" << key(pos)\n                        << \"; gen: \" << gen(pos)\n                        << \"; initgen: \"\n                        << initial_state.Get(key(pos));\n  \n          // Advance to next key in the valid key space\n          if (key(pos) < key(current)) {\n            pos = MakeKey(key(pos) + 1, 0);\n          } else {\n            pos = MakeKey(key(pos), gen(pos) + 1);\n          }\n        }\n  \n        if (!iter.Valid()) {\n          break;\n        }\n  \n        if (rnd->Next() % 2) {\n          iter.Next();\n          pos = MakeKey(key(pos), gen(pos) + 1);\n        } else {\n          Key new_target = RandomTarget(rnd);\n          if (new_target > pos) {\n            pos = new_target;\n            iter.Seek(new_target);\n          }\n        }\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "state->quit_flag_.Acquire_Load",
          "args": [],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<TestState*>",
          "args": [
            "arg"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nstatic void ConcurrentReader(void* arg) {\n  TestState* state = reinterpret_cast<TestState*>(arg);\n  Random rnd(state->seed_);\n  int64_t reads = 0;\n  state->Change(TestState::RUNNING);\n  while (!state->quit_flag_.Acquire_Load()) {\n    state->t_.ReadStep(&rnd);\n    ++reads;\n  }\n  state->Change(TestState::DONE);\n}"
  },
  {
    "function_name": "Change",
    "container": "TestState",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "323-328",
    "snippet": "void Change(ReaderState s) {\n    mu_.Lock();\n    state_ = s;\n    state_cv_.Signal();\n    mu_.Unlock();\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mu_.Unlock",
          "args": [],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "Unlock",
          "container": "Mutex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "60-63",
          "snippet": "void Mutex::Unlock() {\n  assert(cs_);\n  ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Unlock() {\n    assert(cs_);\n    ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "state_cv_.Signal",
          "args": [],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "Signal",
          "container": "CondVar",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "98-108",
          "snippet": "void CondVar::Signal() {\n  wait_mtx_.Lock();\n  if (waiting_ > 0) {\n    --waiting_;\n\n    // finalize handshake\n    ::ReleaseSemaphore(sem1_, 1, NULL);\n    ::WaitForSingleObject(sem2_, INFINITE);\n  }\n  wait_mtx_.Unlock();\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nCondVar {\n  void CondVar::Signal() {\n    wait_mtx_.Lock();\n    if (waiting_ > 0) {\n      --waiting_;\n  \n      // finalize handshake\n      ::ReleaseSemaphore(sem1_, 1, NULL);\n      ::WaitForSingleObject(sem2_, INFINITE);\n    }\n    wait_mtx_.Unlock();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mu_.Lock",
          "args": [],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "Lock",
          "container": "CCryptoKeyStore",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/keystore.cpp",
          "lines": "76-88",
          "snippet": "bool CCryptoKeyStore::Lock()\n{\n    if (!SetCrypted())\n        return false;\n\n    {\n        LOCK(cs_KeyStore);\n        vMasterKey.clear();\n    }\n\n    NotifyStatusChanged(this);\n    return true;\n}",
          "includes": [
            "#include \"script.h\"",
            "#include \"keystore.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"keystore.h\"\n\nCCryptoKeyStore {\n  bool CCryptoKeyStore::Lock()\n  {\n      if (!SetCrypted())\n          return false;\n  \n      {\n          LOCK(cs_KeyStore);\n          vMasterKey.clear();\n      }\n  \n      NotifyStatusChanged(this);\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nTestState {\n  void Change(ReaderState s) {\n      mu_.Lock();\n      state_ = s;\n      state_cv_.Signal();\n      mu_.Unlock();\n    }\n}"
  },
  {
    "function_name": "Wait",
    "container": "TestState",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "315-321",
    "snippet": "void Wait(ReaderState s) {\n    mu_.Lock();\n    while (state_ != s) {\n      state_cv_.Wait();\n    }\n    mu_.Unlock();\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mu_.Unlock",
          "args": [],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "Unlock",
          "container": "Mutex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "60-63",
          "snippet": "void Mutex::Unlock() {\n  assert(cs_);\n  ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Unlock() {\n    assert(cs_);\n    ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "state_cv_.Wait",
          "args": [],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "Wait",
          "container": "CCheckQueueControl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/checkqueue.h",
          "lines": "173-179",
          "snippet": "bool Wait() {\n        if (pqueue == NULL)\n            return true;\n        bool fRet = pqueue->Wait();\n        fDone = true;\n        return fRet;\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <vector>",
            "#include <boost/thread/condition_variable.hpp>",
            "#include <boost/thread/locks.hpp>",
            "#include <boost/thread/mutex.hpp>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <vector>\n#include <boost/thread/condition_variable.hpp>\n#include <boost/thread/locks.hpp>\n#include <boost/thread/mutex.hpp>\n\nCCheckQueueControl {\n  bool Wait() {\n          if (pqueue == NULL)\n              return true;\n          bool fRet = pqueue->Wait();\n          fDone = true;\n          return fRet;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mu_.Lock",
          "args": [],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "Lock",
          "container": "CCryptoKeyStore",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/keystore.cpp",
          "lines": "76-88",
          "snippet": "bool CCryptoKeyStore::Lock()\n{\n    if (!SetCrypted())\n        return false;\n\n    {\n        LOCK(cs_KeyStore);\n        vMasterKey.clear();\n    }\n\n    NotifyStatusChanged(this);\n    return true;\n}",
          "includes": [
            "#include \"script.h\"",
            "#include \"keystore.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"keystore.h\"\n\nCCryptoKeyStore {\n  bool CCryptoKeyStore::Lock()\n  {\n      if (!SetCrypted())\n          return false;\n  \n      {\n          LOCK(cs_KeyStore);\n          vMasterKey.clear();\n      }\n  \n      NotifyStatusChanged(this);\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nTestState {\n  void Wait(ReaderState s) {\n      mu_.Lock();\n      while (state_ != s) {\n        state_cv_.Wait();\n      }\n      mu_.Unlock();\n    }\n}"
  },
  {
    "function_name": "TestState",
    "container": "TestState",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "309-313",
    "snippet": "explicit TestState(int s)\n      : seed_(s),\n        quit_flag_(NULL),\n        state_(STARTING),\n        state_cv_(&mu_) {}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nTestState {\n  explicit TestState(int s)\n        : seed_(s),\n          quit_flag_(NULL),\n          state_(STARTING),\n          state_cv_(&mu_) {}\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "288-295",
    "snippet": "TEST(SkipTest, ConcurrentWithoutThreads) {\n  ConcurrentTest test;\n  Random rnd(test::RandomSeed());\n  for (int i = 0; i < 10000; i++) {\n    test.ReadStep(&rnd);\n    test.WriteStep(&rnd);\n  }\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test.WriteStep",
          "args": [
            "&rnd"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "WriteStep",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "217-223",
          "snippet": "void WriteStep(Random* rnd) {\n    const uint32_t k = rnd->Next() % K;\n    const intptr_t g = current_.Get(k) + 1;\n    const Key key = MakeKey(k, g);\n    list_.Insert(key);\n    current_.Set(k, g);\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  void WriteStep(Random* rnd) {\n      const uint32_t k = rnd->Next() % K;\n      const intptr_t g = current_.Get(k) + 1;\n      const Key key = MakeKey(k, g);\n      list_.Insert(key);\n      current_.Set(k, g);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test.ReadStep",
          "args": [
            "&rnd"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "ReadStep",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "225-282",
          "snippet": "void ReadStep(Random* rnd) {\n    // Remember the initial committed state of the skiplist.\n    State initial_state;\n    for (int k = 0; k < K; k++) {\n      initial_state.Set(k, current_.Get(k));\n    }\n\n    Key pos = RandomTarget(rnd);\n    SkipList<Key, Comparator>::Iterator iter(&list_);\n    iter.Seek(pos);\n    while (true) {\n      Key current;\n      if (!iter.Valid()) {\n        current = MakeKey(K, 0);\n      } else {\n        current = iter.key();\n        ASSERT_TRUE(IsValidKey(current)) << current;\n      }\n      ASSERT_LE(pos, current) << \"should not go backwards\";\n\n      // Verify that everything in [pos,current) was not present in\n      // initial_state.\n      while (pos < current) {\n        ASSERT_LT(key(pos), K) << pos;\n\n        // Note that generation 0 is never inserted, so it is ok if\n        // <*,0,*> is missing.\n        ASSERT_TRUE((gen(pos) == 0) ||\n                    (gen(pos) > initial_state.Get(key(pos)))\n                    ) << \"key: \" << key(pos)\n                      << \"; gen: \" << gen(pos)\n                      << \"; initgen: \"\n                      << initial_state.Get(key(pos));\n\n        // Advance to next key in the valid key space\n        if (key(pos) < key(current)) {\n          pos = MakeKey(key(pos) + 1, 0);\n        } else {\n          pos = MakeKey(key(pos), gen(pos) + 1);\n        }\n      }\n\n      if (!iter.Valid()) {\n        break;\n      }\n\n      if (rnd->Next() % 2) {\n        iter.Next();\n        pos = MakeKey(key(pos), gen(pos) + 1);\n      } else {\n        Key new_target = RandomTarget(rnd);\n        if (new_target > pos) {\n          pos = new_target;\n          iter.Seek(new_target);\n        }\n      }\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  void ReadStep(Random* rnd) {\n      // Remember the initial committed state of the skiplist.\n      State initial_state;\n      for (int k = 0; k < K; k++) {\n        initial_state.Set(k, current_.Get(k));\n      }\n  \n      Key pos = RandomTarget(rnd);\n      SkipList<Key, Comparator>::Iterator iter(&list_);\n      iter.Seek(pos);\n      while (true) {\n        Key current;\n        if (!iter.Valid()) {\n          current = MakeKey(K, 0);\n        } else {\n          current = iter.key();\n          ASSERT_TRUE(IsValidKey(current)) << current;\n        }\n        ASSERT_LE(pos, current) << \"should not go backwards\";\n  \n        // Verify that everything in [pos,current) was not present in\n        // initial_state.\n        while (pos < current) {\n          ASSERT_LT(key(pos), K) << pos;\n  \n          // Note that generation 0 is never inserted, so it is ok if\n          // <*,0,*> is missing.\n          ASSERT_TRUE((gen(pos) == 0) ||\n                      (gen(pos) > initial_state.Get(key(pos)))\n                      ) << \"key: \" << key(pos)\n                        << \"; gen: \" << gen(pos)\n                        << \"; initgen: \"\n                        << initial_state.Get(key(pos));\n  \n          // Advance to next key in the valid key space\n          if (key(pos) < key(current)) {\n            pos = MakeKey(key(pos) + 1, 0);\n          } else {\n            pos = MakeKey(key(pos), gen(pos) + 1);\n          }\n        }\n  \n        if (!iter.Valid()) {\n          break;\n        }\n  \n        if (rnd->Next() % 2) {\n          iter.Next();\n          pos = MakeKey(key(pos), gen(pos) + 1);\n        } else {\n          Key new_target = RandomTarget(rnd);\n          if (new_target > pos) {\n            pos = new_target;\n            iter.Seek(new_target);\n          }\n        }\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nTEST(SkipTest, ConcurrentWithoutThreads) {\n  ConcurrentTest test;\n  Random rnd(test::RandomSeed());\n  for (int i = 0; i < 10000; i++) {\n    test.ReadStep(&rnd);\n    test.WriteStep(&rnd);\n  }\n}"
  },
  {
    "function_name": "ReadStep",
    "container": "ConcurrentTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "225-282",
    "snippet": "void ReadStep(Random* rnd) {\n    // Remember the initial committed state of the skiplist.\n    State initial_state;\n    for (int k = 0; k < K; k++) {\n      initial_state.Set(k, current_.Get(k));\n    }\n\n    Key pos = RandomTarget(rnd);\n    SkipList<Key, Comparator>::Iterator iter(&list_);\n    iter.Seek(pos);\n    while (true) {\n      Key current;\n      if (!iter.Valid()) {\n        current = MakeKey(K, 0);\n      } else {\n        current = iter.key();\n        ASSERT_TRUE(IsValidKey(current)) << current;\n      }\n      ASSERT_LE(pos, current) << \"should not go backwards\";\n\n      // Verify that everything in [pos,current) was not present in\n      // initial_state.\n      while (pos < current) {\n        ASSERT_LT(key(pos), K) << pos;\n\n        // Note that generation 0 is never inserted, so it is ok if\n        // <*,0,*> is missing.\n        ASSERT_TRUE((gen(pos) == 0) ||\n                    (gen(pos) > initial_state.Get(key(pos)))\n                    ) << \"key: \" << key(pos)\n                      << \"; gen: \" << gen(pos)\n                      << \"; initgen: \"\n                      << initial_state.Get(key(pos));\n\n        // Advance to next key in the valid key space\n        if (key(pos) < key(current)) {\n          pos = MakeKey(key(pos) + 1, 0);\n        } else {\n          pos = MakeKey(key(pos), gen(pos) + 1);\n        }\n      }\n\n      if (!iter.Valid()) {\n        break;\n      }\n\n      if (rnd->Next() % 2) {\n        iter.Next();\n        pos = MakeKey(key(pos), gen(pos) + 1);\n      } else {\n        Key new_target = RandomTarget(rnd);\n        if (new_target > pos) {\n          pos = new_target;\n          iter.Seek(new_target);\n        }\n      }\n    }\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter.Seek",
          "args": [
            "new_target"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "Seek",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "274-286",
          "snippet": "void DBIter::Seek(const Slice& target) {\n  direction_ = kForward;\n  ClearSavedValue();\n  saved_key_.clear();\n  AppendInternalKey(\n      &saved_key_, ParsedInternalKey(target, sequence_, kValueTypeForSeek));\n  iter_->Seek(saved_key_);\n  if (iter_->Valid()) {\n    FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n  } else {\n    valid_ = false;\n  }\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::Seek(const Slice& target) {\n    direction_ = kForward;\n    ClearSavedValue();\n    saved_key_.clear();\n    AppendInternalKey(\n        &saved_key_, ParsedInternalKey(target, sequence_, kValueTypeForSeek));\n    iter_->Seek(saved_key_);\n    if (iter_->Valid()) {\n      FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n    } else {\n      valid_ = false;\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "RandomTarget",
          "args": [
            "rnd"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "RandomTarget",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "173-185",
          "snippet": "static Key RandomTarget(Random* rnd) {\n    switch (rnd->Next() % 10) {\n      case 0:\n        // Seek to beginning\n        return MakeKey(0, 0);\n      case 1:\n        // Seek to end\n        return MakeKey(K, 0);\n      default:\n        // Seek to middle\n        return MakeKey(rnd->Next() % K, 0);\n    }\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static Key RandomTarget(Random* rnd) {\n      switch (rnd->Next() % 10) {\n        case 0:\n          // Seek to beginning\n          return MakeKey(0, 0);\n        case 1:\n          // Seek to end\n          return MakeKey(K, 0);\n        default:\n          // Seek to middle\n          return MakeKey(rnd->Next() % K, 0);\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeKey",
          "args": [
            "key(pos)",
            "gen(pos) + 1"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "MakeKey",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "162-167",
          "snippet": "static Key MakeKey(uint64_t k, uint64_t g) {\n    assert(sizeof(Key) == sizeof(uint64_t));\n    assert(k <= K);  // We sometimes pass K to seek to the end of the skiplist\n    assert(g <= 0xffffffffu);\n    return ((k << 40) | (g << 8) | (HashNumbers(k, g) & 0xff));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static Key MakeKey(uint64_t k, uint64_t g) {\n      assert(sizeof(Key) == sizeof(uint64_t));\n      assert(k <= K);  // We sometimes pass K to seek to the end of the skiplist\n      assert(g <= 0xffffffffu);\n      return ((k << 40) | (g << 8) | (HashNumbers(k, g) & 0xff));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "gen",
          "args": [
            "pos"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "gen",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "154-154",
          "snippet": "static uint64_t gen(Key key) { return (key >> 8) & 0xffffffffu; }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static uint64_t gen(Key key) { return (key >> 8) & 0xffffffffu; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "key",
          "args": [
            "pos"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "153-153",
          "snippet": "static uint64_t key(Key key) { return (key >> 40); }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static uint64_t key(Key key) { return (key >> 40); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter.Next",
          "args": [],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "146-171",
          "snippet": "void DBIter::Next() {\n  assert(valid_);\n\n  if (direction_ == kReverse) {  // Switch directions?\n    direction_ = kForward;\n    // iter_ is pointing just before the entries for this->key(),\n    // so advance into the range of entries for this->key() and then\n    // use the normal skipping code below.\n    if (!iter_->Valid()) {\n      iter_->SeekToFirst();\n    } else {\n      iter_->Next();\n    }\n    if (!iter_->Valid()) {\n      valid_ = false;\n      saved_key_.clear();\n      return;\n    }\n    // saved_key_ already contains the key to skip past.\n  } else {\n    // Store in saved_key_ the current key so we skip it below.\n    SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n  }\n\n  FindNextUserEntry(true, &saved_key_);\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::Next() {\n    assert(valid_);\n  \n    if (direction_ == kReverse) {  // Switch directions?\n      direction_ = kForward;\n      // iter_ is pointing just before the entries for this->key(),\n      // so advance into the range of entries for this->key() and then\n      // use the normal skipping code below.\n      if (!iter_->Valid()) {\n        iter_->SeekToFirst();\n      } else {\n        iter_->Next();\n      }\n      if (!iter_->Valid()) {\n        valid_ = false;\n        saved_key_.clear();\n        return;\n      }\n      // saved_key_ already contains the key to skip past.\n    } else {\n      // Store in saved_key_ the current key so we skip it below.\n      SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n    }\n  \n    FindNextUserEntry(true, &saved_key_);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter.Valid",
          "args": [],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "65-65",
          "snippet": "virtual bool Valid() const { return valid_; }",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  virtual bool Valid() const { return valid_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initial_state.Get",
          "args": [
            "key(pos)"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "ConcurrentTest::State",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "193-195",
          "snippet": "intptr_t Get(int k) {\n      return reinterpret_cast<intptr_t>(generation[k].Acquire_Load());\n    }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  State {\n    intptr_t Get(int k) {\n          return reinterpret_cast<intptr_t>(generation[k].Acquire_Load());\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "(gen(pos) == 0) ||\n                    (gen(pos) > initial_state.Get(key(pos)))"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LT",
          "args": [
            "key(pos)",
            "K"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "pos",
            "current"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "IsValidKey(current)"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsValidKey",
          "args": [
            "current"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "IsValidKey",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "169-171",
          "snippet": "static bool IsValidKey(Key k) {\n    return hash(k) == (HashNumbers(key(k), gen(k)) & 0xff);\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static bool IsValidKey(Key k) {\n      return hash(k) == (HashNumbers(key(k), gen(k)) & 0xff);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter.key",
          "args": [],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "66-69",
          "snippet": "virtual Slice key() const {\n    assert(valid_);\n    return (direction_ == kForward) ? ExtractUserKey(iter_->key()) : saved_key_;\n  }",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  virtual Slice key() const {\n      assert(valid_);\n      return (direction_ == kForward) ? ExtractUserKey(iter_->key()) : saved_key_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initial_state.Set",
          "args": [
            "k",
            "current_.Get(k)"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "Set",
          "container": "ConcurrentTest::State",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "190-192",
          "snippet": "void Set(int k, intptr_t v) {\n      generation[k].Release_Store(reinterpret_cast<void*>(v));\n    }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  State {\n    void Set(int k, intptr_t v) {\n          generation[k].Release_Store(reinterpret_cast<void*>(v));\n        }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  void ReadStep(Random* rnd) {\n      // Remember the initial committed state of the skiplist.\n      State initial_state;\n      for (int k = 0; k < K; k++) {\n        initial_state.Set(k, current_.Get(k));\n      }\n  \n      Key pos = RandomTarget(rnd);\n      SkipList<Key, Comparator>::Iterator iter(&list_);\n      iter.Seek(pos);\n      while (true) {\n        Key current;\n        if (!iter.Valid()) {\n          current = MakeKey(K, 0);\n        } else {\n          current = iter.key();\n          ASSERT_TRUE(IsValidKey(current)) << current;\n        }\n        ASSERT_LE(pos, current) << \"should not go backwards\";\n  \n        // Verify that everything in [pos,current) was not present in\n        // initial_state.\n        while (pos < current) {\n          ASSERT_LT(key(pos), K) << pos;\n  \n          // Note that generation 0 is never inserted, so it is ok if\n          // <*,0,*> is missing.\n          ASSERT_TRUE((gen(pos) == 0) ||\n                      (gen(pos) > initial_state.Get(key(pos)))\n                      ) << \"key: \" << key(pos)\n                        << \"; gen: \" << gen(pos)\n                        << \"; initgen: \"\n                        << initial_state.Get(key(pos));\n  \n          // Advance to next key in the valid key space\n          if (key(pos) < key(current)) {\n            pos = MakeKey(key(pos) + 1, 0);\n          } else {\n            pos = MakeKey(key(pos), gen(pos) + 1);\n          }\n        }\n  \n        if (!iter.Valid()) {\n          break;\n        }\n  \n        if (rnd->Next() % 2) {\n          iter.Next();\n          pos = MakeKey(key(pos), gen(pos) + 1);\n        } else {\n          Key new_target = RandomTarget(rnd);\n          if (new_target > pos) {\n            pos = new_target;\n            iter.Seek(new_target);\n          }\n        }\n      }\n    }\n}"
  },
  {
    "function_name": "WriteStep",
    "container": "ConcurrentTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "217-223",
    "snippet": "void WriteStep(Random* rnd) {\n    const uint32_t k = rnd->Next() % K;\n    const intptr_t g = current_.Get(k) + 1;\n    const Key key = MakeKey(k, g);\n    list_.Insert(key);\n    current_.Set(k, g);\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "current_.Set",
          "args": [
            "k",
            "g"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "Set",
          "container": "ConcurrentTest::State",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "190-192",
          "snippet": "void Set(int k, intptr_t v) {\n      generation[k].Release_Store(reinterpret_cast<void*>(v));\n    }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  State {\n    void Set(int k, intptr_t v) {\n          generation[k].Release_Store(reinterpret_cast<void*>(v));\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_.Insert",
          "args": [
            "key"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "Insert",
          "container": "SkipList<Key,Comparator>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "334-367",
          "snippet": "void SkipList<Key,Comparator>::Insert(const Key& key) {\n  // TODO(opt): We can use a barrier-free variant of FindGreaterOrEqual()\n  // here since Insert() is externally synchronized.\n  Node* prev[kMaxHeight];\n  Node* x = FindGreaterOrEqual(key, prev);\n\n  // Our data structure does not allow duplicate insertion\n  assert(x == NULL || !Equal(key, x->key));\n\n  int height = RandomHeight();\n  if (height > GetMaxHeight()) {\n    for (int i = GetMaxHeight(); i < height; i++) {\n      prev[i] = head_;\n    }\n    //fprintf(stderr, \"Change height from %d to %d\\n\", max_height_, height);\n\n    // It is ok to mutate max_height_ without any synchronization\n    // with concurrent readers.  A concurrent reader that observes\n    // the new value of max_height_ will see either the old value of\n    // new level pointers from head_ (NULL), or a new value set in\n    // the loop below.  In the former case the reader will\n    // immediately drop to the next level since NULL sorts after all\n    // keys.  In the latter case the reader will use the new node.\n    max_height_.NoBarrier_Store(reinterpret_cast<void*>(height));\n  }\n\n  x = NewNode(key, height);\n  for (int i = 0; i < height; i++) {\n    // NoBarrier_SetNext() suffices since we will add a barrier when\n    // we publish a pointer to \"x\" in prev[i].\n    x->NoBarrier_SetNext(i, prev[i]->NoBarrier_Next(i));\n    prev[i]->SetNext(i, x);\n  }\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  void SkipList<Key,Comparator>::Insert(const Key& key) {\n    // TODO(opt): We can use a barrier-free variant of FindGreaterOrEqual()\n    // here since Insert() is externally synchronized.\n    Node* prev[kMaxHeight];\n    Node* x = FindGreaterOrEqual(key, prev);\n  \n    // Our data structure does not allow duplicate insertion\n    assert(x == NULL || !Equal(key, x->key));\n  \n    int height = RandomHeight();\n    if (height > GetMaxHeight()) {\n      for (int i = GetMaxHeight(); i < height; i++) {\n        prev[i] = head_;\n      }\n      //fprintf(stderr, \"Change height from %d to %d\\n\", max_height_, height);\n  \n      // It is ok to mutate max_height_ without any synchronization\n      // with concurrent readers.  A concurrent reader that observes\n      // the new value of max_height_ will see either the old value of\n      // new level pointers from head_ (NULL), or a new value set in\n      // the loop below.  In the former case the reader will\n      // immediately drop to the next level since NULL sorts after all\n      // keys.  In the latter case the reader will use the new node.\n      max_height_.NoBarrier_Store(reinterpret_cast<void*>(height));\n    }\n  \n    x = NewNode(key, height);\n    for (int i = 0; i < height; i++) {\n      // NoBarrier_SetNext() suffices since we will add a barrier when\n      // we publish a pointer to \"x\" in prev[i].\n      x->NoBarrier_SetNext(i, prev[i]->NoBarrier_Next(i));\n      prev[i]->SetNext(i, x);\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeKey",
          "args": [
            "k",
            "g"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "MakeKey",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "162-167",
          "snippet": "static Key MakeKey(uint64_t k, uint64_t g) {\n    assert(sizeof(Key) == sizeof(uint64_t));\n    assert(k <= K);  // We sometimes pass K to seek to the end of the skiplist\n    assert(g <= 0xffffffffu);\n    return ((k << 40) | (g << 8) | (HashNumbers(k, g) & 0xff));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static Key MakeKey(uint64_t k, uint64_t g) {\n      assert(sizeof(Key) == sizeof(uint64_t));\n      assert(k <= K);  // We sometimes pass K to seek to the end of the skiplist\n      assert(g <= 0xffffffffu);\n      return ((k << 40) | (g << 8) | (HashNumbers(k, g) & 0xff));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_.Get",
          "args": [
            "k"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "ConcurrentTest::State",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "193-195",
          "snippet": "intptr_t Get(int k) {\n      return reinterpret_cast<intptr_t>(generation[k].Acquire_Load());\n    }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  State {\n    intptr_t Get(int k) {\n          return reinterpret_cast<intptr_t>(generation[k].Acquire_Load());\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rnd->Next",
          "args": [],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "146-171",
          "snippet": "void DBIter::Next() {\n  assert(valid_);\n\n  if (direction_ == kReverse) {  // Switch directions?\n    direction_ = kForward;\n    // iter_ is pointing just before the entries for this->key(),\n    // so advance into the range of entries for this->key() and then\n    // use the normal skipping code below.\n    if (!iter_->Valid()) {\n      iter_->SeekToFirst();\n    } else {\n      iter_->Next();\n    }\n    if (!iter_->Valid()) {\n      valid_ = false;\n      saved_key_.clear();\n      return;\n    }\n    // saved_key_ already contains the key to skip past.\n  } else {\n    // Store in saved_key_ the current key so we skip it below.\n    SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n  }\n\n  FindNextUserEntry(true, &saved_key_);\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::Next() {\n    assert(valid_);\n  \n    if (direction_ == kReverse) {  // Switch directions?\n      direction_ = kForward;\n      // iter_ is pointing just before the entries for this->key(),\n      // so advance into the range of entries for this->key() and then\n      // use the normal skipping code below.\n      if (!iter_->Valid()) {\n        iter_->SeekToFirst();\n      } else {\n        iter_->Next();\n      }\n      if (!iter_->Valid()) {\n        valid_ = false;\n        saved_key_.clear();\n        return;\n      }\n      // saved_key_ already contains the key to skip past.\n    } else {\n      // Store in saved_key_ the current key so we skip it below.\n      SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n    }\n  \n    FindNextUserEntry(true, &saved_key_);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  void WriteStep(Random* rnd) {\n      const uint32_t k = rnd->Next() % K;\n      const intptr_t g = current_.Get(k) + 1;\n      const Key key = MakeKey(k, g);\n      list_.Insert(key);\n      current_.Set(k, g);\n    }\n}"
  },
  {
    "function_name": "ConcurrentTest",
    "container": "ConcurrentTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "214-214",
    "snippet": "ConcurrentTest() : list_(Comparator(), &arena_) { }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Comparator",
          "args": [],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "RandomHeight",
          "container": "SkipList<Key,Comparator>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "240-250",
          "snippet": "int SkipList<Key,Comparator>::RandomHeight() {\n  // Increase height with probability 1 in kBranching\n  static const unsigned int kBranching = 4;\n  int height = 1;\n  while (height < kMaxHeight && ((rnd_.Next() % kBranching) == 0)) {\n    height++;\n  }\n  assert(height > 0);\n  assert(height <= kMaxHeight);\n  return height;\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  int SkipList<Key,Comparator>::RandomHeight() {\n    // Increase height with probability 1 in kBranching\n    static const unsigned int kBranching = 4;\n    int height = 1;\n    while (height < kMaxHeight && ((rnd_.Next() % kBranching) == 0)) {\n      height++;\n    }\n    assert(height > 0);\n    assert(height <= kMaxHeight);\n    return height;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  ConcurrentTest() : list_(Comparator(), &arena_) { }\n}"
  },
  {
    "function_name": "State",
    "container": "ConcurrentTest::State",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "197-201",
    "snippet": "State() {\n      for (int k = 0; k < K; k++) {\n        Set(k, 0);\n      }\n    }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Set",
          "args": [
            "k",
            "0"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "Set",
          "container": "ConcurrentTest::State",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "190-192",
          "snippet": "void Set(int k, intptr_t v) {\n      generation[k].Release_Store(reinterpret_cast<void*>(v));\n    }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  State {\n    void Set(int k, intptr_t v) {\n          generation[k].Release_Store(reinterpret_cast<void*>(v));\n        }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  State {\n    State() {\n          for (int k = 0; k < K; k++) {\n            Set(k, 0);\n          }\n        }\n  }\n}"
  },
  {
    "function_name": "Get",
    "container": "ConcurrentTest::State",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "193-195",
    "snippet": "intptr_t Get(int k) {\n      return reinterpret_cast<intptr_t>(generation[k].Acquire_Load());\n    }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reinterpret_cast<intptr_t>",
          "args": [
            "generation[k].Acquire_Load()"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "generation[k].Acquire_Load",
          "args": [],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  State {\n    intptr_t Get(int k) {\n          return reinterpret_cast<intptr_t>(generation[k].Acquire_Load());\n        }\n  }\n}"
  },
  {
    "function_name": "Set",
    "container": "ConcurrentTest::State",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "190-192",
    "snippet": "void Set(int k, intptr_t v) {\n      generation[k].Release_Store(reinterpret_cast<void*>(v));\n    }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "generation[k].Release_Store",
          "args": [
            "reinterpret_cast<void*>(v)"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<void*>",
          "args": [
            "v"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  State {\n    void Set(int k, intptr_t v) {\n          generation[k].Release_Store(reinterpret_cast<void*>(v));\n        }\n  }\n}"
  },
  {
    "function_name": "RandomTarget",
    "container": "ConcurrentTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "173-185",
    "snippet": "static Key RandomTarget(Random* rnd) {\n    switch (rnd->Next() % 10) {\n      case 0:\n        // Seek to beginning\n        return MakeKey(0, 0);\n      case 1:\n        // Seek to end\n        return MakeKey(K, 0);\n      default:\n        // Seek to middle\n        return MakeKey(rnd->Next() % K, 0);\n    }\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MakeKey",
          "args": [
            "rnd->Next() % K",
            "0"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "MakeKey",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "162-167",
          "snippet": "static Key MakeKey(uint64_t k, uint64_t g) {\n    assert(sizeof(Key) == sizeof(uint64_t));\n    assert(k <= K);  // We sometimes pass K to seek to the end of the skiplist\n    assert(g <= 0xffffffffu);\n    return ((k << 40) | (g << 8) | (HashNumbers(k, g) & 0xff));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static Key MakeKey(uint64_t k, uint64_t g) {\n      assert(sizeof(Key) == sizeof(uint64_t));\n      assert(k <= K);  // We sometimes pass K to seek to the end of the skiplist\n      assert(g <= 0xffffffffu);\n      return ((k << 40) | (g << 8) | (HashNumbers(k, g) & 0xff));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rnd->Next",
          "args": [],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "146-171",
          "snippet": "void DBIter::Next() {\n  assert(valid_);\n\n  if (direction_ == kReverse) {  // Switch directions?\n    direction_ = kForward;\n    // iter_ is pointing just before the entries for this->key(),\n    // so advance into the range of entries for this->key() and then\n    // use the normal skipping code below.\n    if (!iter_->Valid()) {\n      iter_->SeekToFirst();\n    } else {\n      iter_->Next();\n    }\n    if (!iter_->Valid()) {\n      valid_ = false;\n      saved_key_.clear();\n      return;\n    }\n    // saved_key_ already contains the key to skip past.\n  } else {\n    // Store in saved_key_ the current key so we skip it below.\n    SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n  }\n\n  FindNextUserEntry(true, &saved_key_);\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::Next() {\n    assert(valid_);\n  \n    if (direction_ == kReverse) {  // Switch directions?\n      direction_ = kForward;\n      // iter_ is pointing just before the entries for this->key(),\n      // so advance into the range of entries for this->key() and then\n      // use the normal skipping code below.\n      if (!iter_->Valid()) {\n        iter_->SeekToFirst();\n      } else {\n        iter_->Next();\n      }\n      if (!iter_->Valid()) {\n        valid_ = false;\n        saved_key_.clear();\n        return;\n      }\n      // saved_key_ already contains the key to skip past.\n    } else {\n      // Store in saved_key_ the current key so we skip it below.\n      SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n    }\n  \n    FindNextUserEntry(true, &saved_key_);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static Key RandomTarget(Random* rnd) {\n      switch (rnd->Next() % 10) {\n        case 0:\n          // Seek to beginning\n          return MakeKey(0, 0);\n        case 1:\n          // Seek to end\n          return MakeKey(K, 0);\n        default:\n          // Seek to middle\n          return MakeKey(rnd->Next() % K, 0);\n      }\n    }\n}"
  },
  {
    "function_name": "IsValidKey",
    "container": "ConcurrentTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "169-171",
    "snippet": "static bool IsValidKey(Key k) {\n    return hash(k) == (HashNumbers(key(k), gen(k)) & 0xff);\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HashNumbers",
          "args": [
            "key(k)",
            "gen(k)"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "HashNumbers",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "157-160",
          "snippet": "static uint64_t HashNumbers(uint64_t k, uint64_t g) {\n    uint64_t data[2] = { k, g };\n    return Hash(reinterpret_cast<char*>(data), sizeof(data), 0);\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static uint64_t HashNumbers(uint64_t k, uint64_t g) {\n      uint64_t data[2] = { k, g };\n      return Hash(reinterpret_cast<char*>(data), sizeof(data), 0);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "gen",
          "args": [
            "k"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "gen",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "154-154",
          "snippet": "static uint64_t gen(Key key) { return (key >> 8) & 0xffffffffu; }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static uint64_t gen(Key key) { return (key >> 8) & 0xffffffffu; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "key",
          "args": [
            "k"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "153-153",
          "snippet": "static uint64_t key(Key key) { return (key >> 40); }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static uint64_t key(Key key) { return (key >> 40); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash",
          "args": [
            "k"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "hash",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "155-155",
          "snippet": "static uint64_t hash(Key key) { return key & 0xff; }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static uint64_t hash(Key key) { return key & 0xff; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static bool IsValidKey(Key k) {\n      return hash(k) == (HashNumbers(key(k), gen(k)) & 0xff);\n    }\n}"
  },
  {
    "function_name": "MakeKey",
    "container": "ConcurrentTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "162-167",
    "snippet": "static Key MakeKey(uint64_t k, uint64_t g) {\n    assert(sizeof(Key) == sizeof(uint64_t));\n    assert(k <= K);  // We sometimes pass K to seek to the end of the skiplist\n    assert(g <= 0xffffffffu);\n    return ((k << 40) | (g << 8) | (HashNumbers(k, g) & 0xff));\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HashNumbers",
          "args": [
            "k",
            "g"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "HashNumbers",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "157-160",
          "snippet": "static uint64_t HashNumbers(uint64_t k, uint64_t g) {\n    uint64_t data[2] = { k, g };\n    return Hash(reinterpret_cast<char*>(data), sizeof(data), 0);\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static uint64_t HashNumbers(uint64_t k, uint64_t g) {\n      uint64_t data[2] = { k, g };\n      return Hash(reinterpret_cast<char*>(data), sizeof(data), 0);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "g <= 0xffffffffu"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "k <= K"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "sizeof(Key) == sizeof(uint64_t)"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static Key MakeKey(uint64_t k, uint64_t g) {\n      assert(sizeof(Key) == sizeof(uint64_t));\n      assert(k <= K);  // We sometimes pass K to seek to the end of the skiplist\n      assert(g <= 0xffffffffu);\n      return ((k << 40) | (g << 8) | (HashNumbers(k, g) & 0xff));\n    }\n}"
  },
  {
    "function_name": "HashNumbers",
    "container": "ConcurrentTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "157-160",
    "snippet": "static uint64_t HashNumbers(uint64_t k, uint64_t g) {\n    uint64_t data[2] = { k, g };\n    return Hash(reinterpret_cast<char*>(data), sizeof(data), 0);\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Hash",
          "args": [
            "reinterpret_cast<char*>(data)",
            "sizeof(data)",
            "0"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "Hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/hash.cc",
          "lines": "18-49",
          "snippet": "uint32_t Hash(const char* data, size_t n, uint32_t seed) {\n  // Similar to murmur hash\n  const uint32_t m = 0xc6a4a793;\n  const uint32_t r = 24;\n  const char* limit = data + n;\n  uint32_t h = seed ^ (n * m);\n\n  // Pick up four bytes at a time\n  while (data + 4 <= limit) {\n    uint32_t w = DecodeFixed32(data);\n    data += 4;\n    h += w;\n    h *= m;\n    h ^= (h >> 16);\n  }\n\n  // Pick up remaining bytes\n  switch (limit - data) {\n    case 3:\n      h += data[2] << 16;\n      FALLTHROUGH_INTENDED;\n    case 2:\n      h += data[1] << 8;\n      FALLTHROUGH_INTENDED;\n    case 1:\n      h += data[0];\n      h *= m;\n      h ^= (h >> r);\n      break;\n  }\n  return h;\n}",
          "includes": [
            "#include \"util/hash.h\"",
            "#include \"util/coding.h\"",
            "#include <string.h>"
          ],
          "macros_used": [
            "#define FALLTHROUGH_INTENDED do { } while (0)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/hash.h\"\n#include \"util/coding.h\"\n#include <string.h>\n\n#define FALLTHROUGH_INTENDED do { } while (0)\n\nuint32_t Hash(const char* data, size_t n, uint32_t seed) {\n  // Similar to murmur hash\n  const uint32_t m = 0xc6a4a793;\n  const uint32_t r = 24;\n  const char* limit = data + n;\n  uint32_t h = seed ^ (n * m);\n\n  // Pick up four bytes at a time\n  while (data + 4 <= limit) {\n    uint32_t w = DecodeFixed32(data);\n    data += 4;\n    h += w;\n    h *= m;\n    h ^= (h >> 16);\n  }\n\n  // Pick up remaining bytes\n  switch (limit - data) {\n    case 3:\n      h += data[2] << 16;\n      FALLTHROUGH_INTENDED;\n    case 2:\n      h += data[1] << 8;\n      FALLTHROUGH_INTENDED;\n    case 1:\n      h += data[0];\n      h *= m;\n      h ^= (h >> r);\n      break;\n  }\n  return h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<char*>",
          "args": [
            "data"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static uint64_t HashNumbers(uint64_t k, uint64_t g) {\n      uint64_t data[2] = { k, g };\n      return Hash(reinterpret_cast<char*>(data), sizeof(data), 0);\n    }\n}"
  },
  {
    "function_name": "hash",
    "container": "ConcurrentTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "155-155",
    "snippet": "static uint64_t hash(Key key) { return key & 0xff; }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static uint64_t hash(Key key) { return key & 0xff; }\n}"
  },
  {
    "function_name": "gen",
    "container": "ConcurrentTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "154-154",
    "snippet": "static uint64_t gen(Key key) { return (key >> 8) & 0xffffffffu; }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static uint64_t gen(Key key) { return (key >> 8) & 0xffffffffu; }\n}"
  },
  {
    "function_name": "key",
    "container": "ConcurrentTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "153-153",
    "snippet": "static uint64_t key(Key key) { return (key >> 40); }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static uint64_t key(Key key) { return (key >> 40); }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "47-123",
    "snippet": "TEST(SkipTest, InsertAndLookup) {\n  const int N = 2000;\n  const int R = 5000;\n  Random rnd(1000);\n  std::set<Key> keys;\n  Arena arena;\n  Comparator cmp;\n  SkipList<Key, Comparator> list(cmp, &arena);\n  for (int i = 0; i < N; i++) {\n    Key key = rnd.Next() % R;\n    if (keys.insert(key).second) {\n      list.Insert(key);\n    }\n  }\n\n  for (int i = 0; i < R; i++) {\n    if (list.Contains(i)) {\n      ASSERT_EQ(keys.count(i), 1);\n    } else {\n      ASSERT_EQ(keys.count(i), 0);\n    }\n  }\n\n  // Simple iterator tests\n  {\n    SkipList<Key, Comparator>::Iterator iter(&list);\n    ASSERT_TRUE(!iter.Valid());\n\n    iter.Seek(0);\n    ASSERT_TRUE(iter.Valid());\n    ASSERT_EQ(*(keys.begin()), iter.key());\n\n    iter.SeekToFirst();\n    ASSERT_TRUE(iter.Valid());\n    ASSERT_EQ(*(keys.begin()), iter.key());\n\n    iter.SeekToLast();\n    ASSERT_TRUE(iter.Valid());\n    ASSERT_EQ(*(keys.rbegin()), iter.key());\n  }\n\n  // Forward iteration test\n  for (int i = 0; i < R; i++) {\n    SkipList<Key, Comparator>::Iterator iter(&list);\n    iter.Seek(i);\n\n    // Compare against model iterator\n    std::set<Key>::iterator model_iter = keys.lower_bound(i);\n    for (int j = 0; j < 3; j++) {\n      if (model_iter == keys.end()) {\n        ASSERT_TRUE(!iter.Valid());\n        break;\n      } else {\n        ASSERT_TRUE(iter.Valid());\n        ASSERT_EQ(*model_iter, iter.key());\n        ++model_iter;\n        iter.Next();\n      }\n    }\n  }\n\n  // Backward iteration test\n  {\n    SkipList<Key, Comparator>::Iterator iter(&list);\n    iter.SeekToLast();\n\n    // Compare against model iterator\n    for (std::set<Key>::reverse_iterator model_iter = keys.rbegin();\n         model_iter != keys.rend();\n         ++model_iter) {\n      ASSERT_TRUE(iter.Valid());\n      ASSERT_EQ(*model_iter, iter.key());\n      iter.Prev();\n    }\n    ASSERT_TRUE(!iter.Valid());\n  }\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter.Valid()"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter.Valid",
          "args": [],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "65-65",
          "snippet": "virtual bool Valid() const { return valid_; }",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  virtual bool Valid() const { return valid_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter.Prev",
          "args": [],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "Prev",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "205-230",
          "snippet": "void DBIter::Prev() {\n  assert(valid_);\n\n  if (direction_ == kForward) {  // Switch directions?\n    // iter_ is pointing at the current entry.  Scan backwards until\n    // the key changes so we can use the normal reverse scanning code.\n    assert(iter_->Valid());  // Otherwise valid_ would have been false\n    SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n    while (true) {\n      iter_->Prev();\n      if (!iter_->Valid()) {\n        valid_ = false;\n        saved_key_.clear();\n        ClearSavedValue();\n        return;\n      }\n      if (user_comparator_->Compare(ExtractUserKey(iter_->key()),\n                                    saved_key_) < 0) {\n        break;\n      }\n    }\n    direction_ = kReverse;\n  }\n\n  FindPrevUserEntry();\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::Prev() {\n    assert(valid_);\n  \n    if (direction_ == kForward) {  // Switch directions?\n      // iter_ is pointing at the current entry.  Scan backwards until\n      // the key changes so we can use the normal reverse scanning code.\n      assert(iter_->Valid());  // Otherwise valid_ would have been false\n      SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n      while (true) {\n        iter_->Prev();\n        if (!iter_->Valid()) {\n          valid_ = false;\n          saved_key_.clear();\n          ClearSavedValue();\n          return;\n        }\n        if (user_comparator_->Compare(ExtractUserKey(iter_->key()),\n                                      saved_key_) < 0) {\n          break;\n        }\n      }\n      direction_ = kReverse;\n    }\n  \n    FindPrevUserEntry();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "*model_iter",
            "iter.key()"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter.key",
          "args": [],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "66-69",
          "snippet": "virtual Slice key() const {\n    assert(valid_);\n    return (direction_ == kForward) ? ExtractUserKey(iter_->key()) : saved_key_;\n  }",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  virtual Slice key() const {\n      assert(valid_);\n      return (direction_ == kForward) ? ExtractUserKey(iter_->key()) : saved_key_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "iter.Valid()"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keys.rend",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keys.rbegin",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter.SeekToLast",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToLast",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "299-304",
          "snippet": "void DBIter::SeekToLast() {\n  direction_ = kReverse;\n  ClearSavedValue();\n  iter_->SeekToLast();\n  FindPrevUserEntry();\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::SeekToLast() {\n    direction_ = kReverse;\n    ClearSavedValue();\n    iter_->SeekToLast();\n    FindPrevUserEntry();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter.Next",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "146-171",
          "snippet": "void DBIter::Next() {\n  assert(valid_);\n\n  if (direction_ == kReverse) {  // Switch directions?\n    direction_ = kForward;\n    // iter_ is pointing just before the entries for this->key(),\n    // so advance into the range of entries for this->key() and then\n    // use the normal skipping code below.\n    if (!iter_->Valid()) {\n      iter_->SeekToFirst();\n    } else {\n      iter_->Next();\n    }\n    if (!iter_->Valid()) {\n      valid_ = false;\n      saved_key_.clear();\n      return;\n    }\n    // saved_key_ already contains the key to skip past.\n  } else {\n    // Store in saved_key_ the current key so we skip it below.\n    SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n  }\n\n  FindNextUserEntry(true, &saved_key_);\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::Next() {\n    assert(valid_);\n  \n    if (direction_ == kReverse) {  // Switch directions?\n      direction_ = kForward;\n      // iter_ is pointing just before the entries for this->key(),\n      // so advance into the range of entries for this->key() and then\n      // use the normal skipping code below.\n      if (!iter_->Valid()) {\n        iter_->SeekToFirst();\n      } else {\n        iter_->Next();\n      }\n      if (!iter_->Valid()) {\n        valid_ = false;\n        saved_key_.clear();\n        return;\n      }\n      // saved_key_ already contains the key to skip past.\n    } else {\n      // Store in saved_key_ the current key so we skip it below.\n      SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n    }\n  \n    FindNextUserEntry(true, &saved_key_);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "*model_iter",
            "iter.key()"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "iter.Valid()"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter.Valid()"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keys.end",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "keys.lower_bound",
          "args": [
            "i"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter.Seek",
          "args": [
            "i"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "Seek",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "274-286",
          "snippet": "void DBIter::Seek(const Slice& target) {\n  direction_ = kForward;\n  ClearSavedValue();\n  saved_key_.clear();\n  AppendInternalKey(\n      &saved_key_, ParsedInternalKey(target, sequence_, kValueTypeForSeek));\n  iter_->Seek(saved_key_);\n  if (iter_->Valid()) {\n    FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n  } else {\n    valid_ = false;\n  }\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::Seek(const Slice& target) {\n    direction_ = kForward;\n    ClearSavedValue();\n    saved_key_.clear();\n    AppendInternalKey(\n        &saved_key_, ParsedInternalKey(target, sequence_, kValueTypeForSeek));\n    iter_->Seek(saved_key_);\n    if (iter_->Valid()) {\n      FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n    } else {\n      valid_ = false;\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "*(keys.rbegin())",
            "iter.key()"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keys.rbegin",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "iter.Valid()"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "*(keys.begin())",
            "iter.key()"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keys.begin",
          "args": [],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "iter.Valid()"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter.SeekToFirst",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "288-297",
          "snippet": "void DBIter::SeekToFirst() {\n  direction_ = kForward;\n  ClearSavedValue();\n  iter_->SeekToFirst();\n  if (iter_->Valid()) {\n    FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n  } else {\n    valid_ = false;\n  }\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::SeekToFirst() {\n    direction_ = kForward;\n    ClearSavedValue();\n    iter_->SeekToFirst();\n    if (iter_->Valid()) {\n      FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n    } else {\n      valid_ = false;\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "*(keys.begin())",
            "iter.key()"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "iter.Valid()"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter.Valid()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "keys.count(i)",
            "0"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keys.count",
          "args": [
            "i"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "keys.count(i)",
            "1"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list.Contains",
          "args": [
            "i"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "Contains",
          "container": "SkipList<Key,Comparator>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "370-377",
          "snippet": "bool SkipList<Key,Comparator>::Contains(const Key& key) const {\n  Node* x = FindGreaterOrEqual(key, NULL);\n  if (x != NULL && Equal(key, x->key)) {\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  bool SkipList<Key,Comparator>::Contains(const Key& key) const {\n    Node* x = FindGreaterOrEqual(key, NULL);\n    if (x != NULL && Equal(key, x->key)) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "list.Insert",
          "args": [
            "key"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "Insert",
          "container": "SkipList<Key,Comparator>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "334-367",
          "snippet": "void SkipList<Key,Comparator>::Insert(const Key& key) {\n  // TODO(opt): We can use a barrier-free variant of FindGreaterOrEqual()\n  // here since Insert() is externally synchronized.\n  Node* prev[kMaxHeight];\n  Node* x = FindGreaterOrEqual(key, prev);\n\n  // Our data structure does not allow duplicate insertion\n  assert(x == NULL || !Equal(key, x->key));\n\n  int height = RandomHeight();\n  if (height > GetMaxHeight()) {\n    for (int i = GetMaxHeight(); i < height; i++) {\n      prev[i] = head_;\n    }\n    //fprintf(stderr, \"Change height from %d to %d\\n\", max_height_, height);\n\n    // It is ok to mutate max_height_ without any synchronization\n    // with concurrent readers.  A concurrent reader that observes\n    // the new value of max_height_ will see either the old value of\n    // new level pointers from head_ (NULL), or a new value set in\n    // the loop below.  In the former case the reader will\n    // immediately drop to the next level since NULL sorts after all\n    // keys.  In the latter case the reader will use the new node.\n    max_height_.NoBarrier_Store(reinterpret_cast<void*>(height));\n  }\n\n  x = NewNode(key, height);\n  for (int i = 0; i < height; i++) {\n    // NoBarrier_SetNext() suffices since we will add a barrier when\n    // we publish a pointer to \"x\" in prev[i].\n    x->NoBarrier_SetNext(i, prev[i]->NoBarrier_Next(i));\n    prev[i]->SetNext(i, x);\n  }\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  void SkipList<Key,Comparator>::Insert(const Key& key) {\n    // TODO(opt): We can use a barrier-free variant of FindGreaterOrEqual()\n    // here since Insert() is externally synchronized.\n    Node* prev[kMaxHeight];\n    Node* x = FindGreaterOrEqual(key, prev);\n  \n    // Our data structure does not allow duplicate insertion\n    assert(x == NULL || !Equal(key, x->key));\n  \n    int height = RandomHeight();\n    if (height > GetMaxHeight()) {\n      for (int i = GetMaxHeight(); i < height; i++) {\n        prev[i] = head_;\n      }\n      //fprintf(stderr, \"Change height from %d to %d\\n\", max_height_, height);\n  \n      // It is ok to mutate max_height_ without any synchronization\n      // with concurrent readers.  A concurrent reader that observes\n      // the new value of max_height_ will see either the old value of\n      // new level pointers from head_ (NULL), or a new value set in\n      // the loop below.  In the former case the reader will\n      // immediately drop to the next level since NULL sorts after all\n      // keys.  In the latter case the reader will use the new node.\n      max_height_.NoBarrier_Store(reinterpret_cast<void*>(height));\n    }\n  \n    x = NewNode(key, height);\n    for (int i = 0; i < height; i++) {\n      // NoBarrier_SetNext() suffices since we will add a barrier when\n      // we publish a pointer to \"x\" in prev[i].\n      x->NoBarrier_SetNext(i, prev[i]->NoBarrier_Next(i));\n      prev[i]->SetNext(i, x);\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "keys.insert",
          "args": [
            "key"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "61-65",
          "snippet": "void CBloomFilter::insert(const uint256& hash)\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    insert(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  void CBloomFilter::insert(const uint256& hash)\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      insert(data);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nTEST(SkipTest, InsertAndLookup) {\n  const int N = 2000;\n  const int R = 5000;\n  Random rnd(1000);\n  std::set<Key> keys;\n  Arena arena;\n  Comparator cmp;\n  SkipList<Key, Comparator> list(cmp, &arena);\n  for (int i = 0; i < N; i++) {\n    Key key = rnd.Next() % R;\n    if (keys.insert(key).second) {\n      list.Insert(key);\n    }\n  }\n\n  for (int i = 0; i < R; i++) {\n    if (list.Contains(i)) {\n      ASSERT_EQ(keys.count(i), 1);\n    } else {\n      ASSERT_EQ(keys.count(i), 0);\n    }\n  }\n\n  // Simple iterator tests\n  {\n    SkipList<Key, Comparator>::Iterator iter(&list);\n    ASSERT_TRUE(!iter.Valid());\n\n    iter.Seek(0);\n    ASSERT_TRUE(iter.Valid());\n    ASSERT_EQ(*(keys.begin()), iter.key());\n\n    iter.SeekToFirst();\n    ASSERT_TRUE(iter.Valid());\n    ASSERT_EQ(*(keys.begin()), iter.key());\n\n    iter.SeekToLast();\n    ASSERT_TRUE(iter.Valid());\n    ASSERT_EQ(*(keys.rbegin()), iter.key());\n  }\n\n  // Forward iteration test\n  for (int i = 0; i < R; i++) {\n    SkipList<Key, Comparator>::Iterator iter(&list);\n    iter.Seek(i);\n\n    // Compare against model iterator\n    std::set<Key>::iterator model_iter = keys.lower_bound(i);\n    for (int j = 0; j < 3; j++) {\n      if (model_iter == keys.end()) {\n        ASSERT_TRUE(!iter.Valid());\n        break;\n      } else {\n        ASSERT_TRUE(iter.Valid());\n        ASSERT_EQ(*model_iter, iter.key());\n        ++model_iter;\n        iter.Next();\n      }\n    }\n  }\n\n  // Backward iteration test\n  {\n    SkipList<Key, Comparator>::Iterator iter(&list);\n    iter.SeekToLast();\n\n    // Compare against model iterator\n    for (std::set<Key>::reverse_iterator model_iter = keys.rbegin();\n         model_iter != keys.rend();\n         ++model_iter) {\n      ASSERT_TRUE(iter.Valid());\n      ASSERT_EQ(*model_iter, iter.key());\n      iter.Prev();\n    }\n    ASSERT_TRUE(!iter.Valid());\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
    "lines": "31-45",
    "snippet": "TEST(SkipTest, Empty) {\n  Arena arena;\n  Comparator cmp;\n  SkipList<Key, Comparator> list(cmp, &arena);\n  ASSERT_TRUE(!list.Contains(10));\n\n  SkipList<Key, Comparator>::Iterator iter(&list);\n  ASSERT_TRUE(!iter.Valid());\n  iter.SeekToFirst();\n  ASSERT_TRUE(!iter.Valid());\n  iter.Seek(100);\n  ASSERT_TRUE(!iter.Valid());\n  iter.SeekToLast();\n  ASSERT_TRUE(!iter.Valid());\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/random.h\"",
      "#include \"util/hash.h\"",
      "#include \"util/arena.h\"",
      "#include \"leveldb/env.h\"",
      "#include <set>",
      "#include \"db/skiplist.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter.Valid()"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter.Valid",
          "args": [],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "65-65",
          "snippet": "virtual bool Valid() const { return valid_; }",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  virtual bool Valid() const { return valid_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter.SeekToLast",
          "args": [],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToLast",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "299-304",
          "snippet": "void DBIter::SeekToLast() {\n  direction_ = kReverse;\n  ClearSavedValue();\n  iter_->SeekToLast();\n  FindPrevUserEntry();\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::SeekToLast() {\n    direction_ = kReverse;\n    ClearSavedValue();\n    iter_->SeekToLast();\n    FindPrevUserEntry();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter.Valid()"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter.Seek",
          "args": [
            "100"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "Seek",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "274-286",
          "snippet": "void DBIter::Seek(const Slice& target) {\n  direction_ = kForward;\n  ClearSavedValue();\n  saved_key_.clear();\n  AppendInternalKey(\n      &saved_key_, ParsedInternalKey(target, sequence_, kValueTypeForSeek));\n  iter_->Seek(saved_key_);\n  if (iter_->Valid()) {\n    FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n  } else {\n    valid_ = false;\n  }\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::Seek(const Slice& target) {\n    direction_ = kForward;\n    ClearSavedValue();\n    saved_key_.clear();\n    AppendInternalKey(\n        &saved_key_, ParsedInternalKey(target, sequence_, kValueTypeForSeek));\n    iter_->Seek(saved_key_);\n    if (iter_->Valid()) {\n      FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n    } else {\n      valid_ = false;\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter.Valid()"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter.SeekToFirst",
          "args": [],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "288-297",
          "snippet": "void DBIter::SeekToFirst() {\n  direction_ = kForward;\n  ClearSavedValue();\n  iter_->SeekToFirst();\n  if (iter_->Valid()) {\n    FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n  } else {\n    valid_ = false;\n  }\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::SeekToFirst() {\n    direction_ = kForward;\n    ClearSavedValue();\n    iter_->SeekToFirst();\n    if (iter_->Valid()) {\n      FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n    } else {\n      valid_ = false;\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter.Valid()"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!list.Contains(10)"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list.Contains",
          "args": [
            "10"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "Contains",
          "container": "SkipList<Key,Comparator>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "370-377",
          "snippet": "bool SkipList<Key,Comparator>::Contains(const Key& key) const {\n  Node* x = FindGreaterOrEqual(key, NULL);\n  if (x != NULL && Equal(key, x->key)) {\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  bool SkipList<Key,Comparator>::Contains(const Key& key) const {\n    Node* x = FindGreaterOrEqual(key, NULL);\n    if (x != NULL && Equal(key, x->key)) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nTEST(SkipTest, Empty) {\n  Arena arena;\n  Comparator cmp;\n  SkipList<Key, Comparator> list(cmp, &arena);\n  ASSERT_TRUE(!list.Contains(10));\n\n  SkipList<Key, Comparator>::Iterator iter(&list);\n  ASSERT_TRUE(!iter.Valid());\n  iter.SeekToFirst();\n  ASSERT_TRUE(!iter.Valid());\n  iter.Seek(100);\n  ASSERT_TRUE(!iter.Valid());\n  iter.SeekToLast();\n  ASSERT_TRUE(!iter.Valid());\n}"
  }
]