[
  {
    "function_name": "PBKDF2_SHA256",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
    "lines": "97-147",
    "snippet": "void\nPBKDF2_SHA256(const uint8_t * passwd, size_t passwdlen, const uint8_t * salt,\n    size_t saltlen, uint64_t c, uint8_t * buf, size_t dkLen)\n{\n    HMAC_SHA256_CTX PShctx, hctx;\n    size_t i;\n    uint8_t ivec[4];\n    uint8_t U[32];\n    uint8_t T[32];\n    uint64_t j;\n    int k;\n    size_t clen;\n\n    /* Compute HMAC state after processing P and S. */\n    HMAC_SHA256_Init(&PShctx, passwd, passwdlen);\n    HMAC_SHA256_Update(&PShctx, salt, saltlen);\n\n    /* Iterate through the blocks. */\n    for (i = 0; i * 32 < dkLen; i++) {\n        /* Generate INT(i + 1). */\n        be32enc(ivec, (uint32_t)(i + 1));\n\n        /* Compute U_1 = PRF(P, S || INT(i)). */\n        memcpy(&hctx, &PShctx, sizeof(HMAC_SHA256_CTX));\n        HMAC_SHA256_Update(&hctx, ivec, 4);\n        HMAC_SHA256_Final(U, &hctx);\n\n        /* T_i = U_1 ... */\n        memcpy(T, U, 32);\n\n        for (j = 2; j <= c; j++) {\n            /* Compute U_j. */\n            HMAC_SHA256_Init(&hctx, passwd, passwdlen);\n            HMAC_SHA256_Update(&hctx, U, 32);\n            HMAC_SHA256_Final(U, &hctx);\n\n            /* ... xor U_j ... */\n            for (k = 0; k < 32; k++)\n                T[k] ^= U[k];\n        }\n\n        /* Copy as many bytes as necessary into buf. */\n        clen = dkLen - i * 32;\n        if (clen > 32)\n            clen = 32;\n        memcpy(&buf[i * 32], T, clen);\n    }\n\n    /* Clean PShctx, since we never called _Final on it. */\n    memset(&PShctx, 0, sizeof(HMAC_SHA256_CTX));\n}",
    "includes": [
      "#include \"pbkdf2.h\"",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&PShctx",
            "0",
            "sizeof(HMAC_SHA256_CTX)"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&buf[i * 32]",
            "T",
            "clen"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HMAC_SHA256_Final",
          "args": [
            "U",
            "&hctx"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "74-90",
          "snippet": "void\nHMAC_SHA256_Final(unsigned char digest[32], HMAC_SHA256_CTX * ctx)\n{\n    unsigned char ihash[32];\n\n    /* Finish the inner SHA256 operation. */\n    SHA256_Final(ihash, &ctx->ictx);\n\n    /* Feed the inner hash to the outer SHA256 operation. */\n    SHA256_Update(&ctx->octx, ihash, 32);\n\n    /* Finish the outer SHA256 operation. */\n    SHA256_Final(digest, &ctx->octx);\n\n    /* Clean the stack. */\n    memset(ihash, 0, 32);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Final(unsigned char digest[32], HMAC_SHA256_CTX * ctx)\n{\n    unsigned char ihash[32];\n\n    /* Finish the inner SHA256 operation. */\n    SHA256_Final(ihash, &ctx->ictx);\n\n    /* Feed the inner hash to the outer SHA256 operation. */\n    SHA256_Update(&ctx->octx, ihash, 32);\n\n    /* Finish the outer SHA256 operation. */\n    SHA256_Final(digest, &ctx->octx);\n\n    /* Clean the stack. */\n    memset(ihash, 0, 32);\n}"
        }
      },
      {
        "call_info": {
          "callee": "HMAC_SHA256_Update",
          "args": [
            "&hctx",
            "U",
            "32"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "65-71",
          "snippet": "void\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "HMAC_SHA256_Init",
          "args": [
            "&hctx",
            "passwd",
            "passwdlen"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "29-62",
          "snippet": "void\nHMAC_SHA256_Init(HMAC_SHA256_CTX * ctx, const void * _K, size_t Klen)\n{\n    unsigned char pad[64];\n    unsigned char khash[32];\n    const unsigned char * K = (const unsigned char *)_K;\n    size_t i;\n\n    /* If Klen > 64, the key is really SHA256(K). */\n    if (Klen > 64) {\n        SHA256_Init(&ctx->ictx);\n        SHA256_Update(&ctx->ictx, K, Klen);\n        SHA256_Final(khash, &ctx->ictx);\n        K = khash;\n        Klen = 32;\n    }\n\n    /* Inner SHA256 operation is SHA256(K xor [block of 0x36] || data). */\n    SHA256_Init(&ctx->ictx);\n    memset(pad, 0x36, 64);\n    for (i = 0; i < Klen; i++)\n        pad[i] ^= K[i];\n    SHA256_Update(&ctx->ictx, pad, 64);\n\n    /* Outer SHA256 operation is SHA256(K xor [block of 0x5c] || hash). */\n    SHA256_Init(&ctx->octx);\n    memset(pad, 0x5c, 64);\n    for (i = 0; i < Klen; i++)\n        pad[i] ^= K[i];\n    SHA256_Update(&ctx->octx, pad, 64);\n\n    /* Clean the stack. */\n    memset(khash, 0, 32);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Init(HMAC_SHA256_CTX * ctx, const void * _K, size_t Klen)\n{\n    unsigned char pad[64];\n    unsigned char khash[32];\n    const unsigned char * K = (const unsigned char *)_K;\n    size_t i;\n\n    /* If Klen > 64, the key is really SHA256(K). */\n    if (Klen > 64) {\n        SHA256_Init(&ctx->ictx);\n        SHA256_Update(&ctx->ictx, K, Klen);\n        SHA256_Final(khash, &ctx->ictx);\n        K = khash;\n        Klen = 32;\n    }\n\n    /* Inner SHA256 operation is SHA256(K xor [block of 0x36] || data). */\n    SHA256_Init(&ctx->ictx);\n    memset(pad, 0x36, 64);\n    for (i = 0; i < Klen; i++)\n        pad[i] ^= K[i];\n    SHA256_Update(&ctx->ictx, pad, 64);\n\n    /* Outer SHA256 operation is SHA256(K xor [block of 0x5c] || hash). */\n    SHA256_Init(&ctx->octx);\n    memset(pad, 0x5c, 64);\n    for (i = 0; i < Klen; i++)\n        pad[i] ^= K[i];\n    SHA256_Update(&ctx->octx, pad, 64);\n\n    /* Clean the stack. */\n    memset(khash, 0, 32);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "T",
            "U",
            "32"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&hctx",
            "&PShctx",
            "sizeof(HMAC_SHA256_CTX)"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32enc",
          "args": [
            "ivec",
            "(uint32_t)(i + 1)"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "be32enc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "15-24",
          "snippet": "static inline void\nbe32enc(void *pp, uint32_t x)\n{\n    uint8_t * p = (uint8_t *)pp;\n\n    p[3] = x & 0xff;\n    p[2] = (x >> 8) & 0xff;\n    p[1] = (x >> 16) & 0xff;\n    p[0] = (x >> 24) & 0xff;\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nstatic inline void\nbe32enc(void *pp, uint32_t x)\n{\n    uint8_t * p = (uint8_t *)pp;\n\n    p[3] = x & 0xff;\n    p[2] = (x >> 8) & 0xff;\n    p[1] = (x >> 16) & 0xff;\n    p[0] = (x >> 24) & 0xff;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nPBKDF2_SHA256(const uint8_t * passwd, size_t passwdlen, const uint8_t * salt,\n    size_t saltlen, uint64_t c, uint8_t * buf, size_t dkLen)\n{\n    HMAC_SHA256_CTX PShctx, hctx;\n    size_t i;\n    uint8_t ivec[4];\n    uint8_t U[32];\n    uint8_t T[32];\n    uint64_t j;\n    int k;\n    size_t clen;\n\n    /* Compute HMAC state after processing P and S. */\n    HMAC_SHA256_Init(&PShctx, passwd, passwdlen);\n    HMAC_SHA256_Update(&PShctx, salt, saltlen);\n\n    /* Iterate through the blocks. */\n    for (i = 0; i * 32 < dkLen; i++) {\n        /* Generate INT(i + 1). */\n        be32enc(ivec, (uint32_t)(i + 1));\n\n        /* Compute U_1 = PRF(P, S || INT(i)). */\n        memcpy(&hctx, &PShctx, sizeof(HMAC_SHA256_CTX));\n        HMAC_SHA256_Update(&hctx, ivec, 4);\n        HMAC_SHA256_Final(U, &hctx);\n\n        /* T_i = U_1 ... */\n        memcpy(T, U, 32);\n\n        for (j = 2; j <= c; j++) {\n            /* Compute U_j. */\n            HMAC_SHA256_Init(&hctx, passwd, passwdlen);\n            HMAC_SHA256_Update(&hctx, U, 32);\n            HMAC_SHA256_Final(U, &hctx);\n\n            /* ... xor U_j ... */\n            for (k = 0; k < 32; k++)\n                T[k] ^= U[k];\n        }\n\n        /* Copy as many bytes as necessary into buf. */\n        clen = dkLen - i * 32;\n        if (clen > 32)\n            clen = 32;\n        memcpy(&buf[i * 32], T, clen);\n    }\n\n    /* Clean PShctx, since we never called _Final on it. */\n    memset(&PShctx, 0, sizeof(HMAC_SHA256_CTX));\n}"
  },
  {
    "function_name": "HMAC_SHA256_Final",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
    "lines": "74-90",
    "snippet": "void\nHMAC_SHA256_Final(unsigned char digest[32], HMAC_SHA256_CTX * ctx)\n{\n    unsigned char ihash[32];\n\n    /* Finish the inner SHA256 operation. */\n    SHA256_Final(ihash, &ctx->ictx);\n\n    /* Feed the inner hash to the outer SHA256 operation. */\n    SHA256_Update(&ctx->octx, ihash, 32);\n\n    /* Finish the outer SHA256 operation. */\n    SHA256_Final(digest, &ctx->octx);\n\n    /* Clean the stack. */\n    memset(ihash, 0, 32);\n}",
    "includes": [
      "#include \"pbkdf2.h\"",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ihash",
            "0",
            "32"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHA256_Final",
          "args": [
            "digest",
            "&ctx->octx"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "74-90",
          "snippet": "void\nHMAC_SHA256_Final(unsigned char digest[32], HMAC_SHA256_CTX * ctx)\n{\n    unsigned char ihash[32];\n\n    /* Finish the inner SHA256 operation. */\n    SHA256_Final(ihash, &ctx->ictx);\n\n    /* Feed the inner hash to the outer SHA256 operation. */\n    SHA256_Update(&ctx->octx, ihash, 32);\n\n    /* Finish the outer SHA256 operation. */\n    SHA256_Final(digest, &ctx->octx);\n\n    /* Clean the stack. */\n    memset(ihash, 0, 32);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "SHA256_Update",
          "args": [
            "&ctx->octx",
            "ihash",
            "32"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "65-71",
          "snippet": "void\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Final(unsigned char digest[32], HMAC_SHA256_CTX * ctx)\n{\n    unsigned char ihash[32];\n\n    /* Finish the inner SHA256 operation. */\n    SHA256_Final(ihash, &ctx->ictx);\n\n    /* Feed the inner hash to the outer SHA256 operation. */\n    SHA256_Update(&ctx->octx, ihash, 32);\n\n    /* Finish the outer SHA256 operation. */\n    SHA256_Final(digest, &ctx->octx);\n\n    /* Clean the stack. */\n    memset(ihash, 0, 32);\n}"
  },
  {
    "function_name": "HMAC_SHA256_Update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
    "lines": "65-71",
    "snippet": "void\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}",
    "includes": [
      "#include \"pbkdf2.h\"",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SHA256_Update",
          "args": [
            "&ctx->ictx",
            "in",
            "len"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "65-71",
          "snippet": "void\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}"
  },
  {
    "function_name": "HMAC_SHA256_Init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
    "lines": "29-62",
    "snippet": "void\nHMAC_SHA256_Init(HMAC_SHA256_CTX * ctx, const void * _K, size_t Klen)\n{\n    unsigned char pad[64];\n    unsigned char khash[32];\n    const unsigned char * K = (const unsigned char *)_K;\n    size_t i;\n\n    /* If Klen > 64, the key is really SHA256(K). */\n    if (Klen > 64) {\n        SHA256_Init(&ctx->ictx);\n        SHA256_Update(&ctx->ictx, K, Klen);\n        SHA256_Final(khash, &ctx->ictx);\n        K = khash;\n        Klen = 32;\n    }\n\n    /* Inner SHA256 operation is SHA256(K xor [block of 0x36] || data). */\n    SHA256_Init(&ctx->ictx);\n    memset(pad, 0x36, 64);\n    for (i = 0; i < Klen; i++)\n        pad[i] ^= K[i];\n    SHA256_Update(&ctx->ictx, pad, 64);\n\n    /* Outer SHA256 operation is SHA256(K xor [block of 0x5c] || hash). */\n    SHA256_Init(&ctx->octx);\n    memset(pad, 0x5c, 64);\n    for (i = 0; i < Klen; i++)\n        pad[i] ^= K[i];\n    SHA256_Update(&ctx->octx, pad, 64);\n\n    /* Clean the stack. */\n    memset(khash, 0, 32);\n}",
    "includes": [
      "#include \"pbkdf2.h\"",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "khash",
            "0",
            "32"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHA256_Update",
          "args": [
            "&ctx->octx",
            "pad",
            "64"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "65-71",
          "snippet": "void\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "pad",
            "0x5c",
            "64"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHA256_Init",
          "args": [
            "&ctx->octx"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "pad",
            "0x36",
            "64"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHA256_Init",
          "args": [
            "&ctx->ictx"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHA256_Final",
          "args": [
            "khash",
            "&ctx->ictx"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "74-90",
          "snippet": "void\nHMAC_SHA256_Final(unsigned char digest[32], HMAC_SHA256_CTX * ctx)\n{\n    unsigned char ihash[32];\n\n    /* Finish the inner SHA256 operation. */\n    SHA256_Final(ihash, &ctx->ictx);\n\n    /* Feed the inner hash to the outer SHA256 operation. */\n    SHA256_Update(&ctx->octx, ihash, 32);\n\n    /* Finish the outer SHA256 operation. */\n    SHA256_Final(digest, &ctx->octx);\n\n    /* Clean the stack. */\n    memset(ihash, 0, 32);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Final(unsigned char digest[32], HMAC_SHA256_CTX * ctx)\n{\n    unsigned char ihash[32];\n\n    /* Finish the inner SHA256 operation. */\n    SHA256_Final(ihash, &ctx->ictx);\n\n    /* Feed the inner hash to the outer SHA256 operation. */\n    SHA256_Update(&ctx->octx, ihash, 32);\n\n    /* Finish the outer SHA256 operation. */\n    SHA256_Final(digest, &ctx->octx);\n\n    /* Clean the stack. */\n    memset(ihash, 0, 32);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHA256_Init",
          "args": [
            "&ctx->ictx"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Init(HMAC_SHA256_CTX * ctx, const void * _K, size_t Klen)\n{\n    unsigned char pad[64];\n    unsigned char khash[32];\n    const unsigned char * K = (const unsigned char *)_K;\n    size_t i;\n\n    /* If Klen > 64, the key is really SHA256(K). */\n    if (Klen > 64) {\n        SHA256_Init(&ctx->ictx);\n        SHA256_Update(&ctx->ictx, K, Klen);\n        SHA256_Final(khash, &ctx->ictx);\n        K = khash;\n        Klen = 32;\n    }\n\n    /* Inner SHA256 operation is SHA256(K xor [block of 0x36] || data). */\n    SHA256_Init(&ctx->ictx);\n    memset(pad, 0x36, 64);\n    for (i = 0; i < Klen; i++)\n        pad[i] ^= K[i];\n    SHA256_Update(&ctx->ictx, pad, 64);\n\n    /* Outer SHA256 operation is SHA256(K xor [block of 0x5c] || hash). */\n    SHA256_Init(&ctx->octx);\n    memset(pad, 0x5c, 64);\n    for (i = 0; i < Klen; i++)\n        pad[i] ^= K[i];\n    SHA256_Update(&ctx->octx, pad, 64);\n\n    /* Clean the stack. */\n    memset(khash, 0, 32);\n}"
  },
  {
    "function_name": "be32enc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
    "lines": "15-24",
    "snippet": "static inline void\nbe32enc(void *pp, uint32_t x)\n{\n    uint8_t * p = (uint8_t *)pp;\n\n    p[3] = x & 0xff;\n    p[2] = (x >> 8) & 0xff;\n    p[1] = (x >> 16) & 0xff;\n    p[0] = (x >> 24) & 0xff;\n}",
    "includes": [
      "#include \"pbkdf2.h\"",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nstatic inline void\nbe32enc(void *pp, uint32_t x)\n{\n    uint8_t * p = (uint8_t *)pp;\n\n    p[3] = x & 0xff;\n    p[2] = (x >> 8) & 0xff;\n    p[1] = (x >> 16) & 0xff;\n    p[0] = (x >> 24) & 0xff;\n}"
  },
  {
    "function_name": "be32dec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
    "lines": "6-13",
    "snippet": "static inline uint32_t\nbe32dec(const void *pp)\n{\n    const uint8_t *p = (uint8_t const *)pp;\n\n    return ((uint32_t)(p[3]) + ((uint32_t)(p[2]) << 8) +\n        ((uint32_t)(p[1]) << 16) + ((uint32_t)(p[0]) << 24));\n}",
    "includes": [
      "#include \"pbkdf2.h\"",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nstatic inline uint32_t\nbe32dec(const void *pp)\n{\n    const uint8_t *p = (uint8_t const *)pp;\n\n    return ((uint32_t)(p[3]) + ((uint32_t)(p[2]) << 8) +\n        ((uint32_t)(p[1]) << 16) + ((uint32_t)(p[0]) << 24));\n}"
  }
]