[
  {
    "function_name": "noui_connect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/noui.cpp",
    "lines": "23-28",
    "snippet": "void noui_connect()\n{\n    // Connect bitcoind signal handlers\n    uiInterface.ThreadSafeMessageBox.connect(noui_ThreadSafeMessageBox);\n    uiInterface.ThreadSafeAskFee.connect(noui_ThreadSafeAskFee);\n}",
    "includes": [
      "#include <string>",
      "#include \"bitcoinrpc.h\"",
      "#include \"init.h\"",
      "#include \"ui_interface.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "uiInterface.ThreadSafeAskFee.connect",
          "args": [
            "noui_ThreadSafeAskFee"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uiInterface.ThreadSafeMessageBox.connect",
          "args": [
            "noui_ThreadSafeMessageBox"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string>\n#include \"bitcoinrpc.h\"\n#include \"init.h\"\n#include \"ui_interface.h\"\n\nvoid noui_connect()\n{\n    // Connect bitcoind signal handlers\n    uiInterface.ThreadSafeMessageBox.connect(noui_ThreadSafeMessageBox);\n    uiInterface.ThreadSafeAskFee.connect(noui_ThreadSafeAskFee);\n}"
  },
  {
    "function_name": "noui_ThreadSafeAskFee",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/noui.cpp",
    "lines": "18-21",
    "snippet": "static bool noui_ThreadSafeAskFee(int64_t nFeeRequired, const std::string& strCaption)\n{\n    return true;\n}",
    "includes": [
      "#include <string>",
      "#include \"bitcoinrpc.h\"",
      "#include \"init.h\"",
      "#include \"ui_interface.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string>\n#include \"bitcoinrpc.h\"\n#include \"init.h\"\n#include \"ui_interface.h\"\n\nstatic bool noui_ThreadSafeAskFee(int64_t nFeeRequired, const std::string& strCaption)\n{\n    return true;\n}"
  },
  {
    "function_name": "noui_ThreadSafeMessageBox",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/noui.cpp",
    "lines": "11-16",
    "snippet": "static int noui_ThreadSafeMessageBox(const std::string& message, const std::string& caption, int style)\n{\n    printf(\"%s: %s\\n\", caption.c_str(), message.c_str());\n    fprintf(stderr, \"%s: %s\\n\", caption.c_str(), message.c_str());\n    return 4;\n}",
    "includes": [
      "#include <string>",
      "#include \"bitcoinrpc.h\"",
      "#include \"init.h\"",
      "#include \"ui_interface.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%s: %s\\n\"",
            "caption.c_str()",
            "message.c_str()"
          ],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.c_str",
          "args": [],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "caption.c_str",
          "args": [],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: %s\\n\"",
            "caption.c_str()",
            "message.c_str()"
          ],
          "line": 13
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.c_str",
          "args": [],
          "line": 13
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "caption.c_str",
          "args": [],
          "line": 13
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string>\n#include \"bitcoinrpc.h\"\n#include \"init.h\"\n#include \"ui_interface.h\"\n\nstatic int noui_ThreadSafeMessageBox(const std::string& message, const std::string& caption, int style)\n{\n    printf(\"%s: %s\\n\", caption.c_str(), message.c_str());\n    fprintf(stderr, \"%s: %s\\n\", caption.c_str(), message.c_str());\n    return 4;\n}"
  }
]