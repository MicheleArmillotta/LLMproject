[
  {
    "function_name": "selectNewAddress",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "364-374",
    "snippet": "void AddressBookPage::selectNewAddress(const QModelIndex &parent, int begin, int end)\n{\n    QModelIndex idx = proxyModel->mapFromSource(model->index(begin, AddressTableModel::Address, parent));\n    if(idx.isValid() && (idx.data(Qt::EditRole).toString() == newAddressToSelect))\n    {\n        // Select row of newly created address, once\n        ui->tableView->setFocus();\n        ui->tableView->selectRow(idx.row());\n        newAddressToSelect.clear();\n    }\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "newAddressToSelect.clear",
          "args": [],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->tableView->selectRow",
          "args": [
            "idx.row()"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idx.row",
          "args": [],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tableView->setFocus",
          "args": [],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "setFocus",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "162-165",
          "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setFocus()\n  {\n      ui->payTo->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "idx.data",
          "args": [],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idx.data",
          "args": [
            "Qt::EditRole"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idx.isValid",
          "args": [],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "WalletModel::UnlockContext",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.h",
          "lines": "106-106",
          "snippet": "bool isValid() const { return valid; }",
          "includes": [
            "#include \"allocators.h\" /* for SecureString */",
            "#include <map>",
            "#include <vector>",
            "#include <QObject>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"allocators.h\" /* for SecureString */\n#include <map>\n#include <vector>\n#include <QObject>\n\nWalletModel {\n  UnlockContext {\n    bool isValid() const { return valid; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "proxyModel->mapFromSource",
          "args": [
            "model->index(begin, AddressTableModel::Address, parent)"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->index",
          "args": [
            "begin",
            "AddressTableModel::Address",
            "parent"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "index",
          "container": "TransactionTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "604-616",
          "snippet": "QModelIndex TransactionTableModel::index(int row, int column, const QModelIndex &parent) const\n{\n    Q_UNUSED(parent);\n    TransactionRecord *data = priv->index(row);\n    if(data)\n    {\n        return createIndex(row, column, priv->index(row));\n    }\n    else\n    {\n        return QModelIndex();\n    }\n}",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTableModel {\n  QModelIndex TransactionTableModel::index(int row, int column, const QModelIndex &parent) const\n  {\n      Q_UNUSED(parent);\n      TransactionRecord *data = priv->index(row);\n      if(data)\n      {\n          return createIndex(row, column, priv->index(row));\n      }\n      else\n      {\n          return QModelIndex();\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::selectNewAddress(const QModelIndex &parent, int begin, int end)\n  {\n      QModelIndex idx = proxyModel->mapFromSource(model->index(begin, AddressTableModel::Address, parent));\n      if(idx.isValid() && (idx.data(Qt::EditRole).toString() == newAddressToSelect))\n      {\n          // Select row of newly created address, once\n          ui->tableView->setFocus();\n          ui->tableView->selectRow(idx.row());\n          newAddressToSelect.clear();\n      }\n  }\n}"
  },
  {
    "function_name": "contextualMenu",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "355-362",
    "snippet": "void AddressBookPage::contextualMenu(const QPoint &point)\n{\n    QModelIndex index = ui->tableView->indexAt(point);\n    if(index.isValid())\n    {\n        contextMenu->exec(QCursor::pos());\n    }\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "contextMenu->exec",
          "args": [
            "QCursor::pos()"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCursor::pos",
          "args": [],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.isValid",
          "args": [],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "WalletModel::UnlockContext",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.h",
          "lines": "106-106",
          "snippet": "bool isValid() const { return valid; }",
          "includes": [
            "#include \"allocators.h\" /* for SecureString */",
            "#include <map>",
            "#include <vector>",
            "#include <QObject>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"allocators.h\" /* for SecureString */\n#include <map>\n#include <vector>\n#include <QObject>\n\nWalletModel {\n  UnlockContext {\n    bool isValid() const { return valid; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->tableView->indexAt",
          "args": [
            "point"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::contextualMenu(const QPoint &point)\n  {\n      QModelIndex index = ui->tableView->indexAt(point);\n      if(index.isValid())\n      {\n          contextMenu->exec(QCursor::pos());\n      }\n  }\n}"
  },
  {
    "function_name": "on_showQRCode_clicked",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "336-353",
    "snippet": "void AddressBookPage::on_showQRCode_clicked()\n{\n#ifdef USE_QRCODE\n    QTableView *table = ui->tableView;\n    QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n\n    foreach (QModelIndex index, indexes)\n    {\n        QString address = index.data().toString(), label = index.sibling(index.row(), 0).data(Qt::EditRole).toString();\n\n        QRCodeDialog *dialog = new QRCodeDialog(address, label, tab == ReceivingTab, this);\n        if(optionsModel)\n            dialog->setModel(optionsModel);\n        dialog->setAttribute(Qt::WA_DeleteOnClose);\n        dialog->show();\n    }\n#endif\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dialog->show",
          "args": [],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->setAttribute",
          "args": [
            "Qt::WA_DeleteOnClose"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->setModel",
          "args": [
            "optionsModel"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "107-148",
          "snippet": "void AddressBookPage::setModel(AddressTableModel *model)\n{\n    this->model = model;\n    if(!model)\n        return;\n\n    proxyModel = new QSortFilterProxyModel(this);\n    proxyModel->setSourceModel(model);\n    proxyModel->setDynamicSortFilter(true);\n    proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n    proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n    switch(tab)\n    {\n    case ReceivingTab:\n        // Receive filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Receive);\n        break;\n    case SendingTab:\n        // Send filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Send);\n        break;\n    }\n    ui->tableView->setModel(proxyModel);\n    ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n\n    // Set column widths\n    ui->tableView->horizontalHeader()->resizeSection(\n            AddressTableModel::Address, 320);\n    ui->tableView->horizontalHeader()->setResizeMode(\n            AddressTableModel::Label, QHeaderView::Stretch);\n\n    connect(ui->tableView->selectionModel(), SIGNAL(selectionChanged(QItemSelection,QItemSelection)),\n            this, SLOT(selectionChanged()));\n\n    // Select row for newly created address\n    connect(model, SIGNAL(rowsInserted(QModelIndex,int,int)),\n            this, SLOT(selectNewAddress(QModelIndex,int,int)));\n\n    selectionChanged();\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::setModel(AddressTableModel *model)\n  {\n      this->model = model;\n      if(!model)\n          return;\n  \n      proxyModel = new QSortFilterProxyModel(this);\n      proxyModel->setSourceModel(model);\n      proxyModel->setDynamicSortFilter(true);\n      proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n      proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n      switch(tab)\n      {\n      case ReceivingTab:\n          // Receive filter\n          proxyModel->setFilterRole(AddressTableModel::TypeRole);\n          proxyModel->setFilterFixedString(AddressTableModel::Receive);\n          break;\n      case SendingTab:\n          // Send filter\n          proxyModel->setFilterRole(AddressTableModel::TypeRole);\n          proxyModel->setFilterFixedString(AddressTableModel::Send);\n          break;\n      }\n      ui->tableView->setModel(proxyModel);\n      ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n  \n      // Set column widths\n      ui->tableView->horizontalHeader()->resizeSection(\n              AddressTableModel::Address, 320);\n      ui->tableView->horizontalHeader()->setResizeMode(\n              AddressTableModel::Label, QHeaderView::Stretch);\n  \n      connect(ui->tableView->selectionModel(), SIGNAL(selectionChanged(QItemSelection,QItemSelection)),\n              this, SLOT(selectionChanged()));\n  \n      // Select row for newly created address\n      connect(model, SIGNAL(rowsInserted(QModelIndex,int,int)),\n              this, SLOT(selectNewAddress(QModelIndex,int,int)));\n  \n      selectionChanged();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "index.sibling",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.sibling",
          "args": [
            "Qt::EditRole"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.sibling",
          "args": [
            "index.row()",
            "0"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.row",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [
            "AddressTableModel::Address"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::on_showQRCode_clicked()\n  {\n  #ifdef USE_QRCODE\n      QTableView *table = ui->tableView;\n      QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n  \n      foreach (QModelIndex index, indexes)\n      {\n          QString address = index.data().toString(), label = index.sibling(index.row(), 0).data(Qt::EditRole).toString();\n  \n          QRCodeDialog *dialog = new QRCodeDialog(address, label, tab == ReceivingTab, this);\n          if(optionsModel)\n              dialog->setModel(optionsModel);\n          dialog->setAttribute(Qt::WA_DeleteOnClose);\n          dialog->show();\n      }\n  #endif\n  }\n}"
  },
  {
    "function_name": "exportClicked",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "312-334",
    "snippet": "void AddressBookPage::exportClicked()\n{\n    // CSV is currently the only supported format\n    QString filename = GUIUtil::getSaveFileName(\n            this,\n            tr(\"Export Address Book Data\"), QString(),\n            tr(\"Comma separated file (*.csv)\"));\n\n    if (filename.isNull()) return;\n\n    CSVModelWriter writer(filename);\n\n    // name, column, role\n    writer.setModel(proxyModel);\n    writer.addColumn(\"Label\", AddressTableModel::Label, Qt::EditRole);\n    writer.addColumn(\"Address\", AddressTableModel::Address, Qt::EditRole);\n\n    if(!writer.write())\n    {\n        QMessageBox::critical(this, tr(\"Error exporting\"), tr(\"Could not write to file %1.\").arg(filename),\n                              QMessageBox::Abort, QMessageBox::Abort);\n    }\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QMessageBox::critical",
          "args": [
            "this",
            "tr(\"Error exporting\")",
            "tr(\"Could not write to file %1.\").arg(filename)",
            "QMessageBox::Abort",
            "QMessageBox::Abort"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "filename"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writer.write",
          "args": [],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "CSVModelWriter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
          "lines": "45-87",
          "snippet": "bool CSVModelWriter::write()\n{\n    QFile file(filename);\n    if(!file.open(QIODevice::WriteOnly | QIODevice::Text))\n        return false;\n    QTextStream out(&file);\n\n    int numRows = 0;\n    if(model)\n    {\n        numRows = model->rowCount();\n    }\n\n    // Header row\n    for(int i=0; i<columns.size(); ++i)\n    {\n        if(i!=0)\n        {\n            writeSep(out);\n        }\n        writeValue(out, columns[i].title);\n    }\n    writeNewline(out);\n\n    // Data rows\n    for(int j=0; j<numRows; ++j)\n    {\n        for(int i=0; i<columns.size(); ++i)\n        {\n            if(i!=0)\n            {\n                writeSep(out);\n            }\n            QVariant data = model->index(j, columns[i].column).data(columns[i].role);\n            writeValue(out, data.toString());\n        }\n        writeNewline(out);\n    }\n\n    file.close();\n\n    return file.error() == QFile::NoError;\n}",
          "includes": [
            "#include <QTextStream>",
            "#include <QFile>",
            "#include <QAbstractItemModel>",
            "#include \"csvmodelwriter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nCSVModelWriter {\n  bool CSVModelWriter::write()\n  {\n      QFile file(filename);\n      if(!file.open(QIODevice::WriteOnly | QIODevice::Text))\n          return false;\n      QTextStream out(&file);\n  \n      int numRows = 0;\n      if(model)\n      {\n          numRows = model->rowCount();\n      }\n  \n      // Header row\n      for(int i=0; i<columns.size(); ++i)\n      {\n          if(i!=0)\n          {\n              writeSep(out);\n          }\n          writeValue(out, columns[i].title);\n      }\n      writeNewline(out);\n  \n      // Data rows\n      for(int j=0; j<numRows; ++j)\n      {\n          for(int i=0; i<columns.size(); ++i)\n          {\n              if(i!=0)\n              {\n                  writeSep(out);\n              }\n              QVariant data = model->index(j, columns[i].column).data(columns[i].role);\n              writeValue(out, data.toString());\n          }\n          writeNewline(out);\n      }\n  \n      file.close();\n  \n      return file.error() == QFile::NoError;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writer.addColumn",
          "args": [
            "\"Address\"",
            "AddressTableModel::Address",
            "Qt::EditRole"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "addColumn",
          "container": "CSVModelWriter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/csvmodelwriter.cpp",
          "lines": "18-26",
          "snippet": "void CSVModelWriter::addColumn(const QString &title, int column, int role)\n{\n    Column col;\n    col.title = title;\n    col.column = column;\n    col.role = role;\n\n    columns.append(col);\n}",
          "includes": [
            "#include <QTextStream>",
            "#include <QFile>",
            "#include <QAbstractItemModel>",
            "#include \"csvmodelwriter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTextStream>\n#include <QFile>\n#include <QAbstractItemModel>\n#include \"csvmodelwriter.h\"\n\nCSVModelWriter {\n  void CSVModelWriter::addColumn(const QString &title, int column, int role)\n  {\n      Column col;\n      col.title = title;\n      col.column = column;\n      col.role = role;\n  \n      columns.append(col);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writer.setModel",
          "args": [
            "proxyModel"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "107-148",
          "snippet": "void AddressBookPage::setModel(AddressTableModel *model)\n{\n    this->model = model;\n    if(!model)\n        return;\n\n    proxyModel = new QSortFilterProxyModel(this);\n    proxyModel->setSourceModel(model);\n    proxyModel->setDynamicSortFilter(true);\n    proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n    proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n    switch(tab)\n    {\n    case ReceivingTab:\n        // Receive filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Receive);\n        break;\n    case SendingTab:\n        // Send filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Send);\n        break;\n    }\n    ui->tableView->setModel(proxyModel);\n    ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n\n    // Set column widths\n    ui->tableView->horizontalHeader()->resizeSection(\n            AddressTableModel::Address, 320);\n    ui->tableView->horizontalHeader()->setResizeMode(\n            AddressTableModel::Label, QHeaderView::Stretch);\n\n    connect(ui->tableView->selectionModel(), SIGNAL(selectionChanged(QItemSelection,QItemSelection)),\n            this, SLOT(selectionChanged()));\n\n    // Select row for newly created address\n    connect(model, SIGNAL(rowsInserted(QModelIndex,int,int)),\n            this, SLOT(selectNewAddress(QModelIndex,int,int)));\n\n    selectionChanged();\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::setModel(AddressTableModel *model)\n  {\n      this->model = model;\n      if(!model)\n          return;\n  \n      proxyModel = new QSortFilterProxyModel(this);\n      proxyModel->setSourceModel(model);\n      proxyModel->setDynamicSortFilter(true);\n      proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n      proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n      switch(tab)\n      {\n      case ReceivingTab:\n          // Receive filter\n          proxyModel->setFilterRole(AddressTableModel::TypeRole);\n          proxyModel->setFilterFixedString(AddressTableModel::Receive);\n          break;\n      case SendingTab:\n          // Send filter\n          proxyModel->setFilterRole(AddressTableModel::TypeRole);\n          proxyModel->setFilterFixedString(AddressTableModel::Send);\n          break;\n      }\n      ui->tableView->setModel(proxyModel);\n      ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n  \n      // Set column widths\n      ui->tableView->horizontalHeader()->resizeSection(\n              AddressTableModel::Address, 320);\n      ui->tableView->horizontalHeader()->setResizeMode(\n              AddressTableModel::Label, QHeaderView::Stretch);\n  \n      connect(ui->tableView->selectionModel(), SIGNAL(selectionChanged(QItemSelection,QItemSelection)),\n              this, SLOT(selectionChanged()));\n  \n      // Select row for newly created address\n      connect(model, SIGNAL(rowsInserted(QModelIndex,int,int)),\n              this, SLOT(selectNewAddress(QModelIndex,int,int)));\n  \n      selectionChanged();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "filename.isNull",
          "args": [],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::getSaveFileName",
          "args": [
            "this",
            "tr(\"Export Address Book Data\")",
            "QString()",
            "tr(\"Comma separated file (*.csv)\")"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::exportClicked()\n  {\n      // CSV is currently the only supported format\n      QString filename = GUIUtil::getSaveFileName(\n              this,\n              tr(\"Export Address Book Data\"), QString(),\n              tr(\"Comma separated file (*.csv)\"));\n  \n      if (filename.isNull()) return;\n  \n      CSVModelWriter writer(filename);\n  \n      // name, column, role\n      writer.setModel(proxyModel);\n      writer.addColumn(\"Label\", AddressTableModel::Label, Qt::EditRole);\n      writer.addColumn(\"Address\", AddressTableModel::Address, Qt::EditRole);\n  \n      if(!writer.write())\n      {\n          QMessageBox::critical(this, tr(\"Error exporting\"), tr(\"Could not write to file %1.\").arg(filename),\n                                QMessageBox::Abort, QMessageBox::Abort);\n      }\n  }\n}"
  },
  {
    "function_name": "done",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "285-310",
    "snippet": "void AddressBookPage::done(int retval)\n{\n    QTableView *table = ui->tableView;\n    if(!table->selectionModel() || !table->model())\n        return;\n    // When this is a tab/widget and not a model dialog, ignore \"done\"\n    if(mode == ForEditing)\n        return;\n\n    // Figure out which address was selected, and return it\n    QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n\n    foreach (QModelIndex index, indexes)\n    {\n        QVariant address = table->model()->data(index);\n        returnValue = address.toString();\n    }\n\n    if(returnValue.isEmpty())\n    {\n        // If no address entry selected, return rejected\n        retval = Rejected;\n    }\n\n    QDialog::done(retval);\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QDialog::done",
          "args": [
            "retval"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "done",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "285-310",
          "snippet": "void AddressBookPage::done(int retval)\n{\n    QTableView *table = ui->tableView;\n    if(!table->selectionModel() || !table->model())\n        return;\n    // When this is a tab/widget and not a model dialog, ignore \"done\"\n    if(mode == ForEditing)\n        return;\n\n    // Figure out which address was selected, and return it\n    QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n\n    foreach (QModelIndex index, indexes)\n    {\n        QVariant address = table->model()->data(index);\n        returnValue = address.toString();\n    }\n\n    if(returnValue.isEmpty())\n    {\n        // If no address entry selected, return rejected\n        retval = Rejected;\n    }\n\n    QDialog::done(retval);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "returnValue.isEmpty",
          "args": [],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "address.toString",
          "args": [],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->model",
          "args": [
            "index"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->model",
          "args": [],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [
            "AddressTableModel::Address"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->model",
          "args": [],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::done(int retval)\n  {\n      QTableView *table = ui->tableView;\n      if(!table->selectionModel() || !table->model())\n          return;\n      // When this is a tab/widget and not a model dialog, ignore \"done\"\n      if(mode == ForEditing)\n          return;\n  \n      // Figure out which address was selected, and return it\n      QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n  \n      foreach (QModelIndex index, indexes)\n      {\n          QVariant address = table->model()->data(index);\n          returnValue = address.toString();\n      }\n  \n      if(returnValue.isEmpty())\n      {\n          // If no address entry selected, return rejected\n          retval = Rejected;\n      }\n  \n      QDialog::done(retval);\n  }\n}"
  },
  {
    "function_name": "selectionChanged",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "240-283",
    "snippet": "void AddressBookPage::selectionChanged()\n{\n    // Set button states based on selected tab and selection\n    QTableView *table = ui->tableView;\n    if(!table->selectionModel())\n        return;\n\n    if(table->selectionModel()->hasSelection())\n    {\n        switch(tab)\n        {\n        case SendingTab:\n            // In sending tab, allow deletion of selection\n            ui->deleteButton->setEnabled(true);\n            ui->deleteButton->setVisible(true);\n            deleteAction->setEnabled(true);\n            ui->signMessage->setEnabled(false);\n            ui->signMessage->setVisible(false);\n            ui->verifyMessage->setEnabled(true);\n            ui->verifyMessage->setVisible(true);\n            break;\n        case ReceivingTab:\n            // Deleting receiving addresses, however, is not allowed\n            ui->deleteButton->setEnabled(false);\n            ui->deleteButton->setVisible(false);\n            deleteAction->setEnabled(false);\n            ui->signMessage->setEnabled(true);\n            ui->signMessage->setVisible(true);\n            ui->verifyMessage->setEnabled(false);\n            ui->verifyMessage->setVisible(false);\n            break;\n        }\n        ui->copyToClipboard->setEnabled(true);\n        ui->showQRCode->setEnabled(true);\n    }\n    else\n    {\n        ui->deleteButton->setEnabled(false);\n        ui->showQRCode->setEnabled(false);\n        ui->copyToClipboard->setEnabled(false);\n        ui->signMessage->setEnabled(false);\n        ui->verifyMessage->setEnabled(false);\n    }\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->verifyMessage->setEnabled",
          "args": [
            "false"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->signMessage->setEnabled",
          "args": [
            "false"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->copyToClipboard->setEnabled",
          "args": [
            "false"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->showQRCode->setEnabled",
          "args": [
            "false"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->deleteButton->setEnabled",
          "args": [
            "false"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->showQRCode->setEnabled",
          "args": [
            "true"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->copyToClipboard->setEnabled",
          "args": [
            "true"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->verifyMessage->setVisible",
          "args": [
            "false"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->verifyMessage->setEnabled",
          "args": [
            "false"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->signMessage->setVisible",
          "args": [
            "true"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->signMessage->setEnabled",
          "args": [
            "true"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deleteAction->setEnabled",
          "args": [
            "false"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->deleteButton->setVisible",
          "args": [
            "false"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->deleteButton->setEnabled",
          "args": [
            "false"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->verifyMessage->setVisible",
          "args": [
            "true"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->verifyMessage->setEnabled",
          "args": [
            "true"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->signMessage->setVisible",
          "args": [
            "false"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->signMessage->setEnabled",
          "args": [
            "false"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deleteAction->setEnabled",
          "args": [
            "true"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->deleteButton->setVisible",
          "args": [
            "true"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->deleteButton->setEnabled",
          "args": [
            "true"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::selectionChanged()\n  {\n      // Set button states based on selected tab and selection\n      QTableView *table = ui->tableView;\n      if(!table->selectionModel())\n          return;\n  \n      if(table->selectionModel()->hasSelection())\n      {\n          switch(tab)\n          {\n          case SendingTab:\n              // In sending tab, allow deletion of selection\n              ui->deleteButton->setEnabled(true);\n              ui->deleteButton->setVisible(true);\n              deleteAction->setEnabled(true);\n              ui->signMessage->setEnabled(false);\n              ui->signMessage->setVisible(false);\n              ui->verifyMessage->setEnabled(true);\n              ui->verifyMessage->setVisible(true);\n              break;\n          case ReceivingTab:\n              // Deleting receiving addresses, however, is not allowed\n              ui->deleteButton->setEnabled(false);\n              ui->deleteButton->setVisible(false);\n              deleteAction->setEnabled(false);\n              ui->signMessage->setEnabled(true);\n              ui->signMessage->setVisible(true);\n              ui->verifyMessage->setEnabled(false);\n              ui->verifyMessage->setVisible(false);\n              break;\n          }\n          ui->copyToClipboard->setEnabled(true);\n          ui->showQRCode->setEnabled(true);\n      }\n      else\n      {\n          ui->deleteButton->setEnabled(false);\n          ui->showQRCode->setEnabled(false);\n          ui->copyToClipboard->setEnabled(false);\n          ui->signMessage->setEnabled(false);\n          ui->verifyMessage->setEnabled(false);\n      }\n  }\n}"
  },
  {
    "function_name": "on_deleteButton_clicked",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "228-238",
    "snippet": "void AddressBookPage::on_deleteButton_clicked()\n{\n    QTableView *table = ui->tableView;\n    if(!table->selectionModel())\n        return;\n    QModelIndexList indexes = table->selectionModel()->selectedRows();\n    if(!indexes.isEmpty())\n    {\n        table->model()->removeRow(indexes.at(0).row());\n    }\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "table->model",
          "args": [
            "indexes.at(0).row()"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "indexes.at",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "indexes.at",
          "args": [
            "0"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->model",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "indexes.isEmpty",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::on_deleteButton_clicked()\n  {\n      QTableView *table = ui->tableView;\n      if(!table->selectionModel())\n          return;\n      QModelIndexList indexes = table->selectionModel()->selectedRows();\n      if(!indexes.isEmpty())\n      {\n          table->model()->removeRow(indexes.at(0).row());\n      }\n  }\n}"
  },
  {
    "function_name": "on_newAddressButton_clicked",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "213-226",
    "snippet": "void AddressBookPage::on_newAddressButton_clicked()\n{\n    if(!model)\n        return;\n    EditAddressDialog dlg(\n            tab == SendingTab ?\n            EditAddressDialog::NewSendingAddress :\n            EditAddressDialog::NewReceivingAddress, this);\n    dlg.setModel(model);\n    if(dlg.exec())\n    {\n        newAddressToSelect = dlg.getAddress();\n    }\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlg.getAddress",
          "args": [],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "getAddress",
          "container": "EditAddressDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
          "lines": "127-130",
          "snippet": "QString EditAddressDialog::getAddress() const\n{\n    return address;\n}",
          "includes": [
            "#include <QMessageBox>",
            "#include <QDataWidgetMapper>",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_editaddressdialog.h\"",
            "#include \"editaddressdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  QString EditAddressDialog::getAddress() const\n  {\n      return address;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlg.exec",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlg.setModel",
          "args": [
            "model"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "107-148",
          "snippet": "void AddressBookPage::setModel(AddressTableModel *model)\n{\n    this->model = model;\n    if(!model)\n        return;\n\n    proxyModel = new QSortFilterProxyModel(this);\n    proxyModel->setSourceModel(model);\n    proxyModel->setDynamicSortFilter(true);\n    proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n    proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n    switch(tab)\n    {\n    case ReceivingTab:\n        // Receive filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Receive);\n        break;\n    case SendingTab:\n        // Send filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Send);\n        break;\n    }\n    ui->tableView->setModel(proxyModel);\n    ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n\n    // Set column widths\n    ui->tableView->horizontalHeader()->resizeSection(\n            AddressTableModel::Address, 320);\n    ui->tableView->horizontalHeader()->setResizeMode(\n            AddressTableModel::Label, QHeaderView::Stretch);\n\n    connect(ui->tableView->selectionModel(), SIGNAL(selectionChanged(QItemSelection,QItemSelection)),\n            this, SLOT(selectionChanged()));\n\n    // Select row for newly created address\n    connect(model, SIGNAL(rowsInserted(QModelIndex,int,int)),\n            this, SLOT(selectNewAddress(QModelIndex,int,int)));\n\n    selectionChanged();\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::setModel(AddressTableModel *model)\n  {\n      this->model = model;\n      if(!model)\n          return;\n  \n      proxyModel = new QSortFilterProxyModel(this);\n      proxyModel->setSourceModel(model);\n      proxyModel->setDynamicSortFilter(true);\n      proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n      proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n      switch(tab)\n      {\n      case ReceivingTab:\n          // Receive filter\n          proxyModel->setFilterRole(AddressTableModel::TypeRole);\n          proxyModel->setFilterFixedString(AddressTableModel::Receive);\n          break;\n      case SendingTab:\n          // Send filter\n          proxyModel->setFilterRole(AddressTableModel::TypeRole);\n          proxyModel->setFilterFixedString(AddressTableModel::Send);\n          break;\n      }\n      ui->tableView->setModel(proxyModel);\n      ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n  \n      // Set column widths\n      ui->tableView->horizontalHeader()->resizeSection(\n              AddressTableModel::Address, 320);\n      ui->tableView->horizontalHeader()->setResizeMode(\n              AddressTableModel::Label, QHeaderView::Stretch);\n  \n      connect(ui->tableView->selectionModel(), SIGNAL(selectionChanged(QItemSelection,QItemSelection)),\n              this, SLOT(selectionChanged()));\n  \n      // Select row for newly created address\n      connect(model, SIGNAL(rowsInserted(QModelIndex,int,int)),\n              this, SLOT(selectNewAddress(QModelIndex,int,int)));\n  \n      selectionChanged();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::on_newAddressButton_clicked()\n  {\n      if(!model)\n          return;\n      EditAddressDialog dlg(\n              tab == SendingTab ?\n              EditAddressDialog::NewSendingAddress :\n              EditAddressDialog::NewReceivingAddress, this);\n      dlg.setModel(model);\n      if(dlg.exec())\n      {\n          newAddressToSelect = dlg.getAddress();\n      }\n  }\n}"
  },
  {
    "function_name": "on_verifyMessage_clicked",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "198-211",
    "snippet": "void AddressBookPage::on_verifyMessage_clicked()\n{\n    QTableView *table = ui->tableView;\n    QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n    QString addr;\n\n    foreach (QModelIndex index, indexes)\n    {\n        QVariant address = index.data();\n        addr = address.toString();\n    }\n\n    emit verifyMessage(addr);\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "address.toString",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [
            "AddressTableModel::Address"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::on_verifyMessage_clicked()\n  {\n      QTableView *table = ui->tableView;\n      QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n      QString addr;\n  \n      foreach (QModelIndex index, indexes)\n      {\n          QVariant address = index.data();\n          addr = address.toString();\n      }\n  \n      emit verifyMessage(addr);\n  }\n}"
  },
  {
    "function_name": "on_signMessage_clicked",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "183-196",
    "snippet": "void AddressBookPage::on_signMessage_clicked()\n{\n    QTableView *table = ui->tableView;\n    QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n    QString addr;\n\n    foreach (QModelIndex index, indexes)\n    {\n        QVariant address = index.data();\n        addr = address.toString();\n    }\n\n    emit signMessage(addr);\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "address.toString",
          "args": [],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [
            "AddressTableModel::Address"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "table->selectionModel",
          "args": [],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::on_signMessage_clicked()\n  {\n      QTableView *table = ui->tableView;\n      QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n      QString addr;\n  \n      foreach (QModelIndex index, indexes)\n      {\n          QVariant address = index.data();\n          addr = address.toString();\n      }\n  \n      emit signMessage(addr);\n  }\n}"
  },
  {
    "function_name": "onEditAction",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "165-181",
    "snippet": "void AddressBookPage::onEditAction()\n{\n    if(!ui->tableView->selectionModel())\n        return;\n    QModelIndexList indexes = ui->tableView->selectionModel()->selectedRows();\n    if(indexes.isEmpty())\n        return;\n\n    EditAddressDialog dlg(\n            tab == SendingTab ?\n            EditAddressDialog::EditSendingAddress :\n            EditAddressDialog::EditReceivingAddress);\n    dlg.setModel(model);\n    QModelIndex origIndex = proxyModel->mapToSource(indexes.at(0));\n    dlg.loadRow(origIndex.row());\n    dlg.exec();\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlg.exec",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlg.loadRow",
          "args": [
            "origIndex.row()"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "loadRow",
          "container": "EditAddressDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
          "lines": "55-58",
          "snippet": "void EditAddressDialog::loadRow(int row)\n{\n    mapper->setCurrentIndex(row);\n}",
          "includes": [
            "#include <QMessageBox>",
            "#include <QDataWidgetMapper>",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_editaddressdialog.h\"",
            "#include \"editaddressdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  void EditAddressDialog::loadRow(int row)\n  {\n      mapper->setCurrentIndex(row);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "origIndex.row",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proxyModel->mapToSource",
          "args": [
            "indexes.at(0)"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "indexes.at",
          "args": [
            "0"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlg.setModel",
          "args": [
            "model"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "107-148",
          "snippet": "void AddressBookPage::setModel(AddressTableModel *model)\n{\n    this->model = model;\n    if(!model)\n        return;\n\n    proxyModel = new QSortFilterProxyModel(this);\n    proxyModel->setSourceModel(model);\n    proxyModel->setDynamicSortFilter(true);\n    proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n    proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n    switch(tab)\n    {\n    case ReceivingTab:\n        // Receive filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Receive);\n        break;\n    case SendingTab:\n        // Send filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Send);\n        break;\n    }\n    ui->tableView->setModel(proxyModel);\n    ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n\n    // Set column widths\n    ui->tableView->horizontalHeader()->resizeSection(\n            AddressTableModel::Address, 320);\n    ui->tableView->horizontalHeader()->setResizeMode(\n            AddressTableModel::Label, QHeaderView::Stretch);\n\n    connect(ui->tableView->selectionModel(), SIGNAL(selectionChanged(QItemSelection,QItemSelection)),\n            this, SLOT(selectionChanged()));\n\n    // Select row for newly created address\n    connect(model, SIGNAL(rowsInserted(QModelIndex,int,int)),\n            this, SLOT(selectNewAddress(QModelIndex,int,int)));\n\n    selectionChanged();\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::setModel(AddressTableModel *model)\n  {\n      this->model = model;\n      if(!model)\n          return;\n  \n      proxyModel = new QSortFilterProxyModel(this);\n      proxyModel->setSourceModel(model);\n      proxyModel->setDynamicSortFilter(true);\n      proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n      proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n      switch(tab)\n      {\n      case ReceivingTab:\n          // Receive filter\n          proxyModel->setFilterRole(AddressTableModel::TypeRole);\n          proxyModel->setFilterFixedString(AddressTableModel::Receive);\n          break;\n      case SendingTab:\n          // Send filter\n          proxyModel->setFilterRole(AddressTableModel::TypeRole);\n          proxyModel->setFilterFixedString(AddressTableModel::Send);\n          break;\n      }\n      ui->tableView->setModel(proxyModel);\n      ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n  \n      // Set column widths\n      ui->tableView->horizontalHeader()->resizeSection(\n              AddressTableModel::Address, 320);\n      ui->tableView->horizontalHeader()->setResizeMode(\n              AddressTableModel::Label, QHeaderView::Stretch);\n  \n      connect(ui->tableView->selectionModel(), SIGNAL(selectionChanged(QItemSelection,QItemSelection)),\n              this, SLOT(selectionChanged()));\n  \n      // Select row for newly created address\n      connect(model, SIGNAL(rowsInserted(QModelIndex,int,int)),\n              this, SLOT(selectNewAddress(QModelIndex,int,int)));\n  \n      selectionChanged();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "indexes.isEmpty",
          "args": [],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tableView->selectionModel",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tableView->selectionModel",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tableView->selectionModel",
          "args": [],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::onEditAction()\n  {\n      if(!ui->tableView->selectionModel())\n          return;\n      QModelIndexList indexes = ui->tableView->selectionModel()->selectedRows();\n      if(indexes.isEmpty())\n          return;\n  \n      EditAddressDialog dlg(\n              tab == SendingTab ?\n              EditAddressDialog::EditSendingAddress :\n              EditAddressDialog::EditReceivingAddress);\n      dlg.setModel(model);\n      QModelIndex origIndex = proxyModel->mapToSource(indexes.at(0));\n      dlg.loadRow(origIndex.row());\n      dlg.exec();\n  }\n}"
  },
  {
    "function_name": "onCopyLabelAction",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "160-163",
    "snippet": "void AddressBookPage::onCopyLabelAction()\n{\n    GUIUtil::copyEntryData(ui->tableView, AddressTableModel::Label);\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GUIUtil::copyEntryData",
          "args": [
            "ui->tableView",
            "AddressTableModel::Label"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::onCopyLabelAction()\n  {\n      GUIUtil::copyEntryData(ui->tableView, AddressTableModel::Label);\n  }\n}"
  },
  {
    "function_name": "on_copyToClipboard_clicked",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "155-158",
    "snippet": "void AddressBookPage::on_copyToClipboard_clicked()\n{\n    GUIUtil::copyEntryData(ui->tableView, AddressTableModel::Address);\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GUIUtil::copyEntryData",
          "args": [
            "ui->tableView",
            "AddressTableModel::Address"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::on_copyToClipboard_clicked()\n  {\n      GUIUtil::copyEntryData(ui->tableView, AddressTableModel::Address);\n  }\n}"
  },
  {
    "function_name": "setOptionsModel",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "150-153",
    "snippet": "void AddressBookPage::setOptionsModel(OptionsModel *optionsModel)\n{\n    this->optionsModel = optionsModel;\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::setOptionsModel(OptionsModel *optionsModel)\n  {\n      this->optionsModel = optionsModel;\n  }\n}"
  },
  {
    "function_name": "setModel",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "107-148",
    "snippet": "void AddressBookPage::setModel(AddressTableModel *model)\n{\n    this->model = model;\n    if(!model)\n        return;\n\n    proxyModel = new QSortFilterProxyModel(this);\n    proxyModel->setSourceModel(model);\n    proxyModel->setDynamicSortFilter(true);\n    proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n    proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n    switch(tab)\n    {\n    case ReceivingTab:\n        // Receive filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Receive);\n        break;\n    case SendingTab:\n        // Send filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Send);\n        break;\n    }\n    ui->tableView->setModel(proxyModel);\n    ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n\n    // Set column widths\n    ui->tableView->horizontalHeader()->resizeSection(\n            AddressTableModel::Address, 320);\n    ui->tableView->horizontalHeader()->setResizeMode(\n            AddressTableModel::Label, QHeaderView::Stretch);\n\n    connect(ui->tableView->selectionModel(), SIGNAL(selectionChanged(QItemSelection,QItemSelection)),\n            this, SLOT(selectionChanged()));\n\n    // Select row for newly created address\n    connect(model, SIGNAL(rowsInserted(QModelIndex,int,int)),\n            this, SLOT(selectNewAddress(QModelIndex,int,int)));\n\n    selectionChanged();\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "selectionChanged",
          "args": [],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "selectionChanged",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "240-283",
          "snippet": "void AddressBookPage::selectionChanged()\n{\n    // Set button states based on selected tab and selection\n    QTableView *table = ui->tableView;\n    if(!table->selectionModel())\n        return;\n\n    if(table->selectionModel()->hasSelection())\n    {\n        switch(tab)\n        {\n        case SendingTab:\n            // In sending tab, allow deletion of selection\n            ui->deleteButton->setEnabled(true);\n            ui->deleteButton->setVisible(true);\n            deleteAction->setEnabled(true);\n            ui->signMessage->setEnabled(false);\n            ui->signMessage->setVisible(false);\n            ui->verifyMessage->setEnabled(true);\n            ui->verifyMessage->setVisible(true);\n            break;\n        case ReceivingTab:\n            // Deleting receiving addresses, however, is not allowed\n            ui->deleteButton->setEnabled(false);\n            ui->deleteButton->setVisible(false);\n            deleteAction->setEnabled(false);\n            ui->signMessage->setEnabled(true);\n            ui->signMessage->setVisible(true);\n            ui->verifyMessage->setEnabled(false);\n            ui->verifyMessage->setVisible(false);\n            break;\n        }\n        ui->copyToClipboard->setEnabled(true);\n        ui->showQRCode->setEnabled(true);\n    }\n    else\n    {\n        ui->deleteButton->setEnabled(false);\n        ui->showQRCode->setEnabled(false);\n        ui->copyToClipboard->setEnabled(false);\n        ui->signMessage->setEnabled(false);\n        ui->verifyMessage->setEnabled(false);\n    }\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::selectionChanged()\n  {\n      // Set button states based on selected tab and selection\n      QTableView *table = ui->tableView;\n      if(!table->selectionModel())\n          return;\n  \n      if(table->selectionModel()->hasSelection())\n      {\n          switch(tab)\n          {\n          case SendingTab:\n              // In sending tab, allow deletion of selection\n              ui->deleteButton->setEnabled(true);\n              ui->deleteButton->setVisible(true);\n              deleteAction->setEnabled(true);\n              ui->signMessage->setEnabled(false);\n              ui->signMessage->setVisible(false);\n              ui->verifyMessage->setEnabled(true);\n              ui->verifyMessage->setVisible(true);\n              break;\n          case ReceivingTab:\n              // Deleting receiving addresses, however, is not allowed\n              ui->deleteButton->setEnabled(false);\n              ui->deleteButton->setVisible(false);\n              deleteAction->setEnabled(false);\n              ui->signMessage->setEnabled(true);\n              ui->signMessage->setVisible(true);\n              ui->verifyMessage->setEnabled(false);\n              ui->verifyMessage->setVisible(false);\n              break;\n          }\n          ui->copyToClipboard->setEnabled(true);\n          ui->showQRCode->setEnabled(true);\n      }\n      else\n      {\n          ui->deleteButton->setEnabled(false);\n          ui->showQRCode->setEnabled(false);\n          ui->copyToClipboard->setEnabled(false);\n          ui->signMessage->setEnabled(false);\n          ui->verifyMessage->setEnabled(false);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->tableView->selectionModel()",
            "SIGNAL(selectionChanged(QItemSelection,QItemSelection))",
            "this",
            "SLOT(selectionChanged())"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "selectionChanged()"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "selectionChanged(QItemSelection,QItemSelection)"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selectionChanged",
          "args": [
            "QItemSelection",
            "QItemSelection"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tableView->selectionModel",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tableView->horizontalHeader",
          "args": [
            "AddressTableModel::Label",
            "QHeaderView::Stretch"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tableView->horizontalHeader",
          "args": [],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tableView->horizontalHeader",
          "args": [
            "AddressTableModel::Address",
            "320"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tableView->horizontalHeader",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tableView->sortByColumn",
          "args": [
            "0",
            "Qt::AscendingOrder"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tableView->setModel",
          "args": [
            "proxyModel"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "107-148",
          "snippet": "void AddressBookPage::setModel(AddressTableModel *model)\n{\n    this->model = model;\n    if(!model)\n        return;\n\n    proxyModel = new QSortFilterProxyModel(this);\n    proxyModel->setSourceModel(model);\n    proxyModel->setDynamicSortFilter(true);\n    proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n    proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n    switch(tab)\n    {\n    case ReceivingTab:\n        // Receive filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Receive);\n        break;\n    case SendingTab:\n        // Send filter\n        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n        proxyModel->setFilterFixedString(AddressTableModel::Send);\n        break;\n    }\n    ui->tableView->setModel(proxyModel);\n    ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n\n    // Set column widths\n    ui->tableView->horizontalHeader()->resizeSection(\n            AddressTableModel::Address, 320);\n    ui->tableView->horizontalHeader()->setResizeMode(\n            AddressTableModel::Label, QHeaderView::Stretch);\n\n    connect(ui->tableView->selectionModel(), SIGNAL(selectionChanged(QItemSelection,QItemSelection)),\n            this, SLOT(selectionChanged()));\n\n    // Select row for newly created address\n    connect(model, SIGNAL(rowsInserted(QModelIndex,int,int)),\n            this, SLOT(selectNewAddress(QModelIndex,int,int)));\n\n    selectionChanged();\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "proxyModel->setFilterFixedString",
          "args": [
            "AddressTableModel::Send"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proxyModel->setFilterRole",
          "args": [
            "AddressTableModel::TypeRole"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proxyModel->setFilterFixedString",
          "args": [
            "AddressTableModel::Receive"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proxyModel->setFilterRole",
          "args": [
            "AddressTableModel::TypeRole"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proxyModel->setFilterCaseSensitivity",
          "args": [
            "Qt::CaseInsensitive"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proxyModel->setSortCaseSensitivity",
          "args": [
            "Qt::CaseInsensitive"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proxyModel->setDynamicSortFilter",
          "args": [
            "true"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proxyModel->setSourceModel",
          "args": [
            "model"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::setModel(AddressTableModel *model)\n  {\n      this->model = model;\n      if(!model)\n          return;\n  \n      proxyModel = new QSortFilterProxyModel(this);\n      proxyModel->setSourceModel(model);\n      proxyModel->setDynamicSortFilter(true);\n      proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n      proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n      switch(tab)\n      {\n      case ReceivingTab:\n          // Receive filter\n          proxyModel->setFilterRole(AddressTableModel::TypeRole);\n          proxyModel->setFilterFixedString(AddressTableModel::Receive);\n          break;\n      case SendingTab:\n          // Send filter\n          proxyModel->setFilterRole(AddressTableModel::TypeRole);\n          proxyModel->setFilterFixedString(AddressTableModel::Send);\n          break;\n      }\n      ui->tableView->setModel(proxyModel);\n      ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n  \n      // Set column widths\n      ui->tableView->horizontalHeader()->resizeSection(\n              AddressTableModel::Address, 320);\n      ui->tableView->horizontalHeader()->setResizeMode(\n              AddressTableModel::Label, QHeaderView::Stretch);\n  \n      connect(ui->tableView->selectionModel(), SIGNAL(selectionChanged(QItemSelection,QItemSelection)),\n              this, SLOT(selectionChanged()));\n  \n      // Select row for newly created address\n      connect(model, SIGNAL(rowsInserted(QModelIndex,int,int)),\n              this, SLOT(selectNewAddress(QModelIndex,int,int)));\n  \n      selectionChanged();\n  }\n}"
  },
  {
    "function_name": "~AddressBookPage",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "102-105",
    "snippet": "AddressBookPage::~AddressBookPage()\n{\n    delete ui;\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  AddressBookPage::~AddressBookPage()\n  {\n      delete ui;\n  }\n}"
  },
  {
    "function_name": "AddressBookPage",
    "container": "AddressBookPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
    "lines": "20-100",
    "snippet": "AddressBookPage::AddressBookPage(Mode mode, Tabs tab, QWidget *parent) :\n    QDialog(parent),\n    ui(new Ui::AddressBookPage),\n    model(0),\n    optionsModel(0),\n    mode(mode),\n    tab(tab)\n{\n    ui->setupUi(this);\n\n#ifdef Q_OS_MAC // Icons on push buttons are very uncommon on Mac\n    ui->newAddressButton->setIcon(QIcon());\n    ui->copyToClipboard->setIcon(QIcon());\n    ui->deleteButton->setIcon(QIcon());\n#endif\n\n#ifndef USE_QRCODE\n    ui->showQRCode->setVisible(false);\n#endif\n\n    switch(mode)\n    {\n    case ForSending:\n        connect(ui->tableView, SIGNAL(doubleClicked(QModelIndex)), this, SLOT(accept()));\n        ui->tableView->setEditTriggers(QAbstractItemView::NoEditTriggers);\n        ui->tableView->setFocus();\n        break;\n    case ForEditing:\n        ui->buttonBox->setVisible(false);\n        break;\n    }\n    switch(tab)\n    {\n    case SendingTab:\n        ui->labelExplanation->setVisible(false);\n        ui->deleteButton->setVisible(true);\n        ui->signMessage->setVisible(false);\n        break;\n    case ReceivingTab:\n        ui->deleteButton->setVisible(false);\n        ui->signMessage->setVisible(true);\n        break;\n    }\n\n    // Context menu actions\n    QAction *copyLabelAction = new QAction(tr(\"Copy &Label\"), this);\n    QAction *copyAddressAction = new QAction(ui->copyToClipboard->text(), this);\n    QAction *editAction = new QAction(tr(\"&Edit\"), this);\n    QAction *showQRCodeAction = new QAction(ui->showQRCode->text(), this);\n    QAction *signMessageAction = new QAction(ui->signMessage->text(), this);\n    QAction *verifyMessageAction = new QAction(ui->verifyMessage->text(), this);\n    deleteAction = new QAction(ui->deleteButton->text(), this);\n\n    // Build context menu\n    contextMenu = new QMenu();\n    contextMenu->addAction(copyAddressAction);\n    contextMenu->addAction(copyLabelAction);\n    contextMenu->addAction(editAction);\n    if(tab == SendingTab)\n        contextMenu->addAction(deleteAction);\n    contextMenu->addSeparator();\n    contextMenu->addAction(showQRCodeAction);\n    if(tab == ReceivingTab)\n        contextMenu->addAction(signMessageAction);\n    else if(tab == SendingTab)\n        contextMenu->addAction(verifyMessageAction);\n\n    // Connect signals for context menu actions\n    connect(copyAddressAction, SIGNAL(triggered()), this, SLOT(on_copyToClipboard_clicked()));\n    connect(copyLabelAction, SIGNAL(triggered()), this, SLOT(onCopyLabelAction()));\n    connect(editAction, SIGNAL(triggered()), this, SLOT(onEditAction()));\n    connect(deleteAction, SIGNAL(triggered()), this, SLOT(on_deleteButton_clicked()));\n    connect(showQRCodeAction, SIGNAL(triggered()), this, SLOT(on_showQRCode_clicked()));\n    connect(signMessageAction, SIGNAL(triggered()), this, SLOT(on_signMessage_clicked()));\n    connect(verifyMessageAction, SIGNAL(triggered()), this, SLOT(on_verifyMessage_clicked()));\n\n    connect(ui->tableView, SIGNAL(customContextMenuRequested(QPoint)), this, SLOT(contextualMenu(QPoint)));\n\n    // Pass through accept action from button box\n    connect(ui->buttonBox, SIGNAL(accepted()), this, SLOT(accept()));\n}",
    "includes": [
      "#include \"qrcodedialog.h\"",
      "#include <QMenu>",
      "#include <QMessageBox>",
      "#include <QClipboard>",
      "#include <QSortFilterProxyModel>",
      "#include \"guiutil.h\"",
      "#include \"csvmodelwriter.h\"",
      "#include \"editaddressdialog.h\"",
      "#include \"bitcoingui.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_addressbookpage.h\"",
      "#include \"addressbookpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->buttonBox",
            "SIGNAL(accepted())",
            "this",
            "SLOT(accept())"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "accept()"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "accept",
          "args": [],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "accept",
          "container": "EditAddressDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
          "lines": "85-125",
          "snippet": "void EditAddressDialog::accept()\n{\n    if(!model)\n        return;\n\n    if(!saveCurrentRow())\n    {\n        switch(model->getEditStatus())\n        {\n        case AddressTableModel::OK:\n            // Failed with unknown reason. Just reject.\n            break;\n        case AddressTableModel::NO_CHANGES:\n            // No changes were made during edit operation. Just reject.\n            break;\n        case AddressTableModel::INVALID_ADDRESS:\n            QMessageBox::warning(this, windowTitle(),\n                tr(\"The entered address \\\"%1\\\" is not a valid Halcyon address.\").arg(ui->addressEdit->text()),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n        case AddressTableModel::DUPLICATE_ADDRESS:\n            QMessageBox::warning(this, windowTitle(),\n                tr(\"The entered address \\\"%1\\\" is already in the address book.\").arg(ui->addressEdit->text()),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n        case AddressTableModel::WALLET_UNLOCK_FAILURE:\n            QMessageBox::critical(this, windowTitle(),\n                tr(\"Could not unlock wallet.\"),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n        case AddressTableModel::KEY_GENERATION_FAILURE:\n            QMessageBox::critical(this, windowTitle(),\n                tr(\"New key generation failed.\"),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n\n        }\n        return;\n    }\n    QDialog::accept();\n}",
          "includes": [
            "#include <QMessageBox>",
            "#include <QDataWidgetMapper>",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_editaddressdialog.h\"",
            "#include \"editaddressdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  void EditAddressDialog::accept()\n  {\n      if(!model)\n          return;\n  \n      if(!saveCurrentRow())\n      {\n          switch(model->getEditStatus())\n          {\n          case AddressTableModel::OK:\n              // Failed with unknown reason. Just reject.\n              break;\n          case AddressTableModel::NO_CHANGES:\n              // No changes were made during edit operation. Just reject.\n              break;\n          case AddressTableModel::INVALID_ADDRESS:\n              QMessageBox::warning(this, windowTitle(),\n                  tr(\"The entered address \\\"%1\\\" is not a valid Halcyon address.\").arg(ui->addressEdit->text()),\n                  QMessageBox::Ok, QMessageBox::Ok);\n              break;\n          case AddressTableModel::DUPLICATE_ADDRESS:\n              QMessageBox::warning(this, windowTitle(),\n                  tr(\"The entered address \\\"%1\\\" is already in the address book.\").arg(ui->addressEdit->text()),\n                  QMessageBox::Ok, QMessageBox::Ok);\n              break;\n          case AddressTableModel::WALLET_UNLOCK_FAILURE:\n              QMessageBox::critical(this, windowTitle(),\n                  tr(\"Could not unlock wallet.\"),\n                  QMessageBox::Ok, QMessageBox::Ok);\n              break;\n          case AddressTableModel::KEY_GENERATION_FAILURE:\n              QMessageBox::critical(this, windowTitle(),\n                  tr(\"New key generation failed.\"),\n                  QMessageBox::Ok, QMessageBox::Ok);\n              break;\n  \n          }\n          return;\n      }\n      QDialog::accept();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "accepted()"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "accepted",
          "args": [],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "on_buttonBox_accepted",
          "container": "AboutDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/aboutdialog.cpp",
          "lines": "27-30",
          "snippet": "void AboutDialog::on_buttonBox_accepted()\n{\n    close();\n}",
          "includes": [
            "#include \"version.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_aboutdialog.h\"",
            "#include \"aboutdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"clientmodel.h\"\n#include \"ui_aboutdialog.h\"\n#include \"aboutdialog.h\"\n\nAboutDialog {\n  void AboutDialog::on_buttonBox_accepted()\n  {\n      close();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->tableView",
            "SIGNAL(customContextMenuRequested(QPoint))",
            "this",
            "SLOT(contextualMenu(QPoint))"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "contextualMenu(QPoint)"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextualMenu",
          "args": [
            "QPoint"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "contextualMenu",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "355-362",
          "snippet": "void AddressBookPage::contextualMenu(const QPoint &point)\n{\n    QModelIndex index = ui->tableView->indexAt(point);\n    if(index.isValid())\n    {\n        contextMenu->exec(QCursor::pos());\n    }\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::contextualMenu(const QPoint &point)\n  {\n      QModelIndex index = ui->tableView->indexAt(point);\n      if(index.isValid())\n      {\n          contextMenu->exec(QCursor::pos());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "customContextMenuRequested(QPoint)"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "customContextMenuRequested",
          "args": [
            "QPoint"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "verifyMessageAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(on_verifyMessage_clicked())"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "on_verifyMessage_clicked()"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "on_verifyMessage_clicked",
          "args": [],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "on_verifyMessage_clicked",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "198-211",
          "snippet": "void AddressBookPage::on_verifyMessage_clicked()\n{\n    QTableView *table = ui->tableView;\n    QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n    QString addr;\n\n    foreach (QModelIndex index, indexes)\n    {\n        QVariant address = index.data();\n        addr = address.toString();\n    }\n\n    emit verifyMessage(addr);\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::on_verifyMessage_clicked()\n  {\n      QTableView *table = ui->tableView;\n      QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n      QString addr;\n  \n      foreach (QModelIndex index, indexes)\n      {\n          QVariant address = index.data();\n          addr = address.toString();\n      }\n  \n      emit verifyMessage(addr);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "signMessageAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(on_signMessage_clicked())"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "on_signMessage_clicked()"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "on_signMessage_clicked",
          "args": [],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "on_signMessage_clicked",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "183-196",
          "snippet": "void AddressBookPage::on_signMessage_clicked()\n{\n    QTableView *table = ui->tableView;\n    QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n    QString addr;\n\n    foreach (QModelIndex index, indexes)\n    {\n        QVariant address = index.data();\n        addr = address.toString();\n    }\n\n    emit signMessage(addr);\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::on_signMessage_clicked()\n  {\n      QTableView *table = ui->tableView;\n      QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n      QString addr;\n  \n      foreach (QModelIndex index, indexes)\n      {\n          QVariant address = index.data();\n          addr = address.toString();\n      }\n  \n      emit signMessage(addr);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "showQRCodeAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(on_showQRCode_clicked())"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "on_showQRCode_clicked()"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "on_showQRCode_clicked",
          "args": [],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "on_showQRCode_clicked",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "336-353",
          "snippet": "void AddressBookPage::on_showQRCode_clicked()\n{\n#ifdef USE_QRCODE\n    QTableView *table = ui->tableView;\n    QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n\n    foreach (QModelIndex index, indexes)\n    {\n        QString address = index.data().toString(), label = index.sibling(index.row(), 0).data(Qt::EditRole).toString();\n\n        QRCodeDialog *dialog = new QRCodeDialog(address, label, tab == ReceivingTab, this);\n        if(optionsModel)\n            dialog->setModel(optionsModel);\n        dialog->setAttribute(Qt::WA_DeleteOnClose);\n        dialog->show();\n    }\n#endif\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::on_showQRCode_clicked()\n  {\n  #ifdef USE_QRCODE\n      QTableView *table = ui->tableView;\n      QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n  \n      foreach (QModelIndex index, indexes)\n      {\n          QString address = index.data().toString(), label = index.sibling(index.row(), 0).data(Qt::EditRole).toString();\n  \n          QRCodeDialog *dialog = new QRCodeDialog(address, label, tab == ReceivingTab, this);\n          if(optionsModel)\n              dialog->setModel(optionsModel);\n          dialog->setAttribute(Qt::WA_DeleteOnClose);\n          dialog->show();\n      }\n  #endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "deleteAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(on_deleteButton_clicked())"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "on_deleteButton_clicked()"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "on_deleteButton_clicked",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "on_deleteButton_clicked",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "228-238",
          "snippet": "void AddressBookPage::on_deleteButton_clicked()\n{\n    QTableView *table = ui->tableView;\n    if(!table->selectionModel())\n        return;\n    QModelIndexList indexes = table->selectionModel()->selectedRows();\n    if(!indexes.isEmpty())\n    {\n        table->model()->removeRow(indexes.at(0).row());\n    }\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::on_deleteButton_clicked()\n  {\n      QTableView *table = ui->tableView;\n      if(!table->selectionModel())\n          return;\n      QModelIndexList indexes = table->selectionModel()->selectedRows();\n      if(!indexes.isEmpty())\n      {\n          table->model()->removeRow(indexes.at(0).row());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "editAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(onEditAction())"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "onEditAction()"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onEditAction",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "onEditAction",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "165-181",
          "snippet": "void AddressBookPage::onEditAction()\n{\n    if(!ui->tableView->selectionModel())\n        return;\n    QModelIndexList indexes = ui->tableView->selectionModel()->selectedRows();\n    if(indexes.isEmpty())\n        return;\n\n    EditAddressDialog dlg(\n            tab == SendingTab ?\n            EditAddressDialog::EditSendingAddress :\n            EditAddressDialog::EditReceivingAddress);\n    dlg.setModel(model);\n    QModelIndex origIndex = proxyModel->mapToSource(indexes.at(0));\n    dlg.loadRow(origIndex.row());\n    dlg.exec();\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::onEditAction()\n  {\n      if(!ui->tableView->selectionModel())\n          return;\n      QModelIndexList indexes = ui->tableView->selectionModel()->selectedRows();\n      if(indexes.isEmpty())\n          return;\n  \n      EditAddressDialog dlg(\n              tab == SendingTab ?\n              EditAddressDialog::EditSendingAddress :\n              EditAddressDialog::EditReceivingAddress);\n      dlg.setModel(model);\n      QModelIndex origIndex = proxyModel->mapToSource(indexes.at(0));\n      dlg.loadRow(origIndex.row());\n      dlg.exec();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "copyLabelAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(onCopyLabelAction())"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "onCopyLabelAction()"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onCopyLabelAction",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "onCopyLabelAction",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "160-163",
          "snippet": "void AddressBookPage::onCopyLabelAction()\n{\n    GUIUtil::copyEntryData(ui->tableView, AddressTableModel::Label);\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::onCopyLabelAction()\n  {\n      GUIUtil::copyEntryData(ui->tableView, AddressTableModel::Label);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "copyAddressAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(on_copyToClipboard_clicked())"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "on_copyToClipboard_clicked()"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "on_copyToClipboard_clicked",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "on_copyToClipboard_clicked",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "155-158",
          "snippet": "void AddressBookPage::on_copyToClipboard_clicked()\n{\n    GUIUtil::copyEntryData(ui->tableView, AddressTableModel::Address);\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::on_copyToClipboard_clicked()\n  {\n      GUIUtil::copyEntryData(ui->tableView, AddressTableModel::Address);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "verifyMessageAction"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "signMessageAction"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "showQRCodeAction"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addSeparator",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "deleteAction"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "editAction"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "copyLabelAction"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "copyAddressAction"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->deleteButton->text",
          "args": [],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"&Edit\""
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->signMessage->setVisible",
          "args": [
            "true"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->deleteButton->setVisible",
          "args": [
            "false"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->signMessage->setVisible",
          "args": [
            "false"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->deleteButton->setVisible",
          "args": [
            "true"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelExplanation->setVisible",
          "args": [
            "false"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->buttonBox->setVisible",
          "args": [
            "false"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tableView->setFocus",
          "args": [],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "setFocus",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "162-165",
          "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setFocus()\n  {\n      ui->payTo->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->tableView->setEditTriggers",
          "args": [
            "QAbstractItemView::NoEditTriggers"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->tableView",
            "SIGNAL(doubleClicked(QModelIndex))",
            "this",
            "SLOT(accept())"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "accept()"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "doubleClicked(QModelIndex)"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "doubleClicked",
          "args": [
            "QModelIndex"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->showQRCode->setVisible",
          "args": [
            "false"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->deleteButton->setIcon",
          "args": [
            "QIcon()"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->copyToClipboard->setIcon",
          "args": [
            "QIcon()"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->newAddressButton->setIcon",
          "args": [
            "QIcon()"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->setupUi",
          "args": [
            "this"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  AddressBookPage::AddressBookPage(Mode mode, Tabs tab, QWidget *parent) :\n      QDialog(parent),\n      ui(new Ui::AddressBookPage),\n      model(0),\n      optionsModel(0),\n      mode(mode),\n      tab(tab)\n  {\n      ui->setupUi(this);\n  \n  #ifdef Q_OS_MAC // Icons on push buttons are very uncommon on Mac\n      ui->newAddressButton->setIcon(QIcon());\n      ui->copyToClipboard->setIcon(QIcon());\n      ui->deleteButton->setIcon(QIcon());\n  #endif\n  \n  #ifndef USE_QRCODE\n      ui->showQRCode->setVisible(false);\n  #endif\n  \n      switch(mode)\n      {\n      case ForSending:\n          connect(ui->tableView, SIGNAL(doubleClicked(QModelIndex)), this, SLOT(accept()));\n          ui->tableView->setEditTriggers(QAbstractItemView::NoEditTriggers);\n          ui->tableView->setFocus();\n          break;\n      case ForEditing:\n          ui->buttonBox->setVisible(false);\n          break;\n      }\n      switch(tab)\n      {\n      case SendingTab:\n          ui->labelExplanation->setVisible(false);\n          ui->deleteButton->setVisible(true);\n          ui->signMessage->setVisible(false);\n          break;\n      case ReceivingTab:\n          ui->deleteButton->setVisible(false);\n          ui->signMessage->setVisible(true);\n          break;\n      }\n  \n      // Context menu actions\n      QAction *copyLabelAction = new QAction(tr(\"Copy &Label\"), this);\n      QAction *copyAddressAction = new QAction(ui->copyToClipboard->text(), this);\n      QAction *editAction = new QAction(tr(\"&Edit\"), this);\n      QAction *showQRCodeAction = new QAction(ui->showQRCode->text(), this);\n      QAction *signMessageAction = new QAction(ui->signMessage->text(), this);\n      QAction *verifyMessageAction = new QAction(ui->verifyMessage->text(), this);\n      deleteAction = new QAction(ui->deleteButton->text(), this);\n  \n      // Build context menu\n      contextMenu = new QMenu();\n      contextMenu->addAction(copyAddressAction);\n      contextMenu->addAction(copyLabelAction);\n      contextMenu->addAction(editAction);\n      if(tab == SendingTab)\n          contextMenu->addAction(deleteAction);\n      contextMenu->addSeparator();\n      contextMenu->addAction(showQRCodeAction);\n      if(tab == ReceivingTab)\n          contextMenu->addAction(signMessageAction);\n      else if(tab == SendingTab)\n          contextMenu->addAction(verifyMessageAction);\n  \n      // Connect signals for context menu actions\n      connect(copyAddressAction, SIGNAL(triggered()), this, SLOT(on_copyToClipboard_clicked()));\n      connect(copyLabelAction, SIGNAL(triggered()), this, SLOT(onCopyLabelAction()));\n      connect(editAction, SIGNAL(triggered()), this, SLOT(onEditAction()));\n      connect(deleteAction, SIGNAL(triggered()), this, SLOT(on_deleteButton_clicked()));\n      connect(showQRCodeAction, SIGNAL(triggered()), this, SLOT(on_showQRCode_clicked()));\n      connect(signMessageAction, SIGNAL(triggered()), this, SLOT(on_signMessage_clicked()));\n      connect(verifyMessageAction, SIGNAL(triggered()), this, SLOT(on_verifyMessage_clicked()));\n  \n      connect(ui->tableView, SIGNAL(customContextMenuRequested(QPoint)), this, SLOT(contextualMenu(QPoint)));\n  \n      // Pass through accept action from button box\n      connect(ui->buttonBox, SIGNAL(accepted()), this, SLOT(accept()));\n  }\n}"
  }
]