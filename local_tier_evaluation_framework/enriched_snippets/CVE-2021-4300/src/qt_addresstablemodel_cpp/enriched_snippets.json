[
  {
    "function_name": "emitDataChanged",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "423-426",
    "snippet": "void AddressTableModel::emitDataChanged(int idx)\n{\n    emit dataChanged(index(idx, 0, QModelIndex()), index(idx, columns.length()-1, QModelIndex()));\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "index",
          "args": [
            "idx",
            "columns.length()-1",
            "QModelIndex()"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "index",
          "container": "AddressTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
          "lines": "301-313",
          "snippet": "QModelIndex AddressTableModel::index(int row, int column, const QModelIndex &parent) const\n{\n    Q_UNUSED(parent);\n    AddressTableEntry *data = priv->index(row);\n    if(data)\n    {\n        return createIndex(row, column, priv->index(row));\n    }\n    else\n    {\n        return QModelIndex();\n    }\n}",
          "includes": [
            "#include <QColor>",
            "#include <QFont>",
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  QModelIndex AddressTableModel::index(int row, int column, const QModelIndex &parent) const\n  {\n      Q_UNUSED(parent);\n      AddressTableEntry *data = priv->index(row);\n      if(data)\n      {\n          return createIndex(row, column, priv->index(row));\n      }\n      else\n      {\n          return QModelIndex();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QModelIndex",
          "args": [],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "columns.length",
          "args": [],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QModelIndex",
          "args": [],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  void AddressTableModel::emitDataChanged(int idx)\n  {\n      emit dataChanged(index(idx, 0, QModelIndex()), index(idx, columns.length()-1, QModelIndex()));\n  }\n}"
  },
  {
    "function_name": "lookupAddress",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "409-421",
    "snippet": "int AddressTableModel::lookupAddress(const QString &address) const\n{\n    QModelIndexList lst = match(index(0, Address, QModelIndex()),\n                                Qt::EditRole, address, 1, Qt::MatchExactly);\n    if(lst.isEmpty())\n    {\n        return -1;\n    }\n    else\n    {\n        return lst.at(0).row();\n    }\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lst.at",
          "args": [],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lst.at",
          "args": [
            "0"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lst.isEmpty",
          "args": [],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match",
          "args": [
            "index(0, Address, QModelIndex())",
            "Qt::EditRole",
            "address",
            "1",
            "Qt::MatchExactly"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "0",
            "Address",
            "QModelIndex()"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "index",
          "container": "AddressTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
          "lines": "301-313",
          "snippet": "QModelIndex AddressTableModel::index(int row, int column, const QModelIndex &parent) const\n{\n    Q_UNUSED(parent);\n    AddressTableEntry *data = priv->index(row);\n    if(data)\n    {\n        return createIndex(row, column, priv->index(row));\n    }\n    else\n    {\n        return QModelIndex();\n    }\n}",
          "includes": [
            "#include <QColor>",
            "#include <QFont>",
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  QModelIndex AddressTableModel::index(int row, int column, const QModelIndex &parent) const\n  {\n      Q_UNUSED(parent);\n      AddressTableEntry *data = priv->index(row);\n      if(data)\n      {\n          return createIndex(row, column, priv->index(row));\n      }\n      else\n      {\n          return QModelIndex();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QModelIndex",
          "args": [],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  int AddressTableModel::lookupAddress(const QString &address) const\n  {\n      QModelIndexList lst = match(index(0, Address, QModelIndex()),\n                                  Qt::EditRole, address, 1, Qt::MatchExactly);\n      if(lst.isEmpty())\n      {\n          return -1;\n      }\n      else\n      {\n          return lst.at(0).row();\n      }\n  }\n}"
  },
  {
    "function_name": "labelForAddress",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "395-407",
    "snippet": "QString AddressTableModel::labelForAddress(const QString &address) const\n{\n    {\n        LOCK(wallet->cs_wallet);\n        CBitcoinAddress address_parsed(address.toStdString());\n        std::map<CTxDestination, std::string>::iterator mi = wallet->mapAddressBook.find(address_parsed.Get());\n        if (mi != wallet->mapAddressBook.end())\n        {\n            return QString::fromStdString(mi->second);\n        }\n    }\n    return QString();\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "mi->second"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wallet->mapAddressBook.end",
          "args": [],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wallet->mapAddressBook.find",
          "args": [
            "address_parsed.Get()"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "address_parsed.Get",
          "args": [],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "CBitcoinAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "349-367",
          "snippet": "CTxDestination Get() const {\n        if (!IsValid())\n            return CNoDestination();\n        switch (nVersion) {\n        case PUBKEY_ADDRESS:\n        case PUBKEY_ADDRESS_TEST: {\n            uint160 id;\n            memcpy(&id, &vchData[0], 20);\n            return CKeyID(id);\n        }\n        case SCRIPT_ADDRESS:\n        case SCRIPT_ADDRESS_TEST: {\n            uint160 id;\n            memcpy(&id, &vchData[0], 20);\n            return CScriptID(id);\n        }\n        }\n        return CNoDestination();\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  CTxDestination Get() const {\n          if (!IsValid())\n              return CNoDestination();\n          switch (nVersion) {\n          case PUBKEY_ADDRESS:\n          case PUBKEY_ADDRESS_TEST: {\n              uint160 id;\n              memcpy(&id, &vchData[0], 20);\n              return CKeyID(id);\n          }\n          case SCRIPT_ADDRESS:\n          case SCRIPT_ADDRESS_TEST: {\n              uint160 id;\n              memcpy(&id, &vchData[0], 20);\n              return CScriptID(id);\n          }\n          }\n          return CNoDestination();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "address.toStdString",
          "args": [],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "wallet->cs_wallet"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  QString AddressTableModel::labelForAddress(const QString &address) const\n  {\n      {\n          LOCK(wallet->cs_wallet);\n          CBitcoinAddress address_parsed(address.toStdString());\n          std::map<CTxDestination, std::string>::iterator mi = wallet->mapAddressBook.find(address_parsed.Get());\n          if (mi != wallet->mapAddressBook.end())\n          {\n              return QString::fromStdString(mi->second);\n          }\n      }\n      return QString();\n  }\n}"
  },
  {
    "function_name": "removeRows",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "376-391",
    "snippet": "bool AddressTableModel::removeRows(int row, int count, const QModelIndex &parent)\n{\n    Q_UNUSED(parent);\n    AddressTableEntry *rec = priv->index(row);\n    if(count != 1 || !rec || rec->type == AddressTableEntry::Receiving)\n    {\n        // Can only remove one row at a time, and cannot remove rows not in model.\n        // Also refuse to remove receiving addresses.\n        return false;\n    }\n    {\n        LOCK(wallet->cs_wallet);\n        wallet->DelAddressBookName(CBitcoinAddress(rec->address.toStdString()).Get());\n    }\n    return true;\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wallet->DelAddressBookName",
          "args": [
            "CBitcoinAddress(rec->address.toStdString()).Get()"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "IsScript",
          "container": "CBitcoinAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "384-394",
          "snippet": "bool IsScript() const {\n        if (!IsValid())\n            return false;\n        switch (nVersion) {\n        case SCRIPT_ADDRESS:\n        case SCRIPT_ADDRESS_TEST: {\n            return true;\n        }\n        default: return false;\n        }\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool IsScript() const {\n          if (!IsValid())\n              return false;\n          switch (nVersion) {\n          case SCRIPT_ADDRESS:\n          case SCRIPT_ADDRESS_TEST: {\n              return true;\n          }\n          default: return false;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [
            "rec->address.toStdString()"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "operator()",
          "container": "CBitcoinAddressVisitor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "399-399",
          "snippet": "bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddressVisitor {\n  bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rec->address.toStdString",
          "args": [],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "wallet->cs_wallet"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "priv->index",
          "args": [
            "row"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_UNUSED",
          "args": [
            "parent"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  bool AddressTableModel::removeRows(int row, int count, const QModelIndex &parent)\n  {\n      Q_UNUSED(parent);\n      AddressTableEntry *rec = priv->index(row);\n      if(count != 1 || !rec || rec->type == AddressTableEntry::Receiving)\n      {\n          // Can only remove one row at a time, and cannot remove rows not in model.\n          // Also refuse to remove receiving addresses.\n          return false;\n      }\n      {\n          LOCK(wallet->cs_wallet);\n          wallet->DelAddressBookName(CBitcoinAddress(rec->address.toStdString()).Get());\n      }\n      return true;\n  }\n}"
  },
  {
    "function_name": "addRow",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "321-374",
    "snippet": "QString AddressTableModel::addRow(const QString &type, const QString &label, const QString &address)\n{\n    std::string strLabel = label.toStdString();\n    std::string strAddress = address.toStdString();\n\n    editStatus = OK;\n\n    if(type == Send)\n    {\n        if(!walletModel->validateAddress(address))\n        {\n            editStatus = INVALID_ADDRESS;\n            return QString();\n        }\n        // Check for duplicate addresses\n        {\n            LOCK(wallet->cs_wallet);\n            if(wallet->mapAddressBook.count(CBitcoinAddress(strAddress).Get()))\n            {\n                editStatus = DUPLICATE_ADDRESS;\n                return QString();\n            }\n        }\n    }\n    else if(type == Receive)\n    {\n        // Generate a new address to associate with given label\n        WalletModel::UnlockContext ctx(walletModel->requestUnlock());\n        if(!ctx.isValid())\n        {\n            // Unlock wallet failed or was cancelled\n            editStatus = WALLET_UNLOCK_FAILURE;\n            return QString();\n        }\n        CPubKey newKey;\n        if(!wallet->GetKeyFromPool(newKey, true))\n        {\n            editStatus = KEY_GENERATION_FAILURE;\n            return QString();\n        }\n        strAddress = CBitcoinAddress(newKey.GetID()).ToString();\n    }\n    else\n    {\n        return QString();\n    }\n\n    // Add entry\n    {\n        LOCK(wallet->cs_wallet);\n        wallet->SetAddressBookName(CBitcoinAddress(strAddress).Get(), strLabel);\n    }\n    return QString::fromStdString(strAddress);\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "const QString AddressTableModel::Send = \"S\";",
      "const QString AddressTableModel::Receive = \"R\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "strAddress"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wallet->SetAddressBookName",
          "args": [
            "CBitcoinAddress(strAddress).Get()",
            "strLabel"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "IsScript",
          "container": "CBitcoinAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "384-394",
          "snippet": "bool IsScript() const {\n        if (!IsValid())\n            return false;\n        switch (nVersion) {\n        case SCRIPT_ADDRESS:\n        case SCRIPT_ADDRESS_TEST: {\n            return true;\n        }\n        default: return false;\n        }\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool IsScript() const {\n          if (!IsValid())\n              return false;\n          switch (nVersion) {\n          case SCRIPT_ADDRESS:\n          case SCRIPT_ADDRESS_TEST: {\n              return true;\n          }\n          default: return false;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [
            "strAddress"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "operator()",
          "container": "CBitcoinAddressVisitor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "399-399",
          "snippet": "bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddressVisitor {\n  bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "wallet->cs_wallet"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newKey.GetID",
          "args": [],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "GetID",
          "container": "CPubKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "80-82",
          "snippet": "CKeyID GetID() const {\n        return CKeyID(Hash160(vchPubKey));\n    }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  CKeyID GetID() const {\n          return CKeyID(Hash160(vchPubKey));\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wallet->GetKeyFromPool",
          "args": [
            "newKey",
            "true"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ctx.isValid",
          "args": [],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "WalletModel::UnlockContext",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.h",
          "lines": "106-106",
          "snippet": "bool isValid() const { return valid; }",
          "includes": [
            "#include \"allocators.h\" /* for SecureString */",
            "#include <map>",
            "#include <vector>",
            "#include <QObject>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"allocators.h\" /* for SecureString */\n#include <map>\n#include <vector>\n#include <QObject>\n\nWalletModel {\n  UnlockContext {\n    bool isValid() const { return valid; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "walletModel->requestUnlock",
          "args": [],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "requestUnlock",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "364-383",
          "snippet": "WalletModel::UnlockContext WalletModel::requestUnlock()\n{\n    bool was_locked = getEncryptionStatus() == Locked;\n    \n    if ((!was_locked) && fWalletUnlockStakingOnly)\n    {\n       setWalletLocked(true);\n       was_locked = getEncryptionStatus() == Locked;\n\n    }\n    if(was_locked)\n    {\n        // Request UI to unlock wallet\n        emit requireUnlock();\n    }\n    // If wallet is still locked, unlock was failed or cancelled, mark context as invalid\n    bool valid = getEncryptionStatus() != Locked;\n\n    return UnlockContext(this, valid, was_locked && !fWalletUnlockStakingOnly);\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  WalletModel::UnlockContext WalletModel::requestUnlock()\n  {\n      bool was_locked = getEncryptionStatus() == Locked;\n      \n      if ((!was_locked) && fWalletUnlockStakingOnly)\n      {\n         setWalletLocked(true);\n         was_locked = getEncryptionStatus() == Locked;\n  \n      }\n      if(was_locked)\n      {\n          // Request UI to unlock wallet\n          emit requireUnlock();\n      }\n      // If wallet is still locked, unlock was failed or cancelled, mark context as invalid\n      bool valid = getEncryptionStatus() != Locked;\n  \n      return UnlockContext(this, valid, was_locked && !fWalletUnlockStakingOnly);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wallet->mapAddressBook.count",
          "args": [
            "CBitcoinAddress(strAddress).Get()"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "wallet->cs_wallet"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "walletModel->validateAddress",
          "args": [
            "address"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "validateAddress",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "126-130",
          "snippet": "bool WalletModel::validateAddress(const QString &address)\n{\n    CBitcoinAddress addressParsed(address.toStdString());\n    return addressParsed.IsValid();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  bool WalletModel::validateAddress(const QString &address)\n  {\n      CBitcoinAddress addressParsed(address.toStdString());\n      return addressParsed.IsValid();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "address.toStdString",
          "args": [],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "label.toStdString",
          "args": [],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nconst QString AddressTableModel::Send = \"S\";\nconst QString AddressTableModel::Receive = \"R\";\n\nAddressTableModel {\n  QString AddressTableModel::addRow(const QString &type, const QString &label, const QString &address)\n  {\n      std::string strLabel = label.toStdString();\n      std::string strAddress = address.toStdString();\n  \n      editStatus = OK;\n  \n      if(type == Send)\n      {\n          if(!walletModel->validateAddress(address))\n          {\n              editStatus = INVALID_ADDRESS;\n              return QString();\n          }\n          // Check for duplicate addresses\n          {\n              LOCK(wallet->cs_wallet);\n              if(wallet->mapAddressBook.count(CBitcoinAddress(strAddress).Get()))\n              {\n                  editStatus = DUPLICATE_ADDRESS;\n                  return QString();\n              }\n          }\n      }\n      else if(type == Receive)\n      {\n          // Generate a new address to associate with given label\n          WalletModel::UnlockContext ctx(walletModel->requestUnlock());\n          if(!ctx.isValid())\n          {\n              // Unlock wallet failed or was cancelled\n              editStatus = WALLET_UNLOCK_FAILURE;\n              return QString();\n          }\n          CPubKey newKey;\n          if(!wallet->GetKeyFromPool(newKey, true))\n          {\n              editStatus = KEY_GENERATION_FAILURE;\n              return QString();\n          }\n          strAddress = CBitcoinAddress(newKey.GetID()).ToString();\n      }\n      else\n      {\n          return QString();\n      }\n  \n      // Add entry\n      {\n          LOCK(wallet->cs_wallet);\n          wallet->SetAddressBookName(CBitcoinAddress(strAddress).Get(), strLabel);\n      }\n      return QString::fromStdString(strAddress);\n  }\n}"
  },
  {
    "function_name": "updateEntry",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "315-319",
    "snippet": "void AddressTableModel::updateEntry(const QString &address, const QString &label, bool isMine, int status)\n{\n    // Update address book model from Bitcoin core\n    priv->updateEntry(address, label, isMine, status);\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "priv->updateEntry",
          "args": [
            "address",
            "label",
            "isMine",
            "status"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "updateEntry",
          "container": "AddressTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
          "lines": "315-319",
          "snippet": "void AddressTableModel::updateEntry(const QString &address, const QString &label, bool isMine, int status)\n{\n    // Update address book model from Bitcoin core\n    priv->updateEntry(address, label, isMine, status);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  void AddressTableModel::updateEntry(const QString &address, const QString &label, bool isMine, int status)\n  {\n      // Update address book model from Bitcoin core\n      priv->updateEntry(address, label, isMine, status);\n  }\n}"
  },
  {
    "function_name": "index",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "301-313",
    "snippet": "QModelIndex AddressTableModel::index(int row, int column, const QModelIndex &parent) const\n{\n    Q_UNUSED(parent);\n    AddressTableEntry *data = priv->index(row);\n    if(data)\n    {\n        return createIndex(row, column, priv->index(row));\n    }\n    else\n    {\n        return QModelIndex();\n    }\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QModelIndex",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "createIndex",
          "args": [
            "row",
            "column",
            "priv->index(row)"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "priv->index",
          "args": [
            "row"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "priv->index",
          "args": [
            "row"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_UNUSED",
          "args": [
            "parent"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  QModelIndex AddressTableModel::index(int row, int column, const QModelIndex &parent) const\n  {\n      Q_UNUSED(parent);\n      AddressTableEntry *data = priv->index(row);\n      if(data)\n      {\n          return createIndex(row, column, priv->index(row));\n      }\n      else\n      {\n          return QModelIndex();\n      }\n  }\n}"
  },
  {
    "function_name": "Flags",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "284-299",
    "snippet": "Qt::ItemFlags AddressTableModel::Flags(const QModelIndex &index) const\n{\n    if(!index.isValid())\n        return 0;\n    AddressTableEntry *rec = static_cast<AddressTableEntry*>(index.internalPointer());\n\n    Qt::ItemFlags retval = Qt::ItemIsSelectable | Qt::ItemIsEnabled;\n    // Can edit address and label for sending addresses,\n    // and only label for receiving addresses.\n    if(rec->type == AddressTableEntry::Sending ||\n      (rec->type == AddressTableEntry::Receiving && index.column()==Label))\n    {\n        retval |= Qt::ItemIsEditable;\n    }\n    return retval;\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "index.column",
          "args": [],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<AddressTableEntry*>",
          "args": [
            "index.internalPointer()"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.internalPointer",
          "args": [],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.isValid",
          "args": [],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "WalletModel::UnlockContext",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.h",
          "lines": "106-106",
          "snippet": "bool isValid() const { return valid; }",
          "includes": [
            "#include \"allocators.h\" /* for SecureString */",
            "#include <map>",
            "#include <vector>",
            "#include <QObject>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"allocators.h\" /* for SecureString */\n#include <map>\n#include <vector>\n#include <QObject>\n\nWalletModel {\n  UnlockContext {\n    bool isValid() const { return valid; }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  Qt::ItemFlags AddressTableModel::Flags(const QModelIndex &index) const\n  {\n      if(!index.isValid())\n          return 0;\n      AddressTableEntry *rec = static_cast<AddressTableEntry*>(index.internalPointer());\n  \n      Qt::ItemFlags retval = Qt::ItemIsSelectable | Qt::ItemIsEnabled;\n      // Can edit address and label for sending addresses,\n      // and only label for receiving addresses.\n      if(rec->type == AddressTableEntry::Sending ||\n        (rec->type == AddressTableEntry::Receiving && index.column()==Label))\n      {\n          retval |= Qt::ItemIsEditable;\n      }\n      return retval;\n  }\n}"
  },
  {
    "function_name": "headerData",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "272-282",
    "snippet": "QVariant AddressTableModel::headerData(int section, Qt::Orientation orientation, int role) const\n{\n    if(orientation == Qt::Horizontal)\n    {\n        if(role == Qt::DisplayRole)\n        {\n            return columns[section];\n        }\n    }\n    return QVariant();\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QVariant",
          "args": [],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  QVariant AddressTableModel::headerData(int section, Qt::Orientation orientation, int role) const\n  {\n      if(orientation == Qt::Horizontal)\n      {\n          if(role == Qt::DisplayRole)\n          {\n              return columns[section];\n          }\n      }\n      return QVariant();\n  }\n}"
  },
  {
    "function_name": "setData",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "213-270",
    "snippet": "bool AddressTableModel::setData(const QModelIndex &index, const QVariant &value, int role)\n{\n    if(!index.isValid())\n        return false;\n    AddressTableEntry *rec = static_cast<AddressTableEntry*>(index.internalPointer());\n\n    editStatus = OK;\n\n    if(role == Qt::EditRole)\n    {\n        switch(index.column())\n        {\n        case Label:\n            // Do nothing, if old label == new label\n            if(rec->label == value.toString())\n            {\n                editStatus = NO_CHANGES;\n                return false;\n            }\n            wallet->SetAddressBookName(CBitcoinAddress(rec->address.toStdString()).Get(), value.toString().toStdString());\n            break;\n        case Address:\n            // Do nothing, if old address == new address\n            if(CBitcoinAddress(rec->address.toStdString()) == CBitcoinAddress(value.toString().toStdString()))\n            {\n                editStatus = NO_CHANGES;\n                return false;\n            }\n            // Refuse to set invalid address, set error status and return false\n            else if(!walletModel->validateAddress(value.toString()))\n            {\n                editStatus = INVALID_ADDRESS;\n                return false;\n            }\n            // Check for duplicate addresses to prevent accidental deletion of addresses, if you try\n            // to paste an existing address over another address (with a different label)\n            else if(wallet->mapAddressBook.count(CBitcoinAddress(value.toString().toStdString()).Get()))\n            {\n                editStatus = DUPLICATE_ADDRESS;\n                return false;\n            }\n            // Double-check that we're not overwriting a receiving address\n            else if(rec->type == AddressTableEntry::Sending)\n            {\n                {\n                    LOCK(wallet->cs_wallet);\n                    // Remove old entry\n                    wallet->DelAddressBookName(CBitcoinAddress(rec->address.toStdString()).Get());\n                    // Add new entry with new address\n                    wallet->SetAddressBookName(CBitcoinAddress(value.toString().toStdString()).Get(), rec->label.toStdString());\n                }\n            }\n            break;\n        }\n        return true;\n    }\n    return false;\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wallet->SetAddressBookName",
          "args": [
            "CBitcoinAddress(value.toString().toStdString()).Get()",
            "rec->label.toStdString()"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rec->label.toStdString",
          "args": [],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "IsScript",
          "container": "CBitcoinAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "384-394",
          "snippet": "bool IsScript() const {\n        if (!IsValid())\n            return false;\n        switch (nVersion) {\n        case SCRIPT_ADDRESS:\n        case SCRIPT_ADDRESS_TEST: {\n            return true;\n        }\n        default: return false;\n        }\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool IsScript() const {\n          if (!IsValid())\n              return false;\n          switch (nVersion) {\n          case SCRIPT_ADDRESS:\n          case SCRIPT_ADDRESS_TEST: {\n              return true;\n          }\n          default: return false;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [
            "value.toString().toStdString()"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "operator()",
          "container": "CBitcoinAddressVisitor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "399-399",
          "snippet": "bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddressVisitor {\n  bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.toString",
          "args": [],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toString",
          "args": [],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wallet->DelAddressBookName",
          "args": [
            "CBitcoinAddress(rec->address.toStdString()).Get()"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rec->address.toStdString",
          "args": [],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "wallet->cs_wallet"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wallet->mapAddressBook.count",
          "args": [
            "CBitcoinAddress(value.toString().toStdString()).Get()"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "34-34",
          "snippet": "size_type count(const key_type& k) const { return map.count(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  size_type count(const key_type& k) const { return map.count(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.toString",
          "args": [],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toString",
          "args": [],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "walletModel->validateAddress",
          "args": [
            "value.toString()"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "validateAddress",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "126-130",
          "snippet": "bool WalletModel::validateAddress(const QString &address)\n{\n    CBitcoinAddress addressParsed(address.toStdString());\n    return addressParsed.IsValid();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  bool WalletModel::validateAddress(const QString &address)\n  {\n      CBitcoinAddress addressParsed(address.toStdString());\n      return addressParsed.IsValid();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.toString",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toString",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toString",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rec->address.toStdString",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wallet->SetAddressBookName",
          "args": [
            "CBitcoinAddress(rec->address.toStdString()).Get()",
            "value.toString().toStdString()"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toString",
          "args": [],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toString",
          "args": [],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rec->address.toStdString",
          "args": [],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toString",
          "args": [],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.column",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<AddressTableEntry*>",
          "args": [
            "index.internalPointer()"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.internalPointer",
          "args": [],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.isValid",
          "args": [],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "WalletModel::UnlockContext",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.h",
          "lines": "106-106",
          "snippet": "bool isValid() const { return valid; }",
          "includes": [
            "#include \"allocators.h\" /* for SecureString */",
            "#include <map>",
            "#include <vector>",
            "#include <QObject>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"allocators.h\" /* for SecureString */\n#include <map>\n#include <vector>\n#include <QObject>\n\nWalletModel {\n  UnlockContext {\n    bool isValid() const { return valid; }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  bool AddressTableModel::setData(const QModelIndex &index, const QVariant &value, int role)\n  {\n      if(!index.isValid())\n          return false;\n      AddressTableEntry *rec = static_cast<AddressTableEntry*>(index.internalPointer());\n  \n      editStatus = OK;\n  \n      if(role == Qt::EditRole)\n      {\n          switch(index.column())\n          {\n          case Label:\n              // Do nothing, if old label == new label\n              if(rec->label == value.toString())\n              {\n                  editStatus = NO_CHANGES;\n                  return false;\n              }\n              wallet->SetAddressBookName(CBitcoinAddress(rec->address.toStdString()).Get(), value.toString().toStdString());\n              break;\n          case Address:\n              // Do nothing, if old address == new address\n              if(CBitcoinAddress(rec->address.toStdString()) == CBitcoinAddress(value.toString().toStdString()))\n              {\n                  editStatus = NO_CHANGES;\n                  return false;\n              }\n              // Refuse to set invalid address, set error status and return false\n              else if(!walletModel->validateAddress(value.toString()))\n              {\n                  editStatus = INVALID_ADDRESS;\n                  return false;\n              }\n              // Check for duplicate addresses to prevent accidental deletion of addresses, if you try\n              // to paste an existing address over another address (with a different label)\n              else if(wallet->mapAddressBook.count(CBitcoinAddress(value.toString().toStdString()).Get()))\n              {\n                  editStatus = DUPLICATE_ADDRESS;\n                  return false;\n              }\n              // Double-check that we're not overwriting a receiving address\n              else if(rec->type == AddressTableEntry::Sending)\n              {\n                  {\n                      LOCK(wallet->cs_wallet);\n                      // Remove old entry\n                      wallet->DelAddressBookName(CBitcoinAddress(rec->address.toStdString()).Get());\n                      // Add new entry with new address\n                      wallet->SetAddressBookName(CBitcoinAddress(value.toString().toStdString()).Get(), rec->label.toStdString());\n                  }\n              }\n              break;\n          }\n          return true;\n      }\n      return false;\n  }\n}"
  },
  {
    "function_name": "data",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "166-211",
    "snippet": "QVariant AddressTableModel::data(const QModelIndex &index, int role) const\n{\n    if(!index.isValid())\n        return QVariant();\n\n    AddressTableEntry *rec = static_cast<AddressTableEntry*>(index.internalPointer());\n\n    if(role == Qt::DisplayRole || role == Qt::EditRole)\n    {\n        switch(index.column())\n        {\n        case Label:\n            if(rec->label.isEmpty() && role == Qt::DisplayRole)\n            {\n                return tr(\"(no label)\");\n            }\n            else\n            {\n                return rec->label;\n            }\n        case Address:\n            return rec->address;\n        }\n    }\n    else if (role == Qt::FontRole)\n    {\n        QFont font;\n        if(index.column() == Address)\n        {\n            font = GUIUtil::bitcoinAddressFont();\n        }\n        return font;\n    }\n    else if (role == TypeRole)\n    {\n        switch(rec->type)\n        {\n        case AddressTableEntry::Sending:\n            return Send;\n        case AddressTableEntry::Receiving:\n            return Receive;\n        default: break;\n        }\n    }\n    return QVariant();\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "const QString AddressTableModel::Send = \"S\";",
      "const QString AddressTableModel::Receive = \"R\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "QVariant",
          "args": [],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::bitcoinAddressFont",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "bitcoinAddressFont",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "55-60",
          "snippet": "QFont bitcoinAddressFont()\n{\n    QFont font(\"Monospace\");\n    font.setStyleHint(QFont::TypeWriter);\n    return font;\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQFont bitcoinAddressFont()\n{\n    QFont font(\"Monospace\");\n    font.setStyleHint(QFont::TypeWriter);\n    return font;\n}"
        }
      },
      {
        "call_info": {
          "callee": "index.column",
          "args": [],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"(no label)\""
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rec->label.isEmpty",
          "args": [],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.column",
          "args": [],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<AddressTableEntry*>",
          "args": [
            "index.internalPointer()"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.internalPointer",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.isValid",
          "args": [],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "WalletModel::UnlockContext",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.h",
          "lines": "106-106",
          "snippet": "bool isValid() const { return valid; }",
          "includes": [
            "#include \"allocators.h\" /* for SecureString */",
            "#include <map>",
            "#include <vector>",
            "#include <QObject>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"allocators.h\" /* for SecureString */\n#include <map>\n#include <vector>\n#include <QObject>\n\nWalletModel {\n  UnlockContext {\n    bool isValid() const { return valid; }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nconst QString AddressTableModel::Send = \"S\";\nconst QString AddressTableModel::Receive = \"R\";\n\nAddressTableModel {\n  QVariant AddressTableModel::data(const QModelIndex &index, int role) const\n  {\n      if(!index.isValid())\n          return QVariant();\n  \n      AddressTableEntry *rec = static_cast<AddressTableEntry*>(index.internalPointer());\n  \n      if(role == Qt::DisplayRole || role == Qt::EditRole)\n      {\n          switch(index.column())\n          {\n          case Label:\n              if(rec->label.isEmpty() && role == Qt::DisplayRole)\n              {\n                  return tr(\"(no label)\");\n              }\n              else\n              {\n                  return rec->label;\n              }\n          case Address:\n              return rec->address;\n          }\n      }\n      else if (role == Qt::FontRole)\n      {\n          QFont font;\n          if(index.column() == Address)\n          {\n              font = GUIUtil::bitcoinAddressFont();\n          }\n          return font;\n      }\n      else if (role == TypeRole)\n      {\n          switch(rec->type)\n          {\n          case AddressTableEntry::Sending:\n              return Send;\n          case AddressTableEntry::Receiving:\n              return Receive;\n          default: break;\n          }\n      }\n      return QVariant();\n  }\n}"
  },
  {
    "function_name": "columnCount",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "160-164",
    "snippet": "int AddressTableModel::columnCount(const QModelIndex &parent) const\n{\n    Q_UNUSED(parent);\n    return columns.length();\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "columns.length",
          "args": [],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_UNUSED",
          "args": [
            "parent"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  int AddressTableModel::columnCount(const QModelIndex &parent) const\n  {\n      Q_UNUSED(parent);\n      return columns.length();\n  }\n}"
  },
  {
    "function_name": "rowCount",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "154-158",
    "snippet": "int AddressTableModel::rowCount(const QModelIndex &parent) const\n{\n    Q_UNUSED(parent);\n    return priv->size();\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "priv->size",
          "args": [],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "AddressTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
          "lines": "123-126",
          "snippet": "int size()\n    {\n        return cachedAddressTable.size();\n    }",
          "includes": [
            "#include <QColor>",
            "#include <QFont>",
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTablePriv {\n  int size()\n      {\n          return cachedAddressTable.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Q_UNUSED",
          "args": [
            "parent"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  int AddressTableModel::rowCount(const QModelIndex &parent) const\n  {\n      Q_UNUSED(parent);\n      return priv->size();\n  }\n}"
  },
  {
    "function_name": "~AddressTableModel",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "149-152",
    "snippet": "AddressTableModel::~AddressTableModel()\n{\n    delete priv;\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  AddressTableModel::~AddressTableModel()\n  {\n      delete priv;\n  }\n}"
  },
  {
    "function_name": "AddressTableModel",
    "container": "AddressTableModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "141-147",
    "snippet": "AddressTableModel::AddressTableModel(CWallet *wallet, WalletModel *parent) :\n    QAbstractTableModel(parent),walletModel(parent),wallet(wallet),priv(0)\n{\n    columns << tr(\"Label\") << tr(\"Address\");\n    priv = new AddressTablePriv(wallet, this);\n    priv->refreshAddressTable();\n}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "priv->refreshAddressTable",
          "args": [],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "refreshAddressTable",
          "container": "AddressTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
          "lines": "57-74",
          "snippet": "void refreshAddressTable()\n    {\n        cachedAddressTable.clear();\n        {\n            LOCK(wallet->cs_wallet);\n            BOOST_FOREACH(const PAIRTYPE(CTxDestination, std::string)& item, wallet->mapAddressBook)\n            {\n                const CBitcoinAddress& address = item.first;\n                const std::string& strName = item.second;\n                bool fMine = IsMine(*wallet, address.Get());\n                cachedAddressTable.append(AddressTableEntry(fMine ? AddressTableEntry::Receiving : AddressTableEntry::Sending,\n                                  QString::fromStdString(strName),\n                                  QString::fromStdString(address.ToString())));\n            }\n        }\n        // qLowerBound() and qUpperBound() require our cachedAddressTable list to be sorted in asc order\n        qSort(cachedAddressTable.begin(), cachedAddressTable.end(), AddressTableEntryLessThan());\n    }",
          "includes": [
            "#include <QColor>",
            "#include <QFont>",
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTablePriv {\n  void refreshAddressTable()\n      {\n          cachedAddressTable.clear();\n          {\n              LOCK(wallet->cs_wallet);\n              BOOST_FOREACH(const PAIRTYPE(CTxDestination, std::string)& item, wallet->mapAddressBook)\n              {\n                  const CBitcoinAddress& address = item.first;\n                  const std::string& strName = item.second;\n                  bool fMine = IsMine(*wallet, address.Get());\n                  cachedAddressTable.append(AddressTableEntry(fMine ? AddressTableEntry::Receiving : AddressTableEntry::Sending,\n                                    QString::fromStdString(strName),\n                                    QString::fromStdString(address.ToString())));\n              }\n          }\n          // qLowerBound() and qUpperBound() require our cachedAddressTable list to be sorted in asc order\n          qSort(cachedAddressTable.begin(), cachedAddressTable.end(), AddressTableEntryLessThan());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Address\""
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  AddressTableModel::AddressTableModel(CWallet *wallet, WalletModel *parent) :\n      QAbstractTableModel(parent),walletModel(parent),wallet(wallet),priv(0)\n  {\n      columns << tr(\"Label\") << tr(\"Address\");\n      priv = new AddressTablePriv(wallet, this);\n      priv->refreshAddressTable();\n  }\n}"
  },
  {
    "function_name": "size",
    "container": "AddressTablePriv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "123-126",
    "snippet": "int size()\n    {\n        return cachedAddressTable.size();\n    }",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cachedAddressTable.size",
          "args": [],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "AddressTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
          "lines": "123-126",
          "snippet": "int size()\n    {\n        return cachedAddressTable.size();\n    }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTablePriv {\n  int size()\n      {\n          return cachedAddressTable.size();\n      }\n}"
  },
  {
    "function_name": "updateEntry",
    "container": "AddressTablePriv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "76-121",
    "snippet": "void updateEntry(const QString &address, const QString &label, bool isMine, int status)\n    {\n        // Find address / label in model\n        QList<AddressTableEntry>::iterator lower = qLowerBound(\n            cachedAddressTable.begin(), cachedAddressTable.end(), address, AddressTableEntryLessThan());\n        QList<AddressTableEntry>::iterator upper = qUpperBound(\n            cachedAddressTable.begin(), cachedAddressTable.end(), address, AddressTableEntryLessThan());\n        int lowerIndex = (lower - cachedAddressTable.begin());\n        int upperIndex = (upper - cachedAddressTable.begin());\n        bool inModel = (lower != upper);\n        AddressTableEntry::Type newEntryType = isMine ? AddressTableEntry::Receiving : AddressTableEntry::Sending;\n\n        switch(status)\n        {\n        case CT_NEW:\n            if(inModel)\n            {\n                OutputDebugStringF(\"Warning: AddressTablePriv::updateEntry: Got CT_NEW, but entry is already in model\\n\");\n                break;\n            }\n            parent->beginInsertRows(QModelIndex(), lowerIndex, lowerIndex);\n            cachedAddressTable.insert(lowerIndex, AddressTableEntry(newEntryType, label, address));\n            parent->endInsertRows();\n            break;\n        case CT_UPDATED:\n            if(!inModel)\n            {\n                OutputDebugStringF(\"Warning: AddressTablePriv::updateEntry: Got CT_UPDATED, but entry is not in model\\n\");\n                break;\n            }\n            lower->type = newEntryType;\n            lower->label = label;\n            parent->emitDataChanged(lowerIndex);\n            break;\n        case CT_DELETED:\n            if(!inModel)\n            {\n                OutputDebugStringF(\"Warning: AddressTablePriv::updateEntry: Got CT_DELETED, but entry is not in model\\n\");\n                break;\n            }\n            parent->beginRemoveRows(QModelIndex(), lowerIndex, upperIndex-1);\n            cachedAddressTable.erase(lower, upper);\n            parent->endRemoveRows();\n            break;\n        }\n    }",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parent->endRemoveRows",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cachedAddressTable.erase",
          "args": [
            "lower",
            "upper"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "870-888",
          "snippet": "iterator erase(iterator first, iterator last)\n    {\n        if (first == vch.begin() + nReadPos)\n        {\n            // special case for erasing from the front\n            if (last == vch.end())\n            {\n                nReadPos = 0;\n                return vch.erase(vch.begin(), vch.end());\n            }\n            else\n            {\n                nReadPos = (last - vch.begin());\n                return last;\n            }\n        }\n        else\n            return vch.erase(first, last);\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  iterator erase(iterator first, iterator last)\n      {\n          if (first == vch.begin() + nReadPos)\n          {\n              // special case for erasing from the front\n              if (last == vch.end())\n              {\n                  nReadPos = 0;\n                  return vch.erase(vch.begin(), vch.end());\n              }\n              else\n              {\n                  nReadPos = (last - vch.begin());\n                  return last;\n              }\n          }\n          else\n              return vch.erase(first, last);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "parent->beginRemoveRows",
          "args": [
            "QModelIndex()",
            "lowerIndex",
            "upperIndex-1"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QModelIndex",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OutputDebugStringF",
          "args": [
            "\"Warning: AddressTablePriv::updateEntry: Got CT_DELETED, but entry is not in model\\n\""
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "OutputDebugStringF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "207-289",
          "snippet": "inline int OutputDebugStringF(const char* pszFormat, ...)\n{\n    int ret = 0;\n    if (fPrintToConsole)\n    {\n        // print to console\n        va_list arg_ptr;\n        va_start(arg_ptr, pszFormat);\n        ret = vprintf(pszFormat, arg_ptr);\n        va_end(arg_ptr);\n    }\n    else if (!fPrintToDebugger)\n    {\n        // print to debug.log\n\n        if (!fileout)\n        {\n            boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n            fileout = fopen(pathDebug.string().c_str(), \"a\");\n            if (fileout) setbuf(fileout, NULL); // unbuffered\n        }\n        if (fileout)\n        {\n            static bool fStartedNewLine = true;\n\n            // This routine may be called by global destructors during shutdown.\n            // Since the order of destruction of static/global objects is undefined,\n            // allocate mutexDebugLog on the heap the first time this routine\n            // is called to avoid crashes during shutdown.\n            static boost::mutex* mutexDebugLog = NULL;\n            if (mutexDebugLog == NULL) mutexDebugLog = new boost::mutex();\n            boost::mutex::scoped_lock scoped_lock(*mutexDebugLog);\n\n            // reopen the log file, if requested\n            if (fReopenDebugLog) {\n                fReopenDebugLog = false;\n                boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n                if (freopen(pathDebug.string().c_str(),\"a\",fileout) != NULL)\n                    setbuf(fileout, NULL); // unbuffered\n            }\n\n            // Debug print useful for profiling\n            if (fLogTimestamps && fStartedNewLine)\n                fprintf(fileout, \"%s \", DateTimeStrFormat(\"%x %H:%M:%S\", GetTime()).c_str());\n            if (pszFormat[strlen(pszFormat) - 1] == '\\n')\n                fStartedNewLine = true;\n            else\n                fStartedNewLine = false;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            ret = vfprintf(fileout, pszFormat, arg_ptr);\n            va_end(arg_ptr);\n        }\n    }\n\n#ifdef WIN32\n    if (fPrintToDebugger)\n    {\n        static CCriticalSection cs_OutputDebugStringF;\n\n        // accumulate and output a line at a time\n        {\n            LOCK(cs_OutputDebugStringF);\n            static std::string buffer;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            buffer += vstrprintf(pszFormat, arg_ptr);\n            va_end(arg_ptr);\n\n            int line_start = 0, line_end;\n            while((line_end = buffer.find('\\n', line_start)) != -1)\n            {\n                OutputDebugStringA(buffer.substr(line_start, line_end - line_start).c_str());\n                line_start = line_end + 1;\n            }\n            buffer.erase(0, line_start);\n        }\n    }\n#endif\n    return ret;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "bool fPrintToConsole = false;",
            "bool fPrintToDebugger = false;",
            "bool fLogTimestamps = false;",
            "bool fReopenDebugLog = false;",
            "static FILE* fileout = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool fPrintToConsole = false;\nbool fPrintToDebugger = false;\nbool fLogTimestamps = false;\nbool fReopenDebugLog = false;\nstatic FILE* fileout = NULL;\n\ninline int OutputDebugStringF(const char* pszFormat, ...)\n{\n    int ret = 0;\n    if (fPrintToConsole)\n    {\n        // print to console\n        va_list arg_ptr;\n        va_start(arg_ptr, pszFormat);\n        ret = vprintf(pszFormat, arg_ptr);\n        va_end(arg_ptr);\n    }\n    else if (!fPrintToDebugger)\n    {\n        // print to debug.log\n\n        if (!fileout)\n        {\n            boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n            fileout = fopen(pathDebug.string().c_str(), \"a\");\n            if (fileout) setbuf(fileout, NULL); // unbuffered\n        }\n        if (fileout)\n        {\n            static bool fStartedNewLine = true;\n\n            // This routine may be called by global destructors during shutdown.\n            // Since the order of destruction of static/global objects is undefined,\n            // allocate mutexDebugLog on the heap the first time this routine\n            // is called to avoid crashes during shutdown.\n            static boost::mutex* mutexDebugLog = NULL;\n            if (mutexDebugLog == NULL) mutexDebugLog = new boost::mutex();\n            boost::mutex::scoped_lock scoped_lock(*mutexDebugLog);\n\n            // reopen the log file, if requested\n            if (fReopenDebugLog) {\n                fReopenDebugLog = false;\n                boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n                if (freopen(pathDebug.string().c_str(),\"a\",fileout) != NULL)\n                    setbuf(fileout, NULL); // unbuffered\n            }\n\n            // Debug print useful for profiling\n            if (fLogTimestamps && fStartedNewLine)\n                fprintf(fileout, \"%s \", DateTimeStrFormat(\"%x %H:%M:%S\", GetTime()).c_str());\n            if (pszFormat[strlen(pszFormat) - 1] == '\\n')\n                fStartedNewLine = true;\n            else\n                fStartedNewLine = false;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            ret = vfprintf(fileout, pszFormat, arg_ptr);\n            va_end(arg_ptr);\n        }\n    }\n\n#ifdef WIN32\n    if (fPrintToDebugger)\n    {\n        static CCriticalSection cs_OutputDebugStringF;\n\n        // accumulate and output a line at a time\n        {\n            LOCK(cs_OutputDebugStringF);\n            static std::string buffer;\n\n            va_list arg_ptr;\n            va_start(arg_ptr, pszFormat);\n            buffer += vstrprintf(pszFormat, arg_ptr);\n            va_end(arg_ptr);\n\n            int line_start = 0, line_end;\n            while((line_end = buffer.find('\\n', line_start)) != -1)\n            {\n                OutputDebugStringA(buffer.substr(line_start, line_end - line_start).c_str());\n                line_start = line_end + 1;\n            }\n            buffer.erase(0, line_start);\n        }\n    }\n#endif\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "parent->emitDataChanged",
          "args": [
            "lowerIndex"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "emitDataChanged",
          "container": "AddressTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
          "lines": "423-426",
          "snippet": "void AddressTableModel::emitDataChanged(int idx)\n{\n    emit dataChanged(index(idx, 0, QModelIndex()), index(idx, columns.length()-1, QModelIndex()));\n}",
          "includes": [
            "#include <QColor>",
            "#include <QFont>",
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableModel {\n  void AddressTableModel::emitDataChanged(int idx)\n  {\n      emit dataChanged(index(idx, 0, QModelIndex()), index(idx, columns.length()-1, QModelIndex()));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "parent->endInsertRows",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cachedAddressTable.insert",
          "args": [
            "lowerIndex",
            "AddressTableEntry(newEntryType, label, address)"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AddressTableEntry",
          "args": [
            "newEntryType",
            "label",
            "address"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "AddressTableEntry",
          "container": "AddressTableEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
          "lines": "26-27",
          "snippet": "AddressTableEntry(Type type, const QString &label, const QString &address):\n        type(type), label(label), address(address) {}",
          "includes": [
            "#include <QColor>",
            "#include <QFont>",
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableEntry {\n  AddressTableEntry(Type type, const QString &label, const QString &address):\n          type(type), label(label), address(address) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "parent->beginInsertRows",
          "args": [
            "QModelIndex()",
            "lowerIndex",
            "lowerIndex"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QModelIndex",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cachedAddressTable.begin",
          "args": [],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "qUpperBound",
          "args": [
            "cachedAddressTable.begin()",
            "cachedAddressTable.end()",
            "address",
            "AddressTableEntryLessThan()"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AddressTableEntryLessThan",
          "args": [],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cachedAddressTable.end",
          "args": [],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "qLowerBound",
          "args": [
            "cachedAddressTable.begin()",
            "cachedAddressTable.end()",
            "address",
            "AddressTableEntryLessThan()"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AddressTableEntryLessThan",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTablePriv {\n  void updateEntry(const QString &address, const QString &label, bool isMine, int status)\n      {\n          // Find address / label in model\n          QList<AddressTableEntry>::iterator lower = qLowerBound(\n              cachedAddressTable.begin(), cachedAddressTable.end(), address, AddressTableEntryLessThan());\n          QList<AddressTableEntry>::iterator upper = qUpperBound(\n              cachedAddressTable.begin(), cachedAddressTable.end(), address, AddressTableEntryLessThan());\n          int lowerIndex = (lower - cachedAddressTable.begin());\n          int upperIndex = (upper - cachedAddressTable.begin());\n          bool inModel = (lower != upper);\n          AddressTableEntry::Type newEntryType = isMine ? AddressTableEntry::Receiving : AddressTableEntry::Sending;\n  \n          switch(status)\n          {\n          case CT_NEW:\n              if(inModel)\n              {\n                  OutputDebugStringF(\"Warning: AddressTablePriv::updateEntry: Got CT_NEW, but entry is already in model\\n\");\n                  break;\n              }\n              parent->beginInsertRows(QModelIndex(), lowerIndex, lowerIndex);\n              cachedAddressTable.insert(lowerIndex, AddressTableEntry(newEntryType, label, address));\n              parent->endInsertRows();\n              break;\n          case CT_UPDATED:\n              if(!inModel)\n              {\n                  OutputDebugStringF(\"Warning: AddressTablePriv::updateEntry: Got CT_UPDATED, but entry is not in model\\n\");\n                  break;\n              }\n              lower->type = newEntryType;\n              lower->label = label;\n              parent->emitDataChanged(lowerIndex);\n              break;\n          case CT_DELETED:\n              if(!inModel)\n              {\n                  OutputDebugStringF(\"Warning: AddressTablePriv::updateEntry: Got CT_DELETED, but entry is not in model\\n\");\n                  break;\n              }\n              parent->beginRemoveRows(QModelIndex(), lowerIndex, upperIndex-1);\n              cachedAddressTable.erase(lower, upper);\n              parent->endRemoveRows();\n              break;\n          }\n      }\n}"
  },
  {
    "function_name": "refreshAddressTable",
    "container": "AddressTablePriv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "57-74",
    "snippet": "void refreshAddressTable()\n    {\n        cachedAddressTable.clear();\n        {\n            LOCK(wallet->cs_wallet);\n            BOOST_FOREACH(const PAIRTYPE(CTxDestination, std::string)& item, wallet->mapAddressBook)\n            {\n                const CBitcoinAddress& address = item.first;\n                const std::string& strName = item.second;\n                bool fMine = IsMine(*wallet, address.Get());\n                cachedAddressTable.append(AddressTableEntry(fMine ? AddressTableEntry::Receiving : AddressTableEntry::Sending,\n                                  QString::fromStdString(strName),\n                                  QString::fromStdString(address.ToString())));\n            }\n        }\n        // qLowerBound() and qUpperBound() require our cachedAddressTable list to be sorted in asc order\n        qSort(cachedAddressTable.begin(), cachedAddressTable.end(), AddressTableEntryLessThan());\n    }",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qSort",
          "args": [
            "cachedAddressTable.begin()",
            "cachedAddressTable.end()",
            "AddressTableEntryLessThan()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AddressTableEntryLessThan",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cachedAddressTable.end",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cachedAddressTable.begin",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cachedAddressTable.append",
          "args": [
            "AddressTableEntry(fMine ? AddressTableEntry::Receiving : AddressTableEntry::Sending,\n                                  QString::fromStdString(strName),\n                                  QString::fromStdString(address.ToString()))"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AddressTableEntry",
          "args": [
            "fMine ? AddressTableEntry::Receiving : AddressTableEntry::Sending",
            "QString::fromStdString(strName)",
            "QString::fromStdString(address.ToString())"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "AddressTableEntry",
          "container": "AddressTableEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
          "lines": "26-27",
          "snippet": "AddressTableEntry(Type type, const QString &label, const QString &address):\n        type(type), label(label), address(address) {}",
          "includes": [
            "#include <QColor>",
            "#include <QFont>",
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableEntry {\n  AddressTableEntry(Type type, const QString &label, const QString &address):\n          type(type), label(label), address(address) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "address.ToString()"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "address.ToString",
          "args": [],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "strName"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsMine",
          "args": [
            "*wallet",
            "address.Get()"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "IsMine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.cpp",
          "lines": "1551-1588",
          "snippet": "bool IsMine(const CKeyStore &keystore, const CScript& scriptPubKey)\n{\n    vector<valtype> vSolutions;\n    txnouttype whichType;\n    if (!Solver(scriptPubKey, whichType, vSolutions))\n        return false;\n\n    CKeyID keyID;\n    switch (whichType)\n    {\n    case TX_NONSTANDARD:\n        return false;\n    case TX_PUBKEY:\n        keyID = CPubKey(vSolutions[0]).GetID();\n        return keystore.HaveKey(keyID);\n    case TX_PUBKEYHASH:\n        keyID = CKeyID(uint160(vSolutions[0]));\n        return keystore.HaveKey(keyID);\n    case TX_SCRIPTHASH:\n    {\n        CScript subscript;\n        if (!keystore.GetCScript(CScriptID(uint160(vSolutions[0])), subscript))\n            return false;\n        return IsMine(keystore, subscript);\n    }\n    case TX_MULTISIG:\n    {\n        // Only consider transactions \"mine\" if we own ALL the\n        // keys involved. multi-signature transactions that are\n        // partially owned (somebody else has a key that can spend\n        // them) enable spend-out-from-under-you attacks, especially\n        // in shared-wallet situations.\n        vector<valtype> keys(vSolutions.begin()+1, vSolutions.begin()+vSolutions.size()-1);\n        return HaveKeys(keys, keystore) == keys.size();\n    }\n    }\n    return false;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"sync.h\"",
            "#include \"main.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include \"script.h\"",
            "#include <boost/tuple/tuple_comparison.hpp>",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/foreach.hpp>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"sync.h\"\n#include \"main.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include \"keystore.h\"\n#include \"script.h\"\n#include <boost/tuple/tuple_comparison.hpp>\n#include <boost/tuple/tuple.hpp>\n#include <boost/foreach.hpp>\n\nbool IsMine(const CKeyStore &keystore, const CScript& scriptPubKey)\n{\n    vector<valtype> vSolutions;\n    txnouttype whichType;\n    if (!Solver(scriptPubKey, whichType, vSolutions))\n        return false;\n\n    CKeyID keyID;\n    switch (whichType)\n    {\n    case TX_NONSTANDARD:\n        return false;\n    case TX_PUBKEY:\n        keyID = CPubKey(vSolutions[0]).GetID();\n        return keystore.HaveKey(keyID);\n    case TX_PUBKEYHASH:\n        keyID = CKeyID(uint160(vSolutions[0]));\n        return keystore.HaveKey(keyID);\n    case TX_SCRIPTHASH:\n    {\n        CScript subscript;\n        if (!keystore.GetCScript(CScriptID(uint160(vSolutions[0])), subscript))\n            return false;\n        return IsMine(keystore, subscript);\n    }\n    case TX_MULTISIG:\n    {\n        // Only consider transactions \"mine\" if we own ALL the\n        // keys involved. multi-signature transactions that are\n        // partially owned (somebody else has a key that can spend\n        // them) enable spend-out-from-under-you attacks, especially\n        // in shared-wallet situations.\n        vector<valtype> keys(vSolutions.begin()+1, vSolutions.begin()+vSolutions.size()-1);\n        return HaveKeys(keys, keystore) == keys.size();\n    }\n    }\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "address.Get",
          "args": [],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "CBitcoinAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "349-367",
          "snippet": "CTxDestination Get() const {\n        if (!IsValid())\n            return CNoDestination();\n        switch (nVersion) {\n        case PUBKEY_ADDRESS:\n        case PUBKEY_ADDRESS_TEST: {\n            uint160 id;\n            memcpy(&id, &vchData[0], 20);\n            return CKeyID(id);\n        }\n        case SCRIPT_ADDRESS:\n        case SCRIPT_ADDRESS_TEST: {\n            uint160 id;\n            memcpy(&id, &vchData[0], 20);\n            return CScriptID(id);\n        }\n        }\n        return CNoDestination();\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  CTxDestination Get() const {\n          if (!IsValid())\n              return CNoDestination();\n          switch (nVersion) {\n          case PUBKEY_ADDRESS:\n          case PUBKEY_ADDRESS_TEST: {\n              uint160 id;\n              memcpy(&id, &vchData[0], 20);\n              return CKeyID(id);\n          }\n          case SCRIPT_ADDRESS:\n          case SCRIPT_ADDRESS_TEST: {\n              uint160 id;\n              memcpy(&id, &vchData[0], 20);\n              return CScriptID(id);\n          }\n          }\n          return CNoDestination();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK",
          "args": [
            "wallet->cs_wallet"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cachedAddressTable.clear",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTablePriv {\n  void refreshAddressTable()\n      {\n          cachedAddressTable.clear();\n          {\n              LOCK(wallet->cs_wallet);\n              BOOST_FOREACH(const PAIRTYPE(CTxDestination, std::string)& item, wallet->mapAddressBook)\n              {\n                  const CBitcoinAddress& address = item.first;\n                  const std::string& strName = item.second;\n                  bool fMine = IsMine(*wallet, address.Get());\n                  cachedAddressTable.append(AddressTableEntry(fMine ? AddressTableEntry::Receiving : AddressTableEntry::Sending,\n                                    QString::fromStdString(strName),\n                                    QString::fromStdString(address.ToString())));\n              }\n          }\n          // qLowerBound() and qUpperBound() require our cachedAddressTable list to be sorted in asc order\n          qSort(cachedAddressTable.begin(), cachedAddressTable.end(), AddressTableEntryLessThan());\n      }\n}"
  },
  {
    "function_name": "AddressTablePriv",
    "container": "AddressTablePriv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "54-55",
    "snippet": "AddressTablePriv(CWallet *wallet, AddressTableModel *parent):\n        wallet(wallet), parent(parent) {}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTablePriv {\n  AddressTablePriv(CWallet *wallet, AddressTableModel *parent):\n          wallet(wallet), parent(parent) {}\n}"
  },
  {
    "function_name": "AddressTableEntry",
    "container": "AddressTableEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "26-27",
    "snippet": "AddressTableEntry(Type type, const QString &label, const QString &address):\n        type(type), label(label), address(address) {}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableEntry {\n  AddressTableEntry(Type type, const QString &label, const QString &address):\n          type(type), label(label), address(address) {}\n}"
  },
  {
    "function_name": "AddressTableEntry",
    "container": "AddressTableEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
    "lines": "25-25",
    "snippet": "AddressTableEntry() {}",
    "includes": [
      "#include <QColor>",
      "#include <QFont>",
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nAddressTableEntry {\n  AddressTableEntry() {}\n}"
  }
]