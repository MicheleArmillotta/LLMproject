[
  {
    "function_name": "showOutOfSyncWarning",
    "container": "OverviewPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
    "lines": "193-197",
    "snippet": "void OverviewPage::showOutOfSyncWarning(bool fShow)\n{\n    ui->labelWalletStatus->setVisible(fShow);\n    ui->labelTransactionsStatus->setVisible(fShow);\n}",
    "includes": [
      "#include \"overviewpage.moc\"",
      "#include <QPainter>",
      "#include <QAbstractItemDelegate>",
      "#include \"guiconstants.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"ui_overviewpage.h\"",
      "#include \"overviewpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->labelTransactionsStatus->setVisible",
          "args": [
            "fShow"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelWalletStatus->setVisible",
          "args": [
            "fShow"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\nOverviewPage {\n  void OverviewPage::showOutOfSyncWarning(bool fShow)\n  {\n      ui->labelWalletStatus->setVisible(fShow);\n      ui->labelTransactionsStatus->setVisible(fShow);\n  }\n}"
  },
  {
    "function_name": "updateDisplayUnit",
    "container": "OverviewPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
    "lines": "179-191",
    "snippet": "void OverviewPage::updateDisplayUnit()\n{\n    if(model && model->getOptionsModel())\n    {\n        if(currentBalance != -1)\n            setBalance(currentBalance, model->getStake(), currentUnconfirmedBalance, currentImmatureBalance);\n\n        // Update txdelegate->unit with the current unit\n        txdelegate->unit = model->getOptionsModel()->getDisplayUnit();\n\n        ui->listTransactions->update();\n    }\n}",
    "includes": [
      "#include \"overviewpage.moc\"",
      "#include <QPainter>",
      "#include <QAbstractItemDelegate>",
      "#include \"guiconstants.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"ui_overviewpage.h\"",
      "#include \"overviewpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->listTransactions->update",
          "args": [],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setBalance",
          "args": [
            "currentBalance",
            "model->getStake()",
            "currentUnconfirmedBalance",
            "currentImmatureBalance"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "setBalance",
          "container": "OverviewPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
          "lines": "131-149",
          "snippet": "void OverviewPage::setBalance(qint64 balance, qint64 stake, qint64 unconfirmedBalance, qint64 immatureBalance)\n{\n    int unit = model->getOptionsModel()->getDisplayUnit();\n    currentBalance = balance;\n    currentStake = stake;\n    currentUnconfirmedBalance = unconfirmedBalance;\n    currentImmatureBalance = immatureBalance;\n    ui->labelBalance->setText(BitcoinUnits::formatWithUnit(unit, balance));\n    ui->labelStake->setText(BitcoinUnits::formatWithUnit(unit, stake));\n    ui->labelUnconfirmed->setText(BitcoinUnits::formatWithUnit(unit, unconfirmedBalance));\n    ui->labelImmature->setText(BitcoinUnits::formatWithUnit(unit, immatureBalance));\n    ui->labelTotal->setText(BitcoinUnits::formatWithUnit(unit, balance + stake + unconfirmedBalance + immatureBalance));\n\n    // only show immature (newly mined) balance if it's non-zero, so as not to complicate things\n    // for the non-mining users\n    bool showImmature = immatureBalance != 0;\n    ui->labelImmature->setVisible(showImmature);\n    ui->labelImmatureText->setVisible(showImmature);\n}",
          "includes": [
            "#include \"overviewpage.moc\"",
            "#include <QPainter>",
            "#include <QAbstractItemDelegate>",
            "#include \"guiconstants.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"ui_overviewpage.h\"",
            "#include \"overviewpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\nOverviewPage {\n  void OverviewPage::setBalance(qint64 balance, qint64 stake, qint64 unconfirmedBalance, qint64 immatureBalance)\n  {\n      int unit = model->getOptionsModel()->getDisplayUnit();\n      currentBalance = balance;\n      currentStake = stake;\n      currentUnconfirmedBalance = unconfirmedBalance;\n      currentImmatureBalance = immatureBalance;\n      ui->labelBalance->setText(BitcoinUnits::formatWithUnit(unit, balance));\n      ui->labelStake->setText(BitcoinUnits::formatWithUnit(unit, stake));\n      ui->labelUnconfirmed->setText(BitcoinUnits::formatWithUnit(unit, unconfirmedBalance));\n      ui->labelImmature->setText(BitcoinUnits::formatWithUnit(unit, immatureBalance));\n      ui->labelTotal->setText(BitcoinUnits::formatWithUnit(unit, balance + stake + unconfirmedBalance + immatureBalance));\n  \n      // only show immature (newly mined) balance if it's non-zero, so as not to complicate things\n      // for the non-mining users\n      bool showImmature = immatureBalance != 0;\n      ui->labelImmature->setVisible(showImmature);\n      ui->labelImmatureText->setVisible(showImmature);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getStake",
          "args": [],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "getStake",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "49-52",
          "snippet": "qint64 WalletModel::getStake() const\n{\n    return wallet->GetStake();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  qint64 WalletModel::getStake() const\n  {\n      return wallet->GetStake();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\nOverviewPage {\n  void OverviewPage::updateDisplayUnit()\n  {\n      if(model && model->getOptionsModel())\n      {\n          if(currentBalance != -1)\n              setBalance(currentBalance, model->getStake(), currentUnconfirmedBalance, currentImmatureBalance);\n  \n          // Update txdelegate->unit with the current unit\n          txdelegate->unit = model->getOptionsModel()->getDisplayUnit();\n  \n          ui->listTransactions->update();\n      }\n  }\n}"
  },
  {
    "function_name": "setModel",
    "container": "OverviewPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
    "lines": "151-177",
    "snippet": "void OverviewPage::setModel(WalletModel *model)\n{\n    this->model = model;\n    if(model && model->getOptionsModel())\n    {\n        // Set up transaction list\n        filter = new TransactionFilterProxy();\n        filter->setSourceModel(model->getTransactionTableModel());\n        filter->setLimit(NUM_ITEMS);\n        filter->setDynamicSortFilter(true);\n        filter->setSortRole(Qt::EditRole);\n        filter->setShowInactive(false);\n        filter->sort(TransactionTableModel::Status, Qt::DescendingOrder);\n\n        ui->listTransactions->setModel(filter);\n        ui->listTransactions->setModelColumn(TransactionTableModel::ToAddress);\n\n        // Keep up to date with wallet\n        setBalance(model->getBalance(), model->getStake(), model->getUnconfirmedBalance(), model->getImmatureBalance());\n        connect(model, SIGNAL(balanceChanged(qint64, qint64, qint64, qint64)), this, SLOT(setBalance(qint64, qint64, qint64, qint64)));\n\n        connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n    }\n\n    // update the display unit, to not use the default (\"BTC\")\n    updateDisplayUnit();\n}",
    "includes": [
      "#include \"overviewpage.moc\"",
      "#include <QPainter>",
      "#include <QAbstractItemDelegate>",
      "#include \"guiconstants.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"ui_overviewpage.h\"",
      "#include \"overviewpage.h\""
    ],
    "macros_used": [
      "#define NUM_ITEMS 6"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "updateDisplayUnit",
          "args": [],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "updateDisplayUnit",
          "container": "OverviewPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
          "lines": "179-191",
          "snippet": "void OverviewPage::updateDisplayUnit()\n{\n    if(model && model->getOptionsModel())\n    {\n        if(currentBalance != -1)\n            setBalance(currentBalance, model->getStake(), currentUnconfirmedBalance, currentImmatureBalance);\n\n        // Update txdelegate->unit with the current unit\n        txdelegate->unit = model->getOptionsModel()->getDisplayUnit();\n\n        ui->listTransactions->update();\n    }\n}",
          "includes": [
            "#include \"overviewpage.moc\"",
            "#include <QPainter>",
            "#include <QAbstractItemDelegate>",
            "#include \"guiconstants.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"ui_overviewpage.h\"",
            "#include \"overviewpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\nOverviewPage {\n  void OverviewPage::updateDisplayUnit()\n  {\n      if(model && model->getOptionsModel())\n      {\n          if(currentBalance != -1)\n              setBalance(currentBalance, model->getStake(), currentUnconfirmedBalance, currentImmatureBalance);\n  \n          // Update txdelegate->unit with the current unit\n          txdelegate->unit = model->getOptionsModel()->getDisplayUnit();\n  \n          ui->listTransactions->update();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "model->getOptionsModel()",
            "SIGNAL(displayUnitChanged(int))",
            "this",
            "SLOT(updateDisplayUnit())"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "updateDisplayUnit()"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "displayUnitChanged(int)"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "displayUnitChanged",
          "args": [
            "int"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "model",
            "SIGNAL(balanceChanged(qint64, qint64, qint64, qint64))",
            "this",
            "SLOT(setBalance(qint64, qint64, qint64, qint64))"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "setBalance(qint64, qint64, qint64, qint64)"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setBalance",
          "args": [
            "qint64",
            "qint64",
            "qint64",
            "qint64"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "setBalance",
          "container": "OverviewPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
          "lines": "131-149",
          "snippet": "void OverviewPage::setBalance(qint64 balance, qint64 stake, qint64 unconfirmedBalance, qint64 immatureBalance)\n{\n    int unit = model->getOptionsModel()->getDisplayUnit();\n    currentBalance = balance;\n    currentStake = stake;\n    currentUnconfirmedBalance = unconfirmedBalance;\n    currentImmatureBalance = immatureBalance;\n    ui->labelBalance->setText(BitcoinUnits::formatWithUnit(unit, balance));\n    ui->labelStake->setText(BitcoinUnits::formatWithUnit(unit, stake));\n    ui->labelUnconfirmed->setText(BitcoinUnits::formatWithUnit(unit, unconfirmedBalance));\n    ui->labelImmature->setText(BitcoinUnits::formatWithUnit(unit, immatureBalance));\n    ui->labelTotal->setText(BitcoinUnits::formatWithUnit(unit, balance + stake + unconfirmedBalance + immatureBalance));\n\n    // only show immature (newly mined) balance if it's non-zero, so as not to complicate things\n    // for the non-mining users\n    bool showImmature = immatureBalance != 0;\n    ui->labelImmature->setVisible(showImmature);\n    ui->labelImmatureText->setVisible(showImmature);\n}",
          "includes": [
            "#include \"overviewpage.moc\"",
            "#include <QPainter>",
            "#include <QAbstractItemDelegate>",
            "#include \"guiconstants.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"ui_overviewpage.h\"",
            "#include \"overviewpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\nOverviewPage {\n  void OverviewPage::setBalance(qint64 balance, qint64 stake, qint64 unconfirmedBalance, qint64 immatureBalance)\n  {\n      int unit = model->getOptionsModel()->getDisplayUnit();\n      currentBalance = balance;\n      currentStake = stake;\n      currentUnconfirmedBalance = unconfirmedBalance;\n      currentImmatureBalance = immatureBalance;\n      ui->labelBalance->setText(BitcoinUnits::formatWithUnit(unit, balance));\n      ui->labelStake->setText(BitcoinUnits::formatWithUnit(unit, stake));\n      ui->labelUnconfirmed->setText(BitcoinUnits::formatWithUnit(unit, unconfirmedBalance));\n      ui->labelImmature->setText(BitcoinUnits::formatWithUnit(unit, immatureBalance));\n      ui->labelTotal->setText(BitcoinUnits::formatWithUnit(unit, balance + stake + unconfirmedBalance + immatureBalance));\n  \n      // only show immature (newly mined) balance if it's non-zero, so as not to complicate things\n      // for the non-mining users\n      bool showImmature = immatureBalance != 0;\n      ui->labelImmature->setVisible(showImmature);\n      ui->labelImmatureText->setVisible(showImmature);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "balanceChanged(qint64, qint64, qint64, qint64)"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "balanceChanged",
          "args": [
            "qint64",
            "qint64",
            "qint64",
            "qint64"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getImmatureBalance",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "getImmatureBalance",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "54-57",
          "snippet": "qint64 WalletModel::getImmatureBalance() const\n{\n    return wallet->GetImmatureBalance();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  qint64 WalletModel::getImmatureBalance() const\n  {\n      return wallet->GetImmatureBalance();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getUnconfirmedBalance",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "getUnconfirmedBalance",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "44-47",
          "snippet": "qint64 WalletModel::getUnconfirmedBalance() const\n{\n    return wallet->GetUnconfirmedBalance();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  qint64 WalletModel::getUnconfirmedBalance() const\n  {\n      return wallet->GetUnconfirmedBalance();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getStake",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "getStake",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "49-52",
          "snippet": "qint64 WalletModel::getStake() const\n{\n    return wallet->GetStake();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  qint64 WalletModel::getStake() const\n  {\n      return wallet->GetStake();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getBalance",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "getBalance",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "39-42",
          "snippet": "qint64 WalletModel::getBalance() const\n{\n    return wallet->GetBalance();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  qint64 WalletModel::getBalance() const\n  {\n      return wallet->GetBalance();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->listTransactions->setModelColumn",
          "args": [
            "TransactionTableModel::ToAddress"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->listTransactions->setModel",
          "args": [
            "filter"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "OverviewPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
          "lines": "151-177",
          "snippet": "void OverviewPage::setModel(WalletModel *model)\n{\n    this->model = model;\n    if(model && model->getOptionsModel())\n    {\n        // Set up transaction list\n        filter = new TransactionFilterProxy();\n        filter->setSourceModel(model->getTransactionTableModel());\n        filter->setLimit(NUM_ITEMS);\n        filter->setDynamicSortFilter(true);\n        filter->setSortRole(Qt::EditRole);\n        filter->setShowInactive(false);\n        filter->sort(TransactionTableModel::Status, Qt::DescendingOrder);\n\n        ui->listTransactions->setModel(filter);\n        ui->listTransactions->setModelColumn(TransactionTableModel::ToAddress);\n\n        // Keep up to date with wallet\n        setBalance(model->getBalance(), model->getStake(), model->getUnconfirmedBalance(), model->getImmatureBalance());\n        connect(model, SIGNAL(balanceChanged(qint64, qint64, qint64, qint64)), this, SLOT(setBalance(qint64, qint64, qint64, qint64)));\n\n        connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n    }\n\n    // update the display unit, to not use the default (\"BTC\")\n    updateDisplayUnit();\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "filter->sort",
          "args": [
            "TransactionTableModel::Status",
            "Qt::DescendingOrder"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter->setShowInactive",
          "args": [
            "false"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "setShowInactive",
          "container": "TransactionFilterProxy",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionfilterproxy.cpp",
          "lines": "82-86",
          "snippet": "void TransactionFilterProxy::setShowInactive(bool showInactive)\n{\n    this->showInactive = showInactive;\n    invalidateFilter();\n}",
          "includes": [
            "#include <cstdlib>",
            "#include <QDateTime>",
            "#include \"transactionrecord.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"transactionfilterproxy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdlib>\n#include <QDateTime>\n#include \"transactionrecord.h\"\n#include \"transactiontablemodel.h\"\n#include \"transactionfilterproxy.h\"\n\nTransactionFilterProxy {\n  void TransactionFilterProxy::setShowInactive(bool showInactive)\n  {\n      this->showInactive = showInactive;\n      invalidateFilter();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter->setSortRole",
          "args": [
            "Qt::EditRole"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter->setDynamicSortFilter",
          "args": [
            "true"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter->setLimit",
          "args": [
            "NUM_ITEMS"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "setLimit",
          "container": "TransactionFilterProxy",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionfilterproxy.cpp",
          "lines": "77-80",
          "snippet": "void TransactionFilterProxy::setLimit(int limit)\n{\n    this->limitRows = limit;\n}",
          "includes": [
            "#include <cstdlib>",
            "#include <QDateTime>",
            "#include \"transactionrecord.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"transactionfilterproxy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdlib>\n#include <QDateTime>\n#include \"transactionrecord.h\"\n#include \"transactiontablemodel.h\"\n#include \"transactionfilterproxy.h\"\n\nTransactionFilterProxy {\n  void TransactionFilterProxy::setLimit(int limit)\n  {\n      this->limitRows = limit;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter->setSourceModel",
          "args": [
            "model->getTransactionTableModel()"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getTransactionTableModel",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\n#define NUM_ITEMS 6\n\nOverviewPage {\n  void OverviewPage::setModel(WalletModel *model)\n  {\n      this->model = model;\n      if(model && model->getOptionsModel())\n      {\n          // Set up transaction list\n          filter = new TransactionFilterProxy();\n          filter->setSourceModel(model->getTransactionTableModel());\n          filter->setLimit(NUM_ITEMS);\n          filter->setDynamicSortFilter(true);\n          filter->setSortRole(Qt::EditRole);\n          filter->setShowInactive(false);\n          filter->sort(TransactionTableModel::Status, Qt::DescendingOrder);\n  \n          ui->listTransactions->setModel(filter);\n          ui->listTransactions->setModelColumn(TransactionTableModel::ToAddress);\n  \n          // Keep up to date with wallet\n          setBalance(model->getBalance(), model->getStake(), model->getUnconfirmedBalance(), model->getImmatureBalance());\n          connect(model, SIGNAL(balanceChanged(qint64, qint64, qint64, qint64)), this, SLOT(setBalance(qint64, qint64, qint64, qint64)));\n  \n          connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n      }\n  \n      // update the display unit, to not use the default (\"BTC\")\n      updateDisplayUnit();\n  }\n}"
  },
  {
    "function_name": "setBalance",
    "container": "OverviewPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
    "lines": "131-149",
    "snippet": "void OverviewPage::setBalance(qint64 balance, qint64 stake, qint64 unconfirmedBalance, qint64 immatureBalance)\n{\n    int unit = model->getOptionsModel()->getDisplayUnit();\n    currentBalance = balance;\n    currentStake = stake;\n    currentUnconfirmedBalance = unconfirmedBalance;\n    currentImmatureBalance = immatureBalance;\n    ui->labelBalance->setText(BitcoinUnits::formatWithUnit(unit, balance));\n    ui->labelStake->setText(BitcoinUnits::formatWithUnit(unit, stake));\n    ui->labelUnconfirmed->setText(BitcoinUnits::formatWithUnit(unit, unconfirmedBalance));\n    ui->labelImmature->setText(BitcoinUnits::formatWithUnit(unit, immatureBalance));\n    ui->labelTotal->setText(BitcoinUnits::formatWithUnit(unit, balance + stake + unconfirmedBalance + immatureBalance));\n\n    // only show immature (newly mined) balance if it's non-zero, so as not to complicate things\n    // for the non-mining users\n    bool showImmature = immatureBalance != 0;\n    ui->labelImmature->setVisible(showImmature);\n    ui->labelImmatureText->setVisible(showImmature);\n}",
    "includes": [
      "#include \"overviewpage.moc\"",
      "#include <QPainter>",
      "#include <QAbstractItemDelegate>",
      "#include \"guiconstants.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"ui_overviewpage.h\"",
      "#include \"overviewpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->labelImmatureText->setVisible",
          "args": [
            "showImmature"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelImmature->setVisible",
          "args": [
            "showImmature"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelTotal->setText",
          "args": [
            "BitcoinUnits::formatWithUnit(unit, balance + stake + unconfirmedBalance + immatureBalance)"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "unit",
            "balance + stake + unconfirmedBalance + immatureBalance"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "unit",
            "immatureBalance"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "unit",
            "unconfirmedBalance"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "unit",
            "stake"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "unit",
            "balance"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\nOverviewPage {\n  void OverviewPage::setBalance(qint64 balance, qint64 stake, qint64 unconfirmedBalance, qint64 immatureBalance)\n  {\n      int unit = model->getOptionsModel()->getDisplayUnit();\n      currentBalance = balance;\n      currentStake = stake;\n      currentUnconfirmedBalance = unconfirmedBalance;\n      currentImmatureBalance = immatureBalance;\n      ui->labelBalance->setText(BitcoinUnits::formatWithUnit(unit, balance));\n      ui->labelStake->setText(BitcoinUnits::formatWithUnit(unit, stake));\n      ui->labelUnconfirmed->setText(BitcoinUnits::formatWithUnit(unit, unconfirmedBalance));\n      ui->labelImmature->setText(BitcoinUnits::formatWithUnit(unit, immatureBalance));\n      ui->labelTotal->setText(BitcoinUnits::formatWithUnit(unit, balance + stake + unconfirmedBalance + immatureBalance));\n  \n      // only show immature (newly mined) balance if it's non-zero, so as not to complicate things\n      // for the non-mining users\n      bool showImmature = immatureBalance != 0;\n      ui->labelImmature->setVisible(showImmature);\n      ui->labelImmatureText->setVisible(showImmature);\n  }\n}"
  },
  {
    "function_name": "~OverviewPage",
    "container": "OverviewPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
    "lines": "126-129",
    "snippet": "OverviewPage::~OverviewPage()\n{\n    delete ui;\n}",
    "includes": [
      "#include \"overviewpage.moc\"",
      "#include <QPainter>",
      "#include <QAbstractItemDelegate>",
      "#include \"guiconstants.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"ui_overviewpage.h\"",
      "#include \"overviewpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\nOverviewPage {\n  OverviewPage::~OverviewPage()\n  {\n      delete ui;\n  }\n}"
  },
  {
    "function_name": "handleTransactionClicked",
    "container": "OverviewPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
    "lines": "120-124",
    "snippet": "void OverviewPage::handleTransactionClicked(const QModelIndex &index)\n{\n    if(filter)\n        emit transactionClicked(filter->mapToSource(index));\n}",
    "includes": [
      "#include \"overviewpage.moc\"",
      "#include <QPainter>",
      "#include <QAbstractItemDelegate>",
      "#include \"guiconstants.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"ui_overviewpage.h\"",
      "#include \"overviewpage.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "transactionClicked",
          "args": [
            "filter->mapToSource(index)"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter->mapToSource",
          "args": [
            "index"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\nOverviewPage {\n  void OverviewPage::handleTransactionClicked(const QModelIndex &index)\n  {\n      if(filter)\n          emit transactionClicked(filter->mapToSource(index));\n  }\n}"
  },
  {
    "function_name": "OverviewPage",
    "container": "OverviewPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
    "lines": "92-118",
    "snippet": "OverviewPage::OverviewPage(QWidget *parent) :\n    QWidget(parent),\n    ui(new Ui::OverviewPage),\n    currentBalance(-1),\n    currentStake(0),\n    currentUnconfirmedBalance(-1),\n    currentImmatureBalance(-1),\n    txdelegate(new TxViewDelegate()),\n    filter(0)\n{\n    ui->setupUi(this);\n\n    // Recent transactions\n    ui->listTransactions->setItemDelegate(txdelegate);\n    ui->listTransactions->setIconSize(QSize(DECORATION_SIZE, DECORATION_SIZE));\n    ui->listTransactions->setMinimumHeight(NUM_ITEMS * (DECORATION_SIZE + 2));\n    ui->listTransactions->setAttribute(Qt::WA_MacShowFocusRect, false);\n\n    connect(ui->listTransactions, SIGNAL(clicked(QModelIndex)), this, SLOT(handleTransactionClicked(QModelIndex)));\n\n    // init \"out of sync\" warning labels\n    ui->labelWalletStatus->setText(\"(\" + tr(\"out of sync\") + \")\");\n    ui->labelTransactionsStatus->setText(\"(\" + tr(\"out of sync\") + \")\");\n\n    // start with displaying the \"out of sync\" warnings\n    showOutOfSyncWarning(true);\n}",
    "includes": [
      "#include \"overviewpage.moc\"",
      "#include <QPainter>",
      "#include <QAbstractItemDelegate>",
      "#include \"guiconstants.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"ui_overviewpage.h\"",
      "#include \"overviewpage.h\""
    ],
    "macros_used": [
      "#define NUM_ITEMS 6",
      "#define DECORATION_SIZE 64"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "showOutOfSyncWarning",
          "args": [
            "true"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "showOutOfSyncWarning",
          "container": "OverviewPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
          "lines": "193-197",
          "snippet": "void OverviewPage::showOutOfSyncWarning(bool fShow)\n{\n    ui->labelWalletStatus->setVisible(fShow);\n    ui->labelTransactionsStatus->setVisible(fShow);\n}",
          "includes": [
            "#include \"overviewpage.moc\"",
            "#include <QPainter>",
            "#include <QAbstractItemDelegate>",
            "#include \"guiconstants.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"ui_overviewpage.h\"",
            "#include \"overviewpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\nOverviewPage {\n  void OverviewPage::showOutOfSyncWarning(bool fShow)\n  {\n      ui->labelWalletStatus->setVisible(fShow);\n      ui->labelTransactionsStatus->setVisible(fShow);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->labelTransactionsStatus->setText",
          "args": [
            "\"(\" + tr(\"out of sync\") + \")\""
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"out of sync\""
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->listTransactions",
            "SIGNAL(clicked(QModelIndex))",
            "this",
            "SLOT(handleTransactionClicked(QModelIndex))"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "handleTransactionClicked(QModelIndex)"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "handleTransactionClicked",
          "args": [
            "QModelIndex"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "handleTransactionClicked",
          "container": "OverviewPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
          "lines": "120-124",
          "snippet": "void OverviewPage::handleTransactionClicked(const QModelIndex &index)\n{\n    if(filter)\n        emit transactionClicked(filter->mapToSource(index));\n}",
          "includes": [
            "#include \"overviewpage.moc\"",
            "#include <QPainter>",
            "#include <QAbstractItemDelegate>",
            "#include \"guiconstants.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactionfilterproxy.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"ui_overviewpage.h\"",
            "#include \"overviewpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\nOverviewPage {\n  void OverviewPage::handleTransactionClicked(const QModelIndex &index)\n  {\n      if(filter)\n          emit transactionClicked(filter->mapToSource(index));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "clicked(QModelIndex)"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clicked",
          "args": [
            "QModelIndex"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->listTransactions->setAttribute",
          "args": [
            "Qt::WA_MacShowFocusRect",
            "false"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->listTransactions->setMinimumHeight",
          "args": [
            "NUM_ITEMS * (DECORATION_SIZE + 2)"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->listTransactions->setIconSize",
          "args": [
            "QSize(DECORATION_SIZE, DECORATION_SIZE)"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QSize",
          "args": [
            "DECORATION_SIZE",
            "DECORATION_SIZE"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->listTransactions->setItemDelegate",
          "args": [
            "txdelegate"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->setupUi",
          "args": [
            "this"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\n#define NUM_ITEMS 6\n#define DECORATION_SIZE 64\n\nOverviewPage {\n  OverviewPage::OverviewPage(QWidget *parent) :\n      QWidget(parent),\n      ui(new Ui::OverviewPage),\n      currentBalance(-1),\n      currentStake(0),\n      currentUnconfirmedBalance(-1),\n      currentImmatureBalance(-1),\n      txdelegate(new TxViewDelegate()),\n      filter(0)\n  {\n      ui->setupUi(this);\n  \n      // Recent transactions\n      ui->listTransactions->setItemDelegate(txdelegate);\n      ui->listTransactions->setIconSize(QSize(DECORATION_SIZE, DECORATION_SIZE));\n      ui->listTransactions->setMinimumHeight(NUM_ITEMS * (DECORATION_SIZE + 2));\n      ui->listTransactions->setAttribute(Qt::WA_MacShowFocusRect, false);\n  \n      connect(ui->listTransactions, SIGNAL(clicked(QModelIndex)), this, SLOT(handleTransactionClicked(QModelIndex)));\n  \n      // init \"out of sync\" warning labels\n      ui->labelWalletStatus->setText(\"(\" + tr(\"out of sync\") + \")\");\n      ui->labelTransactionsStatus->setText(\"(\" + tr(\"out of sync\") + \")\");\n  \n      // start with displaying the \"out of sync\" warnings\n      showOutOfSyncWarning(true);\n  }\n}"
  },
  {
    "function_name": "sizeHint",
    "container": "TxViewDelegate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
    "lines": "82-85",
    "snippet": "inline QSize sizeHint(const QStyleOptionViewItem &option, const QModelIndex &index) const\n    {\n        return QSize(DECORATION_SIZE, DECORATION_SIZE);\n    }",
    "includes": [
      "#include \"overviewpage.moc\"",
      "#include <QPainter>",
      "#include <QAbstractItemDelegate>",
      "#include \"guiconstants.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"ui_overviewpage.h\"",
      "#include \"overviewpage.h\""
    ],
    "macros_used": [
      "#define DECORATION_SIZE 64"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QSize",
          "args": [
            "DECORATION_SIZE",
            "DECORATION_SIZE"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\n#define DECORATION_SIZE 64\n\nTxViewDelegate {\n  inline QSize sizeHint(const QStyleOptionViewItem &option, const QModelIndex &index) const\n      {\n          return QSize(DECORATION_SIZE, DECORATION_SIZE);\n      }\n}"
  },
  {
    "function_name": "paint",
    "container": "TxViewDelegate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/overviewpage.cpp",
    "lines": "27-80",
    "snippet": "inline void paint(QPainter *painter, const QStyleOptionViewItem &option,\n                      const QModelIndex &index ) const\n    {\n        painter->save();\n\n        QIcon icon = qvariant_cast<QIcon>(index.data(Qt::DecorationRole));\n        QRect mainRect = option.rect;\n        QRect decorationRect(mainRect.topLeft(), QSize(DECORATION_SIZE, DECORATION_SIZE));\n        int xspace = DECORATION_SIZE + 8;\n        int ypad = 6;\n        int halfheight = (mainRect.height() - 2*ypad)/2;\n        QRect amountRect(mainRect.left() + xspace, mainRect.top()+ypad, mainRect.width() - xspace, halfheight);\n        QRect addressRect(mainRect.left() + xspace, mainRect.top()+ypad+halfheight, mainRect.width() - xspace, halfheight);\n        icon.paint(painter, decorationRect);\n\n        QDateTime date = index.data(TransactionTableModel::DateRole).toDateTime();\n        QString address = index.data(Qt::DisplayRole).toString();\n        qint64 amount = index.data(TransactionTableModel::AmountRole).toLongLong();\n        bool confirmed = index.data(TransactionTableModel::ConfirmedRole).toBool();\n        QVariant value = index.data(Qt::ForegroundRole);\n        QColor foreground = option.palette.color(QPalette::Text);\n        if(qVariantCanConvert<QColor>(value))\n        {\n            foreground = qvariant_cast<QColor>(value);\n        }\n\n        painter->setPen(foreground);\n        painter->drawText(addressRect, Qt::AlignLeft|Qt::AlignVCenter, address);\n\n        if(amount < 0)\n        {\n            foreground = COLOR_NEGATIVE;\n        }\n        else if(!confirmed)\n        {\n            foreground = COLOR_UNCONFIRMED;\n        }\n        else\n        {\n            foreground = option.palette.color(QPalette::Text);\n        }\n        painter->setPen(foreground);\n        QString amountText = BitcoinUnits::formatWithUnit(unit, amount, true);\n        if(!confirmed)\n        {\n            amountText = QString(\"[\") + amountText + QString(\"]\");\n        }\n        painter->drawText(amountRect, Qt::AlignRight|Qt::AlignVCenter, amountText);\n\n        painter->setPen(option.palette.color(QPalette::Text));\n        painter->drawText(amountRect, Qt::AlignLeft|Qt::AlignVCenter, GUIUtil::dateTimeStr(date));\n\n        painter->restore();\n    }",
    "includes": [
      "#include \"overviewpage.moc\"",
      "#include <QPainter>",
      "#include <QAbstractItemDelegate>",
      "#include \"guiconstants.h\"",
      "#include \"guiutil.h\"",
      "#include \"transactionfilterproxy.h\"",
      "#include \"transactiontablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"ui_overviewpage.h\"",
      "#include \"overviewpage.h\""
    ],
    "macros_used": [
      "#define DECORATION_SIZE 64"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "painter->restore",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "painter->drawText",
          "args": [
            "amountRect",
            "Qt::AlignLeft|Qt::AlignVCenter",
            "GUIUtil::dateTimeStr(date)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::dateTimeStr",
          "args": [
            "date"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "dateTimeStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "50-53",
          "snippet": "QString dateTimeStr(qint64 nTime)\n{\n    return dateTimeStr(QDateTime::fromTime_t((qint32)nTime));\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQString dateTimeStr(qint64 nTime)\n{\n    return dateTimeStr(QDateTime::fromTime_t((qint32)nTime));\n}"
        }
      },
      {
        "call_info": {
          "callee": "painter->setPen",
          "args": [
            "option.palette.color(QPalette::Text)"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "option.palette.color",
          "args": [
            "QPalette::Text"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "painter->drawText",
          "args": [
            "amountRect",
            "Qt::AlignRight|Qt::AlignVCenter",
            "amountText"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"]\""
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"[\""
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "unit",
            "amount",
            "true"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "painter->setPen",
          "args": [
            "foreground"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "option.palette.color",
          "args": [
            "QPalette::Text"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "painter->drawText",
          "args": [
            "addressRect",
            "Qt::AlignLeft|Qt::AlignVCenter",
            "address"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "painter->setPen",
          "args": [
            "foreground"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qvariant_cast<QColor>",
          "args": [
            "value"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qVariantCanConvert<QColor>",
          "args": [
            "value"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "option.palette.color",
          "args": [
            "QPalette::Text"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [
            "Qt::ForegroundRole"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [
            "TransactionTableModel::ConfirmedRole"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [
            "TransactionTableModel::AmountRole"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [
            "Qt::DisplayRole"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [
            "TransactionTableModel::DateRole"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "icon.paint",
          "args": [
            "painter",
            "decorationRect"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mainRect.width",
          "args": [],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mainRect.top",
          "args": [],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mainRect.left",
          "args": [],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mainRect.width",
          "args": [],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mainRect.top",
          "args": [],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mainRect.left",
          "args": [],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mainRect.height",
          "args": [],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QSize",
          "args": [
            "DECORATION_SIZE",
            "DECORATION_SIZE"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mainRect.topLeft",
          "args": [],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qvariant_cast<QIcon>",
          "args": [
            "index.data(Qt::DecorationRole)"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.data",
          "args": [
            "Qt::DecorationRole"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "painter->save",
          "args": [],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"overviewpage.moc\"\n#include <QPainter>\n#include <QAbstractItemDelegate>\n#include \"guiconstants.h\"\n#include \"guiutil.h\"\n#include \"transactionfilterproxy.h\"\n#include \"transactiontablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"ui_overviewpage.h\"\n#include \"overviewpage.h\"\n\n#define DECORATION_SIZE 64\n\nTxViewDelegate {\n  inline void paint(QPainter *painter, const QStyleOptionViewItem &option,\n                        const QModelIndex &index ) const\n      {\n          painter->save();\n  \n          QIcon icon = qvariant_cast<QIcon>(index.data(Qt::DecorationRole));\n          QRect mainRect = option.rect;\n          QRect decorationRect(mainRect.topLeft(), QSize(DECORATION_SIZE, DECORATION_SIZE));\n          int xspace = DECORATION_SIZE + 8;\n          int ypad = 6;\n          int halfheight = (mainRect.height() - 2*ypad)/2;\n          QRect amountRect(mainRect.left() + xspace, mainRect.top()+ypad, mainRect.width() - xspace, halfheight);\n          QRect addressRect(mainRect.left() + xspace, mainRect.top()+ypad+halfheight, mainRect.width() - xspace, halfheight);\n          icon.paint(painter, decorationRect);\n  \n          QDateTime date = index.data(TransactionTableModel::DateRole).toDateTime();\n          QString address = index.data(Qt::DisplayRole).toString();\n          qint64 amount = index.data(TransactionTableModel::AmountRole).toLongLong();\n          bool confirmed = index.data(TransactionTableModel::ConfirmedRole).toBool();\n          QVariant value = index.data(Qt::ForegroundRole);\n          QColor foreground = option.palette.color(QPalette::Text);\n          if(qVariantCanConvert<QColor>(value))\n          {\n              foreground = qvariant_cast<QColor>(value);\n          }\n  \n          painter->setPen(foreground);\n          painter->drawText(addressRect, Qt::AlignLeft|Qt::AlignVCenter, address);\n  \n          if(amount < 0)\n          {\n              foreground = COLOR_NEGATIVE;\n          }\n          else if(!confirmed)\n          {\n              foreground = COLOR_UNCONFIRMED;\n          }\n          else\n          {\n              foreground = option.palette.color(QPalette::Text);\n          }\n          painter->setPen(foreground);\n          QString amountText = BitcoinUnits::formatWithUnit(unit, amount, true);\n          if(!confirmed)\n          {\n              amountText = QString(\"[\") + amountText + QString(\"]\");\n          }\n          painter->drawText(amountRect, Qt::AlignRight|Qt::AlignVCenter, amountText);\n  \n          painter->setPen(option.palette.color(QPalette::Text));\n          painter->drawText(amountRect, Qt::AlignLeft|Qt::AlignVCenter, GUIUtil::dateTimeStr(date));\n  \n          painter->restore();\n      }\n}"
  }
]