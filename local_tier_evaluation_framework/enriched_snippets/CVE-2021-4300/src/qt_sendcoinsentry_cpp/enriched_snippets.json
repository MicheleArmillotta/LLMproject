[
  {
    "function_name": "updateDisplayUnit",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "167-174",
    "snippet": "void SendCoinsEntry::updateDisplayUnit()\n{\n    if(model && model->getOptionsModel())\n    {\n        // Update payAmount with the current unit\n        ui->payAmount->setDisplayUnit(model->getOptionsModel()->getDisplayUnit());\n    }\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->payAmount->setDisplayUnit",
          "args": [
            "model->getOptionsModel()->getDisplayUnit()"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "setDisplayUnit",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "165-168",
          "snippet": "void BitcoinAmountField::setDisplayUnit(int newUnit)\n{\n    unit->setValue(newUnit);\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setDisplayUnit(int newUnit)\n  {\n      unit->setValue(newUnit);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::updateDisplayUnit()\n  {\n      if(model && model->getOptionsModel())\n      {\n          // Update payAmount with the current unit\n          ui->payAmount->setDisplayUnit(model->getOptionsModel()->getDisplayUnit());\n      }\n  }\n}"
  },
  {
    "function_name": "setFocus",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "162-165",
    "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->payTo->setFocus",
          "args": [],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "setFocus",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "162-165",
          "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setFocus()\n  {\n      ui->payTo->setFocus();\n  }\n}"
  },
  {
    "function_name": "isClear",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "157-160",
    "snippet": "bool SendCoinsEntry::isClear()\n{\n    return ui->payTo->text().isEmpty();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->payTo->text",
          "args": [],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  bool SendCoinsEntry::isClear()\n  {\n      return ui->payTo->text().isEmpty();\n  }\n}"
  },
  {
    "function_name": "setValue",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "150-155",
    "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->payAmount->setValue",
          "args": [
            "value.amount"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ui->addAsLabel->setText",
          "args": [
            "value.label"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
  },
  {
    "function_name": "getValue",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "129-138",
    "snippet": "SendCoinsRecipient SendCoinsEntry::getValue()\n{\n    SendCoinsRecipient rv;\n\n    rv.address = ui->payTo->text();\n    rv.label = ui->addAsLabel->text();\n    rv.amount = ui->payAmount->value();\n\n    return rv;\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->payAmount->value",
          "args": [],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QValueComboBox",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qvaluecombobox.cpp",
          "lines": "9-12",
          "snippet": "QVariant QValueComboBox::value() const\n{\n    return itemData(currentIndex(), role);\n}",
          "includes": [
            "#include \"qvaluecombobox.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qvaluecombobox.h\"\n\nQValueComboBox {\n  QVariant QValueComboBox::value() const\n  {\n      return itemData(currentIndex(), role);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->addAsLabel->text",
          "args": [],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  SendCoinsRecipient SendCoinsEntry::getValue()\n  {\n      SendCoinsRecipient rv;\n  \n      rv.address = ui->payTo->text();\n      rv.label = ui->addAsLabel->text();\n      rv.amount = ui->payAmount->value();\n  \n      return rv;\n  }\n}"
  },
  {
    "function_name": "validate",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "100-127",
    "snippet": "bool SendCoinsEntry::validate()\n{\n    // Check input validity\n    bool retval = true;\n\n    if(!ui->payAmount->validate())\n    {\n        retval = false;\n    }\n    else\n    {\n        if(ui->payAmount->value() <= 0)\n        {\n            // Cannot send 0 coins or less\n            ui->payAmount->setValid(false);\n            retval = false;\n        }\n    }\n\n    if(!ui->payTo->hasAcceptableInput() ||\n       (model && !model->validateAddress(ui->payTo->text())))\n    {\n        ui->payTo->setValid(false);\n        retval = false;\n    }\n\n    return retval;\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->payTo->setValid",
          "args": [
            "false"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "setValid",
          "container": "QValidatedLineEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qvalidatedlineedit.cpp",
          "lines": "11-27",
          "snippet": "void QValidatedLineEdit::setValid(bool valid)\n{\n    if(valid == this->valid)\n    {\n        return;\n    }\n\n    if(valid)\n    {\n        setStyleSheet(\"\");\n    }\n    else\n    {\n        setStyleSheet(STYLE_INVALID);\n    }\n    this->valid = valid;\n}",
          "includes": [
            "#include \"guiconstants.h\"",
            "#include \"qvalidatedlineedit.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"guiconstants.h\"\n#include \"qvalidatedlineedit.h\"\n\nQValidatedLineEdit {\n  void QValidatedLineEdit::setValid(bool valid)\n  {\n      if(valid == this->valid)\n      {\n          return;\n      }\n  \n      if(valid)\n      {\n          setStyleSheet(\"\");\n      }\n      else\n      {\n          setStyleSheet(STYLE_INVALID);\n      }\n      this->valid = valid;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->validateAddress",
          "args": [
            "ui->payTo->text()"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "validateAddress",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "126-130",
          "snippet": "bool WalletModel::validateAddress(const QString &address)\n{\n    CBitcoinAddress addressParsed(address.toStdString());\n    return addressParsed.IsValid();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  bool WalletModel::validateAddress(const QString &address)\n  {\n      CBitcoinAddress addressParsed(address.toStdString());\n      return addressParsed.IsValid();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->payTo->text",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->payTo->hasAcceptableInput",
          "args": [],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->payAmount->value",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QValueComboBox",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qvaluecombobox.cpp",
          "lines": "9-12",
          "snippet": "QVariant QValueComboBox::value() const\n{\n    return itemData(currentIndex(), role);\n}",
          "includes": [
            "#include \"qvaluecombobox.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qvaluecombobox.h\"\n\nQValueComboBox {\n  QVariant QValueComboBox::value() const\n  {\n      return itemData(currentIndex(), role);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->payAmount->validate",
          "args": [],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "validate",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "100-127",
          "snippet": "bool SendCoinsEntry::validate()\n{\n    // Check input validity\n    bool retval = true;\n\n    if(!ui->payAmount->validate())\n    {\n        retval = false;\n    }\n    else\n    {\n        if(ui->payAmount->value() <= 0)\n        {\n            // Cannot send 0 coins or less\n            ui->payAmount->setValid(false);\n            retval = false;\n        }\n    }\n\n    if(!ui->payTo->hasAcceptableInput() ||\n       (model && !model->validateAddress(ui->payTo->text())))\n    {\n        ui->payTo->setValid(false);\n        retval = false;\n    }\n\n    return retval;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  bool SendCoinsEntry::validate()\n  {\n      // Check input validity\n      bool retval = true;\n  \n      if(!ui->payAmount->validate())\n      {\n          retval = false;\n      }\n      else\n      {\n          if(ui->payAmount->value() <= 0)\n          {\n              // Cannot send 0 coins or less\n              ui->payAmount->setValid(false);\n              retval = false;\n          }\n      }\n  \n      if(!ui->payTo->hasAcceptableInput() ||\n         (model && !model->validateAddress(ui->payTo->text())))\n      {\n          ui->payTo->setValid(false);\n          retval = false;\n      }\n  \n      return retval;\n  }\n}"
  },
  {
    "function_name": "on_deleteButton_clicked",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "95-98",
    "snippet": "void SendCoinsEntry::on_deleteButton_clicked()\n{\n    emit removeEntry(this);\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::on_deleteButton_clicked()\n  {\n      emit removeEntry(this);\n  }\n}"
  },
  {
    "function_name": "clear",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "85-93",
    "snippet": "void SendCoinsEntry::clear()\n{\n    ui->payTo->clear();\n    ui->addAsLabel->clear();\n    ui->payAmount->clear();\n    ui->payTo->setFocus();\n    // update the display unit, to not use the default (\"BTC\")\n    updateDisplayUnit();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "updateDisplayUnit",
          "args": [],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "updateDisplayUnit",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "167-174",
          "snippet": "void SendCoinsEntry::updateDisplayUnit()\n{\n    if(model && model->getOptionsModel())\n    {\n        // Update payAmount with the current unit\n        ui->payAmount->setDisplayUnit(model->getOptionsModel()->getDisplayUnit());\n    }\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::updateDisplayUnit()\n  {\n      if(model && model->getOptionsModel())\n      {\n          // Update payAmount with the current unit\n          ui->payAmount->setDisplayUnit(model->getOptionsModel()->getDisplayUnit());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->payTo->setFocus",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "setFocus",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "162-165",
          "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setFocus()\n  {\n      ui->payTo->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->payAmount->clear",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "85-93",
          "snippet": "void SendCoinsEntry::clear()\n{\n    ui->payTo->clear();\n    ui->addAsLabel->clear();\n    ui->payAmount->clear();\n    ui->payTo->setFocus();\n    // update the display unit, to not use the default (\"BTC\")\n    updateDisplayUnit();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::clear()\n  {\n      ui->payTo->clear();\n      ui->addAsLabel->clear();\n      ui->payAmount->clear();\n      ui->payTo->setFocus();\n      // update the display unit, to not use the default (\"BTC\")\n      updateDisplayUnit();\n  }\n}"
  },
  {
    "function_name": "setRemoveEnabled",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "80-83",
    "snippet": "void SendCoinsEntry::setRemoveEnabled(bool enabled)\n{\n    ui->deleteButton->setEnabled(enabled);\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->deleteButton->setEnabled",
          "args": [
            "enabled"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setRemoveEnabled(bool enabled)\n  {\n      ui->deleteButton->setEnabled(enabled);\n  }\n}"
  },
  {
    "function_name": "setModel",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "68-78",
    "snippet": "void SendCoinsEntry::setModel(WalletModel *model)\n{\n    this->model = model;\n\n    if(model && model->getOptionsModel())\n        connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n\n    connect(ui->payAmount, SIGNAL(textChanged()), this, SIGNAL(payAmountChanged()));\n\n    clear();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear",
          "args": [],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "85-93",
          "snippet": "void SendCoinsEntry::clear()\n{\n    ui->payTo->clear();\n    ui->addAsLabel->clear();\n    ui->payAmount->clear();\n    ui->payTo->setFocus();\n    // update the display unit, to not use the default (\"BTC\")\n    updateDisplayUnit();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::clear()\n  {\n      ui->payTo->clear();\n      ui->addAsLabel->clear();\n      ui->payAmount->clear();\n      ui->payTo->setFocus();\n      // update the display unit, to not use the default (\"BTC\")\n      updateDisplayUnit();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->payAmount",
            "SIGNAL(textChanged())",
            "this",
            "SIGNAL(payAmountChanged())"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "payAmountChanged()"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "payAmountChanged",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "textChanged()"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "textChanged",
          "args": [],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "on_lnMessage_textChanged",
          "container": "QRCodeDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
          "lines": "143-146",
          "snippet": "void QRCodeDialog::on_lnMessage_textChanged()\n{\n    genCode();\n}",
          "includes": [
            "#include <qrencode.h>",
            "#include <QUrl>",
            "#include <QPixmap>",
            "#include \"optionsmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_qrcodedialog.h\"",
            "#include \"qrcodedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::on_lnMessage_textChanged()\n  {\n      genCode();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "model->getOptionsModel()",
            "SIGNAL(displayUnitChanged(int))",
            "this",
            "SLOT(updateDisplayUnit())"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "updateDisplayUnit()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "updateDisplayUnit",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "updateDisplayUnit",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "167-174",
          "snippet": "void SendCoinsEntry::updateDisplayUnit()\n{\n    if(model && model->getOptionsModel())\n    {\n        // Update payAmount with the current unit\n        ui->payAmount->setDisplayUnit(model->getOptionsModel()->getDisplayUnit());\n    }\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::updateDisplayUnit()\n  {\n      if(model && model->getOptionsModel())\n      {\n          // Update payAmount with the current unit\n          ui->payAmount->setDisplayUnit(model->getOptionsModel()->getDisplayUnit());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "displayUnitChanged(int)"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "displayUnitChanged",
          "args": [
            "int"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setModel(WalletModel *model)\n  {\n      this->model = model;\n  \n      if(model && model->getOptionsModel())\n          connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n  \n      connect(ui->payAmount, SIGNAL(textChanged()), this, SIGNAL(payAmountChanged()));\n  \n      clear();\n  }\n}"
  },
  {
    "function_name": "on_payTo_textChanged",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "58-66",
    "snippet": "void SendCoinsEntry::on_payTo_textChanged(const QString &address)\n{\n    if(!model)\n        return;\n    // Fill in label from address book, if address has an associated label\n    QString associatedLabel = model->getAddressTableModel()->labelForAddress(address);\n    if(!associatedLabel.isEmpty())\n        ui->addAsLabel->setText(associatedLabel);\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->addAsLabel->setText",
          "args": [
            "associatedLabel"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "associatedLabel.isEmpty",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [
            "address"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::on_payTo_textChanged(const QString &address)\n  {\n      if(!model)\n          return;\n      // Fill in label from address book, if address has an associated label\n      QString associatedLabel = model->getAddressTableModel()->labelForAddress(address);\n      if(!associatedLabel.isEmpty())\n          ui->addAsLabel->setText(associatedLabel);\n  }\n}"
  },
  {
    "function_name": "on_addressBookButton_clicked",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "45-56",
    "snippet": "void SendCoinsEntry::on_addressBookButton_clicked()\n{\n    if(!model)\n        return;\n    AddressBookPage dlg(AddressBookPage::ForSending, AddressBookPage::SendingTab, this);\n    dlg.setModel(model->getAddressTableModel());\n    if(dlg.exec())\n    {\n        ui->payTo->setText(dlg.getReturnValue());\n        ui->payAmount->setFocus();\n    }\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->payAmount->setFocus",
          "args": [],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "setFocus",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "162-165",
          "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setFocus()\n  {\n      ui->payTo->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->payTo->setText",
          "args": [
            "dlg.getReturnValue()"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlg.getReturnValue",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlg.exec",
          "args": [],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlg.setModel",
          "args": [
            "model->getAddressTableModel()"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "68-78",
          "snippet": "void SendCoinsEntry::setModel(WalletModel *model)\n{\n    this->model = model;\n\n    if(model && model->getOptionsModel())\n        connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n\n    connect(ui->payAmount, SIGNAL(textChanged()), this, SIGNAL(payAmountChanged()));\n\n    clear();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setModel(WalletModel *model)\n  {\n      this->model = model;\n  \n      if(model && model->getOptionsModel())\n          connect(model->getOptionsModel(), SIGNAL(displayUnitChanged(int)), this, SLOT(updateDisplayUnit()));\n  \n      connect(ui->payAmount, SIGNAL(textChanged()), this, SIGNAL(payAmountChanged()));\n  \n      clear();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::on_addressBookButton_clicked()\n  {\n      if(!model)\n          return;\n      AddressBookPage dlg(AddressBookPage::ForSending, AddressBookPage::SendingTab, this);\n      dlg.setModel(model->getAddressTableModel());\n      if(dlg.exec())\n      {\n          ui->payTo->setText(dlg.getReturnValue());\n          ui->payAmount->setFocus();\n      }\n  }\n}"
  },
  {
    "function_name": "on_pasteButton_clicked",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "39-43",
    "snippet": "void SendCoinsEntry::on_pasteButton_clicked()\n{\n    // Paste text from clipboard into recipient field\n    ui->payTo->setText(QApplication::clipboard()->text());\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->payTo->setText",
          "args": [
            "QApplication::clipboard()->text()"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::on_pasteButton_clicked()\n  {\n      // Paste text from clipboard into recipient field\n      ui->payTo->setText(QApplication::clipboard()->text());\n  }\n}"
  },
  {
    "function_name": "~SendCoinsEntry",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "34-37",
    "snippet": "SendCoinsEntry::~SendCoinsEntry()\n{\n    delete ui;\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  SendCoinsEntry::~SendCoinsEntry()\n  {\n      delete ui;\n  }\n}"
  },
  {
    "function_name": "SendCoinsEntry",
    "container": "SendCoinsEntry",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
    "lines": "13-32",
    "snippet": "SendCoinsEntry::SendCoinsEntry(QWidget *parent) :\n    QFrame(parent),\n    ui(new Ui::SendCoinsEntry),\n    model(0)\n{\n    ui->setupUi(this);\n\n#ifdef Q_OS_MAC\n    ui->payToLayout->setSpacing(4);\n#endif\n#if QT_VERSION >= 0x040700\n    /* Do not move this to the XML file, Qt before 4.7 will choke on it */\n    ui->addAsLabel->setPlaceholderText(tr(\"Enter a label for this address to add it to your address book\"));\n    ui->payTo->setPlaceholderText(tr(\"Enter a Halcyon address (e.g. halcyonfwYhBmGXcFP2Po1NpRUEiK8km2)\"));\n#endif\n    setFocusPolicy(Qt::TabFocus);\n    setFocusProxy(ui->payTo);\n\n    GUIUtil::setupAddressWidget(ui->payTo, this);\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include \"addresstablemodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"guiutil.h\"",
      "#include \"ui_sendcoinsentry.h\"",
      "#include \"sendcoinsentry.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GUIUtil::setupAddressWidget",
          "args": [
            "ui->payTo",
            "this"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "setupAddressWidget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "62-67",
          "snippet": "void setupAddressWidget(QLineEdit *widget, QWidget *parent)\n{\n    widget->setMaxLength(BitcoinAddressValidator::MaxAddressLength);\n    widget->setValidator(new BitcoinAddressValidator(parent));\n    widget->setFont(bitcoinAddressFont());\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid setupAddressWidget(QLineEdit *widget, QWidget *parent)\n{\n    widget->setMaxLength(BitcoinAddressValidator::MaxAddressLength);\n    widget->setValidator(new BitcoinAddressValidator(parent));\n    widget->setFont(bitcoinAddressFont());\n}"
        }
      },
      {
        "call_info": {
          "callee": "setFocusProxy",
          "args": [
            "ui->payTo"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setFocusPolicy",
          "args": [
            "Qt::TabFocus"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->payTo->setPlaceholderText",
          "args": [
            "tr(\"Enter a Halcyon address (e.g. halcyonfwYhBmGXcFP2Po1NpRUEiK8km2)\")"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Enter a Halcyon address (e.g. halcyonfwYhBmGXcFP2Po1NpRUEiK8km2)\""
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->addAsLabel->setPlaceholderText",
          "args": [
            "tr(\"Enter a label for this address to add it to your address book\")"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->payToLayout->setSpacing",
          "args": [
            "4"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->setupUi",
          "args": [
            "this"
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  SendCoinsEntry::SendCoinsEntry(QWidget *parent) :\n      QFrame(parent),\n      ui(new Ui::SendCoinsEntry),\n      model(0)\n  {\n      ui->setupUi(this);\n  \n  #ifdef Q_OS_MAC\n      ui->payToLayout->setSpacing(4);\n  #endif\n  #if QT_VERSION >= 0x040700\n      /* Do not move this to the XML file, Qt before 4.7 will choke on it */\n      ui->addAsLabel->setPlaceholderText(tr(\"Enter a label for this address to add it to your address book\"));\n      ui->payTo->setPlaceholderText(tr(\"Enter a Halcyon address (e.g. halcyonfwYhBmGXcFP2Po1NpRUEiK8km2)\"));\n  #endif\n      setFocusPolicy(Qt::TabFocus);\n      setFocusProxy(ui->payTo);\n  \n      GUIUtil::setupAddressWidget(ui->payTo, this);\n  }\n}"
  }
]