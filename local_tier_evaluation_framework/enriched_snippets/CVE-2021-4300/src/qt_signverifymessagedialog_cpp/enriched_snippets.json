[
  {
    "function_name": "eventFilter",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "251-274",
    "snippet": "bool SignVerifyMessageDialog::eventFilter(QObject *object, QEvent *event)\n{\n    if (event->type() == QEvent::MouseButtonPress || event->type() == QEvent::FocusIn)\n    {\n        if (ui->tabWidget->currentIndex() == 0)\n        {\n            /* Clear status message on focus change */\n            ui->statusLabel_SM->clear();\n\n            /* Select generated signature */\n            if (object == ui->signatureOut_SM)\n            {\n                ui->signatureOut_SM->selectAll();\n                return true;\n            }\n        }\n        else if (ui->tabWidget->currentIndex() == 1)\n        {\n            /* Clear status message on focus change */\n            ui->statusLabel_VM->clear();\n        }\n    }\n    return QDialog::eventFilter(object, event);\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QDialog::eventFilter",
          "args": [
            "object",
            "event"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "eventFilter",
          "container": "SignVerifyMessageDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
          "lines": "251-274",
          "snippet": "bool SignVerifyMessageDialog::eventFilter(QObject *object, QEvent *event)\n{\n    if (event->type() == QEvent::MouseButtonPress || event->type() == QEvent::FocusIn)\n    {\n        if (ui->tabWidget->currentIndex() == 0)\n        {\n            /* Clear status message on focus change */\n            ui->statusLabel_SM->clear();\n\n            /* Select generated signature */\n            if (object == ui->signatureOut_SM)\n            {\n                ui->signatureOut_SM->selectAll();\n                return true;\n            }\n        }\n        else if (ui->tabWidget->currentIndex() == 1)\n        {\n            /* Clear status message on focus change */\n            ui->statusLabel_VM->clear();\n        }\n    }\n    return QDialog::eventFilter(object, event);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_VM->clear",
          "args": [],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->tabWidget->currentIndex",
          "args": [],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->signatureOut_SM->selectAll",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tabWidget->currentIndex",
          "args": [],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "event->type",
          "args": [],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  bool SignVerifyMessageDialog::eventFilter(QObject *object, QEvent *event)\n  {\n      if (event->type() == QEvent::MouseButtonPress || event->type() == QEvent::FocusIn)\n      {\n          if (ui->tabWidget->currentIndex() == 0)\n          {\n              /* Clear status message on focus change */\n              ui->statusLabel_SM->clear();\n  \n              /* Select generated signature */\n              if (object == ui->signatureOut_SM)\n              {\n                  ui->signatureOut_SM->selectAll();\n                  return true;\n              }\n          }\n          else if (ui->tabWidget->currentIndex() == 1)\n          {\n              /* Clear status message on focus change */\n              ui->statusLabel_VM->clear();\n          }\n      }\n      return QDialog::eventFilter(object, event);\n  }\n}"
  },
  {
    "function_name": "on_clearButton_VM_clicked",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "241-249",
    "snippet": "void SignVerifyMessageDialog::on_clearButton_VM_clicked()\n{\n    ui->addressIn_VM->clear();\n    ui->signatureIn_VM->clear();\n    ui->messageIn_VM->clear();\n    ui->statusLabel_VM->clear();\n\n    ui->addressIn_VM->setFocus();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->addressIn_VM->setFocus",
          "args": [],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "setFocus",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "162-165",
          "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setFocus()\n  {\n      ui->payTo->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_VM->clear",
          "args": [],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::on_clearButton_VM_clicked()\n  {\n      ui->addressIn_VM->clear();\n      ui->signatureIn_VM->clear();\n      ui->messageIn_VM->clear();\n      ui->statusLabel_VM->clear();\n  \n      ui->addressIn_VM->setFocus();\n  }\n}"
  },
  {
    "function_name": "on_verifyMessageButton_VM_clicked",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "187-239",
    "snippet": "void SignVerifyMessageDialog::on_verifyMessageButton_VM_clicked()\n{\n    CBitcoinAddress addr(ui->addressIn_VM->text().toStdString());\n    if (!addr.IsValid())\n    {\n        ui->addressIn_VM->setValid(false);\n        ui->statusLabel_VM->setStyleSheet(\"QLabel { color: red; }\");\n        ui->statusLabel_VM->setText(tr(\"The entered address is invalid.\") + QString(\" \") + tr(\"Please check the address and try again.\"));\n        return;\n    }\n    CKeyID keyID;\n    if (!addr.GetKeyID(keyID))\n    {\n        ui->addressIn_VM->setValid(false);\n        ui->statusLabel_VM->setStyleSheet(\"QLabel { color: red; }\");\n        ui->statusLabel_VM->setText(tr(\"The entered address does not refer to a key.\") + QString(\" \") + tr(\"Please check the address and try again.\"));\n        return;\n    }\n\n    bool fInvalid = false;\n    std::vector<unsigned char> vchSig = DecodeBase64(ui->signatureIn_VM->text().toStdString().c_str(), &fInvalid);\n\n    if (fInvalid)\n    {\n        ui->signatureIn_VM->setValid(false);\n        ui->statusLabel_VM->setStyleSheet(\"QLabel { color: red; }\");\n        ui->statusLabel_VM->setText(tr(\"The signature could not be decoded.\") + QString(\" \") + tr(\"Please check the signature and try again.\"));\n        return;\n    }\n\n    CDataStream ss(SER_GETHASH, 0);\n    ss << strMessageMagic;\n    ss << ui->messageIn_VM->document()->toPlainText().toStdString();\n\n    CKey key;\n    if (!key.SetCompactSignature(Hash(ss.begin(), ss.end()), vchSig))\n    {\n        ui->signatureIn_VM->setValid(false);\n        ui->statusLabel_VM->setStyleSheet(\"QLabel { color: red; }\");\n        ui->statusLabel_VM->setText(tr(\"The signature did not match the message digest.\") + QString(\" \") + tr(\"Please check the signature and try again.\"));\n        return;\n    }\n\n    if (!(CBitcoinAddress(key.GetPubKey().GetID()) == addr))\n    {\n        ui->statusLabel_VM->setStyleSheet(\"QLabel { color: red; }\");\n        ui->statusLabel_VM->setText(QString(\"<nobr>\") + tr(\"Message verification failed.\") + QString(\"</nobr>\"));\n        return;\n    }\n\n    ui->statusLabel_VM->setStyleSheet(\"QLabel { color: green; }\");\n    ui->statusLabel_VM->setText(QString(\"<nobr>\") + tr(\"Message verified.\") + QString(\"</nobr>\"));\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->statusLabel_VM->setText",
          "args": [
            "QString(\"<nobr>\") + tr(\"Message verified.\") + QString(\"</nobr>\")"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"</nobr>\""
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Message verified.\""
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"<nobr>\""
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_VM->setStyleSheet",
          "args": [
            "\"QLabel { color: green; }\""
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"</nobr>\""
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"<nobr>\""
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_VM->setStyleSheet",
          "args": [
            "\"QLabel { color: red; }\""
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [
            "key.GetPubKey().GetID()"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "operator()",
          "container": "CBitcoinAddressVisitor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "399-399",
          "snippet": "bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddressVisitor {\n  bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "key.GetPubKey",
          "args": [],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "GetPubKey",
          "container": "CKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.cpp",
          "lines": "274-284",
          "snippet": "CPubKey CKey::GetPubKey() const\n{\n    int nSize = i2o_ECPublicKey(pkey, NULL);\n    if (!nSize)\n        throw key_error(\"CKey::GetPubKey() : i2o_ECPublicKey failed\");\n    std::vector<unsigned char> vchPubKey(nSize, 0);\n    unsigned char* pbegin = &vchPubKey[0];\n    if (i2o_ECPublicKey(pkey, &pbegin) != nSize)\n        throw key_error(\"CKey::GetPubKey() : i2o_ECPublicKey returned unexpected size\");\n    return CPubKey(vchPubKey);\n}",
          "includes": [
            "#include \"key.h\"",
            "#include <openssl/obj_mac.h>",
            "#include <openssl/ecdsa.h>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"key.h\"\n#include <openssl/obj_mac.h>\n#include <openssl/ecdsa.h>\n#include <map>\n\nCKey {\n  CPubKey CKey::GetPubKey() const\n  {\n      int nSize = i2o_ECPublicKey(pkey, NULL);\n      if (!nSize)\n          throw key_error(\"CKey::GetPubKey() : i2o_ECPublicKey failed\");\n      std::vector<unsigned char> vchPubKey(nSize, 0);\n      unsigned char* pbegin = &vchPubKey[0];\n      if (i2o_ECPublicKey(pkey, &pbegin) != nSize)\n          throw key_error(\"CKey::GetPubKey() : i2o_ECPublicKey returned unexpected size\");\n      return CPubKey(vchPubKey);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" \""
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_VM->setStyleSheet",
          "args": [
            "\"QLabel { color: red; }\""
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->signatureIn_VM->setValid",
          "args": [
            "false"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "setValid",
          "container": "QValidatedLineEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qvalidatedlineedit.cpp",
          "lines": "11-27",
          "snippet": "void QValidatedLineEdit::setValid(bool valid)\n{\n    if(valid == this->valid)\n    {\n        return;\n    }\n\n    if(valid)\n    {\n        setStyleSheet(\"\");\n    }\n    else\n    {\n        setStyleSheet(STYLE_INVALID);\n    }\n    this->valid = valid;\n}",
          "includes": [
            "#include \"guiconstants.h\"",
            "#include \"qvalidatedlineedit.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"guiconstants.h\"\n#include \"qvalidatedlineedit.h\"\n\nQValidatedLineEdit {\n  void QValidatedLineEdit::setValid(bool valid)\n  {\n      if(valid == this->valid)\n      {\n          return;\n      }\n  \n      if(valid)\n      {\n          setStyleSheet(\"\");\n      }\n      else\n      {\n          setStyleSheet(STYLE_INVALID);\n      }\n      this->valid = valid;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "key.SetCompactSignature",
          "args": [
            "Hash(ss.begin(), ss.end())",
            "vchSig"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "SetCompactSignature",
          "container": "CKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.cpp",
          "lines": "364-390",
          "snippet": "bool CKey::SetCompactSignature(uint256 hash, const std::vector<unsigned char>& vchSig)\n{\n    if (vchSig.size() != 65)\n        return false;\n    int nV = vchSig[0];\n    if (nV<27 || nV>=35)\n        return false;\n    ECDSA_SIG *sig = ECDSA_SIG_new();\n    BN_bin2bn(&vchSig[1],32,sig->r);\n    BN_bin2bn(&vchSig[33],32,sig->s);\n\n    EC_KEY_free(pkey);\n    pkey = EC_KEY_new_by_curve_name(NID_secp256k1);\n    if (nV >= 31)\n    {\n        SetCompressedPubKey();\n        nV -= 4;\n    }\n    if (ECDSA_SIG_recover_key_GFp(pkey, sig, (unsigned char*)&hash, sizeof(hash), nV - 27, 0) == 1)\n    {\n        fSet = true;\n        ECDSA_SIG_free(sig);\n        return true;\n    }\n    ECDSA_SIG_free(sig);\n    return false;\n}",
          "includes": [
            "#include \"key.h\"",
            "#include <openssl/obj_mac.h>",
            "#include <openssl/ecdsa.h>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"key.h\"\n#include <openssl/obj_mac.h>\n#include <openssl/ecdsa.h>\n#include <map>\n\nCKey {\n  bool CKey::SetCompactSignature(uint256 hash, const std::vector<unsigned char>& vchSig)\n  {\n      if (vchSig.size() != 65)\n          return false;\n      int nV = vchSig[0];\n      if (nV<27 || nV>=35)\n          return false;\n      ECDSA_SIG *sig = ECDSA_SIG_new();\n      BN_bin2bn(&vchSig[1],32,sig->r);\n      BN_bin2bn(&vchSig[33],32,sig->s);\n  \n      EC_KEY_free(pkey);\n      pkey = EC_KEY_new_by_curve_name(NID_secp256k1);\n      if (nV >= 31)\n      {\n          SetCompressedPubKey();\n          nV -= 4;\n      }\n      if (ECDSA_SIG_recover_key_GFp(pkey, sig, (unsigned char*)&hash, sizeof(hash), nV - 27, 0) == 1)\n      {\n          fSet = true;\n          ECDSA_SIG_free(sig);\n          return true;\n      }\n      ECDSA_SIG_free(sig);\n      return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Hash",
          "args": [
            "ss.begin()",
            "ss.end()"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "Hash",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "34-38",
          "snippet": "inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n{\n    // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n    return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n  {\n      // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n      return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ss.end",
          "args": [],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ss.begin",
          "args": [],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->messageIn_VM->document",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->messageIn_VM->document",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->messageIn_VM->document",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" \""
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_VM->setStyleSheet",
          "args": [
            "\"QLabel { color: red; }\""
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DecodeBase64",
          "args": [
            "ui->signatureIn_VM->text().toStdString().c_str()",
            "&fInvalid"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeBase64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "648-729",
          "snippet": "vector<unsigned char> DecodeBase64(const char* p, bool* pfInvalid)\n{\n    static const int decode64_table[256] =\n    {\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, 62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1,\n        -1, -1, -1, -1, -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14,\n        15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28,\n        29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,\n        49, 50, 51, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1\n    };\n\n    if (pfInvalid)\n        *pfInvalid = false;\n\n    vector<unsigned char> vchRet;\n    vchRet.reserve(strlen(p)*3/4);\n\n    int mode = 0;\n    int left = 0;\n\n    while (1)\n    {\n         int dec = decode64_table[(unsigned char)*p];\n         if (dec == -1) break;\n         p++;\n         switch (mode)\n         {\n             case 0: // we have no bits and get 6\n                 left = dec;\n                 mode = 1;\n                 break;\n\n              case 1: // we have 6 bits and keep 4\n                  vchRet.push_back((left<<2) | (dec>>4));\n                  left = dec & 15;\n                  mode = 2;\n                  break;\n\n             case 2: // we have 4 bits and get 6, we keep 2\n                 vchRet.push_back((left<<4) | (dec>>2));\n                 left = dec & 3;\n                 mode = 3;\n                 break;\n\n             case 3: // we have 2 bits and get 6\n                 vchRet.push_back((left<<6) | dec);\n                 mode = 0;\n                 break;\n         }\n    }\n\n    if (pfInvalid)\n        switch (mode)\n        {\n            case 0: // 4n base64 characters processed: ok\n                break;\n\n            case 1: // 4n+1 base64 character processed: impossible\n                *pfInvalid = true;\n                break;\n\n            case 2: // 4n+2 base64 characters processed: require '=='\n                if (left || p[0] != '=' || p[1] != '=' || decode64_table[(unsigned char)p[2]] != -1)\n                    *pfInvalid = true;\n                break;\n\n            case 3: // 4n+3 base64 characters processed: require '='\n                if (left || p[0] != '=' || decode64_table[(unsigned char)p[1]] != -1)\n                    *pfInvalid = true;\n                break;\n        }\n\n    return vchRet;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nvector<unsigned char> DecodeBase64(const char* p, bool* pfInvalid)\n{\n    static const int decode64_table[256] =\n    {\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, 62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1,\n        -1, -1, -1, -1, -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14,\n        15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28,\n        29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,\n        49, 50, 51, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1\n    };\n\n    if (pfInvalid)\n        *pfInvalid = false;\n\n    vector<unsigned char> vchRet;\n    vchRet.reserve(strlen(p)*3/4);\n\n    int mode = 0;\n    int left = 0;\n\n    while (1)\n    {\n         int dec = decode64_table[(unsigned char)*p];\n         if (dec == -1) break;\n         p++;\n         switch (mode)\n         {\n             case 0: // we have no bits and get 6\n                 left = dec;\n                 mode = 1;\n                 break;\n\n              case 1: // we have 6 bits and keep 4\n                  vchRet.push_back((left<<2) | (dec>>4));\n                  left = dec & 15;\n                  mode = 2;\n                  break;\n\n             case 2: // we have 4 bits and get 6, we keep 2\n                 vchRet.push_back((left<<4) | (dec>>2));\n                 left = dec & 3;\n                 mode = 3;\n                 break;\n\n             case 3: // we have 2 bits and get 6\n                 vchRet.push_back((left<<6) | dec);\n                 mode = 0;\n                 break;\n         }\n    }\n\n    if (pfInvalid)\n        switch (mode)\n        {\n            case 0: // 4n base64 characters processed: ok\n                break;\n\n            case 1: // 4n+1 base64 character processed: impossible\n                *pfInvalid = true;\n                break;\n\n            case 2: // 4n+2 base64 characters processed: require '=='\n                if (left || p[0] != '=' || p[1] != '=' || decode64_table[(unsigned char)p[2]] != -1)\n                    *pfInvalid = true;\n                break;\n\n            case 3: // 4n+3 base64 characters processed: require '='\n                if (left || p[0] != '=' || decode64_table[(unsigned char)p[1]] != -1)\n                    *pfInvalid = true;\n                break;\n        }\n\n    return vchRet;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->signatureIn_VM->text",
          "args": [],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" \""
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_VM->setStyleSheet",
          "args": [
            "\"QLabel { color: red; }\""
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addr.GetKeyID",
          "args": [
            "keyID"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "GetKeyID",
          "container": "CBitcoinAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "369-382",
          "snippet": "bool GetKeyID(CKeyID &keyID) const {\n        if (!IsValid())\n            return false;\n        switch (nVersion) {\n        case PUBKEY_ADDRESS:\n        case PUBKEY_ADDRESS_TEST: {\n            uint160 id;\n            memcpy(&id, &vchData[0], 20);\n            keyID = CKeyID(id);\n            return true;\n        }\n        default: return false;\n        }\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool GetKeyID(CKeyID &keyID) const {\n          if (!IsValid())\n              return false;\n          switch (nVersion) {\n          case PUBKEY_ADDRESS:\n          case PUBKEY_ADDRESS_TEST: {\n              uint160 id;\n              memcpy(&id, &vchData[0], 20);\n              keyID = CKeyID(id);\n              return true;\n          }\n          default: return false;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" \""
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_VM->setStyleSheet",
          "args": [
            "\"QLabel { color: red; }\""
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addr.IsValid",
          "args": [],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "IsValid",
          "container": "CNetAddr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "725-759",
          "snippet": "bool CNetAddr::IsValid() const\n{\n    // Cleanup 3-byte shifted addresses caused by garbage in size field\n    // of addr messages from versions before 0.2.9 checksum.\n    // Two consecutive addr messages look like this:\n    // header20 vectorlen3 addr26 addr26 addr26 header20 vectorlen3 addr26 addr26 addr26...\n    // so if the first length field is garbled, it reads the second batch\n    // of addr misaligned by 3 bytes.\n    if (memcmp(ip, pchIPv4+3, sizeof(pchIPv4)-3) == 0)\n        return false;\n\n    // unspecified IPv6 address (::/128)\n    unsigned char ipNone[16] = {};\n    if (memcmp(ip, ipNone, 16) == 0)\n        return false;\n\n    // documentation IPv6 address\n    if (IsRFC3849())\n        return false;\n\n    if (IsIPv4())\n    {\n        // INADDR_NONE\n        uint32_t ipNone = INADDR_NONE;\n        if (memcmp(ip+12, &ipNone, 4) == 0)\n            return false;\n\n        // 0\n        ipNone = 0;\n        if (memcmp(ip+12, &ipNone, 4) == 0)\n            return false;\n    }\n\n    return true;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const unsigned char pchIPv4[12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nstatic const unsigned char pchIPv4[12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff };\n\nCNetAddr {\n  bool CNetAddr::IsValid() const\n  {\n      // Cleanup 3-byte shifted addresses caused by garbage in size field\n      // of addr messages from versions before 0.2.9 checksum.\n      // Two consecutive addr messages look like this:\n      // header20 vectorlen3 addr26 addr26 addr26 header20 vectorlen3 addr26 addr26 addr26...\n      // so if the first length field is garbled, it reads the second batch\n      // of addr misaligned by 3 bytes.\n      if (memcmp(ip, pchIPv4+3, sizeof(pchIPv4)-3) == 0)\n          return false;\n  \n      // unspecified IPv6 address (::/128)\n      unsigned char ipNone[16] = {};\n      if (memcmp(ip, ipNone, 16) == 0)\n          return false;\n  \n      // documentation IPv6 address\n      if (IsRFC3849())\n          return false;\n  \n      if (IsIPv4())\n      {\n          // INADDR_NONE\n          uint32_t ipNone = INADDR_NONE;\n          if (memcmp(ip+12, &ipNone, 4) == 0)\n              return false;\n  \n          // 0\n          ipNone = 0;\n          if (memcmp(ip+12, &ipNone, 4) == 0)\n              return false;\n      }\n  \n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::on_verifyMessageButton_VM_clicked()\n  {\n      CBitcoinAddress addr(ui->addressIn_VM->text().toStdString());\n      if (!addr.IsValid())\n      {\n          ui->addressIn_VM->setValid(false);\n          ui->statusLabel_VM->setStyleSheet(\"QLabel { color: red; }\");\n          ui->statusLabel_VM->setText(tr(\"The entered address is invalid.\") + QString(\" \") + tr(\"Please check the address and try again.\"));\n          return;\n      }\n      CKeyID keyID;\n      if (!addr.GetKeyID(keyID))\n      {\n          ui->addressIn_VM->setValid(false);\n          ui->statusLabel_VM->setStyleSheet(\"QLabel { color: red; }\");\n          ui->statusLabel_VM->setText(tr(\"The entered address does not refer to a key.\") + QString(\" \") + tr(\"Please check the address and try again.\"));\n          return;\n      }\n  \n      bool fInvalid = false;\n      std::vector<unsigned char> vchSig = DecodeBase64(ui->signatureIn_VM->text().toStdString().c_str(), &fInvalid);\n  \n      if (fInvalid)\n      {\n          ui->signatureIn_VM->setValid(false);\n          ui->statusLabel_VM->setStyleSheet(\"QLabel { color: red; }\");\n          ui->statusLabel_VM->setText(tr(\"The signature could not be decoded.\") + QString(\" \") + tr(\"Please check the signature and try again.\"));\n          return;\n      }\n  \n      CDataStream ss(SER_GETHASH, 0);\n      ss << strMessageMagic;\n      ss << ui->messageIn_VM->document()->toPlainText().toStdString();\n  \n      CKey key;\n      if (!key.SetCompactSignature(Hash(ss.begin(), ss.end()), vchSig))\n      {\n          ui->signatureIn_VM->setValid(false);\n          ui->statusLabel_VM->setStyleSheet(\"QLabel { color: red; }\");\n          ui->statusLabel_VM->setText(tr(\"The signature did not match the message digest.\") + QString(\" \") + tr(\"Please check the signature and try again.\"));\n          return;\n      }\n  \n      if (!(CBitcoinAddress(key.GetPubKey().GetID()) == addr))\n      {\n          ui->statusLabel_VM->setStyleSheet(\"QLabel { color: red; }\");\n          ui->statusLabel_VM->setText(QString(\"<nobr>\") + tr(\"Message verification failed.\") + QString(\"</nobr>\"));\n          return;\n      }\n  \n      ui->statusLabel_VM->setStyleSheet(\"QLabel { color: green; }\");\n      ui->statusLabel_VM->setText(QString(\"<nobr>\") + tr(\"Message verified.\") + QString(\"</nobr>\"));\n  }\n}"
  },
  {
    "function_name": "on_addressBookButton_VM_clicked",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "174-185",
    "snippet": "void SignVerifyMessageDialog::on_addressBookButton_VM_clicked()\n{\n    if (model && model->getAddressTableModel())\n    {\n        AddressBookPage dlg(AddressBookPage::ForSending, AddressBookPage::SendingTab, this);\n        dlg.setModel(model->getAddressTableModel());\n        if (dlg.exec())\n        {\n            setAddress_VM(dlg.getReturnValue());\n        }\n    }\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setAddress_VM",
          "args": [
            "dlg.getReturnValue()"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "setAddress_VM",
          "container": "SignVerifyMessageDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
          "lines": "64-68",
          "snippet": "void SignVerifyMessageDialog::setAddress_VM(QString address)\n{\n    ui->addressIn_VM->setText(address);\n    ui->messageIn_VM->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <vector>",
            "#include <string>",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"main.h\"",
            "#include \"init.h\"",
            "#include \"guiutil.h\"",
            "#include \"base58.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"ui_signverifymessagedialog.h\"",
            "#include \"signverifymessagedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::setAddress_VM(QString address)\n  {\n      ui->addressIn_VM->setText(address);\n      ui->messageIn_VM->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlg.getReturnValue",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlg.exec",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlg.setModel",
          "args": [
            "model->getAddressTableModel()"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "SignVerifyMessageDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
          "lines": "53-56",
          "snippet": "void SignVerifyMessageDialog::setModel(WalletModel *model)\n{\n    this->model = model;\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <vector>",
            "#include <string>",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"main.h\"",
            "#include \"init.h\"",
            "#include \"guiutil.h\"",
            "#include \"base58.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"ui_signverifymessagedialog.h\"",
            "#include \"signverifymessagedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::setModel(WalletModel *model)\n  {\n      this->model = model;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::on_addressBookButton_VM_clicked()\n  {\n      if (model && model->getAddressTableModel())\n      {\n          AddressBookPage dlg(AddressBookPage::ForSending, AddressBookPage::SendingTab, this);\n          dlg.setModel(model->getAddressTableModel());\n          if (dlg.exec())\n          {\n              setAddress_VM(dlg.getReturnValue());\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "on_clearButton_SM_clicked",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "164-172",
    "snippet": "void SignVerifyMessageDialog::on_clearButton_SM_clicked()\n{\n    ui->addressIn_SM->clear();\n    ui->messageIn_SM->clear();\n    ui->signatureOut_SM->clear();\n    ui->statusLabel_SM->clear();\n\n    ui->addressIn_SM->setFocus();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->addressIn_SM->setFocus",
          "args": [],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "setFocus",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "162-165",
          "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setFocus()\n  {\n      ui->payTo->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_SM->clear",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::on_clearButton_SM_clicked()\n  {\n      ui->addressIn_SM->clear();\n      ui->messageIn_SM->clear();\n      ui->signatureOut_SM->clear();\n      ui->statusLabel_SM->clear();\n  \n      ui->addressIn_SM->setFocus();\n  }\n}"
  },
  {
    "function_name": "on_copySignatureButton_SM_clicked",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "159-162",
    "snippet": "void SignVerifyMessageDialog::on_copySignatureButton_SM_clicked()\n{\n    QApplication::clipboard()->setText(ui->signatureOut_SM->text());\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->signatureOut_SM->text()"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->signatureOut_SM->text",
          "args": [],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::on_copySignatureButton_SM_clicked()\n  {\n      QApplication::clipboard()->setText(ui->signatureOut_SM->text());\n  }\n}"
  },
  {
    "function_name": "on_signMessageButton_SM_clicked",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "103-157",
    "snippet": "void SignVerifyMessageDialog::on_signMessageButton_SM_clicked()\n{\n    /* Clear old signature to ensure users don't get confused on error with an old signature displayed */\n    ui->signatureOut_SM->clear();\n\n    CBitcoinAddress addr(ui->addressIn_SM->text().toStdString());\n    if (!addr.IsValid())\n    {\n        ui->addressIn_SM->setValid(false);\n        ui->statusLabel_SM->setStyleSheet(\"QLabel { color: red; }\");\n        ui->statusLabel_SM->setText(tr(\"The entered address is invalid.\") + QString(\" \") + tr(\"Please check the address and try again.\"));\n        return;\n    }\n    CKeyID keyID;\n    if (!addr.GetKeyID(keyID))\n    {\n        ui->addressIn_SM->setValid(false);\n        ui->statusLabel_SM->setStyleSheet(\"QLabel { color: red; }\");\n        ui->statusLabel_SM->setText(tr(\"The entered address does not refer to a key.\") + QString(\" \") + tr(\"Please check the address and try again.\"));\n        return;\n    }\n\n    WalletModel::UnlockContext ctx(model->requestUnlock());\n    if (!ctx.isValid())\n    {\n        ui->statusLabel_SM->setStyleSheet(\"QLabel { color: red; }\");\n        ui->statusLabel_SM->setText(tr(\"Wallet unlock was cancelled.\"));\n        return;\n    }\n\n    CKey key;\n    if (!pwalletMain->GetKey(keyID, key))\n    {\n        ui->statusLabel_SM->setStyleSheet(\"QLabel { color: red; }\");\n        ui->statusLabel_SM->setText(tr(\"Private key for the entered address is not available.\"));\n        return;\n    }\n\n    CDataStream ss(SER_GETHASH, 0);\n    ss << strMessageMagic;\n    ss << ui->messageIn_SM->document()->toPlainText().toStdString();\n\n    std::vector<unsigned char> vchSig;\n    if (!key.SignCompact(Hash(ss.begin(), ss.end()), vchSig))\n    {\n        ui->statusLabel_SM->setStyleSheet(\"QLabel { color: red; }\");\n        ui->statusLabel_SM->setText(QString(\"<nobr>\") + tr(\"Message signing failed.\") + QString(\"</nobr>\"));\n        return;\n    }\n\n    ui->statusLabel_SM->setStyleSheet(\"QLabel { color: green; }\");\n    ui->statusLabel_SM->setText(QString(\"<nobr>\") + tr(\"Message signed.\") + QString(\"</nobr>\"));\n\n    ui->signatureOut_SM->setText(QString::fromStdString(EncodeBase64(&vchSig[0], vchSig.size())));\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->signatureOut_SM->setText",
          "args": [
            "QString::fromStdString(EncodeBase64(&vchSig[0], vchSig.size()))"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "EncodeBase64(&vchSig[0], vchSig.size())"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EncodeBase64",
          "args": [
            "&vchSig[0]",
            "vchSig.size()"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeBase64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "597-641",
          "snippet": "string EncodeBase64(const unsigned char* pch, size_t len)\n{\n    static const char *pbase64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\n    string strRet=\"\";\n    strRet.reserve((len+2)/3*4);\n\n    int mode=0, left=0;\n    const unsigned char *pchEnd = pch+len;\n\n    while (pch<pchEnd)\n    {\n        int enc = *(pch++);\n        switch (mode)\n        {\n            case 0: // we have no bits\n                strRet += pbase64[enc >> 2];\n                left = (enc & 3) << 4;\n                mode = 1;\n                break;\n\n            case 1: // we have two bits\n                strRet += pbase64[left | (enc >> 4)];\n                left = (enc & 15) << 2;\n                mode = 2;\n                break;\n\n            case 2: // we have four bits\n                strRet += pbase64[left | (enc >> 6)];\n                strRet += pbase64[enc & 63];\n                mode = 0;\n                break;\n        }\n    }\n\n    if (mode)\n    {\n        strRet += pbase64[left];\n        strRet += '=';\n        if (mode == 1)\n            strRet += '=';\n    }\n\n    return strRet;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring EncodeBase64(const unsigned char* pch, size_t len)\n{\n    static const char *pbase64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\n    string strRet=\"\";\n    strRet.reserve((len+2)/3*4);\n\n    int mode=0, left=0;\n    const unsigned char *pchEnd = pch+len;\n\n    while (pch<pchEnd)\n    {\n        int enc = *(pch++);\n        switch (mode)\n        {\n            case 0: // we have no bits\n                strRet += pbase64[enc >> 2];\n                left = (enc & 3) << 4;\n                mode = 1;\n                break;\n\n            case 1: // we have two bits\n                strRet += pbase64[left | (enc >> 4)];\n                left = (enc & 15) << 2;\n                mode = 2;\n                break;\n\n            case 2: // we have four bits\n                strRet += pbase64[left | (enc >> 6)];\n                strRet += pbase64[enc & 63];\n                mode = 0;\n                break;\n        }\n    }\n\n    if (mode)\n    {\n        strRet += pbase64[left];\n        strRet += '=';\n        if (mode == 1)\n            strRet += '=';\n    }\n\n    return strRet;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchSig.size",
          "args": [],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"</nobr>\""
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Message signed.\""
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"<nobr>\""
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_SM->setStyleSheet",
          "args": [
            "\"QLabel { color: green; }\""
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"</nobr>\""
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"<nobr>\""
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_SM->setStyleSheet",
          "args": [
            "\"QLabel { color: red; }\""
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.SignCompact",
          "args": [
            "Hash(ss.begin(), ss.end())",
            "vchSig"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "SignCompact",
          "container": "CKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.cpp",
          "lines": "318-358",
          "snippet": "bool CKey::SignCompact(uint256 hash, std::vector<unsigned char>& vchSig)\n{\n    bool fOk = false;\n    ECDSA_SIG *sig = ECDSA_do_sign((unsigned char*)&hash, sizeof(hash), pkey);\n    if (sig==NULL)\n        return false;\n    vchSig.clear();\n    vchSig.resize(65,0);\n    int nBitsR = BN_num_bits(sig->r);\n    int nBitsS = BN_num_bits(sig->s);\n    if (nBitsR <= 256 && nBitsS <= 256)\n    {\n        int nRecId = -1;\n        for (int i=0; i<4; i++)\n        {\n            CKey keyRec;\n            keyRec.fSet = true;\n            if (fCompressedPubKey)\n                keyRec.SetCompressedPubKey();\n            if (ECDSA_SIG_recover_key_GFp(keyRec.pkey, sig, (unsigned char*)&hash, sizeof(hash), i, 1) == 1)\n                if (keyRec.GetPubKey() == this->GetPubKey())\n                {\n                    nRecId = i;\n                    break;\n                }\n        }\n\n        if (nRecId == -1)\n        {\n            ECDSA_SIG_free(sig);\n            throw key_error(\"CKey::SignCompact() : unable to construct recoverable key\");\n        }\n\n        vchSig[0] = nRecId+27+(fCompressedPubKey ? 4 : 0);\n        BN_bn2bin(sig->r,&vchSig[33-(nBitsR+7)/8]);\n        BN_bn2bin(sig->s,&vchSig[65-(nBitsS+7)/8]);\n        fOk = true;\n    }\n    ECDSA_SIG_free(sig);\n    return fOk;\n}",
          "includes": [
            "#include \"key.h\"",
            "#include <openssl/obj_mac.h>",
            "#include <openssl/ecdsa.h>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"key.h\"\n#include <openssl/obj_mac.h>\n#include <openssl/ecdsa.h>\n#include <map>\n\nCKey {\n  bool CKey::SignCompact(uint256 hash, std::vector<unsigned char>& vchSig)\n  {\n      bool fOk = false;\n      ECDSA_SIG *sig = ECDSA_do_sign((unsigned char*)&hash, sizeof(hash), pkey);\n      if (sig==NULL)\n          return false;\n      vchSig.clear();\n      vchSig.resize(65,0);\n      int nBitsR = BN_num_bits(sig->r);\n      int nBitsS = BN_num_bits(sig->s);\n      if (nBitsR <= 256 && nBitsS <= 256)\n      {\n          int nRecId = -1;\n          for (int i=0; i<4; i++)\n          {\n              CKey keyRec;\n              keyRec.fSet = true;\n              if (fCompressedPubKey)\n                  keyRec.SetCompressedPubKey();\n              if (ECDSA_SIG_recover_key_GFp(keyRec.pkey, sig, (unsigned char*)&hash, sizeof(hash), i, 1) == 1)\n                  if (keyRec.GetPubKey() == this->GetPubKey())\n                  {\n                      nRecId = i;\n                      break;\n                  }\n          }\n  \n          if (nRecId == -1)\n          {\n              ECDSA_SIG_free(sig);\n              throw key_error(\"CKey::SignCompact() : unable to construct recoverable key\");\n          }\n  \n          vchSig[0] = nRecId+27+(fCompressedPubKey ? 4 : 0);\n          BN_bn2bin(sig->r,&vchSig[33-(nBitsR+7)/8]);\n          BN_bn2bin(sig->s,&vchSig[65-(nBitsS+7)/8]);\n          fOk = true;\n      }\n      ECDSA_SIG_free(sig);\n      return fOk;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Hash",
          "args": [
            "ss.begin()",
            "ss.end()"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "Hash",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "34-38",
          "snippet": "inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n{\n    // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n    return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n  {\n      // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n      return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ss.end",
          "args": [],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ss.begin",
          "args": [],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->messageIn_SM->document",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->messageIn_SM->document",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->messageIn_SM->document",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_SM->setStyleSheet",
          "args": [
            "\"QLabel { color: red; }\""
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pwalletMain->GetKey",
          "args": [
            "keyID",
            "key"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "GetKey",
          "container": "CBasicKeyStore",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/keystore.h",
          "lines": "81-94",
          "snippet": "bool GetKey(const CKeyID &address, CKey &keyOut) const\n    {\n        {\n            LOCK(cs_KeyStore);\n            KeyMap::const_iterator mi = mapKeys.find(address);\n            if (mi != mapKeys.end())\n            {\n                keyOut.Reset();\n                keyOut.SetSecret((*mi).second.first, (*mi).second.second);\n                return true;\n            }\n        }\n        return false;\n    }",
          "includes": [
            "#include <boost/signals2/signal.hpp>",
            "#include \"sync.h\"",
            "#include \"crypter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/signals2/signal.hpp>\n#include \"sync.h\"\n#include \"crypter.h\"\n\nCBasicKeyStore {\n  bool GetKey(const CKeyID &address, CKey &keyOut) const\n      {\n          {\n              LOCK(cs_KeyStore);\n              KeyMap::const_iterator mi = mapKeys.find(address);\n              if (mi != mapKeys.end())\n              {\n                  keyOut.Reset();\n                  keyOut.SetSecret((*mi).second.first, (*mi).second.second);\n                  return true;\n              }\n          }\n          return false;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_SM->setStyleSheet",
          "args": [
            "\"QLabel { color: red; }\""
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ctx.isValid",
          "args": [],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "WalletModel::UnlockContext",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.h",
          "lines": "106-106",
          "snippet": "bool isValid() const { return valid; }",
          "includes": [
            "#include \"allocators.h\" /* for SecureString */",
            "#include <map>",
            "#include <vector>",
            "#include <QObject>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"allocators.h\" /* for SecureString */\n#include <map>\n#include <vector>\n#include <QObject>\n\nWalletModel {\n  UnlockContext {\n    bool isValid() const { return valid; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->requestUnlock",
          "args": [],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "requestUnlock",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "364-383",
          "snippet": "WalletModel::UnlockContext WalletModel::requestUnlock()\n{\n    bool was_locked = getEncryptionStatus() == Locked;\n    \n    if ((!was_locked) && fWalletUnlockStakingOnly)\n    {\n       setWalletLocked(true);\n       was_locked = getEncryptionStatus() == Locked;\n\n    }\n    if(was_locked)\n    {\n        // Request UI to unlock wallet\n        emit requireUnlock();\n    }\n    // If wallet is still locked, unlock was failed or cancelled, mark context as invalid\n    bool valid = getEncryptionStatus() != Locked;\n\n    return UnlockContext(this, valid, was_locked && !fWalletUnlockStakingOnly);\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  WalletModel::UnlockContext WalletModel::requestUnlock()\n  {\n      bool was_locked = getEncryptionStatus() == Locked;\n      \n      if ((!was_locked) && fWalletUnlockStakingOnly)\n      {\n         setWalletLocked(true);\n         was_locked = getEncryptionStatus() == Locked;\n  \n      }\n      if(was_locked)\n      {\n          // Request UI to unlock wallet\n          emit requireUnlock();\n      }\n      // If wallet is still locked, unlock was failed or cancelled, mark context as invalid\n      bool valid = getEncryptionStatus() != Locked;\n  \n      return UnlockContext(this, valid, was_locked && !fWalletUnlockStakingOnly);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" \""
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_SM->setStyleSheet",
          "args": [
            "\"QLabel { color: red; }\""
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->addressIn_SM->setValid",
          "args": [
            "false"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "setValid",
          "container": "QValidatedLineEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qvalidatedlineedit.cpp",
          "lines": "11-27",
          "snippet": "void QValidatedLineEdit::setValid(bool valid)\n{\n    if(valid == this->valid)\n    {\n        return;\n    }\n\n    if(valid)\n    {\n        setStyleSheet(\"\");\n    }\n    else\n    {\n        setStyleSheet(STYLE_INVALID);\n    }\n    this->valid = valid;\n}",
          "includes": [
            "#include \"guiconstants.h\"",
            "#include \"qvalidatedlineedit.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"guiconstants.h\"\n#include \"qvalidatedlineedit.h\"\n\nQValidatedLineEdit {\n  void QValidatedLineEdit::setValid(bool valid)\n  {\n      if(valid == this->valid)\n      {\n          return;\n      }\n  \n      if(valid)\n      {\n          setStyleSheet(\"\");\n      }\n      else\n      {\n          setStyleSheet(STYLE_INVALID);\n      }\n      this->valid = valid;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "addr.GetKeyID",
          "args": [
            "keyID"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "GetKeyID",
          "container": "CBitcoinAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "369-382",
          "snippet": "bool GetKeyID(CKeyID &keyID) const {\n        if (!IsValid())\n            return false;\n        switch (nVersion) {\n        case PUBKEY_ADDRESS:\n        case PUBKEY_ADDRESS_TEST: {\n            uint160 id;\n            memcpy(&id, &vchData[0], 20);\n            keyID = CKeyID(id);\n            return true;\n        }\n        default: return false;\n        }\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool GetKeyID(CKeyID &keyID) const {\n          if (!IsValid())\n              return false;\n          switch (nVersion) {\n          case PUBKEY_ADDRESS:\n          case PUBKEY_ADDRESS_TEST: {\n              uint160 id;\n              memcpy(&id, &vchData[0], 20);\n              keyID = CKeyID(id);\n              return true;\n          }\n          default: return false;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" \""
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->statusLabel_SM->setStyleSheet",
          "args": [
            "\"QLabel { color: red; }\""
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addr.IsValid",
          "args": [],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "IsValid",
          "container": "CNetAddr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "725-759",
          "snippet": "bool CNetAddr::IsValid() const\n{\n    // Cleanup 3-byte shifted addresses caused by garbage in size field\n    // of addr messages from versions before 0.2.9 checksum.\n    // Two consecutive addr messages look like this:\n    // header20 vectorlen3 addr26 addr26 addr26 header20 vectorlen3 addr26 addr26 addr26...\n    // so if the first length field is garbled, it reads the second batch\n    // of addr misaligned by 3 bytes.\n    if (memcmp(ip, pchIPv4+3, sizeof(pchIPv4)-3) == 0)\n        return false;\n\n    // unspecified IPv6 address (::/128)\n    unsigned char ipNone[16] = {};\n    if (memcmp(ip, ipNone, 16) == 0)\n        return false;\n\n    // documentation IPv6 address\n    if (IsRFC3849())\n        return false;\n\n    if (IsIPv4())\n    {\n        // INADDR_NONE\n        uint32_t ipNone = INADDR_NONE;\n        if (memcmp(ip+12, &ipNone, 4) == 0)\n            return false;\n\n        // 0\n        ipNone = 0;\n        if (memcmp(ip+12, &ipNone, 4) == 0)\n            return false;\n    }\n\n    return true;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const unsigned char pchIPv4[12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nstatic const unsigned char pchIPv4[12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff };\n\nCNetAddr {\n  bool CNetAddr::IsValid() const\n  {\n      // Cleanup 3-byte shifted addresses caused by garbage in size field\n      // of addr messages from versions before 0.2.9 checksum.\n      // Two consecutive addr messages look like this:\n      // header20 vectorlen3 addr26 addr26 addr26 header20 vectorlen3 addr26 addr26 addr26...\n      // so if the first length field is garbled, it reads the second batch\n      // of addr misaligned by 3 bytes.\n      if (memcmp(ip, pchIPv4+3, sizeof(pchIPv4)-3) == 0)\n          return false;\n  \n      // unspecified IPv6 address (::/128)\n      unsigned char ipNone[16] = {};\n      if (memcmp(ip, ipNone, 16) == 0)\n          return false;\n  \n      // documentation IPv6 address\n      if (IsRFC3849())\n          return false;\n  \n      if (IsIPv4())\n      {\n          // INADDR_NONE\n          uint32_t ipNone = INADDR_NONE;\n          if (memcmp(ip+12, &ipNone, 4) == 0)\n              return false;\n  \n          // 0\n          ipNone = 0;\n          if (memcmp(ip+12, &ipNone, 4) == 0)\n              return false;\n      }\n  \n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->addressIn_SM->text",
          "args": [],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->signatureOut_SM->clear",
          "args": [],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::on_signMessageButton_SM_clicked()\n  {\n      /* Clear old signature to ensure users don't get confused on error with an old signature displayed */\n      ui->signatureOut_SM->clear();\n  \n      CBitcoinAddress addr(ui->addressIn_SM->text().toStdString());\n      if (!addr.IsValid())\n      {\n          ui->addressIn_SM->setValid(false);\n          ui->statusLabel_SM->setStyleSheet(\"QLabel { color: red; }\");\n          ui->statusLabel_SM->setText(tr(\"The entered address is invalid.\") + QString(\" \") + tr(\"Please check the address and try again.\"));\n          return;\n      }\n      CKeyID keyID;\n      if (!addr.GetKeyID(keyID))\n      {\n          ui->addressIn_SM->setValid(false);\n          ui->statusLabel_SM->setStyleSheet(\"QLabel { color: red; }\");\n          ui->statusLabel_SM->setText(tr(\"The entered address does not refer to a key.\") + QString(\" \") + tr(\"Please check the address and try again.\"));\n          return;\n      }\n  \n      WalletModel::UnlockContext ctx(model->requestUnlock());\n      if (!ctx.isValid())\n      {\n          ui->statusLabel_SM->setStyleSheet(\"QLabel { color: red; }\");\n          ui->statusLabel_SM->setText(tr(\"Wallet unlock was cancelled.\"));\n          return;\n      }\n  \n      CKey key;\n      if (!pwalletMain->GetKey(keyID, key))\n      {\n          ui->statusLabel_SM->setStyleSheet(\"QLabel { color: red; }\");\n          ui->statusLabel_SM->setText(tr(\"Private key for the entered address is not available.\"));\n          return;\n      }\n  \n      CDataStream ss(SER_GETHASH, 0);\n      ss << strMessageMagic;\n      ss << ui->messageIn_SM->document()->toPlainText().toStdString();\n  \n      std::vector<unsigned char> vchSig;\n      if (!key.SignCompact(Hash(ss.begin(), ss.end()), vchSig))\n      {\n          ui->statusLabel_SM->setStyleSheet(\"QLabel { color: red; }\");\n          ui->statusLabel_SM->setText(QString(\"<nobr>\") + tr(\"Message signing failed.\") + QString(\"</nobr>\"));\n          return;\n      }\n  \n      ui->statusLabel_SM->setStyleSheet(\"QLabel { color: green; }\");\n      ui->statusLabel_SM->setText(QString(\"<nobr>\") + tr(\"Message signed.\") + QString(\"</nobr>\"));\n  \n      ui->signatureOut_SM->setText(QString::fromStdString(EncodeBase64(&vchSig[0], vchSig.size())));\n  }\n}"
  },
  {
    "function_name": "on_pasteButton_SM_clicked",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "98-101",
    "snippet": "void SignVerifyMessageDialog::on_pasteButton_SM_clicked()\n{\n    setAddress_SM(QApplication::clipboard()->text());\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setAddress_SM",
          "args": [
            "QApplication::clipboard()->text()"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "setAddress_SM",
          "container": "SignVerifyMessageDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
          "lines": "58-62",
          "snippet": "void SignVerifyMessageDialog::setAddress_SM(QString address)\n{\n    ui->addressIn_SM->setText(address);\n    ui->messageIn_SM->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <vector>",
            "#include <string>",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"main.h\"",
            "#include \"init.h\"",
            "#include \"guiutil.h\"",
            "#include \"base58.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"ui_signverifymessagedialog.h\"",
            "#include \"signverifymessagedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::setAddress_SM(QString address)\n  {\n      ui->addressIn_SM->setText(address);\n      ui->messageIn_SM->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::on_pasteButton_SM_clicked()\n  {\n      setAddress_SM(QApplication::clipboard()->text());\n  }\n}"
  },
  {
    "function_name": "on_addressBookButton_SM_clicked",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "85-96",
    "snippet": "void SignVerifyMessageDialog::on_addressBookButton_SM_clicked()\n{\n    if (model && model->getAddressTableModel())\n    {\n        AddressBookPage dlg(AddressBookPage::ForSending, AddressBookPage::ReceivingTab, this);\n        dlg.setModel(model->getAddressTableModel());\n        if (dlg.exec())\n        {\n            setAddress_SM(dlg.getReturnValue());\n        }\n    }\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setAddress_SM",
          "args": [
            "dlg.getReturnValue()"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "setAddress_SM",
          "container": "SignVerifyMessageDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
          "lines": "58-62",
          "snippet": "void SignVerifyMessageDialog::setAddress_SM(QString address)\n{\n    ui->addressIn_SM->setText(address);\n    ui->messageIn_SM->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <vector>",
            "#include <string>",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"main.h\"",
            "#include \"init.h\"",
            "#include \"guiutil.h\"",
            "#include \"base58.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"ui_signverifymessagedialog.h\"",
            "#include \"signverifymessagedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::setAddress_SM(QString address)\n  {\n      ui->addressIn_SM->setText(address);\n      ui->messageIn_SM->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlg.getReturnValue",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlg.exec",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlg.setModel",
          "args": [
            "model->getAddressTableModel()"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "SignVerifyMessageDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
          "lines": "53-56",
          "snippet": "void SignVerifyMessageDialog::setModel(WalletModel *model)\n{\n    this->model = model;\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <vector>",
            "#include <string>",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"main.h\"",
            "#include \"init.h\"",
            "#include \"guiutil.h\"",
            "#include \"base58.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"ui_signverifymessagedialog.h\"",
            "#include \"signverifymessagedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::setModel(WalletModel *model)\n  {\n      this->model = model;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::on_addressBookButton_SM_clicked()\n  {\n      if (model && model->getAddressTableModel())\n      {\n          AddressBookPage dlg(AddressBookPage::ForSending, AddressBookPage::ReceivingTab, this);\n          dlg.setModel(model->getAddressTableModel());\n          if (dlg.exec())\n          {\n              setAddress_SM(dlg.getReturnValue());\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "showTab_VM",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "78-83",
    "snippet": "void SignVerifyMessageDialog::showTab_VM(bool fShow)\n{\n    ui->tabWidget->setCurrentIndex(1);\n    if (fShow)\n        this->show();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->show",
          "args": [],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tabWidget->setCurrentIndex",
          "args": [
            "1"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::showTab_VM(bool fShow)\n  {\n      ui->tabWidget->setCurrentIndex(1);\n      if (fShow)\n          this->show();\n  }\n}"
  },
  {
    "function_name": "showTab_SM",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "70-76",
    "snippet": "void SignVerifyMessageDialog::showTab_SM(bool fShow)\n{\n    ui->tabWidget->setCurrentIndex(0);\n\n    if (fShow)\n        this->show();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->show",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->tabWidget->setCurrentIndex",
          "args": [
            "0"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::showTab_SM(bool fShow)\n  {\n      ui->tabWidget->setCurrentIndex(0);\n  \n      if (fShow)\n          this->show();\n  }\n}"
  },
  {
    "function_name": "setAddress_VM",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "64-68",
    "snippet": "void SignVerifyMessageDialog::setAddress_VM(QString address)\n{\n    ui->addressIn_VM->setText(address);\n    ui->messageIn_VM->setFocus();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->messageIn_VM->setFocus",
          "args": [],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "setFocus",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "162-165",
          "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setFocus()\n  {\n      ui->payTo->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->addressIn_VM->setText",
          "args": [
            "address"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::setAddress_VM(QString address)\n  {\n      ui->addressIn_VM->setText(address);\n      ui->messageIn_VM->setFocus();\n  }\n}"
  },
  {
    "function_name": "setAddress_SM",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "58-62",
    "snippet": "void SignVerifyMessageDialog::setAddress_SM(QString address)\n{\n    ui->addressIn_SM->setText(address);\n    ui->messageIn_SM->setFocus();\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->messageIn_SM->setFocus",
          "args": [],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "setFocus",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "162-165",
          "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setFocus()\n  {\n      ui->payTo->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->addressIn_SM->setText",
          "args": [
            "address"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::setAddress_SM(QString address)\n  {\n      ui->addressIn_SM->setText(address);\n      ui->messageIn_SM->setFocus();\n  }\n}"
  },
  {
    "function_name": "setModel",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "53-56",
    "snippet": "void SignVerifyMessageDialog::setModel(WalletModel *model)\n{\n    this->model = model;\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  void SignVerifyMessageDialog::setModel(WalletModel *model)\n  {\n      this->model = model;\n  }\n}"
  },
  {
    "function_name": "~SignVerifyMessageDialog",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "48-51",
    "snippet": "SignVerifyMessageDialog::~SignVerifyMessageDialog()\n{\n    delete ui;\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  SignVerifyMessageDialog::~SignVerifyMessageDialog()\n  {\n      delete ui;\n  }\n}"
  },
  {
    "function_name": "SignVerifyMessageDialog",
    "container": "SignVerifyMessageDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/signverifymessagedialog.cpp",
    "lines": "18-46",
    "snippet": "SignVerifyMessageDialog::SignVerifyMessageDialog(QWidget *parent) :\n    QDialog(parent),\n    ui(new Ui::SignVerifyMessageDialog),\n    model(0)\n{\n    ui->setupUi(this);\n\n#if (QT_VERSION >= 0x040700)\n    /* Do not move this to the XML file, Qt before 4.7 will choke on it */\n    ui->addressIn_SM->setPlaceholderText(tr(\"Enter a Halcyon address (e.g. halcyonfwYhBmGXcFP2Po1NpRUEiK8km2)\"));\n    ui->signatureOut_SM->setPlaceholderText(tr(\"Click \\\"Sign Message\\\" to generate signature\"));\n\n    ui->addressIn_VM->setPlaceholderText(tr(\"Enter a Halcyon address (e.g. halcyonfwYhBmGXcFP2Po1NpRUEiK8km2)\"));\n    ui->signatureIn_VM->setPlaceholderText(tr(\"Enter Halcyon signature\"));\n#endif\n\n    GUIUtil::setupAddressWidget(ui->addressIn_SM, this);\n    GUIUtil::setupAddressWidget(ui->addressIn_VM, this);\n\n    ui->addressIn_SM->installEventFilter(this);\n    ui->messageIn_SM->installEventFilter(this);\n    ui->signatureOut_SM->installEventFilter(this);\n    ui->addressIn_VM->installEventFilter(this);\n    ui->messageIn_VM->installEventFilter(this);\n    ui->signatureIn_VM->installEventFilter(this);\n\n    ui->signatureOut_SM->setFont(GUIUtil::bitcoinAddressFont());\n    ui->signatureIn_VM->setFont(GUIUtil::bitcoinAddressFont());\n}",
    "includes": [
      "#include <QClipboard>",
      "#include <vector>",
      "#include <string>",
      "#include \"wallet.h\"",
      "#include \"walletmodel.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"main.h\"",
      "#include \"init.h\"",
      "#include \"guiutil.h\"",
      "#include \"base58.h\"",
      "#include \"addressbookpage.h\"",
      "#include \"ui_signverifymessagedialog.h\"",
      "#include \"signverifymessagedialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->signatureIn_VM->setFont",
          "args": [
            "GUIUtil::bitcoinAddressFont()"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::bitcoinAddressFont",
          "args": [],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "bitcoinAddressFont",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "55-60",
          "snippet": "QFont bitcoinAddressFont()\n{\n    QFont font(\"Monospace\");\n    font.setStyleHint(QFont::TypeWriter);\n    return font;\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQFont bitcoinAddressFont()\n{\n    QFont font(\"Monospace\");\n    font.setStyleHint(QFont::TypeWriter);\n    return font;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->signatureOut_SM->setFont",
          "args": [
            "GUIUtil::bitcoinAddressFont()"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->signatureIn_VM->installEventFilter",
          "args": [
            "this"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->messageIn_VM->installEventFilter",
          "args": [
            "this"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->addressIn_VM->installEventFilter",
          "args": [
            "this"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->signatureOut_SM->installEventFilter",
          "args": [
            "this"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->messageIn_SM->installEventFilter",
          "args": [
            "this"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->addressIn_SM->installEventFilter",
          "args": [
            "this"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::setupAddressWidget",
          "args": [
            "ui->addressIn_VM",
            "this"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "setupAddressWidget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "62-67",
          "snippet": "void setupAddressWidget(QLineEdit *widget, QWidget *parent)\n{\n    widget->setMaxLength(BitcoinAddressValidator::MaxAddressLength);\n    widget->setValidator(new BitcoinAddressValidator(parent));\n    widget->setFont(bitcoinAddressFont());\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid setupAddressWidget(QLineEdit *widget, QWidget *parent)\n{\n    widget->setMaxLength(BitcoinAddressValidator::MaxAddressLength);\n    widget->setValidator(new BitcoinAddressValidator(parent));\n    widget->setFont(bitcoinAddressFont());\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->signatureIn_VM->setPlaceholderText",
          "args": [
            "tr(\"Enter Halcyon signature\")"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Enter Halcyon signature\""
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->addressIn_VM->setPlaceholderText",
          "args": [
            "tr(\"Enter a Halcyon address (e.g. halcyonfwYhBmGXcFP2Po1NpRUEiK8km2)\")"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->signatureOut_SM->setPlaceholderText",
          "args": [
            "tr(\"Click \\\"Sign Message\\\" to generate signature\")"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->addressIn_SM->setPlaceholderText",
          "args": [
            "tr(\"Enter a Halcyon address (e.g. halcyonfwYhBmGXcFP2Po1NpRUEiK8km2)\")"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->setupUi",
          "args": [
            "this"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QClipboard>\n#include <vector>\n#include <string>\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"optionsmodel.h\"\n#include \"main.h\"\n#include \"init.h\"\n#include \"guiutil.h\"\n#include \"base58.h\"\n#include \"addressbookpage.h\"\n#include \"ui_signverifymessagedialog.h\"\n#include \"signverifymessagedialog.h\"\n\nSignVerifyMessageDialog {\n  SignVerifyMessageDialog::SignVerifyMessageDialog(QWidget *parent) :\n      QDialog(parent),\n      ui(new Ui::SignVerifyMessageDialog),\n      model(0)\n  {\n      ui->setupUi(this);\n  \n  #if (QT_VERSION >= 0x040700)\n      /* Do not move this to the XML file, Qt before 4.7 will choke on it */\n      ui->addressIn_SM->setPlaceholderText(tr(\"Enter a Halcyon address (e.g. halcyonfwYhBmGXcFP2Po1NpRUEiK8km2)\"));\n      ui->signatureOut_SM->setPlaceholderText(tr(\"Click \\\"Sign Message\\\" to generate signature\"));\n  \n      ui->addressIn_VM->setPlaceholderText(tr(\"Enter a Halcyon address (e.g. halcyonfwYhBmGXcFP2Po1NpRUEiK8km2)\"));\n      ui->signatureIn_VM->setPlaceholderText(tr(\"Enter Halcyon signature\"));\n  #endif\n  \n      GUIUtil::setupAddressWidget(ui->addressIn_SM, this);\n      GUIUtil::setupAddressWidget(ui->addressIn_VM, this);\n  \n      ui->addressIn_SM->installEventFilter(this);\n      ui->messageIn_SM->installEventFilter(this);\n      ui->signatureOut_SM->installEventFilter(this);\n      ui->addressIn_VM->installEventFilter(this);\n      ui->messageIn_VM->installEventFilter(this);\n      ui->signatureIn_VM->installEventFilter(this);\n  \n      ui->signatureOut_SM->setFont(GUIUtil::bitcoinAddressFont());\n      ui->signatureIn_VM->setFont(GUIUtil::bitcoinAddressFont());\n  }\n}"
  }
]