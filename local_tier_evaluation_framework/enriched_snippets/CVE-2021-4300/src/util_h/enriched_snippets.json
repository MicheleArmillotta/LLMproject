[
  {
    "function_name": "ByteReverse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "667-671",
    "snippet": "inline uint32_t ByteReverse(uint32_t value)\n{\n    value = ((value & 0xFF00FF00) >> 8) | ((value & 0x00FF00FF) << 8);\n    return (value<<16) | (value>>16);\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline uint32_t ByteReverse(uint32_t value)\n{\n    value = ((value & 0xFF00FF00) >> 8) | ((value & 0x00FF00FF) << 8);\n    return (value<<16) | (value>>16);\n}"
  },
  {
    "function_name": "ExitThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "659-662",
    "snippet": "inline void ExitThread(size_t nExitCode)\n{\n    pthread_exit((void*)nExitCode);\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_exit",
          "args": [
            "(void*)nExitCode"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline void ExitThread(size_t nExitCode)\n{\n    pthread_exit((void*)nExitCode);\n}"
  },
  {
    "function_name": "SetThreadPriority",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "648-657",
    "snippet": "inline void SetThreadPriority(int nPriority)\n{\n    // It's unclear if it's even possible to change thread priorities on Linux,\n    // but we really and truly need it for the generation threads.\n#ifdef PRIO_THREAD\n    setpriority(PRIO_THREAD, 0, nPriority);\n#else\n    setpriority(PRIO_PROCESS, 0, nPriority);\n#endif\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setpriority",
          "args": [
            "PRIO_PROCESS",
            "0",
            "nPriority"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setpriority",
          "args": [
            "PRIO_THREAD",
            "0",
            "nPriority"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline void SetThreadPriority(int nPriority)\n{\n    // It's unclear if it's even possible to change thread priorities on Linux,\n    // but we really and truly need it for the generation threads.\n#ifdef PRIO_THREAD\n    setpriority(PRIO_THREAD, 0, nPriority);\n#else\n    setpriority(PRIO_PROCESS, 0, nPriority);\n#endif\n}"
  },
  {
    "function_name": "SetThreadPriority",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "637-640",
    "snippet": "inline void SetThreadPriority(int nPriority)\n{\n    SetThreadPriority(GetCurrentThread(), nPriority);\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetThreadPriority",
          "args": [
            "GetCurrentThread()",
            "nPriority"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetCurrentThread",
          "args": [],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline void SetThreadPriority(int nPriority)\n{\n    SetThreadPriority(GetCurrentThread(), nPriority);\n}"
  },
  {
    "function_name": "sorted",
    "container": "CMedianFilter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "628-631",
    "snippet": "std::vector<T> sorted () const\n    {\n        return vSorted;\n    }",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  std::vector<T> sorted () const\n      {\n          return vSorted;\n      }\n}"
  },
  {
    "function_name": "size",
    "container": "CMedianFilter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "623-626",
    "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vValues.size",
          "args": [],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "623-626",
          "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  int size() const\n      {\n          return vValues.size();\n      }\n}"
  },
  {
    "function_name": "median",
    "container": "CMedianFilter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "609-621",
    "snippet": "T median() const\n    {\n        int size = vSorted.size();\n        assert(size>0);\n        if(size & 1) // Odd number of elements\n        {\n            return vSorted[size/2];\n        }\n        else // Even number of elements\n        {\n            return (vSorted[size/2-1] + vSorted[size/2]) / 2;\n        }\n    }",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "size>0"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vSorted.size",
          "args": [],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "623-626",
          "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  int size() const\n      {\n          return vValues.size();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  T median() const\n      {\n          int size = vSorted.size();\n          assert(size>0);\n          if(size & 1) // Odd number of elements\n          {\n              return vSorted[size/2];\n          }\n          else // Even number of elements\n          {\n              return (vSorted[size/2-1] + vSorted[size/2]) / 2;\n          }\n      }\n}"
  },
  {
    "function_name": "input",
    "container": "CMedianFilter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "596-607",
    "snippet": "void input(T value)\n    {\n        if(vValues.size() == nSize)\n        {\n            vValues.erase(vValues.begin());\n        }\n        vValues.push_back(value);\n\n        vSorted.resize(vValues.size());\n        std::copy(vValues.begin(), vValues.end(), vSorted.begin());\n        std::sort(vSorted.begin(), vSorted.end());\n    }",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::sort",
          "args": [
            "vSorted.begin()",
            "vSorted.end()"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vSorted.end",
          "args": [],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vSorted.begin",
          "args": [],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::copy",
          "args": [
            "vValues.begin()",
            "vValues.end()",
            "vSorted.begin()"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vSorted.resize",
          "args": [
            "vValues.size()"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vValues.size",
          "args": [],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "623-626",
          "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  int size() const\n      {\n          return vValues.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vValues.push_back",
          "args": [
            "value"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vValues.erase",
          "args": [
            "vValues.begin()"
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "49-65",
          "snippet": "void erase(const key_type& k)\n    {\n        iterator itTarget = map.find(k);\n        if (itTarget == map.end())\n            return;\n        std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n        for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n            if (it->second == itTarget)\n            {\n                rmap.erase(it);\n                map.erase(itTarget);\n                return;\n            }\n        // Shouldn't ever get here\n        assert(0); //TODO remove me\n        map.erase(itTarget);\n    }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  void erase(const key_type& k)\n      {\n          iterator itTarget = map.find(k);\n          if (itTarget == map.end())\n              return;\n          std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n          for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n              if (it->second == itTarget)\n              {\n                  rmap.erase(it);\n                  map.erase(itTarget);\n                  return;\n              }\n          // Shouldn't ever get here\n          assert(0); //TODO remove me\n          map.erase(itTarget);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  void input(T value)\n      {\n          if(vValues.size() == nSize)\n          {\n              vValues.erase(vValues.begin());\n          }\n          vValues.push_back(value);\n  \n          vSorted.resize(vValues.size());\n          std::copy(vValues.begin(), vValues.end(), vSorted.begin());\n          std::sort(vSorted.begin(), vSorted.end());\n      }\n}"
  },
  {
    "function_name": "CMedianFilter",
    "container": "CMedianFilter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "588-594",
    "snippet": "CMedianFilter(unsigned int size, T initial_value):\n        nSize(size)\n    {\n        vValues.reserve(size);\n        vValues.push_back(initial_value);\n        vSorted = vValues;\n    }",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vValues.push_back",
          "args": [
            "initial_value"
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vValues.reserve",
          "args": [
            "size"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "805-805",
          "snippet": "void reserve(size_type n)                        { vch.reserve(n + nReadPos); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void reserve(size_type n)                        { vch.reserve(n + nReadPos); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  CMedianFilter(unsigned int size, T initial_value):\n          nSize(size)\n      {\n          vValues.reserve(size);\n          vValues.push_back(initial_value);\n          vSorted = vValues;\n      }\n}"
  },
  {
    "function_name": "TimingResistantEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "569-576",
    "snippet": "bool TimingResistantEqual(const T& a, const T& b)\n{\n    if (b.size() == 0) return a.size() == 0;\n    size_t accumulator = a.size() ^ b.size();\n    for (size_t i = 0; i < a.size(); i++)\n        accumulator |= a[i] ^ b[i%b.size()];\n    return accumulator == 0;\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b.size",
          "args": [],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "623-626",
          "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  int size() const\n      {\n          return vValues.size();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nbool TimingResistantEqual(const T& a, const T& b)\n{\n    if (b.size() == 0) return a.size() == 0;\n    size_t accumulator = a.size() ^ b.size();\n    for (size_t i = 0; i < a.size(); i++)\n        accumulator |= a[i] ^ b[i%b.size()];\n    return accumulator == 0;\n}"
  },
  {
    "function_name": "Hash160",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "554-561",
    "snippet": "inline uint160 Hash160(const std::vector<unsigned char>& vch)\n{\n    uint256 hash1;\n    SHA256(&vch[0], vch.size(), (unsigned char*)&hash1);\n    uint160 hash2;\n    RIPEMD160((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RIPEMD160",
          "args": [
            "(unsigned char*)&hash1",
            "sizeof(hash1)",
            "(unsigned char*)&hash2"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHA256",
          "args": [
            "&vch[0]",
            "vch.size()",
            "(unsigned char*)&hash1"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "65-71",
          "snippet": "void\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vch.size",
          "args": [],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CMedianFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "623-626",
          "snippet": "int size() const\n    {\n        return vValues.size();\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCMedianFilter {\n  int size() const\n      {\n          return vValues.size();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline uint160 Hash160(const std::vector<unsigned char>& vch)\n{\n    uint256 hash1;\n    SHA256(&vch[0], vch.size(), (unsigned char*)&hash1);\n    uint160 hash2;\n    RIPEMD160((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}"
  },
  {
    "function_name": "SerializeHash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "547-552",
    "snippet": "uint256 SerializeHash(const T& obj, int nType=SER_GETHASH, int nVersion=PROTOCOL_VERSION)\n{\n    CHashWriter ss(nType, nVersion);\n    ss << obj;\n    return ss.GetHash();\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ss.GetHash",
          "args": [],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "GetHash",
          "container": "CHashWriter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "495-501",
          "snippet": "uint256 GetHash() {\n        uint256 hash1;\n        SHA256_Final((unsigned char*)&hash1, &ctx);\n        uint256 hash2;\n        SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n        return hash2;\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCHashWriter {\n  uint256 GetHash() {\n          uint256 hash1;\n          SHA256_Final((unsigned char*)&hash1, &ctx);\n          uint256 hash2;\n          SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n          return hash2;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nuint256 SerializeHash(const T& obj, int nType=SER_GETHASH, int nVersion=PROTOCOL_VERSION)\n{\n    CHashWriter ss(nType, nVersion);\n    ss << obj;\n    return ss.GetHash();\n}"
  },
  {
    "function_name": "Hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "529-544",
    "snippet": "inline uint256 Hash(const T1 p1begin, const T1 p1end,\n                    const T2 p2begin, const T2 p2end,\n                    const T3 p3begin, const T3 p3end)\n{\n    static unsigned char pblank[1];\n    uint256 hash1;\n    SHA256_CTX ctx;\n    SHA256_Init(&ctx);\n    SHA256_Update(&ctx, (p1begin == p1end ? pblank : (unsigned char*)&p1begin[0]), (p1end - p1begin) * sizeof(p1begin[0]));\n    SHA256_Update(&ctx, (p2begin == p2end ? pblank : (unsigned char*)&p2begin[0]), (p2end - p2begin) * sizeof(p2begin[0]));\n    SHA256_Update(&ctx, (p3begin == p3end ? pblank : (unsigned char*)&p3begin[0]), (p3end - p3begin) * sizeof(p3begin[0]));\n    SHA256_Final((unsigned char*)&hash1, &ctx);\n    uint256 hash2;\n    SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SHA256",
          "args": [
            "(unsigned char*)&hash1",
            "sizeof(hash1)",
            "(unsigned char*)&hash2"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "65-71",
          "snippet": "void\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHA256_Final",
          "args": [
            "(unsigned char*)&hash1",
            "&ctx"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "74-90",
          "snippet": "void\nHMAC_SHA256_Final(unsigned char digest[32], HMAC_SHA256_CTX * ctx)\n{\n    unsigned char ihash[32];\n\n    /* Finish the inner SHA256 operation. */\n    SHA256_Final(ihash, &ctx->ictx);\n\n    /* Feed the inner hash to the outer SHA256 operation. */\n    SHA256_Update(&ctx->octx, ihash, 32);\n\n    /* Finish the outer SHA256 operation. */\n    SHA256_Final(digest, &ctx->octx);\n\n    /* Clean the stack. */\n    memset(ihash, 0, 32);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Final(unsigned char digest[32], HMAC_SHA256_CTX * ctx)\n{\n    unsigned char ihash[32];\n\n    /* Finish the inner SHA256 operation. */\n    SHA256_Final(ihash, &ctx->ictx);\n\n    /* Feed the inner hash to the outer SHA256 operation. */\n    SHA256_Update(&ctx->octx, ihash, 32);\n\n    /* Finish the outer SHA256 operation. */\n    SHA256_Final(digest, &ctx->octx);\n\n    /* Clean the stack. */\n    memset(ihash, 0, 32);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHA256_Init",
          "args": [
            "&ctx"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline uint256 Hash(const T1 p1begin, const T1 p1end,\n                    const T2 p2begin, const T2 p2end,\n                    const T3 p3begin, const T3 p3end)\n{\n    static unsigned char pblank[1];\n    uint256 hash1;\n    SHA256_CTX ctx;\n    SHA256_Init(&ctx);\n    SHA256_Update(&ctx, (p1begin == p1end ? pblank : (unsigned char*)&p1begin[0]), (p1end - p1begin) * sizeof(p1begin[0]));\n    SHA256_Update(&ctx, (p2begin == p2end ? pblank : (unsigned char*)&p2begin[0]), (p2end - p2begin) * sizeof(p2begin[0]));\n    SHA256_Update(&ctx, (p3begin == p3end ? pblank : (unsigned char*)&p3begin[0]), (p3end - p3begin) * sizeof(p3begin[0]));\n    SHA256_Final((unsigned char*)&hash1, &ctx);\n    uint256 hash2;\n    SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}"
  },
  {
    "function_name": "Hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "513-526",
    "snippet": "inline uint256 Hash(const T1 p1begin, const T1 p1end,\n                    const T2 p2begin, const T2 p2end)\n{\n    static unsigned char pblank[1];\n    uint256 hash1;\n    SHA256_CTX ctx;\n    SHA256_Init(&ctx);\n    SHA256_Update(&ctx, (p1begin == p1end ? pblank : (unsigned char*)&p1begin[0]), (p1end - p1begin) * sizeof(p1begin[0]));\n    SHA256_Update(&ctx, (p2begin == p2end ? pblank : (unsigned char*)&p2begin[0]), (p2end - p2begin) * sizeof(p2begin[0]));\n    SHA256_Final((unsigned char*)&hash1, &ctx);\n    uint256 hash2;\n    SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SHA256",
          "args": [
            "(unsigned char*)&hash1",
            "sizeof(hash1)",
            "(unsigned char*)&hash2"
          ],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "65-71",
          "snippet": "void\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHA256_Final",
          "args": [
            "(unsigned char*)&hash1",
            "&ctx"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "74-90",
          "snippet": "void\nHMAC_SHA256_Final(unsigned char digest[32], HMAC_SHA256_CTX * ctx)\n{\n    unsigned char ihash[32];\n\n    /* Finish the inner SHA256 operation. */\n    SHA256_Final(ihash, &ctx->ictx);\n\n    /* Feed the inner hash to the outer SHA256 operation. */\n    SHA256_Update(&ctx->octx, ihash, 32);\n\n    /* Finish the outer SHA256 operation. */\n    SHA256_Final(digest, &ctx->octx);\n\n    /* Clean the stack. */\n    memset(ihash, 0, 32);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Final(unsigned char digest[32], HMAC_SHA256_CTX * ctx)\n{\n    unsigned char ihash[32];\n\n    /* Finish the inner SHA256 operation. */\n    SHA256_Final(ihash, &ctx->ictx);\n\n    /* Feed the inner hash to the outer SHA256 operation. */\n    SHA256_Update(&ctx->octx, ihash, 32);\n\n    /* Finish the outer SHA256 operation. */\n    SHA256_Final(digest, &ctx->octx);\n\n    /* Clean the stack. */\n    memset(ihash, 0, 32);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHA256_Init",
          "args": [
            "&ctx"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline uint256 Hash(const T1 p1begin, const T1 p1end,\n                    const T2 p2begin, const T2 p2end)\n{\n    static unsigned char pblank[1];\n    uint256 hash1;\n    SHA256_CTX ctx;\n    SHA256_Init(&ctx);\n    SHA256_Update(&ctx, (p1begin == p1end ? pblank : (unsigned char*)&p1begin[0]), (p1end - p1begin) * sizeof(p1begin[0]));\n    SHA256_Update(&ctx, (p2begin == p2end ? pblank : (unsigned char*)&p2begin[0]), (p2end - p2begin) * sizeof(p2begin[0]));\n    SHA256_Final((unsigned char*)&hash1, &ctx);\n    uint256 hash2;\n    SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}"
  },
  {
    "function_name": "GetHash",
    "container": "CHashWriter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "495-501",
    "snippet": "uint256 GetHash() {\n        uint256 hash1;\n        SHA256_Final((unsigned char*)&hash1, &ctx);\n        uint256 hash2;\n        SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n        return hash2;\n    }",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SHA256",
          "args": [
            "(unsigned char*)&hash1",
            "sizeof(hash1)",
            "(unsigned char*)&hash2"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "65-71",
          "snippet": "void\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHA256_Final",
          "args": [
            "(unsigned char*)&hash1",
            "&ctx"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "74-90",
          "snippet": "void\nHMAC_SHA256_Final(unsigned char digest[32], HMAC_SHA256_CTX * ctx)\n{\n    unsigned char ihash[32];\n\n    /* Finish the inner SHA256 operation. */\n    SHA256_Final(ihash, &ctx->ictx);\n\n    /* Feed the inner hash to the outer SHA256 operation. */\n    SHA256_Update(&ctx->octx, ihash, 32);\n\n    /* Finish the outer SHA256 operation. */\n    SHA256_Final(digest, &ctx->octx);\n\n    /* Clean the stack. */\n    memset(ihash, 0, 32);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Final(unsigned char digest[32], HMAC_SHA256_CTX * ctx)\n{\n    unsigned char ihash[32];\n\n    /* Finish the inner SHA256 operation. */\n    SHA256_Final(ihash, &ctx->ictx);\n\n    /* Feed the inner hash to the outer SHA256 operation. */\n    SHA256_Update(&ctx->octx, ihash, 32);\n\n    /* Finish the outer SHA256 operation. */\n    SHA256_Final(digest, &ctx->octx);\n\n    /* Clean the stack. */\n    memset(ihash, 0, 32);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCHashWriter {\n  uint256 GetHash() {\n          uint256 hash1;\n          SHA256_Final((unsigned char*)&hash1, &ctx);\n          uint256 hash2;\n          SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n          return hash2;\n      }\n}"
  },
  {
    "function_name": "CHashWriter",
    "container": "CHashWriter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "485-487",
    "snippet": "CHashWriter(int nTypeIn, int nVersionIn) : nType(nTypeIn), nVersion(nVersionIn) {\n        Init();\n    }",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "CHashWriter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "481-483",
          "snippet": "void Init() {\n        SHA256_Init(&ctx);\n    }",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCHashWriter {\n  void Init() {\n          SHA256_Init(&ctx);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCHashWriter {\n  CHashWriter(int nTypeIn, int nVersionIn) : nType(nTypeIn), nVersion(nVersionIn) {\n          Init();\n      }\n}"
  },
  {
    "function_name": "Init",
    "container": "CHashWriter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "481-483",
    "snippet": "void Init() {\n        SHA256_Init(&ctx);\n    }",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SHA256_Init",
          "args": [
            "&ctx"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nCHashWriter {\n  void Init() {\n          SHA256_Init(&ctx);\n      }\n}"
  },
  {
    "function_name": "Hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "462-470",
    "snippet": "inline uint256 Hash(const T1 pbegin, const T1 pend)\n{\n    static unsigned char pblank[1];\n    uint256 hash1;\n    SHA256((pbegin == pend ? pblank : (unsigned char*)&pbegin[0]), (pend - pbegin) * sizeof(pbegin[0]), (unsigned char*)&hash1);\n    uint256 hash2;\n    SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SHA256",
          "args": [
            "(unsigned char*)&hash1",
            "sizeof(hash1)",
            "(unsigned char*)&hash2"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_SHA256_Update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/pbkdf2.cpp",
          "lines": "65-71",
          "snippet": "void\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}",
          "includes": [
            "#include \"pbkdf2.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pbkdf2.h\"\n#include <string.h>\n\nvoid\nHMAC_SHA256_Update(HMAC_SHA256_CTX * ctx, const void *in, size_t len)\n{\n\n    /* Feed data to the inner SHA256 operation. */\n    SHA256_Update(&ctx->ictx, in, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline uint256 Hash(const T1 pbegin, const T1 pend)\n{\n    static unsigned char pblank[1];\n    uint256 hash1;\n    SHA256((pbegin == pend ? pblank : (unsigned char*)&pbegin[0]), (pend - pbegin) * sizeof(pbegin[0]), (unsigned char*)&hash1);\n    uint256 hash2;\n    SHA256((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}"
  },
  {
    "function_name": "IsSwitchChar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "399-406",
    "snippet": "inline bool IsSwitchChar(char c)\n{\n#ifdef WIN32\n    return c == '-' || c == '/';\n#else\n    return c == '-';\n#endif\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline bool IsSwitchChar(char c)\n{\n#ifdef WIN32\n    return c == '-' || c == '/';\n#else\n    return c == '-';\n#endif\n}"
  },
  {
    "function_name": "skipspaces",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "393-397",
    "snippet": "void skipspaces(T& it)\n{\n    while (isspace(*it))\n        ++it;\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "*it"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nvoid skipspaces(T& it)\n{\n    while (isspace(*it))\n        ++it;\n}"
  },
  {
    "function_name": "DateTimeStrFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "386-389",
    "snippet": "inline std::string DateTimeStrFormat(int64_t nTime)\n{\n    return DateTimeStrFormat(strTimestampFormat.c_str(), nTime);\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DateTimeStrFormat",
          "args": [
            "strTimestampFormat.c_str()",
            "nTime"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "DateTimeStrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "376-383",
          "snippet": "inline std::string DateTimeStrFormat(const char* pszFormat, int64_t nTime)\n{\n    time_t n = nTime;\n    struct tm* ptmTime = gmtime(&n);\n    char pszTime[200];\n    strftime(pszTime, sizeof(pszTime), pszFormat, ptmTime);\n    return pszTime;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "strTimestampFormat.c_str",
          "args": [],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline std::string DateTimeStrFormat(int64_t nTime)\n{\n    return DateTimeStrFormat(strTimestampFormat.c_str(), nTime);\n}"
  },
  {
    "function_name": "DateTimeStrFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "376-383",
    "snippet": "inline std::string DateTimeStrFormat(const char* pszFormat, int64_t nTime)\n{\n    time_t n = nTime;\n    struct tm* ptmTime = gmtime(&n);\n    char pszTime[200];\n    strftime(pszTime, sizeof(pszTime), pszFormat, ptmTime);\n    return pszTime;\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strftime",
          "args": [
            "pszTime",
            "sizeof(pszTime)",
            "pszFormat",
            "ptmTime"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gmtime",
          "args": [
            "&n"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline std::string DateTimeStrFormat(const char* pszFormat, int64_t nTime)\n{\n    time_t n = nTime;\n    struct tm* ptmTime = gmtime(&n);\n    char pszTime[200];\n    strftime(pszTime, sizeof(pszTime), pszFormat, ptmTime);\n    return pszTime;\n}"
  },
  {
    "function_name": "GetTimeMillis",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "370-374",
    "snippet": "inline int64_t GetTimeMillis()\n{\n    return (boost::posix_time::ptime(boost::posix_time::microsec_clock::universal_time()) -\n            boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_milliseconds();\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::posix_time::ptime",
          "args": [
            "boost::gregorian::date(1970,1,1)"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::gregorian::date",
          "args": [
            "1970",
            "1",
            "1"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::posix_time::ptime",
          "args": [
            "boost::posix_time::microsec_clock::universal_time()"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::posix_time::microsec_clock::universal_time",
          "args": [],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t GetTimeMillis()\n{\n    return (boost::posix_time::ptime(boost::posix_time::microsec_clock::universal_time()) -\n            boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_milliseconds();\n}"
  },
  {
    "function_name": "GetPerformanceCounter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "357-368",
    "snippet": "inline int64_t GetPerformanceCounter()\n{\n    int64_t nCounter = 0;\n#ifdef WIN32\n    QueryPerformanceCounter((LARGE_INTEGER*)&nCounter);\n#else\n    timeval t;\n    gettimeofday(&t, NULL);\n    nCounter = (int64_t) t.tv_sec * 1000000 + t.tv_usec;\n#endif\n    return nCounter;\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gettimeofday",
          "args": [
            "&t",
            "NULL"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QueryPerformanceCounter",
          "args": [
            "(LARGE_INTEGER*)&nCounter"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t GetPerformanceCounter()\n{\n    int64_t nCounter = 0;\n#ifdef WIN32\n    QueryPerformanceCounter((LARGE_INTEGER*)&nCounter);\n#else\n    timeval t;\n    gettimeofday(&t, NULL);\n    nCounter = (int64_t) t.tv_sec * 1000000 + t.tv_usec;\n#endif\n    return nCounter;\n}"
  },
  {
    "function_name": "PrintHex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "352-355",
    "snippet": "inline void PrintHex(const std::vector<unsigned char>& vch, const char* pszFormat=\"%s\", bool fSpaces=true)\n{\n    printf(pszFormat, HexStr(vch, fSpaces).c_str());\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [
      "#define printf OutputDebugStringF"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "pszFormat",
            "HexStr(vch, fSpaces).c_str()"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "HexStr",
          "args": [],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HexStr",
          "args": [
            "vch",
            "fSpaces"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "HexStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "323-339",
          "snippet": "std::string HexStr(const T itbegin, const T itend, bool fSpaces=false)\n{\n    std::string rv;\n    static const char hexmap[16] = { '0', '1', '2', '3', '4', '5', '6', '7',\n                                     '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };\n    rv.reserve((itend-itbegin)*3);\n    for(T it = itbegin; it < itend; ++it)\n    {\n        unsigned char val = (unsigned char)(*it);\n        if(fSpaces && it != itbegin)\n            rv.push_back(' ');\n        rv.push_back(hexmap[val>>4]);\n        rv.push_back(hexmap[val&15]);\n    }\n\n    return rv;\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nstd::string HexStr(const T itbegin, const T itend, bool fSpaces=false)\n{\n    std::string rv;\n    static const char hexmap[16] = { '0', '1', '2', '3', '4', '5', '6', '7',\n                                     '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };\n    rv.reserve((itend-itbegin)*3);\n    for(T it = itbegin; it < itend; ++it)\n    {\n        unsigned char val = (unsigned char)(*it);\n        if(fSpaces && it != itbegin)\n            rv.push_back(' ');\n        rv.push_back(hexmap[val>>4]);\n        rv.push_back(hexmap[val&15]);\n    }\n\n    return rv;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\n#define printf OutputDebugStringF\n\ninline void PrintHex(const std::vector<unsigned char>& vch, const char* pszFormat=\"%s\", bool fSpaces=true)\n{\n    printf(pszFormat, HexStr(vch, fSpaces).c_str());\n}"
  },
  {
    "function_name": "PrintHex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "347-350",
    "snippet": "void PrintHex(const T pbegin, const T pend, const char* pszFormat=\"%s\", bool fSpaces=true)\n{\n    printf(pszFormat, HexStr(pbegin, pend, fSpaces).c_str());\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [
      "#define printf OutputDebugStringF"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "pszFormat",
            "HexStr(pbegin, pend, fSpaces).c_str()"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "HexStr",
          "args": [],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HexStr",
          "args": [
            "pbegin",
            "pend",
            "fSpaces"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\n#define printf OutputDebugStringF\n\nvoid PrintHex(const T pbegin, const T pend, const char* pszFormat=\"%s\", bool fSpaces=true)\n{\n    printf(pszFormat, HexStr(pbegin, pend, fSpaces).c_str());\n}"
  },
  {
    "function_name": "HexStr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "341-344",
    "snippet": "inline std::string HexStr(const std::vector<unsigned char>& vch, bool fSpaces=false)\n{\n    return HexStr(vch.begin(), vch.end(), fSpaces);\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HexStr",
          "args": [
            "vch.begin()",
            "vch.end()",
            "fSpaces"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vch.end",
          "args": [],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vch.begin",
          "args": [],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline std::string HexStr(const std::vector<unsigned char>& vch, bool fSpaces=false)\n{\n    return HexStr(vch.begin(), vch.end(), fSpaces);\n}"
  },
  {
    "function_name": "HexStr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "323-339",
    "snippet": "std::string HexStr(const T itbegin, const T itend, bool fSpaces=false)\n{\n    std::string rv;\n    static const char hexmap[16] = { '0', '1', '2', '3', '4', '5', '6', '7',\n                                     '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };\n    rv.reserve((itend-itbegin)*3);\n    for(T it = itbegin; it < itend; ++it)\n    {\n        unsigned char val = (unsigned char)(*it);\n        if(fSpaces && it != itbegin)\n            rv.push_back(' ');\n        rv.push_back(hexmap[val>>4]);\n        rv.push_back(hexmap[val&15]);\n    }\n\n    return rv;\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rv.push_back",
          "args": [
            "hexmap[val&15]"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rv.push_back",
          "args": [
            "hexmap[val>>4]"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rv.push_back",
          "args": [
            "' '"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rv.reserve",
          "args": [
            "(itend-itbegin)*3"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "805-805",
          "snippet": "void reserve(size_type n)                        { vch.reserve(n + nReadPos); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void reserve(size_type n)                        { vch.reserve(n + nReadPos); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\nstd::string HexStr(const T itbegin, const T itend, bool fSpaces=false)\n{\n    std::string rv;\n    static const char hexmap[16] = { '0', '1', '2', '3', '4', '5', '6', '7',\n                                     '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };\n    rv.reserve((itend-itbegin)*3);\n    for(T it = itbegin; it < itend; ++it)\n    {\n        unsigned char val = (unsigned char)(*it);\n        if(fSpaces && it != itbegin)\n            rv.push_back(' ');\n        rv.push_back(hexmap[val>>4]);\n        rv.push_back(hexmap[val&15]);\n    }\n\n    return rv;\n}"
  },
  {
    "function_name": "leftTrim",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "312-320",
    "snippet": "inline std::string leftTrim(std::string src, char chr)\n{\n    std::string::size_type pos = src.find_first_not_of(chr, 0);\n\n    if(pos > 0)\n        src.erase(0, pos);\n\n    return src;\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "src.erase",
          "args": [
            "0",
            "pos"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "870-888",
          "snippet": "iterator erase(iterator first, iterator last)\n    {\n        if (first == vch.begin() + nReadPos)\n        {\n            // special case for erasing from the front\n            if (last == vch.end())\n            {\n                nReadPos = 0;\n                return vch.erase(vch.begin(), vch.end());\n            }\n            else\n            {\n                nReadPos = (last - vch.begin());\n                return last;\n            }\n        }\n        else\n            return vch.erase(first, last);\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  iterator erase(iterator first, iterator last)\n      {\n          if (first == vch.begin() + nReadPos)\n          {\n              // special case for erasing from the front\n              if (last == vch.end())\n              {\n                  nReadPos = 0;\n                  return vch.erase(vch.begin(), vch.end());\n              }\n              else\n              {\n                  nReadPos = (last - vch.begin());\n                  return last;\n              }\n          }\n          else\n              return vch.erase(first, last);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "src.find_first_not_of",
          "args": [
            "chr",
            "0"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline std::string leftTrim(std::string src, char chr)\n{\n    std::string::size_type pos = src.find_first_not_of(chr, 0);\n\n    if(pos > 0)\n        src.erase(0, pos);\n\n    return src;\n}"
  },
  {
    "function_name": "abs64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "307-310",
    "snippet": "inline int64_t abs64(int64_t n)\n{\n    return (n >= 0 ? n : -n);\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t abs64(int64_t n)\n{\n    return (n >= 0 ? n : -n);\n}"
  },
  {
    "function_name": "roundint64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "302-305",
    "snippet": "inline int64_t roundint64(double d)\n{\n    return (int64_t)(d > 0 ? d + 0.5 : d - 0.5);\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t roundint64(double d)\n{\n    return (int64_t)(d > 0 ? d + 0.5 : d - 0.5);\n}"
  },
  {
    "function_name": "roundint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "297-300",
    "snippet": "inline int roundint(double d)\n{\n    return (int)(d > 0 ? d + 0.5 : d - 0.5);\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int roundint(double d)\n{\n    return (int)(d > 0 ? d + 0.5 : d - 0.5);\n}"
  },
  {
    "function_name": "atoi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "292-295",
    "snippet": "inline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "str.c_str()"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "atoi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "292-295",
          "snippet": "inline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}"
  },
  {
    "function_name": "atoi64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "283-290",
    "snippet": "inline int64_t atoi64(const std::string& str)\n{\n#ifdef _MSC_VER\n    return _atoi64(str.c_str());\n#else\n    return strtoll(str.c_str(), NULL, 10);\n#endif\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtoll",
          "args": [
            "str.c_str()",
            "NULL",
            "10"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_atoi64",
          "args": [
            "str.c_str()"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t atoi64(const std::string& str)\n{\n#ifdef _MSC_VER\n    return _atoi64(str.c_str());\n#else\n    return strtoll(str.c_str(), NULL, 10);\n#endif\n}"
  },
  {
    "function_name": "atoi64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "274-281",
    "snippet": "inline int64_t atoi64(const char* psz)\n{\n#ifdef _MSC_VER\n    return _atoi64(psz);\n#else\n    return strtoll(psz, NULL, 10);\n#endif\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtoll",
          "args": [
            "psz",
            "NULL",
            "10"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_atoi64",
          "args": [
            "psz"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int64_t atoi64(const char* psz)\n{\n#ifdef _MSC_VER\n    return _atoi64(psz);\n#else\n    return strtoll(psz, NULL, 10);\n#endif\n}"
  },
  {
    "function_name": "itostr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "269-272",
    "snippet": "inline std::string itostr(int n)\n{\n    return strprintf(\"%d\", n);\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"%d\"",
            "n"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline std::string itostr(int n)\n{\n    return strprintf(\"%d\", n);\n}"
  },
  {
    "function_name": "i64tostr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "264-267",
    "snippet": "inline std::string i64tostr(int64_t n)\n{\n    return strprintf(\"%\"PRId64, n);\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"%\"PRId64",
            "n"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline std::string i64tostr(int64_t n)\n{\n    return strprintf(\"%\"PRId64, n);\n}"
  },
  {
    "function_name": "MilliSleep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
    "lines": "132-139",
    "snippet": "inline void MilliSleep(int64_t n)\n{\n#if BOOST_VERSION >= 105000\n    boost::this_thread::sleep_for(boost::chrono::milliseconds(n));\n#else\n    boost::this_thread::sleep(boost::posix_time::milliseconds(n));\n#endif\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include <stdint.h>",
      "#include \"netbase.h\" // for AddTimeData",
      "#include <openssl/ripemd.h>",
      "#include <openssl/sha.h>",
      "#include <boost/date_time/posix_time/posix_time_types.hpp>",
      "#include <boost/date_time/gregorian/gregorian_types.hpp>",
      "#include <boost/filesystem/path.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <boost/thread.hpp>",
      "#include <string>",
      "#include <vector>",
      "#include <map>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>",
      "#include \"uint256.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "boost::this_thread::sleep",
          "args": [
            "boost::posix_time::milliseconds(n)"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::posix_time::milliseconds",
          "args": [
            "n"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::this_thread::sleep_for",
          "args": [
            "boost::chrono::milliseconds(n)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::chrono::milliseconds",
          "args": [
            "n"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline void MilliSleep(int64_t n)\n{\n#if BOOST_VERSION >= 105000\n    boost::this_thread::sleep_for(boost::chrono::milliseconds(n));\n#else\n    boost::this_thread::sleep(boost::posix_time::milliseconds(n));\n#endif\n}"
  }
]