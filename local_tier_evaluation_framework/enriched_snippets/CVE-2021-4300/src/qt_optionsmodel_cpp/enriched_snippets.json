[
  {
    "function_name": "getDisplayAddresses",
    "container": "OptionsModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "318-321",
    "snippet": "bool OptionsModel::getDisplayAddresses()\n{\n    return bDisplayAddresses;\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  bool OptionsModel::getDisplayAddresses()\n  {\n      return bDisplayAddresses;\n  }\n}"
  },
  {
    "function_name": "getDisplayUnit",
    "container": "OptionsModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "313-316",
    "snippet": "int OptionsModel::getDisplayUnit()\n{\n    return nDisplayUnit;\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  int OptionsModel::getDisplayUnit()\n  {\n      return nDisplayUnit;\n  }\n}"
  },
  {
    "function_name": "getMinimizeOnClose",
    "container": "OptionsModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "308-311",
    "snippet": "bool OptionsModel::getMinimizeOnClose()\n{\n    return fMinimizeOnClose;\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  bool OptionsModel::getMinimizeOnClose()\n  {\n      return fMinimizeOnClose;\n  }\n}"
  },
  {
    "function_name": "getMinimizeToTray",
    "container": "OptionsModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "303-306",
    "snippet": "bool OptionsModel::getMinimizeToTray()\n{\n    return fMinimizeToTray;\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  bool OptionsModel::getMinimizeToTray()\n  {\n      return fMinimizeToTray;\n  }\n}"
  },
  {
    "function_name": "getCoinControlFeatures",
    "container": "OptionsModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "298-301",
    "snippet": "bool OptionsModel::getCoinControlFeatures()\n{\n    return fCoinControlFeatures;\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  bool OptionsModel::getCoinControlFeatures()\n  {\n      return fCoinControlFeatures;\n  }\n}"
  },
  {
    "function_name": "getReserveBalance",
    "container": "OptionsModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "293-296",
    "snippet": "qint64 OptionsModel::getReserveBalance()\n{\n    return nReserveBalance;\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  qint64 OptionsModel::getReserveBalance()\n  {\n      return nReserveBalance;\n  }\n}"
  },
  {
    "function_name": "getTransactionFee",
    "container": "OptionsModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "288-291",
    "snippet": "qint64 OptionsModel::getTransactionFee()\n{\n    return nTransactionFee;\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  qint64 OptionsModel::getTransactionFee()\n  {\n      return nTransactionFee;\n  }\n}"
  },
  {
    "function_name": "setData",
    "container": "OptionsModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "186-286",
    "snippet": "bool OptionsModel::setData(const QModelIndex & index, const QVariant & value, int role)\n{\n    bool successful = true; /* set to false on parse error */\n    if(role == Qt::EditRole)\n    {\n        QSettings settings;\n        switch(index.row())\n        {\n        case StartAtStartup:\n            successful = GUIUtil::SetStartOnSystemStartup(value.toBool());\n            break;\n        case MinimizeToTray:\n            fMinimizeToTray = value.toBool();\n            settings.setValue(\"fMinimizeToTray\", fMinimizeToTray);\n            break;\n        case MapPortUPnP:\n            fUseUPnP = value.toBool();\n            settings.setValue(\"fUseUPnP\", fUseUPnP);\n            MapPort();\n            break;\n        case MinimizeOnClose:\n            fMinimizeOnClose = value.toBool();\n            settings.setValue(\"fMinimizeOnClose\", fMinimizeOnClose);\n            break;\n        case ProxyUse:\n            settings.setValue(\"fUseProxy\", value.toBool());\n            ApplyProxySettings();\n            break;\n        case ProxyIP: {\n            proxyType proxy;\n            proxy.first = CService(\"127.0.0.1\", 9050);\n            GetProxy(NET_IPV4, proxy);\n\n            CNetAddr addr(value.toString().toStdString());\n            proxy.first.SetIP(addr);\n            settings.setValue(\"addrProxy\", proxy.first.ToStringIPPort().c_str());\n            successful = ApplyProxySettings();\n        }\n        break;\n        case ProxyPort: {\n            proxyType proxy;\n            proxy.first = CService(\"127.0.0.1\", 9050);\n            GetProxy(NET_IPV4, proxy);\n\n            proxy.first.SetPort(value.toInt());\n            settings.setValue(\"addrProxy\", proxy.first.ToStringIPPort().c_str());\n            successful = ApplyProxySettings();\n        }\n        break;\n        case ProxySocksVersion: {\n            proxyType proxy;\n            proxy.second = 5;\n            GetProxy(NET_IPV4, proxy);\n\n            proxy.second = value.toInt();\n            settings.setValue(\"nSocksVersion\", proxy.second);\n            successful = ApplyProxySettings();\n        }\n        break;\n        case Fee:\n            nTransactionFee = value.toLongLong();\n            settings.setValue(\"nTransactionFee\", (qint64) nTransactionFee);\n            emit transactionFeeChanged(nTransactionFee);\n            break;\n        case ReserveBalance:\n            nReserveBalance = value.toLongLong();\n            settings.setValue(\"nReserveBalance\", (qint64) nReserveBalance);\n            emit reserveBalanceChanged(nReserveBalance);\n            break;\n        case DisplayUnit:\n            nDisplayUnit = value.toInt();\n            settings.setValue(\"nDisplayUnit\", nDisplayUnit);\n            emit displayUnitChanged(nDisplayUnit);\n            break;\n        case DisplayAddresses:\n            bDisplayAddresses = value.toBool();\n            settings.setValue(\"bDisplayAddresses\", bDisplayAddresses);\n            break;\n        case DetachDatabases: {\n            bool fDetachDB = value.toBool();\n            bitdb.SetDetach(fDetachDB);\n            settings.setValue(\"detachDB\", fDetachDB);\n            }\n            break;\n        case Language:\n            settings.setValue(\"language\", value);\n            break;\n        case CoinControlFeatures: {\n            fCoinControlFeatures = value.toBool();\n            settings.setValue(\"fCoinControlFeatures\", fCoinControlFeatures);\n            emit coinControlFeaturesChanged(fCoinControlFeatures);\n            }\n            break;\n        default:\n            break;\n        }\n    }\n    emit dataChanged(index, index);\n\n    return successful;\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"fCoinControlFeatures\"",
            "fCoinControlFeatures"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toBool",
          "args": [],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"language\"",
            "value"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"detachDB\"",
            "fDetachDB"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitdb.SetDetach",
          "args": [
            "fDetachDB"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "SetDetach",
          "container": "CDBEnv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
          "lines": "77-77",
          "snippet": "void SetDetach(bool fDetachDB_) { fDetachDB = fDetachDB_; }",
          "includes": [
            "#include <db_cxx.h>",
            "#include <vector>",
            "#include <string>",
            "#include <map>",
            "#include \"main.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDBEnv {\n  void SetDetach(bool fDetachDB_) { fDetachDB = fDetachDB_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.toBool",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"bDisplayAddresses\"",
            "bDisplayAddresses"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toBool",
          "args": [],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"nDisplayUnit\"",
            "nDisplayUnit"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toInt",
          "args": [],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"nReserveBalance\"",
            "(qint64) nReserveBalance"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toLongLong",
          "args": [],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"nTransactionFee\"",
            "(qint64) nTransactionFee"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toLongLong",
          "args": [],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ApplyProxySettings",
          "args": [],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "ApplyProxySettings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
          "lines": "15-37",
          "snippet": "bool static ApplyProxySettings()\n{\n    QSettings settings;\n    CService addrProxy(settings.value(\"addrProxy\", \"127.0.0.1:9050\").toString().toStdString());\n    int nSocksVersion(settings.value(\"nSocksVersion\", 5).toInt());\n    if (!settings.value(\"fUseProxy\", false).toBool()) {\n        addrProxy = CService();\n        nSocksVersion = 0;\n        return false;\n    }\n    if (nSocksVersion && !addrProxy.IsValid())\n        return false;\n    if (!IsLimited(NET_IPV4))\n        SetProxy(NET_IPV4, addrProxy, nSocksVersion);\n    if (nSocksVersion > 4) {\n#ifdef USE_IPV6\n        if (!IsLimited(NET_IPV6))\n            SetProxy(NET_IPV6, addrProxy, nSocksVersion);\n#endif\n        SetNameProxy(addrProxy, nSocksVersion);\n    }\n    return true;\n}",
          "includes": [
            "#include \"guiutil.h\"",
            "#include \"walletdb.h\"",
            "#include \"init.h\"",
            "#include <QSettings>",
            "#include \"bitcoinunits.h\"",
            "#include \"optionsmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nbool static ApplyProxySettings()\n{\n    QSettings settings;\n    CService addrProxy(settings.value(\"addrProxy\", \"127.0.0.1:9050\").toString().toStdString());\n    int nSocksVersion(settings.value(\"nSocksVersion\", 5).toInt());\n    if (!settings.value(\"fUseProxy\", false).toBool()) {\n        addrProxy = CService();\n        nSocksVersion = 0;\n        return false;\n    }\n    if (nSocksVersion && !addrProxy.IsValid())\n        return false;\n    if (!IsLimited(NET_IPV4))\n        SetProxy(NET_IPV4, addrProxy, nSocksVersion);\n    if (nSocksVersion > 4) {\n#ifdef USE_IPV6\n        if (!IsLimited(NET_IPV6))\n            SetProxy(NET_IPV6, addrProxy, nSocksVersion);\n#endif\n        SetNameProxy(addrProxy, nSocksVersion);\n    }\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"nSocksVersion\"",
            "proxy.second"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toInt",
          "args": [],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetProxy",
          "args": [
            "NET_IPV4",
            "proxy"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "GetProxy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "443-450",
          "snippet": "bool GetProxy(enum Network net, proxyType &proxyInfoOut) {\n    assert(net >= 0 && net < NET_MAX);\n    LOCK(cs_proxyInfos);\n    if (!proxyInfo[net].second)\n        return false;\n    proxyInfoOut = proxyInfo[net];\n    return true;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static proxyType proxyInfo[NET_MAX];",
            "static CCriticalSection cs_proxyInfos;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nstatic proxyType proxyInfo[NET_MAX];\nstatic CCriticalSection cs_proxyInfos;\n\nbool GetProxy(enum Network net, proxyType &proxyInfoOut) {\n    assert(net >= 0 && net < NET_MAX);\n    LOCK(cs_proxyInfos);\n    if (!proxyInfo[net].second)\n        return false;\n    proxyInfoOut = proxyInfo[net];\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"addrProxy\"",
            "proxy.first.ToStringIPPort().c_str()"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proxy.first.ToStringIPPort",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "ToStringIPPort",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1163-1170",
          "snippet": "std::string CService::ToStringIPPort() const\n{\n    if (IsIPv4() || IsTor() || IsI2P()) {\n        return ToStringIP() + \":\" + ToStringPort();\n    } else {\n        return \"[\" + ToStringIP() + \"]:\" + ToStringPort();\n    }\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToStringIPPort() const\n  {\n      if (IsIPv4() || IsTor() || IsI2P()) {\n          return ToStringIP() + \":\" + ToStringPort();\n      } else {\n          return \"[\" + ToStringIP() + \"]:\" + ToStringPort();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "proxy.first.SetPort",
          "args": [
            "value.toInt()"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "SetPort",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1182-1185",
          "snippet": "void CService::SetPort(unsigned short portIn)\n{\n    port = portIn;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  void CService::SetPort(unsigned short portIn)\n  {\n      port = portIn;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.toInt",
          "args": [],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CService",
          "args": [
            "\"127.0.0.1\"",
            "9050"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "GetSockAddr",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1117-1146",
          "snippet": "bool CService::GetSockAddr(struct sockaddr* paddr, socklen_t *addrlen) const\n{\n    if (IsIPv4()) {\n        if (*addrlen < (socklen_t)sizeof(struct sockaddr_in))\n            return false;\n        *addrlen = sizeof(struct sockaddr_in);\n        struct sockaddr_in *paddrin = (struct sockaddr_in*)paddr;\n        memset(paddrin, 0, *addrlen);\n        if (!GetInAddr(&paddrin->sin_addr))\n            return false;\n        paddrin->sin_family = AF_INET;\n        paddrin->sin_port = htons(port);\n        return true;\n    }\n#ifdef USE_IPV6\n    if (IsIPv6()) {\n        if (*addrlen < (socklen_t)sizeof(struct sockaddr_in6))\n            return false;\n        *addrlen = sizeof(struct sockaddr_in6);\n        struct sockaddr_in6 *paddrin6 = (struct sockaddr_in6*)paddr;\n        memset(paddrin6, 0, *addrlen);\n        if (!GetIn6Addr(&paddrin6->sin6_addr))\n            return false;\n        paddrin6->sin6_family = AF_INET6;\n        paddrin6->sin6_port = htons(port);\n        return true;\n    }\n#endif\n    return false;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  bool CService::GetSockAddr(struct sockaddr* paddr, socklen_t *addrlen) const\n  {\n      if (IsIPv4()) {\n          if (*addrlen < (socklen_t)sizeof(struct sockaddr_in))\n              return false;\n          *addrlen = sizeof(struct sockaddr_in);\n          struct sockaddr_in *paddrin = (struct sockaddr_in*)paddr;\n          memset(paddrin, 0, *addrlen);\n          if (!GetInAddr(&paddrin->sin_addr))\n              return false;\n          paddrin->sin_family = AF_INET;\n          paddrin->sin_port = htons(port);\n          return true;\n      }\n  #ifdef USE_IPV6\n      if (IsIPv6()) {\n          if (*addrlen < (socklen_t)sizeof(struct sockaddr_in6))\n              return false;\n          *addrlen = sizeof(struct sockaddr_in6);\n          struct sockaddr_in6 *paddrin6 = (struct sockaddr_in6*)paddr;\n          memset(paddrin6, 0, *addrlen);\n          if (!GetIn6Addr(&paddrin6->sin6_addr))\n              return false;\n          paddrin6->sin6_family = AF_INET6;\n          paddrin6->sin6_port = htons(port);\n          return true;\n      }\n  #endif\n      return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"addrProxy\"",
            "proxy.first.ToStringIPPort().c_str()"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proxy.first.SetIP",
          "args": [
            "addr"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "SetIP",
          "container": "CNetAddr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "559-562",
          "snippet": "void CNetAddr::SetIP(const CNetAddr& ipIn)\n{\n    memcpy(ip, ipIn.ip, sizeof(ip));\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCNetAddr {\n  void CNetAddr::SetIP(const CNetAddr& ipIn)\n  {\n      memcpy(ip, ipIn.ip, sizeof(ip));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.toString",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toString",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"fUseProxy\"",
            "value.toBool()"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toBool",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"fMinimizeOnClose\"",
            "fMinimizeOnClose"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toBool",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MapPort",
          "args": [],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "MapPort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.cpp",
          "lines": "1151-1154",
          "snippet": "void MapPort()\n{\n    // Intentionally left blank.\n}",
          "includes": [
            "#include <miniupnpc/upnperrors.h>",
            "#include <miniupnpc/upnpcommands.h>",
            "#include <miniupnpc/miniupnpc.h>",
            "#include <miniupnpc/miniwget.h>",
            "#include <string.h>",
            "#include \"ui_interface.h\"",
            "#include \"addrman.h\"",
            "#include \"strlcpy.h\"",
            "#include \"init.h\"",
            "#include \"ntp.h\"",
            "#include \"net.h\"",
            "#include \"db.h\"",
            "#include \"irc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <miniupnpc/upnperrors.h>\n#include <miniupnpc/upnpcommands.h>\n#include <miniupnpc/miniupnpc.h>\n#include <miniupnpc/miniwget.h>\n#include <string.h>\n#include \"ui_interface.h\"\n#include \"addrman.h\"\n#include \"strlcpy.h\"\n#include \"init.h\"\n#include \"ntp.h\"\n#include \"net.h\"\n#include \"db.h\"\n#include \"irc.h\"\n\nvoid MapPort()\n{\n    // Intentionally left blank.\n}"
        }
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"fUseUPnP\"",
            "fUseUPnP"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toBool",
          "args": [],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"fMinimizeToTray\"",
            "fMinimizeToTray"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.toBool",
          "args": [],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::SetStartOnSystemStartup",
          "args": [
            "value.toBool()"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "SetStartOnSystemStartup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "413-413",
          "snippet": "bool SetStartOnSystemStartup(bool fAutoStart) { return false; }",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool SetStartOnSystemStartup(bool fAutoStart) { return false; }"
        }
      },
      {
        "call_info": {
          "callee": "value.toBool",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index.row",
          "args": [],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  bool OptionsModel::setData(const QModelIndex & index, const QVariant & value, int role)\n  {\n      bool successful = true; /* set to false on parse error */\n      if(role == Qt::EditRole)\n      {\n          QSettings settings;\n          switch(index.row())\n          {\n          case StartAtStartup:\n              successful = GUIUtil::SetStartOnSystemStartup(value.toBool());\n              break;\n          case MinimizeToTray:\n              fMinimizeToTray = value.toBool();\n              settings.setValue(\"fMinimizeToTray\", fMinimizeToTray);\n              break;\n          case MapPortUPnP:\n              fUseUPnP = value.toBool();\n              settings.setValue(\"fUseUPnP\", fUseUPnP);\n              MapPort();\n              break;\n          case MinimizeOnClose:\n              fMinimizeOnClose = value.toBool();\n              settings.setValue(\"fMinimizeOnClose\", fMinimizeOnClose);\n              break;\n          case ProxyUse:\n              settings.setValue(\"fUseProxy\", value.toBool());\n              ApplyProxySettings();\n              break;\n          case ProxyIP: {\n              proxyType proxy;\n              proxy.first = CService(\"127.0.0.1\", 9050);\n              GetProxy(NET_IPV4, proxy);\n  \n              CNetAddr addr(value.toString().toStdString());\n              proxy.first.SetIP(addr);\n              settings.setValue(\"addrProxy\", proxy.first.ToStringIPPort().c_str());\n              successful = ApplyProxySettings();\n          }\n          break;\n          case ProxyPort: {\n              proxyType proxy;\n              proxy.first = CService(\"127.0.0.1\", 9050);\n              GetProxy(NET_IPV4, proxy);\n  \n              proxy.first.SetPort(value.toInt());\n              settings.setValue(\"addrProxy\", proxy.first.ToStringIPPort().c_str());\n              successful = ApplyProxySettings();\n          }\n          break;\n          case ProxySocksVersion: {\n              proxyType proxy;\n              proxy.second = 5;\n              GetProxy(NET_IPV4, proxy);\n  \n              proxy.second = value.toInt();\n              settings.setValue(\"nSocksVersion\", proxy.second);\n              successful = ApplyProxySettings();\n          }\n          break;\n          case Fee:\n              nTransactionFee = value.toLongLong();\n              settings.setValue(\"nTransactionFee\", (qint64) nTransactionFee);\n              emit transactionFeeChanged(nTransactionFee);\n              break;\n          case ReserveBalance:\n              nReserveBalance = value.toLongLong();\n              settings.setValue(\"nReserveBalance\", (qint64) nReserveBalance);\n              emit reserveBalanceChanged(nReserveBalance);\n              break;\n          case DisplayUnit:\n              nDisplayUnit = value.toInt();\n              settings.setValue(\"nDisplayUnit\", nDisplayUnit);\n              emit displayUnitChanged(nDisplayUnit);\n              break;\n          case DisplayAddresses:\n              bDisplayAddresses = value.toBool();\n              settings.setValue(\"bDisplayAddresses\", bDisplayAddresses);\n              break;\n          case DetachDatabases: {\n              bool fDetachDB = value.toBool();\n              bitdb.SetDetach(fDetachDB);\n              settings.setValue(\"detachDB\", fDetachDB);\n              }\n              break;\n          case Language:\n              settings.setValue(\"language\", value);\n              break;\n          case CoinControlFeatures: {\n              fCoinControlFeatures = value.toBool();\n              settings.setValue(\"fCoinControlFeatures\", fCoinControlFeatures);\n              emit coinControlFeaturesChanged(fCoinControlFeatures);\n              }\n              break;\n          default:\n              break;\n          }\n      }\n      emit dataChanged(index, index);\n  \n      return successful;\n  }\n}"
  },
  {
    "function_name": "data",
    "container": "OptionsModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "132-184",
    "snippet": "QVariant OptionsModel::data(const QModelIndex & index, int role) const\n{\n    if(role == Qt::EditRole)\n    {\n        QSettings settings;\n        switch(index.row())\n        {\n        case StartAtStartup:\n            return QVariant(GUIUtil::GetStartOnSystemStartup());\n        case MinimizeToTray:\n            return QVariant(fMinimizeToTray);\n        case MapPortUPnP:\n            return settings.value(\"fUseUPnP\", GetBoolArg(\"-upnp\", true));\n        case MinimizeOnClose:\n            return QVariant(fMinimizeOnClose);\n        case ProxyUse:\n            return settings.value(\"fUseProxy\", false);\n        case ProxyIP: {\n            proxyType proxy;\n            if (GetProxy(NET_IPV4, proxy))\n                return QVariant(QString::fromStdString(proxy.first.ToStringIP()));\n            else\n                return QVariant(QString::fromStdString(\"127.0.0.1\"));\n        }\n        case ProxyPort: {\n            proxyType proxy;\n            if (GetProxy(NET_IPV4, proxy))\n                return QVariant(proxy.first.GetPort());\n            else\n                return QVariant(9050);\n        }\n        case ProxySocksVersion:\n            return settings.value(\"nSocksVersion\", 5);\n        case Fee:\n            return QVariant((qint64) nTransactionFee);\n        case ReserveBalance:\n            return QVariant((qint64) nReserveBalance);\n        case DisplayUnit:\n            return QVariant(nDisplayUnit);\n        case DisplayAddresses:\n            return QVariant(bDisplayAddresses);\n        case DetachDatabases:\n            return QVariant(bitdb.GetDetach());\n        case Language:\n            return settings.value(\"language\", \"\");\n        case CoinControlFeatures:\n            return QVariant(fCoinControlFeatures);\n        default:\n            return QVariant();\n        }\n    }\n    return QVariant();\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QVariant",
          "args": [],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "fCoinControlFeatures"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"language\"",
            "\"\""
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "bitdb.GetDetach()"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitdb.GetDetach",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "GetDetach",
          "container": "CDBEnv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/db.h",
          "lines": "78-78",
          "snippet": "bool GetDetach() { return fDetachDB; }",
          "includes": [
            "#include <db_cxx.h>",
            "#include <vector>",
            "#include <string>",
            "#include <map>",
            "#include \"main.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <db_cxx.h>\n#include <vector>\n#include <string>\n#include <map>\n#include \"main.h\"\n\nCDBEnv {\n  bool GetDetach() { return fDetachDB; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "bDisplayAddresses"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "nDisplayUnit"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "(qint64) nReserveBalance"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "(qint64) nTransactionFee"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"nSocksVersion\"",
            "5"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "9050"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "proxy.first.GetPort()"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proxy.first.GetPort",
          "args": [],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "GetPort",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1097-1100",
          "snippet": "unsigned short CService::GetPort() const\n{\n    return port;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  unsigned short CService::GetPort() const\n  {\n      return port;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetProxy",
          "args": [
            "NET_IPV4",
            "proxy"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "GetProxy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "443-450",
          "snippet": "bool GetProxy(enum Network net, proxyType &proxyInfoOut) {\n    assert(net >= 0 && net < NET_MAX);\n    LOCK(cs_proxyInfos);\n    if (!proxyInfo[net].second)\n        return false;\n    proxyInfoOut = proxyInfo[net];\n    return true;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static proxyType proxyInfo[NET_MAX];",
            "static CCriticalSection cs_proxyInfos;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nstatic proxyType proxyInfo[NET_MAX];\nstatic CCriticalSection cs_proxyInfos;\n\nbool GetProxy(enum Network net, proxyType &proxyInfoOut) {\n    assert(net >= 0 && net < NET_MAX);\n    LOCK(cs_proxyInfos);\n    if (!proxyInfo[net].second)\n        return false;\n    proxyInfoOut = proxyInfo[net];\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "QString::fromStdString(\"127.0.0.1\")"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "\"127.0.0.1\""
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "QString::fromStdString(proxy.first.ToStringIP())"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "proxy.first.ToStringIP()"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proxy.first.ToStringIP",
          "args": [],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "ToStringIP",
          "container": "CNetAddr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "783-809",
          "snippet": "std::string CNetAddr::ToStringIP() const\n{\n    if (IsTor())\n        return EncodeBase32(&ip[6], 10) + \".onion\";\n    if (IsI2P())\n        return EncodeBase32(&ip[6], 10) + \".oc.b32.i2p\";\n    CService serv(*this, 0);\n#ifdef USE_IPV6\n    struct sockaddr_storage sockaddr;\n#else\n    struct sockaddr sockaddr;\n#endif\n    socklen_t socklen = sizeof(sockaddr);\n    if (serv.GetSockAddr((struct sockaddr*)&sockaddr, &socklen)) {\n        char name[1025] = \"\";\n        if (!getnameinfo((const struct sockaddr*)&sockaddr, socklen, name, sizeof(name), NULL, 0, NI_NUMERICHOST))\n            return std::string(name);\n    }\n    if (IsIPv4())\n        return strprintf(\"%u.%u.%u.%u\", GetByte(3), GetByte(2), GetByte(1), GetByte(0));\n    else\n        return strprintf(\"%x:%x:%x:%x:%x:%x:%x:%x\",\n                         GetByte(15) << 8 | GetByte(14), GetByte(13) << 8 | GetByte(12),\n                         GetByte(11) << 8 | GetByte(10), GetByte(9) << 8 | GetByte(8),\n                         GetByte(7) << 8 | GetByte(6), GetByte(5) << 8 | GetByte(4),\n                         GetByte(3) << 8 | GetByte(2), GetByte(1) << 8 | GetByte(0));\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCNetAddr {\n  std::string CNetAddr::ToStringIP() const\n  {\n      if (IsTor())\n          return EncodeBase32(&ip[6], 10) + \".onion\";\n      if (IsI2P())\n          return EncodeBase32(&ip[6], 10) + \".oc.b32.i2p\";\n      CService serv(*this, 0);\n  #ifdef USE_IPV6\n      struct sockaddr_storage sockaddr;\n  #else\n      struct sockaddr sockaddr;\n  #endif\n      socklen_t socklen = sizeof(sockaddr);\n      if (serv.GetSockAddr((struct sockaddr*)&sockaddr, &socklen)) {\n          char name[1025] = \"\";\n          if (!getnameinfo((const struct sockaddr*)&sockaddr, socklen, name, sizeof(name), NULL, 0, NI_NUMERICHOST))\n              return std::string(name);\n      }\n      if (IsIPv4())\n          return strprintf(\"%u.%u.%u.%u\", GetByte(3), GetByte(2), GetByte(1), GetByte(0));\n      else\n          return strprintf(\"%x:%x:%x:%x:%x:%x:%x:%x\",\n                           GetByte(15) << 8 | GetByte(14), GetByte(13) << 8 | GetByte(12),\n                           GetByte(11) << 8 | GetByte(10), GetByte(9) << 8 | GetByte(8),\n                           GetByte(7) << 8 | GetByte(6), GetByte(5) << 8 | GetByte(4),\n                           GetByte(3) << 8 | GetByte(2), GetByte(1) << 8 | GetByte(0));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"fUseProxy\"",
            "false"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "fMinimizeOnClose"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"fUseUPnP\"",
            "GetBoolArg(\"-upnp\", true)"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetBoolArg",
          "args": [
            "\"-upnp\"",
            "true"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "GetBoolArg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "569-578",
          "snippet": "bool GetBoolArg(const std::string& strArg, bool fDefault)\n{\n    if (mapArgs.count(strArg))\n    {\n        if (mapArgs[strArg].empty())\n            return true;\n        return (atoi(mapArgs[strArg]) != 0);\n    }\n    return fDefault;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "map<string, string> mapArgs;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nbool GetBoolArg(const std::string& strArg, bool fDefault)\n{\n    if (mapArgs.count(strArg))\n    {\n        if (mapArgs[strArg].empty())\n            return true;\n        return (atoi(mapArgs[strArg]) != 0);\n    }\n    return fDefault;\n}"
        }
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "fMinimizeToTray"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "GUIUtil::GetStartOnSystemStartup()"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::GetStartOnSystemStartup",
          "args": [],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "GetStartOnSystemStartup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "412-412",
          "snippet": "bool GetStartOnSystemStartup() { return false; }",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool GetStartOnSystemStartup() { return false; }"
        }
      },
      {
        "call_info": {
          "callee": "index.row",
          "args": [],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  QVariant OptionsModel::data(const QModelIndex & index, int role) const\n  {\n      if(role == Qt::EditRole)\n      {\n          QSettings settings;\n          switch(index.row())\n          {\n          case StartAtStartup:\n              return QVariant(GUIUtil::GetStartOnSystemStartup());\n          case MinimizeToTray:\n              return QVariant(fMinimizeToTray);\n          case MapPortUPnP:\n              return settings.value(\"fUseUPnP\", GetBoolArg(\"-upnp\", true));\n          case MinimizeOnClose:\n              return QVariant(fMinimizeOnClose);\n          case ProxyUse:\n              return settings.value(\"fUseProxy\", false);\n          case ProxyIP: {\n              proxyType proxy;\n              if (GetProxy(NET_IPV4, proxy))\n                  return QVariant(QString::fromStdString(proxy.first.ToStringIP()));\n              else\n                  return QVariant(QString::fromStdString(\"127.0.0.1\"));\n          }\n          case ProxyPort: {\n              proxyType proxy;\n              if (GetProxy(NET_IPV4, proxy))\n                  return QVariant(proxy.first.GetPort());\n              else\n                  return QVariant(9050);\n          }\n          case ProxySocksVersion:\n              return settings.value(\"nSocksVersion\", 5);\n          case Fee:\n              return QVariant((qint64) nTransactionFee);\n          case ReserveBalance:\n              return QVariant((qint64) nReserveBalance);\n          case DisplayUnit:\n              return QVariant(nDisplayUnit);\n          case DisplayAddresses:\n              return QVariant(bDisplayAddresses);\n          case DetachDatabases:\n              return QVariant(bitdb.GetDetach());\n          case Language:\n              return settings.value(\"language\", \"\");\n          case CoinControlFeatures:\n              return QVariant(fCoinControlFeatures);\n          default:\n              return QVariant();\n          }\n      }\n      return QVariant();\n  }\n}"
  },
  {
    "function_name": "rowCount",
    "container": "OptionsModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "127-130",
    "snippet": "int OptionsModel::rowCount(const QModelIndex & parent) const\n{\n    return OptionIDRowCount;\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  int OptionsModel::rowCount(const QModelIndex & parent) const\n  {\n      return OptionIDRowCount;\n  }\n}"
  },
  {
    "function_name": "Upgrade",
    "container": "OptionsModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "67-124",
    "snippet": "bool OptionsModel::Upgrade()\n{\n    QSettings settings;\n\n    if (settings.contains(\"bImportFinished\"))\n        return false; // Already upgraded\n\n    settings.setValue(\"bImportFinished\", true);\n\n    // Move settings from old wallet.dat (if any):\n    CWalletDB walletdb(strWalletFileName);\n\n    QList<QString> intOptions;\n    intOptions << \"nDisplayUnit\" << \"nTransactionFee\" << \"nReserveBalance\";\n    foreach(QString key, intOptions)\n    {\n        int value = 0;\n        if (walletdb.ReadSetting(key.toStdString(), value))\n        {\n            settings.setValue(key, value);\n            walletdb.EraseSetting(key.toStdString());\n        }\n    }\n    QList<QString> boolOptions;\n    boolOptions << \"bDisplayAddresses\" << \"fMinimizeToTray\" << \"fMinimizeOnClose\" << \"fUseProxy\" << \"fUseUPnP\";\n    foreach(QString key, boolOptions)\n    {\n        bool value = false;\n        if (walletdb.ReadSetting(key.toStdString(), value))\n        {\n            settings.setValue(key, value);\n            walletdb.EraseSetting(key.toStdString());\n        }\n    }\n    try\n    {\n        CAddress addrProxyAddress;\n        if (walletdb.ReadSetting(\"addrProxy\", addrProxyAddress))\n        {\n            settings.setValue(\"addrProxy\", addrProxyAddress.ToStringIPPort().c_str());\n            walletdb.EraseSetting(\"addrProxy\");\n        }\n    }\n    catch (std::ios_base::failure &e)\n    {\n        // 0.6.0rc1 saved this as a CService, which causes failure when parsing as a CAddress\n        CService addrProxy;\n        if (walletdb.ReadSetting(\"addrProxy\", addrProxy))\n        {\n            settings.setValue(\"addrProxy\", addrProxy.ToStringIPPort().c_str());\n            walletdb.EraseSetting(\"addrProxy\");\n        }\n    }\n    ApplyProxySettings();\n    Init();\n\n    return true;\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "OptionsModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
          "lines": "39-65",
          "snippet": "void OptionsModel::Init()\n{\n    QSettings settings;\n\n    // These are Qt-only settings:\n    nDisplayUnit = settings.value(\"nDisplayUnit\", BitcoinUnits::BTC).toInt();\n    bDisplayAddresses = settings.value(\"bDisplayAddresses\", false).toBool();\n    fMinimizeToTray = settings.value(\"fMinimizeToTray\", false).toBool();\n    fMinimizeOnClose = settings.value(\"fMinimizeOnClose\", false).toBool();\n    fCoinControlFeatures = settings.value(\"fCoinControlFeatures\", false).toBool();\n    nTransactionFee = settings.value(\"nTransactionFee\").toLongLong();\n    nReserveBalance = settings.value(\"nReserveBalance\").toLongLong();\n    language = settings.value(\"language\", \"\").toString();\n\n    // These are shared with core Bitcoin; we want\n    // command-line options to override the GUI settings:\n    if (settings.contains(\"fUseUPnP\"))\n        SoftSetBoolArg(\"-upnp\", settings.value(\"fUseUPnP\").toBool());\n    if (settings.contains(\"addrProxy\") && settings.value(\"fUseProxy\").toBool())\n        SoftSetArg(\"-proxy\", settings.value(\"addrProxy\").toString().toStdString());\n    if (settings.contains(\"nSocksVersion\") && settings.value(\"fUseProxy\").toBool())\n        SoftSetArg(\"-socks\", settings.value(\"nSocksVersion\").toString().toStdString());\n    if (settings.contains(\"detachDB\"))\n        SoftSetBoolArg(\"-detachdb\", settings.value(\"detachDB\").toBool());\n    if (!language.isEmpty())\n        SoftSetArg(\"-lang\", language.toStdString());\n}",
          "includes": [
            "#include \"guiutil.h\"",
            "#include \"walletdb.h\"",
            "#include \"init.h\"",
            "#include <QSettings>",
            "#include \"bitcoinunits.h\"",
            "#include \"optionsmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  void OptionsModel::Init()\n  {\n      QSettings settings;\n  \n      // These are Qt-only settings:\n      nDisplayUnit = settings.value(\"nDisplayUnit\", BitcoinUnits::BTC).toInt();\n      bDisplayAddresses = settings.value(\"bDisplayAddresses\", false).toBool();\n      fMinimizeToTray = settings.value(\"fMinimizeToTray\", false).toBool();\n      fMinimizeOnClose = settings.value(\"fMinimizeOnClose\", false).toBool();\n      fCoinControlFeatures = settings.value(\"fCoinControlFeatures\", false).toBool();\n      nTransactionFee = settings.value(\"nTransactionFee\").toLongLong();\n      nReserveBalance = settings.value(\"nReserveBalance\").toLongLong();\n      language = settings.value(\"language\", \"\").toString();\n  \n      // These are shared with core Bitcoin; we want\n      // command-line options to override the GUI settings:\n      if (settings.contains(\"fUseUPnP\"))\n          SoftSetBoolArg(\"-upnp\", settings.value(\"fUseUPnP\").toBool());\n      if (settings.contains(\"addrProxy\") && settings.value(\"fUseProxy\").toBool())\n          SoftSetArg(\"-proxy\", settings.value(\"addrProxy\").toString().toStdString());\n      if (settings.contains(\"nSocksVersion\") && settings.value(\"fUseProxy\").toBool())\n          SoftSetArg(\"-socks\", settings.value(\"nSocksVersion\").toString().toStdString());\n      if (settings.contains(\"detachDB\"))\n          SoftSetBoolArg(\"-detachdb\", settings.value(\"detachDB\").toBool());\n      if (!language.isEmpty())\n          SoftSetArg(\"-lang\", language.toStdString());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ApplyProxySettings",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "ApplyProxySettings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
          "lines": "15-37",
          "snippet": "bool static ApplyProxySettings()\n{\n    QSettings settings;\n    CService addrProxy(settings.value(\"addrProxy\", \"127.0.0.1:9050\").toString().toStdString());\n    int nSocksVersion(settings.value(\"nSocksVersion\", 5).toInt());\n    if (!settings.value(\"fUseProxy\", false).toBool()) {\n        addrProxy = CService();\n        nSocksVersion = 0;\n        return false;\n    }\n    if (nSocksVersion && !addrProxy.IsValid())\n        return false;\n    if (!IsLimited(NET_IPV4))\n        SetProxy(NET_IPV4, addrProxy, nSocksVersion);\n    if (nSocksVersion > 4) {\n#ifdef USE_IPV6\n        if (!IsLimited(NET_IPV6))\n            SetProxy(NET_IPV6, addrProxy, nSocksVersion);\n#endif\n        SetNameProxy(addrProxy, nSocksVersion);\n    }\n    return true;\n}",
          "includes": [
            "#include \"guiutil.h\"",
            "#include \"walletdb.h\"",
            "#include \"init.h\"",
            "#include <QSettings>",
            "#include \"bitcoinunits.h\"",
            "#include \"optionsmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nbool static ApplyProxySettings()\n{\n    QSettings settings;\n    CService addrProxy(settings.value(\"addrProxy\", \"127.0.0.1:9050\").toString().toStdString());\n    int nSocksVersion(settings.value(\"nSocksVersion\", 5).toInt());\n    if (!settings.value(\"fUseProxy\", false).toBool()) {\n        addrProxy = CService();\n        nSocksVersion = 0;\n        return false;\n    }\n    if (nSocksVersion && !addrProxy.IsValid())\n        return false;\n    if (!IsLimited(NET_IPV4))\n        SetProxy(NET_IPV4, addrProxy, nSocksVersion);\n    if (nSocksVersion > 4) {\n#ifdef USE_IPV6\n        if (!IsLimited(NET_IPV6))\n            SetProxy(NET_IPV6, addrProxy, nSocksVersion);\n#endif\n        SetNameProxy(addrProxy, nSocksVersion);\n    }\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "walletdb.EraseSetting",
          "args": [
            "\"addrProxy\""
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "EraseSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "178-182",
          "snippet": "bool EraseSetting(const std::string& strKey)\n    {\n        nWalletDBUpdated++;\n        return Erase(std::make_pair(std::string(\"setting\"), strKey));\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool EraseSetting(const std::string& strKey)\n      {\n          nWalletDBUpdated++;\n          return Erase(std::make_pair(std::string(\"setting\"), strKey));\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"addrProxy\"",
            "addrProxy.ToStringIPPort().c_str()"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addrProxy.ToStringIPPort",
          "args": [],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "ToStringIPPort",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1163-1170",
          "snippet": "std::string CService::ToStringIPPort() const\n{\n    if (IsIPv4() || IsTor() || IsI2P()) {\n        return ToStringIP() + \":\" + ToStringPort();\n    } else {\n        return \"[\" + ToStringIP() + \"]:\" + ToStringPort();\n    }\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToStringIPPort() const\n  {\n      if (IsIPv4() || IsTor() || IsI2P()) {\n          return ToStringIP() + \":\" + ToStringPort();\n      } else {\n          return \"[\" + ToStringIP() + \"]:\" + ToStringPort();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "walletdb.ReadSetting",
          "args": [
            "\"addrProxy\"",
            "addrProxy"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "ReadSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "168-171",
          "snippet": "bool ReadSetting(const std::string& strKey, T& value)\n    {\n        return Read(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool ReadSetting(const std::string& strKey, T& value)\n      {\n          return Read(std::make_pair(std::string(\"setting\"), strKey), value);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"addrProxy\"",
            "addrProxyAddress.ToStringIPPort().c_str()"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.toStdString",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "key",
            "value"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.toStdString",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.toStdString",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "key",
            "value"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.toStdString",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.setValue",
          "args": [
            "\"bImportFinished\"",
            "true"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.contains",
          "args": [
            "\"bImportFinished\""
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "contains",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "91-95",
          "snippet": "bool CBloomFilter::contains(const uint256& hash) const\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    return contains(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  bool CBloomFilter::contains(const uint256& hash) const\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      return contains(data);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  bool OptionsModel::Upgrade()\n  {\n      QSettings settings;\n  \n      if (settings.contains(\"bImportFinished\"))\n          return false; // Already upgraded\n  \n      settings.setValue(\"bImportFinished\", true);\n  \n      // Move settings from old wallet.dat (if any):\n      CWalletDB walletdb(strWalletFileName);\n  \n      QList<QString> intOptions;\n      intOptions << \"nDisplayUnit\" << \"nTransactionFee\" << \"nReserveBalance\";\n      foreach(QString key, intOptions)\n      {\n          int value = 0;\n          if (walletdb.ReadSetting(key.toStdString(), value))\n          {\n              settings.setValue(key, value);\n              walletdb.EraseSetting(key.toStdString());\n          }\n      }\n      QList<QString> boolOptions;\n      boolOptions << \"bDisplayAddresses\" << \"fMinimizeToTray\" << \"fMinimizeOnClose\" << \"fUseProxy\" << \"fUseUPnP\";\n      foreach(QString key, boolOptions)\n      {\n          bool value = false;\n          if (walletdb.ReadSetting(key.toStdString(), value))\n          {\n              settings.setValue(key, value);\n              walletdb.EraseSetting(key.toStdString());\n          }\n      }\n      try\n      {\n          CAddress addrProxyAddress;\n          if (walletdb.ReadSetting(\"addrProxy\", addrProxyAddress))\n          {\n              settings.setValue(\"addrProxy\", addrProxyAddress.ToStringIPPort().c_str());\n              walletdb.EraseSetting(\"addrProxy\");\n          }\n      }\n      catch (std::ios_base::failure &e)\n      {\n          // 0.6.0rc1 saved this as a CService, which causes failure when parsing as a CAddress\n          CService addrProxy;\n          if (walletdb.ReadSetting(\"addrProxy\", addrProxy))\n          {\n              settings.setValue(\"addrProxy\", addrProxy.ToStringIPPort().c_str());\n              walletdb.EraseSetting(\"addrProxy\");\n          }\n      }\n      ApplyProxySettings();\n      Init();\n  \n      return true;\n  }\n}"
  },
  {
    "function_name": "Init",
    "container": "OptionsModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "39-65",
    "snippet": "void OptionsModel::Init()\n{\n    QSettings settings;\n\n    // These are Qt-only settings:\n    nDisplayUnit = settings.value(\"nDisplayUnit\", BitcoinUnits::BTC).toInt();\n    bDisplayAddresses = settings.value(\"bDisplayAddresses\", false).toBool();\n    fMinimizeToTray = settings.value(\"fMinimizeToTray\", false).toBool();\n    fMinimizeOnClose = settings.value(\"fMinimizeOnClose\", false).toBool();\n    fCoinControlFeatures = settings.value(\"fCoinControlFeatures\", false).toBool();\n    nTransactionFee = settings.value(\"nTransactionFee\").toLongLong();\n    nReserveBalance = settings.value(\"nReserveBalance\").toLongLong();\n    language = settings.value(\"language\", \"\").toString();\n\n    // These are shared with core Bitcoin; we want\n    // command-line options to override the GUI settings:\n    if (settings.contains(\"fUseUPnP\"))\n        SoftSetBoolArg(\"-upnp\", settings.value(\"fUseUPnP\").toBool());\n    if (settings.contains(\"addrProxy\") && settings.value(\"fUseProxy\").toBool())\n        SoftSetArg(\"-proxy\", settings.value(\"addrProxy\").toString().toStdString());\n    if (settings.contains(\"nSocksVersion\") && settings.value(\"fUseProxy\").toBool())\n        SoftSetArg(\"-socks\", settings.value(\"nSocksVersion\").toString().toStdString());\n    if (settings.contains(\"detachDB\"))\n        SoftSetBoolArg(\"-detachdb\", settings.value(\"detachDB\").toBool());\n    if (!language.isEmpty())\n        SoftSetArg(\"-lang\", language.toStdString());\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SoftSetArg",
          "args": [
            "\"-lang\"",
            "language.toStdString()"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "SoftSetArg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "580-586",
          "snippet": "bool SoftSetArg(const std::string& strArg, const std::string& strValue)\n{\n    if (mapArgs.count(strArg))\n        return false;\n    mapArgs[strArg] = strValue;\n    return true;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "map<string, string> mapArgs;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nmap<string, string> mapArgs;\n\nbool SoftSetArg(const std::string& strArg, const std::string& strValue)\n{\n    if (mapArgs.count(strArg))\n        return false;\n    mapArgs[strArg] = strValue;\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "language.toStdString",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "language.isEmpty",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SoftSetBoolArg",
          "args": [
            "\"-detachdb\"",
            "settings.value(\"detachDB\").toBool()"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "SoftSetBoolArg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "588-594",
          "snippet": "bool SoftSetBoolArg(const std::string& strArg, bool fValue)\n{\n    if (fValue)\n        return SoftSetArg(strArg, std::string(\"1\"));\n    else\n        return SoftSetArg(strArg, std::string(\"0\"));\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nbool SoftSetBoolArg(const std::string& strArg, bool fValue)\n{\n    if (fValue)\n        return SoftSetArg(strArg, std::string(\"1\"));\n    else\n        return SoftSetArg(strArg, std::string(\"0\"));\n}"
        }
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QValueComboBox",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qvaluecombobox.cpp",
          "lines": "9-12",
          "snippet": "QVariant QValueComboBox::value() const\n{\n    return itemData(currentIndex(), role);\n}",
          "includes": [
            "#include \"qvaluecombobox.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qvaluecombobox.h\"\n\nQValueComboBox {\n  QVariant QValueComboBox::value() const\n  {\n      return itemData(currentIndex(), role);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"detachDB\""
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "118-127",
          "snippet": "qint64 BitcoinAmountField::value(bool *valid_out) const\n{\n    qint64 val_out = 0;\n    bool valid = BitcoinUnits::parse(currentUnit, text(), &val_out);\n    if(valid_out)\n    {\n        *valid_out = valid;\n    }\n    return val_out;\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  qint64 BitcoinAmountField::value(bool *valid_out) const\n  {\n      qint64 val_out = 0;\n      bool valid = BitcoinUnits::parse(currentUnit, text(), &val_out);\n      if(valid_out)\n      {\n          *valid_out = valid;\n      }\n      return val_out;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "settings.contains",
          "args": [
            "\"detachDB\""
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "contains",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "91-95",
          "snippet": "bool CBloomFilter::contains(const uint256& hash) const\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    return contains(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  bool CBloomFilter::contains(const uint256& hash) const\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      return contains(data);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"language\"",
            "\"\""
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"fCoinControlFeatures\"",
            "false"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"fMinimizeOnClose\"",
            "false"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"fMinimizeToTray\"",
            "false"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"bDisplayAddresses\"",
            "false"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"nDisplayUnit\"",
            "BitcoinUnits::BTC"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  void OptionsModel::Init()\n  {\n      QSettings settings;\n  \n      // These are Qt-only settings:\n      nDisplayUnit = settings.value(\"nDisplayUnit\", BitcoinUnits::BTC).toInt();\n      bDisplayAddresses = settings.value(\"bDisplayAddresses\", false).toBool();\n      fMinimizeToTray = settings.value(\"fMinimizeToTray\", false).toBool();\n      fMinimizeOnClose = settings.value(\"fMinimizeOnClose\", false).toBool();\n      fCoinControlFeatures = settings.value(\"fCoinControlFeatures\", false).toBool();\n      nTransactionFee = settings.value(\"nTransactionFee\").toLongLong();\n      nReserveBalance = settings.value(\"nReserveBalance\").toLongLong();\n      language = settings.value(\"language\", \"\").toString();\n  \n      // These are shared with core Bitcoin; we want\n      // command-line options to override the GUI settings:\n      if (settings.contains(\"fUseUPnP\"))\n          SoftSetBoolArg(\"-upnp\", settings.value(\"fUseUPnP\").toBool());\n      if (settings.contains(\"addrProxy\") && settings.value(\"fUseProxy\").toBool())\n          SoftSetArg(\"-proxy\", settings.value(\"addrProxy\").toString().toStdString());\n      if (settings.contains(\"nSocksVersion\") && settings.value(\"fUseProxy\").toBool())\n          SoftSetArg(\"-socks\", settings.value(\"nSocksVersion\").toString().toStdString());\n      if (settings.contains(\"detachDB\"))\n          SoftSetBoolArg(\"-detachdb\", settings.value(\"detachDB\").toBool());\n      if (!language.isEmpty())\n          SoftSetArg(\"-lang\", language.toStdString());\n  }\n}"
  },
  {
    "function_name": "ApplyProxySettings",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "15-37",
    "snippet": "bool static ApplyProxySettings()\n{\n    QSettings settings;\n    CService addrProxy(settings.value(\"addrProxy\", \"127.0.0.1:9050\").toString().toStdString());\n    int nSocksVersion(settings.value(\"nSocksVersion\", 5).toInt());\n    if (!settings.value(\"fUseProxy\", false).toBool()) {\n        addrProxy = CService();\n        nSocksVersion = 0;\n        return false;\n    }\n    if (nSocksVersion && !addrProxy.IsValid())\n        return false;\n    if (!IsLimited(NET_IPV4))\n        SetProxy(NET_IPV4, addrProxy, nSocksVersion);\n    if (nSocksVersion > 4) {\n#ifdef USE_IPV6\n        if (!IsLimited(NET_IPV6))\n            SetProxy(NET_IPV6, addrProxy, nSocksVersion);\n#endif\n        SetNameProxy(addrProxy, nSocksVersion);\n    }\n    return true;\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetNameProxy",
          "args": [
            "addrProxy",
            "nSocksVersion"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "SetNameProxy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "452-460",
          "snippet": "bool SetNameProxy(CService addrProxy, int nSocksVersion) {\n    if (nSocksVersion != 0 && nSocksVersion != 5)\n        return false;\n    if (nSocksVersion != 0 && !addrProxy.IsValid())\n        return false;\n    LOCK(cs_proxyInfos);\n    nameproxyInfo = std::make_pair(addrProxy, nSocksVersion);\n    return true;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static proxyType nameproxyInfo;",
            "static CCriticalSection cs_proxyInfos;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nstatic proxyType nameproxyInfo;\nstatic CCriticalSection cs_proxyInfos;\n\nbool SetNameProxy(CService addrProxy, int nSocksVersion) {\n    if (nSocksVersion != 0 && nSocksVersion != 5)\n        return false;\n    if (nSocksVersion != 0 && !addrProxy.IsValid())\n        return false;\n    LOCK(cs_proxyInfos);\n    nameproxyInfo = std::make_pair(addrProxy, nSocksVersion);\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetProxy",
          "args": [
            "NET_IPV6",
            "addrProxy",
            "nSocksVersion"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "SetProxy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "432-441",
          "snippet": "bool SetProxy(enum Network net, CService addrProxy, int nSocksVersion) {\n    assert(net >= 0 && net < NET_MAX);\n    if (nSocksVersion != 0 && nSocksVersion != 4 && nSocksVersion != 5)\n        return false;\n    if (nSocksVersion != 0 && !addrProxy.IsValid())\n        return false;\n    LOCK(cs_proxyInfos);\n    proxyInfo[net] = std::make_pair(addrProxy, nSocksVersion);\n    return true;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static proxyType proxyInfo[NET_MAX];",
            "static CCriticalSection cs_proxyInfos;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nstatic proxyType proxyInfo[NET_MAX];\nstatic CCriticalSection cs_proxyInfos;\n\nbool SetProxy(enum Network net, CService addrProxy, int nSocksVersion) {\n    assert(net >= 0 && net < NET_MAX);\n    if (nSocksVersion != 0 && nSocksVersion != 4 && nSocksVersion != 5)\n        return false;\n    if (nSocksVersion != 0 && !addrProxy.IsValid())\n        return false;\n    LOCK(cs_proxyInfos);\n    proxyInfo[net] = std::make_pair(addrProxy, nSocksVersion);\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsLimited",
          "args": [
            "NET_IPV6"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "IsLimited",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.cpp",
          "lines": "272-275",
          "snippet": "bool IsLimited(const CNetAddr &addr)\n{\n    return IsLimited(addr.GetNetwork());\n}",
          "includes": [
            "#include <miniupnpc/upnperrors.h>",
            "#include <miniupnpc/upnpcommands.h>",
            "#include <miniupnpc/miniupnpc.h>",
            "#include <miniupnpc/miniwget.h>",
            "#include <string.h>",
            "#include \"ui_interface.h\"",
            "#include \"addrman.h\"",
            "#include \"strlcpy.h\"",
            "#include \"init.h\"",
            "#include \"ntp.h\"",
            "#include \"net.h\"",
            "#include \"db.h\"",
            "#include \"irc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <miniupnpc/upnperrors.h>\n#include <miniupnpc/upnpcommands.h>\n#include <miniupnpc/miniupnpc.h>\n#include <miniupnpc/miniwget.h>\n#include <string.h>\n#include \"ui_interface.h\"\n#include \"addrman.h\"\n#include \"strlcpy.h\"\n#include \"init.h\"\n#include \"ntp.h\"\n#include \"net.h\"\n#include \"db.h\"\n#include \"irc.h\"\n\nbool IsLimited(const CNetAddr &addr)\n{\n    return IsLimited(addr.GetNetwork());\n}"
        }
      },
      {
        "call_info": {
          "callee": "addrProxy.IsValid",
          "args": [],
          "line": 25
        },
        "resolved": true,
        "details": {
          "function_name": "IsValid",
          "container": "CNetAddr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "725-759",
          "snippet": "bool CNetAddr::IsValid() const\n{\n    // Cleanup 3-byte shifted addresses caused by garbage in size field\n    // of addr messages from versions before 0.2.9 checksum.\n    // Two consecutive addr messages look like this:\n    // header20 vectorlen3 addr26 addr26 addr26 header20 vectorlen3 addr26 addr26 addr26...\n    // so if the first length field is garbled, it reads the second batch\n    // of addr misaligned by 3 bytes.\n    if (memcmp(ip, pchIPv4+3, sizeof(pchIPv4)-3) == 0)\n        return false;\n\n    // unspecified IPv6 address (::/128)\n    unsigned char ipNone[16] = {};\n    if (memcmp(ip, ipNone, 16) == 0)\n        return false;\n\n    // documentation IPv6 address\n    if (IsRFC3849())\n        return false;\n\n    if (IsIPv4())\n    {\n        // INADDR_NONE\n        uint32_t ipNone = INADDR_NONE;\n        if (memcmp(ip+12, &ipNone, 4) == 0)\n            return false;\n\n        // 0\n        ipNone = 0;\n        if (memcmp(ip+12, &ipNone, 4) == 0)\n            return false;\n    }\n\n    return true;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const unsigned char pchIPv4[12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nstatic const unsigned char pchIPv4[12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff };\n\nCNetAddr {\n  bool CNetAddr::IsValid() const\n  {\n      // Cleanup 3-byte shifted addresses caused by garbage in size field\n      // of addr messages from versions before 0.2.9 checksum.\n      // Two consecutive addr messages look like this:\n      // header20 vectorlen3 addr26 addr26 addr26 header20 vectorlen3 addr26 addr26 addr26...\n      // so if the first length field is garbled, it reads the second batch\n      // of addr misaligned by 3 bytes.\n      if (memcmp(ip, pchIPv4+3, sizeof(pchIPv4)-3) == 0)\n          return false;\n  \n      // unspecified IPv6 address (::/128)\n      unsigned char ipNone[16] = {};\n      if (memcmp(ip, ipNone, 16) == 0)\n          return false;\n  \n      // documentation IPv6 address\n      if (IsRFC3849())\n          return false;\n  \n      if (IsIPv4())\n      {\n          // INADDR_NONE\n          uint32_t ipNone = INADDR_NONE;\n          if (memcmp(ip+12, &ipNone, 4) == 0)\n              return false;\n  \n          // 0\n          ipNone = 0;\n          if (memcmp(ip+12, &ipNone, 4) == 0)\n              return false;\n      }\n  \n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CService",
          "args": [],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "print",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1177-1180",
          "snippet": "void CService::print() const\n{\n    printf(\"CService(%s)\\n\", ToString().c_str());\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  void CService::print() const\n  {\n      printf(\"CService(%s)\\n\", ToString().c_str());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [],
          "line": 20
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QValueComboBox",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qvaluecombobox.cpp",
          "lines": "9-12",
          "snippet": "QVariant QValueComboBox::value() const\n{\n    return itemData(currentIndex(), role);\n}",
          "includes": [
            "#include \"qvaluecombobox.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qvaluecombobox.h\"\n\nQValueComboBox {\n  QVariant QValueComboBox::value() const\n  {\n      return itemData(currentIndex(), role);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"fUseProxy\"",
            "false"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"nSocksVersion\"",
            "5"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "settings.value",
          "args": [
            "\"addrProxy\"",
            "\"127.0.0.1:9050\""
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nbool static ApplyProxySettings()\n{\n    QSettings settings;\n    CService addrProxy(settings.value(\"addrProxy\", \"127.0.0.1:9050\").toString().toStdString());\n    int nSocksVersion(settings.value(\"nSocksVersion\", 5).toInt());\n    if (!settings.value(\"fUseProxy\", false).toBool()) {\n        addrProxy = CService();\n        nSocksVersion = 0;\n        return false;\n    }\n    if (nSocksVersion && !addrProxy.IsValid())\n        return false;\n    if (!IsLimited(NET_IPV4))\n        SetProxy(NET_IPV4, addrProxy, nSocksVersion);\n    if (nSocksVersion > 4) {\n#ifdef USE_IPV6\n        if (!IsLimited(NET_IPV6))\n            SetProxy(NET_IPV6, addrProxy, nSocksVersion);\n#endif\n        SetNameProxy(addrProxy, nSocksVersion);\n    }\n    return true;\n}"
  },
  {
    "function_name": "OptionsModel",
    "container": "OptionsModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
    "lines": "9-13",
    "snippet": "OptionsModel::OptionsModel(QObject *parent) :\n    QAbstractListModel(parent)\n{\n    Init();\n}",
    "includes": [
      "#include \"guiutil.h\"",
      "#include \"walletdb.h\"",
      "#include \"init.h\"",
      "#include <QSettings>",
      "#include \"bitcoinunits.h\"",
      "#include \"optionsmodel.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [],
          "line": 12
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "OptionsModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/optionsmodel.cpp",
          "lines": "39-65",
          "snippet": "void OptionsModel::Init()\n{\n    QSettings settings;\n\n    // These are Qt-only settings:\n    nDisplayUnit = settings.value(\"nDisplayUnit\", BitcoinUnits::BTC).toInt();\n    bDisplayAddresses = settings.value(\"bDisplayAddresses\", false).toBool();\n    fMinimizeToTray = settings.value(\"fMinimizeToTray\", false).toBool();\n    fMinimizeOnClose = settings.value(\"fMinimizeOnClose\", false).toBool();\n    fCoinControlFeatures = settings.value(\"fCoinControlFeatures\", false).toBool();\n    nTransactionFee = settings.value(\"nTransactionFee\").toLongLong();\n    nReserveBalance = settings.value(\"nReserveBalance\").toLongLong();\n    language = settings.value(\"language\", \"\").toString();\n\n    // These are shared with core Bitcoin; we want\n    // command-line options to override the GUI settings:\n    if (settings.contains(\"fUseUPnP\"))\n        SoftSetBoolArg(\"-upnp\", settings.value(\"fUseUPnP\").toBool());\n    if (settings.contains(\"addrProxy\") && settings.value(\"fUseProxy\").toBool())\n        SoftSetArg(\"-proxy\", settings.value(\"addrProxy\").toString().toStdString());\n    if (settings.contains(\"nSocksVersion\") && settings.value(\"fUseProxy\").toBool())\n        SoftSetArg(\"-socks\", settings.value(\"nSocksVersion\").toString().toStdString());\n    if (settings.contains(\"detachDB\"))\n        SoftSetBoolArg(\"-detachdb\", settings.value(\"detachDB\").toBool());\n    if (!language.isEmpty())\n        SoftSetArg(\"-lang\", language.toStdString());\n}",
          "includes": [
            "#include \"guiutil.h\"",
            "#include \"walletdb.h\"",
            "#include \"init.h\"",
            "#include <QSettings>",
            "#include \"bitcoinunits.h\"",
            "#include \"optionsmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  void OptionsModel::Init()\n  {\n      QSettings settings;\n  \n      // These are Qt-only settings:\n      nDisplayUnit = settings.value(\"nDisplayUnit\", BitcoinUnits::BTC).toInt();\n      bDisplayAddresses = settings.value(\"bDisplayAddresses\", false).toBool();\n      fMinimizeToTray = settings.value(\"fMinimizeToTray\", false).toBool();\n      fMinimizeOnClose = settings.value(\"fMinimizeOnClose\", false).toBool();\n      fCoinControlFeatures = settings.value(\"fCoinControlFeatures\", false).toBool();\n      nTransactionFee = settings.value(\"nTransactionFee\").toLongLong();\n      nReserveBalance = settings.value(\"nReserveBalance\").toLongLong();\n      language = settings.value(\"language\", \"\").toString();\n  \n      // These are shared with core Bitcoin; we want\n      // command-line options to override the GUI settings:\n      if (settings.contains(\"fUseUPnP\"))\n          SoftSetBoolArg(\"-upnp\", settings.value(\"fUseUPnP\").toBool());\n      if (settings.contains(\"addrProxy\") && settings.value(\"fUseProxy\").toBool())\n          SoftSetArg(\"-proxy\", settings.value(\"addrProxy\").toString().toStdString());\n      if (settings.contains(\"nSocksVersion\") && settings.value(\"fUseProxy\").toBool())\n          SoftSetArg(\"-socks\", settings.value(\"nSocksVersion\").toString().toStdString());\n      if (settings.contains(\"detachDB\"))\n          SoftSetBoolArg(\"-detachdb\", settings.value(\"detachDB\").toBool());\n      if (!language.isEmpty())\n          SoftSetArg(\"-lang\", language.toStdString());\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"guiutil.h\"\n#include \"walletdb.h\"\n#include \"init.h\"\n#include <QSettings>\n#include \"bitcoinunits.h\"\n#include \"optionsmodel.h\"\n\nOptionsModel {\n  OptionsModel::OptionsModel(QObject *parent) :\n      QAbstractListModel(parent)\n  {\n      Init();\n  }\n}"
  }
]