[
  {
    "function_name": "leveldb_minor_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "591-593",
    "snippet": "int leveldb_minor_version() {\n  return kMinorVersion;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nint leveldb_minor_version() {\n  return kMinorVersion;\n}"
  },
  {
    "function_name": "leveldb_major_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "587-589",
    "snippet": "int leveldb_major_version() {\n  return kMajorVersion;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nint leveldb_major_version() {\n  return kMajorVersion;\n}"
  },
  {
    "function_name": "leveldb_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "583-585",
    "snippet": "void leveldb_free(void* ptr) {\n  free(ptr);\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ptr"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "leveldb_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "583-585",
          "snippet": "void leveldb_free(void* ptr) {\n  free(ptr);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_free(void* ptr) {\n  free(ptr);\n}"
  },
  {
    "function_name": "leveldb_env_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "578-581",
    "snippet": "void leveldb_env_destroy(leveldb_env_t* env) {\n  if (!env->is_default) delete env->rep;\n  delete env;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_env_destroy(leveldb_env_t* env) {\n  if (!env->is_default) delete env->rep;\n  delete env;\n}"
  },
  {
    "function_name": "leveldb_cache_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "566-569",
    "snippet": "void leveldb_cache_destroy(leveldb_cache_t* cache) {\n  delete cache->rep;\n  delete cache;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_cache_destroy(leveldb_cache_t* cache) {\n  delete cache->rep;\n  delete cache;\n}"
  },
  {
    "function_name": "leveldb_writeoptions_set_sync",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "555-558",
    "snippet": "void leveldb_writeoptions_set_sync(\n    leveldb_writeoptions_t* opt, unsigned char v) {\n  opt->rep.sync = v;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_writeoptions_set_sync(\n    leveldb_writeoptions_t* opt, unsigned char v) {\n  opt->rep.sync = v;\n}"
  },
  {
    "function_name": "leveldb_writeoptions_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "551-553",
    "snippet": "void leveldb_writeoptions_destroy(leveldb_writeoptions_t* opt) {\n  delete opt;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_writeoptions_destroy(leveldb_writeoptions_t* opt) {\n  delete opt;\n}"
  },
  {
    "function_name": "leveldb_readoptions_set_snapshot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "541-545",
    "snippet": "void leveldb_readoptions_set_snapshot(\n    leveldb_readoptions_t* opt,\n    const leveldb_snapshot_t* snap) {\n  opt->rep.snapshot = (snap ? snap->rep : NULL);\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_readoptions_set_snapshot(\n    leveldb_readoptions_t* opt,\n    const leveldb_snapshot_t* snap) {\n  opt->rep.snapshot = (snap ? snap->rep : NULL);\n}"
  },
  {
    "function_name": "leveldb_readoptions_set_fill_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "536-539",
    "snippet": "void leveldb_readoptions_set_fill_cache(\n    leveldb_readoptions_t* opt, unsigned char v) {\n  opt->rep.fill_cache = v;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_readoptions_set_fill_cache(\n    leveldb_readoptions_t* opt, unsigned char v) {\n  opt->rep.fill_cache = v;\n}"
  },
  {
    "function_name": "leveldb_readoptions_set_verify_checksums",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "530-534",
    "snippet": "void leveldb_readoptions_set_verify_checksums(\n    leveldb_readoptions_t* opt,\n    unsigned char v) {\n  opt->rep.verify_checksums = v;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_readoptions_set_verify_checksums(\n    leveldb_readoptions_t* opt,\n    unsigned char v) {\n  opt->rep.verify_checksums = v;\n}"
  },
  {
    "function_name": "leveldb_readoptions_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "526-528",
    "snippet": "void leveldb_readoptions_destroy(leveldb_readoptions_t* opt) {\n  delete opt;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_readoptions_destroy(leveldb_readoptions_t* opt) {\n  delete opt;\n}"
  },
  {
    "function_name": "leveldb_filterpolicy_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "495-497",
    "snippet": "void leveldb_filterpolicy_destroy(leveldb_filterpolicy_t* filter) {\n  delete filter;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_filterpolicy_destroy(leveldb_filterpolicy_t* filter) {\n  delete filter;\n}"
  },
  {
    "function_name": "leveldb_comparator_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "469-471",
    "snippet": "void leveldb_comparator_destroy(leveldb_comparator_t* cmp) {\n  delete cmp;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_comparator_destroy(leveldb_comparator_t* cmp) {\n  delete cmp;\n}"
  },
  {
    "function_name": "leveldb_options_set_compression",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "449-451",
    "snippet": "void leveldb_options_set_compression(leveldb_options_t* opt, int t) {\n  opt->rep.compression = static_cast<CompressionType>(t);\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<CompressionType>",
          "args": [
            "t"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_compression(leveldb_options_t* opt, int t) {\n  opt->rep.compression = static_cast<CompressionType>(t);\n}"
  },
  {
    "function_name": "leveldb_options_set_block_restart_interval",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "445-447",
    "snippet": "void leveldb_options_set_block_restart_interval(leveldb_options_t* opt, int n) {\n  opt->rep.block_restart_interval = n;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_block_restart_interval(leveldb_options_t* opt, int n) {\n  opt->rep.block_restart_interval = n;\n}"
  },
  {
    "function_name": "leveldb_options_set_block_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "441-443",
    "snippet": "void leveldb_options_set_block_size(leveldb_options_t* opt, size_t s) {\n  opt->rep.block_size = s;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_block_size(leveldb_options_t* opt, size_t s) {\n  opt->rep.block_size = s;\n}"
  },
  {
    "function_name": "leveldb_options_set_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "437-439",
    "snippet": "void leveldb_options_set_cache(leveldb_options_t* opt, leveldb_cache_t* c) {\n  opt->rep.block_cache = c->rep;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_cache(leveldb_options_t* opt, leveldb_cache_t* c) {\n  opt->rep.block_cache = c->rep;\n}"
  },
  {
    "function_name": "leveldb_options_set_max_open_files",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "433-435",
    "snippet": "void leveldb_options_set_max_open_files(leveldb_options_t* opt, int n) {\n  opt->rep.max_open_files = n;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_max_open_files(leveldb_options_t* opt, int n) {\n  opt->rep.max_open_files = n;\n}"
  },
  {
    "function_name": "leveldb_options_set_write_buffer_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "429-431",
    "snippet": "void leveldb_options_set_write_buffer_size(leveldb_options_t* opt, size_t s) {\n  opt->rep.write_buffer_size = s;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_write_buffer_size(leveldb_options_t* opt, size_t s) {\n  opt->rep.write_buffer_size = s;\n}"
  },
  {
    "function_name": "leveldb_options_set_info_log",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "425-427",
    "snippet": "void leveldb_options_set_info_log(leveldb_options_t* opt, leveldb_logger_t* l) {\n  opt->rep.info_log = (l ? l->rep : NULL);\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_info_log(leveldb_options_t* opt, leveldb_logger_t* l) {\n  opt->rep.info_log = (l ? l->rep : NULL);\n}"
  },
  {
    "function_name": "leveldb_options_set_env",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "421-423",
    "snippet": "void leveldb_options_set_env(leveldb_options_t* opt, leveldb_env_t* env) {\n  opt->rep.env = (env ? env->rep : NULL);\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_env(leveldb_options_t* opt, leveldb_env_t* env) {\n  opt->rep.env = (env ? env->rep : NULL);\n}"
  },
  {
    "function_name": "leveldb_options_set_paranoid_checks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "416-419",
    "snippet": "void leveldb_options_set_paranoid_checks(\n    leveldb_options_t* opt, unsigned char v) {\n  opt->rep.paranoid_checks = v;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_paranoid_checks(\n    leveldb_options_t* opt, unsigned char v) {\n  opt->rep.paranoid_checks = v;\n}"
  },
  {
    "function_name": "leveldb_options_set_error_if_exists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "411-414",
    "snippet": "void leveldb_options_set_error_if_exists(\n    leveldb_options_t* opt, unsigned char v) {\n  opt->rep.error_if_exists = v;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_error_if_exists(\n    leveldb_options_t* opt, unsigned char v) {\n  opt->rep.error_if_exists = v;\n}"
  },
  {
    "function_name": "leveldb_options_set_create_if_missing",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "406-409",
    "snippet": "void leveldb_options_set_create_if_missing(\n    leveldb_options_t* opt, unsigned char v) {\n  opt->rep.create_if_missing = v;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_create_if_missing(\n    leveldb_options_t* opt, unsigned char v) {\n  opt->rep.create_if_missing = v;\n}"
  },
  {
    "function_name": "leveldb_options_set_filter_policy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "400-404",
    "snippet": "void leveldb_options_set_filter_policy(\n    leveldb_options_t* opt,\n    leveldb_filterpolicy_t* policy) {\n  opt->rep.filter_policy = policy;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_filter_policy(\n    leveldb_options_t* opt,\n    leveldb_filterpolicy_t* policy) {\n  opt->rep.filter_policy = policy;\n}"
  },
  {
    "function_name": "leveldb_options_set_comparator",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "394-398",
    "snippet": "void leveldb_options_set_comparator(\n    leveldb_options_t* opt,\n    leveldb_comparator_t* cmp) {\n  opt->rep.comparator = cmp;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_comparator(\n    leveldb_options_t* opt,\n    leveldb_comparator_t* cmp) {\n  opt->rep.comparator = cmp;\n}"
  },
  {
    "function_name": "leveldb_options_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "390-392",
    "snippet": "void leveldb_options_destroy(leveldb_options_t* options) {\n  delete options;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_destroy(leveldb_options_t* options) {\n  delete options;\n}"
  },
  {
    "function_name": "leveldb_writebatch_iterate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "362-384",
    "snippet": "void leveldb_writebatch_iterate(\n    leveldb_writebatch_t* b,\n    void* state,\n    void (*put)(void*, const char* k, size_t klen, const char* v, size_t vlen),\n    void (*deleted)(void*, const char* k, size_t klen)) {\n  class H : public WriteBatch::Handler {\n   public:\n    void* state_;\n    void (*put_)(void*, const char* k, size_t klen, const char* v, size_t vlen);\n    void (*deleted_)(void*, const char* k, size_t klen);\n    virtual void Put(const Slice& key, const Slice& value) {\n      (*put_)(state_, key.data(), key.size(), value.data(), value.size());\n    }\n    virtual void Delete(const Slice& key) {\n      (*deleted_)(state_, key.data(), key.size());\n    }\n  };\n  H handler;\n  handler.state_ = state;\n  handler.put_ = put;\n  handler.deleted_ = deleted;\n  b->rep.Iterate(&handler);\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b->rep.Iterate",
          "args": [
            "&handler"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "Iterate",
          "container": "WriteBatch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "42-80",
          "snippet": "Status WriteBatch::Iterate(Handler* handler) const {\n  Slice input(rep_);\n  if (input.size() < kHeader) {\n    return Status::Corruption(\"malformed WriteBatch (too small)\");\n  }\n\n  input.remove_prefix(kHeader);\n  Slice key, value;\n  int found = 0;\n  while (!input.empty()) {\n    found++;\n    char tag = input[0];\n    input.remove_prefix(1);\n    switch (tag) {\n      case kTypeValue:\n        if (GetLengthPrefixedSlice(&input, &key) &&\n            GetLengthPrefixedSlice(&input, &value)) {\n          handler->Put(key, value);\n        } else {\n          return Status::Corruption(\"bad WriteBatch Put\");\n        }\n        break;\n      case kTypeDeletion:\n        if (GetLengthPrefixedSlice(&input, &key)) {\n          handler->Delete(key);\n        } else {\n          return Status::Corruption(\"bad WriteBatch Delete\");\n        }\n        break;\n      default:\n        return Status::Corruption(\"unknown WriteBatch tag\");\n    }\n  }\n  if (found != WriteBatchInternal::Count(this)) {\n    return Status::Corruption(\"WriteBatch has wrong count\");\n  } else {\n    return Status::OK();\n  }\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatch {\n  Status WriteBatch::Iterate(Handler* handler) const {\n    Slice input(rep_);\n    if (input.size() < kHeader) {\n      return Status::Corruption(\"malformed WriteBatch (too small)\");\n    }\n  \n    input.remove_prefix(kHeader);\n    Slice key, value;\n    int found = 0;\n    while (!input.empty()) {\n      found++;\n      char tag = input[0];\n      input.remove_prefix(1);\n      switch (tag) {\n        case kTypeValue:\n          if (GetLengthPrefixedSlice(&input, &key) &&\n              GetLengthPrefixedSlice(&input, &value)) {\n            handler->Put(key, value);\n          } else {\n            return Status::Corruption(\"bad WriteBatch Put\");\n          }\n          break;\n        case kTypeDeletion:\n          if (GetLengthPrefixedSlice(&input, &key)) {\n            handler->Delete(key);\n          } else {\n            return Status::Corruption(\"bad WriteBatch Delete\");\n          }\n          break;\n        default:\n          return Status::Corruption(\"unknown WriteBatch tag\");\n      }\n    }\n    if (found != WriteBatchInternal::Count(this)) {\n      return Status::Corruption(\"WriteBatch has wrong count\");\n    } else {\n      return Status::OK();\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "state_",
            "key.data()",
            "key.size()"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.size",
          "args": [],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "key.data",
          "args": [],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "state_",
            "key.data()",
            "key.size()",
            "value.data()",
            "value.size()"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.data",
          "args": [],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.data",
          "args": [],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_writebatch_iterate(\n    leveldb_writebatch_t* b,\n    void* state,\n    void (*put)(void*, const char* k, size_t klen, const char* v, size_t vlen),\n    void (*deleted)(void*, const char* k, size_t klen)) {\n  class H : public WriteBatch::Handler {\n   public:\n    void* state_;\n    void (*put_)(void*, const char* k, size_t klen, const char* v, size_t vlen);\n    void (*deleted_)(void*, const char* k, size_t klen);\n    virtual void Put(const Slice& key, const Slice& value) {\n      (*put_)(state_, key.data(), key.size(), value.data(), value.size());\n    }\n    virtual void Delete(const Slice& key) {\n      (*deleted_)(state_, key.data(), key.size());\n    }\n  };\n  H handler;\n  handler.state_ = state;\n  handler.put_ = put;\n  handler.deleted_ = deleted;\n  b->rep.Iterate(&handler);\n}"
  },
  {
    "function_name": "leveldb_writebatch_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "356-360",
    "snippet": "void leveldb_writebatch_delete(\n    leveldb_writebatch_t* b,\n    const char* key, size_t klen) {\n  b->rep.Delete(Slice(key, klen));\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b->rep.Delete",
          "args": [
            "Slice(key, klen)"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "MemTableInserter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "121-124",
          "snippet": "virtual void Delete(const Slice& key) {\n    mem_->Add(sequence_, kTypeDeletion, key, Slice());\n    sequence_++;\n  }",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nMemTableInserter {\n  virtual void Delete(const Slice& key) {\n      mem_->Add(sequence_, kTypeDeletion, key, Slice());\n      sequence_++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "key",
            "klen"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_writebatch_delete(\n    leveldb_writebatch_t* b,\n    const char* key, size_t klen) {\n  b->rep.Delete(Slice(key, klen));\n}"
  },
  {
    "function_name": "leveldb_writebatch_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "349-354",
    "snippet": "void leveldb_writebatch_put(\n    leveldb_writebatch_t* b,\n    const char* key, size_t klen,\n    const char* val, size_t vlen) {\n  b->rep.Put(Slice(key, klen), Slice(val, vlen));\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b->rep.Put",
          "args": [
            "Slice(key, klen)",
            "Slice(val, vlen)"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "MemTableInserter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "117-120",
          "snippet": "virtual void Put(const Slice& key, const Slice& value) {\n    mem_->Add(sequence_, kTypeValue, key, value);\n    sequence_++;\n  }",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nMemTableInserter {\n  virtual void Put(const Slice& key, const Slice& value) {\n      mem_->Add(sequence_, kTypeValue, key, value);\n      sequence_++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "val",
            "vlen"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_writebatch_put(\n    leveldb_writebatch_t* b,\n    const char* key, size_t klen,\n    const char* val, size_t vlen) {\n  b->rep.Put(Slice(key, klen), Slice(val, vlen));\n}"
  },
  {
    "function_name": "leveldb_writebatch_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "345-347",
    "snippet": "void leveldb_writebatch_clear(leveldb_writebatch_t* b) {\n  b->rep.Clear();\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b->rep.Clear",
          "args": [],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "Clear",
          "container": "InternalKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "166-166",
          "snippet": "void Clear() { rep_.clear(); }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\nInternalKey {\n  void Clear() { rep_.clear(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_writebatch_clear(leveldb_writebatch_t* b) {\n  b->rep.Clear();\n}"
  },
  {
    "function_name": "leveldb_writebatch_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "341-343",
    "snippet": "void leveldb_writebatch_destroy(leveldb_writebatch_t* b) {\n  delete b;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_writebatch_destroy(leveldb_writebatch_t* b) {\n  delete b;\n}"
  },
  {
    "function_name": "leveldb_iter_get_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "333-335",
    "snippet": "void leveldb_iter_get_error(const leveldb_iterator_t* iter, char** errptr) {\n  SaveError(errptr, iter->rep->status());\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SaveError",
          "args": [
            "errptr",
            "iter->rep->status()"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "SaveError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "132-144",
          "snippet": "static bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nstatic bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->rep->status",
          "args": [],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "status",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "74-80",
          "snippet": "virtual Status status() const {\n    if (status_.ok()) {\n      return iter_->status();\n    } else {\n      return status_;\n    }\n  }",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  virtual Status status() const {\n      if (status_.ok()) {\n        return iter_->status();\n      } else {\n        return status_;\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_iter_get_error(const leveldb_iterator_t* iter, char** errptr) {\n  SaveError(errptr, iter->rep->status());\n}"
  },
  {
    "function_name": "leveldb_iter_prev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "317-319",
    "snippet": "void leveldb_iter_prev(leveldb_iterator_t* iter) {\n  iter->rep->Prev();\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->rep->Prev",
          "args": [],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "Prev",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "205-230",
          "snippet": "void DBIter::Prev() {\n  assert(valid_);\n\n  if (direction_ == kForward) {  // Switch directions?\n    // iter_ is pointing at the current entry.  Scan backwards until\n    // the key changes so we can use the normal reverse scanning code.\n    assert(iter_->Valid());  // Otherwise valid_ would have been false\n    SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n    while (true) {\n      iter_->Prev();\n      if (!iter_->Valid()) {\n        valid_ = false;\n        saved_key_.clear();\n        ClearSavedValue();\n        return;\n      }\n      if (user_comparator_->Compare(ExtractUserKey(iter_->key()),\n                                    saved_key_) < 0) {\n        break;\n      }\n    }\n    direction_ = kReverse;\n  }\n\n  FindPrevUserEntry();\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::Prev() {\n    assert(valid_);\n  \n    if (direction_ == kForward) {  // Switch directions?\n      // iter_ is pointing at the current entry.  Scan backwards until\n      // the key changes so we can use the normal reverse scanning code.\n      assert(iter_->Valid());  // Otherwise valid_ would have been false\n      SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n      while (true) {\n        iter_->Prev();\n        if (!iter_->Valid()) {\n          valid_ = false;\n          saved_key_.clear();\n          ClearSavedValue();\n          return;\n        }\n        if (user_comparator_->Compare(ExtractUserKey(iter_->key()),\n                                      saved_key_) < 0) {\n          break;\n        }\n      }\n      direction_ = kReverse;\n    }\n  \n    FindPrevUserEntry();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_iter_prev(leveldb_iterator_t* iter) {\n  iter->rep->Prev();\n}"
  },
  {
    "function_name": "leveldb_iter_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "313-315",
    "snippet": "void leveldb_iter_next(leveldb_iterator_t* iter) {\n  iter->rep->Next();\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->rep->Next",
          "args": [],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "146-171",
          "snippet": "void DBIter::Next() {\n  assert(valid_);\n\n  if (direction_ == kReverse) {  // Switch directions?\n    direction_ = kForward;\n    // iter_ is pointing just before the entries for this->key(),\n    // so advance into the range of entries for this->key() and then\n    // use the normal skipping code below.\n    if (!iter_->Valid()) {\n      iter_->SeekToFirst();\n    } else {\n      iter_->Next();\n    }\n    if (!iter_->Valid()) {\n      valid_ = false;\n      saved_key_.clear();\n      return;\n    }\n    // saved_key_ already contains the key to skip past.\n  } else {\n    // Store in saved_key_ the current key so we skip it below.\n    SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n  }\n\n  FindNextUserEntry(true, &saved_key_);\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::Next() {\n    assert(valid_);\n  \n    if (direction_ == kReverse) {  // Switch directions?\n      direction_ = kForward;\n      // iter_ is pointing just before the entries for this->key(),\n      // so advance into the range of entries for this->key() and then\n      // use the normal skipping code below.\n      if (!iter_->Valid()) {\n        iter_->SeekToFirst();\n      } else {\n        iter_->Next();\n      }\n      if (!iter_->Valid()) {\n        valid_ = false;\n        saved_key_.clear();\n        return;\n      }\n      // saved_key_ already contains the key to skip past.\n    } else {\n      // Store in saved_key_ the current key so we skip it below.\n      SaveKey(ExtractUserKey(iter_->key()), &saved_key_);\n    }\n  \n    FindNextUserEntry(true, &saved_key_);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_iter_next(leveldb_iterator_t* iter) {\n  iter->rep->Next();\n}"
  },
  {
    "function_name": "leveldb_iter_seek",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "309-311",
    "snippet": "void leveldb_iter_seek(leveldb_iterator_t* iter, const char* k, size_t klen) {\n  iter->rep->Seek(Slice(k, klen));\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->rep->Seek",
          "args": [
            "Slice(k, klen)"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "Seek",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "274-286",
          "snippet": "void DBIter::Seek(const Slice& target) {\n  direction_ = kForward;\n  ClearSavedValue();\n  saved_key_.clear();\n  AppendInternalKey(\n      &saved_key_, ParsedInternalKey(target, sequence_, kValueTypeForSeek));\n  iter_->Seek(saved_key_);\n  if (iter_->Valid()) {\n    FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n  } else {\n    valid_ = false;\n  }\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::Seek(const Slice& target) {\n    direction_ = kForward;\n    ClearSavedValue();\n    saved_key_.clear();\n    AppendInternalKey(\n        &saved_key_, ParsedInternalKey(target, sequence_, kValueTypeForSeek));\n    iter_->Seek(saved_key_);\n    if (iter_->Valid()) {\n      FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n    } else {\n      valid_ = false;\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "k",
            "klen"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_iter_seek(leveldb_iterator_t* iter, const char* k, size_t klen) {\n  iter->rep->Seek(Slice(k, klen));\n}"
  },
  {
    "function_name": "leveldb_iter_seek_to_last",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "305-307",
    "snippet": "void leveldb_iter_seek_to_last(leveldb_iterator_t* iter) {\n  iter->rep->SeekToLast();\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->rep->SeekToLast",
          "args": [],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToLast",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "299-304",
          "snippet": "void DBIter::SeekToLast() {\n  direction_ = kReverse;\n  ClearSavedValue();\n  iter_->SeekToLast();\n  FindPrevUserEntry();\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::SeekToLast() {\n    direction_ = kReverse;\n    ClearSavedValue();\n    iter_->SeekToLast();\n    FindPrevUserEntry();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_iter_seek_to_last(leveldb_iterator_t* iter) {\n  iter->rep->SeekToLast();\n}"
  },
  {
    "function_name": "leveldb_iter_seek_to_first",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "301-303",
    "snippet": "void leveldb_iter_seek_to_first(leveldb_iterator_t* iter) {\n  iter->rep->SeekToFirst();\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->rep->SeekToFirst",
          "args": [],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "288-297",
          "snippet": "void DBIter::SeekToFirst() {\n  direction_ = kForward;\n  ClearSavedValue();\n  iter_->SeekToFirst();\n  if (iter_->Valid()) {\n    FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n  } else {\n    valid_ = false;\n  }\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  void DBIter::SeekToFirst() {\n    direction_ = kForward;\n    ClearSavedValue();\n    iter_->SeekToFirst();\n    if (iter_->Valid()) {\n      FindNextUserEntry(false, &saved_key_ /* temporary storage */);\n    } else {\n      valid_ = false;\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_iter_seek_to_first(leveldb_iterator_t* iter) {\n  iter->rep->SeekToFirst();\n}"
  },
  {
    "function_name": "leveldb_iter_valid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "297-299",
    "snippet": "unsigned char leveldb_iter_valid(const leveldb_iterator_t* iter) {\n  return iter->rep->Valid();\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->rep->Valid",
          "args": [],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "DBIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_iter.cc",
          "lines": "65-65",
          "snippet": "virtual bool Valid() const { return valid_; }",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_iter.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/filename.h\"\n#include \"db/db_iter.h\"\n\nDBIter {\n  virtual bool Valid() const { return valid_; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nunsigned char leveldb_iter_valid(const leveldb_iterator_t* iter) {\n  return iter->rep->Valid();\n}"
  },
  {
    "function_name": "leveldb_iter_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "292-295",
    "snippet": "void leveldb_iter_destroy(leveldb_iterator_t* iter) {\n  delete iter->rep;\n  delete iter;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_iter_destroy(leveldb_iterator_t* iter) {\n  delete iter->rep;\n  delete iter;\n}"
  },
  {
    "function_name": "leveldb_repair_db",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "285-290",
    "snippet": "void leveldb_repair_db(\n    const leveldb_options_t* options,\n    const char* name,\n    char** errptr) {\n  SaveError(errptr, RepairDB(name, options->rep));\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SaveError",
          "args": [
            "errptr",
            "RepairDB(name, options->rep)"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "SaveError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "132-144",
          "snippet": "static bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nstatic bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "RepairDB",
          "args": [
            "name",
            "options->rep"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "RepairDB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/repair.cc",
          "lines": "457-460",
          "snippet": "Status RepairDB(const std::string& dbname, const Options& options) {\n  Repairer repairer(dbname, options);\n  return repairer.Run();\n}",
          "includes": [
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_edit.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"db/builder.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_edit.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_impl.h\"\n#include \"db/builder.h\"\n\nStatus RepairDB(const std::string& dbname, const Options& options) {\n  Repairer repairer(dbname, options);\n  return repairer.Run();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_repair_db(\n    const leveldb_options_t* options,\n    const char* name,\n    char** errptr) {\n  SaveError(errptr, RepairDB(name, options->rep));\n}"
  },
  {
    "function_name": "leveldb_destroy_db",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "278-283",
    "snippet": "void leveldb_destroy_db(\n    const leveldb_options_t* options,\n    const char* name,\n    char** errptr) {\n  SaveError(errptr, DestroyDB(name, options->rep));\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SaveError",
          "args": [
            "errptr",
            "DestroyDB(name, options->rep)"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "SaveError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "132-144",
          "snippet": "static bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nstatic bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DestroyDB",
          "args": [
            "name",
            "options->rep"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyDB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1482-1511",
          "snippet": "Status DestroyDB(const std::string& dbname, const Options& options) {\n  Env* env = options.env;\n  std::vector<std::string> filenames;\n  // Ignore error in case directory does not exist\n  env->GetChildren(dbname, &filenames);\n  if (filenames.empty()) {\n    return Status::OK();\n  }\n\n  FileLock* lock;\n  const std::string lockname = LockFileName(dbname);\n  Status result = env->LockFile(lockname, &lock);\n  if (result.ok()) {\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) &&\n          type != kDBLockFile) {  // Lock file will be deleted at end\n        Status del = env->DeleteFile(dbname + \"/\" + filenames[i]);\n        if (result.ok() && !del.ok()) {\n          result = del;\n        }\n      }\n    }\n    env->UnlockFile(lock);  // Ignore error since state is already gone\n    env->DeleteFile(lockname);\n    env->DeleteDir(dbname);  // Ignore error in case dir contains other files\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nStatus DestroyDB(const std::string& dbname, const Options& options) {\n  Env* env = options.env;\n  std::vector<std::string> filenames;\n  // Ignore error in case directory does not exist\n  env->GetChildren(dbname, &filenames);\n  if (filenames.empty()) {\n    return Status::OK();\n  }\n\n  FileLock* lock;\n  const std::string lockname = LockFileName(dbname);\n  Status result = env->LockFile(lockname, &lock);\n  if (result.ok()) {\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) &&\n          type != kDBLockFile) {  // Lock file will be deleted at end\n        Status del = env->DeleteFile(dbname + \"/\" + filenames[i]);\n        if (result.ok() && !del.ok()) {\n          result = del;\n        }\n      }\n    }\n    env->UnlockFile(lock);  // Ignore error since state is already gone\n    env->DeleteFile(lockname);\n    env->DeleteDir(dbname);  // Ignore error in case dir contains other files\n  }\n  return result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_destroy_db(\n    const leveldb_options_t* options,\n    const char* name,\n    char** errptr) {\n  SaveError(errptr, DestroyDB(name, options->rep));\n}"
  },
  {
    "function_name": "leveldb_compact_range",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "267-276",
    "snippet": "void leveldb_compact_range(\n    leveldb_t* db,\n    const char* start_key, size_t start_key_len,\n    const char* limit_key, size_t limit_key_len) {\n  Slice a, b;\n  db->rep->CompactRange(\n      // Pass NULL Slice if corresponding \"const char*\" is NULL\n      (start_key ? (a = Slice(start_key, start_key_len), &a) : NULL),\n      (limit_key ? (b = Slice(limit_key, limit_key_len), &b) : NULL));\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db->rep->CompactRange",
          "args": [
            "// Pass NULL Slice if corresponding \"const char*\" is NULL(start_key ? (a = Slice(start_key, start_key_len), &a) : NULL)",
            "(limit_key ? (b = Slice(limit_key, limit_key_len), &b) : NULL)"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "CompactRange",
          "container": "DBImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "536-551",
          "snippet": "void DBImpl::CompactRange(const Slice* begin, const Slice* end) {\n  int max_level_with_files = 1;\n  {\n    MutexLock l(&mutex_);\n    Version* base = versions_->current();\n    for (int level = 1; level < config::kNumLevels; level++) {\n      if (base->OverlapInLevel(level, begin, end)) {\n        max_level_with_files = level;\n      }\n    }\n  }\n  TEST_CompactMemTable(); // TODO(sanjay): Skip if memtable does not overlap\n  for (int level = 0; level < max_level_with_files; level++) {\n    TEST_CompactRange(level, begin, end);\n  }\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nDBImpl {\n  void DBImpl::CompactRange(const Slice* begin, const Slice* end) {\n    int max_level_with_files = 1;\n    {\n      MutexLock l(&mutex_);\n      Version* base = versions_->current();\n      for (int level = 1; level < config::kNumLevels; level++) {\n        if (base->OverlapInLevel(level, begin, end)) {\n          max_level_with_files = level;\n        }\n      }\n    }\n    TEST_CompactMemTable(); // TODO(sanjay): Skip if memtable does not overlap\n    for (int level = 0; level < max_level_with_files; level++) {\n      TEST_CompactRange(level, begin, end);\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "limit_key",
            "limit_key_len"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_compact_range(\n    leveldb_t* db,\n    const char* start_key, size_t start_key_len,\n    const char* limit_key, size_t limit_key_len) {\n  Slice a, b;\n  db->rep->CompactRange(\n      // Pass NULL Slice if corresponding \"const char*\" is NULL\n      (start_key ? (a = Slice(start_key, start_key_len), &a) : NULL),\n      (limit_key ? (b = Slice(limit_key, limit_key_len), &b) : NULL));\n}"
  },
  {
    "function_name": "leveldb_approximate_sizes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "252-265",
    "snippet": "void leveldb_approximate_sizes(\n    leveldb_t* db,\n    int num_ranges,\n    const char* const* range_start_key, const size_t* range_start_key_len,\n    const char* const* range_limit_key, const size_t* range_limit_key_len,\n    uint64_t* sizes) {\n  Range* ranges = new Range[num_ranges];\n  for (int i = 0; i < num_ranges; i++) {\n    ranges[i].start = Slice(range_start_key[i], range_start_key_len[i]);\n    ranges[i].limit = Slice(range_limit_key[i], range_limit_key_len[i]);\n  }\n  db->rep->GetApproximateSizes(ranges, num_ranges, sizes);\n  delete[] ranges;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db->rep->GetApproximateSizes",
          "args": [
            "ranges",
            "num_ranges",
            "sizes"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "GetApproximateSizes",
          "container": "DBImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1403-1427",
          "snippet": "void DBImpl::GetApproximateSizes(\n    const Range* range, int n,\n    uint64_t* sizes) {\n  // TODO(opt): better implementation\n  Version* v;\n  {\n    MutexLock l(&mutex_);\n    versions_->current()->Ref();\n    v = versions_->current();\n  }\n\n  for (int i = 0; i < n; i++) {\n    // Convert user_key into a corresponding internal key.\n    InternalKey k1(range[i].start, kMaxSequenceNumber, kValueTypeForSeek);\n    InternalKey k2(range[i].limit, kMaxSequenceNumber, kValueTypeForSeek);\n    uint64_t start = versions_->ApproximateOffsetOf(v, k1);\n    uint64_t limit = versions_->ApproximateOffsetOf(v, k2);\n    sizes[i] = (limit >= start ? limit - start : 0);\n  }\n\n  {\n    MutexLock l(&mutex_);\n    v->Unref();\n  }\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nDBImpl {\n  void DBImpl::GetApproximateSizes(\n      const Range* range, int n,\n      uint64_t* sizes) {\n    // TODO(opt): better implementation\n    Version* v;\n    {\n      MutexLock l(&mutex_);\n      versions_->current()->Ref();\n      v = versions_->current();\n    }\n  \n    for (int i = 0; i < n; i++) {\n      // Convert user_key into a corresponding internal key.\n      InternalKey k1(range[i].start, kMaxSequenceNumber, kValueTypeForSeek);\n      InternalKey k2(range[i].limit, kMaxSequenceNumber, kValueTypeForSeek);\n      uint64_t start = versions_->ApproximateOffsetOf(v, k1);\n      uint64_t limit = versions_->ApproximateOffsetOf(v, k2);\n      sizes[i] = (limit >= start ? limit - start : 0);\n    }\n  \n    {\n      MutexLock l(&mutex_);\n      v->Unref();\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "range_limit_key[i]",
            "range_limit_key_len[i]"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_approximate_sizes(\n    leveldb_t* db,\n    int num_ranges,\n    const char* const* range_start_key, const size_t* range_start_key_len,\n    const char* const* range_limit_key, const size_t* range_limit_key_len,\n    uint64_t* sizes) {\n  Range* ranges = new Range[num_ranges];\n  for (int i = 0; i < num_ranges; i++) {\n    ranges[i].start = Slice(range_start_key[i], range_start_key_len[i]);\n    ranges[i].limit = Slice(range_limit_key[i], range_limit_key_len[i]);\n  }\n  db->rep->GetApproximateSizes(ranges, num_ranges, sizes);\n  delete[] ranges;\n}"
  },
  {
    "function_name": "leveldb_release_snapshot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "233-238",
    "snippet": "void leveldb_release_snapshot(\n    leveldb_t* db,\n    const leveldb_snapshot_t* snapshot) {\n  db->rep->ReleaseSnapshot(snapshot->rep);\n  delete snapshot;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db->rep->ReleaseSnapshot",
          "args": [
            "snapshot->rep"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSnapshot",
          "container": "DBImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1148-1151",
          "snippet": "void DBImpl::ReleaseSnapshot(const Snapshot* s) {\n  MutexLock l(&mutex_);\n  snapshots_.Delete(reinterpret_cast<const SnapshotImpl*>(s));\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nDBImpl {\n  void DBImpl::ReleaseSnapshot(const Snapshot* s) {\n    MutexLock l(&mutex_);\n    snapshots_.Delete(reinterpret_cast<const SnapshotImpl*>(s));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_release_snapshot(\n    leveldb_t* db,\n    const leveldb_snapshot_t* snapshot) {\n  db->rep->ReleaseSnapshot(snapshot->rep);\n  delete snapshot;\n}"
  },
  {
    "function_name": "leveldb_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "189-195",
    "snippet": "void leveldb_write(\n    leveldb_t* db,\n    const leveldb_writeoptions_t* options,\n    leveldb_writebatch_t* batch,\n    char** errptr) {\n  SaveError(errptr, db->rep->Write(options->rep, &batch->rep));\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SaveError",
          "args": [
            "errptr",
            "db->rep->Write(options->rep, &batch->rep)"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "SaveError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "132-144",
          "snippet": "static bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nstatic bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "db->rep->Write",
          "args": [
            "options->rep",
            "&batch->rep"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "DBImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1162-1233",
          "snippet": "Status DBImpl::Write(const WriteOptions& options, WriteBatch* my_batch) {\n  Writer w(&mutex_);\n  w.batch = my_batch;\n  w.sync = options.sync;\n  w.done = false;\n\n  MutexLock l(&mutex_);\n  writers_.push_back(&w);\n  while (!w.done && &w != writers_.front()) {\n    w.cv.Wait();\n  }\n  if (w.done) {\n    return w.status;\n  }\n\n  // May temporarily unlock and wait.\n  Status status = MakeRoomForWrite(my_batch == NULL);\n  uint64_t last_sequence = versions_->LastSequence();\n  Writer* last_writer = &w;\n  if (status.ok() && my_batch != NULL) {  // NULL batch is for compactions\n    WriteBatch* updates = BuildBatchGroup(&last_writer);\n    WriteBatchInternal::SetSequence(updates, last_sequence + 1);\n    last_sequence += WriteBatchInternal::Count(updates);\n\n    // Add to log and apply to memtable.  We can release the lock\n    // during this phase since &w is currently responsible for logging\n    // and protects against concurrent loggers and concurrent writes\n    // into mem_.\n    {\n      mutex_.Unlock();\n      status = log_->AddRecord(WriteBatchInternal::Contents(updates));\n      bool sync_error = false;\n      if (status.ok() && options.sync) {\n        status = logfile_->Sync();\n        if (!status.ok()) {\n          sync_error = true;\n        }\n      }\n      if (status.ok()) {\n        status = WriteBatchInternal::InsertInto(updates, mem_);\n      }\n      mutex_.Lock();\n      if (sync_error) {\n        // The state of the log file is indeterminate: the log record we\n        // just added may or may not show up when the DB is re-opened.\n        // So we force the DB into a mode where all future writes fail.\n        RecordBackgroundError(status);\n      }\n    }\n    if (updates == tmp_batch_) tmp_batch_->Clear();\n\n    versions_->SetLastSequence(last_sequence);\n  }\n\n  while (true) {\n    Writer* ready = writers_.front();\n    writers_.pop_front();\n    if (ready != &w) {\n      ready->status = status;\n      ready->done = true;\n      ready->cv.Signal();\n    }\n    if (ready == last_writer) break;\n  }\n\n  // Notify new head of write queue\n  if (!writers_.empty()) {\n    writers_.front()->cv.Signal();\n  }\n\n  return status;\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nDBImpl {\n  Status DBImpl::Write(const WriteOptions& options, WriteBatch* my_batch) {\n    Writer w(&mutex_);\n    w.batch = my_batch;\n    w.sync = options.sync;\n    w.done = false;\n  \n    MutexLock l(&mutex_);\n    writers_.push_back(&w);\n    while (!w.done && &w != writers_.front()) {\n      w.cv.Wait();\n    }\n    if (w.done) {\n      return w.status;\n    }\n  \n    // May temporarily unlock and wait.\n    Status status = MakeRoomForWrite(my_batch == NULL);\n    uint64_t last_sequence = versions_->LastSequence();\n    Writer* last_writer = &w;\n    if (status.ok() && my_batch != NULL) {  // NULL batch is for compactions\n      WriteBatch* updates = BuildBatchGroup(&last_writer);\n      WriteBatchInternal::SetSequence(updates, last_sequence + 1);\n      last_sequence += WriteBatchInternal::Count(updates);\n  \n      // Add to log and apply to memtable.  We can release the lock\n      // during this phase since &w is currently responsible for logging\n      // and protects against concurrent loggers and concurrent writes\n      // into mem_.\n      {\n        mutex_.Unlock();\n        status = log_->AddRecord(WriteBatchInternal::Contents(updates));\n        bool sync_error = false;\n        if (status.ok() && options.sync) {\n          status = logfile_->Sync();\n          if (!status.ok()) {\n            sync_error = true;\n          }\n        }\n        if (status.ok()) {\n          status = WriteBatchInternal::InsertInto(updates, mem_);\n        }\n        mutex_.Lock();\n        if (sync_error) {\n          // The state of the log file is indeterminate: the log record we\n          // just added may or may not show up when the DB is re-opened.\n          // So we force the DB into a mode where all future writes fail.\n          RecordBackgroundError(status);\n        }\n      }\n      if (updates == tmp_batch_) tmp_batch_->Clear();\n  \n      versions_->SetLastSequence(last_sequence);\n    }\n  \n    while (true) {\n      Writer* ready = writers_.front();\n      writers_.pop_front();\n      if (ready != &w) {\n        ready->status = status;\n        ready->done = true;\n        ready->cv.Signal();\n      }\n      if (ready == last_writer) break;\n    }\n  \n    // Notify new head of write queue\n    if (!writers_.empty()) {\n      writers_.front()->cv.Signal();\n    }\n  \n    return status;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_write(\n    leveldb_t* db,\n    const leveldb_writeoptions_t* options,\n    leveldb_writebatch_t* batch,\n    char** errptr) {\n  SaveError(errptr, db->rep->Write(options->rep, &batch->rep));\n}"
  },
  {
    "function_name": "leveldb_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "180-186",
    "snippet": "void leveldb_delete(\n    leveldb_t* db,\n    const leveldb_writeoptions_t* options,\n    const char* key, size_t keylen,\n    char** errptr) {\n  SaveError(errptr, db->rep->Delete(options->rep, Slice(key, keylen)));\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SaveError",
          "args": [
            "errptr",
            "db->rep->Delete(options->rep, Slice(key, keylen))"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "SaveError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "132-144",
          "snippet": "static bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nstatic bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "db->rep->Delete",
          "args": [
            "options->rep",
            "Slice(key, keylen)"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "DB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1437-1441",
          "snippet": "Status DB::Delete(const WriteOptions& opt, const Slice& key) {\n  WriteBatch batch;\n  batch.Delete(key);\n  return Write(opt, &batch);\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nDB {\n  Status DB::Delete(const WriteOptions& opt, const Slice& key) {\n    WriteBatch batch;\n    batch.Delete(key);\n    return Write(opt, &batch);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "key",
            "keylen"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_delete(\n    leveldb_t* db,\n    const leveldb_writeoptions_t* options,\n    const char* key, size_t keylen,\n    char** errptr) {\n  SaveError(errptr, db->rep->Delete(options->rep, Slice(key, keylen)));\n}"
  },
  {
    "function_name": "leveldb_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "170-178",
    "snippet": "void leveldb_put(\n    leveldb_t* db,\n    const leveldb_writeoptions_t* options,\n    const char* key, size_t keylen,\n    const char* val, size_t vallen,\n    char** errptr) {\n  SaveError(errptr,\n            db->rep->Put(options->rep, Slice(key, keylen), Slice(val, vallen)));\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SaveError",
          "args": [
            "errptr",
            "db->rep->Put(options->rep, Slice(key, keylen), Slice(val, vallen))"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "SaveError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "132-144",
          "snippet": "static bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nstatic bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "db->rep->Put",
          "args": [
            "options->rep",
            "Slice(key, keylen)",
            "Slice(val, vallen)"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1431-1435",
          "snippet": "Status DB::Put(const WriteOptions& opt, const Slice& key, const Slice& value) {\n  WriteBatch batch;\n  batch.Put(key, value);\n  return Write(opt, &batch);\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nDB {\n  Status DB::Put(const WriteOptions& opt, const Slice& key, const Slice& value) {\n    WriteBatch batch;\n    batch.Put(key, value);\n    return Write(opt, &batch);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "val",
            "vallen"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_put(\n    leveldb_t* db,\n    const leveldb_writeoptions_t* options,\n    const char* key, size_t keylen,\n    const char* val, size_t vallen,\n    char** errptr) {\n  SaveError(errptr,\n            db->rep->Put(options->rep, Slice(key, keylen), Slice(val, vallen)));\n}"
  },
  {
    "function_name": "leveldb_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "165-168",
    "snippet": "void leveldb_close(leveldb_t* db) {\n  delete db->rep;\n  delete db;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_close(leveldb_t* db) {\n  delete db->rep;\n  delete db;\n}"
  },
  {
    "function_name": "SaveError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "132-144",
    "snippet": "static bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "s.ToString().c_str()"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ToString",
          "args": [],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CUnsignedSyncCheckpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/checkpoints.h",
          "lines": "89-98",
          "snippet": "std::string ToString() const\n    {\n        return strprintf(\n                \"CSyncCheckpoint(\\n\"\n                \"    nVersion       = %d\\n\"\n                \"    hashCheckpoint = %s\\n\"\n                \")\\n\",\n            nVersion,\n            hashCheckpoint.ToString().c_str());\n    }",
          "includes": [
            "#include \"util.h\"",
            "#include \"net.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"net.h\"\n#include <map>\n\nCUnsignedSyncCheckpoint {\n  std::string ToString() const\n      {\n          return strprintf(\n                  \"CSyncCheckpoint(\\n\"\n                  \"    nVersion       = %d\\n\"\n                  \"    hashCheckpoint = %s\\n\"\n                  \")\\n\",\n              nVersion,\n              hashCheckpoint.ToString().c_str());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "*errptr"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "leveldb_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "583-585",
          "snippet": "void leveldb_free(void* ptr) {\n  free(ptr);\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_free(void* ptr) {\n  free(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "s.ToString().c_str()"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "errptr != NULL"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nstatic bool SaveError(char** errptr, const Status& s) {\n  assert(errptr != NULL);\n  if (s.ok()) {\n    return false;\n  } else if (*errptr == NULL) {\n    *errptr = strdup(s.ToString().c_str());\n  } else {\n    // TODO(sanjay): Merge with existing error?\n    free(*errptr);\n    *errptr = strdup(s.ToString().c_str());\n  }\n  return true;\n}"
  },
  {
    "function_name": "KeyMayMatch",
    "container": "leveldb_filterpolicy_t",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "121-124",
    "snippet": "virtual bool KeyMayMatch(const Slice& key, const Slice& filter) const {\n    return (*key_match_)(state_, key.data(), key.size(),\n                         filter.data(), filter.size());\n  }",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "state_",
            "key.data()",
            "key.size()",
            "filter.data()",
            "filter.size()"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter.size",
          "args": [],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter.data",
          "args": [],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.data",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nleveldb_filterpolicy_t {\n  virtual bool KeyMayMatch(const Slice& key, const Slice& filter) const {\n      return (*key_match_)(state_, key.data(), key.size(),\n                           filter.data(), filter.size());\n    }\n}"
  },
  {
    "function_name": "CreateFilter",
    "container": "leveldb_filterpolicy_t",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "108-119",
    "snippet": "virtual void CreateFilter(const Slice* keys, int n, std::string* dst) const {\n    std::vector<const char*> key_pointers(n);\n    std::vector<size_t> key_sizes(n);\n    for (int i = 0; i < n; i++) {\n      key_pointers[i] = keys[i].data();\n      key_sizes[i] = keys[i].size();\n    }\n    size_t len;\n    char* filter = (*create_)(state_, &key_pointers[0], &key_sizes[0], n, &len);\n    dst->append(filter, len);\n    free(filter);\n  }",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "filter"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "leveldb_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "583-585",
          "snippet": "void leveldb_free(void* ptr) {\n  free(ptr);\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_free(void* ptr) {\n  free(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dst->append",
          "args": [
            "filter",
            "len"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "state_",
            "&key_pointers[0]",
            "&key_sizes[0]",
            "n",
            "&len"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keys[i].size",
          "args": [],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "keys[i].data",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nleveldb_filterpolicy_t {\n  virtual void CreateFilter(const Slice* keys, int n, std::string* dst) const {\n      std::vector<const char*> key_pointers(n);\n      std::vector<size_t> key_sizes(n);\n      for (int i = 0; i < n; i++) {\n        key_pointers[i] = keys[i].data();\n        key_sizes[i] = keys[i].size();\n      }\n      size_t len;\n      char* filter = (*create_)(state_, &key_pointers[0], &key_sizes[0], n, &len);\n      dst->append(filter, len);\n      free(filter);\n    }\n}"
  },
  {
    "function_name": "FindShortSuccessor",
    "container": "leveldb_comparator_t",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "83-83",
    "snippet": "virtual void FindShortSuccessor(std::string* key) const { }",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nleveldb_comparator_t {\n  virtual void FindShortSuccessor(std::string* key) const { }\n}"
  },
  {
    "function_name": "FindShortestSeparator",
    "container": "leveldb_comparator_t",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "82-82",
    "snippet": "virtual void FindShortestSeparator(std::string*, const Slice&) const { }",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nleveldb_comparator_t {\n  virtual void FindShortestSeparator(std::string*, const Slice&) const { }\n}"
  },
  {
    "function_name": "Compare",
    "container": "leveldb_comparator_t",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
    "lines": "73-75",
    "snippet": "virtual int Compare(const Slice& a, const Slice& b) const {\n    return (*compare_)(state_, a.data(), a.size(), b.data(), b.size());\n  }",
    "includes": [
      "#include \"leveldb/write_batch.h\"",
      "#include \"leveldb/status.h\"",
      "#include \"leveldb/options.h\"",
      "#include \"leveldb/iterator.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include \"leveldb/cache.h\"",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include \"leveldb/c.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "state_",
            "a.data()",
            "a.size()",
            "b.data()",
            "b.size()"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b.size",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "b.data",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "a.data",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nleveldb_comparator_t {\n  virtual int Compare(const Slice& a, const Slice& b) const {\n      return (*compare_)(state_, a.data(), a.size(), b.data(), b.size());\n    }\n}"
  }
]