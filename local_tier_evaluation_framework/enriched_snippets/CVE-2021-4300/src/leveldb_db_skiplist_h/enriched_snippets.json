[
  {
    "function_name": "Contains",
    "container": "SkipList<Key,Comparator>",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "370-377",
    "snippet": "bool SkipList<Key,Comparator>::Contains(const Key& key) const {\n  Node* x = FindGreaterOrEqual(key, NULL);\n  if (x != NULL && Equal(key, x->key)) {\n    return true;\n  } else {\n    return false;\n  }\n}",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Equal",
          "args": [
            "key",
            "x->key"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "Equal",
          "container": "SkipList",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "117-117",
          "snippet": "bool Equal(const Key& a, const Key& b) const { return (compare_(a, b) == 0); }",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList {\n  bool Equal(const Key& a, const Key& b) const { return (compare_(a, b) == 0); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FindGreaterOrEqual",
          "args": [
            "key",
            "NULL"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  bool SkipList<Key,Comparator>::Contains(const Key& key) const {\n    Node* x = FindGreaterOrEqual(key, NULL);\n    if (x != NULL && Equal(key, x->key)) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n}"
  },
  {
    "function_name": "Insert",
    "container": "SkipList<Key,Comparator>",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "334-367",
    "snippet": "void SkipList<Key,Comparator>::Insert(const Key& key) {\n  // TODO(opt): We can use a barrier-free variant of FindGreaterOrEqual()\n  // here since Insert() is externally synchronized.\n  Node* prev[kMaxHeight];\n  Node* x = FindGreaterOrEqual(key, prev);\n\n  // Our data structure does not allow duplicate insertion\n  assert(x == NULL || !Equal(key, x->key));\n\n  int height = RandomHeight();\n  if (height > GetMaxHeight()) {\n    for (int i = GetMaxHeight(); i < height; i++) {\n      prev[i] = head_;\n    }\n    //fprintf(stderr, \"Change height from %d to %d\\n\", max_height_, height);\n\n    // It is ok to mutate max_height_ without any synchronization\n    // with concurrent readers.  A concurrent reader that observes\n    // the new value of max_height_ will see either the old value of\n    // new level pointers from head_ (NULL), or a new value set in\n    // the loop below.  In the former case the reader will\n    // immediately drop to the next level since NULL sorts after all\n    // keys.  In the latter case the reader will use the new node.\n    max_height_.NoBarrier_Store(reinterpret_cast<void*>(height));\n  }\n\n  x = NewNode(key, height);\n  for (int i = 0; i < height; i++) {\n    // NoBarrier_SetNext() suffices since we will add a barrier when\n    // we publish a pointer to \"x\" in prev[i].\n    x->NoBarrier_SetNext(i, prev[i]->NoBarrier_Next(i));\n    prev[i]->SetNext(i, x);\n  }\n}",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prev[i]->SetNext",
          "args": [
            "i",
            "x"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "SetNext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "157-162",
          "snippet": "void SetNext(int n, Node* x) {\n    assert(n >= 0);\n    // Use a 'release store' so that anybody who reads through this\n    // pointer observes a fully initialized version of the inserted node.\n    next_[n].Release_Store(x);\n  }",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nvoid SetNext(int n, Node* x) {\n    assert(n >= 0);\n    // Use a 'release store' so that anybody who reads through this\n    // pointer observes a fully initialized version of the inserted node.\n    next_[n].Release_Store(x);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "x->NoBarrier_SetNext",
          "args": [
            "i",
            "prev[i]->NoBarrier_Next(i)"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "NoBarrier_SetNext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "169-172",
          "snippet": "void NoBarrier_SetNext(int n, Node* x) {\n    assert(n >= 0);\n    next_[n].NoBarrier_Store(x);\n  }",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nvoid NoBarrier_SetNext(int n, Node* x) {\n    assert(n >= 0);\n    next_[n].NoBarrier_Store(x);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "prev[i]->NoBarrier_Next",
          "args": [
            "i"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NewNode",
          "args": [
            "key",
            "height"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "max_height_.NoBarrier_Store",
          "args": [
            "reinterpret_cast<void*>(height)"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "NoBarrier_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "207-207",
          "snippet": "inline void NoBarrier_Store(void* v) { rep_ = v; }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void NoBarrier_Store(void* v) { rep_ = v; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<void*>",
          "args": [
            "height"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetMaxHeight",
          "args": [],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "GetMaxHeight",
          "container": "SkipList",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "107-110",
          "snippet": "inline int GetMaxHeight() const {\n    return static_cast<int>(\n        reinterpret_cast<intptr_t>(max_height_.NoBarrier_Load()));\n  }",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList {\n  inline int GetMaxHeight() const {\n      return static_cast<int>(\n          reinterpret_cast<intptr_t>(max_height_.NoBarrier_Load()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "RandomHeight",
          "args": [],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "RandomHeight",
          "container": "SkipList<Key,Comparator>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "240-250",
          "snippet": "int SkipList<Key,Comparator>::RandomHeight() {\n  // Increase height with probability 1 in kBranching\n  static const unsigned int kBranching = 4;\n  int height = 1;\n  while (height < kMaxHeight && ((rnd_.Next() % kBranching) == 0)) {\n    height++;\n  }\n  assert(height > 0);\n  assert(height <= kMaxHeight);\n  return height;\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  int SkipList<Key,Comparator>::RandomHeight() {\n    // Increase height with probability 1 in kBranching\n    static const unsigned int kBranching = 4;\n    int height = 1;\n    while (height < kMaxHeight && ((rnd_.Next() % kBranching) == 0)) {\n      height++;\n    }\n    assert(height > 0);\n    assert(height <= kMaxHeight);\n    return height;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "x == NULL || !Equal(key, x->key)"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Equal",
          "args": [
            "key",
            "x->key"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "Equal",
          "container": "SkipList",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "117-117",
          "snippet": "bool Equal(const Key& a, const Key& b) const { return (compare_(a, b) == 0); }",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList {\n  bool Equal(const Key& a, const Key& b) const { return (compare_(a, b) == 0); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FindGreaterOrEqual",
          "args": [
            "key",
            "prev"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  void SkipList<Key,Comparator>::Insert(const Key& key) {\n    // TODO(opt): We can use a barrier-free variant of FindGreaterOrEqual()\n    // here since Insert() is externally synchronized.\n    Node* prev[kMaxHeight];\n    Node* x = FindGreaterOrEqual(key, prev);\n  \n    // Our data structure does not allow duplicate insertion\n    assert(x == NULL || !Equal(key, x->key));\n  \n    int height = RandomHeight();\n    if (height > GetMaxHeight()) {\n      for (int i = GetMaxHeight(); i < height; i++) {\n        prev[i] = head_;\n      }\n      //fprintf(stderr, \"Change height from %d to %d\\n\", max_height_, height);\n  \n      // It is ok to mutate max_height_ without any synchronization\n      // with concurrent readers.  A concurrent reader that observes\n      // the new value of max_height_ will see either the old value of\n      // new level pointers from head_ (NULL), or a new value set in\n      // the loop below.  In the former case the reader will\n      // immediately drop to the next level since NULL sorts after all\n      // keys.  In the latter case the reader will use the new node.\n      max_height_.NoBarrier_Store(reinterpret_cast<void*>(height));\n    }\n  \n    x = NewNode(key, height);\n    for (int i = 0; i < height; i++) {\n      // NoBarrier_SetNext() suffices since we will add a barrier when\n      // we publish a pointer to \"x\" in prev[i].\n      x->NoBarrier_SetNext(i, prev[i]->NoBarrier_Next(i));\n      prev[i]->SetNext(i, x);\n    }\n  }\n}"
  },
  {
    "function_name": "SkipList",
    "container": "SkipList<Key,Comparator>",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "322-331",
    "snippet": "SkipList<Key,Comparator>::SkipList(Comparator cmp, Arena* arena)\n    : compare_(cmp),\n      arena_(arena),\n      head_(NewNode(0 /* any key will do */, kMaxHeight)),\n      max_height_(reinterpret_cast<void*>(1)),\n      rnd_(0xdeadbeef) {\n  for (int i = 0; i < kMaxHeight; i++) {\n    head_->SetNext(i, NULL);\n  }\n}",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "head_->SetNext",
          "args": [
            "i",
            "NULL"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "SetNext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "157-162",
          "snippet": "void SetNext(int n, Node* x) {\n    assert(n >= 0);\n    // Use a 'release store' so that anybody who reads through this\n    // pointer observes a fully initialized version of the inserted node.\n    next_[n].Release_Store(x);\n  }",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nvoid SetNext(int n, Node* x) {\n    assert(n >= 0);\n    // Use a 'release store' so that anybody who reads through this\n    // pointer observes a fully initialized version of the inserted node.\n    next_[n].Release_Store(x);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<void*>",
          "args": [
            "1"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NewNode",
          "args": [
            "0/* any key will do */",
            "kMaxHeight"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  SkipList<Key,Comparator>::SkipList(Comparator cmp, Arena* arena)\n      : compare_(cmp),\n        arena_(arena),\n        head_(NewNode(0 /* any key will do */, kMaxHeight)),\n        max_height_(reinterpret_cast<void*>(1)),\n        rnd_(0xdeadbeef) {\n    for (int i = 0; i < kMaxHeight; i++) {\n      head_->SetNext(i, NULL);\n    }\n  }\n}"
  },
  {
    "function_name": "KeyIsAfterNode",
    "container": "SkipList<Key,Comparator>",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "253-256",
    "snippet": "bool SkipList<Key,Comparator>::KeyIsAfterNode(const Key& key, Node* n) const {\n  // NULL n is considered infinite\n  return (n != NULL) && (compare_(n->key, key) < 0);\n}",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "compare_",
          "args": [
            "n->key",
            "key"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  bool SkipList<Key,Comparator>::KeyIsAfterNode(const Key& key, Node* n) const {\n    // NULL n is considered infinite\n    return (n != NULL) && (compare_(n->key, key) < 0);\n  }\n}"
  },
  {
    "function_name": "RandomHeight",
    "container": "SkipList<Key,Comparator>",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "240-250",
    "snippet": "int SkipList<Key,Comparator>::RandomHeight() {\n  // Increase height with probability 1 in kBranching\n  static const unsigned int kBranching = 4;\n  int height = 1;\n  while (height < kMaxHeight && ((rnd_.Next() % kBranching) == 0)) {\n    height++;\n  }\n  assert(height > 0);\n  assert(height <= kMaxHeight);\n  return height;\n}",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "height <= kMaxHeight"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "height > 0"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rnd_.Next",
          "args": [],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "SkipList<Key,Comparator>::Iterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "205-208",
          "snippet": "inline void SkipList<Key,Comparator>::Iterator::Next() {\n  assert(Valid());\n  node_ = node_->Next(0);\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  Iterator {\n    inline void SkipList<Key,Comparator>::Iterator::Next() {\n      assert(Valid());\n      node_ = node_->Next(0);\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  int SkipList<Key,Comparator>::RandomHeight() {\n    // Increase height with probability 1 in kBranching\n    static const unsigned int kBranching = 4;\n    int height = 1;\n    while (height < kMaxHeight && ((rnd_.Next() % kBranching) == 0)) {\n      height++;\n    }\n    assert(height > 0);\n    assert(height <= kMaxHeight);\n    return height;\n  }\n}"
  },
  {
    "function_name": "SeekToLast",
    "container": "SkipList<Key,Comparator>::Iterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "232-237",
    "snippet": "inline void SkipList<Key,Comparator>::Iterator::SeekToLast() {\n  node_ = list_->FindLast();\n  if (node_ == list_->head_) {\n    node_ = NULL;\n  }\n}",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_->FindLast",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  Iterator {\n    inline void SkipList<Key,Comparator>::Iterator::SeekToLast() {\n      node_ = list_->FindLast();\n      if (node_ == list_->head_) {\n        node_ = NULL;\n      }\n    }\n  }\n}"
  },
  {
    "function_name": "SeekToFirst",
    "container": "SkipList<Key,Comparator>::Iterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "227-229",
    "snippet": "inline void SkipList<Key,Comparator>::Iterator::SeekToFirst() {\n  node_ = list_->head_->Next(0);\n}",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_->head_->Next",
          "args": [
            "0"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  Iterator {\n    inline void SkipList<Key,Comparator>::Iterator::SeekToFirst() {\n      node_ = list_->head_->Next(0);\n    }\n  }\n}"
  },
  {
    "function_name": "Seek",
    "container": "SkipList<Key,Comparator>::Iterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "222-224",
    "snippet": "inline void SkipList<Key,Comparator>::Iterator::Seek(const Key& target) {\n  node_ = list_->FindGreaterOrEqual(target, NULL);\n}",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_->FindGreaterOrEqual",
          "args": [
            "target",
            "NULL"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  Iterator {\n    inline void SkipList<Key,Comparator>::Iterator::Seek(const Key& target) {\n      node_ = list_->FindGreaterOrEqual(target, NULL);\n    }\n  }\n}"
  },
  {
    "function_name": "Prev",
    "container": "SkipList<Key,Comparator>::Iterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "211-219",
    "snippet": "inline void SkipList<Key,Comparator>::Iterator::Prev() {\n  // Instead of using explicit \"prev\" links, we just search for the\n  // last node that falls before key.\n  assert(Valid());\n  node_ = list_->FindLessThan(node_->key);\n  if (node_ == list_->head_) {\n    node_ = NULL;\n  }\n}",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_->FindLessThan",
          "args": [
            "node_->key"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "Valid()"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Valid",
          "args": [],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "SkipList<Key,Comparator>::Iterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "194-196",
          "snippet": "inline bool SkipList<Key,Comparator>::Iterator::Valid() const {\n  return node_ != NULL;\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  Iterator {\n    inline bool SkipList<Key,Comparator>::Iterator::Valid() const {\n      return node_ != NULL;\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  Iterator {\n    inline void SkipList<Key,Comparator>::Iterator::Prev() {\n      // Instead of using explicit \"prev\" links, we just search for the\n      // last node that falls before key.\n      assert(Valid());\n      node_ = list_->FindLessThan(node_->key);\n      if (node_ == list_->head_) {\n        node_ = NULL;\n      }\n    }\n  }\n}"
  },
  {
    "function_name": "Next",
    "container": "SkipList<Key,Comparator>::Iterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "205-208",
    "snippet": "inline void SkipList<Key,Comparator>::Iterator::Next() {\n  assert(Valid());\n  node_ = node_->Next(0);\n}",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "node_->Next",
          "args": [
            "0"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "Valid()"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Valid",
          "args": [],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "SkipList<Key,Comparator>::Iterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
          "lines": "194-196",
          "snippet": "inline bool SkipList<Key,Comparator>::Iterator::Valid() const {\n  return node_ != NULL;\n}",
          "includes": [
            "#include \"util/random.h\"",
            "#include \"util/arena.h\"",
            "#include \"port/port.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  Iterator {\n    inline bool SkipList<Key,Comparator>::Iterator::Valid() const {\n      return node_ != NULL;\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  Iterator {\n    inline void SkipList<Key,Comparator>::Iterator::Next() {\n      assert(Valid());\n      node_ = node_->Next(0);\n    }\n  }\n}"
  },
  {
    "function_name": "Valid",
    "container": "SkipList<Key,Comparator>::Iterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "194-196",
    "snippet": "inline bool SkipList<Key,Comparator>::Iterator::Valid() const {\n  return node_ != NULL;\n}",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  Iterator {\n    inline bool SkipList<Key,Comparator>::Iterator::Valid() const {\n      return node_ != NULL;\n    }\n  }\n}"
  },
  {
    "function_name": "Iterator",
    "container": "SkipList<Key,Comparator>::Iterator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "188-191",
    "snippet": "inline SkipList<Key,Comparator>::Iterator::Iterator(const SkipList* list) {\n  list_ = list;\n  node_ = NULL;\n}",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList<Key,Comparator> {\n  Iterator {\n    inline SkipList<Key,Comparator>::Iterator::Iterator(const SkipList* list) {\n      list_ = list;\n      node_ = NULL;\n    }\n  }\n}"
  },
  {
    "function_name": "NoBarrier_SetNext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "169-172",
    "snippet": "void NoBarrier_SetNext(int n, Node* x) {\n    assert(n >= 0);\n    next_[n].NoBarrier_Store(x);\n  }",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "next_[n].NoBarrier_Store",
          "args": [
            "x"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "NoBarrier_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "207-207",
          "snippet": "inline void NoBarrier_Store(void* v) { rep_ = v; }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void NoBarrier_Store(void* v) { rep_ = v; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "n >= 0"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nvoid NoBarrier_SetNext(int n, Node* x) {\n    assert(n >= 0);\n    next_[n].NoBarrier_Store(x);\n  }"
  },
  {
    "function_name": "SetNext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "157-162",
    "snippet": "void SetNext(int n, Node* x) {\n    assert(n >= 0);\n    // Use a 'release store' so that anybody who reads through this\n    // pointer observes a fully initialized version of the inserted node.\n    next_[n].Release_Store(x);\n  }",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "next_[n].Release_Store",
          "args": [
            "x"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "n >= 0"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nvoid SetNext(int n, Node* x) {\n    assert(n >= 0);\n    // Use a 'release store' so that anybody who reads through this\n    // pointer observes a fully initialized version of the inserted node.\n    next_[n].Release_Store(x);\n  }"
  },
  {
    "function_name": "Node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "145-145",
    "snippet": "explicit Node(const Key& k) : key(k) { }",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nexplicit Node(const Key& k) : key(k) { }"
  },
  {
    "function_name": "Equal",
    "container": "SkipList",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "117-117",
    "snippet": "bool Equal(const Key& a, const Key& b) const { return (compare_(a, b) == 0); }",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "compare_",
          "args": [
            "a",
            "b"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList {\n  bool Equal(const Key& a, const Key& b) const { return (compare_(a, b) == 0); }\n}"
  },
  {
    "function_name": "GetMaxHeight",
    "container": "SkipList",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist.h",
    "lines": "107-110",
    "snippet": "inline int GetMaxHeight() const {\n    return static_cast<int>(\n        reinterpret_cast<intptr_t>(max_height_.NoBarrier_Load()));\n  }",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"util/arena.h\"",
      "#include \"port/port.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "reinterpret_cast<intptr_t>(max_height_.NoBarrier_Load())"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<intptr_t>",
          "args": [
            "max_height_.NoBarrier_Load()"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "max_height_.NoBarrier_Load",
          "args": [],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"util/arena.h\"\n#include \"port/port.h\"\n#include <stdlib.h>\n#include <assert.h>\n\nSkipList {\n  inline int GetMaxHeight() const {\n      return static_cast<int>(\n          reinterpret_cast<intptr_t>(max_height_.NoBarrier_Load()));\n    }\n}"
  }
]