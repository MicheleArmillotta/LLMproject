[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "184-186",
    "snippet": "int main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "leveldb::test::RunAllTests",
          "args": [],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "RunAllTests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "36-58",
          "snippet": "int RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nint main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "176-180",
    "snippet": "TEST(CacheTest, NewId) {\n  uint64_t a = cache_->NewId();\n  uint64_t b = cache_->NewId();\n  ASSERT_NE(a, b);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "a",
            "b"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_->NewId",
          "args": [],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "NewId",
          "container": "ShardedLRUCache",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "313-316",
          "snippet": "virtual uint64_t NewId() {\n    MutexLock l(&id_mutex_);\n    return ++(last_id_);\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nShardedLRUCache {\n  virtual uint64_t NewId() {\n      MutexLock l(&id_mutex_);\n      return ++(last_id_);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nTEST(CacheTest, NewId) {\n  uint64_t a = cache_->NewId();\n  uint64_t b = cache_->NewId();\n  ASSERT_NE(a, b);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "149-174",
    "snippet": "TEST(CacheTest, HeavyEntries) {\n  // Add a bunch of light and heavy entries and then count the combined\n  // size of items still in the cache, which must be approximately the\n  // same as the total capacity.\n  const int kLight = 1;\n  const int kHeavy = 10;\n  int added = 0;\n  int index = 0;\n  while (added < 2*kCacheSize) {\n    const int weight = (index & 1) ? kLight : kHeavy;\n    Insert(index, 1000+index, weight);\n    added += weight;\n    index++;\n  }\n\n  int cached_weight = 0;\n  for (int i = 0; i < index; i++) {\n    const int weight = (i & 1 ? kLight : kHeavy);\n    int r = Lookup(i);\n    if (r >= 0) {\n      cached_weight += weight;\n      ASSERT_EQ(1000+i, r);\n    }\n  }\n  ASSERT_LE(cached_weight, kCacheSize + kCacheSize/10);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "cached_weight",
            "kCacheSize + kCacheSize/10"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1000+i",
            "r"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Lookup",
          "args": [
            "i"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "Lookup",
          "container": "CacheTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "48-55",
          "snippet": "int Lookup(int key) {\n    Cache::Handle* handle = cache_->Lookup(EncodeKey(key));\n    const int r = (handle == NULL) ? -1 : DecodeValue(cache_->Value(handle));\n    if (handle != NULL) {\n      cache_->Release(handle);\n    }\n    return r;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  int Lookup(int key) {\n      Cache::Handle* handle = cache_->Lookup(EncodeKey(key));\n      const int r = (handle == NULL) ? -1 : DecodeValue(cache_->Value(handle));\n      if (handle != NULL) {\n        cache_->Release(handle);\n      }\n      return r;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Insert",
          "args": [
            "index",
            "1000+index",
            "weight"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nTEST(CacheTest, HeavyEntries) {\n  // Add a bunch of light and heavy entries and then count the combined\n  // size of items still in the cache, which must be approximately the\n  // same as the total capacity.\n  const int kLight = 1;\n  const int kHeavy = 10;\n  int added = 0;\n  int index = 0;\n  while (added < 2*kCacheSize) {\n    const int weight = (index & 1) ? kLight : kHeavy;\n    Insert(index, 1000+index, weight);\n    added += weight;\n    index++;\n  }\n\n  int cached_weight = 0;\n  for (int i = 0; i < index; i++) {\n    const int weight = (i & 1 ? kLight : kHeavy);\n    int r = Lookup(i);\n    if (r >= 0) {\n      cached_weight += weight;\n      ASSERT_EQ(1000+i, r);\n    }\n  }\n  ASSERT_LE(cached_weight, kCacheSize + kCacheSize/10);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "135-147",
    "snippet": "TEST(CacheTest, EvictionPolicy) {\n  Insert(100, 101);\n  Insert(200, 201);\n\n  // Frequently used entry must be kept around\n  for (int i = 0; i < kCacheSize + 100; i++) {\n    Insert(1000+i, 2000+i);\n    ASSERT_EQ(2000+i, Lookup(1000+i));\n    ASSERT_EQ(101, Lookup(100));\n  }\n  ASSERT_EQ(101, Lookup(100));\n  ASSERT_EQ(-1, Lookup(200));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "-1",
            "Lookup(200)"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Lookup",
          "args": [
            "200"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "Lookup",
          "container": "CacheTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "48-55",
          "snippet": "int Lookup(int key) {\n    Cache::Handle* handle = cache_->Lookup(EncodeKey(key));\n    const int r = (handle == NULL) ? -1 : DecodeValue(cache_->Value(handle));\n    if (handle != NULL) {\n      cache_->Release(handle);\n    }\n    return r;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  int Lookup(int key) {\n      Cache::Handle* handle = cache_->Lookup(EncodeKey(key));\n      const int r = (handle == NULL) ? -1 : DecodeValue(cache_->Value(handle));\n      if (handle != NULL) {\n        cache_->Release(handle);\n      }\n      return r;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "101",
            "Lookup(100)"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "101",
            "Lookup(100)"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2000+i",
            "Lookup(1000+i)"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Insert",
          "args": [
            "1000+i",
            "2000+i"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "Insert",
          "container": "CacheTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "57-60",
          "snippet": "void Insert(int key, int value, int charge = 1) {\n    cache_->Release(cache_->Insert(EncodeKey(key), EncodeValue(value), charge,\n                                   &CacheTest::Deleter));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  void Insert(int key, int value, int charge = 1) {\n      cache_->Release(cache_->Insert(EncodeKey(key), EncodeValue(value), charge,\n                                     &CacheTest::Deleter));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nTEST(CacheTest, EvictionPolicy) {\n  Insert(100, 101);\n  Insert(200, 201);\n\n  // Frequently used entry must be kept around\n  for (int i = 0; i < kCacheSize + 100; i++) {\n    Insert(1000+i, 2000+i);\n    ASSERT_EQ(2000+i, Lookup(1000+i));\n    ASSERT_EQ(101, Lookup(100));\n  }\n  ASSERT_EQ(101, Lookup(100));\n  ASSERT_EQ(-1, Lookup(200));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "110-133",
    "snippet": "TEST(CacheTest, EntriesArePinned) {\n  Insert(100, 101);\n  Cache::Handle* h1 = cache_->Lookup(EncodeKey(100));\n  ASSERT_EQ(101, DecodeValue(cache_->Value(h1)));\n\n  Insert(100, 102);\n  Cache::Handle* h2 = cache_->Lookup(EncodeKey(100));\n  ASSERT_EQ(102, DecodeValue(cache_->Value(h2)));\n  ASSERT_EQ(0, deleted_keys_.size());\n\n  cache_->Release(h1);\n  ASSERT_EQ(1, deleted_keys_.size());\n  ASSERT_EQ(100, deleted_keys_[0]);\n  ASSERT_EQ(101, deleted_values_[0]);\n\n  Erase(100);\n  ASSERT_EQ(-1, Lookup(100));\n  ASSERT_EQ(1, deleted_keys_.size());\n\n  cache_->Release(h2);\n  ASSERT_EQ(2, deleted_keys_.size());\n  ASSERT_EQ(100, deleted_keys_[1]);\n  ASSERT_EQ(102, deleted_values_[1]);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "102",
            "deleted_values_[1]"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "100",
            "deleted_keys_[1]"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2",
            "deleted_keys_.size()"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deleted_keys_.size",
          "args": [],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_->Release",
          "args": [
            "h2"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "Release",
          "container": "ShardedLRUCache",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "302-305",
          "snippet": "virtual void Release(Handle* handle) {\n    LRUHandle* h = reinterpret_cast<LRUHandle*>(handle);\n    shard_[Shard(h->hash)].Release(handle);\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nShardedLRUCache {\n  virtual void Release(Handle* handle) {\n      LRUHandle* h = reinterpret_cast<LRUHandle*>(handle);\n      shard_[Shard(h->hash)].Release(handle);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1",
            "deleted_keys_.size()"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "-1",
            "Lookup(100)"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Lookup",
          "args": [
            "100"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "Lookup",
          "container": "CacheTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "48-55",
          "snippet": "int Lookup(int key) {\n    Cache::Handle* handle = cache_->Lookup(EncodeKey(key));\n    const int r = (handle == NULL) ? -1 : DecodeValue(cache_->Value(handle));\n    if (handle != NULL) {\n      cache_->Release(handle);\n    }\n    return r;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  int Lookup(int key) {\n      Cache::Handle* handle = cache_->Lookup(EncodeKey(key));\n      const int r = (handle == NULL) ? -1 : DecodeValue(cache_->Value(handle));\n      if (handle != NULL) {\n        cache_->Release(handle);\n      }\n      return r;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Erase",
          "args": [
            "100"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "Erase",
          "container": "CacheTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "62-64",
          "snippet": "void Erase(int key) {\n    cache_->Erase(EncodeKey(key));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  void Erase(int key) {\n      cache_->Erase(EncodeKey(key));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "101",
            "deleted_values_[0]"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "100",
            "deleted_keys_[0]"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1",
            "deleted_keys_.size()"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "deleted_keys_.size()"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "102",
            "DecodeValue(cache_->Value(h2))"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DecodeValue",
          "args": [
            "cache_->Value(h2)"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "24-24",
          "snippet": "static int DecodeValue(void* v) { return reinterpret_cast<uintptr_t>(v); }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nstatic int DecodeValue(void* v) { return reinterpret_cast<uintptr_t>(v); }"
        }
      },
      {
        "call_info": {
          "callee": "cache_->Value",
          "args": [
            "h2"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EncodeKey",
          "args": [
            "100"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "14-18",
          "snippet": "static std::string EncodeKey(int k) {\n  std::string result;\n  PutFixed32(&result, k);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nstatic std::string EncodeKey(int k) {\n  std::string result;\n  PutFixed32(&result, k);\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Insert",
          "args": [
            "100",
            "102"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "Insert",
          "container": "CacheTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "57-60",
          "snippet": "void Insert(int key, int value, int charge = 1) {\n    cache_->Release(cache_->Insert(EncodeKey(key), EncodeValue(value), charge,\n                                   &CacheTest::Deleter));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  void Insert(int key, int value, int charge = 1) {\n      cache_->Release(cache_->Insert(EncodeKey(key), EncodeValue(value), charge,\n                                     &CacheTest::Deleter));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "101",
            "DecodeValue(cache_->Value(h1))"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_->Value",
          "args": [
            "h1"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nTEST(CacheTest, EntriesArePinned) {\n  Insert(100, 101);\n  Cache::Handle* h1 = cache_->Lookup(EncodeKey(100));\n  ASSERT_EQ(101, DecodeValue(cache_->Value(h1)));\n\n  Insert(100, 102);\n  Cache::Handle* h2 = cache_->Lookup(EncodeKey(100));\n  ASSERT_EQ(102, DecodeValue(cache_->Value(h2)));\n  ASSERT_EQ(0, deleted_keys_.size());\n\n  cache_->Release(h1);\n  ASSERT_EQ(1, deleted_keys_.size());\n  ASSERT_EQ(100, deleted_keys_[0]);\n  ASSERT_EQ(101, deleted_values_[0]);\n\n  Erase(100);\n  ASSERT_EQ(-1, Lookup(100));\n  ASSERT_EQ(1, deleted_keys_.size());\n\n  cache_->Release(h2);\n  ASSERT_EQ(2, deleted_keys_.size());\n  ASSERT_EQ(100, deleted_keys_[1]);\n  ASSERT_EQ(102, deleted_values_[1]);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "91-108",
    "snippet": "TEST(CacheTest, Erase) {\n  Erase(200);\n  ASSERT_EQ(0, deleted_keys_.size());\n\n  Insert(100, 101);\n  Insert(200, 201);\n  Erase(100);\n  ASSERT_EQ(-1,  Lookup(100));\n  ASSERT_EQ(201, Lookup(200));\n  ASSERT_EQ(1, deleted_keys_.size());\n  ASSERT_EQ(100, deleted_keys_[0]);\n  ASSERT_EQ(101, deleted_values_[0]);\n\n  Erase(100);\n  ASSERT_EQ(-1,  Lookup(100));\n  ASSERT_EQ(201, Lookup(200));\n  ASSERT_EQ(1, deleted_keys_.size());\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1",
            "deleted_keys_.size()"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deleted_keys_.size",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "201",
            "Lookup(200)"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Lookup",
          "args": [
            "200"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "Lookup",
          "container": "CacheTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "48-55",
          "snippet": "int Lookup(int key) {\n    Cache::Handle* handle = cache_->Lookup(EncodeKey(key));\n    const int r = (handle == NULL) ? -1 : DecodeValue(cache_->Value(handle));\n    if (handle != NULL) {\n      cache_->Release(handle);\n    }\n    return r;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  int Lookup(int key) {\n      Cache::Handle* handle = cache_->Lookup(EncodeKey(key));\n      const int r = (handle == NULL) ? -1 : DecodeValue(cache_->Value(handle));\n      if (handle != NULL) {\n        cache_->Release(handle);\n      }\n      return r;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "-1",
            "Lookup(100)"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Erase",
          "args": [
            "100"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "Erase",
          "container": "CacheTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "62-64",
          "snippet": "void Erase(int key) {\n    cache_->Erase(EncodeKey(key));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  void Erase(int key) {\n      cache_->Erase(EncodeKey(key));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "101",
            "deleted_values_[0]"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "100",
            "deleted_keys_[0]"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1",
            "deleted_keys_.size()"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "201",
            "Lookup(200)"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "-1",
            "Lookup(100)"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Insert",
          "args": [
            "200",
            "201"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "Insert",
          "container": "CacheTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "57-60",
          "snippet": "void Insert(int key, int value, int charge = 1) {\n    cache_->Release(cache_->Insert(EncodeKey(key), EncodeValue(value), charge,\n                                   &CacheTest::Deleter));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  void Insert(int key, int value, int charge = 1) {\n      cache_->Release(cache_->Insert(EncodeKey(key), EncodeValue(value), charge,\n                                     &CacheTest::Deleter));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "deleted_keys_.size()"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nTEST(CacheTest, Erase) {\n  Erase(200);\n  ASSERT_EQ(0, deleted_keys_.size());\n\n  Insert(100, 101);\n  Insert(200, 201);\n  Erase(100);\n  ASSERT_EQ(-1,  Lookup(100));\n  ASSERT_EQ(201, Lookup(200));\n  ASSERT_EQ(1, deleted_keys_.size());\n  ASSERT_EQ(100, deleted_keys_[0]);\n  ASSERT_EQ(101, deleted_values_[0]);\n\n  Erase(100);\n  ASSERT_EQ(-1,  Lookup(100));\n  ASSERT_EQ(201, Lookup(200));\n  ASSERT_EQ(1, deleted_keys_.size());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "68-89",
    "snippet": "TEST(CacheTest, HitAndMiss) {\n  ASSERT_EQ(-1, Lookup(100));\n\n  Insert(100, 101);\n  ASSERT_EQ(101, Lookup(100));\n  ASSERT_EQ(-1,  Lookup(200));\n  ASSERT_EQ(-1,  Lookup(300));\n\n  Insert(200, 201);\n  ASSERT_EQ(101, Lookup(100));\n  ASSERT_EQ(201, Lookup(200));\n  ASSERT_EQ(-1,  Lookup(300));\n\n  Insert(100, 102);\n  ASSERT_EQ(102, Lookup(100));\n  ASSERT_EQ(201, Lookup(200));\n  ASSERT_EQ(-1,  Lookup(300));\n\n  ASSERT_EQ(1, deleted_keys_.size());\n  ASSERT_EQ(100, deleted_keys_[0]);\n  ASSERT_EQ(101, deleted_values_[0]);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "101",
            "deleted_values_[0]"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "100",
            "deleted_keys_[0]"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1",
            "deleted_keys_.size()"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deleted_keys_.size",
          "args": [],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "-1",
            "Lookup(300)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Lookup",
          "args": [
            "300"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "Lookup",
          "container": "CacheTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "48-55",
          "snippet": "int Lookup(int key) {\n    Cache::Handle* handle = cache_->Lookup(EncodeKey(key));\n    const int r = (handle == NULL) ? -1 : DecodeValue(cache_->Value(handle));\n    if (handle != NULL) {\n      cache_->Release(handle);\n    }\n    return r;\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  int Lookup(int key) {\n      Cache::Handle* handle = cache_->Lookup(EncodeKey(key));\n      const int r = (handle == NULL) ? -1 : DecodeValue(cache_->Value(handle));\n      if (handle != NULL) {\n        cache_->Release(handle);\n      }\n      return r;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "201",
            "Lookup(200)"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "102",
            "Lookup(100)"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Insert",
          "args": [
            "100",
            "102"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "Insert",
          "container": "CacheTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "57-60",
          "snippet": "void Insert(int key, int value, int charge = 1) {\n    cache_->Release(cache_->Insert(EncodeKey(key), EncodeValue(value), charge,\n                                   &CacheTest::Deleter));\n  }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  void Insert(int key, int value, int charge = 1) {\n      cache_->Release(cache_->Insert(EncodeKey(key), EncodeValue(value), charge,\n                                     &CacheTest::Deleter));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "-1",
            "Lookup(300)"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "201",
            "Lookup(200)"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "101",
            "Lookup(100)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "-1",
            "Lookup(300)"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "-1",
            "Lookup(200)"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "101",
            "Lookup(100)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "-1",
            "Lookup(100)"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nTEST(CacheTest, HitAndMiss) {\n  ASSERT_EQ(-1, Lookup(100));\n\n  Insert(100, 101);\n  ASSERT_EQ(101, Lookup(100));\n  ASSERT_EQ(-1,  Lookup(200));\n  ASSERT_EQ(-1,  Lookup(300));\n\n  Insert(200, 201);\n  ASSERT_EQ(101, Lookup(100));\n  ASSERT_EQ(201, Lookup(200));\n  ASSERT_EQ(-1,  Lookup(300));\n\n  Insert(100, 102);\n  ASSERT_EQ(102, Lookup(100));\n  ASSERT_EQ(201, Lookup(200));\n  ASSERT_EQ(-1,  Lookup(300));\n\n  ASSERT_EQ(1, deleted_keys_.size());\n  ASSERT_EQ(100, deleted_keys_[0]);\n  ASSERT_EQ(101, deleted_values_[0]);\n}"
  },
  {
    "function_name": "Erase",
    "container": "CacheTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "62-64",
    "snippet": "void Erase(int key) {\n    cache_->Erase(EncodeKey(key));\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_->Erase",
          "args": [
            "EncodeKey(key)"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "Erase",
          "container": "CacheTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "62-64",
          "snippet": "void Erase(int key) {\n    cache_->Erase(EncodeKey(key));\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "EncodeKey",
          "args": [
            "key"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "14-18",
          "snippet": "static std::string EncodeKey(int k) {\n  std::string result;\n  PutFixed32(&result, k);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nstatic std::string EncodeKey(int k) {\n  std::string result;\n  PutFixed32(&result, k);\n  return result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  void Erase(int key) {\n      cache_->Erase(EncodeKey(key));\n    }\n}"
  },
  {
    "function_name": "Insert",
    "container": "CacheTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "57-60",
    "snippet": "void Insert(int key, int value, int charge = 1) {\n    cache_->Release(cache_->Insert(EncodeKey(key), EncodeValue(value), charge,\n                                   &CacheTest::Deleter));\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_->Release",
          "args": [
            "cache_->Insert(EncodeKey(key), EncodeValue(value), charge,\n                                   &CacheTest::Deleter)"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "Release",
          "container": "ShardedLRUCache",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "302-305",
          "snippet": "virtual void Release(Handle* handle) {\n    LRUHandle* h = reinterpret_cast<LRUHandle*>(handle);\n    shard_[Shard(h->hash)].Release(handle);\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nShardedLRUCache {\n  virtual void Release(Handle* handle) {\n      LRUHandle* h = reinterpret_cast<LRUHandle*>(handle);\n      shard_[Shard(h->hash)].Release(handle);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_->Insert",
          "args": [
            "EncodeKey(key)",
            "EncodeValue(value)",
            "charge",
            "&CacheTest::Deleter"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EncodeValue",
          "args": [
            "value"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EncodeKey",
          "args": [
            "key"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "14-18",
          "snippet": "static std::string EncodeKey(int k) {\n  std::string result;\n  PutFixed32(&result, k);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nstatic std::string EncodeKey(int k) {\n  std::string result;\n  PutFixed32(&result, k);\n  return result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  void Insert(int key, int value, int charge = 1) {\n      cache_->Release(cache_->Insert(EncodeKey(key), EncodeValue(value), charge,\n                                     &CacheTest::Deleter));\n    }\n}"
  },
  {
    "function_name": "Lookup",
    "container": "CacheTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "48-55",
    "snippet": "int Lookup(int key) {\n    Cache::Handle* handle = cache_->Lookup(EncodeKey(key));\n    const int r = (handle == NULL) ? -1 : DecodeValue(cache_->Value(handle));\n    if (handle != NULL) {\n      cache_->Release(handle);\n    }\n    return r;\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_->Release",
          "args": [
            "handle"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "Release",
          "container": "ShardedLRUCache",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "302-305",
          "snippet": "virtual void Release(Handle* handle) {\n    LRUHandle* h = reinterpret_cast<LRUHandle*>(handle);\n    shard_[Shard(h->hash)].Release(handle);\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nShardedLRUCache {\n  virtual void Release(Handle* handle) {\n      LRUHandle* h = reinterpret_cast<LRUHandle*>(handle);\n      shard_[Shard(h->hash)].Release(handle);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DecodeValue",
          "args": [
            "cache_->Value(handle)"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "24-24",
          "snippet": "static int DecodeValue(void* v) { return reinterpret_cast<uintptr_t>(v); }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nstatic int DecodeValue(void* v) { return reinterpret_cast<uintptr_t>(v); }"
        }
      },
      {
        "call_info": {
          "callee": "cache_->Value",
          "args": [
            "handle"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_->Lookup",
          "args": [
            "EncodeKey(key)"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "Lookup",
          "container": "CacheTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "48-55",
          "snippet": "int Lookup(int key) {\n    Cache::Handle* handle = cache_->Lookup(EncodeKey(key));\n    const int r = (handle == NULL) ? -1 : DecodeValue(cache_->Value(handle));\n    if (handle != NULL) {\n      cache_->Release(handle);\n    }\n    return r;\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "EncodeKey",
          "args": [
            "key"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "14-18",
          "snippet": "static std::string EncodeKey(int k) {\n  std::string result;\n  PutFixed32(&result, k);\n  return result;\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nstatic std::string EncodeKey(int k) {\n  std::string result;\n  PutFixed32(&result, k);\n  return result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  int Lookup(int key) {\n      Cache::Handle* handle = cache_->Lookup(EncodeKey(key));\n      const int r = (handle == NULL) ? -1 : DecodeValue(cache_->Value(handle));\n      if (handle != NULL) {\n        cache_->Release(handle);\n      }\n      return r;\n    }\n}"
  },
  {
    "function_name": "CacheTest",
    "container": "CacheTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "40-42",
    "snippet": "CacheTest() : cache_(NewLRUCache(kCacheSize)) {\n    current_ = this;\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NewLRUCache",
          "args": [
            "kCacheSize"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  CacheTest() : cache_(NewLRUCache(kCacheSize)) {\n      current_ = this;\n    }\n}"
  },
  {
    "function_name": "Deleter",
    "container": "CacheTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "30-33",
    "snippet": "static void Deleter(const Slice& key, void* v) {\n    current_->deleted_keys_.push_back(DecodeKey(key));\n    current_->deleted_values_.push_back(DecodeValue(v));\n  }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "current_->deleted_values_.push_back",
          "args": [
            "DecodeValue(v)"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DecodeValue",
          "args": [
            "v"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "24-24",
          "snippet": "static int DecodeValue(void* v) { return reinterpret_cast<uintptr_t>(v); }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nstatic int DecodeValue(void* v) { return reinterpret_cast<uintptr_t>(v); }"
        }
      },
      {
        "call_info": {
          "callee": "current_->deleted_keys_.push_back",
          "args": [
            "DecodeKey(key)"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DecodeKey",
          "args": [
            "key"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
          "lines": "19-22",
          "snippet": "static int DecodeKey(const Slice& k) {\n  assert(k.size() == 4);\n  return DecodeFixed32(k.data());\n}",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/coding.h\"",
            "#include <vector>",
            "#include \"leveldb/cache.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nstatic int DecodeKey(const Slice& k) {\n  assert(k.size() == 4);\n  return DecodeFixed32(k.data());\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nCacheTest {\n  static void Deleter(const Slice& key, void* v) {\n      current_->deleted_keys_.push_back(DecodeKey(key));\n      current_->deleted_values_.push_back(DecodeValue(v));\n    }\n}"
  },
  {
    "function_name": "DecodeValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "24-24",
    "snippet": "static int DecodeValue(void* v) { return reinterpret_cast<uintptr_t>(v); }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reinterpret_cast<uintptr_t>",
          "args": [
            "v"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nstatic int DecodeValue(void* v) { return reinterpret_cast<uintptr_t>(v); }"
  },
  {
    "function_name": "DecodeKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "19-22",
    "snippet": "static int DecodeKey(const Slice& k) {\n  assert(k.size() == 4);\n  return DecodeFixed32(k.data());\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DecodeFixed32",
          "args": [
            "k.data()"
          ],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeFixed32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.h",
          "lines": "58-70",
          "snippet": "inline uint32_t DecodeFixed32(const char* ptr) {\n  if (port::kLittleEndian) {\n    // Load the raw bytes\n    uint32_t result;\n    memcpy(&result, ptr, sizeof(result));  // gcc optimizes this to a plain load\n    return result;\n  } else {\n    return ((static_cast<uint32_t>(static_cast<unsigned char>(ptr[0])))\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[1])) << 8)\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[2])) << 16)\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[3])) << 24));\n  }\n}",
          "includes": [
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <string>",
            "#include <string.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include <string>\n#include <string.h>\n#include <stdint.h>\n\ninline uint32_t DecodeFixed32(const char* ptr) {\n  if (port::kLittleEndian) {\n    // Load the raw bytes\n    uint32_t result;\n    memcpy(&result, ptr, sizeof(result));  // gcc optimizes this to a plain load\n    return result;\n  } else {\n    return ((static_cast<uint32_t>(static_cast<unsigned char>(ptr[0])))\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[1])) << 8)\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[2])) << 16)\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[3])) << 24));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "k.data",
          "args": [],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "k.size() == 4"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "k.size",
          "args": [],
          "line": 20
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "BlockHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/format.h",
          "lines": "31-31",
          "snippet": "uint64_t size() const { return size_; }",
          "includes": [
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <stdint.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/table_builder.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/slice.h\"\n#include <stdint.h>\n#include <string>\n\nBlockHandle {\n  uint64_t size() const { return size_; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nstatic int DecodeKey(const Slice& k) {\n  assert(k.size() == 4);\n  return DecodeFixed32(k.data());\n}"
  },
  {
    "function_name": "EncodeKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache_test.cc",
    "lines": "14-18",
    "snippet": "static std::string EncodeKey(int k) {\n  std::string result;\n  PutFixed32(&result, k);\n  return result;\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\"",
      "#include <vector>",
      "#include \"leveldb/cache.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PutFixed32",
          "args": [
            "&result",
            "k"
          ],
          "line": 16
        },
        "resolved": true,
        "details": {
          "function_name": "PutFixed32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "35-39",
          "snippet": "void PutFixed32(std::string* dst, uint32_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed32(buf, value);\n  dst->append(buf, sizeof(buf));\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutFixed32(std::string* dst, uint32_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed32(buf, value);\n  dst->append(buf, sizeof(buf));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n#include <vector>\n#include \"leveldb/cache.h\"\n\nstatic std::string EncodeKey(int k) {\n  std::string result;\n  PutFixed32(&result, k);\n  return result;\n}"
  }
]