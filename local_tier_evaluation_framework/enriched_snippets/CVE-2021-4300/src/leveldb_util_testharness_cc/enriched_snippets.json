[
  {
    "function_name": "RandomSeed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
    "lines": "67-74",
    "snippet": "int RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}",
    "includes": [
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include \"util/testharness.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "env"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "atoi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "292-295",
          "snippet": "inline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"TEST_RANDOM_SEED\""
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RandomSeed() {\n  const char* env = getenv(\"TEST_RANDOM_SEED\");\n  int result = (env != NULL ? atoi(env) : 301);\n  if (result <= 0) {\n    result = 301;\n  }\n  return result;\n}"
  },
  {
    "function_name": "TmpDir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
    "lines": "60-65",
    "snippet": "std::string TmpDir() {\n  std::string dir;\n  Status s = Env::Default()->GetTestDirectory(&dir);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  return dir;\n}",
    "includes": [
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include \"util/testharness.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s.ToString",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Histogram",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/histogram.cc",
          "lines": "105-137",
          "snippet": "std::string Histogram::ToString() const {\n  std::string r;\n  char buf[200];\n  snprintf(buf, sizeof(buf),\n           \"Count: %.0f  Average: %.4f  StdDev: %.2f\\n\",\n           num_, Average(), StandardDeviation());\n  r.append(buf);\n  snprintf(buf, sizeof(buf),\n           \"Min: %.4f  Median: %.4f  Max: %.4f\\n\",\n           (num_ == 0.0 ? 0.0 : min_), Median(), max_);\n  r.append(buf);\n  r.append(\"------------------------------------------------------\\n\");\n  const double mult = 100.0 / num_;\n  double sum = 0;\n  for (int b = 0; b < kNumBuckets; b++) {\n    if (buckets_[b] <= 0.0) continue;\n    sum += buckets_[b];\n    snprintf(buf, sizeof(buf),\n             \"[ %7.0f, %7.0f ) %7.0f %7.3f%% %7.3f%% \",\n             ((b == 0) ? 0.0 : kBucketLimit[b-1]),      // left\n             kBucketLimit[b],                           // right\n             buckets_[b],                               // count\n             mult * buckets_[b],                        // percentage\n             mult * sum);                               // cumulative percentage\n    r.append(buf);\n\n    // Add hash marks based on percentage; 20 marks for 100%.\n    int marks = static_cast<int>(20*(buckets_[b] / num_) + 0.5);\n    r.append(marks, '#');\n    r.push_back('\\n');\n  }\n  return r;\n}",
          "includes": [
            "#include \"util/histogram.h\"",
            "#include \"port/port.h\"",
            "#include <stdio.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/histogram.h\"\n#include \"port/port.h\"\n#include <stdio.h>\n#include <math.h>\n\nHistogram {\n  std::string Histogram::ToString() const {\n    std::string r;\n    char buf[200];\n    snprintf(buf, sizeof(buf),\n             \"Count: %.0f  Average: %.4f  StdDev: %.2f\\n\",\n             num_, Average(), StandardDeviation());\n    r.append(buf);\n    snprintf(buf, sizeof(buf),\n             \"Min: %.4f  Median: %.4f  Max: %.4f\\n\",\n             (num_ == 0.0 ? 0.0 : min_), Median(), max_);\n    r.append(buf);\n    r.append(\"------------------------------------------------------\\n\");\n    const double mult = 100.0 / num_;\n    double sum = 0;\n    for (int b = 0; b < kNumBuckets; b++) {\n      if (buckets_[b] <= 0.0) continue;\n      sum += buckets_[b];\n      snprintf(buf, sizeof(buf),\n               \"[ %7.0f, %7.0f ) %7.0f %7.3f%% %7.3f%% \",\n               ((b == 0) ? 0.0 : kBucketLimit[b-1]),      // left\n               kBucketLimit[b],                           // right\n               buckets_[b],                               // count\n               mult * buckets_[b],                        // percentage\n               mult * sum);                               // cumulative percentage\n      r.append(buf);\n  \n      // Add hash marks based on percentage; 20 marks for 100%.\n      int marks = static_cast<int>(20*(buckets_[b] / num_) + 0.5);\n      r.append(marks, '#');\n      r.push_back('\\n');\n    }\n    return r;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "s.ok()"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [
            "&dir"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nstd::string TmpDir() {\n  std::string dir;\n  Status s = Env::Default()->GetTestDirectory(&dir);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  return dir;\n}"
  },
  {
    "function_name": "RunAllTests",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
    "lines": "36-58",
    "snippet": "int RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}",
    "includes": [
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include \"util/testharness.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"==== PASSED %d tests\\n\"",
            "num"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"==== Test %s.%s\\n\"",
            "t.base",
            "t.name"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "name.c_str()",
            "matcher"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.c_str",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.append",
          "args": [
            "t.name"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.push_back",
          "args": [
            "'.'"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tests->size",
          "args": [],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"LEVELDB_TESTS\""
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}"
  },
  {
    "function_name": "RegisterTest",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
    "lines": "24-34",
    "snippet": "bool RegisterTest(const char* base, const char* name, void (*func)()) {\n  if (tests == NULL) {\n    tests = new std::vector<Test>;\n  }\n  Test t;\n  t.base = base;\n  t.name = name;\n  t.func = func;\n  tests->push_back(t);\n  return true;\n}",
    "includes": [
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include \"util/testharness.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tests->push_back",
          "args": [
            "t"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nbool RegisterTest(const char* base, const char* name, void (*func)()) {\n  if (tests == NULL) {\n    tests = new std::vector<Test>;\n  }\n  Test t;\n  t.base = base;\n  t.name = name;\n  t.func = func;\n  tests->push_back(t);\n  return true;\n}"
  }
]