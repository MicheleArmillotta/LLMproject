[
  {
    "function_name": "showOrPrint",
    "container": "HelpMessageBox",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "446-455",
    "snippet": "void HelpMessageBox::showOrPrint()\n{\n#if defined(WIN32)\n        // On Windows, show a message box, as there is no stderr/stdout in windowed applications\n        exec();\n#else\n        // On other operating systems, print help text to console\n        printToConsole();\n#endif\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printToConsole",
          "args": [],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "printToConsole",
          "container": "HelpMessageBox",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "439-444",
          "snippet": "void HelpMessageBox::printToConsole()\n{\n    // On other operating systems, the expected action is to print the message to the console.\n    QString strUsage = header + \"\\n\" + coreOptions + \"\\n\" + uiOptions;\n    fprintf(stdout, \"%s\", strUsage.toStdString().c_str());\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nHelpMessageBox {\n  void HelpMessageBox::printToConsole()\n  {\n      // On other operating systems, the expected action is to print the message to the console.\n      QString strUsage = header + \"\\n\" + coreOptions + \"\\n\" + uiOptions;\n      fprintf(stdout, \"%s\", strUsage.toStdString().c_str());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "exec",
          "args": [],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nHelpMessageBox {\n  void HelpMessageBox::showOrPrint()\n  {\n  #if defined(WIN32)\n          // On Windows, show a message box, as there is no stderr/stdout in windowed applications\n          exec();\n  #else\n          // On other operating systems, print help text to console\n          printToConsole();\n  #endif\n  }\n}"
  },
  {
    "function_name": "printToConsole",
    "container": "HelpMessageBox",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "439-444",
    "snippet": "void HelpMessageBox::printToConsole()\n{\n    // On other operating systems, the expected action is to print the message to the console.\n    QString strUsage = header + \"\\n\" + coreOptions + \"\\n\" + uiOptions;\n    fprintf(stdout, \"%s\", strUsage.toStdString().c_str());\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stdout",
            "\"%s\"",
            "strUsage.toStdString().c_str()"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strUsage.toStdString",
          "args": [],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strUsage.toStdString",
          "args": [],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nHelpMessageBox {\n  void HelpMessageBox::printToConsole()\n  {\n      // On other operating systems, the expected action is to print the message to the console.\n      QString strUsage = header + \"\\n\" + coreOptions + \"\\n\" + uiOptions;\n      fprintf(stdout, \"%s\", strUsage.toStdString().c_str());\n  }\n}"
  },
  {
    "function_name": "HelpMessageBox",
    "container": "HelpMessageBox",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "417-437",
    "snippet": "HelpMessageBox::HelpMessageBox(QWidget *parent) :\n    QMessageBox(parent)\n{\n    header = tr(\"Halcyon-Qt\") + \" \" + tr(\"version\") + \" \" +\n        QString::fromStdString(FormatFullVersion()) + \"\\n\\n\" +\n        tr(\"Usage:\") + \"\\n\" +\n        \"  halcyon-qt [\" + tr(\"command-line options\") + \"]                     \" + \"\\n\";\n\n    coreOptions = QString::fromStdString(HelpMessage());\n\n    uiOptions = tr(\"UI options\") + \":\\n\" +\n        \"  -lang=<lang>           \" + tr(\"Set language, for example \\\"de_DE\\\" (default: system locale)\") + \"\\n\" +\n        \"  -min                   \" + tr(\"Start minimized\") + \"\\n\" +\n        \"  -splash                \" + tr(\"Show splash screen on startup (default: 1)\") + \"\\n\";\n\n    setWindowTitle(tr(\"Halcyon-Qt\"));\n    setTextFormat(Qt::PlainText);\n    // setMinimumWidth is ignored for QMessageBox so put in non-breaking spaces to make it wider.\n    setText(header + QString(QChar(0x2003)).repeated(50));\n    setDetailedText(coreOptions + \"\\n\" + uiOptions);\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setDetailedText",
          "args": [
            "coreOptions + \"\\n\" + uiOptions"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setText",
          "args": [
            "header + QString(QChar(0x2003)).repeated(50)"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "50"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "QChar(0x2003)"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QChar",
          "args": [
            "0x2003"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setTextFormat",
          "args": [
            "Qt::PlainText"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setWindowTitle",
          "args": [
            "tr(\"Halcyon-Qt\")"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Halcyon-Qt\""
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "dateTimeStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "50-53",
          "snippet": "QString dateTimeStr(qint64 nTime)\n{\n    return dateTimeStr(QDateTime::fromTime_t((qint32)nTime));\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQString dateTimeStr(qint64 nTime)\n{\n    return dateTimeStr(QDateTime::fromTime_t((qint32)nTime));\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "HelpMessage()"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HelpMessage",
          "args": [],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "showOrPrint",
          "container": "HelpMessageBox",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "446-455",
          "snippet": "void HelpMessageBox::showOrPrint()\n{\n#if defined(WIN32)\n        // On Windows, show a message box, as there is no stderr/stdout in windowed applications\n        exec();\n#else\n        // On other operating systems, print help text to console\n        printToConsole();\n#endif\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nHelpMessageBox {\n  void HelpMessageBox::showOrPrint()\n  {\n  #if defined(WIN32)\n          // On Windows, show a message box, as there is no stderr/stdout in windowed applications\n          exec();\n  #else\n          // On other operating systems, print help text to console\n          printToConsole();\n  #endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "FormatFullVersion()"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FormatFullVersion",
          "args": [],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "FormatFullVersion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1288-1291",
          "snippet": "string FormatFullVersion()\n{\n    return CLIENT_BUILD;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring FormatFullVersion()\n{\n    return CLIENT_BUILD;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nHelpMessageBox {\n  HelpMessageBox::HelpMessageBox(QWidget *parent) :\n      QMessageBox(parent)\n  {\n      header = tr(\"Halcyon-Qt\") + \" \" + tr(\"version\") + \" \" +\n          QString::fromStdString(FormatFullVersion()) + \"\\n\\n\" +\n          tr(\"Usage:\") + \"\\n\" +\n          \"  halcyon-qt [\" + tr(\"command-line options\") + \"]                     \" + \"\\n\";\n  \n      coreOptions = QString::fromStdString(HelpMessage());\n  \n      uiOptions = tr(\"UI options\") + \":\\n\" +\n          \"  -lang=<lang>           \" + tr(\"Set language, for example \\\"de_DE\\\" (default: system locale)\") + \"\\n\" +\n          \"  -min                   \" + tr(\"Start minimized\") + \"\\n\" +\n          \"  -splash                \" + tr(\"Show splash screen on startup (default: 1)\") + \"\\n\";\n  \n      setWindowTitle(tr(\"Halcyon-Qt\"));\n      setTextFormat(Qt::PlainText);\n      // setMinimumWidth is ignored for QMessageBox so put in non-breaking spaces to make it wider.\n      setText(header + QString(QChar(0x2003)).repeated(50));\n      setDetailedText(coreOptions + \"\\n\" + uiOptions);\n  }\n}"
  },
  {
    "function_name": "SetStartOnSystemStartup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "413-413",
    "snippet": "bool SetStartOnSystemStartup(bool fAutoStart) { return false; }",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool SetStartOnSystemStartup(bool fAutoStart) { return false; }"
  },
  {
    "function_name": "GetStartOnSystemStartup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "412-412",
    "snippet": "bool GetStartOnSystemStartup() { return false; }",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool GetStartOnSystemStartup() { return false; }"
  },
  {
    "function_name": "SetStartOnSystemStartup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "380-406",
    "snippet": "bool SetStartOnSystemStartup(bool fAutoStart)\n{\n    if (!fAutoStart)\n        boost::filesystem::remove(GetAutostartFilePath());\n    else\n    {\n        char pszExePath[MAX_PATH+1];\n        memset(pszExePath, 0, sizeof(pszExePath));\n        if (readlink(\"/proc/self/exe\", pszExePath, sizeof(pszExePath)-1) == -1)\n            return false;\n\n        boost::filesystem::create_directories(GetAutostartDir());\n\n        boost::filesystem::ofstream optionFile(GetAutostartFilePath(), std::ios_base::out|std::ios_base::trunc);\n        if (!optionFile.good())\n            return false;\n        // Write a bitcoin.desktop file to the autostart directory:\n        optionFile << \"[Desktop Entry]\\n\";\n        optionFile << \"Type=Application\\n\";\n        optionFile << \"Name=Halcyon\\n\";\n        optionFile << \"Exec=\" << pszExePath << \" -min\\n\";\n        optionFile << \"Terminal=false\\n\";\n        optionFile << \"Hidden=false\\n\";\n        optionFile.close();\n    }\n    return true;\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "optionFile.close",
          "args": [],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "close",
          "container": "AcceptedConnectionImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "664-667",
          "snippet": "virtual void close()\n    {\n        _stream.close();\n    }",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nAcceptedConnectionImpl {\n  virtual void close()\n      {\n          _stream.close();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "optionFile.good",
          "args": [],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "good",
          "container": "CAutoFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "1078-1078",
          "snippet": "bool good() const            { return state == 0; }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCAutoFile {\n  bool good() const            { return state == 0; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetAutostartFilePath",
          "args": [],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "GetAutostartFilePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "356-359",
          "snippet": "boost::filesystem::path static GetAutostartFilePath()\n{\n    return GetAutostartDir() / \"halcyon.desktop\";\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nboost::filesystem::path static GetAutostartFilePath()\n{\n    return GetAutostartDir() / \"halcyon.desktop\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "boost::filesystem::create_directories",
          "args": [
            "GetAutostartDir()"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetAutostartDir",
          "args": [],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "GetAutostartDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "345-354",
          "snippet": "boost::filesystem::path static GetAutostartDir()\n{\n    namespace fs = boost::filesystem;\n\n    char* pszConfigHome = getenv(\"XDG_CONFIG_HOME\");\n    if (pszConfigHome) return fs::path(pszConfigHome) / \"autostart\";\n    char* pszHome = getenv(\"HOME\");\n    if (pszHome) return fs::path(pszHome) / \".config\" / \"autostart\";\n    return fs::path();\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nboost::filesystem::path static GetAutostartDir()\n{\n    namespace fs = boost::filesystem;\n\n    char* pszConfigHome = getenv(\"XDG_CONFIG_HOME\");\n    if (pszConfigHome) return fs::path(pszConfigHome) / \"autostart\";\n    char* pszHome = getenv(\"HOME\");\n    if (pszHome) return fs::path(pszHome) / \".config\" / \"autostart\";\n    return fs::path();\n}"
        }
      },
      {
        "call_info": {
          "callee": "readlink",
          "args": [
            "\"/proc/self/exe\"",
            "pszExePath",
            "sizeof(pszExePath)-1"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "pszExePath",
            "0",
            "sizeof(pszExePath)"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::filesystem::remove",
          "args": [
            "GetAutostartFilePath()"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool SetStartOnSystemStartup(bool fAutoStart)\n{\n    if (!fAutoStart)\n        boost::filesystem::remove(GetAutostartFilePath());\n    else\n    {\n        char pszExePath[MAX_PATH+1];\n        memset(pszExePath, 0, sizeof(pszExePath));\n        if (readlink(\"/proc/self/exe\", pszExePath, sizeof(pszExePath)-1) == -1)\n            return false;\n\n        boost::filesystem::create_directories(GetAutostartDir());\n\n        boost::filesystem::ofstream optionFile(GetAutostartFilePath(), std::ios_base::out|std::ios_base::trunc);\n        if (!optionFile.good())\n            return false;\n        // Write a bitcoin.desktop file to the autostart directory:\n        optionFile << \"[Desktop Entry]\\n\";\n        optionFile << \"Type=Application\\n\";\n        optionFile << \"Name=Halcyon\\n\";\n        optionFile << \"Exec=\" << pszExePath << \" -min\\n\";\n        optionFile << \"Terminal=false\\n\";\n        optionFile << \"Hidden=false\\n\";\n        optionFile.close();\n    }\n    return true;\n}"
  },
  {
    "function_name": "GetStartOnSystemStartup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "361-378",
    "snippet": "bool GetStartOnSystemStartup()\n{\n    boost::filesystem::ifstream optionFile(GetAutostartFilePath());\n    if (!optionFile.good())\n        return false;\n    // Scan through file for \"Hidden=true\":\n    std::string line;\n    while (!optionFile.eof())\n    {\n        getline(optionFile, line);\n        if (line.find(\"Hidden\") != std::string::npos &&\n            line.find(\"true\") != std::string::npos)\n            return false;\n    }\n    optionFile.close();\n\n    return true;\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "optionFile.close",
          "args": [],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "close",
          "container": "AcceptedConnectionImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "664-667",
          "snippet": "virtual void close()\n    {\n        _stream.close();\n    }",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nAcceptedConnectionImpl {\n  virtual void close()\n      {\n          _stream.close();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "line.find",
          "args": [
            "\"true\""
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getline",
          "args": [
            "optionFile",
            "line"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "optionFile.eof",
          "args": [],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "eof",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "916-916",
          "snippet": "bool eof() const             { return size() == 0; }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  bool eof() const             { return size() == 0; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "optionFile.good",
          "args": [],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "good",
          "container": "CAutoFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "1078-1078",
          "snippet": "bool good() const            { return state == 0; }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCAutoFile {\n  bool good() const            { return state == 0; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool GetStartOnSystemStartup()\n{\n    boost::filesystem::ifstream optionFile(GetAutostartFilePath());\n    if (!optionFile.good())\n        return false;\n    // Scan through file for \"Hidden=true\":\n    std::string line;\n    while (!optionFile.eof())\n    {\n        getline(optionFile, line);\n        if (line.find(\"Hidden\") != std::string::npos &&\n            line.find(\"true\") != std::string::npos)\n            return false;\n    }\n    optionFile.close();\n\n    return true;\n}"
  },
  {
    "function_name": "GetAutostartFilePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "356-359",
    "snippet": "boost::filesystem::path static GetAutostartFilePath()\n{\n    return GetAutostartDir() / \"halcyon.desktop\";\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetAutostartDir",
          "args": [],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "GetAutostartDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "345-354",
          "snippet": "boost::filesystem::path static GetAutostartDir()\n{\n    namespace fs = boost::filesystem;\n\n    char* pszConfigHome = getenv(\"XDG_CONFIG_HOME\");\n    if (pszConfigHome) return fs::path(pszConfigHome) / \"autostart\";\n    char* pszHome = getenv(\"HOME\");\n    if (pszHome) return fs::path(pszHome) / \".config\" / \"autostart\";\n    return fs::path();\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nboost::filesystem::path static GetAutostartDir()\n{\n    namespace fs = boost::filesystem;\n\n    char* pszConfigHome = getenv(\"XDG_CONFIG_HOME\");\n    if (pszConfigHome) return fs::path(pszConfigHome) / \"autostart\";\n    char* pszHome = getenv(\"HOME\");\n    if (pszHome) return fs::path(pszHome) / \".config\" / \"autostart\";\n    return fs::path();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nboost::filesystem::path static GetAutostartFilePath()\n{\n    return GetAutostartDir() / \"halcyon.desktop\";\n}"
  },
  {
    "function_name": "GetAutostartDir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "345-354",
    "snippet": "boost::filesystem::path static GetAutostartDir()\n{\n    namespace fs = boost::filesystem;\n\n    char* pszConfigHome = getenv(\"XDG_CONFIG_HOME\");\n    if (pszConfigHome) return fs::path(pszConfigHome) / \"autostart\";\n    char* pszHome = getenv(\"HOME\");\n    if (pszHome) return fs::path(pszHome) / \".config\" / \"autostart\";\n    return fs::path();\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs::path",
          "args": [],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs::path",
          "args": [
            "pszHome"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"HOME\""
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs::path",
          "args": [
            "pszConfigHome"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"XDG_CONFIG_HOME\""
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nboost::filesystem::path static GetAutostartDir()\n{\n    namespace fs = boost::filesystem;\n\n    char* pszConfigHome = getenv(\"XDG_CONFIG_HOME\");\n    if (pszConfigHome) return fs::path(pszConfigHome) / \"autostart\";\n    char* pszHome = getenv(\"HOME\");\n    if (pszHome) return fs::path(pszHome) / \".config\" / \"autostart\";\n    return fs::path();\n}"
  },
  {
    "function_name": "SetStartOnSystemStartup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "285-338",
    "snippet": "bool SetStartOnSystemStartup(bool fAutoStart)\n{\n    // If the shortcut exists already, remove it for updating\n    boost::filesystem::remove(StartupShortcutPath());\n\n    if (fAutoStart)\n    {\n        CoInitialize(NULL);\n\n        // Get a pointer to the IShellLink interface.\n        IShellLink* psl = NULL;\n        HRESULT hres = CoCreateInstance(CLSID_ShellLink, NULL,\n                                CLSCTX_INPROC_SERVER, IID_IShellLink,\n                                reinterpret_cast<void**>(&psl));\n\n        if (SUCCEEDED(hres))\n        {\n            // Get the current executable path\n            TCHAR pszExePath[MAX_PATH];\n            GetModuleFileName(NULL, pszExePath, sizeof(pszExePath));\n\n            TCHAR pszArgs[5] = TEXT(\"-min\");\n\n            // Set the path to the shortcut target\n            psl->SetPath(pszExePath);\n            PathRemoveFileSpec(pszExePath);\n            psl->SetWorkingDirectory(pszExePath);\n            psl->SetShowCmd(SW_SHOWMINNOACTIVE);\n            psl->SetArguments(pszArgs);\n\n            // Query IShellLink for the IPersistFile interface for\n            // saving the shortcut in persistent storage.\n            IPersistFile* ppf = NULL;\n            hres = psl->QueryInterface(IID_IPersistFile,\n                                       reinterpret_cast<void**>(&ppf));\n            if (SUCCEEDED(hres))\n            {\n                WCHAR pwsz[MAX_PATH];\n                // Ensure that the string is ANSI.\n                MultiByteToWideChar(CP_ACP, 0, StartupShortcutPath().string().c_str(), -1, pwsz, MAX_PATH);\n                // Save the link by calling IPersistFile::Save.\n                hres = ppf->Save(pwsz, TRUE);\n                ppf->Release();\n                psl->Release();\n                CoUninitialize();\n                return true;\n            }\n            psl->Release();\n        }\n        CoUninitialize();\n        return false;\n    }\n    return true;\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CoUninitialize",
          "args": [],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "psl->Release",
          "args": [],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "Release",
          "container": "CNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "276-279",
          "snippet": "void Release()\n    {\n        nRefCount--;\n    }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\nCNode {\n  void Release()\n      {\n          nRefCount--;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CoUninitialize",
          "args": [],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppf->Save",
          "args": [
            "pwsz",
            "TRUE"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MultiByteToWideChar",
          "args": [
            "CP_ACP",
            "0",
            "StartupShortcutPath().string().c_str()",
            "-1",
            "pwsz",
            "MAX_PATH"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StartupShortcutPath",
          "args": [],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "StartupShortcutPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "274-277",
          "snippet": "boost::filesystem::path static StartupShortcutPath()\n{\n    return GetSpecialFolderPath(CSIDL_STARTUP) / \"halcyon.lnk\";\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nboost::filesystem::path static StartupShortcutPath()\n{\n    return GetSpecialFolderPath(CSIDL_STARTUP) / \"halcyon.lnk\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "SUCCEEDED",
          "args": [
            "hres"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "psl->QueryInterface",
          "args": [
            "IID_IPersistFile",
            "reinterpret_cast<void**>(&ppf)"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<void**>",
          "args": [
            "&ppf"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "psl->SetArguments",
          "args": [
            "pszArgs"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "psl->SetShowCmd",
          "args": [
            "SW_SHOWMINNOACTIVE"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "psl->SetWorkingDirectory",
          "args": [
            "pszExePath"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PathRemoveFileSpec",
          "args": [
            "pszExePath"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "psl->SetPath",
          "args": [
            "pszExePath"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEXT",
          "args": [
            "\"-min\""
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetModuleFileName",
          "args": [
            "NULL",
            "pszExePath",
            "sizeof(pszExePath)"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SUCCEEDED",
          "args": [
            "hres"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CoCreateInstance",
          "args": [
            "CLSID_ShellLink",
            "NULL",
            "CLSCTX_INPROC_SERVER",
            "IID_IShellLink",
            "reinterpret_cast<void**>(&psl)"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<void**>",
          "args": [
            "&psl"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CoInitialize",
          "args": [
            "NULL"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::filesystem::remove",
          "args": [
            "StartupShortcutPath()"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool SetStartOnSystemStartup(bool fAutoStart)\n{\n    // If the shortcut exists already, remove it for updating\n    boost::filesystem::remove(StartupShortcutPath());\n\n    if (fAutoStart)\n    {\n        CoInitialize(NULL);\n\n        // Get a pointer to the IShellLink interface.\n        IShellLink* psl = NULL;\n        HRESULT hres = CoCreateInstance(CLSID_ShellLink, NULL,\n                                CLSCTX_INPROC_SERVER, IID_IShellLink,\n                                reinterpret_cast<void**>(&psl));\n\n        if (SUCCEEDED(hres))\n        {\n            // Get the current executable path\n            TCHAR pszExePath[MAX_PATH];\n            GetModuleFileName(NULL, pszExePath, sizeof(pszExePath));\n\n            TCHAR pszArgs[5] = TEXT(\"-min\");\n\n            // Set the path to the shortcut target\n            psl->SetPath(pszExePath);\n            PathRemoveFileSpec(pszExePath);\n            psl->SetWorkingDirectory(pszExePath);\n            psl->SetShowCmd(SW_SHOWMINNOACTIVE);\n            psl->SetArguments(pszArgs);\n\n            // Query IShellLink for the IPersistFile interface for\n            // saving the shortcut in persistent storage.\n            IPersistFile* ppf = NULL;\n            hres = psl->QueryInterface(IID_IPersistFile,\n                                       reinterpret_cast<void**>(&ppf));\n            if (SUCCEEDED(hres))\n            {\n                WCHAR pwsz[MAX_PATH];\n                // Ensure that the string is ANSI.\n                MultiByteToWideChar(CP_ACP, 0, StartupShortcutPath().string().c_str(), -1, pwsz, MAX_PATH);\n                // Save the link by calling IPersistFile::Save.\n                hres = ppf->Save(pwsz, TRUE);\n                ppf->Release();\n                psl->Release();\n                CoUninitialize();\n                return true;\n            }\n            psl->Release();\n        }\n        CoUninitialize();\n        return false;\n    }\n    return true;\n}"
  },
  {
    "function_name": "GetStartOnSystemStartup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "279-283",
    "snippet": "bool GetStartOnSystemStartup()\n{\n    // check for Bitcoin.lnk\n    return boost::filesystem::exists(StartupShortcutPath());\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "boost::filesystem::exists",
          "args": [
            "StartupShortcutPath()"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "exists",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1697-1700",
          "snippet": "bool exists(uint256 hash)\n    {\n        return (mapTx.count(hash) != 0);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  bool exists(uint256 hash)\n      {\n          return (mapTx.count(hash) != 0);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "StartupShortcutPath",
          "args": [],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "StartupShortcutPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "274-277",
          "snippet": "boost::filesystem::path static StartupShortcutPath()\n{\n    return GetSpecialFolderPath(CSIDL_STARTUP) / \"halcyon.lnk\";\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nboost::filesystem::path static StartupShortcutPath()\n{\n    return GetSpecialFolderPath(CSIDL_STARTUP) / \"halcyon.lnk\";\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool GetStartOnSystemStartup()\n{\n    // check for Bitcoin.lnk\n    return boost::filesystem::exists(StartupShortcutPath());\n}"
  },
  {
    "function_name": "StartupShortcutPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "274-277",
    "snippet": "boost::filesystem::path static StartupShortcutPath()\n{\n    return GetSpecialFolderPath(CSIDL_STARTUP) / \"halcyon.lnk\";\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSpecialFolderPath",
          "args": [
            "CSIDL_STARTUP"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nboost::filesystem::path static StartupShortcutPath()\n{\n    return GetSpecialFolderPath(CSIDL_STARTUP) / \"halcyon.lnk\";\n}"
  },
  {
    "function_name": "eventFilter",
    "container": "ToolTipToRichTextFilter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "255-271",
    "snippet": "bool ToolTipToRichTextFilter::eventFilter(QObject *obj, QEvent *evt)\n{\n    if(evt->type() == QEvent::ToolTipChange)\n    {\n        QWidget *widget = static_cast<QWidget*>(obj);\n        QString tooltip = widget->toolTip();\n        if(tooltip.size() > size_threshold && !tooltip.startsWith(\"<qt>\") && !Qt::mightBeRichText(tooltip))\n        {\n            // Prefix <qt/> to make sure Qt detects this as rich text\n            // Escape the current message as HTML and replace \\n by <br>\n            tooltip = \"<qt>\" + HtmlEscape(tooltip, true) + \"<qt/>\";\n            widget->setToolTip(tooltip);\n            return true;\n        }\n    }\n    return QObject::eventFilter(obj, evt);\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QObject::eventFilter",
          "args": [
            "obj",
            "evt"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "eventFilter",
          "container": "ToolTipToRichTextFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "255-271",
          "snippet": "bool ToolTipToRichTextFilter::eventFilter(QObject *obj, QEvent *evt)\n{\n    if(evt->type() == QEvent::ToolTipChange)\n    {\n        QWidget *widget = static_cast<QWidget*>(obj);\n        QString tooltip = widget->toolTip();\n        if(tooltip.size() > size_threshold && !tooltip.startsWith(\"<qt>\") && !Qt::mightBeRichText(tooltip))\n        {\n            // Prefix <qt/> to make sure Qt detects this as rich text\n            // Escape the current message as HTML and replace \\n by <br>\n            tooltip = \"<qt>\" + HtmlEscape(tooltip, true) + \"<qt/>\";\n            widget->setToolTip(tooltip);\n            return true;\n        }\n    }\n    return QObject::eventFilter(obj, evt);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "widget->setToolTip",
          "args": [
            "tooltip"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HtmlEscape",
          "args": [
            "tooltip",
            "true"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "HtmlEscape",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "148-151",
          "snippet": "QString HtmlEscape(const std::string& str, bool fMultiLine)\n{\n    return HtmlEscape(QString::fromStdString(str), fMultiLine);\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQString HtmlEscape(const std::string& str, bool fMultiLine)\n{\n    return HtmlEscape(QString::fromStdString(str), fMultiLine);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Qt::mightBeRichText",
          "args": [
            "tooltip"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tooltip.startsWith",
          "args": [
            "\"<qt>\""
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tooltip.size",
          "args": [],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "widget->toolTip",
          "args": [],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<QWidget*>",
          "args": [
            "obj"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evt->type",
          "args": [],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nToolTipToRichTextFilter {\n  bool ToolTipToRichTextFilter::eventFilter(QObject *obj, QEvent *evt)\n  {\n      if(evt->type() == QEvent::ToolTipChange)\n      {\n          QWidget *widget = static_cast<QWidget*>(obj);\n          QString tooltip = widget->toolTip();\n          if(tooltip.size() > size_threshold && !tooltip.startsWith(\"<qt>\") && !Qt::mightBeRichText(tooltip))\n          {\n              // Prefix <qt/> to make sure Qt detects this as rich text\n              // Escape the current message as HTML and replace \\n by <br>\n              tooltip = \"<qt>\" + HtmlEscape(tooltip, true) + \"<qt/>\";\n              widget->setToolTip(tooltip);\n              return true;\n          }\n      }\n      return QObject::eventFilter(obj, evt);\n  }\n}"
  },
  {
    "function_name": "ToolTipToRichTextFilter",
    "container": "ToolTipToRichTextFilter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "249-253",
    "snippet": "ToolTipToRichTextFilter::ToolTipToRichTextFilter(int size_threshold, QObject *parent) :\n    QObject(parent), size_threshold(size_threshold)\n{\n\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nToolTipToRichTextFilter {\n  ToolTipToRichTextFilter::ToolTipToRichTextFilter(int size_threshold, QObject *parent) :\n      QObject(parent), size_threshold(size_threshold)\n  {\n  \n  }\n}"
  },
  {
    "function_name": "openDebugLogfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "240-247",
    "snippet": "void openDebugLogfile()\n{\n    boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n\n    /* Open debug.log with the associated application */\n    if (boost::filesystem::exists(pathDebug))\n        QDesktopServices::openUrl(QUrl::fromLocalFile(QString::fromStdString(pathDebug.string())));\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QDesktopServices::openUrl",
          "args": [
            "QUrl::fromLocalFile(QString::fromStdString(pathDebug.string()))"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QUrl::fromLocalFile",
          "args": [
            "QString::fromStdString(pathDebug.string())"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "pathDebug.string()"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathDebug.string",
          "args": [],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::filesystem::exists",
          "args": [
            "pathDebug"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "exists",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1697-1700",
          "snippet": "bool exists(uint256 hash)\n    {\n        return (mapTx.count(hash) != 0);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  bool exists(uint256 hash)\n      {\n          return (mapTx.count(hash) != 0);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetDataDir",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid openDebugLogfile()\n{\n    boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n\n    /* Open debug.log with the associated application */\n    if (boost::filesystem::exists(pathDebug))\n        QDesktopServices::openUrl(QUrl::fromLocalFile(QString::fromStdString(pathDebug.string())));\n}"
  },
  {
    "function_name": "isObscured",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "231-238",
    "snippet": "bool isObscured(QWidget *w)\n{\n    return !(checkPoint(QPoint(0, 0), w)\n        && checkPoint(QPoint(w->width() - 1, 0), w)\n        && checkPoint(QPoint(0, w->height() - 1), w)\n        && checkPoint(QPoint(w->width() - 1, w->height() - 1), w)\n        && checkPoint(QPoint(w->width() / 2, w->height() / 2), w));\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkPoint",
          "args": [
            "QPoint(w->width() / 2, w->height() / 2)",
            "w"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "checkPoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "224-229",
          "snippet": "bool checkPoint(const QPoint &p, const QWidget *w)\n{\n    QWidget *atW = qApp->widgetAt(w->mapToGlobal(p));\n    if (!atW) return false;\n    return atW->topLevelWidget() == w;\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool checkPoint(const QPoint &p, const QWidget *w)\n{\n    QWidget *atW = qApp->widgetAt(w->mapToGlobal(p));\n    if (!atW) return false;\n    return atW->topLevelWidget() == w;\n}"
        }
      },
      {
        "call_info": {
          "callee": "QPoint",
          "args": [
            "w->width() / 2",
            "w->height() / 2"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "w->height",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "w->width",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QPoint",
          "args": [
            "w->width() - 1",
            "w->height() - 1"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "w->height",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "w->width",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QPoint",
          "args": [
            "0",
            "w->height() - 1"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "w->height",
          "args": [],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QPoint",
          "args": [
            "w->width() - 1",
            "0"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "w->width",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QPoint",
          "args": [
            "0",
            "0"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool isObscured(QWidget *w)\n{\n    return !(checkPoint(QPoint(0, 0), w)\n        && checkPoint(QPoint(w->width() - 1, 0), w)\n        && checkPoint(QPoint(0, w->height() - 1), w)\n        && checkPoint(QPoint(w->width() - 1, w->height() - 1), w)\n        && checkPoint(QPoint(w->width() / 2, w->height() / 2), w));\n}"
  },
  {
    "function_name": "checkPoint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "224-229",
    "snippet": "bool checkPoint(const QPoint &p, const QWidget *w)\n{\n    QWidget *atW = qApp->widgetAt(w->mapToGlobal(p));\n    if (!atW) return false;\n    return atW->topLevelWidget() == w;\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atW->topLevelWidget",
          "args": [],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qApp->widgetAt",
          "args": [
            "w->mapToGlobal(p)"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "w->mapToGlobal",
          "args": [
            "p"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool checkPoint(const QPoint &p, const QWidget *w)\n{\n    QWidget *atW = qApp->widgetAt(w->mapToGlobal(p));\n    if (!atW) return false;\n    return atW->topLevelWidget() == w;\n}"
  },
  {
    "function_name": "blockingGUIThreadConnection",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "212-222",
    "snippet": "Qt::ConnectionType blockingGUIThreadConnection()\n{\n    if(QThread::currentThread() != QCoreApplication::instance()->thread())\n    {\n        return Qt::BlockingQueuedConnection;\n    }\n    else\n    {\n        return Qt::DirectConnection;\n    }\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QCoreApplication::instance",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::instance",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QThread::currentThread",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQt::ConnectionType blockingGUIThreadConnection()\n{\n    if(QThread::currentThread() != QCoreApplication::instance()->thread())\n    {\n        return Qt::BlockingQueuedConnection;\n    }\n    else\n    {\n        return Qt::DirectConnection;\n    }\n}"
  },
  {
    "function_name": "getSaveFileName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "166-210",
    "snippet": "QString getSaveFileName(QWidget *parent, const QString &caption,\n                                 const QString &dir,\n                                 const QString &filter,\n                                 QString *selectedSuffixOut)\n{\n    QString selectedFilter;\n    QString myDir;\n    if(dir.isEmpty()) // Default to user documents location\n    {\n        myDir = QDesktopServices::storageLocation(QDesktopServices::DocumentsLocation);\n    }\n    else\n    {\n        myDir = dir;\n    }\n    QString result = QFileDialog::getSaveFileName(parent, caption, myDir, filter, &selectedFilter);\n\n    /* Extract first suffix from filter pattern \"Description (*.foo)\" or \"Description (*.foo *.bar ...) */\n    QRegExp filter_re(\".* \\\\(\\\\*\\\\.(.*)[ \\\\)]\");\n    QString selectedSuffix;\n    if(filter_re.exactMatch(selectedFilter))\n    {\n        selectedSuffix = filter_re.cap(1);\n    }\n\n    /* Add suffix if needed */\n    QFileInfo info(result);\n    if(!result.isEmpty())\n    {\n        if(info.suffix().isEmpty() && !selectedSuffix.isEmpty())\n        {\n            /* No suffix specified, add selected suffix */\n            if(!result.endsWith(\".\"))\n                result.append(\".\");\n            result.append(selectedSuffix);\n        }\n    }\n\n    /* Return selected suffix if asked to */\n    if(selectedSuffixOut)\n    {\n        *selectedSuffixOut = selectedSuffix;\n    }\n    return result;\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result.append",
          "args": [
            "selectedSuffix"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.append",
          "args": [
            "\".\""
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.endsWith",
          "args": [
            "\".\""
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selectedSuffix.isEmpty",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info.suffix",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info.suffix",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.isEmpty",
          "args": [],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter_re.cap",
          "args": [
            "1"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter_re.exactMatch",
          "args": [
            "selectedFilter"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QFileDialog::getSaveFileName",
          "args": [
            "parent",
            "caption",
            "myDir",
            "filter",
            "&selectedFilter"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "getSaveFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "166-210",
          "snippet": "QString getSaveFileName(QWidget *parent, const QString &caption,\n                                 const QString &dir,\n                                 const QString &filter,\n                                 QString *selectedSuffixOut)\n{\n    QString selectedFilter;\n    QString myDir;\n    if(dir.isEmpty()) // Default to user documents location\n    {\n        myDir = QDesktopServices::storageLocation(QDesktopServices::DocumentsLocation);\n    }\n    else\n    {\n        myDir = dir;\n    }\n    QString result = QFileDialog::getSaveFileName(parent, caption, myDir, filter, &selectedFilter);\n\n    /* Extract first suffix from filter pattern \"Description (*.foo)\" or \"Description (*.foo *.bar ...) */\n    QRegExp filter_re(\".* \\\\(\\\\*\\\\.(.*)[ \\\\)]\");\n    QString selectedSuffix;\n    if(filter_re.exactMatch(selectedFilter))\n    {\n        selectedSuffix = filter_re.cap(1);\n    }\n\n    /* Add suffix if needed */\n    QFileInfo info(result);\n    if(!result.isEmpty())\n    {\n        if(info.suffix().isEmpty() && !selectedSuffix.isEmpty())\n        {\n            /* No suffix specified, add selected suffix */\n            if(!result.endsWith(\".\"))\n                result.append(\".\");\n            result.append(selectedSuffix);\n        }\n    }\n\n    /* Return selected suffix if asked to */\n    if(selectedSuffixOut)\n    {\n        *selectedSuffixOut = selectedSuffix;\n    }\n    return result;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "QDesktopServices::storageLocation",
          "args": [
            "QDesktopServices::DocumentsLocation"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dir.isEmpty",
          "args": [],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQString getSaveFileName(QWidget *parent, const QString &caption,\n                                 const QString &dir,\n                                 const QString &filter,\n                                 QString *selectedSuffixOut)\n{\n    QString selectedFilter;\n    QString myDir;\n    if(dir.isEmpty()) // Default to user documents location\n    {\n        myDir = QDesktopServices::storageLocation(QDesktopServices::DocumentsLocation);\n    }\n    else\n    {\n        myDir = dir;\n    }\n    QString result = QFileDialog::getSaveFileName(parent, caption, myDir, filter, &selectedFilter);\n\n    /* Extract first suffix from filter pattern \"Description (*.foo)\" or \"Description (*.foo *.bar ...) */\n    QRegExp filter_re(\".* \\\\(\\\\*\\\\.(.*)[ \\\\)]\");\n    QString selectedSuffix;\n    if(filter_re.exactMatch(selectedFilter))\n    {\n        selectedSuffix = filter_re.cap(1);\n    }\n\n    /* Add suffix if needed */\n    QFileInfo info(result);\n    if(!result.isEmpty())\n    {\n        if(info.suffix().isEmpty() && !selectedSuffix.isEmpty())\n        {\n            /* No suffix specified, add selected suffix */\n            if(!result.endsWith(\".\"))\n                result.append(\".\");\n            result.append(selectedSuffix);\n        }\n    }\n\n    /* Return selected suffix if asked to */\n    if(selectedSuffixOut)\n    {\n        *selectedSuffixOut = selectedSuffix;\n    }\n    return result;\n}"
  },
  {
    "function_name": "copyEntryData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "153-164",
    "snippet": "void copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "selection.at(0).data(role).toString()"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.at",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.at",
          "args": [
            "role"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.at",
          "args": [
            "0"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selection.isEmpty",
          "args": [],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "view->selectionModel",
          "args": [
            "column"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "view->selectionModel",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "view->selectionModel",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid copyEntryData(QAbstractItemView *view, int column, int role)\n{\n    if(!view || !view->selectionModel())\n        return;\n    QModelIndexList selection = view->selectionModel()->selectedRows(column);\n\n    if(!selection.isEmpty())\n    {\n        // Copy first item\n        QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n    }\n}"
  },
  {
    "function_name": "HtmlEscape",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "148-151",
    "snippet": "QString HtmlEscape(const std::string& str, bool fMultiLine)\n{\n    return HtmlEscape(QString::fromStdString(str), fMultiLine);\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HtmlEscape",
          "args": [
            "QString::fromStdString(str)",
            "fMultiLine"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "HtmlEscape",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "148-151",
          "snippet": "QString HtmlEscape(const std::string& str, bool fMultiLine)\n{\n    return HtmlEscape(QString::fromStdString(str), fMultiLine);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "str"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQString HtmlEscape(const std::string& str, bool fMultiLine)\n{\n    return HtmlEscape(QString::fromStdString(str), fMultiLine);\n}"
  },
  {
    "function_name": "HtmlEscape",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "138-146",
    "snippet": "QString HtmlEscape(const QString& str, bool fMultiLine)\n{\n    QString escaped = Qt::escape(str);\n    if(fMultiLine)\n    {\n        escaped = escaped.replace(\"\\n\", \"<br>\\n\");\n    }\n    return escaped;\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "escaped.replace",
          "args": [
            "\"\\n\"",
            "\"<br>\\n\""
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Qt::escape",
          "args": [
            "str"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQString HtmlEscape(const QString& str, bool fMultiLine)\n{\n    QString escaped = Qt::escape(str);\n    if(fMultiLine)\n    {\n        escaped = escaped.replace(\"\\n\", \"<br>\\n\");\n    }\n    return escaped;\n}"
  },
  {
    "function_name": "parseBitcoinURI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "124-136",
    "snippet": "bool parseBitcoinURI(QString uri, SendCoinsRecipient *out)\n{\n    // Convert halcyon:// to halcyon:\n    //\n    //    Cannot handle this later, because bitcoin:// will cause Qt to see the part after // as host,\n    //    which will lower-case it (and thus invalidate the address).\n    if(uri.startsWith(\"halcyon://\"))\n    {\n        uri.replace(0, 12, \"halcyon:\");\n    }\n    QUrl uriInstance(uri);\n    return parseBitcoinURI(uriInstance, out);\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parseBitcoinURI",
          "args": [
            "uriInstance",
            "out"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "parseBitcoinURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "124-136",
          "snippet": "bool parseBitcoinURI(QString uri, SendCoinsRecipient *out)\n{\n    // Convert halcyon:// to halcyon:\n    //\n    //    Cannot handle this later, because bitcoin:// will cause Qt to see the part after // as host,\n    //    which will lower-case it (and thus invalidate the address).\n    if(uri.startsWith(\"halcyon://\"))\n    {\n        uri.replace(0, 12, \"halcyon:\");\n    }\n    QUrl uriInstance(uri);\n    return parseBitcoinURI(uriInstance, out);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "uri.replace",
          "args": [
            "0",
            "12",
            "\"halcyon:\""
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.startsWith",
          "args": [
            "\"halcyon://\""
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool parseBitcoinURI(QString uri, SendCoinsRecipient *out)\n{\n    // Convert halcyon:// to halcyon:\n    //\n    //    Cannot handle this later, because bitcoin:// will cause Qt to see the part after // as host,\n    //    which will lower-case it (and thus invalidate the address).\n    if(uri.startsWith(\"halcyon://\"))\n    {\n        uri.replace(0, 12, \"halcyon:\");\n    }\n    QUrl uriInstance(uri);\n    return parseBitcoinURI(uriInstance, out);\n}"
  },
  {
    "function_name": "parseBitcoinURI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "78-122",
    "snippet": "bool parseBitcoinURI(const QUrl &uri, SendCoinsRecipient *out)\n{\n    // NovaCoin: check prefix\n    if(uri.scheme() != QString(\"halcyon\"))\n        return false;\n\n    SendCoinsRecipient rv;\n    rv.address = uri.path();\n    rv.amount = 0;\n    QList<QPair<QString, QString> > items = uri.queryItems();\n    for (QList<QPair<QString, QString> >::iterator i = items.begin(); i != items.end(); i++)\n    {\n        bool fShouldReturnFalse = false;\n        if (i->first.startsWith(\"req-\"))\n        {\n            i->first.remove(0, 4);\n            fShouldReturnFalse = true;\n        }\n\n        if (i->first == \"label\")\n        {\n            rv.label = i->second;\n            fShouldReturnFalse = false;\n        }\n        else if (i->first == \"amount\")\n        {\n            if(!i->second.isEmpty())\n            {\n                if(!BitcoinUnits::parse(BitcoinUnits::BTC, i->second, &rv.amount))\n                {\n                    return false;\n                }\n            }\n            fShouldReturnFalse = false;\n        }\n\n        if (fShouldReturnFalse)\n            return false;\n    }\n    if(out)\n    {\n        *out = rv;\n    }\n    return true;\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BitcoinUnits::parse",
          "args": [
            "BitcoinUnits::BTC",
            "i->second",
            "&rv.amount"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->second.isEmpty",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->first.remove",
          "args": [
            "0",
            "4"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "remove",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "729-751",
          "snippet": "bool CTxMemPool::remove(const CTransaction &tx, bool fRecursive)\n{\n    // Remove transaction from memory pool\n    {\n        LOCK(cs);\n        uint256 hash = tx.GetHash();\n        if (mapTx.count(hash))\n        {\n            if (fRecursive) {\n                for (unsigned int i = 0; i < tx.vout.size(); i++) {\n                    std::map<COutPoint, CInPoint>::iterator it = mapNextTx.find(COutPoint(hash, i));\n                    if (it != mapNextTx.end())\n                        remove(*it->second.ptx, true);\n                }\n            }\n            BOOST_FOREACH(const CTxIn& txin, tx.vin)\n                mapNextTx.erase(txin.prevout);\n            mapTx.erase(hash);\n            nTransactionsUpdated++;\n        }\n    }\n    return true;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;",
            "CBigNum bnProofOfWorkLimit(~uint256(0) >> 20);",
            "CBigNum bnProofOfStakeLimit(~uint256(0) >> 20);",
            "const CBigNum bnNeoScryptSwitch(~uint256(0) >> 30);",
            "CBigNum bnProofOfWorkLimitTestNet(~uint256(0) >> 16);",
            "CBigNum bnProofOfStakeLimitTestNet(~uint256(0) >> 16);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\nCBigNum bnProofOfWorkLimit(~uint256(0) >> 20);\nCBigNum bnProofOfStakeLimit(~uint256(0) >> 20);\nconst CBigNum bnNeoScryptSwitch(~uint256(0) >> 30);\nCBigNum bnProofOfWorkLimitTestNet(~uint256(0) >> 16);\nCBigNum bnProofOfStakeLimitTestNet(~uint256(0) >> 16);\n\nCTxMemPool {\n  bool CTxMemPool::remove(const CTransaction &tx, bool fRecursive)\n  {\n      // Remove transaction from memory pool\n      {\n          LOCK(cs);\n          uint256 hash = tx.GetHash();\n          if (mapTx.count(hash))\n          {\n              if (fRecursive) {\n                  for (unsigned int i = 0; i < tx.vout.size(); i++) {\n                      std::map<COutPoint, CInPoint>::iterator it = mapNextTx.find(COutPoint(hash, i));\n                      if (it != mapNextTx.end())\n                          remove(*it->second.ptx, true);\n                  }\n              }\n              BOOST_FOREACH(const CTxIn& txin, tx.vin)\n                  mapNextTx.erase(txin.prevout);\n              mapTx.erase(hash);\n              nTransactionsUpdated++;\n          }\n      }\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->first.startsWith",
          "args": [
            "\"req-\""
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "items.end",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "items.begin",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "uri.queryItems",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.path",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"halcyon\""
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.scheme",
          "args": [],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool parseBitcoinURI(const QUrl &uri, SendCoinsRecipient *out)\n{\n    // NovaCoin: check prefix\n    if(uri.scheme() != QString(\"halcyon\"))\n        return false;\n\n    SendCoinsRecipient rv;\n    rv.address = uri.path();\n    rv.amount = 0;\n    QList<QPair<QString, QString> > items = uri.queryItems();\n    for (QList<QPair<QString, QString> >::iterator i = items.begin(); i != items.end(); i++)\n    {\n        bool fShouldReturnFalse = false;\n        if (i->first.startsWith(\"req-\"))\n        {\n            i->first.remove(0, 4);\n            fShouldReturnFalse = true;\n        }\n\n        if (i->first == \"label\")\n        {\n            rv.label = i->second;\n            fShouldReturnFalse = false;\n        }\n        else if (i->first == \"amount\")\n        {\n            if(!i->second.isEmpty())\n            {\n                if(!BitcoinUnits::parse(BitcoinUnits::BTC, i->second, &rv.amount))\n                {\n                    return false;\n                }\n            }\n            fShouldReturnFalse = false;\n        }\n\n        if (fShouldReturnFalse)\n            return false;\n    }\n    if(out)\n    {\n        *out = rv;\n    }\n    return true;\n}"
  },
  {
    "function_name": "setupAmountWidget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "69-76",
    "snippet": "void setupAmountWidget(QLineEdit *widget, QWidget *parent)\n{\n    QDoubleValidator *amountValidator = new QDoubleValidator(parent);\n    amountValidator->setDecimals(8);\n    amountValidator->setBottom(0.0);\n    widget->setValidator(amountValidator);\n    widget->setAlignment(Qt::AlignRight|Qt::AlignVCenter);\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "widget->setAlignment",
          "args": [
            "Qt::AlignRight|Qt::AlignVCenter"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "widget->setValidator",
          "args": [
            "amountValidator"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amountValidator->setBottom",
          "args": [
            "0.0"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "amountValidator->setDecimals",
          "args": [
            "8"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid setupAmountWidget(QLineEdit *widget, QWidget *parent)\n{\n    QDoubleValidator *amountValidator = new QDoubleValidator(parent);\n    amountValidator->setDecimals(8);\n    amountValidator->setBottom(0.0);\n    widget->setValidator(amountValidator);\n    widget->setAlignment(Qt::AlignRight|Qt::AlignVCenter);\n}"
  },
  {
    "function_name": "setupAddressWidget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "62-67",
    "snippet": "void setupAddressWidget(QLineEdit *widget, QWidget *parent)\n{\n    widget->setMaxLength(BitcoinAddressValidator::MaxAddressLength);\n    widget->setValidator(new BitcoinAddressValidator(parent));\n    widget->setFont(bitcoinAddressFont());\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "widget->setFont",
          "args": [
            "bitcoinAddressFont()"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitcoinAddressFont",
          "args": [],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "bitcoinAddressFont",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "55-60",
          "snippet": "QFont bitcoinAddressFont()\n{\n    QFont font(\"Monospace\");\n    font.setStyleHint(QFont::TypeWriter);\n    return font;\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQFont bitcoinAddressFont()\n{\n    QFont font(\"Monospace\");\n    font.setStyleHint(QFont::TypeWriter);\n    return font;\n}"
        }
      },
      {
        "call_info": {
          "callee": "widget->setValidator",
          "args": [
            "new BitcoinAddressValidator(parent)"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "widget->setMaxLength",
          "args": [
            "BitcoinAddressValidator::MaxAddressLength"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid setupAddressWidget(QLineEdit *widget, QWidget *parent)\n{\n    widget->setMaxLength(BitcoinAddressValidator::MaxAddressLength);\n    widget->setValidator(new BitcoinAddressValidator(parent));\n    widget->setFont(bitcoinAddressFont());\n}"
  },
  {
    "function_name": "bitcoinAddressFont",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "55-60",
    "snippet": "QFont bitcoinAddressFont()\n{\n    QFont font(\"Monospace\");\n    font.setStyleHint(QFont::TypeWriter);\n    return font;\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "font.setStyleHint",
          "args": [
            "QFont::TypeWriter"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQFont bitcoinAddressFont()\n{\n    QFont font(\"Monospace\");\n    font.setStyleHint(QFont::TypeWriter);\n    return font;\n}"
  },
  {
    "function_name": "dateTimeStr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "50-53",
    "snippet": "QString dateTimeStr(qint64 nTime)\n{\n    return dateTimeStr(QDateTime::fromTime_t((qint32)nTime));\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dateTimeStr",
          "args": [
            "QDateTime::fromTime_t((qint32)nTime)"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "dateTimeStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "50-53",
          "snippet": "QString dateTimeStr(qint64 nTime)\n{\n    return dateTimeStr(QDateTime::fromTime_t((qint32)nTime));\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "QDateTime::fromTime_t",
          "args": [
            "(qint32)nTime"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQString dateTimeStr(qint64 nTime)\n{\n    return dateTimeStr(QDateTime::fromTime_t((qint32)nTime));\n}"
  },
  {
    "function_name": "dateTimeStr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
    "lines": "45-48",
    "snippet": "QString dateTimeStr(const QDateTime &date)\n{\n    return date.date().toString(Qt::SystemLocaleShortDate) + QString(\" \") + date.toString(\"hh:mm\");\n}",
    "includes": [
      "#include \"shellapi.h\"",
      "#include \"shlobj.h\"",
      "#include \"shlwapi.h\"",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include <QThread>",
      "#include <QDesktopServices>",
      "#include <QFileDialog>",
      "#include <QClipboard>",
      "#include <QApplication>",
      "#include <QAbstractItemView>",
      "#include <QTextDocument> // For Qt::escape",
      "#include <QUrl>",
      "#include <QLineEdit>",
      "#include <QFont>",
      "#include <QDoubleValidator>",
      "#include <QDateTime>",
      "#include <QString>",
      "#include \"init.h\"",
      "#include \"util.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinaddressvalidator.h\"",
      "#include \"guiutil.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "date.toString",
          "args": [
            "\"hh:mm\""
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\" \""
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "date.date",
          "args": [
            "Qt::SystemLocaleShortDate"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "date.date",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQString dateTimeStr(const QDateTime &date)\n{\n    return date.date().toString(Qt::SystemLocaleShortDate) + QString(\" \") + date.toString(\"hh:mm\");\n}"
  }
]