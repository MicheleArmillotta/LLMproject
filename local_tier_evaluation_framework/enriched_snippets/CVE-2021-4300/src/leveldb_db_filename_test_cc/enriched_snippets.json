[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename_test.cc",
    "lines": "121-123",
    "snippet": "int main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"db/filename.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "leveldb::test::RunAllTests",
          "args": [],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "RunAllTests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "36-58",
          "snippet": "int RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n\nint main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename_test.cc",
    "lines": "77-117",
    "snippet": "TEST(FileNameTest, Construction) {\n  uint64_t number;\n  FileType type;\n  std::string fname;\n\n  fname = CurrentFileName(\"foo\");\n  ASSERT_EQ(\"foo/\", std::string(fname.data(), 4));\n  ASSERT_TRUE(ParseFileName(fname.c_str() + 4, &number, &type));\n  ASSERT_EQ(0, number);\n  ASSERT_EQ(kCurrentFile, type);\n\n  fname = LockFileName(\"foo\");\n  ASSERT_EQ(\"foo/\", std::string(fname.data(), 4));\n  ASSERT_TRUE(ParseFileName(fname.c_str() + 4, &number, &type));\n  ASSERT_EQ(0, number);\n  ASSERT_EQ(kDBLockFile, type);\n\n  fname = LogFileName(\"foo\", 192);\n  ASSERT_EQ(\"foo/\", std::string(fname.data(), 4));\n  ASSERT_TRUE(ParseFileName(fname.c_str() + 4, &number, &type));\n  ASSERT_EQ(192, number);\n  ASSERT_EQ(kLogFile, type);\n\n  fname = TableFileName(\"bar\", 200);\n  ASSERT_EQ(\"bar/\", std::string(fname.data(), 4));\n  ASSERT_TRUE(ParseFileName(fname.c_str() + 4, &number, &type));\n  ASSERT_EQ(200, number);\n  ASSERT_EQ(kTableFile, type);\n\n  fname = DescriptorFileName(\"bar\", 100);\n  ASSERT_EQ(\"bar/\", std::string(fname.data(), 4));\n  ASSERT_TRUE(ParseFileName(fname.c_str() + 4, &number, &type));\n  ASSERT_EQ(100, number);\n  ASSERT_EQ(kDescriptorFile, type);\n\n  fname = TempFileName(\"tmp\", 999);\n  ASSERT_EQ(\"tmp/\", std::string(fname.data(), 4));\n  ASSERT_TRUE(ParseFileName(fname.c_str() + 4, &number, &type));\n  ASSERT_EQ(999, number);\n  ASSERT_EQ(kTempFile, type);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"db/filename.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "kTempFile",
            "type"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "999",
            "number"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "ParseFileName(fname.c_str() + 4, &number, &type)"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ParseFileName",
          "args": [
            "fname.c_str() + 4",
            "&number",
            "&type"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "ParseFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename.cc",
          "lines": "85-129",
          "snippet": "bool ParseFileName(const std::string& fname,\n                   uint64_t* number,\n                   FileType* type) {\n  Slice rest(fname);\n  if (rest == \"CURRENT\") {\n    *number = 0;\n    *type = kCurrentFile;\n  } else if (rest == \"LOCK\") {\n    *number = 0;\n    *type = kDBLockFile;\n  } else if (rest == \"LOG\" || rest == \"LOG.old\") {\n    *number = 0;\n    *type = kInfoLogFile;\n  } else if (rest.starts_with(\"MANIFEST-\")) {\n    rest.remove_prefix(strlen(\"MANIFEST-\"));\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    if (!rest.empty()) {\n      return false;\n    }\n    *type = kDescriptorFile;\n    *number = num;\n  } else {\n    // Avoid strtoull() to keep filename format independent of the\n    // current locale\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    Slice suffix = rest;\n    if (suffix == Slice(\".log\")) {\n      *type = kLogFile;\n    } else if (suffix == Slice(\".sst\") || suffix == Slice(\".ldb\")) {\n      *type = kTableFile;\n    } else if (suffix == Slice(\".dbtmp\")) {\n      *type = kTempFile;\n    } else {\n      return false;\n    }\n    *number = num;\n  }\n  return true;\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <ctype.h>\n\nbool ParseFileName(const std::string& fname,\n                   uint64_t* number,\n                   FileType* type) {\n  Slice rest(fname);\n  if (rest == \"CURRENT\") {\n    *number = 0;\n    *type = kCurrentFile;\n  } else if (rest == \"LOCK\") {\n    *number = 0;\n    *type = kDBLockFile;\n  } else if (rest == \"LOG\" || rest == \"LOG.old\") {\n    *number = 0;\n    *type = kInfoLogFile;\n  } else if (rest.starts_with(\"MANIFEST-\")) {\n    rest.remove_prefix(strlen(\"MANIFEST-\"));\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    if (!rest.empty()) {\n      return false;\n    }\n    *type = kDescriptorFile;\n    *number = num;\n  } else {\n    // Avoid strtoull() to keep filename format independent of the\n    // current locale\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    Slice suffix = rest;\n    if (suffix == Slice(\".log\")) {\n      *type = kLogFile;\n    } else if (suffix == Slice(\".sst\") || suffix == Slice(\".ldb\")) {\n      *type = kTableFile;\n    } else if (suffix == Slice(\".dbtmp\")) {\n      *type = kTempFile;\n    } else {\n      return false;\n    }\n    *number = num;\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"tmp/\"",
            "std::string(fname.data(), 4)"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "fname.data()",
            "4"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.data",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TempFileName",
          "args": [
            "\"tmp\"",
            "999"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "TempFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename.cc",
          "lines": "63-66",
          "snippet": "std::string TempFileName(const std::string& dbname, uint64_t number) {\n  assert(number > 0);\n  return MakeFileName(dbname, number, \"dbtmp\");\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <ctype.h>\n\nstd::string TempFileName(const std::string& dbname, uint64_t number) {\n  assert(number > 0);\n  return MakeFileName(dbname, number, \"dbtmp\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "kDescriptorFile",
            "type"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "100",
            "number"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "ParseFileName(fname.c_str() + 4, &number, &type)"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar/\"",
            "std::string(fname.data(), 4)"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "fname.data()",
            "4"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.data",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DescriptorFileName",
          "args": [
            "\"bar\"",
            "100"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "DescriptorFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename.cc",
          "lines": "47-53",
          "snippet": "std::string DescriptorFileName(const std::string& dbname, uint64_t number) {\n  assert(number > 0);\n  char buf[100];\n  snprintf(buf, sizeof(buf), \"/MANIFEST-%06llu\",\n           static_cast<unsigned long long>(number));\n  return dbname + buf;\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <ctype.h>\n\nstd::string DescriptorFileName(const std::string& dbname, uint64_t number) {\n  assert(number > 0);\n  char buf[100];\n  snprintf(buf, sizeof(buf), \"/MANIFEST-%06llu\",\n           static_cast<unsigned long long>(number));\n  return dbname + buf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "kTableFile",
            "type"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "200",
            "number"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "ParseFileName(fname.c_str() + 4, &number, &type)"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar/\"",
            "std::string(fname.data(), 4)"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "fname.data()",
            "4"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.data",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TableFileName",
          "args": [
            "\"bar\"",
            "200"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "SSTTableFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename.cc",
          "lines": "42-45",
          "snippet": "std::string SSTTableFileName(const std::string& name, uint64_t number) {\n  assert(number > 0);\n  return MakeFileName(name, number, \"ldb\");\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <ctype.h>\n\nstd::string SSTTableFileName(const std::string& name, uint64_t number) {\n  assert(number > 0);\n  return MakeFileName(name, number, \"ldb\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "kLogFile",
            "type"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "192",
            "number"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "ParseFileName(fname.c_str() + 4, &number, &type)"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"foo/\"",
            "std::string(fname.data(), 4)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "fname.data()",
            "4"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.data",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LogFileName",
          "args": [
            "\"foo\"",
            "192"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "LogFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename.cc",
          "lines": "27-30",
          "snippet": "std::string LogFileName(const std::string& name, uint64_t number) {\n  assert(number > 0);\n  return MakeFileName(name, number, \"log\");\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <ctype.h>\n\nstd::string LogFileName(const std::string& name, uint64_t number) {\n  assert(number > 0);\n  return MakeFileName(name, number, \"log\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "kDBLockFile",
            "type"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "number"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "ParseFileName(fname.c_str() + 4, &number, &type)"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"foo/\"",
            "std::string(fname.data(), 4)"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "fname.data()",
            "4"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.data",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LockFileName",
          "args": [
            "\"foo\""
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "LockFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename.cc",
          "lines": "59-61",
          "snippet": "std::string LockFileName(const std::string& dbname) {\n  return dbname + \"/LOCK\";\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <ctype.h>\n\nstd::string LockFileName(const std::string& dbname) {\n  return dbname + \"/LOCK\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "kCurrentFile",
            "type"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "number"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "ParseFileName(fname.c_str() + 4, &number, &type)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"foo/\"",
            "std::string(fname.data(), 4)"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "fname.data()",
            "4"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.data",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CurrentFileName",
          "args": [
            "\"foo\""
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename.cc",
          "lines": "55-57",
          "snippet": "std::string CurrentFileName(const std::string& dbname) {\n  return dbname + \"/CURRENT\";\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <ctype.h>\n\nstd::string CurrentFileName(const std::string& dbname) {\n  return dbname + \"/CURRENT\";\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n\nTEST(FileNameTest, Construction) {\n  uint64_t number;\n  FileType type;\n  std::string fname;\n\n  fname = CurrentFileName(\"foo\");\n  ASSERT_EQ(\"foo/\", std::string(fname.data(), 4));\n  ASSERT_TRUE(ParseFileName(fname.c_str() + 4, &number, &type));\n  ASSERT_EQ(0, number);\n  ASSERT_EQ(kCurrentFile, type);\n\n  fname = LockFileName(\"foo\");\n  ASSERT_EQ(\"foo/\", std::string(fname.data(), 4));\n  ASSERT_TRUE(ParseFileName(fname.c_str() + 4, &number, &type));\n  ASSERT_EQ(0, number);\n  ASSERT_EQ(kDBLockFile, type);\n\n  fname = LogFileName(\"foo\", 192);\n  ASSERT_EQ(\"foo/\", std::string(fname.data(), 4));\n  ASSERT_TRUE(ParseFileName(fname.c_str() + 4, &number, &type));\n  ASSERT_EQ(192, number);\n  ASSERT_EQ(kLogFile, type);\n\n  fname = TableFileName(\"bar\", 200);\n  ASSERT_EQ(\"bar/\", std::string(fname.data(), 4));\n  ASSERT_TRUE(ParseFileName(fname.c_str() + 4, &number, &type));\n  ASSERT_EQ(200, number);\n  ASSERT_EQ(kTableFile, type);\n\n  fname = DescriptorFileName(\"bar\", 100);\n  ASSERT_EQ(\"bar/\", std::string(fname.data(), 4));\n  ASSERT_TRUE(ParseFileName(fname.c_str() + 4, &number, &type));\n  ASSERT_EQ(100, number);\n  ASSERT_EQ(kDescriptorFile, type);\n\n  fname = TempFileName(\"tmp\", 999);\n  ASSERT_EQ(\"tmp/\", std::string(fname.data(), 4));\n  ASSERT_TRUE(ParseFileName(fname.c_str() + 4, &number, &type));\n  ASSERT_EQ(999, number);\n  ASSERT_EQ(kTempFile, type);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename_test.cc",
    "lines": "16-75",
    "snippet": "TEST(FileNameTest, Parse) {\n  Slice db;\n  FileType type;\n  uint64_t number;\n\n  // Successful parses\n  static struct {\n    const char* fname;\n    uint64_t number;\n    FileType type;\n  } cases[] = {\n    { \"100.log\",            100,   kLogFile },\n    { \"0.log\",              0,     kLogFile },\n    { \"0.sst\",              0,     kTableFile },\n    { \"0.ldb\",              0,     kTableFile },\n    { \"CURRENT\",            0,     kCurrentFile },\n    { \"LOCK\",               0,     kDBLockFile },\n    { \"MANIFEST-2\",         2,     kDescriptorFile },\n    { \"MANIFEST-7\",         7,     kDescriptorFile },\n    { \"LOG\",                0,     kInfoLogFile },\n    { \"LOG.old\",            0,     kInfoLogFile },\n    { \"18446744073709551615.log\", 18446744073709551615ull, kLogFile },\n  };\n  for (int i = 0; i < sizeof(cases) / sizeof(cases[0]); i++) {\n    std::string f = cases[i].fname;\n    ASSERT_TRUE(ParseFileName(f, &number, &type)) << f;\n    ASSERT_EQ(cases[i].type, type) << f;\n    ASSERT_EQ(cases[i].number, number) << f;\n  }\n\n  // Errors\n  static const char* errors[] = {\n    \"\",\n    \"foo\",\n    \"foo-dx-100.log\",\n    \".log\",\n    \"\",\n    \"manifest\",\n    \"CURREN\",\n    \"CURRENTX\",\n    \"MANIFES\",\n    \"MANIFEST\",\n    \"MANIFEST-\",\n    \"XMANIFEST-3\",\n    \"MANIFEST-3x\",\n    \"LOC\",\n    \"LOCKx\",\n    \"LO\",\n    \"LOGx\",\n    \"18446744073709551616.log\",\n    \"184467440737095516150.log\",\n    \"100\",\n    \"100.\",\n    \"100.lop\"\n  };\n  for (int i = 0; i < sizeof(errors) / sizeof(errors[0]); i++) {\n    std::string f = errors[i];\n    ASSERT_TRUE(!ParseFileName(f, &number, &type)) << f;\n  }\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"db/filename.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!ParseFileName(f, &number, &type)"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ParseFileName",
          "args": [
            "f",
            "&number",
            "&type"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "ParseFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename.cc",
          "lines": "85-129",
          "snippet": "bool ParseFileName(const std::string& fname,\n                   uint64_t* number,\n                   FileType* type) {\n  Slice rest(fname);\n  if (rest == \"CURRENT\") {\n    *number = 0;\n    *type = kCurrentFile;\n  } else if (rest == \"LOCK\") {\n    *number = 0;\n    *type = kDBLockFile;\n  } else if (rest == \"LOG\" || rest == \"LOG.old\") {\n    *number = 0;\n    *type = kInfoLogFile;\n  } else if (rest.starts_with(\"MANIFEST-\")) {\n    rest.remove_prefix(strlen(\"MANIFEST-\"));\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    if (!rest.empty()) {\n      return false;\n    }\n    *type = kDescriptorFile;\n    *number = num;\n  } else {\n    // Avoid strtoull() to keep filename format independent of the\n    // current locale\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    Slice suffix = rest;\n    if (suffix == Slice(\".log\")) {\n      *type = kLogFile;\n    } else if (suffix == Slice(\".sst\") || suffix == Slice(\".ldb\")) {\n      *type = kTableFile;\n    } else if (suffix == Slice(\".dbtmp\")) {\n      *type = kTempFile;\n    } else {\n      return false;\n    }\n    *number = num;\n  }\n  return true;\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <ctype.h>\n\nbool ParseFileName(const std::string& fname,\n                   uint64_t* number,\n                   FileType* type) {\n  Slice rest(fname);\n  if (rest == \"CURRENT\") {\n    *number = 0;\n    *type = kCurrentFile;\n  } else if (rest == \"LOCK\") {\n    *number = 0;\n    *type = kDBLockFile;\n  } else if (rest == \"LOG\" || rest == \"LOG.old\") {\n    *number = 0;\n    *type = kInfoLogFile;\n  } else if (rest.starts_with(\"MANIFEST-\")) {\n    rest.remove_prefix(strlen(\"MANIFEST-\"));\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    if (!rest.empty()) {\n      return false;\n    }\n    *type = kDescriptorFile;\n    *number = num;\n  } else {\n    // Avoid strtoull() to keep filename format independent of the\n    // current locale\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    Slice suffix = rest;\n    if (suffix == Slice(\".log\")) {\n      *type = kLogFile;\n    } else if (suffix == Slice(\".sst\") || suffix == Slice(\".ldb\")) {\n      *type = kTableFile;\n    } else if (suffix == Slice(\".dbtmp\")) {\n      *type = kTempFile;\n    } else {\n      return false;\n    }\n    *number = num;\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "cases[i].number",
            "number"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "cases[i].type",
            "type"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "ParseFileName(f, &number, &type)"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n\nTEST(FileNameTest, Parse) {\n  Slice db;\n  FileType type;\n  uint64_t number;\n\n  // Successful parses\n  static struct {\n    const char* fname;\n    uint64_t number;\n    FileType type;\n  } cases[] = {\n    { \"100.log\",            100,   kLogFile },\n    { \"0.log\",              0,     kLogFile },\n    { \"0.sst\",              0,     kTableFile },\n    { \"0.ldb\",              0,     kTableFile },\n    { \"CURRENT\",            0,     kCurrentFile },\n    { \"LOCK\",               0,     kDBLockFile },\n    { \"MANIFEST-2\",         2,     kDescriptorFile },\n    { \"MANIFEST-7\",         7,     kDescriptorFile },\n    { \"LOG\",                0,     kInfoLogFile },\n    { \"LOG.old\",            0,     kInfoLogFile },\n    { \"18446744073709551615.log\", 18446744073709551615ull, kLogFile },\n  };\n  for (int i = 0; i < sizeof(cases) / sizeof(cases[0]); i++) {\n    std::string f = cases[i].fname;\n    ASSERT_TRUE(ParseFileName(f, &number, &type)) << f;\n    ASSERT_EQ(cases[i].type, type) << f;\n    ASSERT_EQ(cases[i].number, number) << f;\n  }\n\n  // Errors\n  static const char* errors[] = {\n    \"\",\n    \"foo\",\n    \"foo-dx-100.log\",\n    \".log\",\n    \"\",\n    \"manifest\",\n    \"CURREN\",\n    \"CURRENTX\",\n    \"MANIFES\",\n    \"MANIFEST\",\n    \"MANIFEST-\",\n    \"XMANIFEST-3\",\n    \"MANIFEST-3x\",\n    \"LOC\",\n    \"LOCKx\",\n    \"LO\",\n    \"LOGx\",\n    \"18446744073709551616.log\",\n    \"184467440737095516150.log\",\n    \"100\",\n    \"100.\",\n    \"100.lop\"\n  };\n  for (int i = 0; i < sizeof(errors) / sizeof(errors[0]); i++) {\n    std::string f = errors[i];\n    ASSERT_TRUE(!ParseFileName(f, &number, &type)) << f;\n  }\n}"
  }
]