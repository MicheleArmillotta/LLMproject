[
  {
    "function_name": "updateView",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "576-738",
    "snippet": "void CoinControlDialog::updateView()\n{\n    bool treeMode = ui->radioTreeMode->isChecked();\n\n    ui->treeWidget->clear();\n    ui->treeWidget->setEnabled(false); // performance, otherwise updateLabels would be called for every checked checkbox\n    ui->treeWidget->setAlternatingRowColors(!treeMode);\n    QFlags<Qt::ItemFlag> flgCheckbox=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable;\n    QFlags<Qt::ItemFlag> flgTristate=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable | Qt::ItemIsTristate;    \n    \n    int nDisplayUnit = BitcoinUnits::BTC;\n    if (model && model->getOptionsModel())\n        nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n        \n    map<QString, vector<COutput> > mapCoins;\n    model->listCoins(mapCoins);\n\n    BOOST_FOREACH(PAIRTYPE(QString, vector<COutput>) coins, mapCoins)\n    {\n        QTreeWidgetItem *itemWalletAddress = new QTreeWidgetItem();\n        QString sWalletAddress = coins.first;\n        QString sWalletLabel = \"\";\n        if (model->getAddressTableModel())\n            sWalletLabel = model->getAddressTableModel()->labelForAddress(sWalletAddress);\n        if (sWalletLabel.length() == 0)\n            sWalletLabel = tr(\"(no label)\");\n        \n        if (treeMode)\n        {\n            // wallet address\n            ui->treeWidget->addTopLevelItem(itemWalletAddress);\n\n            itemWalletAddress->setFlags(flgTristate);\n            itemWalletAddress->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n            \n            for (int i = 0; i < ui->treeWidget->columnCount(); i++)\n                itemWalletAddress->setBackground(i, QColor(248, 247, 246));\n            \n            // label\n            itemWalletAddress->setText(COLUMN_LABEL, sWalletLabel);\n\n            // address\n            itemWalletAddress->setText(COLUMN_ADDRESS, sWalletAddress);\n        }\n\n        int64_t nSum = 0;\n        double dPrioritySum = 0;\n        int nChildren = 0;\n        int nInputSum = 0;\n        BOOST_FOREACH(const COutput& out, coins.second)\n        {\n            int nInputSize = 148; // 180 if uncompressed public key\n            nSum += out.tx->vout[out.i].nValue;\n            nChildren++;\n            \n            QTreeWidgetItem *itemOutput;\n            if (treeMode)    itemOutput = new QTreeWidgetItem(itemWalletAddress);\n            else             itemOutput = new QTreeWidgetItem(ui->treeWidget);\n            itemOutput->setFlags(flgCheckbox);\n            itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n                \n            // address\n            CTxDestination outputAddress;\n            QString sAddress = \"\";\n            if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, outputAddress))\n            {\n                sAddress = CBitcoinAddress(outputAddress).ToString().c_str();\n                \n                // if listMode or change => show bitcoin address. In tree mode, address is not shown again for direct wallet address outputs\n                if (!treeMode || (!(sAddress == sWalletAddress)))\n                    itemOutput->setText(COLUMN_ADDRESS, sAddress);\n                    \n                CPubKey pubkey;\n                CKeyID *keyid = boost::get< CKeyID >(&outputAddress);\n                if (keyid && model->getPubKey(*keyid, pubkey) && !pubkey.IsCompressed())\n                    nInputSize = 180;\n            }\n\n            // label\n            if (!(sAddress == sWalletAddress)) // change\n            {\n                // tooltip from where the change comes from\n                itemOutput->setToolTip(COLUMN_LABEL, tr(\"change from %1 (%2)\").arg(sWalletLabel).arg(sWalletAddress));\n                itemOutput->setText(COLUMN_LABEL, tr(\"(change)\"));\n            }\n            else if (!treeMode)\n            {\n                QString sLabel = \"\";\n                if (model->getAddressTableModel())\n                    sLabel = model->getAddressTableModel()->labelForAddress(sAddress);\n                if (sLabel.length() == 0)\n                    sLabel = tr(\"(no label)\");\n                itemOutput->setText(COLUMN_LABEL, sLabel); \n            }\n\n            // amount\n            itemOutput->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, out.tx->vout[out.i].nValue));\n            itemOutput->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(out.tx->vout[out.i].nValue), 15, \" \")); // padding so that sorting works correctly\n\n            // date\n            itemOutput->setText(COLUMN_DATE, QDateTime::fromTime_t(out.tx->GetTxTime()).toUTC().toString(\"yy-MM-dd hh:mm\"));\n            \n            // immature PoS reward\n            if (out.tx->IsCoinStake() && out.tx->GetBlocksToMaturity() > 0 && out.tx->GetDepthInMainChain() > 0) {\n              itemOutput->setBackground(COLUMN_CONFIRMATIONS, Qt::red);\n              itemOutput->setDisabled(true);\n            }\n\n            // confirmations\n            itemOutput->setText(COLUMN_CONFIRMATIONS, strPad(QString::number(out.nDepth), 8, \" \"));\n            \n            // priority\n            double dPriority = ((double)out.tx->vout[out.i].nValue  / (nInputSize + 78)) * (out.nDepth+1); // 78 = 2 * 34 + 10\n            itemOutput->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPriority));\n            itemOutput->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPriority), 20, \" \"));\n            dPrioritySum += (double)out.tx->vout[out.i].nValue  * (out.nDepth+1);\n            nInputSum    += nInputSize;\n            \n            // transaction hash\n            uint256 txhash = out.tx->GetHash();\n            itemOutput->setText(COLUMN_TXHASH, txhash.GetHex().c_str());\n    \n            // vout index\n            itemOutput->setText(COLUMN_VOUT_INDEX, QString::number(out.i));\n            \n            // disable locked coins     \n            /*if (model->isLockedCoin(txhash, out.i))\n            {\n                COutPoint outpt(txhash, out.i);\n                coinControl->UnSelect(outpt); // just to be sure\n                itemOutput->setDisabled(true);\n                itemOutput->setIcon(COLUMN_CHECKBOX, QIcon(\":/icons/lock_closed\"));\n            }*/\n              \n            // set checkbox\n            if (coinControl->IsSelected(txhash, out.i))\n                itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Checked);\n        }\n\n        // amount\n        if (treeMode)\n        {\n            dPrioritySum = dPrioritySum / (nInputSum + 78);\n            itemWalletAddress->setText(COLUMN_CHECKBOX, \"(\" + QString::number(nChildren) + \")\");\n            itemWalletAddress->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, nSum));\n            itemWalletAddress->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(nSum), 15, \" \"));\n            itemWalletAddress->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPrioritySum));\n            itemWalletAddress->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPrioritySum), 20, \" \"));\n        }\n    }\n    \n    // expand all partially selected\n    if (treeMode)\n    {\n        for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n            if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) == Qt::PartiallyChecked)\n                ui->treeWidget->topLevelItem(i)->setExpanded(true);\n    }\n    \n    // sort view\n    sortView(sortColumn, sortOrder);\n    ui->treeWidget->setEnabled(true);\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "CCoinControl* CoinControlDialog::coinControl = new CCoinControl();"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->treeWidget->setEnabled",
          "args": [
            "true"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sortView",
          "args": [
            "sortColumn",
            "sortOrder"
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "sortView",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "313-319",
          "snippet": "void CoinControlDialog::sortView(int column, Qt::SortOrder order)\n{\n    sortColumn = column;\n    sortOrder = order;\n    ui->treeWidget->sortItems(column, order);\n    ui->treeWidget->header()->setSortIndicator((sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn)), sortOrder);\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::sortView(int column, Qt::SortOrder order)\n  {\n      sortColumn = column;\n      sortOrder = order;\n      ui->treeWidget->sortItems(column, order);\n      ui->treeWidget->header()->setSortIndicator((sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn)), sortOrder);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->topLevelItem",
          "args": [
            "true"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->topLevelItem",
          "args": [
            "i"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->topLevelItem",
          "args": [
            "COLUMN_CHECKBOX"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->topLevelItem",
          "args": [
            "i"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->topLevelItemCount",
          "args": [],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemWalletAddress->setText",
          "args": [
            "COLUMN_PRIORITY_INT64",
            "strPad(QString::number((int64_t)dPrioritySum), 20, \" \")"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strPad",
          "args": [
            "QString::number((int64_t)dPrioritySum)",
            "20",
            "\" \""
          ],
          "line": 723
        },
        "resolved": true,
        "details": {
          "function_name": "strPad",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "141-147",
          "snippet": "QString CoinControlDialog::strPad(QString s, int nPadLength, QString sPadding)\n{\n    while (s.length() < nPadLength)\n        s = sPadding + s;\n\n    return s;\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  QString CoinControlDialog::strPad(QString s, int nPadLength, QString sPadding)\n  {\n      while (s.length() < nPadLength)\n          s = sPadding + s;\n  \n      return s;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "(int64_t)dPrioritySum"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemWalletAddress->setText",
          "args": [
            "COLUMN_PRIORITY",
            "CoinControlDialog::getPriorityLabel(dPrioritySum)"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CoinControlDialog::getPriorityLabel",
          "args": [
            "dPrioritySum"
          ],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "getPriorityLabel",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "383-398",
          "snippet": "QString CoinControlDialog::getPriorityLabel(double dPriority)\n{\n    if (dPriority > 576000ULL) // at least medium, this number is from AllowFree(), the other thresholds are kinda random\n    {\n        if      (dPriority > 5760000000ULL)   return tr(\"highest\");\n        else if (dPriority > 576000000ULL)    return tr(\"high\");\n        else if (dPriority > 57600000ULL)     return tr(\"medium-high\");\n        else                                    return tr(\"medium\");\n    }\n    else\n    {\n        if      (dPriority > 5760ULL) return tr(\"low-medium\");\n        else if (dPriority > 58ULL)   return tr(\"low\");\n        else                            return tr(\"lowest\");\n    }\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  QString CoinControlDialog::getPriorityLabel(double dPriority)\n  {\n      if (dPriority > 576000ULL) // at least medium, this number is from AllowFree(), the other thresholds are kinda random\n      {\n          if      (dPriority > 5760000000ULL)   return tr(\"highest\");\n          else if (dPriority > 576000000ULL)    return tr(\"high\");\n          else if (dPriority > 57600000ULL)     return tr(\"medium-high\");\n          else                                    return tr(\"medium\");\n      }\n      else\n      {\n          if      (dPriority > 5760ULL) return tr(\"low-medium\");\n          else if (dPriority > 58ULL)   return tr(\"low\");\n          else                            return tr(\"lowest\");\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "itemWalletAddress->setText",
          "args": [
            "COLUMN_AMOUNT_INT64",
            "strPad(QString::number(nSum), 15, \" \")"
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "nSum"
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemWalletAddress->setText",
          "args": [
            "COLUMN_AMOUNT",
            "BitcoinUnits::format(nDisplayUnit, nSum)"
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::format",
          "args": [
            "nDisplayUnit",
            "nSum"
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemWalletAddress->setText",
          "args": [
            "COLUMN_CHECKBOX",
            "\"(\" + QString::number(nChildren) + \")\""
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "nChildren"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemOutput->setCheckState",
          "args": [
            "COLUMN_CHECKBOX",
            "Qt::Checked"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControl->IsSelected",
          "args": [
            "txhash",
            "out.i"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "IsSelected",
          "container": "CCoinControl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/coincontrol.h",
          "lines": "26-30",
          "snippet": "bool IsSelected(const uint256& hash, unsigned int n) const\n    {\n        COutPoint outpt(hash, n);\n        return (setSelected.count(outpt) > 0);\n    }",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "CCoinControl {\n  bool IsSelected(const uint256& hash, unsigned int n) const\n      {\n          COutPoint outpt(hash, n);\n          return (setSelected.count(outpt) > 0);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "itemOutput->setText",
          "args": [
            "COLUMN_VOUT_INDEX",
            "QString::number(out.i)"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "out.i"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemOutput->setText",
          "args": [
            "COLUMN_TXHASH",
            "txhash.GetHex().c_str()"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "txhash.GetHex",
          "args": [],
          "line": 696
        },
        "resolved": true,
        "details": {
          "function_name": "GetHex",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "402-405",
          "snippet": "std::string GetHex() const\n    {\n        return ToString(16);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  std::string GetHex() const\n      {\n          return ToString(16);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "out.tx->GetHash",
          "args": [],
          "line": 695
        },
        "resolved": true,
        "details": {
          "function_name": "GetHash",
          "container": "CNetAddr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "922-928",
          "snippet": "uint64_t CNetAddr::GetHash() const\n{\n    uint256 hash = Hash(&ip[0], &ip[16]);\n    uint64_t nRet;\n    memcpy(&nRet, &hash, sizeof(nRet));\n    return nRet;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCNetAddr {\n  uint64_t CNetAddr::GetHash() const\n  {\n      uint256 hash = Hash(&ip[0], &ip[16]);\n      uint64_t nRet;\n      memcpy(&nRet, &hash, sizeof(nRet));\n      return nRet;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "itemOutput->setText",
          "args": [
            "COLUMN_PRIORITY_INT64",
            "strPad(QString::number((int64_t)dPriority), 20, \" \")"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "(int64_t)dPriority"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemOutput->setText",
          "args": [
            "COLUMN_PRIORITY",
            "CoinControlDialog::getPriorityLabel(dPriority)"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemOutput->setText",
          "args": [
            "COLUMN_CONFIRMATIONS",
            "strPad(QString::number(out.nDepth), 8, \" \")"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "out.nDepth"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemOutput->setDisabled",
          "args": [
            "true"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemOutput->setBackground",
          "args": [
            "COLUMN_CONFIRMATIONS",
            "Qt::red"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "out.tx->GetDepthInMainChain",
          "args": [],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "GetDepthInMainChain",
          "container": "CMerkleTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "765-765",
          "snippet": "int GetDepthInMainChain() const { CBlockIndex *pindexRet; return GetDepthInMainChain(pindexRet); }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCMerkleTx {\n  int GetDepthInMainChain() const { CBlockIndex *pindexRet; return GetDepthInMainChain(pindexRet); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "out.tx->GetBlocksToMaturity",
          "args": [],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "GetBlocksToMaturity",
          "container": "CMerkleTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "817-822",
          "snippet": "int CMerkleTx::GetBlocksToMaturity() const\n{\n    if (!(IsCoinBase() || IsCoinStake()))\n        return 0;\n    return max(0, (nCoinbaseMaturity+10) - GetDepthInMainChain());\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int nCoinbaseMaturity = 50;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nint nCoinbaseMaturity = 50;\n\nCMerkleTx {\n  int CMerkleTx::GetBlocksToMaturity() const\n  {\n      if (!(IsCoinBase() || IsCoinStake()))\n          return 0;\n      return max(0, (nCoinbaseMaturity+10) - GetDepthInMainChain());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "out.tx->IsCoinStake",
          "args": [],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinStake",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "542-546",
          "snippet": "bool IsCoinStake() const\n    {\n        // ppcoin: the coin stake transaction is marked with the first output empty\n        return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinStake() const\n      {\n          // ppcoin: the coin stake transaction is marked with the first output empty\n          return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "itemOutput->setText",
          "args": [
            "COLUMN_DATE",
            "QDateTime::fromTime_t(out.tx->GetTxTime()).toUTC().toString(\"yy-MM-dd hh:mm\")"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDateTime::fromTime_t",
          "args": [
            "\"yy-MM-dd hh:mm\""
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDateTime::fromTime_t",
          "args": [],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDateTime::fromTime_t",
          "args": [
            "out.tx->GetTxTime()"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "out.tx->GetTxTime",
          "args": [],
          "line": 676
        },
        "resolved": true,
        "details": {
          "function_name": "GetTxTime",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.cpp",
          "lines": "633-637",
          "snippet": "int64_t CWalletTx::GetTxTime() const\n{\n    int64_t n = nTimeSmart;\n    return n ? n : nTimeReceived;\n}",
          "includes": [
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"coincontrol.h\"",
            "#include \"kernel.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"crypter.h\"",
            "#include \"walletdb.h\"",
            "#include \"wallet.h\"",
            "#include \"txdb.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/replace.hpp>\n#include \"coincontrol.h\"\n#include \"kernel.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"crypter.h\"\n#include \"walletdb.h\"\n#include \"wallet.h\"\n#include \"txdb.h\"\n\nCWalletTx {\n  int64_t CWalletTx::GetTxTime() const\n  {\n      int64_t n = nTimeSmart;\n      return n ? n : nTimeReceived;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "itemOutput->setText",
          "args": [
            "COLUMN_AMOUNT_INT64",
            "strPad(QString::number(out.tx->vout[out.i].nValue), 15, \" \")"
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "out.tx->vout[out.i].nValue"
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemOutput->setText",
          "args": [
            "COLUMN_AMOUNT",
            "BitcoinUnits::format(nDisplayUnit, out.tx->vout[out.i].nValue)"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::format",
          "args": [
            "nDisplayUnit",
            "out.tx->vout[out.i].nValue"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemOutput->setText",
          "args": [
            "COLUMN_LABEL",
            "sLabel"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sLabel.length",
          "args": [],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [
            "sAddress"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemOutput->setText",
          "args": [
            "COLUMN_LABEL",
            "tr(\"(change)\")"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemOutput->setToolTip",
          "args": [
            "COLUMN_LABEL",
            "tr(\"change from %1 (%2)\").arg(sWalletLabel).arg(sWalletAddress)"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pubkey.IsCompressed",
          "args": [],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "IsCompressed",
          "container": "CPubKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "92-94",
          "snippet": "bool IsCompressed() const {\n        return vchPubKey.size() == 33;\n    }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  bool IsCompressed() const {\n          return vchPubKey.size() == 33;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getPubKey",
          "args": [
            "*keyid",
            "pubkey"
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "getPubKey",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "407-410",
          "snippet": "bool WalletModel::getPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) const\n{\n    return wallet->GetPubKey(address, vchPubKeyOut);   \n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  bool WalletModel::getPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) const\n  {\n      return wallet->GetPubKey(address, vchPubKeyOut);   \n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "boost::get< CKeyID >",
          "args": [
            "&outputAddress"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemOutput->setText",
          "args": [
            "COLUMN_ADDRESS",
            "sAddress"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "IsScript",
          "container": "CBitcoinAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "384-394",
          "snippet": "bool IsScript() const {\n        if (!IsValid())\n            return false;\n        switch (nVersion) {\n        case SCRIPT_ADDRESS:\n        case SCRIPT_ADDRESS_TEST: {\n            return true;\n        }\n        default: return false;\n        }\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool IsScript() const {\n          if (!IsValid())\n              return false;\n          switch (nVersion) {\n          case SCRIPT_ADDRESS:\n          case SCRIPT_ADDRESS_TEST: {\n              return true;\n          }\n          default: return false;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [
            "outputAddress"
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "operator()",
          "container": "CBitcoinAddressVisitor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "399-399",
          "snippet": "bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddressVisitor {\n  bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ExtractDestination",
          "args": [
            "out.tx->vout[out.i].scriptPubKey",
            "outputAddress"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "ExtractDestination",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.cpp",
          "lines": "1590-1614",
          "snippet": "bool ExtractDestination(const CScript& scriptPubKey, CTxDestination& addressRet)\n{\n    vector<valtype> vSolutions;\n    txnouttype whichType;\n    if (!Solver(scriptPubKey, whichType, vSolutions))\n        return false;\n\n    if (whichType == TX_PUBKEY)\n    {\n        addressRet = CPubKey(vSolutions[0]).GetID();\n        return true;\n    }\n    else if (whichType == TX_PUBKEYHASH)\n    {\n        addressRet = CKeyID(uint160(vSolutions[0]));\n        return true;\n    }\n    else if (whichType == TX_SCRIPTHASH)\n    {\n        addressRet = CScriptID(uint160(vSolutions[0]));\n        return true;\n    }\n    // Multisig txns have more than one address...\n    return false;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"sync.h\"",
            "#include \"main.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include \"script.h\"",
            "#include <boost/tuple/tuple_comparison.hpp>",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/foreach.hpp>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"sync.h\"\n#include \"main.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include \"keystore.h\"\n#include \"script.h\"\n#include <boost/tuple/tuple_comparison.hpp>\n#include <boost/tuple/tuple.hpp>\n#include <boost/foreach.hpp>\n\nbool ExtractDestination(const CScript& scriptPubKey, CTxDestination& addressRet)\n{\n    vector<valtype> vSolutions;\n    txnouttype whichType;\n    if (!Solver(scriptPubKey, whichType, vSolutions))\n        return false;\n\n    if (whichType == TX_PUBKEY)\n    {\n        addressRet = CPubKey(vSolutions[0]).GetID();\n        return true;\n    }\n    else if (whichType == TX_PUBKEYHASH)\n    {\n        addressRet = CKeyID(uint160(vSolutions[0]));\n        return true;\n    }\n    else if (whichType == TX_SCRIPTHASH)\n    {\n        addressRet = CScriptID(uint160(vSolutions[0]));\n        return true;\n    }\n    // Multisig txns have more than one address...\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "itemOutput->setCheckState",
          "args": [
            "COLUMN_CHECKBOX",
            "Qt::Unchecked"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemOutput->setFlags",
          "args": [
            "flgCheckbox"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemWalletAddress->setText",
          "args": [
            "COLUMN_ADDRESS",
            "sWalletAddress"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemWalletAddress->setText",
          "args": [
            "COLUMN_LABEL",
            "sWalletLabel"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemWalletAddress->setBackground",
          "args": [
            "i",
            "QColor(248, 247, 246)"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QColor",
          "args": [
            "248",
            "247",
            "246"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->columnCount",
          "args": [],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemWalletAddress->setCheckState",
          "args": [
            "COLUMN_CHECKBOX",
            "Qt::Unchecked"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemWalletAddress->setFlags",
          "args": [
            "flgTristate"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->addTopLevelItem",
          "args": [
            "itemWalletAddress"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sWalletLabel.length",
          "args": [],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [
            "sWalletAddress"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BOOST_FOREACH",
          "args": [
            "PAIRTYPE(QString, vector<COutput>)coins",
            "mapCoins"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PAIRTYPE",
          "args": [
            "QString",
            "vector<COutput>"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->listCoins",
          "args": [
            "mapCoins"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "listCoins",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "426-456",
          "snippet": "void WalletModel::listCoins(std::map<QString, std::vector<COutput> >& mapCoins) const\n{\n    std::vector<COutput> vCoins;\n    wallet->AvailableCoins(vCoins);\n    std::vector<COutPoint> vLockedCoins;\n\n    // add locked coins\n    BOOST_FOREACH(const COutPoint& outpoint, vLockedCoins)\n    {\n        if (!wallet->mapWallet.count(outpoint.hash)) continue;\n        int nDepth = wallet->mapWallet[outpoint.hash].GetDepthInMainChain();\n        if (nDepth < 0) continue;\n        COutput out(&wallet->mapWallet[outpoint.hash], outpoint.n, nDepth);\n        vCoins.push_back(out);\n    }\n\n    BOOST_FOREACH(const COutput& out, vCoins)\n    {\n        COutput cout = out;\n\n        while (wallet->IsChange(cout.tx->vout[cout.i]) && cout.tx->vin.size() > 0 && wallet->IsMine(cout.tx->vin[0]))\n        {\n            if (!wallet->mapWallet.count(cout.tx->vin[0].prevout.hash)) break;\n            cout = COutput(&wallet->mapWallet[cout.tx->vin[0].prevout.hash], cout.tx->vin[0].prevout.n, 0);\n        }\n\n        CTxDestination address;\n        if(!ExtractDestination(cout.tx->vout[cout.i].scriptPubKey, address)) continue;\n        mapCoins[CBitcoinAddress(address).ToString().c_str()].push_back(out);\n    }\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  void WalletModel::listCoins(std::map<QString, std::vector<COutput> >& mapCoins) const\n  {\n      std::vector<COutput> vCoins;\n      wallet->AvailableCoins(vCoins);\n      std::vector<COutPoint> vLockedCoins;\n  \n      // add locked coins\n      BOOST_FOREACH(const COutPoint& outpoint, vLockedCoins)\n      {\n          if (!wallet->mapWallet.count(outpoint.hash)) continue;\n          int nDepth = wallet->mapWallet[outpoint.hash].GetDepthInMainChain();\n          if (nDepth < 0) continue;\n          COutput out(&wallet->mapWallet[outpoint.hash], outpoint.n, nDepth);\n          vCoins.push_back(out);\n      }\n  \n      BOOST_FOREACH(const COutput& out, vCoins)\n      {\n          COutput cout = out;\n  \n          while (wallet->IsChange(cout.tx->vout[cout.i]) && cout.tx->vin.size() > 0 && wallet->IsMine(cout.tx->vin[0]))\n          {\n              if (!wallet->mapWallet.count(cout.tx->vin[0].prevout.hash)) break;\n              cout = COutput(&wallet->mapWallet[cout.tx->vin[0].prevout.hash], cout.tx->vin[0].prevout.n, 0);\n          }\n  \n          CTxDestination address;\n          if(!ExtractDestination(cout.tx->vout[cout.i].scriptPubKey, address)) continue;\n          mapCoins[CBitcoinAddress(address).ToString().c_str()].push_back(out);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setAlternatingRowColors",
          "args": [
            "!treeMode"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setEnabled",
          "args": [
            "false"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->clear",
          "args": [],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->radioTreeMode->isChecked",
          "args": [],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCCoinControl* CoinControlDialog::coinControl = new CCoinControl();\n\nCoinControlDialog {\n  void CoinControlDialog::updateView()\n  {\n      bool treeMode = ui->radioTreeMode->isChecked();\n  \n      ui->treeWidget->clear();\n      ui->treeWidget->setEnabled(false); // performance, otherwise updateLabels would be called for every checked checkbox\n      ui->treeWidget->setAlternatingRowColors(!treeMode);\n      QFlags<Qt::ItemFlag> flgCheckbox=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable;\n      QFlags<Qt::ItemFlag> flgTristate=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable | Qt::ItemIsTristate;    \n      \n      int nDisplayUnit = BitcoinUnits::BTC;\n      if (model && model->getOptionsModel())\n          nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n          \n      map<QString, vector<COutput> > mapCoins;\n      model->listCoins(mapCoins);\n  \n      BOOST_FOREACH(PAIRTYPE(QString, vector<COutput>) coins, mapCoins)\n      {\n          QTreeWidgetItem *itemWalletAddress = new QTreeWidgetItem();\n          QString sWalletAddress = coins.first;\n          QString sWalletLabel = \"\";\n          if (model->getAddressTableModel())\n              sWalletLabel = model->getAddressTableModel()->labelForAddress(sWalletAddress);\n          if (sWalletLabel.length() == 0)\n              sWalletLabel = tr(\"(no label)\");\n          \n          if (treeMode)\n          {\n              // wallet address\n              ui->treeWidget->addTopLevelItem(itemWalletAddress);\n  \n              itemWalletAddress->setFlags(flgTristate);\n              itemWalletAddress->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n              \n              for (int i = 0; i < ui->treeWidget->columnCount(); i++)\n                  itemWalletAddress->setBackground(i, QColor(248, 247, 246));\n              \n              // label\n              itemWalletAddress->setText(COLUMN_LABEL, sWalletLabel);\n  \n              // address\n              itemWalletAddress->setText(COLUMN_ADDRESS, sWalletAddress);\n          }\n  \n          int64_t nSum = 0;\n          double dPrioritySum = 0;\n          int nChildren = 0;\n          int nInputSum = 0;\n          BOOST_FOREACH(const COutput& out, coins.second)\n          {\n              int nInputSize = 148; // 180 if uncompressed public key\n              nSum += out.tx->vout[out.i].nValue;\n              nChildren++;\n              \n              QTreeWidgetItem *itemOutput;\n              if (treeMode)    itemOutput = new QTreeWidgetItem(itemWalletAddress);\n              else             itemOutput = new QTreeWidgetItem(ui->treeWidget);\n              itemOutput->setFlags(flgCheckbox);\n              itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n                  \n              // address\n              CTxDestination outputAddress;\n              QString sAddress = \"\";\n              if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, outputAddress))\n              {\n                  sAddress = CBitcoinAddress(outputAddress).ToString().c_str();\n                  \n                  // if listMode or change => show bitcoin address. In tree mode, address is not shown again for direct wallet address outputs\n                  if (!treeMode || (!(sAddress == sWalletAddress)))\n                      itemOutput->setText(COLUMN_ADDRESS, sAddress);\n                      \n                  CPubKey pubkey;\n                  CKeyID *keyid = boost::get< CKeyID >(&outputAddress);\n                  if (keyid && model->getPubKey(*keyid, pubkey) && !pubkey.IsCompressed())\n                      nInputSize = 180;\n              }\n  \n              // label\n              if (!(sAddress == sWalletAddress)) // change\n              {\n                  // tooltip from where the change comes from\n                  itemOutput->setToolTip(COLUMN_LABEL, tr(\"change from %1 (%2)\").arg(sWalletLabel).arg(sWalletAddress));\n                  itemOutput->setText(COLUMN_LABEL, tr(\"(change)\"));\n              }\n              else if (!treeMode)\n              {\n                  QString sLabel = \"\";\n                  if (model->getAddressTableModel())\n                      sLabel = model->getAddressTableModel()->labelForAddress(sAddress);\n                  if (sLabel.length() == 0)\n                      sLabel = tr(\"(no label)\");\n                  itemOutput->setText(COLUMN_LABEL, sLabel); \n              }\n  \n              // amount\n              itemOutput->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, out.tx->vout[out.i].nValue));\n              itemOutput->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(out.tx->vout[out.i].nValue), 15, \" \")); // padding so that sorting works correctly\n  \n              // date\n              itemOutput->setText(COLUMN_DATE, QDateTime::fromTime_t(out.tx->GetTxTime()).toUTC().toString(\"yy-MM-dd hh:mm\"));\n              \n              // immature PoS reward\n              if (out.tx->IsCoinStake() && out.tx->GetBlocksToMaturity() > 0 && out.tx->GetDepthInMainChain() > 0) {\n                itemOutput->setBackground(COLUMN_CONFIRMATIONS, Qt::red);\n                itemOutput->setDisabled(true);\n              }\n  \n              // confirmations\n              itemOutput->setText(COLUMN_CONFIRMATIONS, strPad(QString::number(out.nDepth), 8, \" \"));\n              \n              // priority\n              double dPriority = ((double)out.tx->vout[out.i].nValue  / (nInputSize + 78)) * (out.nDepth+1); // 78 = 2 * 34 + 10\n              itemOutput->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPriority));\n              itemOutput->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPriority), 20, \" \"));\n              dPrioritySum += (double)out.tx->vout[out.i].nValue  * (out.nDepth+1);\n              nInputSum    += nInputSize;\n              \n              // transaction hash\n              uint256 txhash = out.tx->GetHash();\n              itemOutput->setText(COLUMN_TXHASH, txhash.GetHex().c_str());\n      \n              // vout index\n              itemOutput->setText(COLUMN_VOUT_INDEX, QString::number(out.i));\n              \n              // disable locked coins     \n              /*if (model->isLockedCoin(txhash, out.i))\n              {\n                  COutPoint outpt(txhash, out.i);\n                  coinControl->UnSelect(outpt); // just to be sure\n                  itemOutput->setDisabled(true);\n                  itemOutput->setIcon(COLUMN_CHECKBOX, QIcon(\":/icons/lock_closed\"));\n              }*/\n                \n              // set checkbox\n              if (coinControl->IsSelected(txhash, out.i))\n                  itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Checked);\n          }\n  \n          // amount\n          if (treeMode)\n          {\n              dPrioritySum = dPrioritySum / (nInputSum + 78);\n              itemWalletAddress->setText(COLUMN_CHECKBOX, \"(\" + QString::number(nChildren) + \")\");\n              itemWalletAddress->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, nSum));\n              itemWalletAddress->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(nSum), 15, \" \"));\n              itemWalletAddress->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPrioritySum));\n              itemWalletAddress->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPrioritySum), 20, \" \"));\n          }\n      }\n      \n      // expand all partially selected\n      if (treeMode)\n      {\n          for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n              if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) == Qt::PartiallyChecked)\n                  ui->treeWidget->topLevelItem(i)->setExpanded(true);\n      }\n      \n      // sort view\n      sortView(sortColumn, sortOrder);\n      ui->treeWidget->setEnabled(true);\n  }\n}"
  },
  {
    "function_name": "updateLabels",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "413-574",
    "snippet": "void CoinControlDialog::updateLabels(WalletModel *model, QDialog* dialog)\n{\n    if (!model) return;\n\n    // nPayAmount\n    qint64 nPayAmount = 0;\n    bool fLowOutput = false;\n    bool fDust = false;\n    CTransaction txDummy;\n    foreach(const qint64 &amount, CoinControlDialog::payAmounts)\n    {\n        nPayAmount += amount;\n\n        if (amount > 0)\n        {\n            if (amount < CENT)\n                fLowOutput = true;\n\n            CTxOut txout(amount, (CScript)vector<unsigned char>(24, 0));\n            txDummy.vout.push_back(txout);\n        }\n    }\n\n    QString sPriorityLabel      = \"\";\n    int64_t nAmount             = 0;\n    int64_t nPayFee             = 0;\n    int64_t nAfterFee           = 0;\n    int64_t nChange             = 0;\n    unsigned int nBytes         = 0;\n    unsigned int nBytesInputs   = 0;\n    double dPriority            = 0;\n    double dPriorityInputs      = 0;\n    unsigned int nQuantity      = 0;\n    \n    vector<COutPoint> vCoinControl;\n    vector<COutput>   vOutputs;\n    coinControl->ListSelected(vCoinControl);\n    model->getOutputs(vCoinControl, vOutputs);\n\n    BOOST_FOREACH(const COutput& out, vOutputs)\n    {\n        // Quantity\n        nQuantity++;\n            \n        // Amount\n        nAmount += out.tx->vout[out.i].nValue;\n        \n        // Priority\n        dPriorityInputs += (double)out.tx->vout[out.i].nValue * (out.nDepth+1);\n        \n        // Bytes\n        CTxDestination address;\n        if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, address))\n        {\n            CPubKey pubkey;\n            CKeyID *keyid = boost::get< CKeyID >(&address);\n            if (keyid && model->getPubKey(*keyid, pubkey))\n                nBytesInputs += (pubkey.IsCompressed() ? 148 : 180);\n            else\n                nBytesInputs += 148; // in all error cases, simply assume 148 here\n        }\n        else nBytesInputs += 148;\n    }\n    \n    // calculation\n    if (nQuantity > 0)\n    {\n        // Bytes\n        nBytes = nBytesInputs + ((CoinControlDialog::payAmounts.size() > 0 ? CoinControlDialog::payAmounts.size() + 1 : 2) * 34) + 10; // always assume +1 output for change here\n        \n        // Priority\n        dPriority = dPriorityInputs / nBytes;\n        sPriorityLabel = CoinControlDialog::getPriorityLabel(dPriority);\n        \n        // Fee\n        int64_t nFee = nTransactionFee * (1 + (int64_t)nBytes / 1000);\n        \n        // Min Fee\n        int64_t nMinFee = txDummy.GetMinFee(1, GMF_SEND, nBytes);\n        \n        nPayFee = max(nFee, nMinFee);\n        \n        if (nPayAmount > 0)\n        {\n            nChange = nAmount - nPayFee - nPayAmount;\n            \n            // if sub-cent change is required, the fee must be raised to at least CTransaction::nMinTxFee   \n            if (nPayFee < CENT && nChange > 0 && nChange < CENT)\n            {\n                if (nChange < CENT) // change < 0.01 => simply move all change to fees\n                {\n                    nPayFee = nChange;\n                    nChange = 0;\n                }\n                else\n                {\n                    nChange = nChange + nPayFee - CENT;\n                    nPayFee = CENT;\n                }  \n            }\n            \n            if (nChange == 0)\n                nBytes -= 34;\n        }\n        \n        // after fee\n        nAfterFee = nAmount - nPayFee;\n        if (nAfterFee < 0)\n            nAfterFee = 0;\n    }\n    \n    // actually update labels\n    int nDisplayUnit = BitcoinUnits::BTC;\n    if (model && model->getOptionsModel())\n        nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n            \n    QLabel *l1 = dialog->findChild<QLabel *>(\"labelCoinControlQuantity\");\n    QLabel *l2 = dialog->findChild<QLabel *>(\"labelCoinControlAmount\");\n    QLabel *l3 = dialog->findChild<QLabel *>(\"labelCoinControlFee\");\n    QLabel *l4 = dialog->findChild<QLabel *>(\"labelCoinControlAfterFee\");\n    QLabel *l5 = dialog->findChild<QLabel *>(\"labelCoinControlBytes\");\n    QLabel *l6 = dialog->findChild<QLabel *>(\"labelCoinControlPriority\");\n    QLabel *l7 = dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\");\n    QLabel *l8 = dialog->findChild<QLabel *>(\"labelCoinControlChange\");\n    \n    // enable/disable \"low output\" and \"change\"\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\")    ->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlChange\")       ->setEnabled(nPayAmount > 0);\n    \n    // stats\n    l1->setText(QString::number(nQuantity));                                 // Quantity        \n    l2->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAmount));        // Amount\n    l3->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nPayFee));        // Fee\n    l4->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAfterFee));      // After Fee\n    l5->setText(((nBytes > 0) ? \"~\" : \"\") + QString::number(nBytes));                                    // Bytes\n    l6->setText(sPriorityLabel);                                             // Priority\n    l7->setText((fLowOutput ? (fDust ? tr(\"DUST\") : tr(\"yes\")) : tr(\"no\"))); // Low Output / Dust\n    l8->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nChange));        // Change\n    \n    // turn labels \"red\"\n    l5->setStyleSheet((nBytes >= 10000) ? \"color:red;\" : \"\");               // Bytes >= 10000\n    l6->setStyleSheet((dPriority <= 576000) ? \"color:red;\" : \"\");         // Priority < \"medium\"\n    l7->setStyleSheet((fLowOutput) ? \"color:red;\" : \"\");                    // Low Output = \"yes\"\n    l8->setStyleSheet((nChange > 0 && nChange < CENT) ? \"color:red;\" : \"\"); // Change < 0.01BTC\n        \n    // tool tips\n    l5->setToolTip(tr(\"This label turns red, if the transaction size is bigger than 10000 bytes.\\n\\n This means a fee of at least %1 per kb is required.\\n\\n Can vary +/- 1 Byte per input.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l6->setToolTip(tr(\"Transactions with higher priority get more likely into a block.\\n\\nThis label turns red, if the priority is smaller than \\\"medium\\\".\\n\\n This means a fee of at least %1 per kb is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l7->setToolTip(tr(\"This label turns red, if any recipient receives an amount smaller than %1.\\n\\n This means a fee of at least %2 is required. \\n\\n Amounts below 0.546 times the minimum relay fee are shown as DUST.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l8->setToolTip(tr(\"This label turns red, if the change is smaller than %1.\\n\\n This means a fee of at least %2 is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    dialog->findChild<QLabel *>(\"labelCoinControlBytesText\")    ->setToolTip(l5->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlPriorityText\") ->setToolTip(l6->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setToolTip(l7->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setToolTip(l8->toolTip());\n   \n    // Insufficient funds\n    QLabel *label = dialog->findChild<QLabel *>(\"labelCoinControlInsuffFunds\");\n    if (label)\n        label->setVisible(nChange < 0);\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "QList<qint64> CoinControlDialog::payAmounts;",
      "CCoinControl* CoinControlDialog::coinControl = new CCoinControl();"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "label->setVisible",
          "args": [
            "nChange < 0"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlInsuffFunds\""
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "l8->toolTip()"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l8->toolTip",
          "args": [],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlChangeText\""
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "l7->toolTip()"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l7->toolTip",
          "args": [],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlLowOutputText\""
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "l6->toolTip()"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l6->toolTip",
          "args": [],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlPriorityText\""
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "l5->toolTip()"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l5->toolTip",
          "args": [],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlBytesText\""
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l8->setToolTip",
          "args": [
            "tr(\"This label turns red, if the change is smaller than %1.\\n\\n This means a fee of at least %2 is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT))"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "getPriorityLabel",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "383-398",
          "snippet": "QString CoinControlDialog::getPriorityLabel(double dPriority)\n{\n    if (dPriority > 576000ULL) // at least medium, this number is from AllowFree(), the other thresholds are kinda random\n    {\n        if      (dPriority > 5760000000ULL)   return tr(\"highest\");\n        else if (dPriority > 576000000ULL)    return tr(\"high\");\n        else if (dPriority > 57600000ULL)     return tr(\"medium-high\");\n        else                                    return tr(\"medium\");\n    }\n    else\n    {\n        if      (dPriority > 5760ULL) return tr(\"low-medium\");\n        else if (dPriority > 58ULL)   return tr(\"low\");\n        else                            return tr(\"lowest\");\n    }\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  QString CoinControlDialog::getPriorityLabel(double dPriority)\n  {\n      if (dPriority > 576000ULL) // at least medium, this number is from AllowFree(), the other thresholds are kinda random\n      {\n          if      (dPriority > 5760000000ULL)   return tr(\"highest\");\n          else if (dPriority > 576000000ULL)    return tr(\"high\");\n          else if (dPriority > 57600000ULL)     return tr(\"medium-high\");\n          else                                    return tr(\"medium\");\n      }\n      else\n      {\n          if      (dPriority > 5760ULL) return tr(\"low-medium\");\n          else if (dPriority > 58ULL)   return tr(\"low\");\n          else                            return tr(\"lowest\");\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "nDisplayUnit",
            "CENT"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "nDisplayUnit",
            "CENT"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l7->setToolTip",
          "args": [
            "tr(\"This label turns red, if any recipient receives an amount smaller than %1.\\n\\n This means a fee of at least %2 is required. \\n\\n Amounts below 0.546 times the minimum relay fee are shown as DUST.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT))"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "nDisplayUnit",
            "CENT"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "nDisplayUnit",
            "CENT"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l6->setToolTip",
          "args": [
            "tr(\"Transactions with higher priority get more likely into a block.\\n\\nThis label turns red, if the priority is smaller than \\\"medium\\\".\\n\\n This means a fee of at least %1 per kb is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT))"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "nDisplayUnit",
            "CENT"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l5->setToolTip",
          "args": [
            "tr(\"This label turns red, if the transaction size is bigger than 10000 bytes.\\n\\n This means a fee of at least %1 per kb is required.\\n\\n Can vary +/- 1 Byte per input.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT))"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "nDisplayUnit",
            "CENT"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l8->setStyleSheet",
          "args": [
            "(nChange > 0 && nChange < CENT) ? \"color:red;\" : \"\""
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l7->setStyleSheet",
          "args": [
            "(fLowOutput) ? \"color:red;\" : \"\""
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l6->setStyleSheet",
          "args": [
            "(dPriority <= 576000) ? \"color:red;\" : \"\""
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l5->setStyleSheet",
          "args": [
            "(nBytes >= 10000) ? \"color:red;\" : \"\""
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l8->setText",
          "args": [
            "BitcoinUnits::formatWithUnit(nDisplayUnit, nChange)"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "nDisplayUnit",
            "nChange"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "nBytes"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "nDisplayUnit",
            "nAfterFee"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "nDisplayUnit",
            "nPayFee"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitcoinUnits::formatWithUnit",
          "args": [
            "nDisplayUnit",
            "nAmount"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "nQuantity"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "nPayAmount > 0"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlChange\""
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "nPayAmount > 0"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlChangeText\""
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "nPayAmount > 0"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlLowOutput\""
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "nPayAmount > 0"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlLowOutputText\""
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlChange\""
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlLowOutput\""
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlPriority\""
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlBytes\""
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlAfterFee\""
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlFee\""
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlAmount\""
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog->findChild<QLabel *>",
          "args": [
            "\"labelCoinControlQuantity\""
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "nFee",
            "nMinFee"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "leveldb_options_set_max_open_files",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "433-435",
          "snippet": "void leveldb_options_set_max_open_files(leveldb_options_t* opt, int n) {\n  opt->rep.max_open_files = n;\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_max_open_files(leveldb_options_t* opt, int n) {\n  opt->rep.max_open_files = n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "txDummy.GetMinFee",
          "args": [
            "1",
            "GMF_SEND",
            "nBytes"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "GetMinFee",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "529-556",
          "snippet": "int64_t CTransaction::GetMinFee(unsigned int nBlockSize, enum GetMinFee_mode mode, unsigned int nBytes) const\n{\n    // Base fee is either MIN_TX_FEE or MIN_RELAY_TX_FEE\n    int64_t nBaseFee = (mode == GMF_RELAY) ? MIN_RELAY_TX_FEE : MIN_TX_FEE;\n\n    unsigned int nNewBlockSize = nBlockSize + nBytes;\n    int64_t nMinFee = (1 + (int64_t)nBytes / 1000) * nBaseFee;\n\n    // To limit dust spam, require MIN_TX_FEE/MIN_RELAY_TX_FEE if any output is less than 0.01\n    if (nMinFee < nBaseFee)\n    {\n        BOOST_FOREACH(const CTxOut& txout, vout)\n            if (txout.nValue < CENT)\n                nMinFee = nBaseFee;\n    }\n\n    // Raise the price as the block approaches full\n    if (nBlockSize != 1 && nNewBlockSize >= MAX_BLOCK_SIZE_GEN/2)\n    {\n        if (nNewBlockSize >= MAX_BLOCK_SIZE_GEN)\n            return MAX_MONEY;\n        nMinFee *= MAX_BLOCK_SIZE_GEN / (MAX_BLOCK_SIZE_GEN - nNewBlockSize);\n    }\n\n    if (!MoneyRange(nMinFee))\n        nMinFee = MAX_MONEY;\n    return nMinFee;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nCTransaction {\n  int64_t CTransaction::GetMinFee(unsigned int nBlockSize, enum GetMinFee_mode mode, unsigned int nBytes) const\n  {\n      // Base fee is either MIN_TX_FEE or MIN_RELAY_TX_FEE\n      int64_t nBaseFee = (mode == GMF_RELAY) ? MIN_RELAY_TX_FEE : MIN_TX_FEE;\n  \n      unsigned int nNewBlockSize = nBlockSize + nBytes;\n      int64_t nMinFee = (1 + (int64_t)nBytes / 1000) * nBaseFee;\n  \n      // To limit dust spam, require MIN_TX_FEE/MIN_RELAY_TX_FEE if any output is less than 0.01\n      if (nMinFee < nBaseFee)\n      {\n          BOOST_FOREACH(const CTxOut& txout, vout)\n              if (txout.nValue < CENT)\n                  nMinFee = nBaseFee;\n      }\n  \n      // Raise the price as the block approaches full\n      if (nBlockSize != 1 && nNewBlockSize >= MAX_BLOCK_SIZE_GEN/2)\n      {\n          if (nNewBlockSize >= MAX_BLOCK_SIZE_GEN)\n              return MAX_MONEY;\n          nMinFee *= MAX_BLOCK_SIZE_GEN / (MAX_BLOCK_SIZE_GEN - nNewBlockSize);\n      }\n  \n      if (!MoneyRange(nMinFee))\n          nMinFee = MAX_MONEY;\n      return nMinFee;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CoinControlDialog::payAmounts.size",
          "args": [],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pubkey.IsCompressed",
          "args": [],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "IsCompressed",
          "container": "CPubKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "92-94",
          "snippet": "bool IsCompressed() const {\n        return vchPubKey.size() == 33;\n    }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  bool IsCompressed() const {\n          return vchPubKey.size() == 33;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getPubKey",
          "args": [
            "*keyid",
            "pubkey"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "getPubKey",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "407-410",
          "snippet": "bool WalletModel::getPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) const\n{\n    return wallet->GetPubKey(address, vchPubKeyOut);   \n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  bool WalletModel::getPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) const\n  {\n      return wallet->GetPubKey(address, vchPubKeyOut);   \n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "boost::get< CKeyID >",
          "args": [
            "&address"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ExtractDestination",
          "args": [
            "out.tx->vout[out.i].scriptPubKey",
            "address"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "ExtractDestination",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.cpp",
          "lines": "1590-1614",
          "snippet": "bool ExtractDestination(const CScript& scriptPubKey, CTxDestination& addressRet)\n{\n    vector<valtype> vSolutions;\n    txnouttype whichType;\n    if (!Solver(scriptPubKey, whichType, vSolutions))\n        return false;\n\n    if (whichType == TX_PUBKEY)\n    {\n        addressRet = CPubKey(vSolutions[0]).GetID();\n        return true;\n    }\n    else if (whichType == TX_PUBKEYHASH)\n    {\n        addressRet = CKeyID(uint160(vSolutions[0]));\n        return true;\n    }\n    else if (whichType == TX_SCRIPTHASH)\n    {\n        addressRet = CScriptID(uint160(vSolutions[0]));\n        return true;\n    }\n    // Multisig txns have more than one address...\n    return false;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"sync.h\"",
            "#include \"main.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include \"script.h\"",
            "#include <boost/tuple/tuple_comparison.hpp>",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/foreach.hpp>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"sync.h\"\n#include \"main.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include \"keystore.h\"\n#include \"script.h\"\n#include <boost/tuple/tuple_comparison.hpp>\n#include <boost/tuple/tuple.hpp>\n#include <boost/foreach.hpp>\n\nbool ExtractDestination(const CScript& scriptPubKey, CTxDestination& addressRet)\n{\n    vector<valtype> vSolutions;\n    txnouttype whichType;\n    if (!Solver(scriptPubKey, whichType, vSolutions))\n        return false;\n\n    if (whichType == TX_PUBKEY)\n    {\n        addressRet = CPubKey(vSolutions[0]).GetID();\n        return true;\n    }\n    else if (whichType == TX_PUBKEYHASH)\n    {\n        addressRet = CKeyID(uint160(vSolutions[0]));\n        return true;\n    }\n    else if (whichType == TX_SCRIPTHASH)\n    {\n        addressRet = CScriptID(uint160(vSolutions[0]));\n        return true;\n    }\n    // Multisig txns have more than one address...\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getOutputs",
          "args": [
            "vCoinControl",
            "vOutputs"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "getOutputs",
          "container": "WalletModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/walletmodel.cpp",
          "lines": "413-423",
          "snippet": "void WalletModel::getOutputs(const std::vector<COutPoint>& vOutpoints, std::vector<COutput>& vOutputs)\n{\n    BOOST_FOREACH(const COutPoint& outpoint, vOutpoints)\n    {\n        if (!wallet->mapWallet.count(outpoint.hash)) continue;\n        int nDepth = wallet->mapWallet[outpoint.hash].GetDepthInMainChain();\n        if (nDepth < 0) continue;\n        COutput out(&wallet->mapWallet[outpoint.hash], outpoint.n, nDepth);\n        vOutputs.push_back(out);\n    }\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QSet>",
            "#include \"base58.h\"",
            "#include \"walletdb.h\" // for BackupWallet",
            "#include \"wallet.h\"",
            "#include \"ui_interface.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"walletmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QSet>\n#include \"base58.h\"\n#include \"walletdb.h\" // for BackupWallet\n#include \"wallet.h\"\n#include \"ui_interface.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"walletmodel.h\"\n\nWalletModel {\n  void WalletModel::getOutputs(const std::vector<COutPoint>& vOutpoints, std::vector<COutput>& vOutputs)\n  {\n      BOOST_FOREACH(const COutPoint& outpoint, vOutpoints)\n      {\n          if (!wallet->mapWallet.count(outpoint.hash)) continue;\n          int nDepth = wallet->mapWallet[outpoint.hash].GetDepthInMainChain();\n          if (nDepth < 0) continue;\n          COutput out(&wallet->mapWallet[outpoint.hash], outpoint.n, nDepth);\n          vOutputs.push_back(out);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "coinControl->ListSelected",
          "args": [
            "vCoinControl"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "ListSelected",
          "container": "CCoinControl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/coincontrol.h",
          "lines": "47-50",
          "snippet": "void ListSelected(std::vector<COutPoint>& vOutpoints)\n    {\n        vOutpoints.assign(setSelected.begin(), setSelected.end());\n    }",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "CCoinControl {\n  void ListSelected(std::vector<COutPoint>& vOutpoints)\n      {\n          vOutpoints.assign(setSelected.begin(), setSelected.end());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "txDummy.vout.push_back",
          "args": [
            "txout"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vector<unsigned char>",
          "args": [
            "24",
            "0"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nQList<qint64> CoinControlDialog::payAmounts;\nCCoinControl* CoinControlDialog::coinControl = new CCoinControl();\n\nCoinControlDialog {\n  void CoinControlDialog::updateLabels(WalletModel *model, QDialog* dialog)\n  {\n      if (!model) return;\n  \n      // nPayAmount\n      qint64 nPayAmount = 0;\n      bool fLowOutput = false;\n      bool fDust = false;\n      CTransaction txDummy;\n      foreach(const qint64 &amount, CoinControlDialog::payAmounts)\n      {\n          nPayAmount += amount;\n  \n          if (amount > 0)\n          {\n              if (amount < CENT)\n                  fLowOutput = true;\n  \n              CTxOut txout(amount, (CScript)vector<unsigned char>(24, 0));\n              txDummy.vout.push_back(txout);\n          }\n      }\n  \n      QString sPriorityLabel      = \"\";\n      int64_t nAmount             = 0;\n      int64_t nPayFee             = 0;\n      int64_t nAfterFee           = 0;\n      int64_t nChange             = 0;\n      unsigned int nBytes         = 0;\n      unsigned int nBytesInputs   = 0;\n      double dPriority            = 0;\n      double dPriorityInputs      = 0;\n      unsigned int nQuantity      = 0;\n      \n      vector<COutPoint> vCoinControl;\n      vector<COutput>   vOutputs;\n      coinControl->ListSelected(vCoinControl);\n      model->getOutputs(vCoinControl, vOutputs);\n  \n      BOOST_FOREACH(const COutput& out, vOutputs)\n      {\n          // Quantity\n          nQuantity++;\n              \n          // Amount\n          nAmount += out.tx->vout[out.i].nValue;\n          \n          // Priority\n          dPriorityInputs += (double)out.tx->vout[out.i].nValue * (out.nDepth+1);\n          \n          // Bytes\n          CTxDestination address;\n          if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, address))\n          {\n              CPubKey pubkey;\n              CKeyID *keyid = boost::get< CKeyID >(&address);\n              if (keyid && model->getPubKey(*keyid, pubkey))\n                  nBytesInputs += (pubkey.IsCompressed() ? 148 : 180);\n              else\n                  nBytesInputs += 148; // in all error cases, simply assume 148 here\n          }\n          else nBytesInputs += 148;\n      }\n      \n      // calculation\n      if (nQuantity > 0)\n      {\n          // Bytes\n          nBytes = nBytesInputs + ((CoinControlDialog::payAmounts.size() > 0 ? CoinControlDialog::payAmounts.size() + 1 : 2) * 34) + 10; // always assume +1 output for change here\n          \n          // Priority\n          dPriority = dPriorityInputs / nBytes;\n          sPriorityLabel = CoinControlDialog::getPriorityLabel(dPriority);\n          \n          // Fee\n          int64_t nFee = nTransactionFee * (1 + (int64_t)nBytes / 1000);\n          \n          // Min Fee\n          int64_t nMinFee = txDummy.GetMinFee(1, GMF_SEND, nBytes);\n          \n          nPayFee = max(nFee, nMinFee);\n          \n          if (nPayAmount > 0)\n          {\n              nChange = nAmount - nPayFee - nPayAmount;\n              \n              // if sub-cent change is required, the fee must be raised to at least CTransaction::nMinTxFee   \n              if (nPayFee < CENT && nChange > 0 && nChange < CENT)\n              {\n                  if (nChange < CENT) // change < 0.01 => simply move all change to fees\n                  {\n                      nPayFee = nChange;\n                      nChange = 0;\n                  }\n                  else\n                  {\n                      nChange = nChange + nPayFee - CENT;\n                      nPayFee = CENT;\n                  }  \n              }\n              \n              if (nChange == 0)\n                  nBytes -= 34;\n          }\n          \n          // after fee\n          nAfterFee = nAmount - nPayFee;\n          if (nAfterFee < 0)\n              nAfterFee = 0;\n      }\n      \n      // actually update labels\n      int nDisplayUnit = BitcoinUnits::BTC;\n      if (model && model->getOptionsModel())\n          nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n              \n      QLabel *l1 = dialog->findChild<QLabel *>(\"labelCoinControlQuantity\");\n      QLabel *l2 = dialog->findChild<QLabel *>(\"labelCoinControlAmount\");\n      QLabel *l3 = dialog->findChild<QLabel *>(\"labelCoinControlFee\");\n      QLabel *l4 = dialog->findChild<QLabel *>(\"labelCoinControlAfterFee\");\n      QLabel *l5 = dialog->findChild<QLabel *>(\"labelCoinControlBytes\");\n      QLabel *l6 = dialog->findChild<QLabel *>(\"labelCoinControlPriority\");\n      QLabel *l7 = dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\");\n      QLabel *l8 = dialog->findChild<QLabel *>(\"labelCoinControlChange\");\n      \n      // enable/disable \"low output\" and \"change\"\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\")    ->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlChange\")       ->setEnabled(nPayAmount > 0);\n      \n      // stats\n      l1->setText(QString::number(nQuantity));                                 // Quantity        \n      l2->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAmount));        // Amount\n      l3->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nPayFee));        // Fee\n      l4->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAfterFee));      // After Fee\n      l5->setText(((nBytes > 0) ? \"~\" : \"\") + QString::number(nBytes));                                    // Bytes\n      l6->setText(sPriorityLabel);                                             // Priority\n      l7->setText((fLowOutput ? (fDust ? tr(\"DUST\") : tr(\"yes\")) : tr(\"no\"))); // Low Output / Dust\n      l8->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nChange));        // Change\n      \n      // turn labels \"red\"\n      l5->setStyleSheet((nBytes >= 10000) ? \"color:red;\" : \"\");               // Bytes >= 10000\n      l6->setStyleSheet((dPriority <= 576000) ? \"color:red;\" : \"\");         // Priority < \"medium\"\n      l7->setStyleSheet((fLowOutput) ? \"color:red;\" : \"\");                    // Low Output = \"yes\"\n      l8->setStyleSheet((nChange > 0 && nChange < CENT) ? \"color:red;\" : \"\"); // Change < 0.01BTC\n          \n      // tool tips\n      l5->setToolTip(tr(\"This label turns red, if the transaction size is bigger than 10000 bytes.\\n\\n This means a fee of at least %1 per kb is required.\\n\\n Can vary +/- 1 Byte per input.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l6->setToolTip(tr(\"Transactions with higher priority get more likely into a block.\\n\\nThis label turns red, if the priority is smaller than \\\"medium\\\".\\n\\n This means a fee of at least %1 per kb is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l7->setToolTip(tr(\"This label turns red, if any recipient receives an amount smaller than %1.\\n\\n This means a fee of at least %2 is required. \\n\\n Amounts below 0.546 times the minimum relay fee are shown as DUST.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l8->setToolTip(tr(\"This label turns red, if the change is smaller than %1.\\n\\n This means a fee of at least %2 is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      dialog->findChild<QLabel *>(\"labelCoinControlBytesText\")    ->setToolTip(l5->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlPriorityText\") ->setToolTip(l6->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setToolTip(l7->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setToolTip(l8->toolTip());\n     \n      // Insufficient funds\n      QLabel *label = dialog->findChild<QLabel *>(\"labelCoinControlInsuffFunds\");\n      if (label)\n          label->setVisible(nChange < 0);\n  }\n}"
  },
  {
    "function_name": "getPriorityLabel",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "383-398",
    "snippet": "QString CoinControlDialog::getPriorityLabel(double dPriority)\n{\n    if (dPriority > 576000ULL) // at least medium, this number is from AllowFree(), the other thresholds are kinda random\n    {\n        if      (dPriority > 5760000000ULL)   return tr(\"highest\");\n        else if (dPriority > 576000000ULL)    return tr(\"high\");\n        else if (dPriority > 57600000ULL)     return tr(\"medium-high\");\n        else                                    return tr(\"medium\");\n    }\n    else\n    {\n        if      (dPriority > 5760ULL) return tr(\"low-medium\");\n        else if (dPriority > 58ULL)   return tr(\"low\");\n        else                            return tr(\"lowest\");\n    }\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"lowest\""
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "getPriorityLabel",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "383-398",
          "snippet": "QString CoinControlDialog::getPriorityLabel(double dPriority)\n{\n    if (dPriority > 576000ULL) // at least medium, this number is from AllowFree(), the other thresholds are kinda random\n    {\n        if      (dPriority > 5760000000ULL)   return tr(\"highest\");\n        else if (dPriority > 576000000ULL)    return tr(\"high\");\n        else if (dPriority > 57600000ULL)     return tr(\"medium-high\");\n        else                                    return tr(\"medium\");\n    }\n    else\n    {\n        if      (dPriority > 5760ULL) return tr(\"low-medium\");\n        else if (dPriority > 58ULL)   return tr(\"low\");\n        else                            return tr(\"lowest\");\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  QString CoinControlDialog::getPriorityLabel(double dPriority)\n  {\n      if (dPriority > 576000ULL) // at least medium, this number is from AllowFree(), the other thresholds are kinda random\n      {\n          if      (dPriority > 5760000000ULL)   return tr(\"highest\");\n          else if (dPriority > 576000000ULL)    return tr(\"high\");\n          else if (dPriority > 57600000ULL)     return tr(\"medium-high\");\n          else                                    return tr(\"medium\");\n      }\n      else\n      {\n          if      (dPriority > 5760ULL) return tr(\"low-medium\");\n          else if (dPriority > 58ULL)   return tr(\"low\");\n          else                            return tr(\"lowest\");\n      }\n  }\n}"
  },
  {
    "function_name": "viewItemChanged",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "363-380",
    "snippet": "void CoinControlDialog::viewItemChanged(QTreeWidgetItem* item, int column)\n{\n    if (column == COLUMN_CHECKBOX && item->text(COLUMN_TXHASH).length() == 64) // transaction hash is 64 characters (this means its a child node, so its not a parent node in tree mode)\n    {\n        COutPoint outpt(uint256(item->text(COLUMN_TXHASH).toStdString()), item->text(COLUMN_VOUT_INDEX).toUInt());\n\n        if (item->checkState(COLUMN_CHECKBOX) == Qt::Unchecked)\n            coinControl->UnSelect(outpt);\n        else if (item->isDisabled()) // locked (this happens if \"check all\" through parent node)\n            item->setCheckState(COLUMN_CHECKBOX, Qt::Unchecked);\n        else\n            coinControl->Select(outpt);\n\n        // selection changed -> update labels\n        if (ui->treeWidget->isEnabled()) // do not update on every click for (un)select all\n            CoinControlDialog::updateLabels(model, this);\n    }\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "CCoinControl* CoinControlDialog::coinControl = new CCoinControl();"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "CoinControlDialog::updateLabels",
          "args": [
            "model",
            "this"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "updateLabels",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "413-574",
          "snippet": "void CoinControlDialog::updateLabels(WalletModel *model, QDialog* dialog)\n{\n    if (!model) return;\n\n    // nPayAmount\n    qint64 nPayAmount = 0;\n    bool fLowOutput = false;\n    bool fDust = false;\n    CTransaction txDummy;\n    foreach(const qint64 &amount, CoinControlDialog::payAmounts)\n    {\n        nPayAmount += amount;\n\n        if (amount > 0)\n        {\n            if (amount < CENT)\n                fLowOutput = true;\n\n            CTxOut txout(amount, (CScript)vector<unsigned char>(24, 0));\n            txDummy.vout.push_back(txout);\n        }\n    }\n\n    QString sPriorityLabel      = \"\";\n    int64_t nAmount             = 0;\n    int64_t nPayFee             = 0;\n    int64_t nAfterFee           = 0;\n    int64_t nChange             = 0;\n    unsigned int nBytes         = 0;\n    unsigned int nBytesInputs   = 0;\n    double dPriority            = 0;\n    double dPriorityInputs      = 0;\n    unsigned int nQuantity      = 0;\n    \n    vector<COutPoint> vCoinControl;\n    vector<COutput>   vOutputs;\n    coinControl->ListSelected(vCoinControl);\n    model->getOutputs(vCoinControl, vOutputs);\n\n    BOOST_FOREACH(const COutput& out, vOutputs)\n    {\n        // Quantity\n        nQuantity++;\n            \n        // Amount\n        nAmount += out.tx->vout[out.i].nValue;\n        \n        // Priority\n        dPriorityInputs += (double)out.tx->vout[out.i].nValue * (out.nDepth+1);\n        \n        // Bytes\n        CTxDestination address;\n        if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, address))\n        {\n            CPubKey pubkey;\n            CKeyID *keyid = boost::get< CKeyID >(&address);\n            if (keyid && model->getPubKey(*keyid, pubkey))\n                nBytesInputs += (pubkey.IsCompressed() ? 148 : 180);\n            else\n                nBytesInputs += 148; // in all error cases, simply assume 148 here\n        }\n        else nBytesInputs += 148;\n    }\n    \n    // calculation\n    if (nQuantity > 0)\n    {\n        // Bytes\n        nBytes = nBytesInputs + ((CoinControlDialog::payAmounts.size() > 0 ? CoinControlDialog::payAmounts.size() + 1 : 2) * 34) + 10; // always assume +1 output for change here\n        \n        // Priority\n        dPriority = dPriorityInputs / nBytes;\n        sPriorityLabel = CoinControlDialog::getPriorityLabel(dPriority);\n        \n        // Fee\n        int64_t nFee = nTransactionFee * (1 + (int64_t)nBytes / 1000);\n        \n        // Min Fee\n        int64_t nMinFee = txDummy.GetMinFee(1, GMF_SEND, nBytes);\n        \n        nPayFee = max(nFee, nMinFee);\n        \n        if (nPayAmount > 0)\n        {\n            nChange = nAmount - nPayFee - nPayAmount;\n            \n            // if sub-cent change is required, the fee must be raised to at least CTransaction::nMinTxFee   \n            if (nPayFee < CENT && nChange > 0 && nChange < CENT)\n            {\n                if (nChange < CENT) // change < 0.01 => simply move all change to fees\n                {\n                    nPayFee = nChange;\n                    nChange = 0;\n                }\n                else\n                {\n                    nChange = nChange + nPayFee - CENT;\n                    nPayFee = CENT;\n                }  \n            }\n            \n            if (nChange == 0)\n                nBytes -= 34;\n        }\n        \n        // after fee\n        nAfterFee = nAmount - nPayFee;\n        if (nAfterFee < 0)\n            nAfterFee = 0;\n    }\n    \n    // actually update labels\n    int nDisplayUnit = BitcoinUnits::BTC;\n    if (model && model->getOptionsModel())\n        nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n            \n    QLabel *l1 = dialog->findChild<QLabel *>(\"labelCoinControlQuantity\");\n    QLabel *l2 = dialog->findChild<QLabel *>(\"labelCoinControlAmount\");\n    QLabel *l3 = dialog->findChild<QLabel *>(\"labelCoinControlFee\");\n    QLabel *l4 = dialog->findChild<QLabel *>(\"labelCoinControlAfterFee\");\n    QLabel *l5 = dialog->findChild<QLabel *>(\"labelCoinControlBytes\");\n    QLabel *l6 = dialog->findChild<QLabel *>(\"labelCoinControlPriority\");\n    QLabel *l7 = dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\");\n    QLabel *l8 = dialog->findChild<QLabel *>(\"labelCoinControlChange\");\n    \n    // enable/disable \"low output\" and \"change\"\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\")    ->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlChange\")       ->setEnabled(nPayAmount > 0);\n    \n    // stats\n    l1->setText(QString::number(nQuantity));                                 // Quantity        \n    l2->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAmount));        // Amount\n    l3->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nPayFee));        // Fee\n    l4->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAfterFee));      // After Fee\n    l5->setText(((nBytes > 0) ? \"~\" : \"\") + QString::number(nBytes));                                    // Bytes\n    l6->setText(sPriorityLabel);                                             // Priority\n    l7->setText((fLowOutput ? (fDust ? tr(\"DUST\") : tr(\"yes\")) : tr(\"no\"))); // Low Output / Dust\n    l8->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nChange));        // Change\n    \n    // turn labels \"red\"\n    l5->setStyleSheet((nBytes >= 10000) ? \"color:red;\" : \"\");               // Bytes >= 10000\n    l6->setStyleSheet((dPriority <= 576000) ? \"color:red;\" : \"\");         // Priority < \"medium\"\n    l7->setStyleSheet((fLowOutput) ? \"color:red;\" : \"\");                    // Low Output = \"yes\"\n    l8->setStyleSheet((nChange > 0 && nChange < CENT) ? \"color:red;\" : \"\"); // Change < 0.01BTC\n        \n    // tool tips\n    l5->setToolTip(tr(\"This label turns red, if the transaction size is bigger than 10000 bytes.\\n\\n This means a fee of at least %1 per kb is required.\\n\\n Can vary +/- 1 Byte per input.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l6->setToolTip(tr(\"Transactions with higher priority get more likely into a block.\\n\\nThis label turns red, if the priority is smaller than \\\"medium\\\".\\n\\n This means a fee of at least %1 per kb is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l7->setToolTip(tr(\"This label turns red, if any recipient receives an amount smaller than %1.\\n\\n This means a fee of at least %2 is required. \\n\\n Amounts below 0.546 times the minimum relay fee are shown as DUST.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l8->setToolTip(tr(\"This label turns red, if the change is smaller than %1.\\n\\n This means a fee of at least %2 is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    dialog->findChild<QLabel *>(\"labelCoinControlBytesText\")    ->setToolTip(l5->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlPriorityText\") ->setToolTip(l6->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setToolTip(l7->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setToolTip(l8->toolTip());\n   \n    // Insufficient funds\n    QLabel *label = dialog->findChild<QLabel *>(\"labelCoinControlInsuffFunds\");\n    if (label)\n        label->setVisible(nChange < 0);\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QList<qint64> CoinControlDialog::payAmounts;",
            "CCoinControl* CoinControlDialog::coinControl = new CCoinControl();"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nQList<qint64> CoinControlDialog::payAmounts;\nCCoinControl* CoinControlDialog::coinControl = new CCoinControl();\n\nCoinControlDialog {\n  void CoinControlDialog::updateLabels(WalletModel *model, QDialog* dialog)\n  {\n      if (!model) return;\n  \n      // nPayAmount\n      qint64 nPayAmount = 0;\n      bool fLowOutput = false;\n      bool fDust = false;\n      CTransaction txDummy;\n      foreach(const qint64 &amount, CoinControlDialog::payAmounts)\n      {\n          nPayAmount += amount;\n  \n          if (amount > 0)\n          {\n              if (amount < CENT)\n                  fLowOutput = true;\n  \n              CTxOut txout(amount, (CScript)vector<unsigned char>(24, 0));\n              txDummy.vout.push_back(txout);\n          }\n      }\n  \n      QString sPriorityLabel      = \"\";\n      int64_t nAmount             = 0;\n      int64_t nPayFee             = 0;\n      int64_t nAfterFee           = 0;\n      int64_t nChange             = 0;\n      unsigned int nBytes         = 0;\n      unsigned int nBytesInputs   = 0;\n      double dPriority            = 0;\n      double dPriorityInputs      = 0;\n      unsigned int nQuantity      = 0;\n      \n      vector<COutPoint> vCoinControl;\n      vector<COutput>   vOutputs;\n      coinControl->ListSelected(vCoinControl);\n      model->getOutputs(vCoinControl, vOutputs);\n  \n      BOOST_FOREACH(const COutput& out, vOutputs)\n      {\n          // Quantity\n          nQuantity++;\n              \n          // Amount\n          nAmount += out.tx->vout[out.i].nValue;\n          \n          // Priority\n          dPriorityInputs += (double)out.tx->vout[out.i].nValue * (out.nDepth+1);\n          \n          // Bytes\n          CTxDestination address;\n          if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, address))\n          {\n              CPubKey pubkey;\n              CKeyID *keyid = boost::get< CKeyID >(&address);\n              if (keyid && model->getPubKey(*keyid, pubkey))\n                  nBytesInputs += (pubkey.IsCompressed() ? 148 : 180);\n              else\n                  nBytesInputs += 148; // in all error cases, simply assume 148 here\n          }\n          else nBytesInputs += 148;\n      }\n      \n      // calculation\n      if (nQuantity > 0)\n      {\n          // Bytes\n          nBytes = nBytesInputs + ((CoinControlDialog::payAmounts.size() > 0 ? CoinControlDialog::payAmounts.size() + 1 : 2) * 34) + 10; // always assume +1 output for change here\n          \n          // Priority\n          dPriority = dPriorityInputs / nBytes;\n          sPriorityLabel = CoinControlDialog::getPriorityLabel(dPriority);\n          \n          // Fee\n          int64_t nFee = nTransactionFee * (1 + (int64_t)nBytes / 1000);\n          \n          // Min Fee\n          int64_t nMinFee = txDummy.GetMinFee(1, GMF_SEND, nBytes);\n          \n          nPayFee = max(nFee, nMinFee);\n          \n          if (nPayAmount > 0)\n          {\n              nChange = nAmount - nPayFee - nPayAmount;\n              \n              // if sub-cent change is required, the fee must be raised to at least CTransaction::nMinTxFee   \n              if (nPayFee < CENT && nChange > 0 && nChange < CENT)\n              {\n                  if (nChange < CENT) // change < 0.01 => simply move all change to fees\n                  {\n                      nPayFee = nChange;\n                      nChange = 0;\n                  }\n                  else\n                  {\n                      nChange = nChange + nPayFee - CENT;\n                      nPayFee = CENT;\n                  }  \n              }\n              \n              if (nChange == 0)\n                  nBytes -= 34;\n          }\n          \n          // after fee\n          nAfterFee = nAmount - nPayFee;\n          if (nAfterFee < 0)\n              nAfterFee = 0;\n      }\n      \n      // actually update labels\n      int nDisplayUnit = BitcoinUnits::BTC;\n      if (model && model->getOptionsModel())\n          nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n              \n      QLabel *l1 = dialog->findChild<QLabel *>(\"labelCoinControlQuantity\");\n      QLabel *l2 = dialog->findChild<QLabel *>(\"labelCoinControlAmount\");\n      QLabel *l3 = dialog->findChild<QLabel *>(\"labelCoinControlFee\");\n      QLabel *l4 = dialog->findChild<QLabel *>(\"labelCoinControlAfterFee\");\n      QLabel *l5 = dialog->findChild<QLabel *>(\"labelCoinControlBytes\");\n      QLabel *l6 = dialog->findChild<QLabel *>(\"labelCoinControlPriority\");\n      QLabel *l7 = dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\");\n      QLabel *l8 = dialog->findChild<QLabel *>(\"labelCoinControlChange\");\n      \n      // enable/disable \"low output\" and \"change\"\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\")    ->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlChange\")       ->setEnabled(nPayAmount > 0);\n      \n      // stats\n      l1->setText(QString::number(nQuantity));                                 // Quantity        \n      l2->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAmount));        // Amount\n      l3->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nPayFee));        // Fee\n      l4->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAfterFee));      // After Fee\n      l5->setText(((nBytes > 0) ? \"~\" : \"\") + QString::number(nBytes));                                    // Bytes\n      l6->setText(sPriorityLabel);                                             // Priority\n      l7->setText((fLowOutput ? (fDust ? tr(\"DUST\") : tr(\"yes\")) : tr(\"no\"))); // Low Output / Dust\n      l8->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nChange));        // Change\n      \n      // turn labels \"red\"\n      l5->setStyleSheet((nBytes >= 10000) ? \"color:red;\" : \"\");               // Bytes >= 10000\n      l6->setStyleSheet((dPriority <= 576000) ? \"color:red;\" : \"\");         // Priority < \"medium\"\n      l7->setStyleSheet((fLowOutput) ? \"color:red;\" : \"\");                    // Low Output = \"yes\"\n      l8->setStyleSheet((nChange > 0 && nChange < CENT) ? \"color:red;\" : \"\"); // Change < 0.01BTC\n          \n      // tool tips\n      l5->setToolTip(tr(\"This label turns red, if the transaction size is bigger than 10000 bytes.\\n\\n This means a fee of at least %1 per kb is required.\\n\\n Can vary +/- 1 Byte per input.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l6->setToolTip(tr(\"Transactions with higher priority get more likely into a block.\\n\\nThis label turns red, if the priority is smaller than \\\"medium\\\".\\n\\n This means a fee of at least %1 per kb is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l7->setToolTip(tr(\"This label turns red, if any recipient receives an amount smaller than %1.\\n\\n This means a fee of at least %2 is required. \\n\\n Amounts below 0.546 times the minimum relay fee are shown as DUST.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l8->setToolTip(tr(\"This label turns red, if the change is smaller than %1.\\n\\n This means a fee of at least %2 is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      dialog->findChild<QLabel *>(\"labelCoinControlBytesText\")    ->setToolTip(l5->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlPriorityText\") ->setToolTip(l6->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setToolTip(l7->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setToolTip(l8->toolTip());\n     \n      // Insufficient funds\n      QLabel *label = dialog->findChild<QLabel *>(\"labelCoinControlInsuffFunds\");\n      if (label)\n          label->setVisible(nChange < 0);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->isEnabled",
          "args": [],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControl->Select",
          "args": [
            "outpt"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "Select",
          "container": "CCoinControl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/coincontrol.h",
          "lines": "32-35",
          "snippet": "void Select(COutPoint& output)\n    {\n        setSelected.insert(output);\n    }",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "CCoinControl {\n  void Select(COutPoint& output)\n      {\n          setSelected.insert(output);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "item->setCheckState",
          "args": [
            "COLUMN_CHECKBOX",
            "Qt::Unchecked"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "item->isDisabled",
          "args": [],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "coinControl->UnSelect",
          "args": [
            "outpt"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "UnSelect",
          "container": "CCoinControl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/coincontrol.h",
          "lines": "37-40",
          "snippet": "void UnSelect(COutPoint& output)\n    {\n        setSelected.erase(output);\n    }",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "CCoinControl {\n  void UnSelect(COutPoint& output)\n      {\n          setSelected.erase(output);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "item->checkState",
          "args": [
            "COLUMN_CHECKBOX"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "item->text",
          "args": [],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "item->text",
          "args": [
            "COLUMN_VOUT_INDEX"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uint256",
          "args": [
            "item->text(COLUMN_TXHASH).toStdString()"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "setuint256",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "250-276",
          "snippet": "void setuint256(uint256 n)\n    {\n        unsigned char pch[sizeof(n) + 6];\n        unsigned char* p = pch + 4;\n        bool fLeadingZeroes = true;\n        unsigned char* pbegin = (unsigned char*)&n;\n        unsigned char* psrc = pbegin + sizeof(n);\n        while (psrc != pbegin)\n        {\n            unsigned char c = *(--psrc);\n            if (fLeadingZeroes)\n            {\n                if (c == 0)\n                    continue;\n                if (c & 0x80)\n                    *p++ = 0;\n                fLeadingZeroes = false;\n            }\n            *p++ = c;\n        }\n        unsigned int nSize = p - (pch + 4);\n        pch[0] = (nSize >> 24) & 0xff;\n        pch[1] = (nSize >> 16) & 0xff;\n        pch[2] = (nSize >> 8) & 0xff;\n        pch[3] = (nSize >> 0) & 0xff;\n        BN_mpi2bn(pch, p - pch, this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  void setuint256(uint256 n)\n      {\n          unsigned char pch[sizeof(n) + 6];\n          unsigned char* p = pch + 4;\n          bool fLeadingZeroes = true;\n          unsigned char* pbegin = (unsigned char*)&n;\n          unsigned char* psrc = pbegin + sizeof(n);\n          while (psrc != pbegin)\n          {\n              unsigned char c = *(--psrc);\n              if (fLeadingZeroes)\n              {\n                  if (c == 0)\n                      continue;\n                  if (c & 0x80)\n                      *p++ = 0;\n                  fLeadingZeroes = false;\n              }\n              *p++ = c;\n          }\n          unsigned int nSize = p - (pch + 4);\n          pch[0] = (nSize >> 24) & 0xff;\n          pch[1] = (nSize >> 16) & 0xff;\n          pch[2] = (nSize >> 8) & 0xff;\n          pch[3] = (nSize >> 0) & 0xff;\n          BN_mpi2bn(pch, p - pch, this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "item->text",
          "args": [
            "COLUMN_TXHASH"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "item->text",
          "args": [
            "COLUMN_TXHASH"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCCoinControl* CoinControlDialog::coinControl = new CCoinControl();\n\nCoinControlDialog {\n  void CoinControlDialog::viewItemChanged(QTreeWidgetItem* item, int column)\n  {\n      if (column == COLUMN_CHECKBOX && item->text(COLUMN_TXHASH).length() == 64) // transaction hash is 64 characters (this means its a child node, so its not a parent node in tree mode)\n      {\n          COutPoint outpt(uint256(item->text(COLUMN_TXHASH).toStdString()), item->text(COLUMN_VOUT_INDEX).toUInt());\n  \n          if (item->checkState(COLUMN_CHECKBOX) == Qt::Unchecked)\n              coinControl->UnSelect(outpt);\n          else if (item->isDisabled()) // locked (this happens if \"check all\" through parent node)\n              item->setCheckState(COLUMN_CHECKBOX, Qt::Unchecked);\n          else\n              coinControl->Select(outpt);\n  \n          // selection changed -> update labels\n          if (ui->treeWidget->isEnabled()) // do not update on every click for (un)select all\n              CoinControlDialog::updateLabels(model, this);\n      }\n  }\n}"
  },
  {
    "function_name": "radioListMode",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "356-360",
    "snippet": "void CoinControlDialog::radioListMode(bool checked)\n{\n    if (checked && model)\n        updateView();\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "updateView",
          "args": [],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "updateView",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "576-738",
          "snippet": "void CoinControlDialog::updateView()\n{\n    bool treeMode = ui->radioTreeMode->isChecked();\n\n    ui->treeWidget->clear();\n    ui->treeWidget->setEnabled(false); // performance, otherwise updateLabels would be called for every checked checkbox\n    ui->treeWidget->setAlternatingRowColors(!treeMode);\n    QFlags<Qt::ItemFlag> flgCheckbox=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable;\n    QFlags<Qt::ItemFlag> flgTristate=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable | Qt::ItemIsTristate;    \n    \n    int nDisplayUnit = BitcoinUnits::BTC;\n    if (model && model->getOptionsModel())\n        nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n        \n    map<QString, vector<COutput> > mapCoins;\n    model->listCoins(mapCoins);\n\n    BOOST_FOREACH(PAIRTYPE(QString, vector<COutput>) coins, mapCoins)\n    {\n        QTreeWidgetItem *itemWalletAddress = new QTreeWidgetItem();\n        QString sWalletAddress = coins.first;\n        QString sWalletLabel = \"\";\n        if (model->getAddressTableModel())\n            sWalletLabel = model->getAddressTableModel()->labelForAddress(sWalletAddress);\n        if (sWalletLabel.length() == 0)\n            sWalletLabel = tr(\"(no label)\");\n        \n        if (treeMode)\n        {\n            // wallet address\n            ui->treeWidget->addTopLevelItem(itemWalletAddress);\n\n            itemWalletAddress->setFlags(flgTristate);\n            itemWalletAddress->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n            \n            for (int i = 0; i < ui->treeWidget->columnCount(); i++)\n                itemWalletAddress->setBackground(i, QColor(248, 247, 246));\n            \n            // label\n            itemWalletAddress->setText(COLUMN_LABEL, sWalletLabel);\n\n            // address\n            itemWalletAddress->setText(COLUMN_ADDRESS, sWalletAddress);\n        }\n\n        int64_t nSum = 0;\n        double dPrioritySum = 0;\n        int nChildren = 0;\n        int nInputSum = 0;\n        BOOST_FOREACH(const COutput& out, coins.second)\n        {\n            int nInputSize = 148; // 180 if uncompressed public key\n            nSum += out.tx->vout[out.i].nValue;\n            nChildren++;\n            \n            QTreeWidgetItem *itemOutput;\n            if (treeMode)    itemOutput = new QTreeWidgetItem(itemWalletAddress);\n            else             itemOutput = new QTreeWidgetItem(ui->treeWidget);\n            itemOutput->setFlags(flgCheckbox);\n            itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n                \n            // address\n            CTxDestination outputAddress;\n            QString sAddress = \"\";\n            if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, outputAddress))\n            {\n                sAddress = CBitcoinAddress(outputAddress).ToString().c_str();\n                \n                // if listMode or change => show bitcoin address. In tree mode, address is not shown again for direct wallet address outputs\n                if (!treeMode || (!(sAddress == sWalletAddress)))\n                    itemOutput->setText(COLUMN_ADDRESS, sAddress);\n                    \n                CPubKey pubkey;\n                CKeyID *keyid = boost::get< CKeyID >(&outputAddress);\n                if (keyid && model->getPubKey(*keyid, pubkey) && !pubkey.IsCompressed())\n                    nInputSize = 180;\n            }\n\n            // label\n            if (!(sAddress == sWalletAddress)) // change\n            {\n                // tooltip from where the change comes from\n                itemOutput->setToolTip(COLUMN_LABEL, tr(\"change from %1 (%2)\").arg(sWalletLabel).arg(sWalletAddress));\n                itemOutput->setText(COLUMN_LABEL, tr(\"(change)\"));\n            }\n            else if (!treeMode)\n            {\n                QString sLabel = \"\";\n                if (model->getAddressTableModel())\n                    sLabel = model->getAddressTableModel()->labelForAddress(sAddress);\n                if (sLabel.length() == 0)\n                    sLabel = tr(\"(no label)\");\n                itemOutput->setText(COLUMN_LABEL, sLabel); \n            }\n\n            // amount\n            itemOutput->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, out.tx->vout[out.i].nValue));\n            itemOutput->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(out.tx->vout[out.i].nValue), 15, \" \")); // padding so that sorting works correctly\n\n            // date\n            itemOutput->setText(COLUMN_DATE, QDateTime::fromTime_t(out.tx->GetTxTime()).toUTC().toString(\"yy-MM-dd hh:mm\"));\n            \n            // immature PoS reward\n            if (out.tx->IsCoinStake() && out.tx->GetBlocksToMaturity() > 0 && out.tx->GetDepthInMainChain() > 0) {\n              itemOutput->setBackground(COLUMN_CONFIRMATIONS, Qt::red);\n              itemOutput->setDisabled(true);\n            }\n\n            // confirmations\n            itemOutput->setText(COLUMN_CONFIRMATIONS, strPad(QString::number(out.nDepth), 8, \" \"));\n            \n            // priority\n            double dPriority = ((double)out.tx->vout[out.i].nValue  / (nInputSize + 78)) * (out.nDepth+1); // 78 = 2 * 34 + 10\n            itemOutput->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPriority));\n            itemOutput->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPriority), 20, \" \"));\n            dPrioritySum += (double)out.tx->vout[out.i].nValue  * (out.nDepth+1);\n            nInputSum    += nInputSize;\n            \n            // transaction hash\n            uint256 txhash = out.tx->GetHash();\n            itemOutput->setText(COLUMN_TXHASH, txhash.GetHex().c_str());\n    \n            // vout index\n            itemOutput->setText(COLUMN_VOUT_INDEX, QString::number(out.i));\n            \n            // disable locked coins     \n            /*if (model->isLockedCoin(txhash, out.i))\n            {\n                COutPoint outpt(txhash, out.i);\n                coinControl->UnSelect(outpt); // just to be sure\n                itemOutput->setDisabled(true);\n                itemOutput->setIcon(COLUMN_CHECKBOX, QIcon(\":/icons/lock_closed\"));\n            }*/\n              \n            // set checkbox\n            if (coinControl->IsSelected(txhash, out.i))\n                itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Checked);\n        }\n\n        // amount\n        if (treeMode)\n        {\n            dPrioritySum = dPrioritySum / (nInputSum + 78);\n            itemWalletAddress->setText(COLUMN_CHECKBOX, \"(\" + QString::number(nChildren) + \")\");\n            itemWalletAddress->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, nSum));\n            itemWalletAddress->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(nSum), 15, \" \"));\n            itemWalletAddress->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPrioritySum));\n            itemWalletAddress->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPrioritySum), 20, \" \"));\n        }\n    }\n    \n    // expand all partially selected\n    if (treeMode)\n    {\n        for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n            if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) == Qt::PartiallyChecked)\n                ui->treeWidget->topLevelItem(i)->setExpanded(true);\n    }\n    \n    // sort view\n    sortView(sortColumn, sortOrder);\n    ui->treeWidget->setEnabled(true);\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "CCoinControl* CoinControlDialog::coinControl = new CCoinControl();"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCCoinControl* CoinControlDialog::coinControl = new CCoinControl();\n\nCoinControlDialog {\n  void CoinControlDialog::updateView()\n  {\n      bool treeMode = ui->radioTreeMode->isChecked();\n  \n      ui->treeWidget->clear();\n      ui->treeWidget->setEnabled(false); // performance, otherwise updateLabels would be called for every checked checkbox\n      ui->treeWidget->setAlternatingRowColors(!treeMode);\n      QFlags<Qt::ItemFlag> flgCheckbox=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable;\n      QFlags<Qt::ItemFlag> flgTristate=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable | Qt::ItemIsTristate;    \n      \n      int nDisplayUnit = BitcoinUnits::BTC;\n      if (model && model->getOptionsModel())\n          nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n          \n      map<QString, vector<COutput> > mapCoins;\n      model->listCoins(mapCoins);\n  \n      BOOST_FOREACH(PAIRTYPE(QString, vector<COutput>) coins, mapCoins)\n      {\n          QTreeWidgetItem *itemWalletAddress = new QTreeWidgetItem();\n          QString sWalletAddress = coins.first;\n          QString sWalletLabel = \"\";\n          if (model->getAddressTableModel())\n              sWalletLabel = model->getAddressTableModel()->labelForAddress(sWalletAddress);\n          if (sWalletLabel.length() == 0)\n              sWalletLabel = tr(\"(no label)\");\n          \n          if (treeMode)\n          {\n              // wallet address\n              ui->treeWidget->addTopLevelItem(itemWalletAddress);\n  \n              itemWalletAddress->setFlags(flgTristate);\n              itemWalletAddress->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n              \n              for (int i = 0; i < ui->treeWidget->columnCount(); i++)\n                  itemWalletAddress->setBackground(i, QColor(248, 247, 246));\n              \n              // label\n              itemWalletAddress->setText(COLUMN_LABEL, sWalletLabel);\n  \n              // address\n              itemWalletAddress->setText(COLUMN_ADDRESS, sWalletAddress);\n          }\n  \n          int64_t nSum = 0;\n          double dPrioritySum = 0;\n          int nChildren = 0;\n          int nInputSum = 0;\n          BOOST_FOREACH(const COutput& out, coins.second)\n          {\n              int nInputSize = 148; // 180 if uncompressed public key\n              nSum += out.tx->vout[out.i].nValue;\n              nChildren++;\n              \n              QTreeWidgetItem *itemOutput;\n              if (treeMode)    itemOutput = new QTreeWidgetItem(itemWalletAddress);\n              else             itemOutput = new QTreeWidgetItem(ui->treeWidget);\n              itemOutput->setFlags(flgCheckbox);\n              itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n                  \n              // address\n              CTxDestination outputAddress;\n              QString sAddress = \"\";\n              if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, outputAddress))\n              {\n                  sAddress = CBitcoinAddress(outputAddress).ToString().c_str();\n                  \n                  // if listMode or change => show bitcoin address. In tree mode, address is not shown again for direct wallet address outputs\n                  if (!treeMode || (!(sAddress == sWalletAddress)))\n                      itemOutput->setText(COLUMN_ADDRESS, sAddress);\n                      \n                  CPubKey pubkey;\n                  CKeyID *keyid = boost::get< CKeyID >(&outputAddress);\n                  if (keyid && model->getPubKey(*keyid, pubkey) && !pubkey.IsCompressed())\n                      nInputSize = 180;\n              }\n  \n              // label\n              if (!(sAddress == sWalletAddress)) // change\n              {\n                  // tooltip from where the change comes from\n                  itemOutput->setToolTip(COLUMN_LABEL, tr(\"change from %1 (%2)\").arg(sWalletLabel).arg(sWalletAddress));\n                  itemOutput->setText(COLUMN_LABEL, tr(\"(change)\"));\n              }\n              else if (!treeMode)\n              {\n                  QString sLabel = \"\";\n                  if (model->getAddressTableModel())\n                      sLabel = model->getAddressTableModel()->labelForAddress(sAddress);\n                  if (sLabel.length() == 0)\n                      sLabel = tr(\"(no label)\");\n                  itemOutput->setText(COLUMN_LABEL, sLabel); \n              }\n  \n              // amount\n              itemOutput->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, out.tx->vout[out.i].nValue));\n              itemOutput->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(out.tx->vout[out.i].nValue), 15, \" \")); // padding so that sorting works correctly\n  \n              // date\n              itemOutput->setText(COLUMN_DATE, QDateTime::fromTime_t(out.tx->GetTxTime()).toUTC().toString(\"yy-MM-dd hh:mm\"));\n              \n              // immature PoS reward\n              if (out.tx->IsCoinStake() && out.tx->GetBlocksToMaturity() > 0 && out.tx->GetDepthInMainChain() > 0) {\n                itemOutput->setBackground(COLUMN_CONFIRMATIONS, Qt::red);\n                itemOutput->setDisabled(true);\n              }\n  \n              // confirmations\n              itemOutput->setText(COLUMN_CONFIRMATIONS, strPad(QString::number(out.nDepth), 8, \" \"));\n              \n              // priority\n              double dPriority = ((double)out.tx->vout[out.i].nValue  / (nInputSize + 78)) * (out.nDepth+1); // 78 = 2 * 34 + 10\n              itemOutput->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPriority));\n              itemOutput->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPriority), 20, \" \"));\n              dPrioritySum += (double)out.tx->vout[out.i].nValue  * (out.nDepth+1);\n              nInputSum    += nInputSize;\n              \n              // transaction hash\n              uint256 txhash = out.tx->GetHash();\n              itemOutput->setText(COLUMN_TXHASH, txhash.GetHex().c_str());\n      \n              // vout index\n              itemOutput->setText(COLUMN_VOUT_INDEX, QString::number(out.i));\n              \n              // disable locked coins     \n              /*if (model->isLockedCoin(txhash, out.i))\n              {\n                  COutPoint outpt(txhash, out.i);\n                  coinControl->UnSelect(outpt); // just to be sure\n                  itemOutput->setDisabled(true);\n                  itemOutput->setIcon(COLUMN_CHECKBOX, QIcon(\":/icons/lock_closed\"));\n              }*/\n                \n              // set checkbox\n              if (coinControl->IsSelected(txhash, out.i))\n                  itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Checked);\n          }\n  \n          // amount\n          if (treeMode)\n          {\n              dPrioritySum = dPrioritySum / (nInputSum + 78);\n              itemWalletAddress->setText(COLUMN_CHECKBOX, \"(\" + QString::number(nChildren) + \")\");\n              itemWalletAddress->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, nSum));\n              itemWalletAddress->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(nSum), 15, \" \"));\n              itemWalletAddress->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPrioritySum));\n              itemWalletAddress->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPrioritySum), 20, \" \"));\n          }\n      }\n      \n      // expand all partially selected\n      if (treeMode)\n      {\n          for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n              if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) == Qt::PartiallyChecked)\n                  ui->treeWidget->topLevelItem(i)->setExpanded(true);\n      }\n      \n      // sort view\n      sortView(sortColumn, sortOrder);\n      ui->treeWidget->setEnabled(true);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::radioListMode(bool checked)\n  {\n      if (checked && model)\n          updateView();\n  }\n}"
  },
  {
    "function_name": "radioTreeMode",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "349-353",
    "snippet": "void CoinControlDialog::radioTreeMode(bool checked)\n{\n    if (checked && model)\n        updateView();\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "updateView",
          "args": [],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "updateView",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "576-738",
          "snippet": "void CoinControlDialog::updateView()\n{\n    bool treeMode = ui->radioTreeMode->isChecked();\n\n    ui->treeWidget->clear();\n    ui->treeWidget->setEnabled(false); // performance, otherwise updateLabels would be called for every checked checkbox\n    ui->treeWidget->setAlternatingRowColors(!treeMode);\n    QFlags<Qt::ItemFlag> flgCheckbox=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable;\n    QFlags<Qt::ItemFlag> flgTristate=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable | Qt::ItemIsTristate;    \n    \n    int nDisplayUnit = BitcoinUnits::BTC;\n    if (model && model->getOptionsModel())\n        nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n        \n    map<QString, vector<COutput> > mapCoins;\n    model->listCoins(mapCoins);\n\n    BOOST_FOREACH(PAIRTYPE(QString, vector<COutput>) coins, mapCoins)\n    {\n        QTreeWidgetItem *itemWalletAddress = new QTreeWidgetItem();\n        QString sWalletAddress = coins.first;\n        QString sWalletLabel = \"\";\n        if (model->getAddressTableModel())\n            sWalletLabel = model->getAddressTableModel()->labelForAddress(sWalletAddress);\n        if (sWalletLabel.length() == 0)\n            sWalletLabel = tr(\"(no label)\");\n        \n        if (treeMode)\n        {\n            // wallet address\n            ui->treeWidget->addTopLevelItem(itemWalletAddress);\n\n            itemWalletAddress->setFlags(flgTristate);\n            itemWalletAddress->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n            \n            for (int i = 0; i < ui->treeWidget->columnCount(); i++)\n                itemWalletAddress->setBackground(i, QColor(248, 247, 246));\n            \n            // label\n            itemWalletAddress->setText(COLUMN_LABEL, sWalletLabel);\n\n            // address\n            itemWalletAddress->setText(COLUMN_ADDRESS, sWalletAddress);\n        }\n\n        int64_t nSum = 0;\n        double dPrioritySum = 0;\n        int nChildren = 0;\n        int nInputSum = 0;\n        BOOST_FOREACH(const COutput& out, coins.second)\n        {\n            int nInputSize = 148; // 180 if uncompressed public key\n            nSum += out.tx->vout[out.i].nValue;\n            nChildren++;\n            \n            QTreeWidgetItem *itemOutput;\n            if (treeMode)    itemOutput = new QTreeWidgetItem(itemWalletAddress);\n            else             itemOutput = new QTreeWidgetItem(ui->treeWidget);\n            itemOutput->setFlags(flgCheckbox);\n            itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n                \n            // address\n            CTxDestination outputAddress;\n            QString sAddress = \"\";\n            if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, outputAddress))\n            {\n                sAddress = CBitcoinAddress(outputAddress).ToString().c_str();\n                \n                // if listMode or change => show bitcoin address. In tree mode, address is not shown again for direct wallet address outputs\n                if (!treeMode || (!(sAddress == sWalletAddress)))\n                    itemOutput->setText(COLUMN_ADDRESS, sAddress);\n                    \n                CPubKey pubkey;\n                CKeyID *keyid = boost::get< CKeyID >(&outputAddress);\n                if (keyid && model->getPubKey(*keyid, pubkey) && !pubkey.IsCompressed())\n                    nInputSize = 180;\n            }\n\n            // label\n            if (!(sAddress == sWalletAddress)) // change\n            {\n                // tooltip from where the change comes from\n                itemOutput->setToolTip(COLUMN_LABEL, tr(\"change from %1 (%2)\").arg(sWalletLabel).arg(sWalletAddress));\n                itemOutput->setText(COLUMN_LABEL, tr(\"(change)\"));\n            }\n            else if (!treeMode)\n            {\n                QString sLabel = \"\";\n                if (model->getAddressTableModel())\n                    sLabel = model->getAddressTableModel()->labelForAddress(sAddress);\n                if (sLabel.length() == 0)\n                    sLabel = tr(\"(no label)\");\n                itemOutput->setText(COLUMN_LABEL, sLabel); \n            }\n\n            // amount\n            itemOutput->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, out.tx->vout[out.i].nValue));\n            itemOutput->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(out.tx->vout[out.i].nValue), 15, \" \")); // padding so that sorting works correctly\n\n            // date\n            itemOutput->setText(COLUMN_DATE, QDateTime::fromTime_t(out.tx->GetTxTime()).toUTC().toString(\"yy-MM-dd hh:mm\"));\n            \n            // immature PoS reward\n            if (out.tx->IsCoinStake() && out.tx->GetBlocksToMaturity() > 0 && out.tx->GetDepthInMainChain() > 0) {\n              itemOutput->setBackground(COLUMN_CONFIRMATIONS, Qt::red);\n              itemOutput->setDisabled(true);\n            }\n\n            // confirmations\n            itemOutput->setText(COLUMN_CONFIRMATIONS, strPad(QString::number(out.nDepth), 8, \" \"));\n            \n            // priority\n            double dPriority = ((double)out.tx->vout[out.i].nValue  / (nInputSize + 78)) * (out.nDepth+1); // 78 = 2 * 34 + 10\n            itemOutput->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPriority));\n            itemOutput->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPriority), 20, \" \"));\n            dPrioritySum += (double)out.tx->vout[out.i].nValue  * (out.nDepth+1);\n            nInputSum    += nInputSize;\n            \n            // transaction hash\n            uint256 txhash = out.tx->GetHash();\n            itemOutput->setText(COLUMN_TXHASH, txhash.GetHex().c_str());\n    \n            // vout index\n            itemOutput->setText(COLUMN_VOUT_INDEX, QString::number(out.i));\n            \n            // disable locked coins     \n            /*if (model->isLockedCoin(txhash, out.i))\n            {\n                COutPoint outpt(txhash, out.i);\n                coinControl->UnSelect(outpt); // just to be sure\n                itemOutput->setDisabled(true);\n                itemOutput->setIcon(COLUMN_CHECKBOX, QIcon(\":/icons/lock_closed\"));\n            }*/\n              \n            // set checkbox\n            if (coinControl->IsSelected(txhash, out.i))\n                itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Checked);\n        }\n\n        // amount\n        if (treeMode)\n        {\n            dPrioritySum = dPrioritySum / (nInputSum + 78);\n            itemWalletAddress->setText(COLUMN_CHECKBOX, \"(\" + QString::number(nChildren) + \")\");\n            itemWalletAddress->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, nSum));\n            itemWalletAddress->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(nSum), 15, \" \"));\n            itemWalletAddress->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPrioritySum));\n            itemWalletAddress->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPrioritySum), 20, \" \"));\n        }\n    }\n    \n    // expand all partially selected\n    if (treeMode)\n    {\n        for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n            if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) == Qt::PartiallyChecked)\n                ui->treeWidget->topLevelItem(i)->setExpanded(true);\n    }\n    \n    // sort view\n    sortView(sortColumn, sortOrder);\n    ui->treeWidget->setEnabled(true);\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "CCoinControl* CoinControlDialog::coinControl = new CCoinControl();"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCCoinControl* CoinControlDialog::coinControl = new CCoinControl();\n\nCoinControlDialog {\n  void CoinControlDialog::updateView()\n  {\n      bool treeMode = ui->radioTreeMode->isChecked();\n  \n      ui->treeWidget->clear();\n      ui->treeWidget->setEnabled(false); // performance, otherwise updateLabels would be called for every checked checkbox\n      ui->treeWidget->setAlternatingRowColors(!treeMode);\n      QFlags<Qt::ItemFlag> flgCheckbox=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable;\n      QFlags<Qt::ItemFlag> flgTristate=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable | Qt::ItemIsTristate;    \n      \n      int nDisplayUnit = BitcoinUnits::BTC;\n      if (model && model->getOptionsModel())\n          nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n          \n      map<QString, vector<COutput> > mapCoins;\n      model->listCoins(mapCoins);\n  \n      BOOST_FOREACH(PAIRTYPE(QString, vector<COutput>) coins, mapCoins)\n      {\n          QTreeWidgetItem *itemWalletAddress = new QTreeWidgetItem();\n          QString sWalletAddress = coins.first;\n          QString sWalletLabel = \"\";\n          if (model->getAddressTableModel())\n              sWalletLabel = model->getAddressTableModel()->labelForAddress(sWalletAddress);\n          if (sWalletLabel.length() == 0)\n              sWalletLabel = tr(\"(no label)\");\n          \n          if (treeMode)\n          {\n              // wallet address\n              ui->treeWidget->addTopLevelItem(itemWalletAddress);\n  \n              itemWalletAddress->setFlags(flgTristate);\n              itemWalletAddress->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n              \n              for (int i = 0; i < ui->treeWidget->columnCount(); i++)\n                  itemWalletAddress->setBackground(i, QColor(248, 247, 246));\n              \n              // label\n              itemWalletAddress->setText(COLUMN_LABEL, sWalletLabel);\n  \n              // address\n              itemWalletAddress->setText(COLUMN_ADDRESS, sWalletAddress);\n          }\n  \n          int64_t nSum = 0;\n          double dPrioritySum = 0;\n          int nChildren = 0;\n          int nInputSum = 0;\n          BOOST_FOREACH(const COutput& out, coins.second)\n          {\n              int nInputSize = 148; // 180 if uncompressed public key\n              nSum += out.tx->vout[out.i].nValue;\n              nChildren++;\n              \n              QTreeWidgetItem *itemOutput;\n              if (treeMode)    itemOutput = new QTreeWidgetItem(itemWalletAddress);\n              else             itemOutput = new QTreeWidgetItem(ui->treeWidget);\n              itemOutput->setFlags(flgCheckbox);\n              itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n                  \n              // address\n              CTxDestination outputAddress;\n              QString sAddress = \"\";\n              if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, outputAddress))\n              {\n                  sAddress = CBitcoinAddress(outputAddress).ToString().c_str();\n                  \n                  // if listMode or change => show bitcoin address. In tree mode, address is not shown again for direct wallet address outputs\n                  if (!treeMode || (!(sAddress == sWalletAddress)))\n                      itemOutput->setText(COLUMN_ADDRESS, sAddress);\n                      \n                  CPubKey pubkey;\n                  CKeyID *keyid = boost::get< CKeyID >(&outputAddress);\n                  if (keyid && model->getPubKey(*keyid, pubkey) && !pubkey.IsCompressed())\n                      nInputSize = 180;\n              }\n  \n              // label\n              if (!(sAddress == sWalletAddress)) // change\n              {\n                  // tooltip from where the change comes from\n                  itemOutput->setToolTip(COLUMN_LABEL, tr(\"change from %1 (%2)\").arg(sWalletLabel).arg(sWalletAddress));\n                  itemOutput->setText(COLUMN_LABEL, tr(\"(change)\"));\n              }\n              else if (!treeMode)\n              {\n                  QString sLabel = \"\";\n                  if (model->getAddressTableModel())\n                      sLabel = model->getAddressTableModel()->labelForAddress(sAddress);\n                  if (sLabel.length() == 0)\n                      sLabel = tr(\"(no label)\");\n                  itemOutput->setText(COLUMN_LABEL, sLabel); \n              }\n  \n              // amount\n              itemOutput->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, out.tx->vout[out.i].nValue));\n              itemOutput->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(out.tx->vout[out.i].nValue), 15, \" \")); // padding so that sorting works correctly\n  \n              // date\n              itemOutput->setText(COLUMN_DATE, QDateTime::fromTime_t(out.tx->GetTxTime()).toUTC().toString(\"yy-MM-dd hh:mm\"));\n              \n              // immature PoS reward\n              if (out.tx->IsCoinStake() && out.tx->GetBlocksToMaturity() > 0 && out.tx->GetDepthInMainChain() > 0) {\n                itemOutput->setBackground(COLUMN_CONFIRMATIONS, Qt::red);\n                itemOutput->setDisabled(true);\n              }\n  \n              // confirmations\n              itemOutput->setText(COLUMN_CONFIRMATIONS, strPad(QString::number(out.nDepth), 8, \" \"));\n              \n              // priority\n              double dPriority = ((double)out.tx->vout[out.i].nValue  / (nInputSize + 78)) * (out.nDepth+1); // 78 = 2 * 34 + 10\n              itemOutput->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPriority));\n              itemOutput->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPriority), 20, \" \"));\n              dPrioritySum += (double)out.tx->vout[out.i].nValue  * (out.nDepth+1);\n              nInputSum    += nInputSize;\n              \n              // transaction hash\n              uint256 txhash = out.tx->GetHash();\n              itemOutput->setText(COLUMN_TXHASH, txhash.GetHex().c_str());\n      \n              // vout index\n              itemOutput->setText(COLUMN_VOUT_INDEX, QString::number(out.i));\n              \n              // disable locked coins     \n              /*if (model->isLockedCoin(txhash, out.i))\n              {\n                  COutPoint outpt(txhash, out.i);\n                  coinControl->UnSelect(outpt); // just to be sure\n                  itemOutput->setDisabled(true);\n                  itemOutput->setIcon(COLUMN_CHECKBOX, QIcon(\":/icons/lock_closed\"));\n              }*/\n                \n              // set checkbox\n              if (coinControl->IsSelected(txhash, out.i))\n                  itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Checked);\n          }\n  \n          // amount\n          if (treeMode)\n          {\n              dPrioritySum = dPrioritySum / (nInputSum + 78);\n              itemWalletAddress->setText(COLUMN_CHECKBOX, \"(\" + QString::number(nChildren) + \")\");\n              itemWalletAddress->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, nSum));\n              itemWalletAddress->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(nSum), 15, \" \"));\n              itemWalletAddress->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPrioritySum));\n              itemWalletAddress->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPrioritySum), 20, \" \"));\n          }\n      }\n      \n      // expand all partially selected\n      if (treeMode)\n      {\n          for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n              if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) == Qt::PartiallyChecked)\n                  ui->treeWidget->topLevelItem(i)->setExpanded(true);\n      }\n      \n      // sort view\n      sortView(sortColumn, sortOrder);\n      ui->treeWidget->setEnabled(true);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::radioTreeMode(bool checked)\n  {\n      if (checked && model)\n          updateView();\n  }\n}"
  },
  {
    "function_name": "headerSectionClicked",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "322-346",
    "snippet": "void CoinControlDialog::headerSectionClicked(int logicalIndex)\n{\n    if (logicalIndex == COLUMN_CHECKBOX) // click on most left column -> do nothing\n    {\n        ui->treeWidget->header()->setSortIndicator((sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn)), sortOrder);\n    }\n    else\n    {\n        if (logicalIndex == COLUMN_AMOUNT) // sort by amount\n            logicalIndex = COLUMN_AMOUNT_INT64;\n\n        if (logicalIndex == COLUMN_PRIORITY) // sort by priority\n            logicalIndex = COLUMN_PRIORITY_INT64;\n\n        if (sortColumn == logicalIndex)\n            sortOrder = ((sortOrder == Qt::AscendingOrder) ? Qt::DescendingOrder : Qt::AscendingOrder);\n        else\n        {\n            sortColumn = logicalIndex;\n            sortOrder = ((sortColumn == COLUMN_AMOUNT_INT64 || sortColumn == COLUMN_PRIORITY_INT64 || sortColumn == COLUMN_DATE || sortColumn == COLUMN_CONFIRMATIONS) ? Qt::DescendingOrder : Qt::AscendingOrder); // if amount,date,conf,priority then default => desc, else default => asc\n        }\n\n        sortView(sortColumn, sortOrder);\n    }\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sortView",
          "args": [
            "sortColumn",
            "sortOrder"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "sortView",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "313-319",
          "snippet": "void CoinControlDialog::sortView(int column, Qt::SortOrder order)\n{\n    sortColumn = column;\n    sortOrder = order;\n    ui->treeWidget->sortItems(column, order);\n    ui->treeWidget->header()->setSortIndicator((sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn)), sortOrder);\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::sortView(int column, Qt::SortOrder order)\n  {\n      sortColumn = column;\n      sortOrder = order;\n      ui->treeWidget->sortItems(column, order);\n      ui->treeWidget->header()->setSortIndicator((sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn)), sortOrder);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->header",
          "args": [
            "(sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn))",
            "sortOrder"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->header",
          "args": [],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::headerSectionClicked(int logicalIndex)\n  {\n      if (logicalIndex == COLUMN_CHECKBOX) // click on most left column -> do nothing\n      {\n          ui->treeWidget->header()->setSortIndicator((sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn)), sortOrder);\n      }\n      else\n      {\n          if (logicalIndex == COLUMN_AMOUNT) // sort by amount\n              logicalIndex = COLUMN_AMOUNT_INT64;\n  \n          if (logicalIndex == COLUMN_PRIORITY) // sort by priority\n              logicalIndex = COLUMN_PRIORITY_INT64;\n  \n          if (sortColumn == logicalIndex)\n              sortOrder = ((sortOrder == Qt::AscendingOrder) ? Qt::DescendingOrder : Qt::AscendingOrder);\n          else\n          {\n              sortColumn = logicalIndex;\n              sortOrder = ((sortColumn == COLUMN_AMOUNT_INT64 || sortColumn == COLUMN_PRIORITY_INT64 || sortColumn == COLUMN_DATE || sortColumn == COLUMN_CONFIRMATIONS) ? Qt::DescendingOrder : Qt::AscendingOrder); // if amount,date,conf,priority then default => desc, else default => asc\n          }\n  \n          sortView(sortColumn, sortOrder);\n      }\n  }\n}"
  },
  {
    "function_name": "sortView",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "313-319",
    "snippet": "void CoinControlDialog::sortView(int column, Qt::SortOrder order)\n{\n    sortColumn = column;\n    sortOrder = order;\n    ui->treeWidget->sortItems(column, order);\n    ui->treeWidget->header()->setSortIndicator((sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn)), sortOrder);\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->treeWidget->header",
          "args": [
            "(sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn))",
            "sortOrder"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->header",
          "args": [],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->sortItems",
          "args": [
            "column",
            "order"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::sortView(int column, Qt::SortOrder order)\n  {\n      sortColumn = column;\n      sortOrder = order;\n      ui->treeWidget->sortItems(column, order);\n      ui->treeWidget->header()->setSortIndicator((sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn)), sortOrder);\n  }\n}"
  },
  {
    "function_name": "clipboardChange",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "307-310",
    "snippet": "void CoinControlDialog::clipboardChange()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlChange->text().left(ui->labelCoinControlChange->text().indexOf(\" \")));\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlChange->text().left(ui->labelCoinControlChange->text().indexOf(\" \"))"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlChange->text",
          "args": [
            "ui->labelCoinControlChange->text().indexOf(\" \")"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlChange->text",
          "args": [
            "\" \""
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlChange->text",
          "args": [],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardChange()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlChange->text().left(ui->labelCoinControlChange->text().indexOf(\" \")));\n  }\n}"
  },
  {
    "function_name": "clipboardLowOutput",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "301-304",
    "snippet": "void CoinControlDialog::clipboardLowOutput()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlLowOutput->text());\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlLowOutput->text()"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlLowOutput->text",
          "args": [],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardLowOutput()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlLowOutput->text());\n  }\n}"
  },
  {
    "function_name": "clipboardPriority",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "295-298",
    "snippet": "void CoinControlDialog::clipboardPriority()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlPriority->text());\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlPriority->text()"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlPriority->text",
          "args": [],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardPriority()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlPriority->text());\n  }\n}"
  },
  {
    "function_name": "clipboardBytes",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "289-292",
    "snippet": "void CoinControlDialog::clipboardBytes()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlBytes->text());\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlBytes->text()"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlBytes->text",
          "args": [],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardBytes()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlBytes->text());\n  }\n}"
  },
  {
    "function_name": "clipboardAfterFee",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "283-286",
    "snippet": "void CoinControlDialog::clipboardAfterFee()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlAfterFee->text().left(ui->labelCoinControlAfterFee->text().indexOf(\" \")));\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlAfterFee->text().left(ui->labelCoinControlAfterFee->text().indexOf(\" \"))"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAfterFee->text",
          "args": [
            "ui->labelCoinControlAfterFee->text().indexOf(\" \")"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAfterFee->text",
          "args": [
            "\" \""
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAfterFee->text",
          "args": [],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardAfterFee()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlAfterFee->text().left(ui->labelCoinControlAfterFee->text().indexOf(\" \")));\n  }\n}"
  },
  {
    "function_name": "clipboardFee",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "277-280",
    "snippet": "void CoinControlDialog::clipboardFee()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlFee->text().left(ui->labelCoinControlFee->text().indexOf(\" \")));\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlFee->text().left(ui->labelCoinControlFee->text().indexOf(\" \"))"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlFee->text",
          "args": [
            "ui->labelCoinControlFee->text().indexOf(\" \")"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlFee->text",
          "args": [
            "\" \""
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlFee->text",
          "args": [],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardFee()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlFee->text().left(ui->labelCoinControlFee->text().indexOf(\" \")));\n  }\n}"
  },
  {
    "function_name": "clipboardAmount",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "271-274",
    "snippet": "void CoinControlDialog::clipboardAmount()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlAmount->text().left(ui->labelCoinControlAmount->text().indexOf(\" \")));\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlAmount->text().left(ui->labelCoinControlAmount->text().indexOf(\" \"))"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAmount->text",
          "args": [
            "ui->labelCoinControlAmount->text().indexOf(\" \")"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAmount->text",
          "args": [
            "\" \""
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAmount->text",
          "args": [],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardAmount()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlAmount->text().left(ui->labelCoinControlAmount->text().indexOf(\" \")));\n  }\n}"
  },
  {
    "function_name": "clipboardQuantity",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "265-268",
    "snippet": "void CoinControlDialog::clipboardQuantity()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlQuantity->text());\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "ui->labelCoinControlQuantity->text()"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlQuantity->text",
          "args": [],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardQuantity()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlQuantity->text());\n  }\n}"
  },
  {
    "function_name": "copyTransactionHash",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "236-239",
    "snippet": "void CoinControlDialog::copyTransactionHash()\n{\n    QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_TXHASH));\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "contextMenuItem->text(COLUMN_TXHASH)"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenuItem->text",
          "args": [
            "COLUMN_TXHASH"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::copyTransactionHash()\n  {\n      QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_TXHASH));\n  }\n}"
  },
  {
    "function_name": "copyAddress",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "227-233",
    "snippet": "void CoinControlDialog::copyAddress()\n{\n    if (ui->radioTreeMode->isChecked() && contextMenuItem->text(COLUMN_ADDRESS).length() == 0 && contextMenuItem->parent())\n        QApplication::clipboard()->setText(contextMenuItem->parent()->text(COLUMN_ADDRESS));\n    else\n        QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_ADDRESS));\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "contextMenuItem->text(COLUMN_ADDRESS)"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenuItem->text",
          "args": [
            "COLUMN_ADDRESS"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "contextMenuItem->parent()->text(COLUMN_ADDRESS)"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenuItem->parent",
          "args": [
            "COLUMN_ADDRESS"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenuItem->parent",
          "args": [],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenuItem->parent",
          "args": [],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenuItem->text",
          "args": [],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "contextMenuItem->text",
          "args": [
            "COLUMN_ADDRESS"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->radioTreeMode->isChecked",
          "args": [],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::copyAddress()\n  {\n      if (ui->radioTreeMode->isChecked() && contextMenuItem->text(COLUMN_ADDRESS).length() == 0 && contextMenuItem->parent())\n          QApplication::clipboard()->setText(contextMenuItem->parent()->text(COLUMN_ADDRESS));\n      else\n          QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_ADDRESS));\n  }\n}"
  },
  {
    "function_name": "copyLabel",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "218-224",
    "snippet": "void CoinControlDialog::copyLabel()\n{\n    if (ui->radioTreeMode->isChecked() && contextMenuItem->text(COLUMN_LABEL).length() == 0 && contextMenuItem->parent())\n        QApplication::clipboard()->setText(contextMenuItem->parent()->text(COLUMN_LABEL));\n    else\n        QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_LABEL));\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "contextMenuItem->text(COLUMN_LABEL)"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenuItem->text",
          "args": [
            "COLUMN_LABEL"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "contextMenuItem->parent()->text(COLUMN_LABEL)"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenuItem->parent",
          "args": [
            "COLUMN_LABEL"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenuItem->parent",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenuItem->parent",
          "args": [],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenuItem->text",
          "args": [],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "contextMenuItem->text",
          "args": [
            "COLUMN_LABEL"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->radioTreeMode->isChecked",
          "args": [],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::copyLabel()\n  {\n      if (ui->radioTreeMode->isChecked() && contextMenuItem->text(COLUMN_LABEL).length() == 0 && contextMenuItem->parent())\n          QApplication::clipboard()->setText(contextMenuItem->parent()->text(COLUMN_LABEL));\n      else\n          QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_LABEL));\n  }\n}"
  },
  {
    "function_name": "copyAmount",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "212-215",
    "snippet": "void CoinControlDialog::copyAmount()\n{\n    QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_AMOUNT));\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [
            "contextMenuItem->text(COLUMN_AMOUNT)"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenuItem->text",
          "args": [
            "COLUMN_AMOUNT"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QApplication::clipboard",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::copyAmount()\n  {\n      QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_AMOUNT));\n  }\n}"
  },
  {
    "function_name": "showMenu",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "177-209",
    "snippet": "void CoinControlDialog::showMenu(const QPoint &point)\n{\n    QTreeWidgetItem *item = ui->treeWidget->itemAt(point);\n    if(item)\n    {\n        contextMenuItem = item;\n\n        // disable some items (like Copy Transaction ID, lock, unlock) for tree roots in context menu\n        if (item->text(COLUMN_TXHASH).length() == 64) // transaction hash is 64 characters (this means its a child node, so its not a parent node in tree mode)\n        {\n            copyTransactionHashAction->setEnabled(true);\n            //if (model->isLockedCoin(uint256(item->text(COLUMN_TXHASH).toStdString()), item->text(COLUMN_VOUT_INDEX).toUInt()))\n            //{\n            //    lockAction->setEnabled(false);\n            //    unlockAction->setEnabled(true);\n            //}\n            //else\n            //{\n            //    lockAction->setEnabled(true);\n            //    unlockAction->setEnabled(false);\n            //}\n        }\n        else // this means click on parent node in tree mode -> disable all\n        {\n            copyTransactionHashAction->setEnabled(false);\n            //lockAction->setEnabled(false);\n            //unlockAction->setEnabled(false);\n        }\n\n        // show context menu\n        contextMenu->exec(QCursor::pos());\n    }\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "contextMenu->exec",
          "args": [
            "QCursor::pos()"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCursor::pos",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copyTransactionHashAction->setEnabled",
          "args": [
            "false"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copyTransactionHashAction->setEnabled",
          "args": [
            "true"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "item->text",
          "args": [],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "item->text",
          "args": [
            "COLUMN_TXHASH"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->itemAt",
          "args": [
            "point"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::showMenu(const QPoint &point)\n  {\n      QTreeWidgetItem *item = ui->treeWidget->itemAt(point);\n      if(item)\n      {\n          contextMenuItem = item;\n  \n          // disable some items (like Copy Transaction ID, lock, unlock) for tree roots in context menu\n          if (item->text(COLUMN_TXHASH).length() == 64) // transaction hash is 64 characters (this means its a child node, so its not a parent node in tree mode)\n          {\n              copyTransactionHashAction->setEnabled(true);\n              //if (model->isLockedCoin(uint256(item->text(COLUMN_TXHASH).toStdString()), item->text(COLUMN_VOUT_INDEX).toUInt()))\n              //{\n              //    lockAction->setEnabled(false);\n              //    unlockAction->setEnabled(true);\n              //}\n              //else\n              //{\n              //    lockAction->setEnabled(true);\n              //    unlockAction->setEnabled(false);\n              //}\n          }\n          else // this means click on parent node in tree mode -> disable all\n          {\n              copyTransactionHashAction->setEnabled(false);\n              //lockAction->setEnabled(false);\n              //unlockAction->setEnabled(false);\n          }\n  \n          // show context menu\n          contextMenu->exec(QCursor::pos());\n      }\n  }\n}"
  },
  {
    "function_name": "buttonSelectAllClicked",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "157-174",
    "snippet": "void CoinControlDialog::buttonSelectAllClicked()\n{\n    Qt::CheckState state = Qt::Checked;\n    for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n    {\n        if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) != Qt::Unchecked)\n        {\n            state = Qt::Unchecked;\n            break;\n        }\n    }\n    ui->treeWidget->setEnabled(false);\n    for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n            if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) != state)\n                ui->treeWidget->topLevelItem(i)->setCheckState(COLUMN_CHECKBOX, state);\n    ui->treeWidget->setEnabled(true);\n    CoinControlDialog::updateLabels(model, this);\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CoinControlDialog::updateLabels",
          "args": [
            "model",
            "this"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "updateLabels",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "413-574",
          "snippet": "void CoinControlDialog::updateLabels(WalletModel *model, QDialog* dialog)\n{\n    if (!model) return;\n\n    // nPayAmount\n    qint64 nPayAmount = 0;\n    bool fLowOutput = false;\n    bool fDust = false;\n    CTransaction txDummy;\n    foreach(const qint64 &amount, CoinControlDialog::payAmounts)\n    {\n        nPayAmount += amount;\n\n        if (amount > 0)\n        {\n            if (amount < CENT)\n                fLowOutput = true;\n\n            CTxOut txout(amount, (CScript)vector<unsigned char>(24, 0));\n            txDummy.vout.push_back(txout);\n        }\n    }\n\n    QString sPriorityLabel      = \"\";\n    int64_t nAmount             = 0;\n    int64_t nPayFee             = 0;\n    int64_t nAfterFee           = 0;\n    int64_t nChange             = 0;\n    unsigned int nBytes         = 0;\n    unsigned int nBytesInputs   = 0;\n    double dPriority            = 0;\n    double dPriorityInputs      = 0;\n    unsigned int nQuantity      = 0;\n    \n    vector<COutPoint> vCoinControl;\n    vector<COutput>   vOutputs;\n    coinControl->ListSelected(vCoinControl);\n    model->getOutputs(vCoinControl, vOutputs);\n\n    BOOST_FOREACH(const COutput& out, vOutputs)\n    {\n        // Quantity\n        nQuantity++;\n            \n        // Amount\n        nAmount += out.tx->vout[out.i].nValue;\n        \n        // Priority\n        dPriorityInputs += (double)out.tx->vout[out.i].nValue * (out.nDepth+1);\n        \n        // Bytes\n        CTxDestination address;\n        if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, address))\n        {\n            CPubKey pubkey;\n            CKeyID *keyid = boost::get< CKeyID >(&address);\n            if (keyid && model->getPubKey(*keyid, pubkey))\n                nBytesInputs += (pubkey.IsCompressed() ? 148 : 180);\n            else\n                nBytesInputs += 148; // in all error cases, simply assume 148 here\n        }\n        else nBytesInputs += 148;\n    }\n    \n    // calculation\n    if (nQuantity > 0)\n    {\n        // Bytes\n        nBytes = nBytesInputs + ((CoinControlDialog::payAmounts.size() > 0 ? CoinControlDialog::payAmounts.size() + 1 : 2) * 34) + 10; // always assume +1 output for change here\n        \n        // Priority\n        dPriority = dPriorityInputs / nBytes;\n        sPriorityLabel = CoinControlDialog::getPriorityLabel(dPriority);\n        \n        // Fee\n        int64_t nFee = nTransactionFee * (1 + (int64_t)nBytes / 1000);\n        \n        // Min Fee\n        int64_t nMinFee = txDummy.GetMinFee(1, GMF_SEND, nBytes);\n        \n        nPayFee = max(nFee, nMinFee);\n        \n        if (nPayAmount > 0)\n        {\n            nChange = nAmount - nPayFee - nPayAmount;\n            \n            // if sub-cent change is required, the fee must be raised to at least CTransaction::nMinTxFee   \n            if (nPayFee < CENT && nChange > 0 && nChange < CENT)\n            {\n                if (nChange < CENT) // change < 0.01 => simply move all change to fees\n                {\n                    nPayFee = nChange;\n                    nChange = 0;\n                }\n                else\n                {\n                    nChange = nChange + nPayFee - CENT;\n                    nPayFee = CENT;\n                }  \n            }\n            \n            if (nChange == 0)\n                nBytes -= 34;\n        }\n        \n        // after fee\n        nAfterFee = nAmount - nPayFee;\n        if (nAfterFee < 0)\n            nAfterFee = 0;\n    }\n    \n    // actually update labels\n    int nDisplayUnit = BitcoinUnits::BTC;\n    if (model && model->getOptionsModel())\n        nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n            \n    QLabel *l1 = dialog->findChild<QLabel *>(\"labelCoinControlQuantity\");\n    QLabel *l2 = dialog->findChild<QLabel *>(\"labelCoinControlAmount\");\n    QLabel *l3 = dialog->findChild<QLabel *>(\"labelCoinControlFee\");\n    QLabel *l4 = dialog->findChild<QLabel *>(\"labelCoinControlAfterFee\");\n    QLabel *l5 = dialog->findChild<QLabel *>(\"labelCoinControlBytes\");\n    QLabel *l6 = dialog->findChild<QLabel *>(\"labelCoinControlPriority\");\n    QLabel *l7 = dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\");\n    QLabel *l8 = dialog->findChild<QLabel *>(\"labelCoinControlChange\");\n    \n    // enable/disable \"low output\" and \"change\"\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\")    ->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlChange\")       ->setEnabled(nPayAmount > 0);\n    \n    // stats\n    l1->setText(QString::number(nQuantity));                                 // Quantity        \n    l2->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAmount));        // Amount\n    l3->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nPayFee));        // Fee\n    l4->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAfterFee));      // After Fee\n    l5->setText(((nBytes > 0) ? \"~\" : \"\") + QString::number(nBytes));                                    // Bytes\n    l6->setText(sPriorityLabel);                                             // Priority\n    l7->setText((fLowOutput ? (fDust ? tr(\"DUST\") : tr(\"yes\")) : tr(\"no\"))); // Low Output / Dust\n    l8->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nChange));        // Change\n    \n    // turn labels \"red\"\n    l5->setStyleSheet((nBytes >= 10000) ? \"color:red;\" : \"\");               // Bytes >= 10000\n    l6->setStyleSheet((dPriority <= 576000) ? \"color:red;\" : \"\");         // Priority < \"medium\"\n    l7->setStyleSheet((fLowOutput) ? \"color:red;\" : \"\");                    // Low Output = \"yes\"\n    l8->setStyleSheet((nChange > 0 && nChange < CENT) ? \"color:red;\" : \"\"); // Change < 0.01BTC\n        \n    // tool tips\n    l5->setToolTip(tr(\"This label turns red, if the transaction size is bigger than 10000 bytes.\\n\\n This means a fee of at least %1 per kb is required.\\n\\n Can vary +/- 1 Byte per input.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l6->setToolTip(tr(\"Transactions with higher priority get more likely into a block.\\n\\nThis label turns red, if the priority is smaller than \\\"medium\\\".\\n\\n This means a fee of at least %1 per kb is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l7->setToolTip(tr(\"This label turns red, if any recipient receives an amount smaller than %1.\\n\\n This means a fee of at least %2 is required. \\n\\n Amounts below 0.546 times the minimum relay fee are shown as DUST.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l8->setToolTip(tr(\"This label turns red, if the change is smaller than %1.\\n\\n This means a fee of at least %2 is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    dialog->findChild<QLabel *>(\"labelCoinControlBytesText\")    ->setToolTip(l5->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlPriorityText\") ->setToolTip(l6->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setToolTip(l7->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setToolTip(l8->toolTip());\n   \n    // Insufficient funds\n    QLabel *label = dialog->findChild<QLabel *>(\"labelCoinControlInsuffFunds\");\n    if (label)\n        label->setVisible(nChange < 0);\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QList<qint64> CoinControlDialog::payAmounts;",
            "CCoinControl* CoinControlDialog::coinControl = new CCoinControl();"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nQList<qint64> CoinControlDialog::payAmounts;\nCCoinControl* CoinControlDialog::coinControl = new CCoinControl();\n\nCoinControlDialog {\n  void CoinControlDialog::updateLabels(WalletModel *model, QDialog* dialog)\n  {\n      if (!model) return;\n  \n      // nPayAmount\n      qint64 nPayAmount = 0;\n      bool fLowOutput = false;\n      bool fDust = false;\n      CTransaction txDummy;\n      foreach(const qint64 &amount, CoinControlDialog::payAmounts)\n      {\n          nPayAmount += amount;\n  \n          if (amount > 0)\n          {\n              if (amount < CENT)\n                  fLowOutput = true;\n  \n              CTxOut txout(amount, (CScript)vector<unsigned char>(24, 0));\n              txDummy.vout.push_back(txout);\n          }\n      }\n  \n      QString sPriorityLabel      = \"\";\n      int64_t nAmount             = 0;\n      int64_t nPayFee             = 0;\n      int64_t nAfterFee           = 0;\n      int64_t nChange             = 0;\n      unsigned int nBytes         = 0;\n      unsigned int nBytesInputs   = 0;\n      double dPriority            = 0;\n      double dPriorityInputs      = 0;\n      unsigned int nQuantity      = 0;\n      \n      vector<COutPoint> vCoinControl;\n      vector<COutput>   vOutputs;\n      coinControl->ListSelected(vCoinControl);\n      model->getOutputs(vCoinControl, vOutputs);\n  \n      BOOST_FOREACH(const COutput& out, vOutputs)\n      {\n          // Quantity\n          nQuantity++;\n              \n          // Amount\n          nAmount += out.tx->vout[out.i].nValue;\n          \n          // Priority\n          dPriorityInputs += (double)out.tx->vout[out.i].nValue * (out.nDepth+1);\n          \n          // Bytes\n          CTxDestination address;\n          if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, address))\n          {\n              CPubKey pubkey;\n              CKeyID *keyid = boost::get< CKeyID >(&address);\n              if (keyid && model->getPubKey(*keyid, pubkey))\n                  nBytesInputs += (pubkey.IsCompressed() ? 148 : 180);\n              else\n                  nBytesInputs += 148; // in all error cases, simply assume 148 here\n          }\n          else nBytesInputs += 148;\n      }\n      \n      // calculation\n      if (nQuantity > 0)\n      {\n          // Bytes\n          nBytes = nBytesInputs + ((CoinControlDialog::payAmounts.size() > 0 ? CoinControlDialog::payAmounts.size() + 1 : 2) * 34) + 10; // always assume +1 output for change here\n          \n          // Priority\n          dPriority = dPriorityInputs / nBytes;\n          sPriorityLabel = CoinControlDialog::getPriorityLabel(dPriority);\n          \n          // Fee\n          int64_t nFee = nTransactionFee * (1 + (int64_t)nBytes / 1000);\n          \n          // Min Fee\n          int64_t nMinFee = txDummy.GetMinFee(1, GMF_SEND, nBytes);\n          \n          nPayFee = max(nFee, nMinFee);\n          \n          if (nPayAmount > 0)\n          {\n              nChange = nAmount - nPayFee - nPayAmount;\n              \n              // if sub-cent change is required, the fee must be raised to at least CTransaction::nMinTxFee   \n              if (nPayFee < CENT && nChange > 0 && nChange < CENT)\n              {\n                  if (nChange < CENT) // change < 0.01 => simply move all change to fees\n                  {\n                      nPayFee = nChange;\n                      nChange = 0;\n                  }\n                  else\n                  {\n                      nChange = nChange + nPayFee - CENT;\n                      nPayFee = CENT;\n                  }  \n              }\n              \n              if (nChange == 0)\n                  nBytes -= 34;\n          }\n          \n          // after fee\n          nAfterFee = nAmount - nPayFee;\n          if (nAfterFee < 0)\n              nAfterFee = 0;\n      }\n      \n      // actually update labels\n      int nDisplayUnit = BitcoinUnits::BTC;\n      if (model && model->getOptionsModel())\n          nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n              \n      QLabel *l1 = dialog->findChild<QLabel *>(\"labelCoinControlQuantity\");\n      QLabel *l2 = dialog->findChild<QLabel *>(\"labelCoinControlAmount\");\n      QLabel *l3 = dialog->findChild<QLabel *>(\"labelCoinControlFee\");\n      QLabel *l4 = dialog->findChild<QLabel *>(\"labelCoinControlAfterFee\");\n      QLabel *l5 = dialog->findChild<QLabel *>(\"labelCoinControlBytes\");\n      QLabel *l6 = dialog->findChild<QLabel *>(\"labelCoinControlPriority\");\n      QLabel *l7 = dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\");\n      QLabel *l8 = dialog->findChild<QLabel *>(\"labelCoinControlChange\");\n      \n      // enable/disable \"low output\" and \"change\"\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\")    ->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlChange\")       ->setEnabled(nPayAmount > 0);\n      \n      // stats\n      l1->setText(QString::number(nQuantity));                                 // Quantity        \n      l2->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAmount));        // Amount\n      l3->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nPayFee));        // Fee\n      l4->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAfterFee));      // After Fee\n      l5->setText(((nBytes > 0) ? \"~\" : \"\") + QString::number(nBytes));                                    // Bytes\n      l6->setText(sPriorityLabel);                                             // Priority\n      l7->setText((fLowOutput ? (fDust ? tr(\"DUST\") : tr(\"yes\")) : tr(\"no\"))); // Low Output / Dust\n      l8->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nChange));        // Change\n      \n      // turn labels \"red\"\n      l5->setStyleSheet((nBytes >= 10000) ? \"color:red;\" : \"\");               // Bytes >= 10000\n      l6->setStyleSheet((dPriority <= 576000) ? \"color:red;\" : \"\");         // Priority < \"medium\"\n      l7->setStyleSheet((fLowOutput) ? \"color:red;\" : \"\");                    // Low Output = \"yes\"\n      l8->setStyleSheet((nChange > 0 && nChange < CENT) ? \"color:red;\" : \"\"); // Change < 0.01BTC\n          \n      // tool tips\n      l5->setToolTip(tr(\"This label turns red, if the transaction size is bigger than 10000 bytes.\\n\\n This means a fee of at least %1 per kb is required.\\n\\n Can vary +/- 1 Byte per input.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l6->setToolTip(tr(\"Transactions with higher priority get more likely into a block.\\n\\nThis label turns red, if the priority is smaller than \\\"medium\\\".\\n\\n This means a fee of at least %1 per kb is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l7->setToolTip(tr(\"This label turns red, if any recipient receives an amount smaller than %1.\\n\\n This means a fee of at least %2 is required. \\n\\n Amounts below 0.546 times the minimum relay fee are shown as DUST.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l8->setToolTip(tr(\"This label turns red, if the change is smaller than %1.\\n\\n This means a fee of at least %2 is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      dialog->findChild<QLabel *>(\"labelCoinControlBytesText\")    ->setToolTip(l5->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlPriorityText\") ->setToolTip(l6->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setToolTip(l7->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setToolTip(l8->toolTip());\n     \n      // Insufficient funds\n      QLabel *label = dialog->findChild<QLabel *>(\"labelCoinControlInsuffFunds\");\n      if (label)\n          label->setVisible(nChange < 0);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setEnabled",
          "args": [
            "true"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->topLevelItem",
          "args": [
            "COLUMN_CHECKBOX",
            "state"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->topLevelItem",
          "args": [
            "i"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->topLevelItem",
          "args": [
            "COLUMN_CHECKBOX"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->topLevelItem",
          "args": [
            "i"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->topLevelItemCount",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setEnabled",
          "args": [
            "false"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->topLevelItem",
          "args": [
            "COLUMN_CHECKBOX"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->topLevelItem",
          "args": [
            "i"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->topLevelItemCount",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::buttonSelectAllClicked()\n  {\n      Qt::CheckState state = Qt::Checked;\n      for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n      {\n          if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) != Qt::Unchecked)\n          {\n              state = Qt::Unchecked;\n              break;\n          }\n      }\n      ui->treeWidget->setEnabled(false);\n      for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n              if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) != state)\n                  ui->treeWidget->topLevelItem(i)->setCheckState(COLUMN_CHECKBOX, state);\n      ui->treeWidget->setEnabled(true);\n      CoinControlDialog::updateLabels(model, this);\n  }\n}"
  },
  {
    "function_name": "buttonBoxClicked",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "150-154",
    "snippet": "void CoinControlDialog::buttonBoxClicked(QAbstractButton* button)\n{\n    if (ui->buttonBox->buttonRole(button) == QDialogButtonBox::AcceptRole)\n        done(QDialog::Accepted); // closes the dialog\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "done",
          "args": [
            "QDialog::Accepted"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "done",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "285-310",
          "snippet": "void AddressBookPage::done(int retval)\n{\n    QTableView *table = ui->tableView;\n    if(!table->selectionModel() || !table->model())\n        return;\n    // When this is a tab/widget and not a model dialog, ignore \"done\"\n    if(mode == ForEditing)\n        return;\n\n    // Figure out which address was selected, and return it\n    QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n\n    foreach (QModelIndex index, indexes)\n    {\n        QVariant address = table->model()->data(index);\n        returnValue = address.toString();\n    }\n\n    if(returnValue.isEmpty())\n    {\n        // If no address entry selected, return rejected\n        retval = Rejected;\n    }\n\n    QDialog::done(retval);\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::done(int retval)\n  {\n      QTableView *table = ui->tableView;\n      if(!table->selectionModel() || !table->model())\n          return;\n      // When this is a tab/widget and not a model dialog, ignore \"done\"\n      if(mode == ForEditing)\n          return;\n  \n      // Figure out which address was selected, and return it\n      QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n  \n      foreach (QModelIndex index, indexes)\n      {\n          QVariant address = table->model()->data(index);\n          returnValue = address.toString();\n      }\n  \n      if(returnValue.isEmpty())\n      {\n          // If no address entry selected, return rejected\n          retval = Rejected;\n      }\n  \n      QDialog::done(retval);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->buttonBox->buttonRole",
          "args": [
            "button"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::buttonBoxClicked(QAbstractButton* button)\n  {\n      if (ui->buttonBox->buttonRole(button) == QDialogButtonBox::AcceptRole)\n          done(QDialog::Accepted); // closes the dialog\n  }\n}"
  },
  {
    "function_name": "strPad",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "141-147",
    "snippet": "QString CoinControlDialog::strPad(QString s, int nPadLength, QString sPadding)\n{\n    while (s.length() < nPadLength)\n        s = sPadding + s;\n\n    return s;\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s.length",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  QString CoinControlDialog::strPad(QString s, int nPadLength, QString sPadding)\n  {\n      while (s.length() < nPadLength)\n          s = sPadding + s;\n  \n      return s;\n  }\n}"
  },
  {
    "function_name": "setModel",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "128-138",
    "snippet": "void CoinControlDialog::setModel(WalletModel *model)\n{\n    this->model = model;\n\n    if(model && model->getOptionsModel() && model->getAddressTableModel())\n    {\n        updateView();\n        //updateLabelLocked();\n        CoinControlDialog::updateLabels(model, this);\n    }\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CoinControlDialog::updateLabels",
          "args": [
            "model",
            "this"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "updateLabels",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "413-574",
          "snippet": "void CoinControlDialog::updateLabels(WalletModel *model, QDialog* dialog)\n{\n    if (!model) return;\n\n    // nPayAmount\n    qint64 nPayAmount = 0;\n    bool fLowOutput = false;\n    bool fDust = false;\n    CTransaction txDummy;\n    foreach(const qint64 &amount, CoinControlDialog::payAmounts)\n    {\n        nPayAmount += amount;\n\n        if (amount > 0)\n        {\n            if (amount < CENT)\n                fLowOutput = true;\n\n            CTxOut txout(amount, (CScript)vector<unsigned char>(24, 0));\n            txDummy.vout.push_back(txout);\n        }\n    }\n\n    QString sPriorityLabel      = \"\";\n    int64_t nAmount             = 0;\n    int64_t nPayFee             = 0;\n    int64_t nAfterFee           = 0;\n    int64_t nChange             = 0;\n    unsigned int nBytes         = 0;\n    unsigned int nBytesInputs   = 0;\n    double dPriority            = 0;\n    double dPriorityInputs      = 0;\n    unsigned int nQuantity      = 0;\n    \n    vector<COutPoint> vCoinControl;\n    vector<COutput>   vOutputs;\n    coinControl->ListSelected(vCoinControl);\n    model->getOutputs(vCoinControl, vOutputs);\n\n    BOOST_FOREACH(const COutput& out, vOutputs)\n    {\n        // Quantity\n        nQuantity++;\n            \n        // Amount\n        nAmount += out.tx->vout[out.i].nValue;\n        \n        // Priority\n        dPriorityInputs += (double)out.tx->vout[out.i].nValue * (out.nDepth+1);\n        \n        // Bytes\n        CTxDestination address;\n        if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, address))\n        {\n            CPubKey pubkey;\n            CKeyID *keyid = boost::get< CKeyID >(&address);\n            if (keyid && model->getPubKey(*keyid, pubkey))\n                nBytesInputs += (pubkey.IsCompressed() ? 148 : 180);\n            else\n                nBytesInputs += 148; // in all error cases, simply assume 148 here\n        }\n        else nBytesInputs += 148;\n    }\n    \n    // calculation\n    if (nQuantity > 0)\n    {\n        // Bytes\n        nBytes = nBytesInputs + ((CoinControlDialog::payAmounts.size() > 0 ? CoinControlDialog::payAmounts.size() + 1 : 2) * 34) + 10; // always assume +1 output for change here\n        \n        // Priority\n        dPriority = dPriorityInputs / nBytes;\n        sPriorityLabel = CoinControlDialog::getPriorityLabel(dPriority);\n        \n        // Fee\n        int64_t nFee = nTransactionFee * (1 + (int64_t)nBytes / 1000);\n        \n        // Min Fee\n        int64_t nMinFee = txDummy.GetMinFee(1, GMF_SEND, nBytes);\n        \n        nPayFee = max(nFee, nMinFee);\n        \n        if (nPayAmount > 0)\n        {\n            nChange = nAmount - nPayFee - nPayAmount;\n            \n            // if sub-cent change is required, the fee must be raised to at least CTransaction::nMinTxFee   \n            if (nPayFee < CENT && nChange > 0 && nChange < CENT)\n            {\n                if (nChange < CENT) // change < 0.01 => simply move all change to fees\n                {\n                    nPayFee = nChange;\n                    nChange = 0;\n                }\n                else\n                {\n                    nChange = nChange + nPayFee - CENT;\n                    nPayFee = CENT;\n                }  \n            }\n            \n            if (nChange == 0)\n                nBytes -= 34;\n        }\n        \n        // after fee\n        nAfterFee = nAmount - nPayFee;\n        if (nAfterFee < 0)\n            nAfterFee = 0;\n    }\n    \n    // actually update labels\n    int nDisplayUnit = BitcoinUnits::BTC;\n    if (model && model->getOptionsModel())\n        nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n            \n    QLabel *l1 = dialog->findChild<QLabel *>(\"labelCoinControlQuantity\");\n    QLabel *l2 = dialog->findChild<QLabel *>(\"labelCoinControlAmount\");\n    QLabel *l3 = dialog->findChild<QLabel *>(\"labelCoinControlFee\");\n    QLabel *l4 = dialog->findChild<QLabel *>(\"labelCoinControlAfterFee\");\n    QLabel *l5 = dialog->findChild<QLabel *>(\"labelCoinControlBytes\");\n    QLabel *l6 = dialog->findChild<QLabel *>(\"labelCoinControlPriority\");\n    QLabel *l7 = dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\");\n    QLabel *l8 = dialog->findChild<QLabel *>(\"labelCoinControlChange\");\n    \n    // enable/disable \"low output\" and \"change\"\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\")    ->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setEnabled(nPayAmount > 0);\n    dialog->findChild<QLabel *>(\"labelCoinControlChange\")       ->setEnabled(nPayAmount > 0);\n    \n    // stats\n    l1->setText(QString::number(nQuantity));                                 // Quantity        \n    l2->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAmount));        // Amount\n    l3->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nPayFee));        // Fee\n    l4->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAfterFee));      // After Fee\n    l5->setText(((nBytes > 0) ? \"~\" : \"\") + QString::number(nBytes));                                    // Bytes\n    l6->setText(sPriorityLabel);                                             // Priority\n    l7->setText((fLowOutput ? (fDust ? tr(\"DUST\") : tr(\"yes\")) : tr(\"no\"))); // Low Output / Dust\n    l8->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nChange));        // Change\n    \n    // turn labels \"red\"\n    l5->setStyleSheet((nBytes >= 10000) ? \"color:red;\" : \"\");               // Bytes >= 10000\n    l6->setStyleSheet((dPriority <= 576000) ? \"color:red;\" : \"\");         // Priority < \"medium\"\n    l7->setStyleSheet((fLowOutput) ? \"color:red;\" : \"\");                    // Low Output = \"yes\"\n    l8->setStyleSheet((nChange > 0 && nChange < CENT) ? \"color:red;\" : \"\"); // Change < 0.01BTC\n        \n    // tool tips\n    l5->setToolTip(tr(\"This label turns red, if the transaction size is bigger than 10000 bytes.\\n\\n This means a fee of at least %1 per kb is required.\\n\\n Can vary +/- 1 Byte per input.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l6->setToolTip(tr(\"Transactions with higher priority get more likely into a block.\\n\\nThis label turns red, if the priority is smaller than \\\"medium\\\".\\n\\n This means a fee of at least %1 per kb is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l7->setToolTip(tr(\"This label turns red, if any recipient receives an amount smaller than %1.\\n\\n This means a fee of at least %2 is required. \\n\\n Amounts below 0.546 times the minimum relay fee are shown as DUST.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    l8->setToolTip(tr(\"This label turns red, if the change is smaller than %1.\\n\\n This means a fee of at least %2 is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n    dialog->findChild<QLabel *>(\"labelCoinControlBytesText\")    ->setToolTip(l5->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlPriorityText\") ->setToolTip(l6->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setToolTip(l7->toolTip());\n    dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setToolTip(l8->toolTip());\n   \n    // Insufficient funds\n    QLabel *label = dialog->findChild<QLabel *>(\"labelCoinControlInsuffFunds\");\n    if (label)\n        label->setVisible(nChange < 0);\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QList<qint64> CoinControlDialog::payAmounts;",
            "CCoinControl* CoinControlDialog::coinControl = new CCoinControl();"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nQList<qint64> CoinControlDialog::payAmounts;\nCCoinControl* CoinControlDialog::coinControl = new CCoinControl();\n\nCoinControlDialog {\n  void CoinControlDialog::updateLabels(WalletModel *model, QDialog* dialog)\n  {\n      if (!model) return;\n  \n      // nPayAmount\n      qint64 nPayAmount = 0;\n      bool fLowOutput = false;\n      bool fDust = false;\n      CTransaction txDummy;\n      foreach(const qint64 &amount, CoinControlDialog::payAmounts)\n      {\n          nPayAmount += amount;\n  \n          if (amount > 0)\n          {\n              if (amount < CENT)\n                  fLowOutput = true;\n  \n              CTxOut txout(amount, (CScript)vector<unsigned char>(24, 0));\n              txDummy.vout.push_back(txout);\n          }\n      }\n  \n      QString sPriorityLabel      = \"\";\n      int64_t nAmount             = 0;\n      int64_t nPayFee             = 0;\n      int64_t nAfterFee           = 0;\n      int64_t nChange             = 0;\n      unsigned int nBytes         = 0;\n      unsigned int nBytesInputs   = 0;\n      double dPriority            = 0;\n      double dPriorityInputs      = 0;\n      unsigned int nQuantity      = 0;\n      \n      vector<COutPoint> vCoinControl;\n      vector<COutput>   vOutputs;\n      coinControl->ListSelected(vCoinControl);\n      model->getOutputs(vCoinControl, vOutputs);\n  \n      BOOST_FOREACH(const COutput& out, vOutputs)\n      {\n          // Quantity\n          nQuantity++;\n              \n          // Amount\n          nAmount += out.tx->vout[out.i].nValue;\n          \n          // Priority\n          dPriorityInputs += (double)out.tx->vout[out.i].nValue * (out.nDepth+1);\n          \n          // Bytes\n          CTxDestination address;\n          if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, address))\n          {\n              CPubKey pubkey;\n              CKeyID *keyid = boost::get< CKeyID >(&address);\n              if (keyid && model->getPubKey(*keyid, pubkey))\n                  nBytesInputs += (pubkey.IsCompressed() ? 148 : 180);\n              else\n                  nBytesInputs += 148; // in all error cases, simply assume 148 here\n          }\n          else nBytesInputs += 148;\n      }\n      \n      // calculation\n      if (nQuantity > 0)\n      {\n          // Bytes\n          nBytes = nBytesInputs + ((CoinControlDialog::payAmounts.size() > 0 ? CoinControlDialog::payAmounts.size() + 1 : 2) * 34) + 10; // always assume +1 output for change here\n          \n          // Priority\n          dPriority = dPriorityInputs / nBytes;\n          sPriorityLabel = CoinControlDialog::getPriorityLabel(dPriority);\n          \n          // Fee\n          int64_t nFee = nTransactionFee * (1 + (int64_t)nBytes / 1000);\n          \n          // Min Fee\n          int64_t nMinFee = txDummy.GetMinFee(1, GMF_SEND, nBytes);\n          \n          nPayFee = max(nFee, nMinFee);\n          \n          if (nPayAmount > 0)\n          {\n              nChange = nAmount - nPayFee - nPayAmount;\n              \n              // if sub-cent change is required, the fee must be raised to at least CTransaction::nMinTxFee   \n              if (nPayFee < CENT && nChange > 0 && nChange < CENT)\n              {\n                  if (nChange < CENT) // change < 0.01 => simply move all change to fees\n                  {\n                      nPayFee = nChange;\n                      nChange = 0;\n                  }\n                  else\n                  {\n                      nChange = nChange + nPayFee - CENT;\n                      nPayFee = CENT;\n                  }  \n              }\n              \n              if (nChange == 0)\n                  nBytes -= 34;\n          }\n          \n          // after fee\n          nAfterFee = nAmount - nPayFee;\n          if (nAfterFee < 0)\n              nAfterFee = 0;\n      }\n      \n      // actually update labels\n      int nDisplayUnit = BitcoinUnits::BTC;\n      if (model && model->getOptionsModel())\n          nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n              \n      QLabel *l1 = dialog->findChild<QLabel *>(\"labelCoinControlQuantity\");\n      QLabel *l2 = dialog->findChild<QLabel *>(\"labelCoinControlAmount\");\n      QLabel *l3 = dialog->findChild<QLabel *>(\"labelCoinControlFee\");\n      QLabel *l4 = dialog->findChild<QLabel *>(\"labelCoinControlAfterFee\");\n      QLabel *l5 = dialog->findChild<QLabel *>(\"labelCoinControlBytes\");\n      QLabel *l6 = dialog->findChild<QLabel *>(\"labelCoinControlPriority\");\n      QLabel *l7 = dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\");\n      QLabel *l8 = dialog->findChild<QLabel *>(\"labelCoinControlChange\");\n      \n      // enable/disable \"low output\" and \"change\"\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutput\")    ->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setEnabled(nPayAmount > 0);\n      dialog->findChild<QLabel *>(\"labelCoinControlChange\")       ->setEnabled(nPayAmount > 0);\n      \n      // stats\n      l1->setText(QString::number(nQuantity));                                 // Quantity        \n      l2->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAmount));        // Amount\n      l3->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nPayFee));        // Fee\n      l4->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nAfterFee));      // After Fee\n      l5->setText(((nBytes > 0) ? \"~\" : \"\") + QString::number(nBytes));                                    // Bytes\n      l6->setText(sPriorityLabel);                                             // Priority\n      l7->setText((fLowOutput ? (fDust ? tr(\"DUST\") : tr(\"yes\")) : tr(\"no\"))); // Low Output / Dust\n      l8->setText(BitcoinUnits::formatWithUnit(nDisplayUnit, nChange));        // Change\n      \n      // turn labels \"red\"\n      l5->setStyleSheet((nBytes >= 10000) ? \"color:red;\" : \"\");               // Bytes >= 10000\n      l6->setStyleSheet((dPriority <= 576000) ? \"color:red;\" : \"\");         // Priority < \"medium\"\n      l7->setStyleSheet((fLowOutput) ? \"color:red;\" : \"\");                    // Low Output = \"yes\"\n      l8->setStyleSheet((nChange > 0 && nChange < CENT) ? \"color:red;\" : \"\"); // Change < 0.01BTC\n          \n      // tool tips\n      l5->setToolTip(tr(\"This label turns red, if the transaction size is bigger than 10000 bytes.\\n\\n This means a fee of at least %1 per kb is required.\\n\\n Can vary +/- 1 Byte per input.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l6->setToolTip(tr(\"Transactions with higher priority get more likely into a block.\\n\\nThis label turns red, if the priority is smaller than \\\"medium\\\".\\n\\n This means a fee of at least %1 per kb is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l7->setToolTip(tr(\"This label turns red, if any recipient receives an amount smaller than %1.\\n\\n This means a fee of at least %2 is required. \\n\\n Amounts below 0.546 times the minimum relay fee are shown as DUST.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      l8->setToolTip(tr(\"This label turns red, if the change is smaller than %1.\\n\\n This means a fee of at least %2 is required.\").arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)).arg(BitcoinUnits::formatWithUnit(nDisplayUnit, CENT)));\n      dialog->findChild<QLabel *>(\"labelCoinControlBytesText\")    ->setToolTip(l5->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlPriorityText\") ->setToolTip(l6->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlLowOutputText\")->setToolTip(l7->toolTip());\n      dialog->findChild<QLabel *>(\"labelCoinControlChangeText\")   ->setToolTip(l8->toolTip());\n     \n      // Insufficient funds\n      QLabel *label = dialog->findChild<QLabel *>(\"labelCoinControlInsuffFunds\");\n      if (label)\n          label->setVisible(nChange < 0);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "updateView",
          "args": [],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "updateView",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "576-738",
          "snippet": "void CoinControlDialog::updateView()\n{\n    bool treeMode = ui->radioTreeMode->isChecked();\n\n    ui->treeWidget->clear();\n    ui->treeWidget->setEnabled(false); // performance, otherwise updateLabels would be called for every checked checkbox\n    ui->treeWidget->setAlternatingRowColors(!treeMode);\n    QFlags<Qt::ItemFlag> flgCheckbox=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable;\n    QFlags<Qt::ItemFlag> flgTristate=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable | Qt::ItemIsTristate;    \n    \n    int nDisplayUnit = BitcoinUnits::BTC;\n    if (model && model->getOptionsModel())\n        nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n        \n    map<QString, vector<COutput> > mapCoins;\n    model->listCoins(mapCoins);\n\n    BOOST_FOREACH(PAIRTYPE(QString, vector<COutput>) coins, mapCoins)\n    {\n        QTreeWidgetItem *itemWalletAddress = new QTreeWidgetItem();\n        QString sWalletAddress = coins.first;\n        QString sWalletLabel = \"\";\n        if (model->getAddressTableModel())\n            sWalletLabel = model->getAddressTableModel()->labelForAddress(sWalletAddress);\n        if (sWalletLabel.length() == 0)\n            sWalletLabel = tr(\"(no label)\");\n        \n        if (treeMode)\n        {\n            // wallet address\n            ui->treeWidget->addTopLevelItem(itemWalletAddress);\n\n            itemWalletAddress->setFlags(flgTristate);\n            itemWalletAddress->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n            \n            for (int i = 0; i < ui->treeWidget->columnCount(); i++)\n                itemWalletAddress->setBackground(i, QColor(248, 247, 246));\n            \n            // label\n            itemWalletAddress->setText(COLUMN_LABEL, sWalletLabel);\n\n            // address\n            itemWalletAddress->setText(COLUMN_ADDRESS, sWalletAddress);\n        }\n\n        int64_t nSum = 0;\n        double dPrioritySum = 0;\n        int nChildren = 0;\n        int nInputSum = 0;\n        BOOST_FOREACH(const COutput& out, coins.second)\n        {\n            int nInputSize = 148; // 180 if uncompressed public key\n            nSum += out.tx->vout[out.i].nValue;\n            nChildren++;\n            \n            QTreeWidgetItem *itemOutput;\n            if (treeMode)    itemOutput = new QTreeWidgetItem(itemWalletAddress);\n            else             itemOutput = new QTreeWidgetItem(ui->treeWidget);\n            itemOutput->setFlags(flgCheckbox);\n            itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n                \n            // address\n            CTxDestination outputAddress;\n            QString sAddress = \"\";\n            if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, outputAddress))\n            {\n                sAddress = CBitcoinAddress(outputAddress).ToString().c_str();\n                \n                // if listMode or change => show bitcoin address. In tree mode, address is not shown again for direct wallet address outputs\n                if (!treeMode || (!(sAddress == sWalletAddress)))\n                    itemOutput->setText(COLUMN_ADDRESS, sAddress);\n                    \n                CPubKey pubkey;\n                CKeyID *keyid = boost::get< CKeyID >(&outputAddress);\n                if (keyid && model->getPubKey(*keyid, pubkey) && !pubkey.IsCompressed())\n                    nInputSize = 180;\n            }\n\n            // label\n            if (!(sAddress == sWalletAddress)) // change\n            {\n                // tooltip from where the change comes from\n                itemOutput->setToolTip(COLUMN_LABEL, tr(\"change from %1 (%2)\").arg(sWalletLabel).arg(sWalletAddress));\n                itemOutput->setText(COLUMN_LABEL, tr(\"(change)\"));\n            }\n            else if (!treeMode)\n            {\n                QString sLabel = \"\";\n                if (model->getAddressTableModel())\n                    sLabel = model->getAddressTableModel()->labelForAddress(sAddress);\n                if (sLabel.length() == 0)\n                    sLabel = tr(\"(no label)\");\n                itemOutput->setText(COLUMN_LABEL, sLabel); \n            }\n\n            // amount\n            itemOutput->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, out.tx->vout[out.i].nValue));\n            itemOutput->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(out.tx->vout[out.i].nValue), 15, \" \")); // padding so that sorting works correctly\n\n            // date\n            itemOutput->setText(COLUMN_DATE, QDateTime::fromTime_t(out.tx->GetTxTime()).toUTC().toString(\"yy-MM-dd hh:mm\"));\n            \n            // immature PoS reward\n            if (out.tx->IsCoinStake() && out.tx->GetBlocksToMaturity() > 0 && out.tx->GetDepthInMainChain() > 0) {\n              itemOutput->setBackground(COLUMN_CONFIRMATIONS, Qt::red);\n              itemOutput->setDisabled(true);\n            }\n\n            // confirmations\n            itemOutput->setText(COLUMN_CONFIRMATIONS, strPad(QString::number(out.nDepth), 8, \" \"));\n            \n            // priority\n            double dPriority = ((double)out.tx->vout[out.i].nValue  / (nInputSize + 78)) * (out.nDepth+1); // 78 = 2 * 34 + 10\n            itemOutput->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPriority));\n            itemOutput->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPriority), 20, \" \"));\n            dPrioritySum += (double)out.tx->vout[out.i].nValue  * (out.nDepth+1);\n            nInputSum    += nInputSize;\n            \n            // transaction hash\n            uint256 txhash = out.tx->GetHash();\n            itemOutput->setText(COLUMN_TXHASH, txhash.GetHex().c_str());\n    \n            // vout index\n            itemOutput->setText(COLUMN_VOUT_INDEX, QString::number(out.i));\n            \n            // disable locked coins     \n            /*if (model->isLockedCoin(txhash, out.i))\n            {\n                COutPoint outpt(txhash, out.i);\n                coinControl->UnSelect(outpt); // just to be sure\n                itemOutput->setDisabled(true);\n                itemOutput->setIcon(COLUMN_CHECKBOX, QIcon(\":/icons/lock_closed\"));\n            }*/\n              \n            // set checkbox\n            if (coinControl->IsSelected(txhash, out.i))\n                itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Checked);\n        }\n\n        // amount\n        if (treeMode)\n        {\n            dPrioritySum = dPrioritySum / (nInputSum + 78);\n            itemWalletAddress->setText(COLUMN_CHECKBOX, \"(\" + QString::number(nChildren) + \")\");\n            itemWalletAddress->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, nSum));\n            itemWalletAddress->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(nSum), 15, \" \"));\n            itemWalletAddress->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPrioritySum));\n            itemWalletAddress->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPrioritySum), 20, \" \"));\n        }\n    }\n    \n    // expand all partially selected\n    if (treeMode)\n    {\n        for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n            if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) == Qt::PartiallyChecked)\n                ui->treeWidget->topLevelItem(i)->setExpanded(true);\n    }\n    \n    // sort view\n    sortView(sortColumn, sortOrder);\n    ui->treeWidget->setEnabled(true);\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "CCoinControl* CoinControlDialog::coinControl = new CCoinControl();"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCCoinControl* CoinControlDialog::coinControl = new CCoinControl();\n\nCoinControlDialog {\n  void CoinControlDialog::updateView()\n  {\n      bool treeMode = ui->radioTreeMode->isChecked();\n  \n      ui->treeWidget->clear();\n      ui->treeWidget->setEnabled(false); // performance, otherwise updateLabels would be called for every checked checkbox\n      ui->treeWidget->setAlternatingRowColors(!treeMode);\n      QFlags<Qt::ItemFlag> flgCheckbox=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable;\n      QFlags<Qt::ItemFlag> flgTristate=Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable | Qt::ItemIsTristate;    \n      \n      int nDisplayUnit = BitcoinUnits::BTC;\n      if (model && model->getOptionsModel())\n          nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n          \n      map<QString, vector<COutput> > mapCoins;\n      model->listCoins(mapCoins);\n  \n      BOOST_FOREACH(PAIRTYPE(QString, vector<COutput>) coins, mapCoins)\n      {\n          QTreeWidgetItem *itemWalletAddress = new QTreeWidgetItem();\n          QString sWalletAddress = coins.first;\n          QString sWalletLabel = \"\";\n          if (model->getAddressTableModel())\n              sWalletLabel = model->getAddressTableModel()->labelForAddress(sWalletAddress);\n          if (sWalletLabel.length() == 0)\n              sWalletLabel = tr(\"(no label)\");\n          \n          if (treeMode)\n          {\n              // wallet address\n              ui->treeWidget->addTopLevelItem(itemWalletAddress);\n  \n              itemWalletAddress->setFlags(flgTristate);\n              itemWalletAddress->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n              \n              for (int i = 0; i < ui->treeWidget->columnCount(); i++)\n                  itemWalletAddress->setBackground(i, QColor(248, 247, 246));\n              \n              // label\n              itemWalletAddress->setText(COLUMN_LABEL, sWalletLabel);\n  \n              // address\n              itemWalletAddress->setText(COLUMN_ADDRESS, sWalletAddress);\n          }\n  \n          int64_t nSum = 0;\n          double dPrioritySum = 0;\n          int nChildren = 0;\n          int nInputSum = 0;\n          BOOST_FOREACH(const COutput& out, coins.second)\n          {\n              int nInputSize = 148; // 180 if uncompressed public key\n              nSum += out.tx->vout[out.i].nValue;\n              nChildren++;\n              \n              QTreeWidgetItem *itemOutput;\n              if (treeMode)    itemOutput = new QTreeWidgetItem(itemWalletAddress);\n              else             itemOutput = new QTreeWidgetItem(ui->treeWidget);\n              itemOutput->setFlags(flgCheckbox);\n              itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Unchecked);\n                  \n              // address\n              CTxDestination outputAddress;\n              QString sAddress = \"\";\n              if(ExtractDestination(out.tx->vout[out.i].scriptPubKey, outputAddress))\n              {\n                  sAddress = CBitcoinAddress(outputAddress).ToString().c_str();\n                  \n                  // if listMode or change => show bitcoin address. In tree mode, address is not shown again for direct wallet address outputs\n                  if (!treeMode || (!(sAddress == sWalletAddress)))\n                      itemOutput->setText(COLUMN_ADDRESS, sAddress);\n                      \n                  CPubKey pubkey;\n                  CKeyID *keyid = boost::get< CKeyID >(&outputAddress);\n                  if (keyid && model->getPubKey(*keyid, pubkey) && !pubkey.IsCompressed())\n                      nInputSize = 180;\n              }\n  \n              // label\n              if (!(sAddress == sWalletAddress)) // change\n              {\n                  // tooltip from where the change comes from\n                  itemOutput->setToolTip(COLUMN_LABEL, tr(\"change from %1 (%2)\").arg(sWalletLabel).arg(sWalletAddress));\n                  itemOutput->setText(COLUMN_LABEL, tr(\"(change)\"));\n              }\n              else if (!treeMode)\n              {\n                  QString sLabel = \"\";\n                  if (model->getAddressTableModel())\n                      sLabel = model->getAddressTableModel()->labelForAddress(sAddress);\n                  if (sLabel.length() == 0)\n                      sLabel = tr(\"(no label)\");\n                  itemOutput->setText(COLUMN_LABEL, sLabel); \n              }\n  \n              // amount\n              itemOutput->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, out.tx->vout[out.i].nValue));\n              itemOutput->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(out.tx->vout[out.i].nValue), 15, \" \")); // padding so that sorting works correctly\n  \n              // date\n              itemOutput->setText(COLUMN_DATE, QDateTime::fromTime_t(out.tx->GetTxTime()).toUTC().toString(\"yy-MM-dd hh:mm\"));\n              \n              // immature PoS reward\n              if (out.tx->IsCoinStake() && out.tx->GetBlocksToMaturity() > 0 && out.tx->GetDepthInMainChain() > 0) {\n                itemOutput->setBackground(COLUMN_CONFIRMATIONS, Qt::red);\n                itemOutput->setDisabled(true);\n              }\n  \n              // confirmations\n              itemOutput->setText(COLUMN_CONFIRMATIONS, strPad(QString::number(out.nDepth), 8, \" \"));\n              \n              // priority\n              double dPriority = ((double)out.tx->vout[out.i].nValue  / (nInputSize + 78)) * (out.nDepth+1); // 78 = 2 * 34 + 10\n              itemOutput->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPriority));\n              itemOutput->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPriority), 20, \" \"));\n              dPrioritySum += (double)out.tx->vout[out.i].nValue  * (out.nDepth+1);\n              nInputSum    += nInputSize;\n              \n              // transaction hash\n              uint256 txhash = out.tx->GetHash();\n              itemOutput->setText(COLUMN_TXHASH, txhash.GetHex().c_str());\n      \n              // vout index\n              itemOutput->setText(COLUMN_VOUT_INDEX, QString::number(out.i));\n              \n              // disable locked coins     \n              /*if (model->isLockedCoin(txhash, out.i))\n              {\n                  COutPoint outpt(txhash, out.i);\n                  coinControl->UnSelect(outpt); // just to be sure\n                  itemOutput->setDisabled(true);\n                  itemOutput->setIcon(COLUMN_CHECKBOX, QIcon(\":/icons/lock_closed\"));\n              }*/\n                \n              // set checkbox\n              if (coinControl->IsSelected(txhash, out.i))\n                  itemOutput->setCheckState(COLUMN_CHECKBOX,Qt::Checked);\n          }\n  \n          // amount\n          if (treeMode)\n          {\n              dPrioritySum = dPrioritySum / (nInputSum + 78);\n              itemWalletAddress->setText(COLUMN_CHECKBOX, \"(\" + QString::number(nChildren) + \")\");\n              itemWalletAddress->setText(COLUMN_AMOUNT, BitcoinUnits::format(nDisplayUnit, nSum));\n              itemWalletAddress->setText(COLUMN_AMOUNT_INT64, strPad(QString::number(nSum), 15, \" \"));\n              itemWalletAddress->setText(COLUMN_PRIORITY, CoinControlDialog::getPriorityLabel(dPrioritySum));\n              itemWalletAddress->setText(COLUMN_PRIORITY_INT64, strPad(QString::number((int64_t)dPrioritySum), 20, \" \"));\n          }\n      }\n      \n      // expand all partially selected\n      if (treeMode)\n      {\n          for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n              if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) == Qt::PartiallyChecked)\n                  ui->treeWidget->topLevelItem(i)->setExpanded(true);\n      }\n      \n      // sort view\n      sortView(sortColumn, sortOrder);\n      ui->treeWidget->setEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getAddressTableModel",
          "args": [],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getOptionsModel",
          "args": [],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::setModel(WalletModel *model)\n  {\n      this->model = model;\n  \n      if(model && model->getOptionsModel() && model->getAddressTableModel())\n      {\n          updateView();\n          //updateLabelLocked();\n          CoinControlDialog::updateLabels(model, this);\n      }\n  }\n}"
  },
  {
    "function_name": "~CoinControlDialog",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "123-126",
    "snippet": "CoinControlDialog::~CoinControlDialog()\n{\n    delete ui;\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  CoinControlDialog::~CoinControlDialog()\n  {\n      delete ui;\n  }\n}"
  },
  {
    "function_name": "CoinControlDialog",
    "container": "CoinControlDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
    "lines": "28-121",
    "snippet": "CoinControlDialog::CoinControlDialog(QWidget *parent) :\n    QDialog(parent),\n    ui(new Ui::CoinControlDialog),\n    model(0)\n{\n    ui->setupUi(this);\n\n    // context menu actions\n    QAction *copyAddressAction = new QAction(tr(\"Copy address\"), this);\n    QAction *copyLabelAction = new QAction(tr(\"Copy label\"), this);\n    QAction *copyAmountAction = new QAction(tr(\"Copy amount\"), this);\n             copyTransactionHashAction = new QAction(tr(\"Copy transaction ID\"), this);  // we need to enable/disable this\n             //lockAction = new QAction(tr(\"Lock unspent\"), this);                        // we need to enable/disable this\n             //unlockAction = new QAction(tr(\"Unlock unspent\"), this);                    // we need to enable/disable this\n\n    // context menu\n    contextMenu = new QMenu();\n    contextMenu->addAction(copyAddressAction);\n    contextMenu->addAction(copyLabelAction);\n    contextMenu->addAction(copyAmountAction);\n    contextMenu->addAction(copyTransactionHashAction);\n    //contextMenu->addSeparator();\n    //contextMenu->addAction(lockAction);\n    //contextMenu->addAction(unlockAction);\n\n    // context menu signals\n    connect(ui->treeWidget, SIGNAL(customContextMenuRequested(QPoint)), this, SLOT(showMenu(QPoint)));\n    connect(copyAddressAction, SIGNAL(triggered()), this, SLOT(copyAddress()));\n    connect(copyLabelAction, SIGNAL(triggered()), this, SLOT(copyLabel()));\n    connect(copyAmountAction, SIGNAL(triggered()), this, SLOT(copyAmount()));\n    connect(copyTransactionHashAction, SIGNAL(triggered()), this, SLOT(copyTransactionHash()));\n    //connect(lockAction, SIGNAL(triggered()), this, SLOT(lockCoin()));\n    //connect(unlockAction, SIGNAL(triggered()), this, SLOT(unlockCoin()));\n\n    // clipboard actions\n    QAction *clipboardQuantityAction = new QAction(tr(\"Copy quantity\"), this);\n    QAction *clipboardAmountAction = new QAction(tr(\"Copy amount\"), this);\n    QAction *clipboardFeeAction = new QAction(tr(\"Copy fee\"), this);\n    QAction *clipboardAfterFeeAction = new QAction(tr(\"Copy after fee\"), this);\n    QAction *clipboardBytesAction = new QAction(tr(\"Copy bytes\"), this);\n    QAction *clipboardPriorityAction = new QAction(tr(\"Copy priority\"), this);\n    QAction *clipboardLowOutputAction = new QAction(tr(\"Copy low output\"), this);\n    QAction *clipboardChangeAction = new QAction(tr(\"Copy change\"), this);\n\n    connect(clipboardQuantityAction, SIGNAL(triggered()), this, SLOT(clipboardQuantity()));\n    connect(clipboardAmountAction, SIGNAL(triggered()), this, SLOT(clipboardAmount()));\n    connect(clipboardFeeAction, SIGNAL(triggered()), this, SLOT(clipboardFee()));\n    connect(clipboardAfterFeeAction, SIGNAL(triggered()), this, SLOT(clipboardAfterFee()));\n    connect(clipboardBytesAction, SIGNAL(triggered()), this, SLOT(clipboardBytes()));\n    connect(clipboardPriorityAction, SIGNAL(triggered()), this, SLOT(clipboardPriority()));\n    connect(clipboardLowOutputAction, SIGNAL(triggered()), this, SLOT(clipboardLowOutput()));\n    connect(clipboardChangeAction, SIGNAL(triggered()), this, SLOT(clipboardChange()));\n\n    ui->labelCoinControlQuantity->addAction(clipboardQuantityAction);\n    ui->labelCoinControlAmount->addAction(clipboardAmountAction);\n    ui->labelCoinControlFee->addAction(clipboardFeeAction);\n    ui->labelCoinControlAfterFee->addAction(clipboardAfterFeeAction);\n    ui->labelCoinControlBytes->addAction(clipboardBytesAction);\n    ui->labelCoinControlPriority->addAction(clipboardPriorityAction);\n    ui->labelCoinControlLowOutput->addAction(clipboardLowOutputAction);\n    ui->labelCoinControlChange->addAction(clipboardChangeAction);\n\n    // toggle tree/list mode\n    connect(ui->radioTreeMode, SIGNAL(toggled(bool)), this, SLOT(radioTreeMode(bool)));\n    connect(ui->radioListMode, SIGNAL(toggled(bool)), this, SLOT(radioListMode(bool)));\n\n    // click on checkbox\n    connect(ui->treeWidget, SIGNAL(itemChanged( QTreeWidgetItem*, int)), this, SLOT(viewItemChanged( QTreeWidgetItem*, int)));\n\n    // click on header\n    ui->treeWidget->header()->setClickable(true);\n    connect(ui->treeWidget->header(), SIGNAL(sectionClicked(int)), this, SLOT(headerSectionClicked(int)));\n\n    // ok button\n    connect(ui->buttonBox, SIGNAL(clicked( QAbstractButton*)), this, SLOT(buttonBoxClicked(QAbstractButton*)));\n\n    // (un)select all\n    connect(ui->pushButtonSelectAll, SIGNAL(clicked()), this, SLOT(buttonSelectAllClicked()));\n\n    ui->treeWidget->setColumnWidth(COLUMN_CHECKBOX, 84);\n    ui->treeWidget->setColumnWidth(COLUMN_AMOUNT, 100);\n    ui->treeWidget->setColumnWidth(COLUMN_LABEL, 170);\n    ui->treeWidget->setColumnWidth(COLUMN_ADDRESS, 290);\n    ui->treeWidget->setColumnWidth(COLUMN_DATE, 110);\n    ui->treeWidget->setColumnWidth(COLUMN_CONFIRMATIONS, 100);\n    ui->treeWidget->setColumnWidth(COLUMN_PRIORITY, 100);\n    ui->treeWidget->setColumnHidden(COLUMN_TXHASH, true);         // store transacton hash in this column, but dont show it\n    ui->treeWidget->setColumnHidden(COLUMN_VOUT_INDEX, true);     // store vout index in this column, but dont show it\n    ui->treeWidget->setColumnHidden(COLUMN_AMOUNT_INT64, true);   // store amount int64_t in this column, but dont show it\n    ui->treeWidget->setColumnHidden(COLUMN_PRIORITY_INT64, true); // store priority int64_t in this column, but dont show it\n\n    // default view is sorted by amount desc\n    sortView(COLUMN_AMOUNT_INT64, Qt::DescendingOrder);\n}",
    "includes": [
      "#include <QTreeWidgetItem>",
      "#include <QTreeWidget>",
      "#include <QString>",
      "#include <QIcon>",
      "#include <QFlags>",
      "#include <QDialogButtonBox>",
      "#include <QDateTime>",
      "#include <QCursor>",
      "#include <QColor>",
      "#include <QClipboard>",
      "#include <QCheckBox>",
      "#include <QApplication>",
      "#include \"coincontrol.h\"",
      "#include \"optionsmodel.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"walletmodel.h\"",
      "#include \"bitcoinunits.h\"",
      "#include \"init.h\"",
      "#include \"ui_coincontroldialog.h\"",
      "#include \"coincontroldialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sortView",
          "args": [
            "COLUMN_AMOUNT_INT64",
            "Qt::DescendingOrder"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "sortView",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "313-319",
          "snippet": "void CoinControlDialog::sortView(int column, Qt::SortOrder order)\n{\n    sortColumn = column;\n    sortOrder = order;\n    ui->treeWidget->sortItems(column, order);\n    ui->treeWidget->header()->setSortIndicator((sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn)), sortOrder);\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::sortView(int column, Qt::SortOrder order)\n  {\n      sortColumn = column;\n      sortOrder = order;\n      ui->treeWidget->sortItems(column, order);\n      ui->treeWidget->header()->setSortIndicator((sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn)), sortOrder);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setColumnHidden",
          "args": [
            "COLUMN_PRIORITY_INT64",
            "true"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setColumnHidden",
          "args": [
            "COLUMN_AMOUNT_INT64",
            "true"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setColumnHidden",
          "args": [
            "COLUMN_VOUT_INDEX",
            "true"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setColumnHidden",
          "args": [
            "COLUMN_TXHASH",
            "true"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setColumnWidth",
          "args": [
            "COLUMN_PRIORITY",
            "100"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setColumnWidth",
          "args": [
            "COLUMN_CONFIRMATIONS",
            "100"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setColumnWidth",
          "args": [
            "COLUMN_DATE",
            "110"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setColumnWidth",
          "args": [
            "COLUMN_ADDRESS",
            "290"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setColumnWidth",
          "args": [
            "COLUMN_LABEL",
            "170"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setColumnWidth",
          "args": [
            "COLUMN_AMOUNT",
            "100"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->setColumnWidth",
          "args": [
            "COLUMN_CHECKBOX",
            "84"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->pushButtonSelectAll",
            "SIGNAL(clicked())",
            "this",
            "SLOT(buttonSelectAllClicked())"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "buttonSelectAllClicked()"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buttonSelectAllClicked",
          "args": [],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "buttonSelectAllClicked",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "157-174",
          "snippet": "void CoinControlDialog::buttonSelectAllClicked()\n{\n    Qt::CheckState state = Qt::Checked;\n    for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n    {\n        if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) != Qt::Unchecked)\n        {\n            state = Qt::Unchecked;\n            break;\n        }\n    }\n    ui->treeWidget->setEnabled(false);\n    for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n            if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) != state)\n                ui->treeWidget->topLevelItem(i)->setCheckState(COLUMN_CHECKBOX, state);\n    ui->treeWidget->setEnabled(true);\n    CoinControlDialog::updateLabels(model, this);\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::buttonSelectAllClicked()\n  {\n      Qt::CheckState state = Qt::Checked;\n      for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n      {\n          if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) != Qt::Unchecked)\n          {\n              state = Qt::Unchecked;\n              break;\n          }\n      }\n      ui->treeWidget->setEnabled(false);\n      for (int i = 0; i < ui->treeWidget->topLevelItemCount(); i++)\n              if (ui->treeWidget->topLevelItem(i)->checkState(COLUMN_CHECKBOX) != state)\n                  ui->treeWidget->topLevelItem(i)->setCheckState(COLUMN_CHECKBOX, state);\n      ui->treeWidget->setEnabled(true);\n      CoinControlDialog::updateLabels(model, this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "clicked()"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clicked",
          "args": [],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "on_showQRCode_clicked",
          "container": "AddressBookPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addressbookpage.cpp",
          "lines": "336-353",
          "snippet": "void AddressBookPage::on_showQRCode_clicked()\n{\n#ifdef USE_QRCODE\n    QTableView *table = ui->tableView;\n    QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n\n    foreach (QModelIndex index, indexes)\n    {\n        QString address = index.data().toString(), label = index.sibling(index.row(), 0).data(Qt::EditRole).toString();\n\n        QRCodeDialog *dialog = new QRCodeDialog(address, label, tab == ReceivingTab, this);\n        if(optionsModel)\n            dialog->setModel(optionsModel);\n        dialog->setAttribute(Qt::WA_DeleteOnClose);\n        dialog->show();\n    }\n#endif\n}",
          "includes": [
            "#include \"qrcodedialog.h\"",
            "#include <QMenu>",
            "#include <QMessageBox>",
            "#include <QClipboard>",
            "#include <QSortFilterProxyModel>",
            "#include \"guiutil.h\"",
            "#include \"csvmodelwriter.h\"",
            "#include \"editaddressdialog.h\"",
            "#include \"bitcoingui.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_addressbookpage.h\"",
            "#include \"addressbookpage.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qrcodedialog.h\"\n#include <QMenu>\n#include <QMessageBox>\n#include <QClipboard>\n#include <QSortFilterProxyModel>\n#include \"guiutil.h\"\n#include \"csvmodelwriter.h\"\n#include \"editaddressdialog.h\"\n#include \"bitcoingui.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_addressbookpage.h\"\n#include \"addressbookpage.h\"\n\nAddressBookPage {\n  void AddressBookPage::on_showQRCode_clicked()\n  {\n  #ifdef USE_QRCODE\n      QTableView *table = ui->tableView;\n      QModelIndexList indexes = table->selectionModel()->selectedRows(AddressTableModel::Address);\n  \n      foreach (QModelIndex index, indexes)\n      {\n          QString address = index.data().toString(), label = index.sibling(index.row(), 0).data(Qt::EditRole).toString();\n  \n          QRCodeDialog *dialog = new QRCodeDialog(address, label, tab == ReceivingTab, this);\n          if(optionsModel)\n              dialog->setModel(optionsModel);\n          dialog->setAttribute(Qt::WA_DeleteOnClose);\n          dialog->show();\n      }\n  #endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->buttonBox",
            "SIGNAL(clicked( QAbstractButton*))",
            "this",
            "SLOT(buttonBoxClicked(QAbstractButton*))"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "buttonBoxClicked(QAbstractButton*)"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buttonBoxClicked",
          "args": [
            "QAbstractButton*"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "buttonBoxClicked",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "150-154",
          "snippet": "void CoinControlDialog::buttonBoxClicked(QAbstractButton* button)\n{\n    if (ui->buttonBox->buttonRole(button) == QDialogButtonBox::AcceptRole)\n        done(QDialog::Accepted); // closes the dialog\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::buttonBoxClicked(QAbstractButton* button)\n  {\n      if (ui->buttonBox->buttonRole(button) == QDialogButtonBox::AcceptRole)\n          done(QDialog::Accepted); // closes the dialog\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "clicked( QAbstractButton*)"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clicked",
          "args": [
            "QAbstractButton*"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->treeWidget->header()",
            "SIGNAL(sectionClicked(int))",
            "this",
            "SLOT(headerSectionClicked(int))"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "headerSectionClicked(int)"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "headerSectionClicked",
          "args": [
            "int"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "headerSectionClicked",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "322-346",
          "snippet": "void CoinControlDialog::headerSectionClicked(int logicalIndex)\n{\n    if (logicalIndex == COLUMN_CHECKBOX) // click on most left column -> do nothing\n    {\n        ui->treeWidget->header()->setSortIndicator((sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn)), sortOrder);\n    }\n    else\n    {\n        if (logicalIndex == COLUMN_AMOUNT) // sort by amount\n            logicalIndex = COLUMN_AMOUNT_INT64;\n\n        if (logicalIndex == COLUMN_PRIORITY) // sort by priority\n            logicalIndex = COLUMN_PRIORITY_INT64;\n\n        if (sortColumn == logicalIndex)\n            sortOrder = ((sortOrder == Qt::AscendingOrder) ? Qt::DescendingOrder : Qt::AscendingOrder);\n        else\n        {\n            sortColumn = logicalIndex;\n            sortOrder = ((sortColumn == COLUMN_AMOUNT_INT64 || sortColumn == COLUMN_PRIORITY_INT64 || sortColumn == COLUMN_DATE || sortColumn == COLUMN_CONFIRMATIONS) ? Qt::DescendingOrder : Qt::AscendingOrder); // if amount,date,conf,priority then default => desc, else default => asc\n        }\n\n        sortView(sortColumn, sortOrder);\n    }\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::headerSectionClicked(int logicalIndex)\n  {\n      if (logicalIndex == COLUMN_CHECKBOX) // click on most left column -> do nothing\n      {\n          ui->treeWidget->header()->setSortIndicator((sortColumn == COLUMN_AMOUNT_INT64 ? COLUMN_AMOUNT : (sortColumn == COLUMN_PRIORITY_INT64 ? COLUMN_PRIORITY : sortColumn)), sortOrder);\n      }\n      else\n      {\n          if (logicalIndex == COLUMN_AMOUNT) // sort by amount\n              logicalIndex = COLUMN_AMOUNT_INT64;\n  \n          if (logicalIndex == COLUMN_PRIORITY) // sort by priority\n              logicalIndex = COLUMN_PRIORITY_INT64;\n  \n          if (sortColumn == logicalIndex)\n              sortOrder = ((sortOrder == Qt::AscendingOrder) ? Qt::DescendingOrder : Qt::AscendingOrder);\n          else\n          {\n              sortColumn = logicalIndex;\n              sortOrder = ((sortColumn == COLUMN_AMOUNT_INT64 || sortColumn == COLUMN_PRIORITY_INT64 || sortColumn == COLUMN_DATE || sortColumn == COLUMN_CONFIRMATIONS) ? Qt::DescendingOrder : Qt::AscendingOrder); // if amount,date,conf,priority then default => desc, else default => asc\n          }\n  \n          sortView(sortColumn, sortOrder);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "sectionClicked(int)"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sectionClicked",
          "args": [
            "int"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->header",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->header",
          "args": [
            "true"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->treeWidget->header",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->treeWidget",
            "SIGNAL(itemChanged( QTreeWidgetItem*, int))",
            "this",
            "SLOT(viewItemChanged( QTreeWidgetItem*, int))"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "viewItemChanged( QTreeWidgetItem*, int)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewItemChanged",
          "args": [
            "QTreeWidgetItem*, int"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "itemChanged( QTreeWidgetItem*, int)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itemChanged",
          "args": [
            "QTreeWidgetItem*, int"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->radioListMode",
            "SIGNAL(toggled(bool))",
            "this",
            "SLOT(radioListMode(bool))"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "radioListMode(bool)"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "radioListMode",
          "args": [
            "bool"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "radioListMode",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "356-360",
          "snippet": "void CoinControlDialog::radioListMode(bool checked)\n{\n    if (checked && model)\n        updateView();\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::radioListMode(bool checked)\n  {\n      if (checked && model)\n          updateView();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "toggled(bool)"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toggled",
          "args": [
            "bool"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "on_chkReqPayment_toggled",
          "container": "QRCodeDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/qrcodedialog.cpp",
          "lines": "155-162",
          "snippet": "void QRCodeDialog::on_chkReqPayment_toggled(bool fChecked)\n{\n    if (!fChecked)\n        // if chkReqPayment is not active, don't display lnReqAmount as invalid\n        ui->lnReqAmount->setValid(true);\n\n    genCode();\n}",
          "includes": [
            "#include <qrencode.h>",
            "#include <QUrl>",
            "#include <QPixmap>",
            "#include \"optionsmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"ui_qrcodedialog.h\"",
            "#include \"qrcodedialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qrencode.h>\n#include <QUrl>\n#include <QPixmap>\n#include \"optionsmodel.h\"\n#include \"guiutil.h\"\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"ui_qrcodedialog.h\"\n#include \"qrcodedialog.h\"\n\nQRCodeDialog {\n  void QRCodeDialog::on_chkReqPayment_toggled(bool fChecked)\n  {\n      if (!fChecked)\n          // if chkReqPayment is not active, don't display lnReqAmount as invalid\n          ui->lnReqAmount->setValid(true);\n  \n      genCode();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->radioTreeMode",
            "SIGNAL(toggled(bool))",
            "this",
            "SLOT(radioTreeMode(bool))"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "radioTreeMode(bool)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "radioTreeMode",
          "args": [
            "bool"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "radioTreeMode",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "349-353",
          "snippet": "void CoinControlDialog::radioTreeMode(bool checked)\n{\n    if (checked && model)\n        updateView();\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::radioTreeMode(bool checked)\n  {\n      if (checked && model)\n          updateView();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "toggled(bool)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlChange->addAction",
          "args": [
            "clipboardChangeAction"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlLowOutput->addAction",
          "args": [
            "clipboardLowOutputAction"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlPriority->addAction",
          "args": [
            "clipboardPriorityAction"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlBytes->addAction",
          "args": [
            "clipboardBytesAction"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAfterFee->addAction",
          "args": [
            "clipboardAfterFeeAction"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlFee->addAction",
          "args": [
            "clipboardFeeAction"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlAmount->addAction",
          "args": [
            "clipboardAmountAction"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->labelCoinControlQuantity->addAction",
          "args": [
            "clipboardQuantityAction"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardChangeAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(clipboardChange())"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "clipboardChange()"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clipboardChange",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "clipboardChange",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "307-310",
          "snippet": "void CoinControlDialog::clipboardChange()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlChange->text().left(ui->labelCoinControlChange->text().indexOf(\" \")));\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardChange()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlChange->text().left(ui->labelCoinControlChange->text().indexOf(\" \")));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardLowOutputAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(clipboardLowOutput())"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "clipboardLowOutput()"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clipboardLowOutput",
          "args": [],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "clipboardLowOutput",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "301-304",
          "snippet": "void CoinControlDialog::clipboardLowOutput()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlLowOutput->text());\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardLowOutput()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlLowOutput->text());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardPriorityAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(clipboardPriority())"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "clipboardPriority()"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clipboardPriority",
          "args": [],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "clipboardPriority",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "295-298",
          "snippet": "void CoinControlDialog::clipboardPriority()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlPriority->text());\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardPriority()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlPriority->text());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardBytesAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(clipboardBytes())"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "clipboardBytes()"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clipboardBytes",
          "args": [],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "clipboardBytes",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "289-292",
          "snippet": "void CoinControlDialog::clipboardBytes()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlBytes->text());\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardBytes()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlBytes->text());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardAfterFeeAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(clipboardAfterFee())"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "clipboardAfterFee()"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clipboardAfterFee",
          "args": [],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "clipboardAfterFee",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "283-286",
          "snippet": "void CoinControlDialog::clipboardAfterFee()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlAfterFee->text().left(ui->labelCoinControlAfterFee->text().indexOf(\" \")));\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardAfterFee()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlAfterFee->text().left(ui->labelCoinControlAfterFee->text().indexOf(\" \")));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardFeeAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(clipboardFee())"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "clipboardFee()"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clipboardFee",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "clipboardFee",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "277-280",
          "snippet": "void CoinControlDialog::clipboardFee()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlFee->text().left(ui->labelCoinControlFee->text().indexOf(\" \")));\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardFee()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlFee->text().left(ui->labelCoinControlFee->text().indexOf(\" \")));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardAmountAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(clipboardAmount())"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "clipboardAmount()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clipboardAmount",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "clipboardAmount",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "271-274",
          "snippet": "void CoinControlDialog::clipboardAmount()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlAmount->text().left(ui->labelCoinControlAmount->text().indexOf(\" \")));\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardAmount()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlAmount->text().left(ui->labelCoinControlAmount->text().indexOf(\" \")));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "clipboardQuantityAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(clipboardQuantity())"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "clipboardQuantity()"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clipboardQuantity",
          "args": [],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "clipboardQuantity",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "265-268",
          "snippet": "void CoinControlDialog::clipboardQuantity()\n{\n    QApplication::clipboard()->setText(ui->labelCoinControlQuantity->text());\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::clipboardQuantity()\n  {\n      QApplication::clipboard()->setText(ui->labelCoinControlQuantity->text());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Copy change\""
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "getPriorityLabel",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "383-398",
          "snippet": "QString CoinControlDialog::getPriorityLabel(double dPriority)\n{\n    if (dPriority > 576000ULL) // at least medium, this number is from AllowFree(), the other thresholds are kinda random\n    {\n        if      (dPriority > 5760000000ULL)   return tr(\"highest\");\n        else if (dPriority > 576000000ULL)    return tr(\"high\");\n        else if (dPriority > 57600000ULL)     return tr(\"medium-high\");\n        else                                    return tr(\"medium\");\n    }\n    else\n    {\n        if      (dPriority > 5760ULL) return tr(\"low-medium\");\n        else if (dPriority > 58ULL)   return tr(\"low\");\n        else                            return tr(\"lowest\");\n    }\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  QString CoinControlDialog::getPriorityLabel(double dPriority)\n  {\n      if (dPriority > 576000ULL) // at least medium, this number is from AllowFree(), the other thresholds are kinda random\n      {\n          if      (dPriority > 5760000000ULL)   return tr(\"highest\");\n          else if (dPriority > 576000000ULL)    return tr(\"high\");\n          else if (dPriority > 57600000ULL)     return tr(\"medium-high\");\n          else                                    return tr(\"medium\");\n      }\n      else\n      {\n          if      (dPriority > 5760ULL) return tr(\"low-medium\");\n          else if (dPriority > 58ULL)   return tr(\"low\");\n          else                            return tr(\"lowest\");\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "copyTransactionHashAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(copyTransactionHash())"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "copyTransactionHash()"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copyTransactionHash",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "copyTransactionHash",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "236-239",
          "snippet": "void CoinControlDialog::copyTransactionHash()\n{\n    QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_TXHASH));\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::copyTransactionHash()\n  {\n      QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_TXHASH));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "copyAmountAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(copyAmount())"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "copyAmount()"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copyAmount",
          "args": [],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "copyAmount",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "212-215",
          "snippet": "void CoinControlDialog::copyAmount()\n{\n    QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_AMOUNT));\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::copyAmount()\n  {\n      QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_AMOUNT));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "copyLabelAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(copyLabel())"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "copyLabel()"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copyLabel",
          "args": [],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "copyLabel",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "218-224",
          "snippet": "void CoinControlDialog::copyLabel()\n{\n    if (ui->radioTreeMode->isChecked() && contextMenuItem->text(COLUMN_LABEL).length() == 0 && contextMenuItem->parent())\n        QApplication::clipboard()->setText(contextMenuItem->parent()->text(COLUMN_LABEL));\n    else\n        QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_LABEL));\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::copyLabel()\n  {\n      if (ui->radioTreeMode->isChecked() && contextMenuItem->text(COLUMN_LABEL).length() == 0 && contextMenuItem->parent())\n          QApplication::clipboard()->setText(contextMenuItem->parent()->text(COLUMN_LABEL));\n      else\n          QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_LABEL));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "copyAddressAction",
            "SIGNAL(triggered())",
            "this",
            "SLOT(copyAddress())"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "copyAddress()"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copyAddress",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "copyAddress",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "227-233",
          "snippet": "void CoinControlDialog::copyAddress()\n{\n    if (ui->radioTreeMode->isChecked() && contextMenuItem->text(COLUMN_ADDRESS).length() == 0 && contextMenuItem->parent())\n        QApplication::clipboard()->setText(contextMenuItem->parent()->text(COLUMN_ADDRESS));\n    else\n        QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_ADDRESS));\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::copyAddress()\n  {\n      if (ui->radioTreeMode->isChecked() && contextMenuItem->text(COLUMN_ADDRESS).length() == 0 && contextMenuItem->parent())\n          QApplication::clipboard()->setText(contextMenuItem->parent()->text(COLUMN_ADDRESS));\n      else\n          QApplication::clipboard()->setText(contextMenuItem->text(COLUMN_ADDRESS));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "triggered()"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "triggered",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->treeWidget",
            "SIGNAL(customContextMenuRequested(QPoint))",
            "this",
            "SLOT(showMenu(QPoint))"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "showMenu(QPoint)"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "showMenu",
          "args": [
            "QPoint"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "showMenu",
          "container": "CoinControlDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/coincontroldialog.cpp",
          "lines": "177-209",
          "snippet": "void CoinControlDialog::showMenu(const QPoint &point)\n{\n    QTreeWidgetItem *item = ui->treeWidget->itemAt(point);\n    if(item)\n    {\n        contextMenuItem = item;\n\n        // disable some items (like Copy Transaction ID, lock, unlock) for tree roots in context menu\n        if (item->text(COLUMN_TXHASH).length() == 64) // transaction hash is 64 characters (this means its a child node, so its not a parent node in tree mode)\n        {\n            copyTransactionHashAction->setEnabled(true);\n            //if (model->isLockedCoin(uint256(item->text(COLUMN_TXHASH).toStdString()), item->text(COLUMN_VOUT_INDEX).toUInt()))\n            //{\n            //    lockAction->setEnabled(false);\n            //    unlockAction->setEnabled(true);\n            //}\n            //else\n            //{\n            //    lockAction->setEnabled(true);\n            //    unlockAction->setEnabled(false);\n            //}\n        }\n        else // this means click on parent node in tree mode -> disable all\n        {\n            copyTransactionHashAction->setEnabled(false);\n            //lockAction->setEnabled(false);\n            //unlockAction->setEnabled(false);\n        }\n\n        // show context menu\n        contextMenu->exec(QCursor::pos());\n    }\n}",
          "includes": [
            "#include <QTreeWidgetItem>",
            "#include <QTreeWidget>",
            "#include <QString>",
            "#include <QIcon>",
            "#include <QFlags>",
            "#include <QDialogButtonBox>",
            "#include <QDateTime>",
            "#include <QCursor>",
            "#include <QColor>",
            "#include <QClipboard>",
            "#include <QCheckBox>",
            "#include <QApplication>",
            "#include \"coincontrol.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"init.h\"",
            "#include \"ui_coincontroldialog.h\"",
            "#include \"coincontroldialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  void CoinControlDialog::showMenu(const QPoint &point)\n  {\n      QTreeWidgetItem *item = ui->treeWidget->itemAt(point);\n      if(item)\n      {\n          contextMenuItem = item;\n  \n          // disable some items (like Copy Transaction ID, lock, unlock) for tree roots in context menu\n          if (item->text(COLUMN_TXHASH).length() == 64) // transaction hash is 64 characters (this means its a child node, so its not a parent node in tree mode)\n          {\n              copyTransactionHashAction->setEnabled(true);\n              //if (model->isLockedCoin(uint256(item->text(COLUMN_TXHASH).toStdString()), item->text(COLUMN_VOUT_INDEX).toUInt()))\n              //{\n              //    lockAction->setEnabled(false);\n              //    unlockAction->setEnabled(true);\n              //}\n              //else\n              //{\n              //    lockAction->setEnabled(true);\n              //    unlockAction->setEnabled(false);\n              //}\n          }\n          else // this means click on parent node in tree mode -> disable all\n          {\n              copyTransactionHashAction->setEnabled(false);\n              //lockAction->setEnabled(false);\n              //unlockAction->setEnabled(false);\n          }\n  \n          // show context menu\n          contextMenu->exec(QCursor::pos());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "customContextMenuRequested(QPoint)"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "customContextMenuRequested",
          "args": [
            "QPoint"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "copyTransactionHashAction"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "copyAmountAction"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "copyLabelAction"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contextMenu->addAction",
          "args": [
            "copyAddressAction"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->setupUi",
          "args": [
            "this"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QTreeWidgetItem>\n#include <QTreeWidget>\n#include <QString>\n#include <QIcon>\n#include <QFlags>\n#include <QDialogButtonBox>\n#include <QDateTime>\n#include <QCursor>\n#include <QColor>\n#include <QClipboard>\n#include <QCheckBox>\n#include <QApplication>\n#include \"coincontrol.h\"\n#include \"optionsmodel.h\"\n#include \"addresstablemodel.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinunits.h\"\n#include \"init.h\"\n#include \"ui_coincontroldialog.h\"\n#include \"coincontroldialog.h\"\n\nCoinControlDialog {\n  CoinControlDialog::CoinControlDialog(QWidget *parent) :\n      QDialog(parent),\n      ui(new Ui::CoinControlDialog),\n      model(0)\n  {\n      ui->setupUi(this);\n  \n      // context menu actions\n      QAction *copyAddressAction = new QAction(tr(\"Copy address\"), this);\n      QAction *copyLabelAction = new QAction(tr(\"Copy label\"), this);\n      QAction *copyAmountAction = new QAction(tr(\"Copy amount\"), this);\n               copyTransactionHashAction = new QAction(tr(\"Copy transaction ID\"), this);  // we need to enable/disable this\n               //lockAction = new QAction(tr(\"Lock unspent\"), this);                        // we need to enable/disable this\n               //unlockAction = new QAction(tr(\"Unlock unspent\"), this);                    // we need to enable/disable this\n  \n      // context menu\n      contextMenu = new QMenu();\n      contextMenu->addAction(copyAddressAction);\n      contextMenu->addAction(copyLabelAction);\n      contextMenu->addAction(copyAmountAction);\n      contextMenu->addAction(copyTransactionHashAction);\n      //contextMenu->addSeparator();\n      //contextMenu->addAction(lockAction);\n      //contextMenu->addAction(unlockAction);\n  \n      // context menu signals\n      connect(ui->treeWidget, SIGNAL(customContextMenuRequested(QPoint)), this, SLOT(showMenu(QPoint)));\n      connect(copyAddressAction, SIGNAL(triggered()), this, SLOT(copyAddress()));\n      connect(copyLabelAction, SIGNAL(triggered()), this, SLOT(copyLabel()));\n      connect(copyAmountAction, SIGNAL(triggered()), this, SLOT(copyAmount()));\n      connect(copyTransactionHashAction, SIGNAL(triggered()), this, SLOT(copyTransactionHash()));\n      //connect(lockAction, SIGNAL(triggered()), this, SLOT(lockCoin()));\n      //connect(unlockAction, SIGNAL(triggered()), this, SLOT(unlockCoin()));\n  \n      // clipboard actions\n      QAction *clipboardQuantityAction = new QAction(tr(\"Copy quantity\"), this);\n      QAction *clipboardAmountAction = new QAction(tr(\"Copy amount\"), this);\n      QAction *clipboardFeeAction = new QAction(tr(\"Copy fee\"), this);\n      QAction *clipboardAfterFeeAction = new QAction(tr(\"Copy after fee\"), this);\n      QAction *clipboardBytesAction = new QAction(tr(\"Copy bytes\"), this);\n      QAction *clipboardPriorityAction = new QAction(tr(\"Copy priority\"), this);\n      QAction *clipboardLowOutputAction = new QAction(tr(\"Copy low output\"), this);\n      QAction *clipboardChangeAction = new QAction(tr(\"Copy change\"), this);\n  \n      connect(clipboardQuantityAction, SIGNAL(triggered()), this, SLOT(clipboardQuantity()));\n      connect(clipboardAmountAction, SIGNAL(triggered()), this, SLOT(clipboardAmount()));\n      connect(clipboardFeeAction, SIGNAL(triggered()), this, SLOT(clipboardFee()));\n      connect(clipboardAfterFeeAction, SIGNAL(triggered()), this, SLOT(clipboardAfterFee()));\n      connect(clipboardBytesAction, SIGNAL(triggered()), this, SLOT(clipboardBytes()));\n      connect(clipboardPriorityAction, SIGNAL(triggered()), this, SLOT(clipboardPriority()));\n      connect(clipboardLowOutputAction, SIGNAL(triggered()), this, SLOT(clipboardLowOutput()));\n      connect(clipboardChangeAction, SIGNAL(triggered()), this, SLOT(clipboardChange()));\n  \n      ui->labelCoinControlQuantity->addAction(clipboardQuantityAction);\n      ui->labelCoinControlAmount->addAction(clipboardAmountAction);\n      ui->labelCoinControlFee->addAction(clipboardFeeAction);\n      ui->labelCoinControlAfterFee->addAction(clipboardAfterFeeAction);\n      ui->labelCoinControlBytes->addAction(clipboardBytesAction);\n      ui->labelCoinControlPriority->addAction(clipboardPriorityAction);\n      ui->labelCoinControlLowOutput->addAction(clipboardLowOutputAction);\n      ui->labelCoinControlChange->addAction(clipboardChangeAction);\n  \n      // toggle tree/list mode\n      connect(ui->radioTreeMode, SIGNAL(toggled(bool)), this, SLOT(radioTreeMode(bool)));\n      connect(ui->radioListMode, SIGNAL(toggled(bool)), this, SLOT(radioListMode(bool)));\n  \n      // click on checkbox\n      connect(ui->treeWidget, SIGNAL(itemChanged( QTreeWidgetItem*, int)), this, SLOT(viewItemChanged( QTreeWidgetItem*, int)));\n  \n      // click on header\n      ui->treeWidget->header()->setClickable(true);\n      connect(ui->treeWidget->header(), SIGNAL(sectionClicked(int)), this, SLOT(headerSectionClicked(int)));\n  \n      // ok button\n      connect(ui->buttonBox, SIGNAL(clicked( QAbstractButton*)), this, SLOT(buttonBoxClicked(QAbstractButton*)));\n  \n      // (un)select all\n      connect(ui->pushButtonSelectAll, SIGNAL(clicked()), this, SLOT(buttonSelectAllClicked()));\n  \n      ui->treeWidget->setColumnWidth(COLUMN_CHECKBOX, 84);\n      ui->treeWidget->setColumnWidth(COLUMN_AMOUNT, 100);\n      ui->treeWidget->setColumnWidth(COLUMN_LABEL, 170);\n      ui->treeWidget->setColumnWidth(COLUMN_ADDRESS, 290);\n      ui->treeWidget->setColumnWidth(COLUMN_DATE, 110);\n      ui->treeWidget->setColumnWidth(COLUMN_CONFIRMATIONS, 100);\n      ui->treeWidget->setColumnWidth(COLUMN_PRIORITY, 100);\n      ui->treeWidget->setColumnHidden(COLUMN_TXHASH, true);         // store transacton hash in this column, but dont show it\n      ui->treeWidget->setColumnHidden(COLUMN_VOUT_INDEX, true);     // store vout index in this column, but dont show it\n      ui->treeWidget->setColumnHidden(COLUMN_AMOUNT_INT64, true);   // store amount int64_t in this column, but dont show it\n      ui->treeWidget->setColumnHidden(COLUMN_PRIORITY_INT64, true); // store priority int64_t in this column, but dont show it\n  \n      // default view is sorted by amount desc\n      sortView(COLUMN_AMOUNT_INT64, Qt::DescendingOrder);\n  }\n}"
  }
]