[
  {
    "function_name": "ConsumeDecimalNumber",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
    "lines": "57-79",
    "snippet": "bool ConsumeDecimalNumber(Slice* in, uint64_t* val) {\n  uint64_t v = 0;\n  int digits = 0;\n  while (!in->empty()) {\n    char c = (*in)[0];\n    if (c >= '0' && c <= '9') {\n      ++digits;\n      const int delta = (c - '0');\n      static const uint64_t kMaxUint64 = ~static_cast<uint64_t>(0);\n      if (v > kMaxUint64/10 ||\n          (v == kMaxUint64/10 && delta > kMaxUint64%10)) {\n        // Overflow\n        return false;\n      }\n      v = (v * 10) + delta;\n      in->remove_prefix(1);\n    } else {\n      break;\n    }\n  }\n  *val = v;\n  return (digits > 0);\n}",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"util/logging.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in->remove_prefix",
          "args": [
            "1"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "remove_prefix",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "59-63",
          "snippet": "void remove_prefix(size_t n) {\n    assert(n <= size());\n    data_ += n;\n    size_ -= n;\n  }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  void remove_prefix(size_t n) {\n      assert(n <= size());\n      data_ += n;\n      size_ -= n;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<uint64_t>",
          "args": [
            "0"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in->empty",
          "args": [],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nbool ConsumeDecimalNumber(Slice* in, uint64_t* val) {\n  uint64_t v = 0;\n  int digits = 0;\n  while (!in->empty()) {\n    char c = (*in)[0];\n    if (c >= '0' && c <= '9') {\n      ++digits;\n      const int delta = (c - '0');\n      static const uint64_t kMaxUint64 = ~static_cast<uint64_t>(0);\n      if (v > kMaxUint64/10 ||\n          (v == kMaxUint64/10 && delta > kMaxUint64%10)) {\n        // Overflow\n        return false;\n      }\n      v = (v * 10) + delta;\n      in->remove_prefix(1);\n    } else {\n      break;\n    }\n  }\n  *val = v;\n  return (digits > 0);\n}"
  },
  {
    "function_name": "ConsumeChar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
    "lines": "48-55",
    "snippet": "bool ConsumeChar(Slice* in, char c) {\n  if (!in->empty() && (*in)[0] == c) {\n    in->remove_prefix(1);\n    return true;\n  } else {\n    return false;\n  }\n}",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"util/logging.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in->remove_prefix",
          "args": [
            "1"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "remove_prefix",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "59-63",
          "snippet": "void remove_prefix(size_t n) {\n    assert(n <= size());\n    data_ += n;\n    size_ -= n;\n  }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  void remove_prefix(size_t n) {\n      assert(n <= size());\n      data_ += n;\n      size_ -= n;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "in->empty",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nbool ConsumeChar(Slice* in, char c) {\n  if (!in->empty() && (*in)[0] == c) {\n    in->remove_prefix(1);\n    return true;\n  } else {\n    return false;\n  }\n}"
  },
  {
    "function_name": "EscapeString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
    "lines": "42-46",
    "snippet": "std::string EscapeString(const Slice& value) {\n  std::string r;\n  AppendEscapedStringTo(&r, value);\n  return r;\n}",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"util/logging.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AppendEscapedStringTo",
          "args": [
            "&r",
            "value"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "AppendEscapedStringTo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
          "lines": "22-34",
          "snippet": "void AppendEscapedStringTo(std::string* str, const Slice& value) {\n  for (size_t i = 0; i < value.size(); i++) {\n    char c = value[i];\n    if (c >= ' ' && c <= '~') {\n      str->push_back(c);\n    } else {\n      char buf[10];\n      snprintf(buf, sizeof(buf), \"\\\\x%02x\",\n               static_cast<unsigned int>(c) & 0xff);\n      str->append(buf);\n    }\n  }\n}",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"util/logging.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nvoid AppendEscapedStringTo(std::string* str, const Slice& value) {\n  for (size_t i = 0; i < value.size(); i++) {\n    char c = value[i];\n    if (c >= ' ' && c <= '~') {\n      str->push_back(c);\n    } else {\n      char buf[10];\n      snprintf(buf, sizeof(buf), \"\\\\x%02x\",\n               static_cast<unsigned int>(c) & 0xff);\n      str->append(buf);\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nstd::string EscapeString(const Slice& value) {\n  std::string r;\n  AppendEscapedStringTo(&r, value);\n  return r;\n}"
  },
  {
    "function_name": "NumberToString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
    "lines": "36-40",
    "snippet": "std::string NumberToString(uint64_t num) {\n  std::string r;\n  AppendNumberTo(&r, num);\n  return r;\n}",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"util/logging.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AppendNumberTo",
          "args": [
            "&r",
            "num"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "AppendNumberTo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
          "lines": "16-20",
          "snippet": "void AppendNumberTo(std::string* str, uint64_t num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%llu\", (unsigned long long) num);\n  str->append(buf);\n}",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"util/logging.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nvoid AppendNumberTo(std::string* str, uint64_t num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%llu\", (unsigned long long) num);\n  str->append(buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nstd::string NumberToString(uint64_t num) {\n  std::string r;\n  AppendNumberTo(&r, num);\n  return r;\n}"
  },
  {
    "function_name": "AppendEscapedStringTo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
    "lines": "22-34",
    "snippet": "void AppendEscapedStringTo(std::string* str, const Slice& value) {\n  for (size_t i = 0; i < value.size(); i++) {\n    char c = value[i];\n    if (c >= ' ' && c <= '~') {\n      str->push_back(c);\n    } else {\n      char buf[10];\n      snprintf(buf, sizeof(buf), \"\\\\x%02x\",\n               static_cast<unsigned int>(c) & 0xff);\n      str->append(buf);\n    }\n  }\n}",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"util/logging.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "str->append",
          "args": [
            "buf"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"\\\\x%02x\"",
            "static_cast<unsigned int>(c) & 0xff"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<unsigned int>",
          "args": [
            "c"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str->push_back",
          "args": [
            "c"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.size",
          "args": [],
          "line": 23
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nvoid AppendEscapedStringTo(std::string* str, const Slice& value) {\n  for (size_t i = 0; i < value.size(); i++) {\n    char c = value[i];\n    if (c >= ' ' && c <= '~') {\n      str->push_back(c);\n    } else {\n      char buf[10];\n      snprintf(buf, sizeof(buf), \"\\\\x%02x\",\n               static_cast<unsigned int>(c) & 0xff);\n      str->append(buf);\n    }\n  }\n}"
  },
  {
    "function_name": "AppendNumberTo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
    "lines": "16-20",
    "snippet": "void AppendNumberTo(std::string* str, uint64_t num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%llu\", (unsigned long long) num);\n  str->append(buf);\n}",
    "includes": [
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"util/logging.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "str->append",
          "args": [
            "buf"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%llu\"",
            "(unsigned long long) num"
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nvoid AppendNumberTo(std::string* str, uint64_t num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%llu\", (unsigned long long) num);\n  str->append(buf);\n}"
  }
]