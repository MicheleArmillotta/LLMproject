[
  {
    "function_name": "DeleteFile",
    "container": "VersionEdit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
    "lines": "75-77",
    "snippet": "void DeleteFile(int level, uint64_t file) {\n    deleted_files_.insert(std::make_pair(level, file));\n  }",
    "includes": [
      "#include \"db/dbformat.h\"",
      "#include <vector>",
      "#include <utility>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "deleted_files_.insert",
          "args": [
            "std::make_pair(level, file)"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "61-65",
          "snippet": "void CBloomFilter::insert(const uint256& hash)\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    insert(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  void CBloomFilter::insert(const uint256& hash)\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      insert(data);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "level",
            "file"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void DeleteFile(int level, uint64_t file) {\n      deleted_files_.insert(std::make_pair(level, file));\n    }\n}"
  },
  {
    "function_name": "AddFile",
    "container": "VersionEdit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
    "lines": "62-72",
    "snippet": "void AddFile(int level, uint64_t file,\n               uint64_t file_size,\n               const InternalKey& smallest,\n               const InternalKey& largest) {\n    FileMetaData f;\n    f.number = file;\n    f.file_size = file_size;\n    f.smallest = smallest;\n    f.largest = largest;\n    new_files_.push_back(std::make_pair(level, f));\n  }",
    "includes": [
      "#include \"db/dbformat.h\"",
      "#include <vector>",
      "#include <utility>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "new_files_.push_back",
          "args": [
            "std::make_pair(level, f)"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "level",
            "f"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void AddFile(int level, uint64_t file,\n                 uint64_t file_size,\n                 const InternalKey& smallest,\n                 const InternalKey& largest) {\n      FileMetaData f;\n      f.number = file;\n      f.file_size = file_size;\n      f.smallest = smallest;\n      f.largest = largest;\n      new_files_.push_back(std::make_pair(level, f));\n    }\n}"
  },
  {
    "function_name": "SetCompactPointer",
    "container": "VersionEdit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
    "lines": "55-57",
    "snippet": "void SetCompactPointer(int level, const InternalKey& key) {\n    compact_pointers_.push_back(std::make_pair(level, key));\n  }",
    "includes": [
      "#include \"db/dbformat.h\"",
      "#include <vector>",
      "#include <utility>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "compact_pointers_.push_back",
          "args": [
            "std::make_pair(level, key)"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "level",
            "key"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void SetCompactPointer(int level, const InternalKey& key) {\n      compact_pointers_.push_back(std::make_pair(level, key));\n    }\n}"
  },
  {
    "function_name": "SetLastSequence",
    "container": "VersionEdit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
    "lines": "51-54",
    "snippet": "void SetLastSequence(SequenceNumber seq) {\n    has_last_sequence_ = true;\n    last_sequence_ = seq;\n  }",
    "includes": [
      "#include \"db/dbformat.h\"",
      "#include <vector>",
      "#include <utility>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void SetLastSequence(SequenceNumber seq) {\n      has_last_sequence_ = true;\n      last_sequence_ = seq;\n    }\n}"
  },
  {
    "function_name": "SetNextFile",
    "container": "VersionEdit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
    "lines": "47-50",
    "snippet": "void SetNextFile(uint64_t num) {\n    has_next_file_number_ = true;\n    next_file_number_ = num;\n  }",
    "includes": [
      "#include \"db/dbformat.h\"",
      "#include <vector>",
      "#include <utility>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void SetNextFile(uint64_t num) {\n      has_next_file_number_ = true;\n      next_file_number_ = num;\n    }\n}"
  },
  {
    "function_name": "SetPrevLogNumber",
    "container": "VersionEdit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
    "lines": "43-46",
    "snippet": "void SetPrevLogNumber(uint64_t num) {\n    has_prev_log_number_ = true;\n    prev_log_number_ = num;\n  }",
    "includes": [
      "#include \"db/dbformat.h\"",
      "#include <vector>",
      "#include <utility>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void SetPrevLogNumber(uint64_t num) {\n      has_prev_log_number_ = true;\n      prev_log_number_ = num;\n    }\n}"
  },
  {
    "function_name": "SetLogNumber",
    "container": "VersionEdit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
    "lines": "39-42",
    "snippet": "void SetLogNumber(uint64_t num) {\n    has_log_number_ = true;\n    log_number_ = num;\n  }",
    "includes": [
      "#include \"db/dbformat.h\"",
      "#include <vector>",
      "#include <utility>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void SetLogNumber(uint64_t num) {\n      has_log_number_ = true;\n      log_number_ = num;\n    }\n}"
  },
  {
    "function_name": "SetComparatorName",
    "container": "VersionEdit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
    "lines": "35-38",
    "snippet": "void SetComparatorName(const Slice& name) {\n    has_comparator_ = true;\n    comparator_ = name.ToString();\n  }",
    "includes": [
      "#include \"db/dbformat.h\"",
      "#include <vector>",
      "#include <utility>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "name.ToString",
          "args": [],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void SetComparatorName(const Slice& name) {\n      has_comparator_ = true;\n      comparator_ = name.ToString();\n    }\n}"
  },
  {
    "function_name": "VersionEdit",
    "container": "VersionEdit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
    "lines": "30-30",
    "snippet": "VersionEdit() { Clear(); }",
    "includes": [
      "#include \"db/dbformat.h\"",
      "#include <vector>",
      "#include <utility>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Clear",
          "args": [],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "Clear",
          "container": "VersionEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.cc",
          "lines": "26-39",
          "snippet": "void VersionEdit::Clear() {\n  comparator_.clear();\n  log_number_ = 0;\n  prev_log_number_ = 0;\n  last_sequence_ = 0;\n  next_file_number_ = 0;\n  has_comparator_ = false;\n  has_log_number_ = false;\n  has_prev_log_number_ = false;\n  has_next_file_number_ = false;\n  has_last_sequence_ = false;\n  deleted_files_.clear();\n  new_files_.clear();\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/version_edit.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/version_set.h\"\n#include \"db/version_edit.h\"\n\nVersionEdit {\n  void VersionEdit::Clear() {\n    comparator_.clear();\n    log_number_ = 0;\n    prev_log_number_ = 0;\n    last_sequence_ = 0;\n    next_file_number_ = 0;\n    has_comparator_ = false;\n    has_log_number_ = false;\n    has_prev_log_number_ = false;\n    has_next_file_number_ = false;\n    has_last_sequence_ = false;\n    deleted_files_.clear();\n    new_files_.clear();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  VersionEdit() { Clear(); }\n}"
  },
  {
    "function_name": "FileMetaData",
    "container": "FileMetaData",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
    "lines": "25-25",
    "snippet": "FileMetaData() : refs(0), allowed_seeks(1 << 30), file_size(0) { }",
    "includes": [
      "#include \"db/dbformat.h\"",
      "#include <vector>",
      "#include <utility>",
      "#include <set>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nFileMetaData {\n  FileMetaData() : refs(0), allowed_seeks(1 << 30), file_size(0) { }\n}"
  }
]