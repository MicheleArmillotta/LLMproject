[
  {
    "function_name": "GetHeapProfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.h",
    "lines": "167-169",
    "snippet": "inline bool GetHeapProfile(void (*func)(void*, const char*, int), void* arg) {\n  return false;\n}",
    "includes": [
      "#include <snappy.h>",
      "#include <stdint.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <snappy.h>\n#include <stdint.h>\n#include <string>\n\ninline bool GetHeapProfile(void (*func)(void*, const char*, int), void* arg) {\n  return false;\n}"
  },
  {
    "function_name": "Snappy_Uncompress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.h",
    "lines": "158-165",
    "snippet": "inline bool Snappy_Uncompress(const char* input, size_t length,\n                              char* output) {\n#ifdef SNAPPY\n  return snappy::RawUncompress(input, length, output);\n#else\n  return false;\n#endif\n}",
    "includes": [
      "#include <snappy.h>",
      "#include <stdint.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snappy::RawUncompress",
          "args": [
            "input",
            "length",
            "output"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <snappy.h>\n#include <stdint.h>\n#include <string>\n\ninline bool Snappy_Uncompress(const char* input, size_t length,\n                              char* output) {\n#ifdef SNAPPY\n  return snappy::RawUncompress(input, length, output);\n#else\n  return false;\n#endif\n}"
  },
  {
    "function_name": "Snappy_GetUncompressedLength",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.h",
    "lines": "149-156",
    "snippet": "inline bool Snappy_GetUncompressedLength(const char* input, size_t length,\n                                         size_t* result) {\n#ifdef SNAPPY\n  return snappy::GetUncompressedLength(input, length, result);\n#else\n  return false;\n#endif\n}",
    "includes": [
      "#include <snappy.h>",
      "#include <stdint.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snappy::GetUncompressedLength",
          "args": [
            "input",
            "length",
            "result"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <snappy.h>\n#include <stdint.h>\n#include <string>\n\ninline bool Snappy_GetUncompressedLength(const char* input, size_t length,\n                                         size_t* result) {\n#ifdef SNAPPY\n  return snappy::GetUncompressedLength(input, length, result);\n#else\n  return false;\n#endif\n}"
  },
  {
    "function_name": "Snappy_Compress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.h",
    "lines": "136-147",
    "snippet": "inline bool Snappy_Compress(const char* input, size_t length,\n                            ::std::string* output) {\n#ifdef SNAPPY\n  output->resize(snappy::MaxCompressedLength(length));\n  size_t outlen;\n  snappy::RawCompress(input, length, &(*output)[0], &outlen);\n  output->resize(outlen);\n  return true;\n#endif\n\n  return false;\n}",
    "includes": [
      "#include <snappy.h>",
      "#include <stdint.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "output->resize",
          "args": [
            "outlen"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "snappy::RawCompress",
          "args": [
            "input",
            "length",
            "&(*output)[0]",
            "&outlen"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snappy::MaxCompressedLength",
          "args": [
            "length"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <snappy.h>\n#include <stdint.h>\n#include <string>\n\ninline bool Snappy_Compress(const char* input, size_t length,\n                            ::std::string* output) {\n#ifdef SNAPPY\n  output->resize(snappy::MaxCompressedLength(length));\n  size_t outlen;\n  snappy::RawCompress(input, length, &(*output)[0], &outlen);\n  output->resize(outlen);\n  return true;\n#endif\n\n  return false;\n}"
  },
  {
    "function_name": "AtomicPointer",
    "container": "AtomicPointer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.h",
    "lines": "125-125",
    "snippet": "AtomicPointer() : rep_(NULL) { }",
    "includes": [
      "#include <snappy.h>",
      "#include <stdint.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <snappy.h>\n#include <stdint.h>\n#include <string>\n\nAtomicPointer {\n  AtomicPointer() : rep_(NULL) { }\n}"
  },
  {
    "function_name": "InitOnce",
    "container": "OnceType",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.h",
    "lines": "103-110",
    "snippet": "void InitOnce(void (*initializer)()) {\n        mutex_.Lock();\n        if (!init_) {\n            init_ = true;\n            initializer();\n        }\n        mutex_.Unlock();\n    }",
    "includes": [
      "#include <snappy.h>",
      "#include <stdint.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_.Unlock",
          "args": [],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "Unlock",
          "container": "Mutex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "60-63",
          "snippet": "void Mutex::Unlock() {\n  assert(cs_);\n  ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Unlock() {\n    assert(cs_);\n    ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initializer",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_.Lock",
          "args": [],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "Lock",
          "container": "Mutex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "55-58",
          "snippet": "void Mutex::Lock() {\n  assert(cs_);\n  ::EnterCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Lock() {\n    assert(cs_);\n    ::EnterCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <snappy.h>\n#include <stdint.h>\n#include <string>\n\nOnceType {\n  void InitOnce(void (*initializer)()) {\n          mutex_.Lock();\n          if (!init_) {\n              init_ = true;\n              initializer();\n          }\n          mutex_.Unlock();\n      }\n}"
  },
  {
    "function_name": "OnceType",
    "container": "OnceType",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.h",
    "lines": "102-102",
    "snippet": "OnceType(bool f) : init_(f) {}",
    "includes": [
      "#include <snappy.h>",
      "#include <stdint.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <snappy.h>\n#include <stdint.h>\n#include <string>\n\nOnceType {\n  OnceType(bool f) : init_(f) {}\n}"
  },
  {
    "function_name": "OnceType",
    "container": "OnceType",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.h",
    "lines": "101-101",
    "snippet": "OnceType(const OnceType &once) : init_(once.init_) {}",
    "includes": [
      "#include <snappy.h>",
      "#include <stdint.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <snappy.h>\n#include <stdint.h>\n#include <string>\n\nOnceType {\n  OnceType(const OnceType &once) : init_(once.init_) {}\n}"
  }
]