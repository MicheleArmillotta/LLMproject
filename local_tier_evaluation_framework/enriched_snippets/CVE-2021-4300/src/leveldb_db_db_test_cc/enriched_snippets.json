[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "2118-2128",
    "snippet": "int main(int argc, char** argv) {\n  if (argc > 1 && std::string(argv[1]) == \"--benchmark\") {\n    leveldb::BM_LogAndApply(1000, 1);\n    leveldb::BM_LogAndApply(1000, 100);\n    leveldb::BM_LogAndApply(1000, 10000);\n    leveldb::BM_LogAndApply(100, 100000);\n    return 0;\n  }\n\n  return leveldb::test::RunAllTests();\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "leveldb::test::RunAllTests",
          "args": [],
          "line": 2127
        },
        "resolved": true,
        "details": {
          "function_name": "RunAllTests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "36-58",
          "snippet": "int RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "leveldb::BM_LogAndApply",
          "args": [
            "100",
            "100000"
          ],
          "line": 2123
        },
        "resolved": true,
        "details": {
          "function_name": "BM_LogAndApply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "2065-2114",
          "snippet": "void BM_LogAndApply(int iters, int num_base_files) {\n  std::string dbname = test::TmpDir() + \"/leveldb_test_benchmark\";\n  DestroyDB(dbname, Options());\n\n  DB* db = NULL;\n  Options opts;\n  opts.create_if_missing = true;\n  Status s = DB::Open(opts, dbname, &db);\n  ASSERT_OK(s);\n  ASSERT_TRUE(db != NULL);\n\n  delete db;\n  db = NULL;\n\n  Env* env = Env::Default();\n\n  port::Mutex mu;\n  MutexLock l(&mu);\n\n  InternalKeyComparator cmp(BytewiseComparator());\n  Options options;\n  VersionSet vset(dbname, &options, NULL, &cmp);\n  ASSERT_OK(vset.Recover());\n  VersionEdit vbase;\n  uint64_t fnum = 1;\n  for (int i = 0; i < num_base_files; i++) {\n    InternalKey start(MakeKey(2*fnum), 1, kTypeValue);\n    InternalKey limit(MakeKey(2*fnum+1), 1, kTypeDeletion);\n    vbase.AddFile(2, fnum++, 1 /* file size */, start, limit);\n  }\n  ASSERT_OK(vset.LogAndApply(&vbase, &mu));\n\n  uint64_t start_micros = env->NowMicros();\n\n  for (int i = 0; i < iters; i++) {\n    VersionEdit vedit;\n    vedit.DeleteFile(2, fnum);\n    InternalKey start(MakeKey(2*fnum), 1, kTypeValue);\n    InternalKey limit(MakeKey(2*fnum+1), 1, kTypeDeletion);\n    vedit.AddFile(2, fnum++, 1 /* file size */, start, limit);\n    vset.LogAndApply(&vedit, &mu);\n  }\n  uint64_t stop_micros = env->NowMicros();\n  unsigned int us = stop_micros - start_micros;\n  char buf[16];\n  snprintf(buf, sizeof(buf), \"%d\", num_base_files);\n  fprintf(stderr,\n          \"BM_LogAndApply/%-6s   %8d iters : %9u us (%7.0f us / iter)\\n\",\n          buf, iters, us, ((float)us) / iters);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nvoid BM_LogAndApply(int iters, int num_base_files) {\n  std::string dbname = test::TmpDir() + \"/leveldb_test_benchmark\";\n  DestroyDB(dbname, Options());\n\n  DB* db = NULL;\n  Options opts;\n  opts.create_if_missing = true;\n  Status s = DB::Open(opts, dbname, &db);\n  ASSERT_OK(s);\n  ASSERT_TRUE(db != NULL);\n\n  delete db;\n  db = NULL;\n\n  Env* env = Env::Default();\n\n  port::Mutex mu;\n  MutexLock l(&mu);\n\n  InternalKeyComparator cmp(BytewiseComparator());\n  Options options;\n  VersionSet vset(dbname, &options, NULL, &cmp);\n  ASSERT_OK(vset.Recover());\n  VersionEdit vbase;\n  uint64_t fnum = 1;\n  for (int i = 0; i < num_base_files; i++) {\n    InternalKey start(MakeKey(2*fnum), 1, kTypeValue);\n    InternalKey limit(MakeKey(2*fnum+1), 1, kTypeDeletion);\n    vbase.AddFile(2, fnum++, 1 /* file size */, start, limit);\n  }\n  ASSERT_OK(vset.LogAndApply(&vbase, &mu));\n\n  uint64_t start_micros = env->NowMicros();\n\n  for (int i = 0; i < iters; i++) {\n    VersionEdit vedit;\n    vedit.DeleteFile(2, fnum);\n    InternalKey start(MakeKey(2*fnum), 1, kTypeValue);\n    InternalKey limit(MakeKey(2*fnum+1), 1, kTypeDeletion);\n    vedit.AddFile(2, fnum++, 1 /* file size */, start, limit);\n    vset.LogAndApply(&vedit, &mu);\n  }\n  uint64_t stop_micros = env->NowMicros();\n  unsigned int us = stop_micros - start_micros;\n  char buf[16];\n  snprintf(buf, sizeof(buf), \"%d\", num_base_files);\n  fprintf(stderr,\n          \"BM_LogAndApply/%-6s   %8d iters : %9u us (%7.0f us / iter)\\n\",\n          buf, iters, us, ((float)us) / iters);\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "argv[1]"
          ],
          "line": 2119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nint main(int argc, char** argv) {\n  if (argc > 1 && std::string(argv[1]) == \"--benchmark\") {\n    leveldb::BM_LogAndApply(1000, 1);\n    leveldb::BM_LogAndApply(1000, 100);\n    leveldb::BM_LogAndApply(1000, 10000);\n    leveldb::BM_LogAndApply(100, 100000);\n    return 0;\n  }\n\n  return leveldb::test::RunAllTests();\n}"
  },
  {
    "function_name": "BM_LogAndApply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "2065-2114",
    "snippet": "void BM_LogAndApply(int iters, int num_base_files) {\n  std::string dbname = test::TmpDir() + \"/leveldb_test_benchmark\";\n  DestroyDB(dbname, Options());\n\n  DB* db = NULL;\n  Options opts;\n  opts.create_if_missing = true;\n  Status s = DB::Open(opts, dbname, &db);\n  ASSERT_OK(s);\n  ASSERT_TRUE(db != NULL);\n\n  delete db;\n  db = NULL;\n\n  Env* env = Env::Default();\n\n  port::Mutex mu;\n  MutexLock l(&mu);\n\n  InternalKeyComparator cmp(BytewiseComparator());\n  Options options;\n  VersionSet vset(dbname, &options, NULL, &cmp);\n  ASSERT_OK(vset.Recover());\n  VersionEdit vbase;\n  uint64_t fnum = 1;\n  for (int i = 0; i < num_base_files; i++) {\n    InternalKey start(MakeKey(2*fnum), 1, kTypeValue);\n    InternalKey limit(MakeKey(2*fnum+1), 1, kTypeDeletion);\n    vbase.AddFile(2, fnum++, 1 /* file size */, start, limit);\n  }\n  ASSERT_OK(vset.LogAndApply(&vbase, &mu));\n\n  uint64_t start_micros = env->NowMicros();\n\n  for (int i = 0; i < iters; i++) {\n    VersionEdit vedit;\n    vedit.DeleteFile(2, fnum);\n    InternalKey start(MakeKey(2*fnum), 1, kTypeValue);\n    InternalKey limit(MakeKey(2*fnum+1), 1, kTypeDeletion);\n    vedit.AddFile(2, fnum++, 1 /* file size */, start, limit);\n    vset.LogAndApply(&vedit, &mu);\n  }\n  uint64_t stop_micros = env->NowMicros();\n  unsigned int us = stop_micros - start_micros;\n  char buf[16];\n  snprintf(buf, sizeof(buf), \"%d\", num_base_files);\n  fprintf(stderr,\n          \"BM_LogAndApply/%-6s   %8d iters : %9u us (%7.0f us / iter)\\n\",\n          buf, iters, us, ((float)us) / iters);\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"BM_LogAndApply/%-6s   %8d iters : %9u us (%7.0f us / iter)\\n\"",
            "buf",
            "iters",
            "us",
            "((float)us) / iters"
          ],
          "line": 2111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%d\"",
            "num_base_files"
          ],
          "line": 2110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "env->NowMicros",
          "args": [],
          "line": 2107
        },
        "resolved": true,
        "details": {
          "function_name": "NowMicros",
          "container": "Win32Env",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "901-907",
          "snippet": "uint64_t Win32Env::NowMicros()\n{\n#ifndef USE_VISTA_API\n#define GetTickCount64 GetTickCount\n#endif\n    return (uint64_t)(GetTickCount64()*1000);\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [
            "#define GetTickCount64 GetTickCount"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\n#define GetTickCount64 GetTickCount\n\nWin32Env {\n  uint64_t Win32Env::NowMicros()\n  {\n  #ifndef USE_VISTA_API\n  #define GetTickCount64 GetTickCount\n  #endif\n      return (uint64_t)(GetTickCount64()*1000);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vset.LogAndApply",
          "args": [
            "&vedit",
            "&mu"
          ],
          "line": 2105
        },
        "resolved": true,
        "details": {
          "function_name": "LogAndApply",
          "container": "VersionSet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set.cc",
          "lines": "825-908",
          "snippet": "Status VersionSet::LogAndApply(VersionEdit* edit, port::Mutex* mu) {\n  if (edit->has_log_number_) {\n    assert(edit->log_number_ >= log_number_);\n    assert(edit->log_number_ < next_file_number_);\n  } else {\n    edit->SetLogNumber(log_number_);\n  }\n\n  if (!edit->has_prev_log_number_) {\n    edit->SetPrevLogNumber(prev_log_number_);\n  }\n\n  edit->SetNextFile(next_file_number_);\n  edit->SetLastSequence(last_sequence_);\n\n  Version* v = new Version(this);\n  {\n    Builder builder(this, current_);\n    builder.Apply(edit);\n    builder.SaveTo(v);\n  }\n  Finalize(v);\n\n  // Initialize new descriptor log file if necessary by creating\n  // a temporary file that contains a snapshot of the current version.\n  std::string new_manifest_file;\n  Status s;\n  if (descriptor_log_ == NULL) {\n    // No reason to unlock *mu here since we only hit this path in the\n    // first call to LogAndApply (when opening the database).\n    assert(descriptor_file_ == NULL);\n    new_manifest_file = DescriptorFileName(dbname_, manifest_file_number_);\n    edit->SetNextFile(next_file_number_);\n    s = env_->NewWritableFile(new_manifest_file, &descriptor_file_);\n    if (s.ok()) {\n      descriptor_log_ = new log::Writer(descriptor_file_);\n      s = WriteSnapshot(descriptor_log_);\n    }\n  }\n\n  // Unlock during expensive MANIFEST log write\n  {\n    mu->Unlock();\n\n    // Write new record to MANIFEST log\n    if (s.ok()) {\n      std::string record;\n      edit->EncodeTo(&record);\n      s = descriptor_log_->AddRecord(record);\n      if (s.ok()) {\n        s = descriptor_file_->Sync();\n      }\n      if (!s.ok()) {\n        Log(options_->info_log, \"MANIFEST write: %s\\n\", s.ToString().c_str());\n      }\n    }\n\n    // If we just created a new descriptor file, install it by writing a\n    // new CURRENT file that points to it.\n    if (s.ok() && !new_manifest_file.empty()) {\n      s = SetCurrentFile(env_, dbname_, manifest_file_number_);\n    }\n\n    mu->Lock();\n  }\n\n  // Install the new version\n  if (s.ok()) {\n    AppendVersion(v);\n    log_number_ = edit->log_number_;\n    prev_log_number_ = edit->prev_log_number_;\n  } else {\n    delete v;\n    if (!new_manifest_file.empty()) {\n      delete descriptor_log_;\n      delete descriptor_file_;\n      descriptor_log_ = NULL;\n      descriptor_file_ = NULL;\n      env_->DeleteFile(new_manifest_file);\n    }\n  }\n\n  return s;\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <algorithm>",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/env.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <algorithm>\n#include \"db/version_set.h\"\n\nVersionSet {\n  Status VersionSet::LogAndApply(VersionEdit* edit, port::Mutex* mu) {\n    if (edit->has_log_number_) {\n      assert(edit->log_number_ >= log_number_);\n      assert(edit->log_number_ < next_file_number_);\n    } else {\n      edit->SetLogNumber(log_number_);\n    }\n  \n    if (!edit->has_prev_log_number_) {\n      edit->SetPrevLogNumber(prev_log_number_);\n    }\n  \n    edit->SetNextFile(next_file_number_);\n    edit->SetLastSequence(last_sequence_);\n  \n    Version* v = new Version(this);\n    {\n      Builder builder(this, current_);\n      builder.Apply(edit);\n      builder.SaveTo(v);\n    }\n    Finalize(v);\n  \n    // Initialize new descriptor log file if necessary by creating\n    // a temporary file that contains a snapshot of the current version.\n    std::string new_manifest_file;\n    Status s;\n    if (descriptor_log_ == NULL) {\n      // No reason to unlock *mu here since we only hit this path in the\n      // first call to LogAndApply (when opening the database).\n      assert(descriptor_file_ == NULL);\n      new_manifest_file = DescriptorFileName(dbname_, manifest_file_number_);\n      edit->SetNextFile(next_file_number_);\n      s = env_->NewWritableFile(new_manifest_file, &descriptor_file_);\n      if (s.ok()) {\n        descriptor_log_ = new log::Writer(descriptor_file_);\n        s = WriteSnapshot(descriptor_log_);\n      }\n    }\n  \n    // Unlock during expensive MANIFEST log write\n    {\n      mu->Unlock();\n  \n      // Write new record to MANIFEST log\n      if (s.ok()) {\n        std::string record;\n        edit->EncodeTo(&record);\n        s = descriptor_log_->AddRecord(record);\n        if (s.ok()) {\n          s = descriptor_file_->Sync();\n        }\n        if (!s.ok()) {\n          Log(options_->info_log, \"MANIFEST write: %s\\n\", s.ToString().c_str());\n        }\n      }\n  \n      // If we just created a new descriptor file, install it by writing a\n      // new CURRENT file that points to it.\n      if (s.ok() && !new_manifest_file.empty()) {\n        s = SetCurrentFile(env_, dbname_, manifest_file_number_);\n      }\n  \n      mu->Lock();\n    }\n  \n    // Install the new version\n    if (s.ok()) {\n      AppendVersion(v);\n      log_number_ = edit->log_number_;\n      prev_log_number_ = edit->prev_log_number_;\n    } else {\n      delete v;\n      if (!new_manifest_file.empty()) {\n        delete descriptor_log_;\n        delete descriptor_file_;\n        descriptor_log_ = NULL;\n        descriptor_file_ = NULL;\n        env_->DeleteFile(new_manifest_file);\n      }\n    }\n  \n    return s;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vedit.AddFile",
          "args": [
            "2",
            "fnum++",
            "1/* file size */",
            "start",
            "limit"
          ],
          "line": 2104
        },
        "resolved": true,
        "details": {
          "function_name": "AddFile",
          "container": "VersionEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
          "lines": "62-72",
          "snippet": "void AddFile(int level, uint64_t file,\n               uint64_t file_size,\n               const InternalKey& smallest,\n               const InternalKey& largest) {\n    FileMetaData f;\n    f.number = file;\n    f.file_size = file_size;\n    f.smallest = smallest;\n    f.largest = largest;\n    new_files_.push_back(std::make_pair(level, f));\n  }",
          "includes": [
            "#include \"db/dbformat.h\"",
            "#include <vector>",
            "#include <utility>",
            "#include <set>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void AddFile(int level, uint64_t file,\n                 uint64_t file_size,\n                 const InternalKey& smallest,\n                 const InternalKey& largest) {\n      FileMetaData f;\n      f.number = file;\n      f.file_size = file_size;\n      f.smallest = smallest;\n      f.largest = largest;\n      new_files_.push_back(std::make_pair(level, f));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeKey",
          "args": [
            "2*fnum+1"
          ],
          "line": 2103
        },
        "resolved": true,
        "details": {
          "function_name": "MakeKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "2059-2063",
          "snippet": "std::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstd::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vedit.DeleteFile",
          "args": [
            "2",
            "fnum"
          ],
          "line": 2101
        },
        "resolved": true,
        "details": {
          "function_name": "DeleteFile",
          "container": "VersionEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_edit.h",
          "lines": "75-77",
          "snippet": "void DeleteFile(int level, uint64_t file) {\n    deleted_files_.insert(std::make_pair(level, file));\n  }",
          "includes": [
            "#include \"db/dbformat.h\"",
            "#include <vector>",
            "#include <utility>",
            "#include <set>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"db/dbformat.h\"\n#include <vector>\n#include <utility>\n#include <set>\n\nVersionEdit {\n  void DeleteFile(int level, uint64_t file) {\n      deleted_files_.insert(std::make_pair(level, file));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "vset.LogAndApply(&vbase, &mu)"
          ],
          "line": 2095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "vset.Recover()"
          ],
          "line": 2087
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vset.Recover",
          "args": [],
          "line": 2087
        },
        "resolved": true,
        "details": {
          "function_name": "Recover",
          "container": "VersionSet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/version_set.cc",
          "lines": "910-1023",
          "snippet": "Status VersionSet::Recover() {\n  struct LogReporter : public log::Reader::Reporter {\n    Status* status;\n    virtual void Corruption(size_t bytes, const Status& s) {\n      if (this->status->ok()) *this->status = s;\n    }\n  };\n\n  // Read \"CURRENT\" file, which contains a pointer to the current manifest file\n  std::string current;\n  Status s = ReadFileToString(env_, CurrentFileName(dbname_), &current);\n  if (!s.ok()) {\n    return s;\n  }\n  if (current.empty() || current[current.size()-1] != '\\n') {\n    return Status::Corruption(\"CURRENT file does not end with newline\");\n  }\n  current.resize(current.size() - 1);\n\n  std::string dscname = dbname_ + \"/\" + current;\n  SequentialFile* file;\n  s = env_->NewSequentialFile(dscname, &file);\n  if (!s.ok()) {\n    return s;\n  }\n\n  bool have_log_number = false;\n  bool have_prev_log_number = false;\n  bool have_next_file = false;\n  bool have_last_sequence = false;\n  uint64_t next_file = 0;\n  uint64_t last_sequence = 0;\n  uint64_t log_number = 0;\n  uint64_t prev_log_number = 0;\n  Builder builder(this, current_);\n\n  {\n    LogReporter reporter;\n    reporter.status = &s;\n    log::Reader reader(file, &reporter, true/*checksum*/, 0/*initial_offset*/);\n    Slice record;\n    std::string scratch;\n    while (reader.ReadRecord(&record, &scratch) && s.ok()) {\n      VersionEdit edit;\n      s = edit.DecodeFrom(record);\n      if (s.ok()) {\n        if (edit.has_comparator_ &&\n            edit.comparator_ != icmp_.user_comparator()->Name()) {\n          s = Status::InvalidArgument(\n              edit.comparator_ + \" does not match existing comparator \",\n              icmp_.user_comparator()->Name());\n        }\n      }\n\n      if (s.ok()) {\n        builder.Apply(&edit);\n      }\n\n      if (edit.has_log_number_) {\n        log_number = edit.log_number_;\n        have_log_number = true;\n      }\n\n      if (edit.has_prev_log_number_) {\n        prev_log_number = edit.prev_log_number_;\n        have_prev_log_number = true;\n      }\n\n      if (edit.has_next_file_number_) {\n        next_file = edit.next_file_number_;\n        have_next_file = true;\n      }\n\n      if (edit.has_last_sequence_) {\n        last_sequence = edit.last_sequence_;\n        have_last_sequence = true;\n      }\n    }\n  }\n  delete file;\n  file = NULL;\n\n  if (s.ok()) {\n    if (!have_next_file) {\n      s = Status::Corruption(\"no meta-nextfile entry in descriptor\");\n    } else if (!have_log_number) {\n      s = Status::Corruption(\"no meta-lognumber entry in descriptor\");\n    } else if (!have_last_sequence) {\n      s = Status::Corruption(\"no last-sequence-number entry in descriptor\");\n    }\n\n    if (!have_prev_log_number) {\n      prev_log_number = 0;\n    }\n\n    MarkFileNumberUsed(prev_log_number);\n    MarkFileNumberUsed(log_number);\n  }\n\n  if (s.ok()) {\n    Version* v = new Version(this);\n    builder.SaveTo(v);\n    // Install recovered version\n    Finalize(v);\n    AppendVersion(v);\n    manifest_file_number_ = next_file;\n    next_file_number_ = next_file + 1;\n    last_sequence_ = last_sequence;\n    log_number_ = log_number;\n    prev_log_number_ = prev_log_number;\n  }\n\n  return s;\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <algorithm>",
            "#include \"db/version_set.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/env.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <algorithm>\n#include \"db/version_set.h\"\n\nVersionSet {\n  Status VersionSet::Recover() {\n    struct LogReporter : public log::Reader::Reporter {\n      Status* status;\n      virtual void Corruption(size_t bytes, const Status& s) {\n        if (this->status->ok()) *this->status = s;\n      }\n    };\n  \n    // Read \"CURRENT\" file, which contains a pointer to the current manifest file\n    std::string current;\n    Status s = ReadFileToString(env_, CurrentFileName(dbname_), &current);\n    if (!s.ok()) {\n      return s;\n    }\n    if (current.empty() || current[current.size()-1] != '\\n') {\n      return Status::Corruption(\"CURRENT file does not end with newline\");\n    }\n    current.resize(current.size() - 1);\n  \n    std::string dscname = dbname_ + \"/\" + current;\n    SequentialFile* file;\n    s = env_->NewSequentialFile(dscname, &file);\n    if (!s.ok()) {\n      return s;\n    }\n  \n    bool have_log_number = false;\n    bool have_prev_log_number = false;\n    bool have_next_file = false;\n    bool have_last_sequence = false;\n    uint64_t next_file = 0;\n    uint64_t last_sequence = 0;\n    uint64_t log_number = 0;\n    uint64_t prev_log_number = 0;\n    Builder builder(this, current_);\n  \n    {\n      LogReporter reporter;\n      reporter.status = &s;\n      log::Reader reader(file, &reporter, true/*checksum*/, 0/*initial_offset*/);\n      Slice record;\n      std::string scratch;\n      while (reader.ReadRecord(&record, &scratch) && s.ok()) {\n        VersionEdit edit;\n        s = edit.DecodeFrom(record);\n        if (s.ok()) {\n          if (edit.has_comparator_ &&\n              edit.comparator_ != icmp_.user_comparator()->Name()) {\n            s = Status::InvalidArgument(\n                edit.comparator_ + \" does not match existing comparator \",\n                icmp_.user_comparator()->Name());\n          }\n        }\n  \n        if (s.ok()) {\n          builder.Apply(&edit);\n        }\n  \n        if (edit.has_log_number_) {\n          log_number = edit.log_number_;\n          have_log_number = true;\n        }\n  \n        if (edit.has_prev_log_number_) {\n          prev_log_number = edit.prev_log_number_;\n          have_prev_log_number = true;\n        }\n  \n        if (edit.has_next_file_number_) {\n          next_file = edit.next_file_number_;\n          have_next_file = true;\n        }\n  \n        if (edit.has_last_sequence_) {\n          last_sequence = edit.last_sequence_;\n          have_last_sequence = true;\n        }\n      }\n    }\n    delete file;\n    file = NULL;\n  \n    if (s.ok()) {\n      if (!have_next_file) {\n        s = Status::Corruption(\"no meta-nextfile entry in descriptor\");\n      } else if (!have_log_number) {\n        s = Status::Corruption(\"no meta-lognumber entry in descriptor\");\n      } else if (!have_last_sequence) {\n        s = Status::Corruption(\"no last-sequence-number entry in descriptor\");\n      }\n  \n      if (!have_prev_log_number) {\n        prev_log_number = 0;\n      }\n  \n      MarkFileNumberUsed(prev_log_number);\n      MarkFileNumberUsed(log_number);\n    }\n  \n    if (s.ok()) {\n      Version* v = new Version(this);\n      builder.SaveTo(v);\n      // Install recovered version\n      Finalize(v);\n      AppendVersion(v);\n      manifest_file_number_ = next_file;\n      next_file_number_ = next_file + 1;\n      last_sequence_ = last_sequence;\n      log_number_ = log_number;\n      prev_log_number_ = prev_log_number;\n    }\n  \n    return s;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [],
          "line": 2079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "db != NULL"
          ],
          "line": 2074
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "s"
          ],
          "line": 2073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DB::Open",
          "args": [
            "opts",
            "dbname",
            "&db"
          ],
          "line": 2072
        },
        "resolved": true,
        "details": {
          "function_name": "Open",
          "container": "DB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1445-1477",
          "snippet": "Status DB::Open(const Options& options, const std::string& dbname,\n                DB** dbptr) {\n  *dbptr = NULL;\n\n  DBImpl* impl = new DBImpl(options, dbname);\n  impl->mutex_.Lock();\n  VersionEdit edit;\n  Status s = impl->Recover(&edit); // Handles create_if_missing, error_if_exists\n  if (s.ok()) {\n    uint64_t new_log_number = impl->versions_->NewFileNumber();\n    WritableFile* lfile;\n    s = options.env->NewWritableFile(LogFileName(dbname, new_log_number),\n                                     &lfile);\n    if (s.ok()) {\n      edit.SetLogNumber(new_log_number);\n      impl->logfile_ = lfile;\n      impl->logfile_number_ = new_log_number;\n      impl->log_ = new log::Writer(lfile);\n      s = impl->versions_->LogAndApply(&edit, &impl->mutex_);\n    }\n    if (s.ok()) {\n      impl->DeleteObsoleteFiles();\n      impl->MaybeScheduleCompaction();\n    }\n  }\n  impl->mutex_.Unlock();\n  if (s.ok()) {\n    *dbptr = impl;\n  } else {\n    delete impl;\n  }\n  return s;\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nDB {\n  Status DB::Open(const Options& options, const std::string& dbname,\n                  DB** dbptr) {\n    *dbptr = NULL;\n  \n    DBImpl* impl = new DBImpl(options, dbname);\n    impl->mutex_.Lock();\n    VersionEdit edit;\n    Status s = impl->Recover(&edit); // Handles create_if_missing, error_if_exists\n    if (s.ok()) {\n      uint64_t new_log_number = impl->versions_->NewFileNumber();\n      WritableFile* lfile;\n      s = options.env->NewWritableFile(LogFileName(dbname, new_log_number),\n                                       &lfile);\n      if (s.ok()) {\n        edit.SetLogNumber(new_log_number);\n        impl->logfile_ = lfile;\n        impl->logfile_number_ = new_log_number;\n        impl->log_ = new log::Writer(lfile);\n        s = impl->versions_->LogAndApply(&edit, &impl->mutex_);\n      }\n      if (s.ok()) {\n        impl->DeleteObsoleteFiles();\n        impl->MaybeScheduleCompaction();\n      }\n    }\n    impl->mutex_.Unlock();\n    if (s.ok()) {\n      *dbptr = impl;\n    } else {\n      delete impl;\n    }\n    return s;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DestroyDB",
          "args": [
            "dbname",
            "Options()"
          ],
          "line": 2067
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyDB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1482-1511",
          "snippet": "Status DestroyDB(const std::string& dbname, const Options& options) {\n  Env* env = options.env;\n  std::vector<std::string> filenames;\n  // Ignore error in case directory does not exist\n  env->GetChildren(dbname, &filenames);\n  if (filenames.empty()) {\n    return Status::OK();\n  }\n\n  FileLock* lock;\n  const std::string lockname = LockFileName(dbname);\n  Status result = env->LockFile(lockname, &lock);\n  if (result.ok()) {\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) &&\n          type != kDBLockFile) {  // Lock file will be deleted at end\n        Status del = env->DeleteFile(dbname + \"/\" + filenames[i]);\n        if (result.ok() && !del.ok()) {\n          result = del;\n        }\n      }\n    }\n    env->UnlockFile(lock);  // Ignore error since state is already gone\n    env->DeleteFile(lockname);\n    env->DeleteDir(dbname);  // Ignore error in case dir contains other files\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nStatus DestroyDB(const std::string& dbname, const Options& options) {\n  Env* env = options.env;\n  std::vector<std::string> filenames;\n  // Ignore error in case directory does not exist\n  env->GetChildren(dbname, &filenames);\n  if (filenames.empty()) {\n    return Status::OK();\n  }\n\n  FileLock* lock;\n  const std::string lockname = LockFileName(dbname);\n  Status result = env->LockFile(lockname, &lock);\n  if (result.ok()) {\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) &&\n          type != kDBLockFile) {  // Lock file will be deleted at end\n        Status del = env->DeleteFile(dbname + \"/\" + filenames[i]);\n        if (result.ok() && !del.ok()) {\n          result = del;\n        }\n      }\n    }\n    env->UnlockFile(lock);  // Ignore error since state is already gone\n    env->DeleteFile(lockname);\n    env->DeleteDir(dbname);  // Ignore error in case dir contains other files\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Options",
          "args": [],
          "line": 2067
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::TmpDir",
          "args": [],
          "line": 2066
        },
        "resolved": true,
        "details": {
          "function_name": "TmpDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "60-65",
          "snippet": "std::string TmpDir() {\n  std::string dir;\n  Status s = Env::Default()->GetTestDirectory(&dir);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  return dir;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nstd::string TmpDir() {\n  std::string dir;\n  Status s = Env::Default()->GetTestDirectory(&dir);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  return dir;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nvoid BM_LogAndApply(int iters, int num_base_files) {\n  std::string dbname = test::TmpDir() + \"/leveldb_test_benchmark\";\n  DestroyDB(dbname, Options());\n\n  DB* db = NULL;\n  Options opts;\n  opts.create_if_missing = true;\n  Status s = DB::Open(opts, dbname, &db);\n  ASSERT_OK(s);\n  ASSERT_TRUE(db != NULL);\n\n  delete db;\n  db = NULL;\n\n  Env* env = Env::Default();\n\n  port::Mutex mu;\n  MutexLock l(&mu);\n\n  InternalKeyComparator cmp(BytewiseComparator());\n  Options options;\n  VersionSet vset(dbname, &options, NULL, &cmp);\n  ASSERT_OK(vset.Recover());\n  VersionEdit vbase;\n  uint64_t fnum = 1;\n  for (int i = 0; i < num_base_files; i++) {\n    InternalKey start(MakeKey(2*fnum), 1, kTypeValue);\n    InternalKey limit(MakeKey(2*fnum+1), 1, kTypeDeletion);\n    vbase.AddFile(2, fnum++, 1 /* file size */, start, limit);\n  }\n  ASSERT_OK(vset.LogAndApply(&vbase, &mu));\n\n  uint64_t start_micros = env->NowMicros();\n\n  for (int i = 0; i < iters; i++) {\n    VersionEdit vedit;\n    vedit.DeleteFile(2, fnum);\n    InternalKey start(MakeKey(2*fnum), 1, kTypeValue);\n    InternalKey limit(MakeKey(2*fnum+1), 1, kTypeDeletion);\n    vedit.AddFile(2, fnum++, 1 /* file size */, start, limit);\n    vset.LogAndApply(&vedit, &mu);\n  }\n  uint64_t stop_micros = env->NowMicros();\n  unsigned int us = stop_micros - start_micros;\n  char buf[16];\n  snprintf(buf, sizeof(buf), \"%d\", num_base_files);\n  fprintf(stderr,\n          \"BM_LogAndApply/%-6s   %8d iters : %9u us (%7.0f us / iter)\\n\",\n          buf, iters, us, ((float)us) / iters);\n}"
  },
  {
    "function_name": "MakeKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "2059-2063",
    "snippet": "std::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "buf"
          ],
          "line": 2062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%016u\"",
            "num"
          ],
          "line": 2061
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstd::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1988-2057",
    "snippet": "TEST(DBTest, Randomized) {\n  Random rnd(test::RandomSeed());\n  do {\n    ModelDB model(CurrentOptions());\n    const int N = 10000;\n    const Snapshot* model_snap = NULL;\n    const Snapshot* db_snap = NULL;\n    std::string k, v;\n    for (int step = 0; step < N; step++) {\n      if (step % 100 == 0) {\n        fprintf(stderr, \"Step %d of %d\\n\", step, N);\n      }\n      // TODO(sanjay): Test Get() works\n      int p = rnd.Uniform(100);\n      if (p < 45) {                               // Put\n        k = RandomKey(&rnd);\n        v = RandomString(&rnd,\n                         rnd.OneIn(20)\n                         ? 100 + rnd.Uniform(100)\n                         : rnd.Uniform(8));\n        ASSERT_OK(model.Put(WriteOptions(), k, v));\n        ASSERT_OK(db_->Put(WriteOptions(), k, v));\n\n      } else if (p < 90) {                        // Delete\n        k = RandomKey(&rnd);\n        ASSERT_OK(model.Delete(WriteOptions(), k));\n        ASSERT_OK(db_->Delete(WriteOptions(), k));\n\n\n      } else {                                    // Multi-element batch\n        WriteBatch b;\n        const int num = rnd.Uniform(8);\n        for (int i = 0; i < num; i++) {\n          if (i == 0 || !rnd.OneIn(10)) {\n            k = RandomKey(&rnd);\n          } else {\n            // Periodically re-use the same key from the previous iter, so\n            // we have multiple entries in the write batch for the same key\n          }\n          if (rnd.OneIn(2)) {\n            v = RandomString(&rnd, rnd.Uniform(10));\n            b.Put(k, v);\n          } else {\n            b.Delete(k);\n          }\n        }\n        ASSERT_OK(model.Write(WriteOptions(), &b));\n        ASSERT_OK(db_->Write(WriteOptions(), &b));\n      }\n\n      if ((step % 100) == 0) {\n        ASSERT_TRUE(CompareIterators(step, &model, db_, NULL, NULL));\n        ASSERT_TRUE(CompareIterators(step, &model, db_, model_snap, db_snap));\n        // Save a snapshot from each DB this time that we'll use next\n        // time we compare things, to make sure the current state is\n        // preserved with the snapshot\n        if (model_snap != NULL) model.ReleaseSnapshot(model_snap);\n        if (db_snap != NULL) db_->ReleaseSnapshot(db_snap);\n\n        Reopen();\n        ASSERT_TRUE(CompareIterators(step, &model, db_, NULL, NULL));\n\n        model_snap = model.GetSnapshot();\n        db_snap = db_->GetSnapshot();\n      }\n    }\n    if (model_snap != NULL) model.ReleaseSnapshot(model_snap);\n    if (db_snap != NULL) db_->ReleaseSnapshot(db_snap);\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 2056
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->ReleaseSnapshot",
          "args": [
            "db_snap"
          ],
          "line": 2055
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSnapshot",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1868-1870",
          "snippet": "virtual void ReleaseSnapshot(const Snapshot* snapshot) {\n    delete reinterpret_cast<const ModelSnapshot*>(snapshot);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void ReleaseSnapshot(const Snapshot* snapshot) {\n      delete reinterpret_cast<const ModelSnapshot*>(snapshot);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->GetSnapshot",
          "args": [],
          "line": 2051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model.GetSnapshot",
          "args": [],
          "line": 2050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "CompareIterators(step, &model, db_, NULL, NULL)"
          ],
          "line": 2048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CompareIterators",
          "args": [
            "step",
            "&model",
            "db_",
            "NULL",
            "NULL"
          ],
          "line": 2048
        },
        "resolved": true,
        "details": {
          "function_name": "CompareIterators",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1940-1986",
          "snippet": "static bool CompareIterators(int step,\n                             DB* model,\n                             DB* db,\n                             const Snapshot* model_snap,\n                             const Snapshot* db_snap) {\n  ReadOptions options;\n  options.snapshot = model_snap;\n  Iterator* miter = model->NewIterator(options);\n  options.snapshot = db_snap;\n  Iterator* dbiter = db->NewIterator(options);\n  bool ok = true;\n  int count = 0;\n  for (miter->SeekToFirst(), dbiter->SeekToFirst();\n       ok && miter->Valid() && dbiter->Valid();\n       miter->Next(), dbiter->Next()) {\n    count++;\n    if (miter->key().compare(dbiter->key()) != 0) {\n      fprintf(stderr, \"step %d: Key mismatch: '%s' vs. '%s'\\n\",\n              step,\n              EscapeString(miter->key()).c_str(),\n              EscapeString(dbiter->key()).c_str());\n      ok = false;\n      break;\n    }\n\n    if (miter->value().compare(dbiter->value()) != 0) {\n      fprintf(stderr, \"step %d: Value mismatch for key '%s': '%s' vs. '%s'\\n\",\n              step,\n              EscapeString(miter->key()).c_str(),\n              EscapeString(miter->value()).c_str(),\n              EscapeString(miter->value()).c_str());\n      ok = false;\n    }\n  }\n\n  if (ok) {\n    if (miter->Valid() != dbiter->Valid()) {\n      fprintf(stderr, \"step %d: Mismatch at end of iterators: %d vs. %d\\n\",\n              step, miter->Valid(), dbiter->Valid());\n      ok = false;\n    }\n  }\n  fprintf(stderr, \"%d entries compared: ok=%d\\n\", count, ok);\n  delete miter;\n  delete dbiter;\n  return ok;\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic bool CompareIterators(int step,\n                             DB* model,\n                             DB* db,\n                             const Snapshot* model_snap,\n                             const Snapshot* db_snap) {\n  ReadOptions options;\n  options.snapshot = model_snap;\n  Iterator* miter = model->NewIterator(options);\n  options.snapshot = db_snap;\n  Iterator* dbiter = db->NewIterator(options);\n  bool ok = true;\n  int count = 0;\n  for (miter->SeekToFirst(), dbiter->SeekToFirst();\n       ok && miter->Valid() && dbiter->Valid();\n       miter->Next(), dbiter->Next()) {\n    count++;\n    if (miter->key().compare(dbiter->key()) != 0) {\n      fprintf(stderr, \"step %d: Key mismatch: '%s' vs. '%s'\\n\",\n              step,\n              EscapeString(miter->key()).c_str(),\n              EscapeString(dbiter->key()).c_str());\n      ok = false;\n      break;\n    }\n\n    if (miter->value().compare(dbiter->value()) != 0) {\n      fprintf(stderr, \"step %d: Value mismatch for key '%s': '%s' vs. '%s'\\n\",\n              step,\n              EscapeString(miter->key()).c_str(),\n              EscapeString(miter->value()).c_str(),\n              EscapeString(miter->value()).c_str());\n      ok = false;\n    }\n  }\n\n  if (ok) {\n    if (miter->Valid() != dbiter->Valid()) {\n      fprintf(stderr, \"step %d: Mismatch at end of iterators: %d vs. %d\\n\",\n              step, miter->Valid(), dbiter->Valid());\n      ok = false;\n    }\n  }\n  fprintf(stderr, \"%d entries compared: ok=%d\\n\", count, ok);\n  delete miter;\n  delete dbiter;\n  return ok;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [],
          "line": 2047
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyAndReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "266-271",
          "snippet": "void DestroyAndReopen(Options* options = NULL) {\n    delete db_;\n    db_ = NULL;\n    DestroyDB(dbname_, Options());\n    ASSERT_OK(TryReopen(options));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void DestroyAndReopen(Options* options = NULL) {\n      delete db_;\n      db_ = NULL;\n      DestroyDB(dbname_, Options());\n      ASSERT_OK(TryReopen(options));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "CompareIterators(step, &model, db_, model_snap, db_snap)"
          ],
          "line": 2040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "CompareIterators(step, &model, db_, NULL, NULL)"
          ],
          "line": 2039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "db_->Write(WriteOptions(), &b)"
          ],
          "line": 2035
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->Write",
          "args": [
            "WriteOptions()",
            "&b"
          ],
          "line": 2035
        },
        "resolved": true,
        "details": {
          "function_name": "Write",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1871-1885",
          "snippet": "virtual Status Write(const WriteOptions& options, WriteBatch* batch) {\n    class Handler : public WriteBatch::Handler {\n     public:\n      KVMap* map_;\n      virtual void Put(const Slice& key, const Slice& value) {\n        (*map_)[key.ToString()] = value.ToString();\n      }\n      virtual void Delete(const Slice& key) {\n        map_->erase(key.ToString());\n      }\n    };\n    Handler handler;\n    handler.map_ = &map_;\n    return batch->Iterate(&handler);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Write(const WriteOptions& options, WriteBatch* batch) {\n      class Handler : public WriteBatch::Handler {\n       public:\n        KVMap* map_;\n        virtual void Put(const Slice& key, const Slice& value) {\n          (*map_)[key.ToString()] = value.ToString();\n        }\n        virtual void Delete(const Slice& key) {\n          map_->erase(key.ToString());\n        }\n      };\n      Handler handler;\n      handler.map_ = &map_;\n      return batch->Iterate(&handler);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WriteOptions",
          "args": [],
          "line": 2035
        },
        "resolved": true,
        "details": {
          "function_name": "WriteOptions",
          "container": "WriteOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "188-190",
          "snippet": "WriteOptions()\n      : sync(false) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nWriteOptions {\n  WriteOptions()\n        : sync(false) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "model.Write(WriteOptions(), &b)"
          ],
          "line": 2034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b.Delete",
          "args": [
            "k"
          ],
          "line": 2031
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "292-294",
          "snippet": "Status Delete(const std::string& k) {\n    return db_->Delete(WriteOptions(), k);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Delete(const std::string& k) {\n      return db_->Delete(WriteOptions(), k);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "b.Put",
          "args": [
            "k",
            "v"
          ],
          "line": 2029
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "RandomString",
          "args": [
            "&rnd",
            "rnd.Uniform(10)"
          ],
          "line": 2028
        },
        "resolved": true,
        "details": {
          "function_name": "RandomString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "22-26",
          "snippet": "static std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rnd.Uniform",
          "args": [
            "10"
          ],
          "line": 2028
        },
        "resolved": true,
        "details": {
          "function_name": "Uniform",
          "container": "Random",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/random.h",
          "lines": "48-48",
          "snippet": "uint32_t Uniform(int n) { return Next() % n; }",
          "includes": [
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n\nRandom {\n  uint32_t Uniform(int n) { return Next() % n; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rnd.OneIn",
          "args": [
            "2"
          ],
          "line": 2027
        },
        "resolved": true,
        "details": {
          "function_name": "OneIn",
          "container": "Random",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/random.h",
          "lines": "52-52",
          "snippet": "bool OneIn(int n) { return (Next() % n) == 0; }",
          "includes": [
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n\nRandom {\n  bool OneIn(int n) { return (Next() % n) == 0; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "RandomKey",
          "args": [
            "&rnd"
          ],
          "line": 2022
        },
        "resolved": true,
        "details": {
          "function_name": "RandomKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1933-1938",
          "snippet": "static std::string RandomKey(Random* rnd) {\n  int len = (rnd->OneIn(3)\n             ? 1                // Short sometimes to encourage collisions\n             : (rnd->OneIn(100) ? rnd->Skewed(10) : rnd->Uniform(10)));\n  return test::RandomKey(rnd, len);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic std::string RandomKey(Random* rnd) {\n  int len = (rnd->OneIn(3)\n             ? 1                // Short sometimes to encourage collisions\n             : (rnd->OneIn(100) ? rnd->Skewed(10) : rnd->Uniform(10)));\n  return test::RandomKey(rnd, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "db_->Delete(WriteOptions(), k)"
          ],
          "line": 2014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->Delete",
          "args": [
            "WriteOptions()",
            "k"
          ],
          "line": 2014
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1843-1845",
          "snippet": "virtual Status Delete(const WriteOptions& o, const Slice& key) {\n    return DB::Delete(o, key);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Delete(const WriteOptions& o, const Slice& key) {\n      return DB::Delete(o, key);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "model.Delete(WriteOptions(), k)"
          ],
          "line": 2013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "db_->Put(WriteOptions(), k, v)"
          ],
          "line": 2009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->Put",
          "args": [
            "WriteOptions()",
            "k",
            "v"
          ],
          "line": 2009
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1840-1842",
          "snippet": "virtual Status Put(const WriteOptions& o, const Slice& k, const Slice& v) {\n    return DB::Put(o, k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Put(const WriteOptions& o, const Slice& k, const Slice& v) {\n      return DB::Put(o, k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "model.Put(WriteOptions(), k, v)"
          ],
          "line": 2008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Step %d of %d\\n\"",
            "step",
            "N"
          ],
          "line": 1998
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, Randomized) {\n  Random rnd(test::RandomSeed());\n  do {\n    ModelDB model(CurrentOptions());\n    const int N = 10000;\n    const Snapshot* model_snap = NULL;\n    const Snapshot* db_snap = NULL;\n    std::string k, v;\n    for (int step = 0; step < N; step++) {\n      if (step % 100 == 0) {\n        fprintf(stderr, \"Step %d of %d\\n\", step, N);\n      }\n      // TODO(sanjay): Test Get() works\n      int p = rnd.Uniform(100);\n      if (p < 45) {                               // Put\n        k = RandomKey(&rnd);\n        v = RandomString(&rnd,\n                         rnd.OneIn(20)\n                         ? 100 + rnd.Uniform(100)\n                         : rnd.Uniform(8));\n        ASSERT_OK(model.Put(WriteOptions(), k, v));\n        ASSERT_OK(db_->Put(WriteOptions(), k, v));\n\n      } else if (p < 90) {                        // Delete\n        k = RandomKey(&rnd);\n        ASSERT_OK(model.Delete(WriteOptions(), k));\n        ASSERT_OK(db_->Delete(WriteOptions(), k));\n\n\n      } else {                                    // Multi-element batch\n        WriteBatch b;\n        const int num = rnd.Uniform(8);\n        for (int i = 0; i < num; i++) {\n          if (i == 0 || !rnd.OneIn(10)) {\n            k = RandomKey(&rnd);\n          } else {\n            // Periodically re-use the same key from the previous iter, so\n            // we have multiple entries in the write batch for the same key\n          }\n          if (rnd.OneIn(2)) {\n            v = RandomString(&rnd, rnd.Uniform(10));\n            b.Put(k, v);\n          } else {\n            b.Delete(k);\n          }\n        }\n        ASSERT_OK(model.Write(WriteOptions(), &b));\n        ASSERT_OK(db_->Write(WriteOptions(), &b));\n      }\n\n      if ((step % 100) == 0) {\n        ASSERT_TRUE(CompareIterators(step, &model, db_, NULL, NULL));\n        ASSERT_TRUE(CompareIterators(step, &model, db_, model_snap, db_snap));\n        // Save a snapshot from each DB this time that we'll use next\n        // time we compare things, to make sure the current state is\n        // preserved with the snapshot\n        if (model_snap != NULL) model.ReleaseSnapshot(model_snap);\n        if (db_snap != NULL) db_->ReleaseSnapshot(db_snap);\n\n        Reopen();\n        ASSERT_TRUE(CompareIterators(step, &model, db_, NULL, NULL));\n\n        model_snap = model.GetSnapshot();\n        db_snap = db_->GetSnapshot();\n      }\n    }\n    if (model_snap != NULL) model.ReleaseSnapshot(model_snap);\n    if (db_snap != NULL) db_->ReleaseSnapshot(db_snap);\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "CompareIterators",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1940-1986",
    "snippet": "static bool CompareIterators(int step,\n                             DB* model,\n                             DB* db,\n                             const Snapshot* model_snap,\n                             const Snapshot* db_snap) {\n  ReadOptions options;\n  options.snapshot = model_snap;\n  Iterator* miter = model->NewIterator(options);\n  options.snapshot = db_snap;\n  Iterator* dbiter = db->NewIterator(options);\n  bool ok = true;\n  int count = 0;\n  for (miter->SeekToFirst(), dbiter->SeekToFirst();\n       ok && miter->Valid() && dbiter->Valid();\n       miter->Next(), dbiter->Next()) {\n    count++;\n    if (miter->key().compare(dbiter->key()) != 0) {\n      fprintf(stderr, \"step %d: Key mismatch: '%s' vs. '%s'\\n\",\n              step,\n              EscapeString(miter->key()).c_str(),\n              EscapeString(dbiter->key()).c_str());\n      ok = false;\n      break;\n    }\n\n    if (miter->value().compare(dbiter->value()) != 0) {\n      fprintf(stderr, \"step %d: Value mismatch for key '%s': '%s' vs. '%s'\\n\",\n              step,\n              EscapeString(miter->key()).c_str(),\n              EscapeString(miter->value()).c_str(),\n              EscapeString(miter->value()).c_str());\n      ok = false;\n    }\n  }\n\n  if (ok) {\n    if (miter->Valid() != dbiter->Valid()) {\n      fprintf(stderr, \"step %d: Mismatch at end of iterators: %d vs. %d\\n\",\n              step, miter->Valid(), dbiter->Valid());\n      ok = false;\n    }\n  }\n  fprintf(stderr, \"%d entries compared: ok=%d\\n\", count, ok);\n  delete miter;\n  delete dbiter;\n  return ok;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%d entries compared: ok=%d\\n\"",
            "count",
            "ok"
          ],
          "line": 1982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"step %d: Mismatch at end of iterators: %d vs. %d\\n\"",
            "step",
            "miter->Valid()",
            "dbiter->Valid()"
          ],
          "line": 1977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbiter->Valid",
          "args": [],
          "line": 1978
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1907-1907",
          "snippet": "virtual bool Valid() const { return iter_ != map_->end(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual bool Valid() const { return iter_ != map_->end(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"step %d: Value mismatch for key '%s': '%s' vs. '%s'\\n\"",
            "step",
            "EscapeString(miter->key()).c_str()",
            "EscapeString(miter->value()).c_str()",
            "EscapeString(miter->value()).c_str()"
          ],
          "line": 1966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EscapeString",
          "args": [],
          "line": 1970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EscapeString",
          "args": [
            "miter->value()"
          ],
          "line": 1970
        },
        "resolved": true,
        "details": {
          "function_name": "EscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
          "lines": "42-46",
          "snippet": "std::string EscapeString(const Slice& value) {\n  std::string r;\n  AppendEscapedStringTo(&r, value);\n  return r;\n}",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"util/logging.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nstd::string EscapeString(const Slice& value) {\n  std::string r;\n  AppendEscapedStringTo(&r, value);\n  return r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "miter->value",
          "args": [],
          "line": 1970
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1922-1922",
          "snippet": "virtual Slice value() const { return iter_->second; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual Slice value() const { return iter_->second; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EscapeString",
          "args": [],
          "line": 1969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EscapeString",
          "args": [],
          "line": 1968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "miter->key",
          "args": [],
          "line": 1968
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1921-1921",
          "snippet": "virtual Slice key() const { return iter_->first; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual Slice key() const { return iter_->first; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "miter->value",
          "args": [
            "dbiter->value()"
          ],
          "line": 1965
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "118-127",
          "snippet": "qint64 BitcoinAmountField::value(bool *valid_out) const\n{\n    qint64 val_out = 0;\n    bool valid = BitcoinUnits::parse(currentUnit, text(), &val_out);\n    if(valid_out)\n    {\n        *valid_out = valid;\n    }\n    return val_out;\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  qint64 BitcoinAmountField::value(bool *valid_out) const\n  {\n      qint64 val_out = 0;\n      bool valid = BitcoinUnits::parse(currentUnit, text(), &val_out);\n      if(valid_out)\n      {\n          *valid_out = valid;\n      }\n      return val_out;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"step %d: Key mismatch: '%s' vs. '%s'\\n\"",
            "step",
            "EscapeString(miter->key()).c_str()",
            "EscapeString(dbiter->key()).c_str()"
          ],
          "line": 1957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EscapeString",
          "args": [],
          "line": 1960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EscapeString",
          "args": [],
          "line": 1959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "miter->key",
          "args": [
            "dbiter->key()"
          ],
          "line": 1956
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "ConcurrentTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/skiplist_test.cc",
          "lines": "153-153",
          "snippet": "static uint64_t key(Key key) { return (key >> 40); }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/hash.h\"",
            "#include \"util/arena.h\"",
            "#include \"leveldb/env.h\"",
            "#include <set>",
            "#include \"db/skiplist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/hash.h\"\n#include \"util/arena.h\"\n#include \"leveldb/env.h\"\n#include <set>\n#include \"db/skiplist.h\"\n\nConcurrentTest {\n  static uint64_t key(Key key) { return (key >> 40); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbiter->Next",
          "args": [],
          "line": 1954
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1919-1919",
          "snippet": "virtual void Next() { ++iter_; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Next() { ++iter_; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbiter->SeekToFirst",
          "args": [],
          "line": 1952
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1908-1908",
          "snippet": "virtual void SeekToFirst() { iter_ = map_->begin(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToFirst() { iter_ = map_->begin(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db->NewIterator",
          "args": [
            "options"
          ],
          "line": 1949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->NewIterator",
          "args": [
            "options"
          ],
          "line": 1947
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic bool CompareIterators(int step,\n                             DB* model,\n                             DB* db,\n                             const Snapshot* model_snap,\n                             const Snapshot* db_snap) {\n  ReadOptions options;\n  options.snapshot = model_snap;\n  Iterator* miter = model->NewIterator(options);\n  options.snapshot = db_snap;\n  Iterator* dbiter = db->NewIterator(options);\n  bool ok = true;\n  int count = 0;\n  for (miter->SeekToFirst(), dbiter->SeekToFirst();\n       ok && miter->Valid() && dbiter->Valid();\n       miter->Next(), dbiter->Next()) {\n    count++;\n    if (miter->key().compare(dbiter->key()) != 0) {\n      fprintf(stderr, \"step %d: Key mismatch: '%s' vs. '%s'\\n\",\n              step,\n              EscapeString(miter->key()).c_str(),\n              EscapeString(dbiter->key()).c_str());\n      ok = false;\n      break;\n    }\n\n    if (miter->value().compare(dbiter->value()) != 0) {\n      fprintf(stderr, \"step %d: Value mismatch for key '%s': '%s' vs. '%s'\\n\",\n              step,\n              EscapeString(miter->key()).c_str(),\n              EscapeString(miter->value()).c_str(),\n              EscapeString(miter->value()).c_str());\n      ok = false;\n    }\n  }\n\n  if (ok) {\n    if (miter->Valid() != dbiter->Valid()) {\n      fprintf(stderr, \"step %d: Mismatch at end of iterators: %d vs. %d\\n\",\n              step, miter->Valid(), dbiter->Valid());\n      ok = false;\n    }\n  }\n  fprintf(stderr, \"%d entries compared: ok=%d\\n\", count, ok);\n  delete miter;\n  delete dbiter;\n  return ok;\n}"
  },
  {
    "function_name": "RandomKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1933-1938",
    "snippet": "static std::string RandomKey(Random* rnd) {\n  int len = (rnd->OneIn(3)\n             ? 1                // Short sometimes to encourage collisions\n             : (rnd->OneIn(100) ? rnd->Skewed(10) : rnd->Uniform(10)));\n  return test::RandomKey(rnd, len);\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test::RandomKey",
          "args": [
            "rnd",
            "len"
          ],
          "line": 1937
        },
        "resolved": true,
        "details": {
          "function_name": "RandomKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testutil.cc",
          "lines": "20-31",
          "snippet": "std::string RandomKey(Random* rnd, int len) {\n  // Make sure to generate a wide variety of characters so we\n  // test the boundary conditions for short-key optimizations.\n  static const char kTestChars[] = {\n    '\\0', '\\1', 'a', 'b', 'c', 'd', 'e', '\\xfd', '\\xfe', '\\xff'\n  };\n  std::string result;\n  for (int i = 0; i < len; i++) {\n    result += kTestChars[rnd->Uniform(sizeof(kTestChars))];\n  }\n  return result;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "rnd->Uniform",
          "args": [
            "10"
          ],
          "line": 1936
        },
        "resolved": true,
        "details": {
          "function_name": "Uniform",
          "container": "Random",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/random.h",
          "lines": "48-48",
          "snippet": "uint32_t Uniform(int n) { return Next() % n; }",
          "includes": [
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n\nRandom {\n  uint32_t Uniform(int n) { return Next() % n; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rnd->Skewed",
          "args": [
            "10"
          ],
          "line": 1936
        },
        "resolved": true,
        "details": {
          "function_name": "Skewed",
          "container": "Random",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/random.h",
          "lines": "57-59",
          "snippet": "uint32_t Skewed(int max_log) {\n    return Uniform(1 << Uniform(max_log + 1));\n  }",
          "includes": [
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n\nRandom {\n  uint32_t Skewed(int max_log) {\n      return Uniform(1 << Uniform(max_log + 1));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rnd->OneIn",
          "args": [
            "100"
          ],
          "line": 1936
        },
        "resolved": true,
        "details": {
          "function_name": "OneIn",
          "container": "Random",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/random.h",
          "lines": "52-52",
          "snippet": "bool OneIn(int n) { return (Next() % n) == 0; }",
          "includes": [
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n\nRandom {\n  bool OneIn(int n) { return (Next() % n) == 0; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic std::string RandomKey(Random* rnd) {\n  int len = (rnd->OneIn(3)\n             ? 1                // Short sometimes to encourage collisions\n             : (rnd->OneIn(100) ? rnd->Skewed(10) : rnd->Uniform(10)));\n  return test::RandomKey(rnd, len);\n}"
  },
  {
    "function_name": "status",
    "container": "ModelDB::ModelIter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1923-1923",
    "snippet": "virtual Status status() const { return Status::OK(); }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 1923
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual Status status() const { return Status::OK(); }\n  }\n}"
  },
  {
    "function_name": "value",
    "container": "ModelDB::ModelIter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1922-1922",
    "snippet": "virtual Slice value() const { return iter_->second; }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual Slice value() const { return iter_->second; }\n  }\n}"
  },
  {
    "function_name": "key",
    "container": "ModelDB::ModelIter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1921-1921",
    "snippet": "virtual Slice key() const { return iter_->first; }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual Slice key() const { return iter_->first; }\n  }\n}"
  },
  {
    "function_name": "Prev",
    "container": "ModelDB::ModelIter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1920-1920",
    "snippet": "virtual void Prev() { --iter_; }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Prev() { --iter_; }\n  }\n}"
  },
  {
    "function_name": "Next",
    "container": "ModelDB::ModelIter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1919-1919",
    "snippet": "virtual void Next() { ++iter_; }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Next() { ++iter_; }\n  }\n}"
  },
  {
    "function_name": "Seek",
    "container": "ModelDB::ModelIter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1916-1918",
    "snippet": "virtual void Seek(const Slice& k) {\n      iter_ = map_->lower_bound(k.ToString());\n    }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "map_->lower_bound",
          "args": [
            "k.ToString()"
          ],
          "line": 1917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "k.ToString",
          "args": [],
          "line": 1917
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CUnsignedSyncCheckpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/checkpoints.h",
          "lines": "89-98",
          "snippet": "std::string ToString() const\n    {\n        return strprintf(\n                \"CSyncCheckpoint(\\n\"\n                \"    nVersion       = %d\\n\"\n                \"    hashCheckpoint = %s\\n\"\n                \")\\n\",\n            nVersion,\n            hashCheckpoint.ToString().c_str());\n    }",
          "includes": [
            "#include \"util.h\"",
            "#include \"net.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"net.h\"\n#include <map>\n\nCUnsignedSyncCheckpoint {\n  std::string ToString() const\n      {\n          return strprintf(\n                  \"CSyncCheckpoint(\\n\"\n                  \"    nVersion       = %d\\n\"\n                  \"    hashCheckpoint = %s\\n\"\n                  \")\\n\",\n              nVersion,\n              hashCheckpoint.ToString().c_str());\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Seek(const Slice& k) {\n          iter_ = map_->lower_bound(k.ToString());\n        }\n  }\n}"
  },
  {
    "function_name": "SeekToLast",
    "container": "ModelDB::ModelIter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1909-1915",
    "snippet": "virtual void SeekToLast() {\n      if (map_->empty()) {\n        iter_ = map_->end();\n      } else {\n        iter_ = map_->find(map_->rbegin()->first);\n      }\n    }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "map_->find",
          "args": [
            "map_->rbegin()->first"
          ],
          "line": 1913
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "map_->rbegin",
          "args": [],
          "line": 1913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map_->end",
          "args": [],
          "line": 1911
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "map_->empty",
          "args": [],
          "line": 1910
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "SnapshotList",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/snapshot.h",
          "lines": "37-37",
          "snippet": "bool empty() const { return list_.next_ == &list_; }",
          "includes": [
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/db.h\"\n\nSnapshotList {\n  bool empty() const { return list_.next_ == &list_; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToLast() {\n          if (map_->empty()) {\n            iter_ = map_->end();\n          } else {\n            iter_ = map_->find(map_->rbegin()->first);\n          }\n        }\n  }\n}"
  },
  {
    "function_name": "SeekToFirst",
    "container": "ModelDB::ModelIter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1908-1908",
    "snippet": "virtual void SeekToFirst() { iter_ = map_->begin(); }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "map_->begin",
          "args": [],
          "line": 1908
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToFirst() { iter_ = map_->begin(); }\n  }\n}"
  },
  {
    "function_name": "Valid",
    "container": "ModelDB::ModelIter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1907-1907",
    "snippet": "virtual bool Valid() const { return iter_ != map_->end(); }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "map_->end",
          "args": [],
          "line": 1907
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual bool Valid() const { return iter_ != map_->end(); }\n  }\n}"
  },
  {
    "function_name": "ModelIter",
    "container": "ModelDB::ModelIter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1901-1903",
    "snippet": "ModelIter(const KVMap* map, bool owned)\n        : map_(map), owned_(owned), iter_(map_->end()) {\n    }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "map_->end",
          "args": [],
          "line": 1902
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    ModelIter(const KVMap* map, bool owned)\n            : map_(map), owned_(owned), iter_(map_->end()) {\n        }\n  }\n}"
  },
  {
    "function_name": "CompactRange",
    "container": "ModelDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1895-1896",
    "snippet": "virtual void CompactRange(const Slice* start, const Slice* end) {\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void CompactRange(const Slice* start, const Slice* end) {\n    }\n}"
  },
  {
    "function_name": "GetApproximateSizes",
    "container": "ModelDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1890-1894",
    "snippet": "virtual void GetApproximateSizes(const Range* r, int n, uint64_t* sizes) {\n    for (int i = 0; i < n; i++) {\n      sizes[i] = 0;\n    }\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void GetApproximateSizes(const Range* r, int n, uint64_t* sizes) {\n      for (int i = 0; i < n; i++) {\n        sizes[i] = 0;\n      }\n    }\n}"
  },
  {
    "function_name": "GetProperty",
    "container": "ModelDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1887-1889",
    "snippet": "virtual bool GetProperty(const Slice& property, std::string* value) {\n    return false;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual bool GetProperty(const Slice& property, std::string* value) {\n      return false;\n    }\n}"
  },
  {
    "function_name": "Write",
    "container": "ModelDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1871-1885",
    "snippet": "virtual Status Write(const WriteOptions& options, WriteBatch* batch) {\n    class Handler : public WriteBatch::Handler {\n     public:\n      KVMap* map_;\n      virtual void Put(const Slice& key, const Slice& value) {\n        (*map_)[key.ToString()] = value.ToString();\n      }\n      virtual void Delete(const Slice& key) {\n        map_->erase(key.ToString());\n      }\n    };\n    Handler handler;\n    handler.map_ = &map_;\n    return batch->Iterate(&handler);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "batch->Iterate",
          "args": [
            "&handler"
          ],
          "line": 1884
        },
        "resolved": true,
        "details": {
          "function_name": "Iterate",
          "container": "WriteBatch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "42-80",
          "snippet": "Status WriteBatch::Iterate(Handler* handler) const {\n  Slice input(rep_);\n  if (input.size() < kHeader) {\n    return Status::Corruption(\"malformed WriteBatch (too small)\");\n  }\n\n  input.remove_prefix(kHeader);\n  Slice key, value;\n  int found = 0;\n  while (!input.empty()) {\n    found++;\n    char tag = input[0];\n    input.remove_prefix(1);\n    switch (tag) {\n      case kTypeValue:\n        if (GetLengthPrefixedSlice(&input, &key) &&\n            GetLengthPrefixedSlice(&input, &value)) {\n          handler->Put(key, value);\n        } else {\n          return Status::Corruption(\"bad WriteBatch Put\");\n        }\n        break;\n      case kTypeDeletion:\n        if (GetLengthPrefixedSlice(&input, &key)) {\n          handler->Delete(key);\n        } else {\n          return Status::Corruption(\"bad WriteBatch Delete\");\n        }\n        break;\n      default:\n        return Status::Corruption(\"unknown WriteBatch tag\");\n    }\n  }\n  if (found != WriteBatchInternal::Count(this)) {\n    return Status::Corruption(\"WriteBatch has wrong count\");\n  } else {\n    return Status::OK();\n  }\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatch {\n  Status WriteBatch::Iterate(Handler* handler) const {\n    Slice input(rep_);\n    if (input.size() < kHeader) {\n      return Status::Corruption(\"malformed WriteBatch (too small)\");\n    }\n  \n    input.remove_prefix(kHeader);\n    Slice key, value;\n    int found = 0;\n    while (!input.empty()) {\n      found++;\n      char tag = input[0];\n      input.remove_prefix(1);\n      switch (tag) {\n        case kTypeValue:\n          if (GetLengthPrefixedSlice(&input, &key) &&\n              GetLengthPrefixedSlice(&input, &value)) {\n            handler->Put(key, value);\n          } else {\n            return Status::Corruption(\"bad WriteBatch Put\");\n          }\n          break;\n        case kTypeDeletion:\n          if (GetLengthPrefixedSlice(&input, &key)) {\n            handler->Delete(key);\n          } else {\n            return Status::Corruption(\"bad WriteBatch Delete\");\n          }\n          break;\n        default:\n          return Status::Corruption(\"unknown WriteBatch tag\");\n      }\n    }\n    if (found != WriteBatchInternal::Count(this)) {\n      return Status::Corruption(\"WriteBatch has wrong count\");\n    } else {\n      return Status::OK();\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "map_->erase",
          "args": [
            "key.ToString()"
          ],
          "line": 1879
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "49-65",
          "snippet": "void erase(const key_type& k)\n    {\n        iterator itTarget = map.find(k);\n        if (itTarget == map.end())\n            return;\n        std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n        for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n            if (it->second == itTarget)\n            {\n                rmap.erase(it);\n                map.erase(itTarget);\n                return;\n            }\n        // Shouldn't ever get here\n        assert(0); //TODO remove me\n        map.erase(itTarget);\n    }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  void erase(const key_type& k)\n      {\n          iterator itTarget = map.find(k);\n          if (itTarget == map.end())\n              return;\n          std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n          for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n              if (it->second == itTarget)\n              {\n                  rmap.erase(it);\n                  map.erase(itTarget);\n                  return;\n              }\n          // Shouldn't ever get here\n          assert(0); //TODO remove me\n          map.erase(itTarget);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "key.ToString",
          "args": [],
          "line": 1879
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Write(const WriteOptions& options, WriteBatch* batch) {\n      class Handler : public WriteBatch::Handler {\n       public:\n        KVMap* map_;\n        virtual void Put(const Slice& key, const Slice& value) {\n          (*map_)[key.ToString()] = value.ToString();\n        }\n        virtual void Delete(const Slice& key) {\n          map_->erase(key.ToString());\n        }\n      };\n      Handler handler;\n      handler.map_ = &map_;\n      return batch->Iterate(&handler);\n    }\n}"
  },
  {
    "function_name": "ReleaseSnapshot",
    "container": "ModelDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1868-1870",
    "snippet": "virtual void ReleaseSnapshot(const Snapshot* snapshot) {\n    delete reinterpret_cast<const ModelSnapshot*>(snapshot);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reinterpret_cast<const ModelSnapshot*>",
          "args": [
            "snapshot"
          ],
          "line": 1869
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void ReleaseSnapshot(const Snapshot* snapshot) {\n      delete reinterpret_cast<const ModelSnapshot*>(snapshot);\n    }\n}"
  },
  {
    "function_name": "Get",
    "container": "ModelDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1846-1850",
    "snippet": "virtual Status Get(const ReadOptions& options,\n                     const Slice& key, std::string* value) {\n    assert(false);      // Not implemented\n    return Status::NotFound(key);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::NotFound",
          "args": [
            "key"
          ],
          "line": 1849
        },
        "resolved": true,
        "details": {
          "function_name": "NotFound",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "35-37",
          "snippet": "static Status NotFound(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kNotFound, msg, msg2);\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status NotFound(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kNotFound, msg, msg2);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "false"
          ],
          "line": 1848
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Get(const ReadOptions& options,\n                       const Slice& key, std::string* value) {\n      assert(false);      // Not implemented\n      return Status::NotFound(key);\n    }\n}"
  },
  {
    "function_name": "Delete",
    "container": "ModelDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1843-1845",
    "snippet": "virtual Status Delete(const WriteOptions& o, const Slice& key) {\n    return DB::Delete(o, key);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DB::Delete",
          "args": [
            "o",
            "key"
          ],
          "line": 1844
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1843-1845",
          "snippet": "virtual Status Delete(const WriteOptions& o, const Slice& key) {\n    return DB::Delete(o, key);\n  }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Delete(const WriteOptions& o, const Slice& key) {\n      return DB::Delete(o, key);\n    }\n}"
  },
  {
    "function_name": "Put",
    "container": "ModelDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1840-1842",
    "snippet": "virtual Status Put(const WriteOptions& o, const Slice& k, const Slice& v) {\n    return DB::Put(o, k, v);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DB::Put",
          "args": [
            "o",
            "k",
            "v"
          ],
          "line": 1841
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1840-1842",
          "snippet": "virtual Status Put(const WriteOptions& o, const Slice& k, const Slice& v) {\n    return DB::Put(o, k, v);\n  }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Put(const WriteOptions& o, const Slice& k, const Slice& v) {\n      return DB::Put(o, k, v);\n    }\n}"
  },
  {
    "function_name": "ModelDB",
    "container": "ModelDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1838-1838",
    "snippet": "explicit ModelDB(const Options& options): options_(options) { }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  explicit ModelDB(const Options& options): options_(options) { }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1795-1825",
    "snippet": "TEST(DBTest, MultiThreaded) {\n  do {\n    // Initialize state\n    MTState mt;\n    mt.test = this;\n    mt.stop.Release_Store(0);\n    for (int id = 0; id < kNumThreads; id++) {\n      mt.counter[id].Release_Store(0);\n      mt.thread_done[id].Release_Store(0);\n    }\n\n    // Start threads\n    MTThread thread[kNumThreads];\n    for (int id = 0; id < kNumThreads; id++) {\n      thread[id].state = &mt;\n      thread[id].id = id;\n      env_->StartThread(MTThreadBody, &thread[id]);\n    }\n\n    // Let them run for a while\n    DelayMilliseconds(kTestSeconds * 1000);\n\n    // Stop the threads and wait for them to finish\n    mt.stop.Release_Store(&mt);\n    for (int id = 0; id < kNumThreads; id++) {\n      while (mt.thread_done[id].Acquire_Load() == NULL) {\n        DelayMilliseconds(100);\n      }\n    }\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 1824
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DelayMilliseconds",
          "args": [
            "100"
          ],
          "line": 1821
        },
        "resolved": true,
        "details": {
          "function_name": "DelayMilliseconds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "52-54",
          "snippet": "void DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nvoid DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mt.thread_done[id].Acquire_Load",
          "args": [],
          "line": 1820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mt.stop.Release_Store",
          "args": [
            "&mt"
          ],
          "line": 1818
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "env_->StartThread",
          "args": [
            "MTThreadBody",
            "&thread[id]"
          ],
          "line": 1811
        },
        "resolved": true,
        "details": {
          "function_name": "StartThread",
          "container": "Win32Env",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "885-888",
          "snippet": "void Win32Env::StartThread( void (*function)(void* arg), void* arg )\n{\n    ::_beginthread(function,0,arg);\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  void Win32Env::StartThread( void (*function)(void* arg), void* arg )\n  {\n      ::_beginthread(function,0,arg);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, MultiThreaded) {\n  do {\n    // Initialize state\n    MTState mt;\n    mt.test = this;\n    mt.stop.Release_Store(0);\n    for (int id = 0; id < kNumThreads; id++) {\n      mt.counter[id].Release_Store(0);\n      mt.thread_done[id].Release_Store(0);\n    }\n\n    // Start threads\n    MTThread thread[kNumThreads];\n    for (int id = 0; id < kNumThreads; id++) {\n      thread[id].state = &mt;\n      thread[id].id = id;\n      env_->StartThread(MTThreadBody, &thread[id]);\n    }\n\n    // Let them run for a while\n    DelayMilliseconds(kTestSeconds * 1000);\n\n    // Stop the threads and wait for them to finish\n    mt.stop.Release_Store(&mt);\n    for (int id = 0; id < kNumThreads; id++) {\n      while (mt.thread_done[id].Acquire_Load() == NULL) {\n        DelayMilliseconds(100);\n      }\n    }\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "MTThreadBody",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1748-1791",
    "snippet": "static void MTThreadBody(void* arg) {\n  MTThread* t = reinterpret_cast<MTThread*>(arg);\n  int id = t->id;\n  DB* db = t->state->test->db_;\n  uintptr_t counter = 0;\n  fprintf(stderr, \"... starting thread %d\\n\", id);\n  Random rnd(1000 + id);\n  std::string value;\n  char valbuf[1500];\n  while (t->state->stop.Acquire_Load() == NULL) {\n    t->state->counter[id].Release_Store(reinterpret_cast<void*>(counter));\n\n    int key = rnd.Uniform(kNumKeys);\n    char keybuf[20];\n    snprintf(keybuf, sizeof(keybuf), \"%016d\", key);\n\n    if (rnd.OneIn(2)) {\n      // Write values of the form <key, my id, counter>.\n      // We add some padding for force compactions.\n      snprintf(valbuf, sizeof(valbuf), \"%d.%d.%-1000d\",\n               key, id, static_cast<int>(counter));\n      ASSERT_OK(db->Put(WriteOptions(), Slice(keybuf), Slice(valbuf)));\n    } else {\n      // Read a value and verify that it matches the pattern written above.\n      Status s = db->Get(ReadOptions(), Slice(keybuf), &value);\n      if (s.IsNotFound()) {\n        // Key has not yet been written\n      } else {\n        // Check that the writer thread counter is >= the counter in the value\n        ASSERT_OK(s);\n        int k, w, c;\n        ASSERT_EQ(3, sscanf(value.c_str(), \"%d.%d.%d\", &k, &w, &c)) << value;\n        ASSERT_EQ(k, key);\n        ASSERT_GE(w, 0);\n        ASSERT_LT(w, kNumThreads);\n        ASSERT_LE(static_cast<uintptr_t>(c), reinterpret_cast<uintptr_t>(\n            t->state->counter[w].Acquire_Load()));\n      }\n    }\n    counter++;\n  }\n  t->state->thread_done[id].Release_Store(t);\n  fprintf(stderr, \"... stopping thread %d after %d ops\\n\", id, int(counter));\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"... stopping thread %d after %d ops\\n\"",
            "id",
            "int(counter)"
          ],
          "line": 1790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "int",
          "args": [
            "counter"
          ],
          "line": 1790
        },
        "resolved": true,
        "details": {
          "function_name": "VersionEditPrinter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/leveldb_main.cc",
          "lines": "110-118",
          "snippet": "static void VersionEditPrinter(Slice record) {\n  VersionEdit edit;\n  Status s = edit.DecodeFrom(record);\n  if (!s.ok()) {\n    printf(\"%s\\n\", s.ToString().c_str());\n    return;\n  }\n  printf(\"%s\", edit.DebugString().c_str());\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_edit.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/write_batch.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_edit.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nstatic void VersionEditPrinter(Slice record) {\n  VersionEdit edit;\n  Status s = edit.DecodeFrom(record);\n  if (!s.ok()) {\n    printf(\"%s\\n\", s.ToString().c_str());\n    return;\n  }\n  printf(\"%s\", edit.DebugString().c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "t->state->thread_done[id].Release_Store",
          "args": [
            "t"
          ],
          "line": 1789
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "static_cast<uintptr_t>(c)",
            "reinterpret_cast<uintptr_t>(\n            t->state->counter[w].Acquire_Load())"
          ],
          "line": 1783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<uintptr_t>",
          "args": [
            "t->state->counter[w].Acquire_Load()"
          ],
          "line": 1783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->state->counter[w].Acquire_Load",
          "args": [],
          "line": 1784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<uintptr_t>",
          "args": [
            "c"
          ],
          "line": 1783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LT",
          "args": [
            "w",
            "kNumThreads"
          ],
          "line": 1782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_GE",
          "args": [
            "w",
            "0"
          ],
          "line": 1781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "k",
            "key"
          ],
          "line": 1780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "3",
            "sscanf(value.c_str(), \"%d.%d.%d\", &k, &w, &c)"
          ],
          "line": 1779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "value.c_str()",
            "\"%d.%d.%d\"",
            "&k",
            "&w",
            "&c"
          ],
          "line": 1779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.c_str",
          "args": [],
          "line": 1779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "s"
          ],
          "line": 1777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.IsNotFound",
          "args": [],
          "line": 1773
        },
        "resolved": true,
        "details": {
          "function_name": "IsNotFound",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "55-55",
          "snippet": "bool IsNotFound() const { return code() == kNotFound; }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool IsNotFound() const { return code() == kNotFound; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db->Get",
          "args": [
            "ReadOptions()",
            "Slice(keybuf)",
            "&value"
          ],
          "line": 1772
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1846-1850",
          "snippet": "virtual Status Get(const ReadOptions& options,\n                     const Slice& key, std::string* value) {\n    assert(false);      // Not implemented\n    return Status::NotFound(key);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Get(const ReadOptions& options,\n                       const Slice& key, std::string* value) {\n      assert(false);      // Not implemented\n      return Status::NotFound(key);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "keybuf"
          ],
          "line": 1772
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/memtable.cc",
          "lines": "14-19",
          "snippet": "static Slice GetLengthPrefixedSlice(const char* data) {\n  uint32_t len;\n  const char* p = data;\n  p = GetVarint32Ptr(p, p + 5, &len);  // +5: we assume \"p\" is not corrupted\n  return Slice(p, len);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/memtable.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/comparator.h\"\n#include \"db/dbformat.h\"\n#include \"db/memtable.h\"\n\nstatic Slice GetLengthPrefixedSlice(const char* data) {\n  uint32_t len;\n  const char* p = data;\n  p = GetVarint32Ptr(p, p + 5, &len);  // +5: we assume \"p\" is not corrupted\n  return Slice(p, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ReadOptions",
          "args": [],
          "line": 1772
        },
        "resolved": true,
        "details": {
          "function_name": "ReadOptions",
          "container": "ReadOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "161-165",
          "snippet": "ReadOptions()\n      : verify_checksums(false),\n        fill_cache(true),\n        snapshot(NULL) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nReadOptions {\n  ReadOptions()\n        : verify_checksums(false),\n          fill_cache(true),\n          snapshot(NULL) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "db->Put(WriteOptions(), Slice(keybuf), Slice(valbuf))"
          ],
          "line": 1769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db->Put",
          "args": [
            "WriteOptions()",
            "Slice(keybuf)",
            "Slice(valbuf)"
          ],
          "line": 1769
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1840-1842",
          "snippet": "virtual Status Put(const WriteOptions& o, const Slice& k, const Slice& v) {\n    return DB::Put(o, k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Put(const WriteOptions& o, const Slice& k, const Slice& v) {\n      return DB::Put(o, k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WriteOptions",
          "args": [],
          "line": 1769
        },
        "resolved": true,
        "details": {
          "function_name": "WriteOptions",
          "container": "WriteOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "188-190",
          "snippet": "WriteOptions()\n      : sync(false) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nWriteOptions {\n  WriteOptions()\n        : sync(false) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "valbuf",
            "sizeof(valbuf)",
            "\"%d.%d.%-1000d\"",
            "key",
            "id",
            "static_cast<int>(counter)"
          ],
          "line": 1767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "counter"
          ],
          "line": 1768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rnd.OneIn",
          "args": [
            "2"
          ],
          "line": 1764
        },
        "resolved": true,
        "details": {
          "function_name": "OneIn",
          "container": "Random",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/random.h",
          "lines": "52-52",
          "snippet": "bool OneIn(int n) { return (Next() % n) == 0; }",
          "includes": [
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n\nRandom {\n  bool OneIn(int n) { return (Next() % n) == 0; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "keybuf",
            "sizeof(keybuf)",
            "\"%016d\"",
            "key"
          ],
          "line": 1762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rnd.Uniform",
          "args": [
            "kNumKeys"
          ],
          "line": 1760
        },
        "resolved": true,
        "details": {
          "function_name": "Uniform",
          "container": "Random",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/random.h",
          "lines": "48-48",
          "snippet": "uint32_t Uniform(int n) { return Next() % n; }",
          "includes": [
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n\nRandom {\n  uint32_t Uniform(int n) { return Next() % n; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<void*>",
          "args": [
            "counter"
          ],
          "line": 1758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->state->stop.Acquire_Load",
          "args": [],
          "line": 1757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"... starting thread %d\\n\"",
            "id"
          ],
          "line": 1753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<MTThread*>",
          "args": [
            "arg"
          ],
          "line": 1749
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic void MTThreadBody(void* arg) {\n  MTThread* t = reinterpret_cast<MTThread*>(arg);\n  int id = t->id;\n  DB* db = t->state->test->db_;\n  uintptr_t counter = 0;\n  fprintf(stderr, \"... starting thread %d\\n\", id);\n  Random rnd(1000 + id);\n  std::string value;\n  char valbuf[1500];\n  while (t->state->stop.Acquire_Load() == NULL) {\n    t->state->counter[id].Release_Store(reinterpret_cast<void*>(counter));\n\n    int key = rnd.Uniform(kNumKeys);\n    char keybuf[20];\n    snprintf(keybuf, sizeof(keybuf), \"%016d\", key);\n\n    if (rnd.OneIn(2)) {\n      // Write values of the form <key, my id, counter>.\n      // We add some padding for force compactions.\n      snprintf(valbuf, sizeof(valbuf), \"%d.%d.%-1000d\",\n               key, id, static_cast<int>(counter));\n      ASSERT_OK(db->Put(WriteOptions(), Slice(keybuf), Slice(valbuf)));\n    } else {\n      // Read a value and verify that it matches the pattern written above.\n      Status s = db->Get(ReadOptions(), Slice(keybuf), &value);\n      if (s.IsNotFound()) {\n        // Key has not yet been written\n      } else {\n        // Check that the writer thread counter is >= the counter in the value\n        ASSERT_OK(s);\n        int k, w, c;\n        ASSERT_EQ(3, sscanf(value.c_str(), \"%d.%d.%d\", &k, &w, &c)) << value;\n        ASSERT_EQ(k, key);\n        ASSERT_GE(w, 0);\n        ASSERT_LT(w, kNumThreads);\n        ASSERT_LE(static_cast<uintptr_t>(c), reinterpret_cast<uintptr_t>(\n            t->state->counter[w].Acquire_Load()));\n      }\n    }\n    counter++;\n  }\n  t->state->thread_done[id].Release_Store(t);\n  fprintf(stderr, \"... stopping thread %d after %d ops\\n\", id, int(counter));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1682-1727",
    "snippet": "TEST(DBTest, BloomFilter) {\n  env_->count_random_reads_ = true;\n  Options options = CurrentOptions();\n  options.env = env_;\n  options.block_cache = NewLRUCache(0);  // Prevent cache hits\n  options.filter_policy = NewBloomFilterPolicy(10);\n  Reopen(&options);\n\n  // Populate multiple layers\n  const int N = 10000;\n  for (int i = 0; i < N; i++) {\n    ASSERT_OK(Put(Key(i), Key(i)));\n  }\n  Compact(\"a\", \"z\");\n  for (int i = 0; i < N; i += 100) {\n    ASSERT_OK(Put(Key(i), Key(i)));\n  }\n  dbfull()->TEST_CompactMemTable();\n\n  // Prevent auto compactions triggered by seeks\n  env_->delay_data_sync_.Release_Store(env_);\n\n  // Lookup present keys.  Should rarely read from small sstable.\n  env_->random_read_counter_.Reset();\n  for (int i = 0; i < N; i++) {\n    ASSERT_EQ(Key(i), Get(Key(i)));\n  }\n  int reads = env_->random_read_counter_.Read();\n  fprintf(stderr, \"%d present => %d reads\\n\", N, reads);\n  ASSERT_GE(reads, N);\n  ASSERT_LE(reads, N + 2*N/100);\n\n  // Lookup present keys.  Should rarely read from either sstable.\n  env_->random_read_counter_.Reset();\n  for (int i = 0; i < N; i++) {\n    ASSERT_EQ(\"NOT_FOUND\", Get(Key(i) + \".missing\"));\n  }\n  reads = env_->random_read_counter_.Read();\n  fprintf(stderr, \"%d missing => %d reads\\n\", N, reads);\n  ASSERT_LE(reads, 3*N/100);\n\n  env_->delay_data_sync_.Release_Store(NULL);\n  Close();\n  delete options.block_cache;\n  delete options.filter_policy;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Close",
          "args": [],
          "line": 1724
        },
        "resolved": true,
        "details": {
          "function_name": "Close",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "261-264",
          "snippet": "void Close() {\n    delete db_;\n    db_ = NULL;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void Close() {\n      delete db_;\n      db_ = NULL;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "env_->delay_data_sync_.Release_Store",
          "args": [
            "NULL"
          ],
          "line": 1723
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "reads",
            "3*N/100"
          ],
          "line": 1721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%d missing => %d reads\\n\"",
            "N",
            "reads"
          ],
          "line": 1720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "env_->random_read_counter_.Read",
          "args": [],
          "line": 1719
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "AtomicCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "42-45",
          "snippet": "int Read() {\n    MutexLock l(&mu_);\n    return count_;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nAtomicCounter {\n  int Read() {\n      MutexLock l(&mu_);\n      return count_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"NOT_FOUND\"",
            "Get(Key(i) + \".missing\")"
          ],
          "line": 1717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "Key(i) + \".missing\""
          ],
          "line": 1717
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Key",
          "args": [
            "i"
          ],
          "line": 1717
        },
        "resolved": true,
        "details": {
          "function_name": "MakeKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "2059-2063",
          "snippet": "std::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstd::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "env_->random_read_counter_.Reset",
          "args": [],
          "line": 1715
        },
        "resolved": true,
        "details": {
          "function_name": "Reset",
          "container": "AtomicCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "46-49",
          "snippet": "void Reset() {\n    MutexLock l(&mu_);\n    count_ = 0;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nAtomicCounter {\n  void Reset() {\n      MutexLock l(&mu_);\n      count_ = 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "reads",
            "N + 2*N/100"
          ],
          "line": 1712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_GE",
          "args": [
            "reads",
            "N"
          ],
          "line": 1711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%d present => %d reads\\n\"",
            "N",
            "reads"
          ],
          "line": 1710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "Key(i)",
            "Get(Key(i))"
          ],
          "line": 1707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(i), Key(i))"
          ],
          "line": 1697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "Key(i)",
            "Key(i)"
          ],
          "line": 1697
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Compact",
          "args": [
            "\"a\"",
            "\"z\""
          ],
          "line": 1695
        },
        "resolved": true,
        "details": {
          "function_name": "CompactRange",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1895-1896",
          "snippet": "virtual void CompactRange(const Slice* start, const Slice* end) {\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void CompactRange(const Slice* start, const Slice* end) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(i), Key(i))"
          ],
          "line": 1693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 1688
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "NewBloomFilterPolicy",
          "args": [
            "10"
          ],
          "line": 1687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NewLRUCache",
          "args": [
            "0"
          ],
          "line": 1686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 1684
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, BloomFilter) {\n  env_->count_random_reads_ = true;\n  Options options = CurrentOptions();\n  options.env = env_;\n  options.block_cache = NewLRUCache(0);  // Prevent cache hits\n  options.filter_policy = NewBloomFilterPolicy(10);\n  Reopen(&options);\n\n  // Populate multiple layers\n  const int N = 10000;\n  for (int i = 0; i < N; i++) {\n    ASSERT_OK(Put(Key(i), Key(i)));\n  }\n  Compact(\"a\", \"z\");\n  for (int i = 0; i < N; i += 100) {\n    ASSERT_OK(Put(Key(i), Key(i)));\n  }\n  dbfull()->TEST_CompactMemTable();\n\n  // Prevent auto compactions triggered by seeks\n  env_->delay_data_sync_.Release_Store(env_);\n\n  // Lookup present keys.  Should rarely read from small sstable.\n  env_->random_read_counter_.Reset();\n  for (int i = 0; i < N; i++) {\n    ASSERT_EQ(Key(i), Get(Key(i)));\n  }\n  int reads = env_->random_read_counter_.Read();\n  fprintf(stderr, \"%d present => %d reads\\n\", N, reads);\n  ASSERT_GE(reads, N);\n  ASSERT_LE(reads, N + 2*N/100);\n\n  // Lookup present keys.  Should rarely read from either sstable.\n  env_->random_read_counter_.Reset();\n  for (int i = 0; i < N; i++) {\n    ASSERT_EQ(\"NOT_FOUND\", Get(Key(i) + \".missing\"));\n  }\n  reads = env_->random_read_counter_.Read();\n  fprintf(stderr, \"%d missing => %d reads\\n\", N, reads);\n  ASSERT_LE(reads, 3*N/100);\n\n  env_->delay_data_sync_.Release_Store(NULL);\n  Close();\n  delete options.block_cache;\n  delete options.filter_policy;\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1671-1680",
    "snippet": "TEST(DBTest, FilesDeletedAfterCompaction) {\n  ASSERT_OK(Put(\"foo\", \"v2\"));\n  Compact(\"a\", \"z\");\n  const int num_files = CountFiles();\n  for (int i = 0; i < 10; i++) {\n    ASSERT_OK(Put(\"foo\", \"v2\"));\n    Compact(\"a\", \"z\");\n  }\n  ASSERT_EQ(CountFiles(), num_files);\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "CountFiles()",
            "num_files"
          ],
          "line": 1679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CountFiles",
          "args": [],
          "line": 1679
        },
        "resolved": true,
        "details": {
          "function_name": "CountFiles",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "411-415",
          "snippet": "int CountFiles() {\n    std::vector<std::string> files;\n    env_->GetChildren(dbname_, &files);\n    return static_cast<int>(files.size());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int CountFiles() {\n      std::vector<std::string> files;\n      env_->GetChildren(dbname_, &files);\n      return static_cast<int>(files.size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Compact",
          "args": [
            "\"a\"",
            "\"z\""
          ],
          "line": 1677
        },
        "resolved": true,
        "details": {
          "function_name": "CompactRange",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1895-1896",
          "snippet": "virtual void CompactRange(const Slice* start, const Slice* end) {\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void CompactRange(const Slice* start, const Slice* end) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v2\")"
          ],
          "line": 1676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"v2\""
          ],
          "line": 1676
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v2\")"
          ],
          "line": 1672
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, FilesDeletedAfterCompaction) {\n  ASSERT_OK(Put(\"foo\", \"v2\"));\n  Compact(\"a\", \"z\");\n  const int num_files = CountFiles();\n  for (int i = 0; i < 10; i++) {\n    ASSERT_OK(Put(\"foo\", \"v2\"));\n    Compact(\"a\", \"z\");\n  }\n  ASSERT_EQ(CountFiles(), num_files);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1655-1669",
    "snippet": "TEST(DBTest, StillReadSST) {\n  ASSERT_OK(Put(\"foo\", \"bar\"));\n  ASSERT_EQ(\"bar\", Get(\"foo\"));\n\n  // Dump the memtable to disk.\n  dbfull()->TEST_CompactMemTable();\n  ASSERT_EQ(\"bar\", Get(\"foo\"));\n  Close();\n  ASSERT_GT(RenameLDBToSST(), 0);\n  Options options = CurrentOptions();\n  options.paranoid_checks = true;\n  Status s = TryReopen(&options);\n  ASSERT_TRUE(s.ok());\n  ASSERT_EQ(\"bar\", Get(\"foo\"));\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Get(\"foo\")"
          ],
          "line": 1668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\""
          ],
          "line": 1668
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "s.ok()"
          ],
          "line": 1667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 1667
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TryReopen",
          "args": [
            "&options"
          ],
          "line": 1666
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 1664
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_GT",
          "args": [
            "RenameLDBToSST()",
            "0"
          ],
          "line": 1663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RenameLDBToSST",
          "args": [],
          "line": 1663
        },
        "resolved": true,
        "details": {
          "function_name": "RenameLDBToSST",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "488-503",
          "snippet": "int RenameLDBToSST() {\n    std::vector<std::string> filenames;\n    ASSERT_OK(env_->GetChildren(dbname_, &filenames));\n    uint64_t number;\n    FileType type;\n    int files_renamed = 0;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) && type == kTableFile) {\n        const std::string from = TableFileName(dbname_, number);\n        const std::string to = SSTTableFileName(dbname_, number);\n        ASSERT_OK(env_->RenameFile(from, to));\n        files_renamed++;\n      }\n    }\n    return files_renamed;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int RenameLDBToSST() {\n      std::vector<std::string> filenames;\n      ASSERT_OK(env_->GetChildren(dbname_, &filenames));\n      uint64_t number;\n      FileType type;\n      int files_renamed = 0;\n      for (size_t i = 0; i < filenames.size(); i++) {\n        if (ParseFileName(filenames[i], &number, &type) && type == kTableFile) {\n          const std::string from = TableFileName(dbname_, number);\n          const std::string to = SSTTableFileName(dbname_, number);\n          ASSERT_OK(env_->RenameFile(from, to));\n          files_renamed++;\n        }\n      }\n      return files_renamed;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Close",
          "args": [],
          "line": 1662
        },
        "resolved": true,
        "details": {
          "function_name": "Close",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "261-264",
          "snippet": "void Close() {\n    delete db_;\n    db_ = NULL;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void Close() {\n      delete db_;\n      db_ = NULL;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Get(\"foo\")"
          ],
          "line": 1661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Get(\"foo\")"
          ],
          "line": 1657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"bar\")"
          ],
          "line": 1656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"bar\""
          ],
          "line": 1656
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, StillReadSST) {\n  ASSERT_OK(Put(\"foo\", \"bar\"));\n  ASSERT_EQ(\"bar\", Get(\"foo\"));\n\n  // Dump the memtable to disk.\n  dbfull()->TEST_CompactMemTable();\n  ASSERT_EQ(\"bar\", Get(\"foo\"));\n  Close();\n  ASSERT_GT(RenameLDBToSST(), 0);\n  Options options = CurrentOptions();\n  options.paranoid_checks = true;\n  Status s = TryReopen(&options);\n  ASSERT_TRUE(s.ok());\n  ASSERT_EQ(\"bar\", Get(\"foo\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1637-1653",
    "snippet": "TEST(DBTest, MissingSSTFile) {\n  ASSERT_OK(Put(\"foo\", \"bar\"));\n  ASSERT_EQ(\"bar\", Get(\"foo\"));\n\n  // Dump the memtable to disk.\n  dbfull()->TEST_CompactMemTable();\n  ASSERT_EQ(\"bar\", Get(\"foo\"));\n\n  Close();\n  ASSERT_TRUE(DeleteAnSSTFile());\n  Options options = CurrentOptions();\n  options.paranoid_checks = true;\n  Status s = TryReopen(&options);\n  ASSERT_TRUE(!s.ok());\n  ASSERT_TRUE(s.ToString().find(\"issing\") != std::string::npos)\n      << s.ToString();\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s.ToString",
          "args": [],
          "line": 1652
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CUnsignedSyncCheckpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/checkpoints.h",
          "lines": "89-98",
          "snippet": "std::string ToString() const\n    {\n        return strprintf(\n                \"CSyncCheckpoint(\\n\"\n                \"    nVersion       = %d\\n\"\n                \"    hashCheckpoint = %s\\n\"\n                \")\\n\",\n            nVersion,\n            hashCheckpoint.ToString().c_str());\n    }",
          "includes": [
            "#include \"util.h\"",
            "#include \"net.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"net.h\"\n#include <map>\n\nCUnsignedSyncCheckpoint {\n  std::string ToString() const\n      {\n          return strprintf(\n                  \"CSyncCheckpoint(\\n\"\n                  \"    nVersion       = %d\\n\"\n                  \"    hashCheckpoint = %s\\n\"\n                  \")\\n\",\n              nVersion,\n              hashCheckpoint.ToString().c_str());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "s.ToString().find(\"issing\") != std::string::npos"
          ],
          "line": 1651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ToString",
          "args": [
            "\"issing\""
          ],
          "line": 1651
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "604-610",
          "snippet": "std::string ToString(const Iterator* it) {\n    if (!it->Valid()) {\n      return \"END\";\n    } else {\n      return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string ToString(const Iterator* it) {\n      if (!it->Valid()) {\n        return \"END\";\n      } else {\n        return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!s.ok()"
          ],
          "line": 1650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 1650
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TryReopen",
          "args": [
            "&options"
          ],
          "line": 1649
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 1647
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "DeleteAnSSTFile()"
          ],
          "line": 1646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DeleteAnSSTFile",
          "args": [],
          "line": 1646
        },
        "resolved": true,
        "details": {
          "function_name": "DeleteAnSSTFile",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "473-485",
          "snippet": "bool DeleteAnSSTFile() {\n    std::vector<std::string> filenames;\n    ASSERT_OK(env_->GetChildren(dbname_, &filenames));\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) && type == kTableFile) {\n        ASSERT_OK(env_->DeleteFile(TableFileName(dbname_, number)));\n        return true;\n      }\n    }\n    return false;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool DeleteAnSSTFile() {\n      std::vector<std::string> filenames;\n      ASSERT_OK(env_->GetChildren(dbname_, &filenames));\n      uint64_t number;\n      FileType type;\n      for (size_t i = 0; i < filenames.size(); i++) {\n        if (ParseFileName(filenames[i], &number, &type) && type == kTableFile) {\n          ASSERT_OK(env_->DeleteFile(TableFileName(dbname_, number)));\n          return true;\n        }\n      }\n      return false;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Close",
          "args": [],
          "line": 1645
        },
        "resolved": true,
        "details": {
          "function_name": "Close",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "261-264",
          "snippet": "void Close() {\n    delete db_;\n    db_ = NULL;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void Close() {\n      delete db_;\n      db_ = NULL;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Get(\"foo\")"
          ],
          "line": 1643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\""
          ],
          "line": 1643
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Get(\"foo\")"
          ],
          "line": 1639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"bar\")"
          ],
          "line": 1638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"bar\""
          ],
          "line": 1638
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, MissingSSTFile) {\n  ASSERT_OK(Put(\"foo\", \"bar\"));\n  ASSERT_EQ(\"bar\", Get(\"foo\"));\n\n  // Dump the memtable to disk.\n  dbfull()->TEST_CompactMemTable();\n  ASSERT_EQ(\"bar\", Get(\"foo\"));\n\n  Close();\n  ASSERT_TRUE(DeleteAnSSTFile());\n  Options options = CurrentOptions();\n  options.paranoid_checks = true;\n  Status s = TryReopen(&options);\n  ASSERT_TRUE(!s.ok());\n  ASSERT_TRUE(s.ToString().find(\"issing\") != std::string::npos)\n      << s.ToString();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1596-1635",
    "snippet": "TEST(DBTest, ManifestWriteError) {\n  // Test for the following problem:\n  // (a) Compaction produces file F\n  // (b) Log record containing F is written to MANIFEST file, but Sync() fails\n  // (c) GC deletes F\n  // (d) After reopening DB, reads fail since deleted F is named in log record\n\n  // We iterate twice.  In the second iteration, everything is the\n  // same except the log record never makes it to the MANIFEST file.\n  for (int iter = 0; iter < 2; iter++) {\n    port::AtomicPointer* error_type = (iter == 0)\n        ? &env_->manifest_sync_error_\n        : &env_->manifest_write_error_;\n\n    // Insert foo=>bar mapping\n    Options options = CurrentOptions();\n    options.env = env_;\n    options.create_if_missing = true;\n    options.error_if_exists = false;\n    DestroyAndReopen(&options);\n    ASSERT_OK(Put(\"foo\", \"bar\"));\n    ASSERT_EQ(\"bar\", Get(\"foo\"));\n\n    // Memtable compaction (will succeed)\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"bar\", Get(\"foo\"));\n    const int last = config::kMaxMemCompactLevel;\n    ASSERT_EQ(NumTableFilesAtLevel(last), 1);   // foo=>bar is now in last level\n\n    // Merging compaction (will fail)\n    error_type->Release_Store(env_);\n    dbfull()->TEST_CompactRange(last, NULL, NULL);  // Should fail\n    ASSERT_EQ(\"bar\", Get(\"foo\"));\n\n    // Recovery: should not lose data\n    error_type->Release_Store(NULL);\n    Reopen(&options);\n    ASSERT_EQ(\"bar\", Get(\"foo\"));\n  }\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Get(\"foo\")"
          ],
          "line": 1633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\""
          ],
          "line": 1633
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 1632
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "error_type->Release_Store",
          "args": [
            "NULL"
          ],
          "line": 1631
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Get(\"foo\")"
          ],
          "line": 1628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "last",
            "NULL",
            "NULL"
          ],
          "line": 1627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(last)",
            "1"
          ],
          "line": 1623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NumTableFilesAtLevel",
          "args": [
            "last"
          ],
          "line": 1623
        },
        "resolved": true,
        "details": {
          "function_name": "NumTableFilesAtLevel",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "378-384",
          "snippet": "int NumTableFilesAtLevel(int level) {\n    std::string property;\n    ASSERT_TRUE(\n        db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                         &property));\n    return atoi(property.c_str());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int NumTableFilesAtLevel(int level) {\n      std::string property;\n      ASSERT_TRUE(\n          db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                           &property));\n      return atoi(property.c_str());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Get(\"foo\")"
          ],
          "line": 1621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "Get(\"foo\")"
          ],
          "line": 1617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"bar\")"
          ],
          "line": 1616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"bar\""
          ],
          "line": 1616
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DestroyAndReopen",
          "args": [
            "&options"
          ],
          "line": 1615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 1611
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, ManifestWriteError) {\n  // Test for the following problem:\n  // (a) Compaction produces file F\n  // (b) Log record containing F is written to MANIFEST file, but Sync() fails\n  // (c) GC deletes F\n  // (d) After reopening DB, reads fail since deleted F is named in log record\n\n  // We iterate twice.  In the second iteration, everything is the\n  // same except the log record never makes it to the MANIFEST file.\n  for (int iter = 0; iter < 2; iter++) {\n    port::AtomicPointer* error_type = (iter == 0)\n        ? &env_->manifest_sync_error_\n        : &env_->manifest_write_error_;\n\n    // Insert foo=>bar mapping\n    Options options = CurrentOptions();\n    options.env = env_;\n    options.create_if_missing = true;\n    options.error_if_exists = false;\n    DestroyAndReopen(&options);\n    ASSERT_OK(Put(\"foo\", \"bar\"));\n    ASSERT_EQ(\"bar\", Get(\"foo\"));\n\n    // Memtable compaction (will succeed)\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"bar\", Get(\"foo\"));\n    const int last = config::kMaxMemCompactLevel;\n    ASSERT_EQ(NumTableFilesAtLevel(last), 1);   // foo=>bar is now in last level\n\n    // Merging compaction (will fail)\n    error_type->Release_Store(env_);\n    dbfull()->TEST_CompactRange(last, NULL, NULL);  // Should fail\n    ASSERT_EQ(\"bar\", Get(\"foo\"));\n\n    // Recovery: should not lose data\n    error_type->Release_Store(NULL);\n    Reopen(&options);\n    ASSERT_EQ(\"bar\", Get(\"foo\"));\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1565-1594",
    "snippet": "TEST(DBTest, WriteSyncError) {\n  // Check that log sync errors cause the DB to disallow future writes.\n\n  // (a) Cause log sync calls to fail\n  Options options = CurrentOptions();\n  options.env = env_;\n  Reopen(&options);\n  env_->data_sync_error_.Release_Store(env_);\n\n  // (b) Normal write should succeed\n  WriteOptions w;\n  ASSERT_OK(db_->Put(w, \"k1\", \"v1\"));\n  ASSERT_EQ(\"v1\", Get(\"k1\"));\n\n  // (c) Do a sync write; should fail\n  w.sync = true;\n  ASSERT_TRUE(!db_->Put(w, \"k2\", \"v2\").ok());\n  ASSERT_EQ(\"v1\", Get(\"k1\"));\n  ASSERT_EQ(\"NOT_FOUND\", Get(\"k2\"));\n\n  // (d) make sync behave normally\n  env_->data_sync_error_.Release_Store(NULL);\n\n  // (e) Do a non-sync write; should fail\n  w.sync = false;\n  ASSERT_TRUE(!db_->Put(w, \"k3\", \"v3\").ok());\n  ASSERT_EQ(\"v1\", Get(\"k1\"));\n  ASSERT_EQ(\"NOT_FOUND\", Get(\"k2\"));\n  ASSERT_EQ(\"NOT_FOUND\", Get(\"k3\"));\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"NOT_FOUND\"",
            "Get(\"k3\")"
          ],
          "line": 1593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"k3\""
          ],
          "line": 1593
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"NOT_FOUND\"",
            "Get(\"k2\")"
          ],
          "line": 1592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"k1\")"
          ],
          "line": 1591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!db_->Put(w, \"k3\", \"v3\").ok()"
          ],
          "line": 1590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->Put",
          "args": [],
          "line": 1590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->Put",
          "args": [
            "w",
            "\"k3\"",
            "\"v3\""
          ],
          "line": 1590
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1840-1842",
          "snippet": "virtual Status Put(const WriteOptions& o, const Slice& k, const Slice& v) {\n    return DB::Put(o, k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Put(const WriteOptions& o, const Slice& k, const Slice& v) {\n      return DB::Put(o, k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "env_->data_sync_error_.Release_Store",
          "args": [
            "NULL"
          ],
          "line": 1586
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"NOT_FOUND\"",
            "Get(\"k2\")"
          ],
          "line": 1583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"k1\")"
          ],
          "line": 1582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!db_->Put(w, \"k2\", \"v2\").ok()"
          ],
          "line": 1581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->Put",
          "args": [],
          "line": 1581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"k1\")"
          ],
          "line": 1577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "db_->Put(w, \"k1\", \"v1\")"
          ],
          "line": 1576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 1571
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 1569
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, WriteSyncError) {\n  // Check that log sync errors cause the DB to disallow future writes.\n\n  // (a) Cause log sync calls to fail\n  Options options = CurrentOptions();\n  options.env = env_;\n  Reopen(&options);\n  env_->data_sync_error_.Release_Store(env_);\n\n  // (b) Normal write should succeed\n  WriteOptions w;\n  ASSERT_OK(db_->Put(w, \"k1\", \"v1\"));\n  ASSERT_EQ(\"v1\", Get(\"k1\"));\n\n  // (c) Do a sync write; should fail\n  w.sync = true;\n  ASSERT_TRUE(!db_->Put(w, \"k2\", \"v2\").ok());\n  ASSERT_EQ(\"v1\", Get(\"k1\"));\n  ASSERT_EQ(\"NOT_FOUND\", Get(\"k2\"));\n\n  // (d) make sync behave normally\n  env_->data_sync_error_.Release_Store(NULL);\n\n  // (e) Do a non-sync write; should fail\n  w.sync = false;\n  ASSERT_TRUE(!db_->Put(w, \"k3\", \"v3\").ok());\n  ASSERT_EQ(\"v1\", Get(\"k1\"));\n  ASSERT_EQ(\"NOT_FOUND\", Get(\"k2\"));\n  ASSERT_EQ(\"NOT_FOUND\", Get(\"k3\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1545-1563",
    "snippet": "TEST(DBTest, NonWritableFileSystem) {\n  Options options = CurrentOptions();\n  options.write_buffer_size = 1000;\n  options.env = env_;\n  Reopen(&options);\n  ASSERT_OK(Put(\"foo\", \"v1\"));\n  env_->non_writable_.Release_Store(env_);  // Force errors for new files\n  std::string big(100000, 'x');\n  int errors = 0;\n  for (int i = 0; i < 20; i++) {\n    fprintf(stderr, \"iter %d; errors %d\\n\", i, errors);\n    if (!Put(\"foo\", big).ok()) {\n      errors++;\n      DelayMilliseconds(100);\n    }\n  }\n  ASSERT_GT(errors, 0);\n  env_->non_writable_.Release_Store(NULL);\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "env_->non_writable_.Release_Store",
          "args": [
            "NULL"
          ],
          "line": 1562
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_GT",
          "args": [
            "errors",
            "0"
          ],
          "line": 1561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DelayMilliseconds",
          "args": [
            "100"
          ],
          "line": 1558
        },
        "resolved": true,
        "details": {
          "function_name": "DelayMilliseconds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "52-54",
          "snippet": "void DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nvoid DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [],
          "line": 1556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "big"
          ],
          "line": 1556
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"iter %d; errors %d\\n\"",
            "i",
            "errors"
          ],
          "line": 1555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v1\")"
          ],
          "line": 1550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 1549
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 1546
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, NonWritableFileSystem) {\n  Options options = CurrentOptions();\n  options.write_buffer_size = 1000;\n  options.env = env_;\n  Reopen(&options);\n  ASSERT_OK(Put(\"foo\", \"v1\"));\n  env_->non_writable_.Release_Store(env_);  // Force errors for new files\n  std::string big(100000, 'x');\n  int errors = 0;\n  for (int i = 0; i < 20; i++) {\n    fprintf(stderr, \"iter %d; errors %d\\n\", i, errors);\n    if (!Put(\"foo\", big).ok()) {\n      errors++;\n      DelayMilliseconds(100);\n    }\n  }\n  ASSERT_GT(errors, 0);\n  env_->non_writable_.Release_Store(NULL);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1526-1543",
    "snippet": "TEST(DBTest, NoSpace) {\n  Options options = CurrentOptions();\n  options.env = env_;\n  Reopen(&options);\n\n  ASSERT_OK(Put(\"foo\", \"v1\"));\n  ASSERT_EQ(\"v1\", Get(\"foo\"));\n  Compact(\"a\", \"z\");\n  const int num_files = CountFiles();\n  env_->no_space_.Release_Store(env_);   // Force out-of-space errors\n  for (int i = 0; i < 10; i++) {\n    for (int level = 0; level < config::kNumLevels-1; level++) {\n      dbfull()->TEST_CompactRange(level, NULL, NULL);\n    }\n  }\n  env_->no_space_.Release_Store(NULL);\n  ASSERT_LT(CountFiles(), num_files + 3);\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_LT",
          "args": [
            "CountFiles()",
            "num_files + 3"
          ],
          "line": 1542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CountFiles",
          "args": [],
          "line": 1542
        },
        "resolved": true,
        "details": {
          "function_name": "CountFiles",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "411-415",
          "snippet": "int CountFiles() {\n    std::vector<std::string> files;\n    env_->GetChildren(dbname_, &files);\n    return static_cast<int>(files.size());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int CountFiles() {\n      std::vector<std::string> files;\n      env_->GetChildren(dbname_, &files);\n      return static_cast<int>(files.size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "env_->no_space_.Release_Store",
          "args": [
            "NULL"
          ],
          "line": 1541
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "level",
            "NULL",
            "NULL"
          ],
          "line": 1538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Compact",
          "args": [
            "\"a\"",
            "\"z\""
          ],
          "line": 1533
        },
        "resolved": true,
        "details": {
          "function_name": "CompactRange",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1895-1896",
          "snippet": "virtual void CompactRange(const Slice* start, const Slice* end) {\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void CompactRange(const Slice* start, const Slice* end) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"foo\")"
          ],
          "line": 1532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\""
          ],
          "line": 1532
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v1\")"
          ],
          "line": 1531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"v1\""
          ],
          "line": 1531
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 1529
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 1527
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, NoSpace) {\n  Options options = CurrentOptions();\n  options.env = env_;\n  Reopen(&options);\n\n  ASSERT_OK(Put(\"foo\", \"v1\"));\n  ASSERT_EQ(\"v1\", Get(\"foo\"));\n  Compact(\"a\", \"z\");\n  const int num_files = CountFiles();\n  env_->no_space_.Release_Store(env_);   // Force out-of-space errors\n  for (int i = 0; i < 10; i++) {\n    for (int level = 0; level < config::kNumLevels-1; level++) {\n      dbfull()->TEST_CompactRange(level, NULL, NULL);\n    }\n  }\n  env_->no_space_.Release_Store(NULL);\n  ASSERT_LT(CountFiles(), num_files + 3);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1519-1523",
    "snippet": "TEST(DBTest, Locking) {\n  DB* db2 = NULL;\n  Status s = DB::Open(CurrentOptions(), dbname_, &db2);\n  ASSERT_TRUE(!s.ok()) << \"Locking did not prevent re-opening db\";\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!s.ok()"
          ],
          "line": 1522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 1522
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DB::Open",
          "args": [
            "CurrentOptions()",
            "dbname_",
            "&db2"
          ],
          "line": 1521
        },
        "resolved": true,
        "details": {
          "function_name": "Open",
          "container": "DB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1445-1477",
          "snippet": "Status DB::Open(const Options& options, const std::string& dbname,\n                DB** dbptr) {\n  *dbptr = NULL;\n\n  DBImpl* impl = new DBImpl(options, dbname);\n  impl->mutex_.Lock();\n  VersionEdit edit;\n  Status s = impl->Recover(&edit); // Handles create_if_missing, error_if_exists\n  if (s.ok()) {\n    uint64_t new_log_number = impl->versions_->NewFileNumber();\n    WritableFile* lfile;\n    s = options.env->NewWritableFile(LogFileName(dbname, new_log_number),\n                                     &lfile);\n    if (s.ok()) {\n      edit.SetLogNumber(new_log_number);\n      impl->logfile_ = lfile;\n      impl->logfile_number_ = new_log_number;\n      impl->log_ = new log::Writer(lfile);\n      s = impl->versions_->LogAndApply(&edit, &impl->mutex_);\n    }\n    if (s.ok()) {\n      impl->DeleteObsoleteFiles();\n      impl->MaybeScheduleCompaction();\n    }\n  }\n  impl->mutex_.Unlock();\n  if (s.ok()) {\n    *dbptr = impl;\n  } else {\n    delete impl;\n  }\n  return s;\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nDB {\n  Status DB::Open(const Options& options, const std::string& dbname,\n                  DB** dbptr) {\n    *dbptr = NULL;\n  \n    DBImpl* impl = new DBImpl(options, dbname);\n    impl->mutex_.Lock();\n    VersionEdit edit;\n    Status s = impl->Recover(&edit); // Handles create_if_missing, error_if_exists\n    if (s.ok()) {\n      uint64_t new_log_number = impl->versions_->NewFileNumber();\n      WritableFile* lfile;\n      s = options.env->NewWritableFile(LogFileName(dbname, new_log_number),\n                                       &lfile);\n      if (s.ok()) {\n        edit.SetLogNumber(new_log_number);\n        impl->logfile_ = lfile;\n        impl->logfile_number_ = new_log_number;\n        impl->log_ = new log::Writer(lfile);\n        s = impl->versions_->LogAndApply(&edit, &impl->mutex_);\n      }\n      if (s.ok()) {\n        impl->DeleteObsoleteFiles();\n        impl->MaybeScheduleCompaction();\n      }\n    }\n    impl->mutex_.Unlock();\n    if (s.ok()) {\n      *dbptr = impl;\n    } else {\n      delete impl;\n    }\n    return s;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 1521
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, Locking) {\n  DB* db2 = NULL;\n  Status s = DB::Open(CurrentOptions(), dbname_, &db2);\n  ASSERT_TRUE(!s.ok()) << \"Locking did not prevent re-opening db\";\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1480-1517",
    "snippet": "TEST(DBTest, DBOpen_Options) {\n  std::string dbname = test::TmpDir() + \"/db_options_test\";\n  DestroyDB(dbname, Options());\n\n  // Does not exist, and create_if_missing == false: error\n  DB* db = NULL;\n  Options opts;\n  opts.create_if_missing = false;\n  Status s = DB::Open(opts, dbname, &db);\n  ASSERT_TRUE(strstr(s.ToString().c_str(), \"does not exist\") != NULL);\n  ASSERT_TRUE(db == NULL);\n\n  // Does not exist, and create_if_missing == true: OK\n  opts.create_if_missing = true;\n  s = DB::Open(opts, dbname, &db);\n  ASSERT_OK(s);\n  ASSERT_TRUE(db != NULL);\n\n  delete db;\n  db = NULL;\n\n  // Does exist, and error_if_exists == true: error\n  opts.create_if_missing = false;\n  opts.error_if_exists = true;\n  s = DB::Open(opts, dbname, &db);\n  ASSERT_TRUE(strstr(s.ToString().c_str(), \"exists\") != NULL);\n  ASSERT_TRUE(db == NULL);\n\n  // Does exist, and error_if_exists == false: OK\n  opts.create_if_missing = true;\n  opts.error_if_exists = false;\n  s = DB::Open(opts, dbname, &db);\n  ASSERT_OK(s);\n  ASSERT_TRUE(db != NULL);\n\n  delete db;\n  db = NULL;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "db != NULL"
          ],
          "line": 1513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "s"
          ],
          "line": 1512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DB::Open",
          "args": [
            "opts",
            "dbname",
            "&db"
          ],
          "line": 1511
        },
        "resolved": true,
        "details": {
          "function_name": "Open",
          "container": "DB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1445-1477",
          "snippet": "Status DB::Open(const Options& options, const std::string& dbname,\n                DB** dbptr) {\n  *dbptr = NULL;\n\n  DBImpl* impl = new DBImpl(options, dbname);\n  impl->mutex_.Lock();\n  VersionEdit edit;\n  Status s = impl->Recover(&edit); // Handles create_if_missing, error_if_exists\n  if (s.ok()) {\n    uint64_t new_log_number = impl->versions_->NewFileNumber();\n    WritableFile* lfile;\n    s = options.env->NewWritableFile(LogFileName(dbname, new_log_number),\n                                     &lfile);\n    if (s.ok()) {\n      edit.SetLogNumber(new_log_number);\n      impl->logfile_ = lfile;\n      impl->logfile_number_ = new_log_number;\n      impl->log_ = new log::Writer(lfile);\n      s = impl->versions_->LogAndApply(&edit, &impl->mutex_);\n    }\n    if (s.ok()) {\n      impl->DeleteObsoleteFiles();\n      impl->MaybeScheduleCompaction();\n    }\n  }\n  impl->mutex_.Unlock();\n  if (s.ok()) {\n    *dbptr = impl;\n  } else {\n    delete impl;\n  }\n  return s;\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nDB {\n  Status DB::Open(const Options& options, const std::string& dbname,\n                  DB** dbptr) {\n    *dbptr = NULL;\n  \n    DBImpl* impl = new DBImpl(options, dbname);\n    impl->mutex_.Lock();\n    VersionEdit edit;\n    Status s = impl->Recover(&edit); // Handles create_if_missing, error_if_exists\n    if (s.ok()) {\n      uint64_t new_log_number = impl->versions_->NewFileNumber();\n      WritableFile* lfile;\n      s = options.env->NewWritableFile(LogFileName(dbname, new_log_number),\n                                       &lfile);\n      if (s.ok()) {\n        edit.SetLogNumber(new_log_number);\n        impl->logfile_ = lfile;\n        impl->logfile_number_ = new_log_number;\n        impl->log_ = new log::Writer(lfile);\n        s = impl->versions_->LogAndApply(&edit, &impl->mutex_);\n      }\n      if (s.ok()) {\n        impl->DeleteObsoleteFiles();\n        impl->MaybeScheduleCompaction();\n      }\n    }\n    impl->mutex_.Unlock();\n    if (s.ok()) {\n      *dbptr = impl;\n    } else {\n      delete impl;\n    }\n    return s;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "db == NULL"
          ],
          "line": 1506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "strstr(s.ToString().c_str(), \"exists\") != NULL"
          ],
          "line": 1505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "s.ToString().c_str()",
            "\"exists\""
          ],
          "line": 1505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ToString",
          "args": [],
          "line": 1505
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CUnsignedSyncCheckpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/checkpoints.h",
          "lines": "89-98",
          "snippet": "std::string ToString() const\n    {\n        return strprintf(\n                \"CSyncCheckpoint(\\n\"\n                \"    nVersion       = %d\\n\"\n                \"    hashCheckpoint = %s\\n\"\n                \")\\n\",\n            nVersion,\n            hashCheckpoint.ToString().c_str());\n    }",
          "includes": [
            "#include \"util.h\"",
            "#include \"net.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"net.h\"\n#include <map>\n\nCUnsignedSyncCheckpoint {\n  std::string ToString() const\n      {\n          return strprintf(\n                  \"CSyncCheckpoint(\\n\"\n                  \"    nVersion       = %d\\n\"\n                  \"    hashCheckpoint = %s\\n\"\n                  \")\\n\",\n              nVersion,\n              hashCheckpoint.ToString().c_str());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "db != NULL"
          ],
          "line": 1496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "s"
          ],
          "line": 1495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "db == NULL"
          ],
          "line": 1490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "strstr(s.ToString().c_str(), \"does not exist\") != NULL"
          ],
          "line": 1489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "s.ToString().c_str()",
            "\"does not exist\""
          ],
          "line": 1489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DestroyDB",
          "args": [
            "dbname",
            "Options()"
          ],
          "line": 1482
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyDB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1482-1511",
          "snippet": "Status DestroyDB(const std::string& dbname, const Options& options) {\n  Env* env = options.env;\n  std::vector<std::string> filenames;\n  // Ignore error in case directory does not exist\n  env->GetChildren(dbname, &filenames);\n  if (filenames.empty()) {\n    return Status::OK();\n  }\n\n  FileLock* lock;\n  const std::string lockname = LockFileName(dbname);\n  Status result = env->LockFile(lockname, &lock);\n  if (result.ok()) {\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) &&\n          type != kDBLockFile) {  // Lock file will be deleted at end\n        Status del = env->DeleteFile(dbname + \"/\" + filenames[i]);\n        if (result.ok() && !del.ok()) {\n          result = del;\n        }\n      }\n    }\n    env->UnlockFile(lock);  // Ignore error since state is already gone\n    env->DeleteFile(lockname);\n    env->DeleteDir(dbname);  // Ignore error in case dir contains other files\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nStatus DestroyDB(const std::string& dbname, const Options& options) {\n  Env* env = options.env;\n  std::vector<std::string> filenames;\n  // Ignore error in case directory does not exist\n  env->GetChildren(dbname, &filenames);\n  if (filenames.empty()) {\n    return Status::OK();\n  }\n\n  FileLock* lock;\n  const std::string lockname = LockFileName(dbname);\n  Status result = env->LockFile(lockname, &lock);\n  if (result.ok()) {\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) &&\n          type != kDBLockFile) {  // Lock file will be deleted at end\n        Status del = env->DeleteFile(dbname + \"/\" + filenames[i]);\n        if (result.ok() && !del.ok()) {\n          result = del;\n        }\n      }\n    }\n    env->UnlockFile(lock);  // Ignore error since state is already gone\n    env->DeleteFile(lockname);\n    env->DeleteDir(dbname);  // Ignore error in case dir contains other files\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Options",
          "args": [],
          "line": 1482
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::TmpDir",
          "args": [],
          "line": 1481
        },
        "resolved": true,
        "details": {
          "function_name": "TmpDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "60-65",
          "snippet": "std::string TmpDir() {\n  std::string dir;\n  Status s = Env::Default()->GetTestDirectory(&dir);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  return dir;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nstd::string TmpDir() {\n  std::string dir;\n  Status s = Env::Default()->GetTestDirectory(&dir);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  return dir;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, DBOpen_Options) {\n  std::string dbname = test::TmpDir() + \"/db_options_test\";\n  DestroyDB(dbname, Options());\n\n  // Does not exist, and create_if_missing == false: error\n  DB* db = NULL;\n  Options opts;\n  opts.create_if_missing = false;\n  Status s = DB::Open(opts, dbname, &db);\n  ASSERT_TRUE(strstr(s.ToString().c_str(), \"does not exist\") != NULL);\n  ASSERT_TRUE(db == NULL);\n\n  // Does not exist, and create_if_missing == true: OK\n  opts.create_if_missing = true;\n  s = DB::Open(opts, dbname, &db);\n  ASSERT_OK(s);\n  ASSERT_TRUE(db != NULL);\n\n  delete db;\n  db = NULL;\n\n  // Does exist, and error_if_exists == true: error\n  opts.create_if_missing = false;\n  opts.error_if_exists = true;\n  s = DB::Open(opts, dbname, &db);\n  ASSERT_TRUE(strstr(s.ToString().c_str(), \"exists\") != NULL);\n  ASSERT_TRUE(db == NULL);\n\n  // Does exist, and error_if_exists == false: OK\n  opts.create_if_missing = true;\n  opts.error_if_exists = false;\n  s = DB::Open(opts, dbname, &db);\n  ASSERT_OK(s);\n  ASSERT_TRUE(db != NULL);\n\n  delete db;\n  db = NULL;\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1446-1478",
    "snippet": "TEST(DBTest, ManualCompaction) {\n  ASSERT_EQ(config::kMaxMemCompactLevel, 2)\n      << \"Need to update this test to match kMaxMemCompactLevel\";\n\n  MakeTables(3, \"p\", \"q\");\n  ASSERT_EQ(\"1,1,1\", FilesPerLevel());\n\n  // Compaction range falls before files\n  Compact(\"\", \"c\");\n  ASSERT_EQ(\"1,1,1\", FilesPerLevel());\n\n  // Compaction range falls after files\n  Compact(\"r\", \"z\");\n  ASSERT_EQ(\"1,1,1\", FilesPerLevel());\n\n  // Compaction range overlaps files\n  Compact(\"p1\", \"p9\");\n  ASSERT_EQ(\"0,0,1\", FilesPerLevel());\n\n  // Populate a different range\n  MakeTables(3, \"c\", \"e\");\n  ASSERT_EQ(\"1,1,2\", FilesPerLevel());\n\n  // Compact just the new range\n  Compact(\"b\", \"f\");\n  ASSERT_EQ(\"0,0,2\", FilesPerLevel());\n\n  // Compact all\n  MakeTables(1, \"a\", \"z\");\n  ASSERT_EQ(\"0,1,2\", FilesPerLevel());\n  db_->CompactRange(NULL, NULL);\n  ASSERT_EQ(\"0,0,1\", FilesPerLevel());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"0,0,1\"",
            "FilesPerLevel()"
          ],
          "line": 1477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FilesPerLevel",
          "args": [],
          "line": 1477
        },
        "resolved": true,
        "details": {
          "function_name": "FilesPerLevel",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "395-409",
          "snippet": "std::string FilesPerLevel() {\n    std::string result;\n    int last_non_zero_offset = 0;\n    for (int level = 0; level < config::kNumLevels; level++) {\n      int f = NumTableFilesAtLevel(level);\n      char buf[100];\n      snprintf(buf, sizeof(buf), \"%s%d\", (level ? \",\" : \"\"), f);\n      result += buf;\n      if (f > 0) {\n        last_non_zero_offset = result.size();\n      }\n    }\n    result.resize(last_non_zero_offset);\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string FilesPerLevel() {\n      std::string result;\n      int last_non_zero_offset = 0;\n      for (int level = 0; level < config::kNumLevels; level++) {\n        int f = NumTableFilesAtLevel(level);\n        char buf[100];\n        snprintf(buf, sizeof(buf), \"%s%d\", (level ? \",\" : \"\"), f);\n        result += buf;\n        if (f > 0) {\n          last_non_zero_offset = result.size();\n        }\n      }\n      result.resize(last_non_zero_offset);\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->CompactRange",
          "args": [
            "NULL",
            "NULL"
          ],
          "line": 1476
        },
        "resolved": true,
        "details": {
          "function_name": "CompactRange",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1895-1896",
          "snippet": "virtual void CompactRange(const Slice* start, const Slice* end) {\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void CompactRange(const Slice* start, const Slice* end) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"0,1,2\"",
            "FilesPerLevel()"
          ],
          "line": 1475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakeTables",
          "args": [
            "1",
            "\"a\"",
            "\"z\""
          ],
          "line": 1474
        },
        "resolved": true,
        "details": {
          "function_name": "MakeTables",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "430-436",
          "snippet": "void MakeTables(int n, const std::string& small, const std::string& large) {\n    for (int i = 0; i < n; i++) {\n      Put(small, \"begin\");\n      Put(large, \"end\");\n      dbfull()->TEST_CompactMemTable();\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void MakeTables(int n, const std::string& small, const std::string& large) {\n      for (int i = 0; i < n; i++) {\n        Put(small, \"begin\");\n        Put(large, \"end\");\n        dbfull()->TEST_CompactMemTable();\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"0,0,2\"",
            "FilesPerLevel()"
          ],
          "line": 1471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"1,1,2\"",
            "FilesPerLevel()"
          ],
          "line": 1467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"0,0,1\"",
            "FilesPerLevel()"
          ],
          "line": 1463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"1,1,1\"",
            "FilesPerLevel()"
          ],
          "line": 1459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"1,1,1\"",
            "FilesPerLevel()"
          ],
          "line": 1455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"1,1,1\"",
            "FilesPerLevel()"
          ],
          "line": 1451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "config::kMaxMemCompactLevel",
            "2"
          ],
          "line": 1447
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, ManualCompaction) {\n  ASSERT_EQ(config::kMaxMemCompactLevel, 2)\n      << \"Need to update this test to match kMaxMemCompactLevel\";\n\n  MakeTables(3, \"p\", \"q\");\n  ASSERT_EQ(\"1,1,1\", FilesPerLevel());\n\n  // Compaction range falls before files\n  Compact(\"\", \"c\");\n  ASSERT_EQ(\"1,1,1\", FilesPerLevel());\n\n  // Compaction range falls after files\n  Compact(\"r\", \"z\");\n  ASSERT_EQ(\"1,1,1\", FilesPerLevel());\n\n  // Compaction range overlaps files\n  Compact(\"p1\", \"p9\");\n  ASSERT_EQ(\"0,0,1\", FilesPerLevel());\n\n  // Populate a different range\n  MakeTables(3, \"c\", \"e\");\n  ASSERT_EQ(\"1,1,2\", FilesPerLevel());\n\n  // Compact just the new range\n  Compact(\"b\", \"f\");\n  ASSERT_EQ(\"0,0,2\", FilesPerLevel());\n\n  // Compact all\n  MakeTables(1, \"a\", \"z\");\n  ASSERT_EQ(\"0,1,2\", FilesPerLevel());\n  db_->CompactRange(NULL, NULL);\n  ASSERT_EQ(\"0,0,1\", FilesPerLevel());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1391-1444",
    "snippet": "TEST(DBTest, CustomComparator) {\n  class NumberComparator : public Comparator {\n   public:\n    virtual const char* Name() const { return \"test.NumberComparator\"; }\n    virtual int Compare(const Slice& a, const Slice& b) const {\n      return ToNumber(a) - ToNumber(b);\n    }\n    virtual void FindShortestSeparator(std::string* s, const Slice& l) const {\n      ToNumber(*s);     // Check format\n      ToNumber(l);      // Check format\n    }\n    virtual void FindShortSuccessor(std::string* key) const {\n      ToNumber(*key);   // Check format\n    }\n   private:\n    static int ToNumber(const Slice& x) {\n      // Check that there are no extra characters.\n      ASSERT_TRUE(x.size() >= 2 && x[0] == '[' && x[x.size()-1] == ']')\n          << EscapeString(x);\n      int val;\n      char ignored;\n      ASSERT_TRUE(sscanf(x.ToString().c_str(), \"[%i]%c\", &val, &ignored) == 1)\n          << EscapeString(x);\n      return val;\n    }\n  };\n  NumberComparator cmp;\n  Options new_options = CurrentOptions();\n  new_options.create_if_missing = true;\n  new_options.comparator = &cmp;\n  new_options.filter_policy = NULL;     // Cannot use bloom filters\n  new_options.write_buffer_size = 1000;  // Compact more often\n  DestroyAndReopen(&new_options);\n  ASSERT_OK(Put(\"[10]\", \"ten\"));\n  ASSERT_OK(Put(\"[0x14]\", \"twenty\"));\n  for (int i = 0; i < 2; i++) {\n    ASSERT_EQ(\"ten\", Get(\"[10]\"));\n    ASSERT_EQ(\"ten\", Get(\"[0xa]\"));\n    ASSERT_EQ(\"twenty\", Get(\"[20]\"));\n    ASSERT_EQ(\"twenty\", Get(\"[0x14]\"));\n    ASSERT_EQ(\"NOT_FOUND\", Get(\"[15]\"));\n    ASSERT_EQ(\"NOT_FOUND\", Get(\"[0xf]\"));\n    Compact(\"[0]\", \"[9999]\");\n  }\n\n  for (int run = 0; run < 2; run++) {\n    for (int i = 0; i < 1000; i++) {\n      char buf[100];\n      snprintf(buf, sizeof(buf), \"[%d]\", i*10);\n      ASSERT_OK(Put(buf, buf));\n    }\n    Compact(\"[0]\", \"[1000000]\");\n  }\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Compact",
          "args": [
            "\"[0]\"",
            "\"[1000000]\""
          ],
          "line": 1442
        },
        "resolved": true,
        "details": {
          "function_name": "CompactRange",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1895-1896",
          "snippet": "virtual void CompactRange(const Slice* start, const Slice* end) {\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void CompactRange(const Slice* start, const Slice* end) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(buf, buf)"
          ],
          "line": 1440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "buf",
            "buf"
          ],
          "line": 1440
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"[%d]\"",
            "i*10"
          ],
          "line": 1439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"NOT_FOUND\"",
            "Get(\"[0xf]\")"
          ],
          "line": 1432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"[0xf]\""
          ],
          "line": 1432
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"NOT_FOUND\"",
            "Get(\"[15]\")"
          ],
          "line": 1431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"twenty\"",
            "Get(\"[0x14]\")"
          ],
          "line": 1430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"twenty\"",
            "Get(\"[20]\")"
          ],
          "line": 1429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"ten\"",
            "Get(\"[0xa]\")"
          ],
          "line": 1428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"ten\"",
            "Get(\"[10]\")"
          ],
          "line": 1427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"[0x14]\", \"twenty\")"
          ],
          "line": 1425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"[10]\", \"ten\")"
          ],
          "line": 1424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DestroyAndReopen",
          "args": [
            "&new_options"
          ],
          "line": 1423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 1418
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EscapeString",
          "args": [
            "x"
          ],
          "line": 1413
        },
        "resolved": true,
        "details": {
          "function_name": "EscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
          "lines": "42-46",
          "snippet": "std::string EscapeString(const Slice& value) {\n  std::string r;\n  AppendEscapedStringTo(&r, value);\n  return r;\n}",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"util/logging.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nstd::string EscapeString(const Slice& value) {\n  std::string r;\n  AppendEscapedStringTo(&r, value);\n  return r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "sscanf(x.ToString().c_str(), \"[%i]%c\", &val, &ignored) == 1"
          ],
          "line": 1412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "x.ToString().c_str()",
            "\"[%i]%c\"",
            "&val",
            "&ignored"
          ],
          "line": 1412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "x.ToString",
          "args": [],
          "line": 1412
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CDiskBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1518-1527",
          "snippet": "std::string ToString() const\n    {\n        std::string str = \"CDiskBlockIndex(\";\n        str += CBlockIndex::ToString();\n        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n            GetBlockHash().ToString().c_str(),\n            hashPrev.ToString().c_str(),\n            hashNext.ToString().c_str());\n        return str;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCDiskBlockIndex {\n  std::string ToString() const\n      {\n          std::string str = \"CDiskBlockIndex(\";\n          str += CBlockIndex::ToString();\n          str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s, hashNext=%s)\",\n              GetBlockHash().ToString().c_str(),\n              hashPrev.ToString().c_str(),\n              hashNext.ToString().c_str());\n          return str;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "x.size() >= 2 && x[0] == '[' && x[x.size()-1] == ']'"
          ],
          "line": 1408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "x.size",
          "args": [],
          "line": 1408
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1691-1695",
          "snippet": "unsigned long size()\n    {\n        LOCK(cs);\n        return mapTx.size();\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTxMemPool {\n  unsigned long size()\n      {\n          LOCK(cs);\n          return mapTx.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ToNumber",
          "args": [
            "*key"
          ],
          "line": 1403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToNumber",
          "args": [
            "l"
          ],
          "line": 1400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToNumber",
          "args": [
            "*s"
          ],
          "line": 1399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToNumber",
          "args": [
            "b"
          ],
          "line": 1396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ToNumber",
          "args": [
            "a"
          ],
          "line": 1396
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, CustomComparator) {\n  class NumberComparator : public Comparator {\n   public:\n    virtual const char* Name() const { return \"test.NumberComparator\"; }\n    virtual int Compare(const Slice& a, const Slice& b) const {\n      return ToNumber(a) - ToNumber(b);\n    }\n    virtual void FindShortestSeparator(std::string* s, const Slice& l) const {\n      ToNumber(*s);     // Check format\n      ToNumber(l);      // Check format\n    }\n    virtual void FindShortSuccessor(std::string* key) const {\n      ToNumber(*key);   // Check format\n    }\n   private:\n    static int ToNumber(const Slice& x) {\n      // Check that there are no extra characters.\n      ASSERT_TRUE(x.size() >= 2 && x[0] == '[' && x[x.size()-1] == ']')\n          << EscapeString(x);\n      int val;\n      char ignored;\n      ASSERT_TRUE(sscanf(x.ToString().c_str(), \"[%i]%c\", &val, &ignored) == 1)\n          << EscapeString(x);\n      return val;\n    }\n  };\n  NumberComparator cmp;\n  Options new_options = CurrentOptions();\n  new_options.create_if_missing = true;\n  new_options.comparator = &cmp;\n  new_options.filter_policy = NULL;     // Cannot use bloom filters\n  new_options.write_buffer_size = 1000;  // Compact more often\n  DestroyAndReopen(&new_options);\n  ASSERT_OK(Put(\"[10]\", \"ten\"));\n  ASSERT_OK(Put(\"[0x14]\", \"twenty\"));\n  for (int i = 0; i < 2; i++) {\n    ASSERT_EQ(\"ten\", Get(\"[10]\"));\n    ASSERT_EQ(\"ten\", Get(\"[0xa]\"));\n    ASSERT_EQ(\"twenty\", Get(\"[20]\"));\n    ASSERT_EQ(\"twenty\", Get(\"[0x14]\"));\n    ASSERT_EQ(\"NOT_FOUND\", Get(\"[15]\"));\n    ASSERT_EQ(\"NOT_FOUND\", Get(\"[0xf]\"));\n    Compact(\"[0]\", \"[9999]\");\n  }\n\n  for (int run = 0; run < 2; run++) {\n    for (int i = 0; i < 1000; i++) {\n      char buf[100];\n      snprintf(buf, sizeof(buf), \"[%d]\", i*10);\n      ASSERT_OK(Put(buf, buf));\n    }\n    Compact(\"[0]\", \"[1000000]\");\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1368-1389",
    "snippet": "TEST(DBTest, ComparatorCheck) {\n  class NewComparator : public Comparator {\n   public:\n    virtual const char* Name() const { return \"leveldb.NewComparator\"; }\n    virtual int Compare(const Slice& a, const Slice& b) const {\n      return BytewiseComparator()->Compare(a, b);\n    }\n    virtual void FindShortestSeparator(std::string* s, const Slice& l) const {\n      BytewiseComparator()->FindShortestSeparator(s, l);\n    }\n    virtual void FindShortSuccessor(std::string* key) const {\n      BytewiseComparator()->FindShortSuccessor(key);\n    }\n  };\n  NewComparator cmp;\n  Options new_options = CurrentOptions();\n  new_options.comparator = &cmp;\n  Status s = TryReopen(&new_options);\n  ASSERT_TRUE(!s.ok());\n  ASSERT_TRUE(s.ToString().find(\"comparator\") != std::string::npos)\n      << s.ToString();\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s.ToString",
          "args": [],
          "line": 1388
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CUnsignedSyncCheckpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/checkpoints.h",
          "lines": "89-98",
          "snippet": "std::string ToString() const\n    {\n        return strprintf(\n                \"CSyncCheckpoint(\\n\"\n                \"    nVersion       = %d\\n\"\n                \"    hashCheckpoint = %s\\n\"\n                \")\\n\",\n            nVersion,\n            hashCheckpoint.ToString().c_str());\n    }",
          "includes": [
            "#include \"util.h\"",
            "#include \"net.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"net.h\"\n#include <map>\n\nCUnsignedSyncCheckpoint {\n  std::string ToString() const\n      {\n          return strprintf(\n                  \"CSyncCheckpoint(\\n\"\n                  \"    nVersion       = %d\\n\"\n                  \"    hashCheckpoint = %s\\n\"\n                  \")\\n\",\n              nVersion,\n              hashCheckpoint.ToString().c_str());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "s.ToString().find(\"comparator\") != std::string::npos"
          ],
          "line": 1387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ToString",
          "args": [
            "\"comparator\""
          ],
          "line": 1387
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "604-610",
          "snippet": "std::string ToString(const Iterator* it) {\n    if (!it->Valid()) {\n      return \"END\";\n    } else {\n      return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string ToString(const Iterator* it) {\n      if (!it->Valid()) {\n        return \"END\";\n      } else {\n        return \"'\" + it->key().ToString() + \"->\" + it->value().ToString() + \"'\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!s.ok()"
          ],
          "line": 1386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 1386
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TryReopen",
          "args": [
            "&new_options"
          ],
          "line": 1385
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 1383
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [
            "key"
          ],
          "line": 1379
        },
        "resolved": true,
        "details": {
          "function_name": "FindShortSuccessor",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "53-65",
          "snippet": "virtual void FindShortSuccessor(std::string* key) const {\n    // Find first character that can be incremented\n    size_t n = key->size();\n    for (size_t i = 0; i < n; i++) {\n      const uint8_t byte = (*key)[i];\n      if (byte != static_cast<uint8_t>(0xff)) {\n        (*key)[i] = byte + 1;\n        key->resize(i+1);\n        return;\n      }\n    }\n    // *key is a run of 0xffs.  Leave it alone.\n  }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  virtual void FindShortSuccessor(std::string* key) const {\n      // Find first character that can be incremented\n      size_t n = key->size();\n      for (size_t i = 0; i < n; i++) {\n        const uint8_t byte = (*key)[i];\n        if (byte != static_cast<uint8_t>(0xff)) {\n          (*key)[i] = byte + 1;\n          key->resize(i+1);\n          return;\n        }\n      }\n      // *key is a run of 0xffs.  Leave it alone.\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [],
          "line": 1379
        },
        "resolved": true,
        "details": {
          "function_name": "BytewiseComparatorImpl",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "19-19",
          "snippet": "BytewiseComparatorImpl() { }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  BytewiseComparatorImpl() { }\n}"
        }
      },
      {
        "call_info": {
          "callee": "BytewiseComparator",
          "args": [
            "s",
            "l"
          ],
          "line": 1376
        },
        "resolved": true,
        "details": {
          "function_name": "FindShortestSeparator",
          "container": "BytewiseComparatorImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/comparator.cc",
          "lines": "29-51",
          "snippet": "virtual void FindShortestSeparator(\n      std::string* start,\n      const Slice& limit) const {\n    // Find length of common prefix\n    size_t min_length = std::min(start->size(), limit.size());\n    size_t diff_index = 0;\n    while ((diff_index < min_length) &&\n           ((*start)[diff_index] == limit[diff_index])) {\n      diff_index++;\n    }\n\n    if (diff_index >= min_length) {\n      // Do not shorten if one string is a prefix of the other\n    } else {\n      uint8_t diff_byte = static_cast<uint8_t>((*start)[diff_index]);\n      if (diff_byte < static_cast<uint8_t>(0xff) &&\n          diff_byte + 1 < static_cast<uint8_t>(limit[diff_index])) {\n        (*start)[diff_index]++;\n        start->resize(diff_index + 1);\n        assert(Compare(*start, limit) < 0);\n      }\n    }\n  }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdint.h>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/comparator.h\"\n#include <stdint.h>\n#include <algorithm>\n\nBytewiseComparatorImpl {\n  virtual void FindShortestSeparator(\n        std::string* start,\n        const Slice& limit) const {\n      // Find length of common prefix\n      size_t min_length = std::min(start->size(), limit.size());\n      size_t diff_index = 0;\n      while ((diff_index < min_length) &&\n             ((*start)[diff_index] == limit[diff_index])) {\n        diff_index++;\n      }\n  \n      if (diff_index >= min_length) {\n        // Do not shorten if one string is a prefix of the other\n      } else {\n        uint8_t diff_byte = static_cast<uint8_t>((*start)[diff_index]);\n        if (diff_byte < static_cast<uint8_t>(0xff) &&\n            diff_byte + 1 < static_cast<uint8_t>(limit[diff_index])) {\n          (*start)[diff_index]++;\n          start->resize(diff_index + 1);\n          assert(Compare(*start, limit) < 0);\n        }\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, ComparatorCheck) {\n  class NewComparator : public Comparator {\n   public:\n    virtual const char* Name() const { return \"leveldb.NewComparator\"; }\n    virtual int Compare(const Slice& a, const Slice& b) const {\n      return BytewiseComparator()->Compare(a, b);\n    }\n    virtual void FindShortestSeparator(std::string* s, const Slice& l) const {\n      BytewiseComparator()->FindShortestSeparator(s, l);\n    }\n    virtual void FindShortSuccessor(std::string* key) const {\n      BytewiseComparator()->FindShortSuccessor(key);\n    }\n  };\n  NewComparator cmp;\n  Options new_options = CurrentOptions();\n  new_options.comparator = &cmp;\n  Status s = TryReopen(&new_options);\n  ASSERT_TRUE(!s.ok());\n  ASSERT_TRUE(s.ToString().find(\"comparator\") != std::string::npos)\n      << s.ToString();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1342-1366",
    "snippet": "TEST(DBTest, L0_CompactionBug_Issue44_b) {\n  Reopen();\n  Put(\"\",\"\");\n  Reopen();\n  Delete(\"e\");\n  Put(\"\",\"\");\n  Reopen();\n  Put(\"c\", \"cv\");\n  Reopen();\n  Put(\"\",\"\");\n  Reopen();\n  Put(\"\",\"\");\n  DelayMilliseconds(1000);  // Wait for compaction to finish\n  Reopen();\n  Put(\"d\",\"dv\");\n  Reopen();\n  Put(\"\",\"\");\n  Reopen();\n  Delete(\"d\");\n  Delete(\"b\");\n  Reopen();\n  ASSERT_EQ(\"(->)(c->cv)\", Contents());\n  DelayMilliseconds(1000);  // Wait for compaction to finish\n  ASSERT_EQ(\"(->)(c->cv)\", Contents());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"(->)(c->cv)\"",
            "Contents()"
          ],
          "line": 1365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Contents",
          "args": [],
          "line": 1365
        },
        "resolved": true,
        "details": {
          "function_name": "Contents",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "311-334",
          "snippet": "std::string Contents() {\n    std::vector<std::string> forward;\n    std::string result;\n    Iterator* iter = db_->NewIterator(ReadOptions());\n    for (iter->SeekToFirst(); iter->Valid(); iter->Next()) {\n      std::string s = IterStatus(iter);\n      result.push_back('(');\n      result.append(s);\n      result.push_back(')');\n      forward.push_back(s);\n    }\n\n    // Check reverse iteration results are the reverse of forward results\n    size_t matched = 0;\n    for (iter->SeekToLast(); iter->Valid(); iter->Prev()) {\n      ASSERT_LT(matched, forward.size());\n      ASSERT_EQ(IterStatus(iter), forward[forward.size() - matched - 1]);\n      matched++;\n    }\n    ASSERT_EQ(matched, forward.size());\n\n    delete iter;\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Contents() {\n      std::vector<std::string> forward;\n      std::string result;\n      Iterator* iter = db_->NewIterator(ReadOptions());\n      for (iter->SeekToFirst(); iter->Valid(); iter->Next()) {\n        std::string s = IterStatus(iter);\n        result.push_back('(');\n        result.append(s);\n        result.push_back(')');\n        forward.push_back(s);\n      }\n  \n      // Check reverse iteration results are the reverse of forward results\n      size_t matched = 0;\n      for (iter->SeekToLast(); iter->Valid(); iter->Prev()) {\n        ASSERT_LT(matched, forward.size());\n        ASSERT_EQ(IterStatus(iter), forward[forward.size() - matched - 1]);\n        matched++;\n      }\n      ASSERT_EQ(matched, forward.size());\n  \n      delete iter;\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DelayMilliseconds",
          "args": [
            "1000"
          ],
          "line": 1364
        },
        "resolved": true,
        "details": {
          "function_name": "DelayMilliseconds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "52-54",
          "snippet": "void DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nvoid DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"(->)(c->cv)\"",
            "Contents()"
          ],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [],
          "line": 1362
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyAndReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "266-271",
          "snippet": "void DestroyAndReopen(Options* options = NULL) {\n    delete db_;\n    db_ = NULL;\n    DestroyDB(dbname_, Options());\n    ASSERT_OK(TryReopen(options));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void DestroyAndReopen(Options* options = NULL) {\n      delete db_;\n      db_ = NULL;\n      DestroyDB(dbname_, Options());\n      ASSERT_OK(TryReopen(options));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Delete",
          "args": [
            "\"b\""
          ],
          "line": 1361
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "292-294",
          "snippet": "Status Delete(const std::string& k) {\n    return db_->Delete(WriteOptions(), k);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Delete(const std::string& k) {\n      return db_->Delete(WriteOptions(), k);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"\"",
            "\"\""
          ],
          "line": 1358
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, L0_CompactionBug_Issue44_b) {\n  Reopen();\n  Put(\"\",\"\");\n  Reopen();\n  Delete(\"e\");\n  Put(\"\",\"\");\n  Reopen();\n  Put(\"c\", \"cv\");\n  Reopen();\n  Put(\"\",\"\");\n  Reopen();\n  Put(\"\",\"\");\n  DelayMilliseconds(1000);  // Wait for compaction to finish\n  Reopen();\n  Put(\"d\",\"dv\");\n  Reopen();\n  Put(\"\",\"\");\n  Reopen();\n  Delete(\"d\");\n  Delete(\"b\");\n  Reopen();\n  ASSERT_EQ(\"(->)(c->cv)\", Contents());\n  DelayMilliseconds(1000);  // Wait for compaction to finish\n  ASSERT_EQ(\"(->)(c->cv)\", Contents());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1325-1340",
    "snippet": "TEST(DBTest, L0_CompactionBug_Issue44_a) {\n  Reopen();\n  ASSERT_OK(Put(\"b\", \"v\"));\n  Reopen();\n  ASSERT_OK(Delete(\"b\"));\n  ASSERT_OK(Delete(\"a\"));\n  Reopen();\n  ASSERT_OK(Delete(\"a\"));\n  Reopen();\n  ASSERT_OK(Put(\"a\", \"v\"));\n  Reopen();\n  Reopen();\n  ASSERT_EQ(\"(a->v)\", Contents());\n  DelayMilliseconds(1000);  // Wait for compaction to finish\n  ASSERT_EQ(\"(a->v)\", Contents());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"(a->v)\"",
            "Contents()"
          ],
          "line": 1339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Contents",
          "args": [],
          "line": 1339
        },
        "resolved": true,
        "details": {
          "function_name": "Contents",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "311-334",
          "snippet": "std::string Contents() {\n    std::vector<std::string> forward;\n    std::string result;\n    Iterator* iter = db_->NewIterator(ReadOptions());\n    for (iter->SeekToFirst(); iter->Valid(); iter->Next()) {\n      std::string s = IterStatus(iter);\n      result.push_back('(');\n      result.append(s);\n      result.push_back(')');\n      forward.push_back(s);\n    }\n\n    // Check reverse iteration results are the reverse of forward results\n    size_t matched = 0;\n    for (iter->SeekToLast(); iter->Valid(); iter->Prev()) {\n      ASSERT_LT(matched, forward.size());\n      ASSERT_EQ(IterStatus(iter), forward[forward.size() - matched - 1]);\n      matched++;\n    }\n    ASSERT_EQ(matched, forward.size());\n\n    delete iter;\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Contents() {\n      std::vector<std::string> forward;\n      std::string result;\n      Iterator* iter = db_->NewIterator(ReadOptions());\n      for (iter->SeekToFirst(); iter->Valid(); iter->Next()) {\n        std::string s = IterStatus(iter);\n        result.push_back('(');\n        result.append(s);\n        result.push_back(')');\n        forward.push_back(s);\n      }\n  \n      // Check reverse iteration results are the reverse of forward results\n      size_t matched = 0;\n      for (iter->SeekToLast(); iter->Valid(); iter->Prev()) {\n        ASSERT_LT(matched, forward.size());\n        ASSERT_EQ(IterStatus(iter), forward[forward.size() - matched - 1]);\n        matched++;\n      }\n      ASSERT_EQ(matched, forward.size());\n  \n      delete iter;\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DelayMilliseconds",
          "args": [
            "1000"
          ],
          "line": 1338
        },
        "resolved": true,
        "details": {
          "function_name": "DelayMilliseconds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "52-54",
          "snippet": "void DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nvoid DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"(a->v)\"",
            "Contents()"
          ],
          "line": 1337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyAndReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "266-271",
          "snippet": "void DestroyAndReopen(Options* options = NULL) {\n    delete db_;\n    db_ = NULL;\n    DestroyDB(dbname_, Options());\n    ASSERT_OK(TryReopen(options));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void DestroyAndReopen(Options* options = NULL) {\n      delete db_;\n      db_ = NULL;\n      DestroyDB(dbname_, Options());\n      ASSERT_OK(TryReopen(options));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"a\", \"v\")"
          ],
          "line": 1334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"a\"",
            "\"v\""
          ],
          "line": 1334
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Delete(\"a\")"
          ],
          "line": 1332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Delete",
          "args": [
            "\"a\""
          ],
          "line": 1332
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "292-294",
          "snippet": "Status Delete(const std::string& k) {\n    return db_->Delete(WriteOptions(), k);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Delete(const std::string& k) {\n      return db_->Delete(WriteOptions(), k);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Delete(\"a\")"
          ],
          "line": 1330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Delete(\"b\")"
          ],
          "line": 1329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"b\", \"v\")"
          ],
          "line": 1327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, L0_CompactionBug_Issue44_a) {\n  Reopen();\n  ASSERT_OK(Put(\"b\", \"v\"));\n  Reopen();\n  ASSERT_OK(Delete(\"b\"));\n  ASSERT_OK(Delete(\"a\"));\n  Reopen();\n  ASSERT_OK(Delete(\"a\"));\n  Reopen();\n  ASSERT_OK(Put(\"a\", \"v\"));\n  Reopen();\n  Reopen();\n  ASSERT_EQ(\"(a->v)\", Contents());\n  DelayMilliseconds(1000);  // Wait for compaction to finish\n  ASSERT_EQ(\"(a->v)\", Contents());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1284-1323",
    "snippet": "TEST(DBTest, OverlapInLevel0) {\n  do {\n    ASSERT_EQ(config::kMaxMemCompactLevel, 2) << \"Fix test to match config\";\n\n    // Fill levels 1 and 2 to disable the pushing of new memtables to levels > 0.\n    ASSERT_OK(Put(\"100\", \"v100\"));\n    ASSERT_OK(Put(\"999\", \"v999\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_OK(Delete(\"100\"));\n    ASSERT_OK(Delete(\"999\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"0,1,1\", FilesPerLevel());\n\n    // Make files spanning the following ranges in level-0:\n    //  files[0]  200 .. 900\n    //  files[1]  300 .. 500\n    // Note that files are sorted by smallest key.\n    ASSERT_OK(Put(\"300\", \"v300\"));\n    ASSERT_OK(Put(\"500\", \"v500\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_OK(Put(\"200\", \"v200\"));\n    ASSERT_OK(Put(\"600\", \"v600\"));\n    ASSERT_OK(Put(\"900\", \"v900\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"2,1,1\", FilesPerLevel());\n\n    // Compact away the placeholder files we created initially\n    dbfull()->TEST_CompactRange(1, NULL, NULL);\n    dbfull()->TEST_CompactRange(2, NULL, NULL);\n    ASSERT_EQ(\"2\", FilesPerLevel());\n\n    // Do a memtable compaction.  Before bug-fix, the compaction would\n    // not detect the overlap with level-0 files and would incorrectly place\n    // the deletion in a deeper level.\n    ASSERT_OK(Delete(\"600\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"3\", FilesPerLevel());\n    ASSERT_EQ(\"NOT_FOUND\", Get(\"600\"));\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 1322
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"NOT_FOUND\"",
            "Get(\"600\")"
          ],
          "line": 1321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"600\""
          ],
          "line": 1321
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"3\"",
            "FilesPerLevel()"
          ],
          "line": 1320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FilesPerLevel",
          "args": [],
          "line": 1320
        },
        "resolved": true,
        "details": {
          "function_name": "FilesPerLevel",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "395-409",
          "snippet": "std::string FilesPerLevel() {\n    std::string result;\n    int last_non_zero_offset = 0;\n    for (int level = 0; level < config::kNumLevels; level++) {\n      int f = NumTableFilesAtLevel(level);\n      char buf[100];\n      snprintf(buf, sizeof(buf), \"%s%d\", (level ? \",\" : \"\"), f);\n      result += buf;\n      if (f > 0) {\n        last_non_zero_offset = result.size();\n      }\n    }\n    result.resize(last_non_zero_offset);\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string FilesPerLevel() {\n      std::string result;\n      int last_non_zero_offset = 0;\n      for (int level = 0; level < config::kNumLevels; level++) {\n        int f = NumTableFilesAtLevel(level);\n        char buf[100];\n        snprintf(buf, sizeof(buf), \"%s%d\", (level ? \",\" : \"\"), f);\n        result += buf;\n        if (f > 0) {\n          last_non_zero_offset = result.size();\n        }\n      }\n      result.resize(last_non_zero_offset);\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Delete(\"600\")"
          ],
          "line": 1318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Delete",
          "args": [
            "\"600\""
          ],
          "line": 1318
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "292-294",
          "snippet": "Status Delete(const std::string& k) {\n    return db_->Delete(WriteOptions(), k);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Delete(const std::string& k) {\n      return db_->Delete(WriteOptions(), k);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"2\"",
            "FilesPerLevel()"
          ],
          "line": 1313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "2",
            "NULL",
            "NULL"
          ],
          "line": 1312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "1",
            "NULL",
            "NULL"
          ],
          "line": 1311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"2,1,1\"",
            "FilesPerLevel()"
          ],
          "line": 1308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"900\", \"v900\")"
          ],
          "line": 1306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"900\"",
            "\"v900\""
          ],
          "line": 1306
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"600\", \"v600\")"
          ],
          "line": 1305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"200\", \"v200\")"
          ],
          "line": 1304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"500\", \"v500\")"
          ],
          "line": 1302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"300\", \"v300\")"
          ],
          "line": 1301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"0,1,1\"",
            "FilesPerLevel()"
          ],
          "line": 1295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Delete(\"999\")"
          ],
          "line": 1293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Delete(\"100\")"
          ],
          "line": 1292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"999\", \"v999\")"
          ],
          "line": 1290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"100\", \"v100\")"
          ],
          "line": 1289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "config::kMaxMemCompactLevel",
            "2"
          ],
          "line": 1286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, OverlapInLevel0) {\n  do {\n    ASSERT_EQ(config::kMaxMemCompactLevel, 2) << \"Fix test to match config\";\n\n    // Fill levels 1 and 2 to disable the pushing of new memtables to levels > 0.\n    ASSERT_OK(Put(\"100\", \"v100\"));\n    ASSERT_OK(Put(\"999\", \"v999\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_OK(Delete(\"100\"));\n    ASSERT_OK(Delete(\"999\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"0,1,1\", FilesPerLevel());\n\n    // Make files spanning the following ranges in level-0:\n    //  files[0]  200 .. 900\n    //  files[1]  300 .. 500\n    // Note that files are sorted by smallest key.\n    ASSERT_OK(Put(\"300\", \"v300\"));\n    ASSERT_OK(Put(\"500\", \"v500\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_OK(Put(\"200\", \"v200\"));\n    ASSERT_OK(Put(\"600\", \"v600\"));\n    ASSERT_OK(Put(\"900\", \"v900\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"2,1,1\", FilesPerLevel());\n\n    // Compact away the placeholder files we created initially\n    dbfull()->TEST_CompactRange(1, NULL, NULL);\n    dbfull()->TEST_CompactRange(2, NULL, NULL);\n    ASSERT_EQ(\"2\", FilesPerLevel());\n\n    // Do a memtable compaction.  Before bug-fix, the compaction would\n    // not detect the overlap with level-0 files and would incorrectly place\n    // the deletion in a deeper level.\n    ASSERT_OK(Delete(\"600\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"3\", FilesPerLevel());\n    ASSERT_EQ(\"NOT_FOUND\", Get(\"600\"));\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1258-1282",
    "snippet": "TEST(DBTest, DeletionMarkers2) {\n  Put(\"foo\", \"v1\");\n  ASSERT_OK(dbfull()->TEST_CompactMemTable());\n  const int last = config::kMaxMemCompactLevel;\n  ASSERT_EQ(NumTableFilesAtLevel(last), 1);   // foo => v1 is now in last level\n\n  // Place a table at level last-1 to prevent merging with preceding mutation\n  Put(\"a\", \"begin\");\n  Put(\"z\", \"end\");\n  dbfull()->TEST_CompactMemTable();\n  ASSERT_EQ(NumTableFilesAtLevel(last), 1);\n  ASSERT_EQ(NumTableFilesAtLevel(last-1), 1);\n\n  Delete(\"foo\");\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ DEL, v1 ]\");\n  ASSERT_OK(dbfull()->TEST_CompactMemTable());  // Moves to level last-2\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ DEL, v1 ]\");\n  dbfull()->TEST_CompactRange(last-2, NULL, NULL);\n  // DEL kept: \"last\" file overlaps\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ DEL, v1 ]\");\n  dbfull()->TEST_CompactRange(last-1, NULL, NULL);\n  // Merging last-1 w/ last, so we are the base level for \"foo\", so\n  // DEL is removed.  (as is v1).\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ ]\");\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "AllEntriesFor(\"foo\")",
            "\"[ ]\""
          ],
          "line": 1281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AllEntriesFor",
          "args": [
            "\"foo\""
          ],
          "line": 1281
        },
        "resolved": true,
        "details": {
          "function_name": "AllEntriesFor",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "336-376",
          "snippet": "std::string AllEntriesFor(const Slice& user_key) {\n    Iterator* iter = dbfull()->TEST_NewInternalIterator();\n    InternalKey target(user_key, kMaxSequenceNumber, kTypeValue);\n    iter->Seek(target.Encode());\n    std::string result;\n    if (!iter->status().ok()) {\n      result = iter->status().ToString();\n    } else {\n      result = \"[ \";\n      bool first = true;\n      while (iter->Valid()) {\n        ParsedInternalKey ikey;\n        if (!ParseInternalKey(iter->key(), &ikey)) {\n          result += \"CORRUPTED\";\n        } else {\n          if (last_options_.comparator->Compare(ikey.user_key, user_key) != 0) {\n            break;\n          }\n          if (!first) {\n            result += \", \";\n          }\n          first = false;\n          switch (ikey.type) {\n            case kTypeValue:\n              result += iter->value().ToString();\n              break;\n            case kTypeDeletion:\n              result += \"DEL\";\n              break;\n          }\n        }\n        iter->Next();\n      }\n      if (!first) {\n        result += \" \";\n      }\n      result += \"]\";\n    }\n    delete iter;\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string AllEntriesFor(const Slice& user_key) {\n      Iterator* iter = dbfull()->TEST_NewInternalIterator();\n      InternalKey target(user_key, kMaxSequenceNumber, kTypeValue);\n      iter->Seek(target.Encode());\n      std::string result;\n      if (!iter->status().ok()) {\n        result = iter->status().ToString();\n      } else {\n        result = \"[ \";\n        bool first = true;\n        while (iter->Valid()) {\n          ParsedInternalKey ikey;\n          if (!ParseInternalKey(iter->key(), &ikey)) {\n            result += \"CORRUPTED\";\n          } else {\n            if (last_options_.comparator->Compare(ikey.user_key, user_key) != 0) {\n              break;\n            }\n            if (!first) {\n              result += \", \";\n            }\n            first = false;\n            switch (ikey.type) {\n              case kTypeValue:\n                result += iter->value().ToString();\n                break;\n              case kTypeDeletion:\n                result += \"DEL\";\n                break;\n            }\n          }\n          iter->Next();\n        }\n        if (!first) {\n          result += \" \";\n        }\n        result += \"]\";\n      }\n      delete iter;\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "last-1",
            "NULL",
            "NULL"
          ],
          "line": 1278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "AllEntriesFor(\"foo\")",
            "\"[ DEL, v1 ]\""
          ],
          "line": 1277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "last-2",
            "NULL",
            "NULL"
          ],
          "line": 1275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "AllEntriesFor(\"foo\")",
            "\"[ DEL, v1 ]\""
          ],
          "line": 1274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "dbfull()->TEST_CompactMemTable()"
          ],
          "line": 1273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "AllEntriesFor(\"foo\")",
            "\"[ DEL, v1 ]\""
          ],
          "line": 1272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Delete",
          "args": [
            "\"foo\""
          ],
          "line": 1271
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "292-294",
          "snippet": "Status Delete(const std::string& k) {\n    return db_->Delete(WriteOptions(), k);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Delete(const std::string& k) {\n      return db_->Delete(WriteOptions(), k);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(last-1)",
            "1"
          ],
          "line": 1269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NumTableFilesAtLevel",
          "args": [
            "last-1"
          ],
          "line": 1269
        },
        "resolved": true,
        "details": {
          "function_name": "NumTableFilesAtLevel",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "378-384",
          "snippet": "int NumTableFilesAtLevel(int level) {\n    std::string property;\n    ASSERT_TRUE(\n        db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                         &property));\n    return atoi(property.c_str());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int NumTableFilesAtLevel(int level) {\n      std::string property;\n      ASSERT_TRUE(\n          db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                           &property));\n      return atoi(property.c_str());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(last)",
            "1"
          ],
          "line": 1268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"z\"",
            "\"end\""
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(last)",
            "1"
          ],
          "line": 1262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "dbfull()->TEST_CompactMemTable()"
          ],
          "line": 1260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1260
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, DeletionMarkers2) {\n  Put(\"foo\", \"v1\");\n  ASSERT_OK(dbfull()->TEST_CompactMemTable());\n  const int last = config::kMaxMemCompactLevel;\n  ASSERT_EQ(NumTableFilesAtLevel(last), 1);   // foo => v1 is now in last level\n\n  // Place a table at level last-1 to prevent merging with preceding mutation\n  Put(\"a\", \"begin\");\n  Put(\"z\", \"end\");\n  dbfull()->TEST_CompactMemTable();\n  ASSERT_EQ(NumTableFilesAtLevel(last), 1);\n  ASSERT_EQ(NumTableFilesAtLevel(last-1), 1);\n\n  Delete(\"foo\");\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ DEL, v1 ]\");\n  ASSERT_OK(dbfull()->TEST_CompactMemTable());  // Moves to level last-2\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ DEL, v1 ]\");\n  dbfull()->TEST_CompactRange(last-2, NULL, NULL);\n  // DEL kept: \"last\" file overlaps\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ DEL, v1 ]\");\n  dbfull()->TEST_CompactRange(last-1, NULL, NULL);\n  // Merging last-1 w/ last, so we are the base level for \"foo\", so\n  // DEL is removed.  (as is v1).\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ ]\");\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1229-1256",
    "snippet": "TEST(DBTest, DeletionMarkers1) {\n  Put(\"foo\", \"v1\");\n  ASSERT_OK(dbfull()->TEST_CompactMemTable());\n  const int last = config::kMaxMemCompactLevel;\n  ASSERT_EQ(NumTableFilesAtLevel(last), 1);   // foo => v1 is now in last level\n\n  // Place a table at level last-1 to prevent merging with preceding mutation\n  Put(\"a\", \"begin\");\n  Put(\"z\", \"end\");\n  dbfull()->TEST_CompactMemTable();\n  ASSERT_EQ(NumTableFilesAtLevel(last), 1);\n  ASSERT_EQ(NumTableFilesAtLevel(last-1), 1);\n\n  Delete(\"foo\");\n  Put(\"foo\", \"v2\");\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ v2, DEL, v1 ]\");\n  ASSERT_OK(dbfull()->TEST_CompactMemTable());  // Moves to level last-2\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ v2, DEL, v1 ]\");\n  Slice z(\"z\");\n  dbfull()->TEST_CompactRange(last-2, NULL, &z);\n  // DEL eliminated, but v1 remains because we aren't compacting that level\n  // (DEL can be eliminated because v2 hides v1).\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ v2, v1 ]\");\n  dbfull()->TEST_CompactRange(last-1, NULL, NULL);\n  // Merging last-1 w/ last, so we are the base level for \"foo\", so\n  // DEL is removed.  (as is v1).\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ v2 ]\");\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "AllEntriesFor(\"foo\")",
            "\"[ v2 ]\""
          ],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AllEntriesFor",
          "args": [
            "\"foo\""
          ],
          "line": 1255
        },
        "resolved": true,
        "details": {
          "function_name": "AllEntriesFor",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "336-376",
          "snippet": "std::string AllEntriesFor(const Slice& user_key) {\n    Iterator* iter = dbfull()->TEST_NewInternalIterator();\n    InternalKey target(user_key, kMaxSequenceNumber, kTypeValue);\n    iter->Seek(target.Encode());\n    std::string result;\n    if (!iter->status().ok()) {\n      result = iter->status().ToString();\n    } else {\n      result = \"[ \";\n      bool first = true;\n      while (iter->Valid()) {\n        ParsedInternalKey ikey;\n        if (!ParseInternalKey(iter->key(), &ikey)) {\n          result += \"CORRUPTED\";\n        } else {\n          if (last_options_.comparator->Compare(ikey.user_key, user_key) != 0) {\n            break;\n          }\n          if (!first) {\n            result += \", \";\n          }\n          first = false;\n          switch (ikey.type) {\n            case kTypeValue:\n              result += iter->value().ToString();\n              break;\n            case kTypeDeletion:\n              result += \"DEL\";\n              break;\n          }\n        }\n        iter->Next();\n      }\n      if (!first) {\n        result += \" \";\n      }\n      result += \"]\";\n    }\n    delete iter;\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string AllEntriesFor(const Slice& user_key) {\n      Iterator* iter = dbfull()->TEST_NewInternalIterator();\n      InternalKey target(user_key, kMaxSequenceNumber, kTypeValue);\n      iter->Seek(target.Encode());\n      std::string result;\n      if (!iter->status().ok()) {\n        result = iter->status().ToString();\n      } else {\n        result = \"[ \";\n        bool first = true;\n        while (iter->Valid()) {\n          ParsedInternalKey ikey;\n          if (!ParseInternalKey(iter->key(), &ikey)) {\n            result += \"CORRUPTED\";\n          } else {\n            if (last_options_.comparator->Compare(ikey.user_key, user_key) != 0) {\n              break;\n            }\n            if (!first) {\n              result += \", \";\n            }\n            first = false;\n            switch (ikey.type) {\n              case kTypeValue:\n                result += iter->value().ToString();\n                break;\n              case kTypeDeletion:\n                result += \"DEL\";\n                break;\n            }\n          }\n          iter->Next();\n        }\n        if (!first) {\n          result += \" \";\n        }\n        result += \"]\";\n      }\n      delete iter;\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "last-1",
            "NULL",
            "NULL"
          ],
          "line": 1252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "AllEntriesFor(\"foo\")",
            "\"[ v2, v1 ]\""
          ],
          "line": 1251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "last-2",
            "NULL",
            "&z"
          ],
          "line": 1248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "AllEntriesFor(\"foo\")",
            "\"[ v2, DEL, v1 ]\""
          ],
          "line": 1246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "dbfull()->TEST_CompactMemTable()"
          ],
          "line": 1245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "AllEntriesFor(\"foo\")",
            "\"[ v2, DEL, v1 ]\""
          ],
          "line": 1244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"v2\""
          ],
          "line": 1243
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Delete",
          "args": [
            "\"foo\""
          ],
          "line": 1242
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "292-294",
          "snippet": "Status Delete(const std::string& k) {\n    return db_->Delete(WriteOptions(), k);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Delete(const std::string& k) {\n      return db_->Delete(WriteOptions(), k);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(last-1)",
            "1"
          ],
          "line": 1240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NumTableFilesAtLevel",
          "args": [
            "last-1"
          ],
          "line": 1240
        },
        "resolved": true,
        "details": {
          "function_name": "NumTableFilesAtLevel",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "378-384",
          "snippet": "int NumTableFilesAtLevel(int level) {\n    std::string property;\n    ASSERT_TRUE(\n        db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                         &property));\n    return atoi(property.c_str());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int NumTableFilesAtLevel(int level) {\n      std::string property;\n      ASSERT_TRUE(\n          db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                           &property));\n      return atoi(property.c_str());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(last)",
            "1"
          ],
          "line": 1239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(last)",
            "1"
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "dbfull()->TEST_CompactMemTable()"
          ],
          "line": 1231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1231
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, DeletionMarkers1) {\n  Put(\"foo\", \"v1\");\n  ASSERT_OK(dbfull()->TEST_CompactMemTable());\n  const int last = config::kMaxMemCompactLevel;\n  ASSERT_EQ(NumTableFilesAtLevel(last), 1);   // foo => v1 is now in last level\n\n  // Place a table at level last-1 to prevent merging with preceding mutation\n  Put(\"a\", \"begin\");\n  Put(\"z\", \"end\");\n  dbfull()->TEST_CompactMemTable();\n  ASSERT_EQ(NumTableFilesAtLevel(last), 1);\n  ASSERT_EQ(NumTableFilesAtLevel(last-1), 1);\n\n  Delete(\"foo\");\n  Put(\"foo\", \"v2\");\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ v2, DEL, v1 ]\");\n  ASSERT_OK(dbfull()->TEST_CompactMemTable());  // Moves to level last-2\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ v2, DEL, v1 ]\");\n  Slice z(\"z\");\n  dbfull()->TEST_CompactRange(last-2, NULL, &z);\n  // DEL eliminated, but v1 remains because we aren't compacting that level\n  // (DEL can be eliminated because v2 hides v1).\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ v2, v1 ]\");\n  dbfull()->TEST_CompactRange(last-1, NULL, NULL);\n  // Merging last-1 w/ last, so we are the base level for \"foo\", so\n  // DEL is removed.  (as is v1).\n  ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ v2 ]\");\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1198-1227",
    "snippet": "TEST(DBTest, HiddenValuesAreRemoved) {\n  do {\n    Random rnd(301);\n    FillLevels(\"a\", \"z\");\n\n    std::string big = RandomString(&rnd, 50000);\n    Put(\"foo\", big);\n    Put(\"pastfoo\", \"v\");\n    const Snapshot* snapshot = db_->GetSnapshot();\n    Put(\"foo\", \"tiny\");\n    Put(\"pastfoo2\", \"v2\");        // Advance sequence number one more\n\n    ASSERT_OK(dbfull()->TEST_CompactMemTable());\n    ASSERT_GT(NumTableFilesAtLevel(0), 0);\n\n    ASSERT_EQ(big, Get(\"foo\", snapshot));\n    ASSERT_TRUE(Between(Size(\"\", \"pastfoo\"), 50000, 60000));\n    db_->ReleaseSnapshot(snapshot);\n    ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ tiny, \" + big + \" ]\");\n    Slice x(\"x\");\n    dbfull()->TEST_CompactRange(0, NULL, &x);\n    ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ tiny ]\");\n    ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n    ASSERT_GE(NumTableFilesAtLevel(1), 1);\n    dbfull()->TEST_CompactRange(1, NULL, &x);\n    ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ tiny ]\");\n\n    ASSERT_TRUE(Between(Size(\"\", \"pastfoo\"), 0, 1000));\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 1226
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", \"pastfoo\"), 0, 1000)"
          ],
          "line": 1225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Between",
          "args": [
            "Size(\"\", \"pastfoo\")",
            "0",
            "1000"
          ],
          "line": 1225
        },
        "resolved": true,
        "details": {
          "function_name": "Between",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1048-1057",
          "snippet": "static bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Size",
          "args": [
            "\"\"",
            "\"pastfoo\""
          ],
          "line": 1225
        },
        "resolved": true,
        "details": {
          "function_name": "Size",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "417-422",
          "snippet": "uint64_t Size(const Slice& start, const Slice& limit) {\n    Range r(start, limit);\n    uint64_t size;\n    db_->GetApproximateSizes(&r, 1, &size);\n    return size;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  uint64_t Size(const Slice& start, const Slice& limit) {\n      Range r(start, limit);\n      uint64_t size;\n      db_->GetApproximateSizes(&r, 1, &size);\n      return size;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "AllEntriesFor(\"foo\")",
            "\"[ tiny ]\""
          ],
          "line": 1223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AllEntriesFor",
          "args": [
            "\"foo\""
          ],
          "line": 1223
        },
        "resolved": true,
        "details": {
          "function_name": "AllEntriesFor",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "336-376",
          "snippet": "std::string AllEntriesFor(const Slice& user_key) {\n    Iterator* iter = dbfull()->TEST_NewInternalIterator();\n    InternalKey target(user_key, kMaxSequenceNumber, kTypeValue);\n    iter->Seek(target.Encode());\n    std::string result;\n    if (!iter->status().ok()) {\n      result = iter->status().ToString();\n    } else {\n      result = \"[ \";\n      bool first = true;\n      while (iter->Valid()) {\n        ParsedInternalKey ikey;\n        if (!ParseInternalKey(iter->key(), &ikey)) {\n          result += \"CORRUPTED\";\n        } else {\n          if (last_options_.comparator->Compare(ikey.user_key, user_key) != 0) {\n            break;\n          }\n          if (!first) {\n            result += \", \";\n          }\n          first = false;\n          switch (ikey.type) {\n            case kTypeValue:\n              result += iter->value().ToString();\n              break;\n            case kTypeDeletion:\n              result += \"DEL\";\n              break;\n          }\n        }\n        iter->Next();\n      }\n      if (!first) {\n        result += \" \";\n      }\n      result += \"]\";\n    }\n    delete iter;\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string AllEntriesFor(const Slice& user_key) {\n      Iterator* iter = dbfull()->TEST_NewInternalIterator();\n      InternalKey target(user_key, kMaxSequenceNumber, kTypeValue);\n      iter->Seek(target.Encode());\n      std::string result;\n      if (!iter->status().ok()) {\n        result = iter->status().ToString();\n      } else {\n        result = \"[ \";\n        bool first = true;\n        while (iter->Valid()) {\n          ParsedInternalKey ikey;\n          if (!ParseInternalKey(iter->key(), &ikey)) {\n            result += \"CORRUPTED\";\n          } else {\n            if (last_options_.comparator->Compare(ikey.user_key, user_key) != 0) {\n              break;\n            }\n            if (!first) {\n              result += \", \";\n            }\n            first = false;\n            switch (ikey.type) {\n              case kTypeValue:\n                result += iter->value().ToString();\n                break;\n              case kTypeDeletion:\n                result += \"DEL\";\n                break;\n            }\n          }\n          iter->Next();\n        }\n        if (!first) {\n          result += \" \";\n        }\n        result += \"]\";\n      }\n      delete iter;\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "1",
            "NULL",
            "&x"
          ],
          "line": 1222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_GE",
          "args": [
            "NumTableFilesAtLevel(1)",
            "1"
          ],
          "line": 1221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NumTableFilesAtLevel",
          "args": [
            "1"
          ],
          "line": 1221
        },
        "resolved": true,
        "details": {
          "function_name": "NumTableFilesAtLevel",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "378-384",
          "snippet": "int NumTableFilesAtLevel(int level) {\n    std::string property;\n    ASSERT_TRUE(\n        db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                         &property));\n    return atoi(property.c_str());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int NumTableFilesAtLevel(int level) {\n      std::string property;\n      ASSERT_TRUE(\n          db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                           &property));\n      return atoi(property.c_str());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(0)",
            "0"
          ],
          "line": 1220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "AllEntriesFor(\"foo\")",
            "\"[ tiny ]\""
          ],
          "line": 1219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "0",
            "NULL",
            "&x"
          ],
          "line": 1218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "AllEntriesFor(\"foo\")",
            "\"[ tiny, \" + big + \" ]\""
          ],
          "line": 1216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->ReleaseSnapshot",
          "args": [
            "snapshot"
          ],
          "line": 1215
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSnapshot",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1868-1870",
          "snippet": "virtual void ReleaseSnapshot(const Snapshot* snapshot) {\n    delete reinterpret_cast<const ModelSnapshot*>(snapshot);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void ReleaseSnapshot(const Snapshot* snapshot) {\n      delete reinterpret_cast<const ModelSnapshot*>(snapshot);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", \"pastfoo\"), 50000, 60000)"
          ],
          "line": 1214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "big",
            "Get(\"foo\", snapshot)"
          ],
          "line": 1213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\"",
            "snapshot"
          ],
          "line": 1213
        },
        "resolved": true,
        "details": {
          "function_name": "GetProperty",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1887-1889",
          "snippet": "virtual bool GetProperty(const Slice& property, std::string* value) {\n    return false;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual bool GetProperty(const Slice& property, std::string* value) {\n      return false;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_GT",
          "args": [
            "NumTableFilesAtLevel(0)",
            "0"
          ],
          "line": 1211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "dbfull()->TEST_CompactMemTable()"
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"pastfoo2\"",
            "\"v2\""
          ],
          "line": 1208
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->GetSnapshot",
          "args": [],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RandomString",
          "args": [
            "&rnd",
            "50000"
          ],
          "line": 1203
        },
        "resolved": true,
        "details": {
          "function_name": "RandomString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "22-26",
          "snippet": "static std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "FillLevels",
          "args": [
            "\"a\"",
            "\"z\""
          ],
          "line": 1201
        },
        "resolved": true,
        "details": {
          "function_name": "FillLevels",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "440-442",
          "snippet": "void FillLevels(const std::string& smallest, const std::string& largest) {\n    MakeTables(config::kNumLevels, smallest, largest);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void FillLevels(const std::string& smallest, const std::string& largest) {\n      MakeTables(config::kNumLevels, smallest, largest);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, HiddenValuesAreRemoved) {\n  do {\n    Random rnd(301);\n    FillLevels(\"a\", \"z\");\n\n    std::string big = RandomString(&rnd, 50000);\n    Put(\"foo\", big);\n    Put(\"pastfoo\", \"v\");\n    const Snapshot* snapshot = db_->GetSnapshot();\n    Put(\"foo\", \"tiny\");\n    Put(\"pastfoo2\", \"v2\");        // Advance sequence number one more\n\n    ASSERT_OK(dbfull()->TEST_CompactMemTable());\n    ASSERT_GT(NumTableFilesAtLevel(0), 0);\n\n    ASSERT_EQ(big, Get(\"foo\", snapshot));\n    ASSERT_TRUE(Between(Size(\"\", \"pastfoo\"), 50000, 60000));\n    db_->ReleaseSnapshot(snapshot);\n    ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ tiny, \" + big + \" ]\");\n    Slice x(\"x\");\n    dbfull()->TEST_CompactRange(0, NULL, &x);\n    ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ tiny ]\");\n    ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n    ASSERT_GE(NumTableFilesAtLevel(1), 1);\n    dbfull()->TEST_CompactRange(1, NULL, &x);\n    ASSERT_EQ(AllEntriesFor(\"foo\"), \"[ tiny ]\");\n\n    ASSERT_TRUE(Between(Size(\"\", \"pastfoo\"), 0, 1000));\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1169-1196",
    "snippet": "TEST(DBTest, Snapshot) {\n  do {\n    Put(\"foo\", \"v1\");\n    const Snapshot* s1 = db_->GetSnapshot();\n    Put(\"foo\", \"v2\");\n    const Snapshot* s2 = db_->GetSnapshot();\n    Put(\"foo\", \"v3\");\n    const Snapshot* s3 = db_->GetSnapshot();\n\n    Put(\"foo\", \"v4\");\n    ASSERT_EQ(\"v1\", Get(\"foo\", s1));\n    ASSERT_EQ(\"v2\", Get(\"foo\", s2));\n    ASSERT_EQ(\"v3\", Get(\"foo\", s3));\n    ASSERT_EQ(\"v4\", Get(\"foo\"));\n\n    db_->ReleaseSnapshot(s3);\n    ASSERT_EQ(\"v1\", Get(\"foo\", s1));\n    ASSERT_EQ(\"v2\", Get(\"foo\", s2));\n    ASSERT_EQ(\"v4\", Get(\"foo\"));\n\n    db_->ReleaseSnapshot(s1);\n    ASSERT_EQ(\"v2\", Get(\"foo\", s2));\n    ASSERT_EQ(\"v4\", Get(\"foo\"));\n\n    db_->ReleaseSnapshot(s2);\n    ASSERT_EQ(\"v4\", Get(\"foo\"));\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 1195
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v4\"",
            "Get(\"foo\")"
          ],
          "line": 1194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\""
          ],
          "line": 1194
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->ReleaseSnapshot",
          "args": [
            "s2"
          ],
          "line": 1193
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSnapshot",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1868-1870",
          "snippet": "virtual void ReleaseSnapshot(const Snapshot* snapshot) {\n    delete reinterpret_cast<const ModelSnapshot*>(snapshot);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void ReleaseSnapshot(const Snapshot* snapshot) {\n      delete reinterpret_cast<const ModelSnapshot*>(snapshot);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v4\"",
            "Get(\"foo\")"
          ],
          "line": 1191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v2\"",
            "Get(\"foo\", s2)"
          ],
          "line": 1190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\"",
            "s2"
          ],
          "line": 1190
        },
        "resolved": true,
        "details": {
          "function_name": "GetProperty",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1887-1889",
          "snippet": "virtual bool GetProperty(const Slice& property, std::string* value) {\n    return false;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual bool GetProperty(const Slice& property, std::string* value) {\n      return false;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v4\"",
            "Get(\"foo\")"
          ],
          "line": 1187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v2\"",
            "Get(\"foo\", s2)"
          ],
          "line": 1186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"foo\", s1)"
          ],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v4\"",
            "Get(\"foo\")"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v3\"",
            "Get(\"foo\", s3)"
          ],
          "line": 1181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v2\"",
            "Get(\"foo\", s2)"
          ],
          "line": 1180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"foo\", s1)"
          ],
          "line": 1179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"v4\""
          ],
          "line": 1178
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->GetSnapshot",
          "args": [],
          "line": 1176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->GetSnapshot",
          "args": [],
          "line": 1174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->GetSnapshot",
          "args": [],
          "line": 1172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, Snapshot) {\n  do {\n    Put(\"foo\", \"v1\");\n    const Snapshot* s1 = db_->GetSnapshot();\n    Put(\"foo\", \"v2\");\n    const Snapshot* s2 = db_->GetSnapshot();\n    Put(\"foo\", \"v3\");\n    const Snapshot* s3 = db_->GetSnapshot();\n\n    Put(\"foo\", \"v4\");\n    ASSERT_EQ(\"v1\", Get(\"foo\", s1));\n    ASSERT_EQ(\"v2\", Get(\"foo\", s2));\n    ASSERT_EQ(\"v3\", Get(\"foo\", s3));\n    ASSERT_EQ(\"v4\", Get(\"foo\"));\n\n    db_->ReleaseSnapshot(s3);\n    ASSERT_EQ(\"v1\", Get(\"foo\", s1));\n    ASSERT_EQ(\"v2\", Get(\"foo\", s2));\n    ASSERT_EQ(\"v4\", Get(\"foo\"));\n\n    db_->ReleaseSnapshot(s1);\n    ASSERT_EQ(\"v2\", Get(\"foo\", s2));\n    ASSERT_EQ(\"v4\", Get(\"foo\"));\n\n    db_->ReleaseSnapshot(s2);\n    ASSERT_EQ(\"v4\", Get(\"foo\"));\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1147-1167",
    "snippet": "TEST(DBTest, IteratorPinsRef) {\n  Put(\"foo\", \"hello\");\n\n  // Get iterator that will yield the current contents of the DB.\n  Iterator* iter = db_->NewIterator(ReadOptions());\n\n  // Write to force compactions\n  Put(\"foo\", \"newvalue1\");\n  for (int i = 0; i < 100; i++) {\n    ASSERT_OK(Put(Key(i), Key(i) + std::string(100000, 'v'))); // 100K values\n  }\n  Put(\"foo\", \"newvalue2\");\n\n  iter->SeekToFirst();\n  ASSERT_TRUE(iter->Valid());\n  ASSERT_EQ(\"foo\", iter->key().ToString());\n  ASSERT_EQ(\"hello\", iter->value().ToString());\n  iter->Next();\n  ASSERT_TRUE(!iter->Valid());\n  delete iter;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "!iter->Valid()"
          ],
          "line": 1165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Valid",
          "args": [],
          "line": 1165
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1907-1907",
          "snippet": "virtual bool Valid() const { return iter_ != map_->end(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual bool Valid() const { return iter_ != map_->end(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Next",
          "args": [],
          "line": 1164
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1919-1919",
          "snippet": "virtual void Next() { ++iter_; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Next() { ++iter_; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"hello\"",
            "iter->value().ToString()"
          ],
          "line": 1163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->value",
          "args": [],
          "line": 1163
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1922-1922",
          "snippet": "virtual Slice value() const { return iter_->second; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual Slice value() const { return iter_->second; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"foo\"",
            "iter->key().ToString()"
          ],
          "line": 1162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->key",
          "args": [],
          "line": 1162
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1921-1921",
          "snippet": "virtual Slice key() const { return iter_->first; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual Slice key() const { return iter_->first; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "iter->Valid()"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->SeekToFirst",
          "args": [],
          "line": 1160
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1908-1908",
          "snippet": "virtual void SeekToFirst() { iter_ = map_->begin(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToFirst() { iter_ = map_->begin(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"newvalue2\""
          ],
          "line": 1158
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(i), Key(i) + std::string(100000, 'v'))"
          ],
          "line": 1156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "100000",
            "'v'"
          ],
          "line": 1156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Key",
          "args": [
            "i"
          ],
          "line": 1156
        },
        "resolved": true,
        "details": {
          "function_name": "MakeKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "2059-2063",
          "snippet": "std::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstd::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->NewIterator",
          "args": [
            "ReadOptions()"
          ],
          "line": 1151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReadOptions",
          "args": [],
          "line": 1151
        },
        "resolved": true,
        "details": {
          "function_name": "ReadOptions",
          "container": "ReadOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "161-165",
          "snippet": "ReadOptions()\n      : verify_checksums(false),\n        fill_cache(true),\n        snapshot(NULL) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nReadOptions {\n  ReadOptions()\n        : verify_checksums(false),\n          fill_cache(true),\n          snapshot(NULL) {\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, IteratorPinsRef) {\n  Put(\"foo\", \"hello\");\n\n  // Get iterator that will yield the current contents of the DB.\n  Iterator* iter = db_->NewIterator(ReadOptions());\n\n  // Write to force compactions\n  Put(\"foo\", \"newvalue1\");\n  for (int i = 0; i < 100; i++) {\n    ASSERT_OK(Put(Key(i), Key(i) + std::string(100000, 'v'))); // 100K values\n  }\n  Put(\"foo\", \"newvalue2\");\n\n  iter->SeekToFirst();\n  ASSERT_TRUE(iter->Valid());\n  ASSERT_EQ(\"foo\", iter->key().ToString());\n  ASSERT_EQ(\"hello\", iter->value().ToString());\n  iter->Next();\n  ASSERT_TRUE(!iter->Valid());\n  delete iter;\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1109-1145",
    "snippet": "TEST(DBTest, ApproximateSizes_MixOfSmallAndLarge) {\n  do {\n    Options options = CurrentOptions();\n    options.compression = kNoCompression;\n    Reopen();\n\n    Random rnd(301);\n    std::string big1 = RandomString(&rnd, 100000);\n    ASSERT_OK(Put(Key(0), RandomString(&rnd, 10000)));\n    ASSERT_OK(Put(Key(1), RandomString(&rnd, 10000)));\n    ASSERT_OK(Put(Key(2), big1));\n    ASSERT_OK(Put(Key(3), RandomString(&rnd, 10000)));\n    ASSERT_OK(Put(Key(4), big1));\n    ASSERT_OK(Put(Key(5), RandomString(&rnd, 10000)));\n    ASSERT_OK(Put(Key(6), RandomString(&rnd, 300000)));\n    ASSERT_OK(Put(Key(7), RandomString(&rnd, 10000)));\n\n    // Check sizes across recovery by reopening a few times\n    for (int run = 0; run < 3; run++) {\n      Reopen(&options);\n\n      ASSERT_TRUE(Between(Size(\"\", Key(0)), 0, 0));\n      ASSERT_TRUE(Between(Size(\"\", Key(1)), 10000, 11000));\n      ASSERT_TRUE(Between(Size(\"\", Key(2)), 20000, 21000));\n      ASSERT_TRUE(Between(Size(\"\", Key(3)), 120000, 121000));\n      ASSERT_TRUE(Between(Size(\"\", Key(4)), 130000, 131000));\n      ASSERT_TRUE(Between(Size(\"\", Key(5)), 230000, 231000));\n      ASSERT_TRUE(Between(Size(\"\", Key(6)), 240000, 241000));\n      ASSERT_TRUE(Between(Size(\"\", Key(7)), 540000, 541000));\n      ASSERT_TRUE(Between(Size(\"\", Key(8)), 550000, 560000));\n\n      ASSERT_TRUE(Between(Size(Key(3), Key(5)), 110000, 111000));\n\n      dbfull()->TEST_CompactRange(0, NULL, NULL);\n    }\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 1144
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "0",
            "NULL",
            "NULL"
          ],
          "line": 1142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(Key(3), Key(5)), 110000, 111000)"
          ],
          "line": 1140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Between",
          "args": [
            "Size(Key(3), Key(5))",
            "110000",
            "111000"
          ],
          "line": 1140
        },
        "resolved": true,
        "details": {
          "function_name": "Between",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1048-1057",
          "snippet": "static bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Size",
          "args": [
            "Key(3)",
            "Key(5)"
          ],
          "line": 1140
        },
        "resolved": true,
        "details": {
          "function_name": "Size",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "417-422",
          "snippet": "uint64_t Size(const Slice& start, const Slice& limit) {\n    Range r(start, limit);\n    uint64_t size;\n    db_->GetApproximateSizes(&r, 1, &size);\n    return size;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  uint64_t Size(const Slice& start, const Slice& limit) {\n      Range r(start, limit);\n      uint64_t size;\n      db_->GetApproximateSizes(&r, 1, &size);\n      return size;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Key",
          "args": [
            "5"
          ],
          "line": 1140
        },
        "resolved": true,
        "details": {
          "function_name": "MakeKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "2059-2063",
          "snippet": "std::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstd::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(8)), 550000, 560000)"
          ],
          "line": 1138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(7)), 540000, 541000)"
          ],
          "line": 1137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(6)), 240000, 241000)"
          ],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(5)), 230000, 231000)"
          ],
          "line": 1135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(4)), 130000, 131000)"
          ],
          "line": 1134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(3)), 120000, 121000)"
          ],
          "line": 1133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(2)), 20000, 21000)"
          ],
          "line": 1132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(1)), 10000, 11000)"
          ],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(0)), 0, 0)"
          ],
          "line": 1130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 1128
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(7), RandomString(&rnd, 10000))"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "Key(7)",
            "RandomString(&rnd, 10000)"
          ],
          "line": 1124
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "RandomString",
          "args": [
            "&rnd",
            "10000"
          ],
          "line": 1124
        },
        "resolved": true,
        "details": {
          "function_name": "RandomString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "22-26",
          "snippet": "static std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(6), RandomString(&rnd, 300000))"
          ],
          "line": 1123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(5), RandomString(&rnd, 10000))"
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(4), big1)"
          ],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(3), RandomString(&rnd, 10000))"
          ],
          "line": 1120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(2), big1)"
          ],
          "line": 1119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(1), RandomString(&rnd, 10000))"
          ],
          "line": 1118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(0), RandomString(&rnd, 10000))"
          ],
          "line": 1117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [],
          "line": 1113
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyAndReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "266-271",
          "snippet": "void DestroyAndReopen(Options* options = NULL) {\n    delete db_;\n    db_ = NULL;\n    DestroyDB(dbname_, Options());\n    ASSERT_OK(TryReopen(options));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void DestroyAndReopen(Options* options = NULL) {\n      delete db_;\n      db_ = NULL;\n      DestroyDB(dbname_, Options());\n      ASSERT_OK(TryReopen(options));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 1111
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, ApproximateSizes_MixOfSmallAndLarge) {\n  do {\n    Options options = CurrentOptions();\n    options.compression = kNoCompression;\n    Reopen();\n\n    Random rnd(301);\n    std::string big1 = RandomString(&rnd, 100000);\n    ASSERT_OK(Put(Key(0), RandomString(&rnd, 10000)));\n    ASSERT_OK(Put(Key(1), RandomString(&rnd, 10000)));\n    ASSERT_OK(Put(Key(2), big1));\n    ASSERT_OK(Put(Key(3), RandomString(&rnd, 10000)));\n    ASSERT_OK(Put(Key(4), big1));\n    ASSERT_OK(Put(Key(5), RandomString(&rnd, 10000)));\n    ASSERT_OK(Put(Key(6), RandomString(&rnd, 300000)));\n    ASSERT_OK(Put(Key(7), RandomString(&rnd, 10000)));\n\n    // Check sizes across recovery by reopening a few times\n    for (int run = 0; run < 3; run++) {\n      Reopen(&options);\n\n      ASSERT_TRUE(Between(Size(\"\", Key(0)), 0, 0));\n      ASSERT_TRUE(Between(Size(\"\", Key(1)), 10000, 11000));\n      ASSERT_TRUE(Between(Size(\"\", Key(2)), 20000, 21000));\n      ASSERT_TRUE(Between(Size(\"\", Key(3)), 120000, 121000));\n      ASSERT_TRUE(Between(Size(\"\", Key(4)), 130000, 131000));\n      ASSERT_TRUE(Between(Size(\"\", Key(5)), 230000, 231000));\n      ASSERT_TRUE(Between(Size(\"\", Key(6)), 240000, 241000));\n      ASSERT_TRUE(Between(Size(\"\", Key(7)), 540000, 541000));\n      ASSERT_TRUE(Between(Size(\"\", Key(8)), 550000, 560000));\n\n      ASSERT_TRUE(Between(Size(Key(3), Key(5)), 110000, 111000));\n\n      dbfull()->TEST_CompactRange(0, NULL, NULL);\n    }\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1059-1107",
    "snippet": "TEST(DBTest, ApproximateSizes) {\n  do {\n    Options options = CurrentOptions();\n    options.write_buffer_size = 100000000;        // Large write buffer\n    options.compression = kNoCompression;\n    DestroyAndReopen();\n\n    ASSERT_TRUE(Between(Size(\"\", \"xyz\"), 0, 0));\n    Reopen(&options);\n    ASSERT_TRUE(Between(Size(\"\", \"xyz\"), 0, 0));\n\n    // Write 8MB (80 values, each 100K)\n    ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n    const int N = 80;\n    static const int S1 = 100000;\n    static const int S2 = 105000;  // Allow some expansion from metadata\n    Random rnd(301);\n    for (int i = 0; i < N; i++) {\n      ASSERT_OK(Put(Key(i), RandomString(&rnd, S1)));\n    }\n\n    // 0 because GetApproximateSizes() does not account for memtable space\n    ASSERT_TRUE(Between(Size(\"\", Key(50)), 0, 0));\n\n    // Check sizes across recovery by reopening a few times\n    for (int run = 0; run < 3; run++) {\n      Reopen(&options);\n\n      for (int compact_start = 0; compact_start < N; compact_start += 10) {\n        for (int i = 0; i < N; i += 10) {\n          ASSERT_TRUE(Between(Size(\"\", Key(i)), S1*i, S2*i));\n          ASSERT_TRUE(Between(Size(\"\", Key(i)+\".suffix\"), S1*(i+1), S2*(i+1)));\n          ASSERT_TRUE(Between(Size(Key(i), Key(i+10)), S1*10, S2*10));\n        }\n        ASSERT_TRUE(Between(Size(\"\", Key(50)), S1*50, S2*50));\n        ASSERT_TRUE(Between(Size(\"\", Key(50)+\".suffix\"), S1*50, S2*50));\n\n        std::string cstart_str = Key(compact_start);\n        std::string cend_str = Key(compact_start + 9);\n        Slice cstart = cstart_str;\n        Slice cend = cend_str;\n        dbfull()->TEST_CompactRange(0, &cstart, &cend);\n      }\n\n      ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n      ASSERT_GT(NumTableFilesAtLevel(1), 0);\n    }\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 1106
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_GT",
          "args": [
            "NumTableFilesAtLevel(1)",
            "0"
          ],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NumTableFilesAtLevel",
          "args": [
            "1"
          ],
          "line": 1104
        },
        "resolved": true,
        "details": {
          "function_name": "NumTableFilesAtLevel",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "378-384",
          "snippet": "int NumTableFilesAtLevel(int level) {\n    std::string property;\n    ASSERT_TRUE(\n        db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                         &property));\n    return atoi(property.c_str());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int NumTableFilesAtLevel(int level) {\n      std::string property;\n      ASSERT_TRUE(\n          db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                           &property));\n      return atoi(property.c_str());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(0)",
            "0"
          ],
          "line": 1103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "0",
            "&cstart",
            "&cend"
          ],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Key",
          "args": [
            "compact_start + 9"
          ],
          "line": 1097
        },
        "resolved": true,
        "details": {
          "function_name": "MakeKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "2059-2063",
          "snippet": "std::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstd::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(50)+\".suffix\"), S1*50, S2*50)"
          ],
          "line": 1094
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Between",
          "args": [
            "Size(\"\", Key(50)+\".suffix\")",
            "S1*50",
            "S2*50"
          ],
          "line": 1094
        },
        "resolved": true,
        "details": {
          "function_name": "Between",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1048-1057",
          "snippet": "static bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Size",
          "args": [
            "\"\"",
            "Key(50)+\".suffix\""
          ],
          "line": 1094
        },
        "resolved": true,
        "details": {
          "function_name": "Size",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "417-422",
          "snippet": "uint64_t Size(const Slice& start, const Slice& limit) {\n    Range r(start, limit);\n    uint64_t size;\n    db_->GetApproximateSizes(&r, 1, &size);\n    return size;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  uint64_t Size(const Slice& start, const Slice& limit) {\n      Range r(start, limit);\n      uint64_t size;\n      db_->GetApproximateSizes(&r, 1, &size);\n      return size;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(50)), S1*50, S2*50)"
          ],
          "line": 1093
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(Key(i), Key(i+10)), S1*10, S2*10)"
          ],
          "line": 1091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(i)+\".suffix\"), S1*(i+1), S2*(i+1))"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(i)), S1*i, S2*i)"
          ],
          "line": 1089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", Key(50)), 0, 0)"
          ],
          "line": 1081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(i), RandomString(&rnd, S1))"
          ],
          "line": 1077
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "Key(i)",
            "RandomString(&rnd, S1)"
          ],
          "line": 1077
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "RandomString",
          "args": [
            "&rnd",
            "S1"
          ],
          "line": 1077
        },
        "resolved": true,
        "details": {
          "function_name": "RandomString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "22-26",
          "snippet": "static std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(0)",
            "0"
          ],
          "line": 1071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", \"xyz\"), 0, 0)"
          ],
          "line": 1068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "Between(Size(\"\", \"xyz\"), 0, 0)"
          ],
          "line": 1066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DestroyAndReopen",
          "args": [],
          "line": 1064
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyAndReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "266-271",
          "snippet": "void DestroyAndReopen(Options* options = NULL) {\n    delete db_;\n    db_ = NULL;\n    DestroyDB(dbname_, Options());\n    ASSERT_OK(TryReopen(options));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void DestroyAndReopen(Options* options = NULL) {\n      delete db_;\n      db_ = NULL;\n      DestroyDB(dbname_, Options());\n      ASSERT_OK(TryReopen(options));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 1061
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, ApproximateSizes) {\n  do {\n    Options options = CurrentOptions();\n    options.write_buffer_size = 100000000;        // Large write buffer\n    options.compression = kNoCompression;\n    DestroyAndReopen();\n\n    ASSERT_TRUE(Between(Size(\"\", \"xyz\"), 0, 0));\n    Reopen(&options);\n    ASSERT_TRUE(Between(Size(\"\", \"xyz\"), 0, 0));\n\n    // Write 8MB (80 values, each 100K)\n    ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n    const int N = 80;\n    static const int S1 = 100000;\n    static const int S2 = 105000;  // Allow some expansion from metadata\n    Random rnd(301);\n    for (int i = 0; i < N; i++) {\n      ASSERT_OK(Put(Key(i), RandomString(&rnd, S1)));\n    }\n\n    // 0 because GetApproximateSizes() does not account for memtable space\n    ASSERT_TRUE(Between(Size(\"\", Key(50)), 0, 0));\n\n    // Check sizes across recovery by reopening a few times\n    for (int run = 0; run < 3; run++) {\n      Reopen(&options);\n\n      for (int compact_start = 0; compact_start < N; compact_start += 10) {\n        for (int i = 0; i < N; i += 10) {\n          ASSERT_TRUE(Between(Size(\"\", Key(i)), S1*i, S2*i));\n          ASSERT_TRUE(Between(Size(\"\", Key(i)+\".suffix\"), S1*(i+1), S2*(i+1)));\n          ASSERT_TRUE(Between(Size(Key(i), Key(i+10)), S1*10, S2*10));\n        }\n        ASSERT_TRUE(Between(Size(\"\", Key(50)), S1*50, S2*50));\n        ASSERT_TRUE(Between(Size(\"\", Key(50)+\".suffix\"), S1*50, S2*50));\n\n        std::string cstart_str = Key(compact_start);\n        std::string cend_str = Key(compact_start + 9);\n        Slice cstart = cstart_str;\n        Slice cend = cend_str;\n        dbfull()->TEST_CompactRange(0, &cstart, &cend);\n      }\n\n      ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n      ASSERT_GT(NumTableFilesAtLevel(1), 0);\n    }\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "Between",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1048-1057",
    "snippet": "static bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Value %llu is not in range [%llu, %llu]\\n\"",
            "(unsigned long long)(val)",
            "(unsigned long long)(low)",
            "(unsigned long long)(high)"
          ],
          "line": 1051
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic bool Between(uint64_t val, uint64_t low, uint64_t high) {\n  bool result = (val >= low) && (val <= high);\n  if (!result) {\n    fprintf(stderr, \"Value %llu is not in range [%llu, %llu]\\n\",\n            (unsigned long long)(val),\n            (unsigned long long)(low),\n            (unsigned long long)(high));\n  }\n  return result;\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "1008-1046",
    "snippet": "TEST(DBTest, SparseMerge) {\n  Options options = CurrentOptions();\n  options.compression = kNoCompression;\n  Reopen(&options);\n\n  FillLevels(\"A\", \"Z\");\n\n  // Suppose there is:\n  //    small amount of data with prefix A\n  //    large amount of data with prefix B\n  //    small amount of data with prefix C\n  // and that recent updates have made small changes to all three prefixes.\n  // Check that we do not do a compaction that merges all of B in one shot.\n  const std::string value(1000, 'x');\n  Put(\"A\", \"va\");\n  // Write approximately 100MB of \"B\" values\n  for (int i = 0; i < 100000; i++) {\n    char key[100];\n    snprintf(key, sizeof(key), \"B%010d\", i);\n    Put(key, value);\n  }\n  Put(\"C\", \"vc\");\n  dbfull()->TEST_CompactMemTable();\n  dbfull()->TEST_CompactRange(0, NULL, NULL);\n\n  // Make sparse update\n  Put(\"A\",    \"va2\");\n  Put(\"B100\", \"bvalue2\");\n  Put(\"C\",    \"vc2\");\n  dbfull()->TEST_CompactMemTable();\n\n  // Compactions should not cause us to create a situation where\n  // a file overlaps too much data at the next level.\n  ASSERT_LE(dbfull()->TEST_MaxNextLevelOverlappingBytes(), 20*1048576);\n  dbfull()->TEST_CompactRange(0, NULL, NULL);\n  ASSERT_LE(dbfull()->TEST_MaxNextLevelOverlappingBytes(), 20*1048576);\n  dbfull()->TEST_CompactRange(1, NULL, NULL);\n  ASSERT_LE(dbfull()->TEST_MaxNextLevelOverlappingBytes(), 20*1048576);\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "dbfull()->TEST_MaxNextLevelOverlappingBytes()",
            "20*1048576"
          ],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "1",
            "NULL",
            "NULL"
          ],
          "line": 1044
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1044
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "dbfull()->TEST_MaxNextLevelOverlappingBytes()",
            "20*1048576"
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "0",
            "NULL",
            "NULL"
          ],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "dbfull()->TEST_MaxNextLevelOverlappingBytes()",
            "20*1048576"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"C\"",
            "\"vc2\""
          ],
          "line": 1036
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "0",
            "NULL",
            "NULL"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "key",
            "sizeof(key)",
            "\"B%010d\"",
            "i"
          ],
          "line": 1026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FillLevels",
          "args": [
            "\"A\"",
            "\"Z\""
          ],
          "line": 1013
        },
        "resolved": true,
        "details": {
          "function_name": "FillLevels",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "440-442",
          "snippet": "void FillLevels(const std::string& smallest, const std::string& largest) {\n    MakeTables(config::kNumLevels, smallest, largest);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void FillLevels(const std::string& smallest, const std::string& largest) {\n      MakeTables(config::kNumLevels, smallest, largest);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 1011
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 1009
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, SparseMerge) {\n  Options options = CurrentOptions();\n  options.compression = kNoCompression;\n  Reopen(&options);\n\n  FillLevels(\"A\", \"Z\");\n\n  // Suppose there is:\n  //    small amount of data with prefix A\n  //    large amount of data with prefix B\n  //    small amount of data with prefix C\n  // and that recent updates have made small changes to all three prefixes.\n  // Check that we do not do a compaction that merges all of B in one shot.\n  const std::string value(1000, 'x');\n  Put(\"A\", \"va\");\n  // Write approximately 100MB of \"B\" values\n  for (int i = 0; i < 100000; i++) {\n    char key[100];\n    snprintf(key, sizeof(key), \"B%010d\", i);\n    Put(key, value);\n  }\n  Put(\"C\", \"vc\");\n  dbfull()->TEST_CompactMemTable();\n  dbfull()->TEST_CompactRange(0, NULL, NULL);\n\n  // Make sparse update\n  Put(\"A\",    \"va2\");\n  Put(\"B100\", \"bvalue2\");\n  Put(\"C\",    \"vc2\");\n  dbfull()->TEST_CompactMemTable();\n\n  // Compactions should not cause us to create a situation where\n  // a file overlaps too much data at the next level.\n  ASSERT_LE(dbfull()->TEST_MaxNextLevelOverlappingBytes(), 20*1048576);\n  dbfull()->TEST_CompactRange(0, NULL, NULL);\n  ASSERT_LE(dbfull()->TEST_MaxNextLevelOverlappingBytes(), 20*1048576);\n  dbfull()->TEST_CompactRange(1, NULL, NULL);\n  ASSERT_LE(dbfull()->TEST_MaxNextLevelOverlappingBytes(), 20*1048576);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "989-1006",
    "snippet": "TEST(DBTest, RepeatedWritesToSameKey) {\n  Options options = CurrentOptions();\n  options.env = env_;\n  options.write_buffer_size = 100000;  // Small write buffer\n  Reopen(&options);\n\n  // We must have at most one file per level except for level-0,\n  // which may have up to kL0_StopWritesTrigger files.\n  const int kMaxFiles = config::kNumLevels + config::kL0_StopWritesTrigger;\n\n  Random rnd(301);\n  std::string value = RandomString(&rnd, 2 * options.write_buffer_size);\n  for (int i = 0; i < 5 * kMaxFiles; i++) {\n    Put(\"key\", value);\n    ASSERT_LE(TotalTableFiles(), kMaxFiles);\n    fprintf(stderr, \"after %d: %d files\\n\", int(i+1), TotalTableFiles());\n  }\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"after %d: %d files\\n\"",
            "int(i+1)",
            "TotalTableFiles()"
          ],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TotalTableFiles",
          "args": [],
          "line": 1004
        },
        "resolved": true,
        "details": {
          "function_name": "TotalTableFiles",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "386-392",
          "snippet": "int TotalTableFiles() {\n    int result = 0;\n    for (int level = 0; level < config::kNumLevels; level++) {\n      result += NumTableFilesAtLevel(level);\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int TotalTableFiles() {\n      int result = 0;\n      for (int level = 0; level < config::kNumLevels; level++) {\n        result += NumTableFilesAtLevel(level);\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "int",
          "args": [
            "i+1"
          ],
          "line": 1004
        },
        "resolved": true,
        "details": {
          "function_name": "VersionEditPrinter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/leveldb_main.cc",
          "lines": "110-118",
          "snippet": "static void VersionEditPrinter(Slice record) {\n  VersionEdit edit;\n  Status s = edit.DecodeFrom(record);\n  if (!s.ok()) {\n    printf(\"%s\\n\", s.ToString().c_str());\n    return;\n  }\n  printf(\"%s\", edit.DebugString().c_str());\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_edit.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/write_batch.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_edit.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nstatic void VersionEditPrinter(Slice record) {\n  VersionEdit edit;\n  Status s = edit.DecodeFrom(record);\n  if (!s.ok()) {\n    printf(\"%s\\n\", s.ToString().c_str());\n    return;\n  }\n  printf(\"%s\", edit.DebugString().c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "TotalTableFiles()",
            "kMaxFiles"
          ],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"key\"",
            "value"
          ],
          "line": 1002
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "RandomString",
          "args": [
            "&rnd",
            "2 * options.write_buffer_size"
          ],
          "line": 1000
        },
        "resolved": true,
        "details": {
          "function_name": "RandomString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "22-26",
          "snippet": "static std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 993
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 990
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, RepeatedWritesToSameKey) {\n  Options options = CurrentOptions();\n  options.env = env_;\n  options.write_buffer_size = 100000;  // Small write buffer\n  Reopen(&options);\n\n  // We must have at most one file per level except for level-0,\n  // which may have up to kL0_StopWritesTrigger files.\n  const int kMaxFiles = config::kNumLevels + config::kL0_StopWritesTrigger;\n\n  Random rnd(301);\n  std::string value = RandomString(&rnd, 2 * options.write_buffer_size);\n  for (int i = 0; i < 5 * kMaxFiles; i++) {\n    Put(\"key\", value);\n    ASSERT_LE(TotalTableFiles(), kMaxFiles);\n    fprintf(stderr, \"after %d: %d files\\n\", int(i+1), TotalTableFiles());\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "963-987",
    "snippet": "TEST(DBTest, CompactionsGenerateMultipleFiles) {\n  Options options = CurrentOptions();\n  options.write_buffer_size = 100000000;        // Large write buffer\n  Reopen(&options);\n\n  Random rnd(301);\n\n  // Write 8MB (80 values, each 100K)\n  ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n  std::vector<std::string> values;\n  for (int i = 0; i < 80; i++) {\n    values.push_back(RandomString(&rnd, 100000));\n    ASSERT_OK(Put(Key(i), values[i]));\n  }\n\n  // Reopening moves updates to level-0\n  Reopen(&options);\n  dbfull()->TEST_CompactRange(0, NULL, NULL);\n\n  ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n  ASSERT_GT(NumTableFilesAtLevel(1), 1);\n  for (int i = 0; i < 80; i++) {\n    ASSERT_EQ(Get(Key(i)), values[i]);\n  }\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "Get(Key(i))",
            "values[i]"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "Key(i)"
          ],
          "line": 985
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Key",
          "args": [
            "i"
          ],
          "line": 985
        },
        "resolved": true,
        "details": {
          "function_name": "MakeKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "2059-2063",
          "snippet": "std::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstd::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_GT",
          "args": [
            "NumTableFilesAtLevel(1)",
            "1"
          ],
          "line": 983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NumTableFilesAtLevel",
          "args": [
            "1"
          ],
          "line": 983
        },
        "resolved": true,
        "details": {
          "function_name": "NumTableFilesAtLevel",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "378-384",
          "snippet": "int NumTableFilesAtLevel(int level) {\n    std::string property;\n    ASSERT_TRUE(\n        db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                         &property));\n    return atoi(property.c_str());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int NumTableFilesAtLevel(int level) {\n      std::string property;\n      ASSERT_TRUE(\n          db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                           &property));\n      return atoi(property.c_str());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(0)",
            "0"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "0",
            "NULL",
            "NULL"
          ],
          "line": 980
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 980
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 979
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(i), values[i])"
          ],
          "line": 975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "Key(i)",
            "values[i]"
          ],
          "line": 975
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "values.push_back",
          "args": [
            "RandomString(&rnd, 100000)"
          ],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RandomString",
          "args": [
            "&rnd",
            "100000"
          ],
          "line": 974
        },
        "resolved": true,
        "details": {
          "function_name": "RandomString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "22-26",
          "snippet": "static std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(0)",
            "0"
          ],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 964
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, CompactionsGenerateMultipleFiles) {\n  Options options = CurrentOptions();\n  options.write_buffer_size = 100000000;        // Large write buffer\n  Reopen(&options);\n\n  Random rnd(301);\n\n  // Write 8MB (80 values, each 100K)\n  ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n  std::vector<std::string> values;\n  for (int i = 0; i < 80; i++) {\n    values.push_back(RandomString(&rnd, 100000));\n    ASSERT_OK(Put(Key(i), values[i]));\n  }\n\n  // Reopening moves updates to level-0\n  Reopen(&options);\n  dbfull()->TEST_CompactRange(0, NULL, NULL);\n\n  ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n  ASSERT_GT(NumTableFilesAtLevel(1), 1);\n  for (int i = 0; i < 80; i++) {\n    ASSERT_EQ(Get(Key(i)), values[i]);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "939-961",
    "snippet": "TEST(DBTest, RecoverWithLargeLog) {\n  {\n    Options options = CurrentOptions();\n    Reopen(&options);\n    ASSERT_OK(Put(\"big1\", std::string(200000, '1')));\n    ASSERT_OK(Put(\"big2\", std::string(200000, '2')));\n    ASSERT_OK(Put(\"small3\", std::string(10, '3')));\n    ASSERT_OK(Put(\"small4\", std::string(10, '4')));\n    ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n  }\n\n  // Make sure that if we re-open with a small write buffer size that\n  // we flush table files in the middle of a large log file.\n  Options options = CurrentOptions();\n  options.write_buffer_size = 100000;\n  Reopen(&options);\n  ASSERT_EQ(NumTableFilesAtLevel(0), 3);\n  ASSERT_EQ(std::string(200000, '1'), Get(\"big1\"));\n  ASSERT_EQ(std::string(200000, '2'), Get(\"big2\"));\n  ASSERT_EQ(std::string(10, '3'), Get(\"small3\"));\n  ASSERT_EQ(std::string(10, '4'), Get(\"small4\"));\n  ASSERT_GT(NumTableFilesAtLevel(0), 1);\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_GT",
          "args": [
            "NumTableFilesAtLevel(0)",
            "1"
          ],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NumTableFilesAtLevel",
          "args": [
            "0"
          ],
          "line": 960
        },
        "resolved": true,
        "details": {
          "function_name": "NumTableFilesAtLevel",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "378-384",
          "snippet": "int NumTableFilesAtLevel(int level) {\n    std::string property;\n    ASSERT_TRUE(\n        db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                         &property));\n    return atoi(property.c_str());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int NumTableFilesAtLevel(int level) {\n      std::string property;\n      ASSERT_TRUE(\n          db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                           &property));\n      return atoi(property.c_str());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "std::string(10, '4')",
            "Get(\"small4\")"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"small4\""
          ],
          "line": 959
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "10",
            "'4'"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "std::string(10, '3')",
            "Get(\"small3\")"
          ],
          "line": 958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "10",
            "'3'"
          ],
          "line": 958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "std::string(200000, '2')",
            "Get(\"big2\")"
          ],
          "line": 957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "200000",
            "'2'"
          ],
          "line": 957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "std::string(200000, '1')",
            "Get(\"big1\")"
          ],
          "line": 956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "200000",
            "'1'"
          ],
          "line": 956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(0)",
            "3"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 954
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 952
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(0)",
            "0"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"small4\", std::string(10, '4'))"
          ],
          "line": 946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"small4\"",
            "std::string(10, '4')"
          ],
          "line": 946
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "10",
            "'4'"
          ],
          "line": 946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"small3\", std::string(10, '3'))"
          ],
          "line": 945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "10",
            "'3'"
          ],
          "line": 945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"big2\", std::string(200000, '2'))"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "200000",
            "'2'"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"big1\", std::string(200000, '1'))"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "200000",
            "'1'"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, RecoverWithLargeLog) {\n  {\n    Options options = CurrentOptions();\n    Reopen(&options);\n    ASSERT_OK(Put(\"big1\", std::string(200000, '1')));\n    ASSERT_OK(Put(\"big2\", std::string(200000, '2')));\n    ASSERT_OK(Put(\"small3\", std::string(10, '3')));\n    ASSERT_OK(Put(\"small4\", std::string(10, '4')));\n    ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n  }\n\n  // Make sure that if we re-open with a small write buffer size that\n  // we flush table files in the middle of a large log file.\n  Options options = CurrentOptions();\n  options.write_buffer_size = 100000;\n  Reopen(&options);\n  ASSERT_EQ(NumTableFilesAtLevel(0), 3);\n  ASSERT_EQ(std::string(200000, '1'), Get(\"big1\"));\n  ASSERT_EQ(std::string(200000, '2'), Get(\"big2\"));\n  ASSERT_EQ(std::string(10, '3'), Get(\"small3\"));\n  ASSERT_EQ(std::string(10, '4'), Get(\"small4\"));\n  ASSERT_GT(NumTableFilesAtLevel(0), 1);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "914-937",
    "snippet": "TEST(DBTest, MinorCompactionsHappen) {\n  Options options = CurrentOptions();\n  options.write_buffer_size = 10000;\n  Reopen(&options);\n\n  const int N = 500;\n\n  int starting_num_tables = TotalTableFiles();\n  for (int i = 0; i < N; i++) {\n    ASSERT_OK(Put(Key(i), Key(i) + std::string(1000, 'v')));\n  }\n  int ending_num_tables = TotalTableFiles();\n  ASSERT_GT(ending_num_tables, starting_num_tables);\n\n  for (int i = 0; i < N; i++) {\n    ASSERT_EQ(Key(i) + std::string(1000, 'v'), Get(Key(i)));\n  }\n\n  Reopen();\n\n  for (int i = 0; i < N; i++) {\n    ASSERT_EQ(Key(i) + std::string(1000, 'v'), Get(Key(i)));\n  }\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "Key(i) + std::string(1000, 'v')",
            "Get(Key(i))"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "Key(i)"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Key",
          "args": [
            "i"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "MakeKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "2059-2063",
          "snippet": "std::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstd::string MakeKey(unsigned int num) {\n  char buf[30];\n  snprintf(buf, sizeof(buf), \"%016u\", num);\n  return std::string(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "1000",
            "'v'"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [],
          "line": 932
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyAndReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "266-271",
          "snippet": "void DestroyAndReopen(Options* options = NULL) {\n    delete db_;\n    db_ = NULL;\n    DestroyDB(dbname_, Options());\n    ASSERT_OK(TryReopen(options));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void DestroyAndReopen(Options* options = NULL) {\n      delete db_;\n      db_ = NULL;\n      DestroyDB(dbname_, Options());\n      ASSERT_OK(TryReopen(options));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "Key(i) + std::string(1000, 'v')",
            "Get(Key(i))"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "1000",
            "'v'"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_GT",
          "args": [
            "ending_num_tables",
            "starting_num_tables"
          ],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TotalTableFiles",
          "args": [],
          "line": 925
        },
        "resolved": true,
        "details": {
          "function_name": "TotalTableFiles",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "386-392",
          "snippet": "int TotalTableFiles() {\n    int result = 0;\n    for (int level = 0; level < config::kNumLevels; level++) {\n      result += NumTableFilesAtLevel(level);\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int TotalTableFiles() {\n      int result = 0;\n      for (int level = 0; level < config::kNumLevels; level++) {\n        result += NumTableFilesAtLevel(level);\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(Key(i), Key(i) + std::string(1000, 'v'))"
          ],
          "line": 923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "Key(i)",
            "Key(i) + std::string(1000, 'v')"
          ],
          "line": 923
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "1000",
            "'v'"
          ],
          "line": 923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 915
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, MinorCompactionsHappen) {\n  Options options = CurrentOptions();\n  options.write_buffer_size = 10000;\n  Reopen(&options);\n\n  const int N = 500;\n\n  int starting_num_tables = TotalTableFiles();\n  for (int i = 0; i < N; i++) {\n    ASSERT_OK(Put(Key(i), Key(i) + std::string(1000, 'v')));\n  }\n  int ending_num_tables = TotalTableFiles();\n  ASSERT_GT(ending_num_tables, starting_num_tables);\n\n  for (int i = 0; i < N; i++) {\n    ASSERT_EQ(Key(i) + std::string(1000, 'v'), Get(Key(i)));\n  }\n\n  Reopen();\n\n  for (int i = 0; i < N; i++) {\n    ASSERT_EQ(Key(i) + std::string(1000, 'v'), Get(Key(i)));\n  }\n}"
  },
  {
    "function_name": "Key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "908-912",
    "snippet": "static std::string Key(int i) {\n  char buf[100];\n  snprintf(buf, sizeof(buf), \"key%06d\", i);\n  return std::string(buf);\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "buf"
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"key%06d\"",
            "i"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic std::string Key(int i) {\n  char buf[100];\n  snprintf(buf, sizeof(buf), \"key%06d\", i);\n  return std::string(buf);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "887-906",
    "snippet": "TEST(DBTest, RecoverDuringMemtableCompaction) {\n  do {\n    Options options = CurrentOptions();\n    options.env = env_;\n    options.write_buffer_size = 1000000;\n    Reopen(&options);\n\n    // Trigger a long memtable compaction and reopen the database during it\n    ASSERT_OK(Put(\"foo\", \"v1\"));                         // Goes to 1st log file\n    ASSERT_OK(Put(\"big1\", std::string(10000000, 'x')));  // Fills memtable\n    ASSERT_OK(Put(\"big2\", std::string(1000, 'y')));      // Triggers compaction\n    ASSERT_OK(Put(\"bar\", \"v2\"));                         // Goes to new log file\n\n    Reopen(&options);\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n    ASSERT_EQ(\"v2\", Get(\"bar\"));\n    ASSERT_EQ(std::string(10000000, 'x'), Get(\"big1\"));\n    ASSERT_EQ(std::string(1000, 'y'), Get(\"big2\"));\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "std::string(1000, 'y')",
            "Get(\"big2\")"
          ],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"big2\""
          ],
          "line": 904
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "1000",
            "'y'"
          ],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "std::string(10000000, 'x')",
            "Get(\"big1\")"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "10000000",
            "'x'"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v2\"",
            "Get(\"bar\")"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"foo\")"
          ],
          "line": 901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 900
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"bar\", \"v2\")"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"bar\"",
            "\"v2\""
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"big2\", std::string(1000, 'y'))"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "1000",
            "'y'"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"big1\", std::string(10000000, 'x'))"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "10000000",
            "'x'"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v1\")"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 889
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, RecoverDuringMemtableCompaction) {\n  do {\n    Options options = CurrentOptions();\n    options.env = env_;\n    options.write_buffer_size = 1000000;\n    Reopen(&options);\n\n    // Trigger a long memtable compaction and reopen the database during it\n    ASSERT_OK(Put(\"foo\", \"v1\"));                         // Goes to 1st log file\n    ASSERT_OK(Put(\"big1\", std::string(10000000, 'x')));  // Fills memtable\n    ASSERT_OK(Put(\"big2\", std::string(1000, 'y')));      // Triggers compaction\n    ASSERT_OK(Put(\"bar\", \"v2\"));                         // Goes to new log file\n\n    Reopen(&options);\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n    ASSERT_EQ(\"v2\", Get(\"bar\"));\n    ASSERT_EQ(std::string(10000000, 'x'), Get(\"big1\"));\n    ASSERT_EQ(std::string(1000, 'y'), Get(\"big2\"));\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "873-883",
    "snippet": "TEST(DBTest, RecoveryWithEmptyLog) {\n  do {\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    ASSERT_OK(Put(\"foo\", \"v2\"));\n    Reopen();\n    Reopen();\n    ASSERT_OK(Put(\"foo\", \"v3\"));\n    Reopen();\n    ASSERT_EQ(\"v3\", Get(\"foo\"));\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 882
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v3\"",
            "Get(\"foo\")"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\""
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [],
          "line": 880
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyAndReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "266-271",
          "snippet": "void DestroyAndReopen(Options* options = NULL) {\n    delete db_;\n    db_ = NULL;\n    DestroyDB(dbname_, Options());\n    ASSERT_OK(TryReopen(options));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void DestroyAndReopen(Options* options = NULL) {\n      delete db_;\n      db_ = NULL;\n      DestroyDB(dbname_, Options());\n      ASSERT_OK(TryReopen(options));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v3\")"
          ],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"v3\""
          ],
          "line": 879
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v2\")"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v1\")"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, RecoveryWithEmptyLog) {\n  do {\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    ASSERT_OK(Put(\"foo\", \"v2\"));\n    Reopen();\n    Reopen();\n    ASSERT_OK(Put(\"foo\", \"v3\"));\n    Reopen();\n    ASSERT_EQ(\"v3\", Get(\"foo\"));\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "851-871",
    "snippet": "TEST(DBTest, Recover) {\n  do {\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    ASSERT_OK(Put(\"baz\", \"v5\"));\n\n    Reopen();\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n    ASSERT_EQ(\"v5\", Get(\"baz\"));\n    ASSERT_OK(Put(\"bar\", \"v2\"));\n    ASSERT_OK(Put(\"foo\", \"v3\"));\n\n    Reopen();\n    ASSERT_EQ(\"v3\", Get(\"foo\"));\n    ASSERT_OK(Put(\"foo\", \"v4\"));\n    ASSERT_EQ(\"v4\", Get(\"foo\"));\n    ASSERT_EQ(\"v2\", Get(\"bar\"));\n    ASSERT_EQ(\"v5\", Get(\"baz\"));\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v5\"",
            "Get(\"baz\")"
          ],
          "line": 869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"baz\""
          ],
          "line": 869
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v2\"",
            "Get(\"bar\")"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v4\"",
            "Get(\"foo\")"
          ],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v4\")"
          ],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"v4\""
          ],
          "line": 866
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v3\"",
            "Get(\"foo\")"
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyAndReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "266-271",
          "snippet": "void DestroyAndReopen(Options* options = NULL) {\n    delete db_;\n    db_ = NULL;\n    DestroyDB(dbname_, Options());\n    ASSERT_OK(TryReopen(options));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void DestroyAndReopen(Options* options = NULL) {\n      delete db_;\n      db_ = NULL;\n      DestroyDB(dbname_, Options());\n      ASSERT_OK(TryReopen(options));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v3\")"
          ],
          "line": 862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"bar\", \"v2\")"
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v5\"",
            "Get(\"baz\")"
          ],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"foo\")"
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"foo\")"
          ],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"baz\", \"v5\")"
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v1\")"
          ],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, Recover) {\n  do {\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    ASSERT_OK(Put(\"baz\", \"v5\"));\n\n    Reopen();\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n    ASSERT_EQ(\"v5\", Get(\"baz\"));\n    ASSERT_OK(Put(\"bar\", \"v2\"));\n    ASSERT_OK(Put(\"foo\", \"v3\"));\n\n    Reopen();\n    ASSERT_EQ(\"v3\", Get(\"foo\"));\n    ASSERT_OK(Put(\"foo\", \"v4\"));\n    ASSERT_EQ(\"v4\", Get(\"foo\"));\n    ASSERT_EQ(\"v2\", Get(\"bar\"));\n    ASSERT_EQ(\"v5\", Get(\"baz\"));\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "834-849",
    "snippet": "TEST(DBTest, IterMultiWithDelete) {\n  do {\n    ASSERT_OK(Put(\"a\", \"va\"));\n    ASSERT_OK(Put(\"b\", \"vb\"));\n    ASSERT_OK(Put(\"c\", \"vc\"));\n    ASSERT_OK(Delete(\"b\"));\n    ASSERT_EQ(\"NOT_FOUND\", Get(\"b\"));\n\n    Iterator* iter = db_->NewIterator(ReadOptions());\n    iter->Seek(\"c\");\n    ASSERT_EQ(IterStatus(iter), \"c->vc\");\n    iter->Prev();\n    ASSERT_EQ(IterStatus(iter), \"a->va\");\n    delete iter;\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IterStatus",
          "args": [
            "iter"
          ],
          "line": 846
        },
        "resolved": true,
        "details": {
          "function_name": "IterStatus",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "463-471",
          "snippet": "std::string IterStatus(Iterator* iter) {\n    std::string result;\n    if (iter->Valid()) {\n      result = iter->key().ToString() + \"->\" + iter->value().ToString();\n    } else {\n      result = \"(invalid)\";\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string IterStatus(Iterator* iter) {\n      std::string result;\n      if (iter->Valid()) {\n        result = iter->key().ToString() + \"->\" + iter->value().ToString();\n      } else {\n        result = \"(invalid)\";\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Prev",
          "args": [],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "Prev",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1920-1920",
          "snippet": "virtual void Prev() { --iter_; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Prev() { --iter_; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"c->vc\""
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Seek",
          "args": [
            "\"c\""
          ],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "Seek",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1916-1918",
          "snippet": "virtual void Seek(const Slice& k) {\n      iter_ = map_->lower_bound(k.ToString());\n    }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Seek(const Slice& k) {\n          iter_ = map_->lower_bound(k.ToString());\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->NewIterator",
          "args": [
            "ReadOptions()"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReadOptions",
          "args": [],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "ReadOptions",
          "container": "ReadOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "161-165",
          "snippet": "ReadOptions()\n      : verify_checksums(false),\n        fill_cache(true),\n        snapshot(NULL) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nReadOptions {\n  ReadOptions()\n        : verify_checksums(false),\n          fill_cache(true),\n          snapshot(NULL) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"NOT_FOUND\"",
            "Get(\"b\")"
          ],
          "line": 840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"b\""
          ],
          "line": 840
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Delete(\"b\")"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Delete",
          "args": [
            "\"b\""
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "292-294",
          "snippet": "Status Delete(const std::string& k) {\n    return db_->Delete(WriteOptions(), k);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Delete(const std::string& k) {\n      return db_->Delete(WriteOptions(), k);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"c\", \"vc\")"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"c\"",
            "\"vc\""
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"b\", \"vb\")"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"a\", \"va\")"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, IterMultiWithDelete) {\n  do {\n    ASSERT_OK(Put(\"a\", \"va\"));\n    ASSERT_OK(Put(\"b\", \"vb\"));\n    ASSERT_OK(Put(\"c\", \"vc\"));\n    ASSERT_OK(Delete(\"b\"));\n    ASSERT_EQ(\"NOT_FOUND\", Get(\"b\"));\n\n    Iterator* iter = db_->NewIterator(ReadOptions());\n    iter->Seek(\"c\");\n    ASSERT_EQ(IterStatus(iter), \"c->vc\");\n    iter->Prev();\n    ASSERT_EQ(IterStatus(iter), \"a->va\");\n    delete iter;\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "796-832",
    "snippet": "TEST(DBTest, IterSmallAndLargeMix) {\n  ASSERT_OK(Put(\"a\", \"va\"));\n  ASSERT_OK(Put(\"b\", std::string(100000, 'b')));\n  ASSERT_OK(Put(\"c\", \"vc\"));\n  ASSERT_OK(Put(\"d\", std::string(100000, 'd')));\n  ASSERT_OK(Put(\"e\", std::string(100000, 'e')));\n\n  Iterator* iter = db_->NewIterator(ReadOptions());\n\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"b->\" + std::string(100000, 'b'));\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"d->\" + std::string(100000, 'd'));\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"e->\" + std::string(100000, 'e'));\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"e->\" + std::string(100000, 'e'));\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"d->\" + std::string(100000, 'd'));\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"b->\" + std::string(100000, 'b'));\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  delete iter;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IterStatus",
          "args": [
            "iter"
          ],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "IterStatus",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "463-471",
          "snippet": "std::string IterStatus(Iterator* iter) {\n    std::string result;\n    if (iter->Valid()) {\n      result = iter->key().ToString() + \"->\" + iter->value().ToString();\n    } else {\n      result = \"(invalid)\";\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string IterStatus(Iterator* iter) {\n      std::string result;\n      if (iter->Valid()) {\n        result = iter->key().ToString() + \"->\" + iter->value().ToString();\n      } else {\n        result = \"(invalid)\";\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Prev",
          "args": [],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "Prev",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1920-1920",
          "snippet": "virtual void Prev() { --iter_; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Prev() { --iter_; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"b->\" + std::string(100000, 'b')"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "100000",
            "'b'"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"c->vc\""
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"d->\" + std::string(100000, 'd')"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "100000",
            "'d'"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"e->\" + std::string(100000, 'e')"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "100000",
            "'e'"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->SeekToLast",
          "args": [],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToLast",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1909-1915",
          "snippet": "virtual void SeekToLast() {\n      if (map_->empty()) {\n        iter_ = map_->end();\n      } else {\n        iter_ = map_->find(map_->rbegin()->first);\n      }\n    }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToLast() {\n          if (map_->empty()) {\n            iter_ = map_->end();\n          } else {\n            iter_ = map_->find(map_->rbegin()->first);\n          }\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Next",
          "args": [],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1919-1919",
          "snippet": "virtual void Next() { ++iter_; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Next() { ++iter_; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"e->\" + std::string(100000, 'e')"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "100000",
            "'e'"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"d->\" + std::string(100000, 'd')"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "100000",
            "'d'"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"c->vc\""
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"b->\" + std::string(100000, 'b')"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "100000",
            "'b'"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->SeekToFirst",
          "args": [],
          "line": 805
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1908-1908",
          "snippet": "virtual void SeekToFirst() { iter_ = map_->begin(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToFirst() { iter_ = map_->begin(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->NewIterator",
          "args": [
            "ReadOptions()"
          ],
          "line": 803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReadOptions",
          "args": [],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "ReadOptions",
          "container": "ReadOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "161-165",
          "snippet": "ReadOptions()\n      : verify_checksums(false),\n        fill_cache(true),\n        snapshot(NULL) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nReadOptions {\n  ReadOptions()\n        : verify_checksums(false),\n          fill_cache(true),\n          snapshot(NULL) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"e\", std::string(100000, 'e'))"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"e\"",
            "std::string(100000, 'e')"
          ],
          "line": 801
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "100000",
            "'e'"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"d\", std::string(100000, 'd'))"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "100000",
            "'d'"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"c\", \"vc\")"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"b\", std::string(100000, 'b'))"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "100000",
            "'b'"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"a\", \"va\")"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, IterSmallAndLargeMix) {\n  ASSERT_OK(Put(\"a\", \"va\"));\n  ASSERT_OK(Put(\"b\", std::string(100000, 'b')));\n  ASSERT_OK(Put(\"c\", \"vc\"));\n  ASSERT_OK(Put(\"d\", std::string(100000, 'd')));\n  ASSERT_OK(Put(\"e\", std::string(100000, 'e')));\n\n  Iterator* iter = db_->NewIterator(ReadOptions());\n\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"b->\" + std::string(100000, 'b'));\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"d->\" + std::string(100000, 'd'));\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"e->\" + std::string(100000, 'e'));\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"e->\" + std::string(100000, 'e'));\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"d->\" + std::string(100000, 'd'));\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"b->\" + std::string(100000, 'b'));\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  delete iter;\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "713-794",
    "snippet": "TEST(DBTest, IterMulti) {\n  ASSERT_OK(Put(\"a\", \"va\"));\n  ASSERT_OK(Put(\"b\", \"vb\"));\n  ASSERT_OK(Put(\"c\", \"vc\"));\n  Iterator* iter = db_->NewIterator(ReadOptions());\n\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->Seek(\"\");\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Seek(\"a\");\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Seek(\"ax\");\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n  iter->Seek(\"b\");\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n  iter->Seek(\"z\");\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  // Switch from reverse to forward\n  iter->SeekToLast();\n  iter->Prev();\n  iter->Prev();\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n\n  // Switch from forward to reverse\n  iter->SeekToFirst();\n  iter->Next();\n  iter->Next();\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n\n  // Make sure iter stays at snapshot\n  ASSERT_OK(Put(\"a\",  \"va2\"));\n  ASSERT_OK(Put(\"a2\", \"va3\"));\n  ASSERT_OK(Put(\"b\",  \"vb2\"));\n  ASSERT_OK(Put(\"c\",  \"vc2\"));\n  ASSERT_OK(Delete(\"b\"));\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  delete iter;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IterStatus",
          "args": [
            "iter"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "IterStatus",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "463-471",
          "snippet": "std::string IterStatus(Iterator* iter) {\n    std::string result;\n    if (iter->Valid()) {\n      result = iter->key().ToString() + \"->\" + iter->value().ToString();\n    } else {\n      result = \"(invalid)\";\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string IterStatus(Iterator* iter) {\n      std::string result;\n      if (iter->Valid()) {\n        result = iter->key().ToString() + \"->\" + iter->value().ToString();\n      } else {\n        result = \"(invalid)\";\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Prev",
          "args": [],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "Prev",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1920-1920",
          "snippet": "virtual void Prev() { --iter_; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Prev() { --iter_; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"b->vb\""
          ],
          "line": 787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"c->vc\""
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->SeekToLast",
          "args": [],
          "line": 784
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToLast",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1909-1915",
          "snippet": "virtual void SeekToLast() {\n      if (map_->empty()) {\n        iter_ = map_->end();\n      } else {\n        iter_ = map_->find(map_->rbegin()->first);\n      }\n    }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToLast() {\n          if (map_->empty()) {\n            iter_ = map_->end();\n          } else {\n            iter_ = map_->find(map_->rbegin()->first);\n          }\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Next",
          "args": [],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1919-1919",
          "snippet": "virtual void Next() { ++iter_; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Next() { ++iter_; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"c->vc\""
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"b->vb\""
          ],
          "line": 779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->SeekToFirst",
          "args": [],
          "line": 776
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1908-1908",
          "snippet": "virtual void SeekToFirst() { iter_ = map_->begin(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToFirst() { iter_ = map_->begin(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Delete(\"b\")"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Delete",
          "args": [
            "\"b\""
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "292-294",
          "snippet": "Status Delete(const std::string& k) {\n    return db_->Delete(WriteOptions(), k);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Delete(const std::string& k) {\n      return db_->Delete(WriteOptions(), k);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"c\",  \"vc2\")"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"c\"",
            "\"vc2\""
          ],
          "line": 774
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"b\",  \"vb2\")"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"a2\", \"va3\")"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"a\",  \"va2\")"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"b->vb\""
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"b->vb\""
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Seek",
          "args": [
            "\"z\""
          ],
          "line": 753
        },
        "resolved": true,
        "details": {
          "function_name": "Seek",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1916-1918",
          "snippet": "virtual void Seek(const Slice& k) {\n      iter_ = map_->lower_bound(k.ToString());\n    }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Seek(const Slice& k) {\n          iter_ = map_->lower_bound(k.ToString());\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"b->vb\""
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"b->vb\""
          ],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"c->vc\""
          ],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"b->vb\""
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"c->vc\""
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"c->vc\""
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"b->vb\""
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->NewIterator",
          "args": [
            "ReadOptions()"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReadOptions",
          "args": [],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "ReadOptions",
          "container": "ReadOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "161-165",
          "snippet": "ReadOptions()\n      : verify_checksums(false),\n        fill_cache(true),\n        snapshot(NULL) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nReadOptions {\n  ReadOptions()\n        : verify_checksums(false),\n          fill_cache(true),\n          snapshot(NULL) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"c\", \"vc\")"
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"b\", \"vb\")"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"a\", \"va\")"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, IterMulti) {\n  ASSERT_OK(Put(\"a\", \"va\"));\n  ASSERT_OK(Put(\"b\", \"vb\"));\n  ASSERT_OK(Put(\"c\", \"vc\"));\n  Iterator* iter = db_->NewIterator(ReadOptions());\n\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->Seek(\"\");\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Seek(\"a\");\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Seek(\"ax\");\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n  iter->Seek(\"b\");\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n  iter->Seek(\"z\");\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  // Switch from reverse to forward\n  iter->SeekToLast();\n  iter->Prev();\n  iter->Prev();\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n\n  // Switch from forward to reverse\n  iter->SeekToFirst();\n  iter->Next();\n  iter->Next();\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n\n  // Make sure iter stays at snapshot\n  ASSERT_OK(Put(\"a\",  \"va2\"));\n  ASSERT_OK(Put(\"a2\", \"va3\"));\n  ASSERT_OK(Put(\"b\",  \"vb2\"));\n  ASSERT_OK(Put(\"c\",  \"vc2\"));\n  ASSERT_OK(Delete(\"b\"));\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"c->vc\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"b->vb\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  delete iter;\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "675-711",
    "snippet": "TEST(DBTest, IterSingle) {\n  ASSERT_OK(Put(\"a\", \"va\"));\n  Iterator* iter = db_->NewIterator(ReadOptions());\n\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->Seek(\"\");\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->Seek(\"a\");\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->Seek(\"b\");\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  delete iter;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IterStatus",
          "args": [
            "iter"
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "IterStatus",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "463-471",
          "snippet": "std::string IterStatus(Iterator* iter) {\n    std::string result;\n    if (iter->Valid()) {\n      result = iter->key().ToString() + \"->\" + iter->value().ToString();\n    } else {\n      result = \"(invalid)\";\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string IterStatus(Iterator* iter) {\n      std::string result;\n      if (iter->Valid()) {\n        result = iter->key().ToString() + \"->\" + iter->value().ToString();\n      } else {\n        result = \"(invalid)\";\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Seek",
          "args": [
            "\"b\""
          ],
          "line": 707
        },
        "resolved": true,
        "details": {
          "function_name": "Seek",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1916-1918",
          "snippet": "virtual void Seek(const Slice& k) {\n      iter_ = map_->lower_bound(k.ToString());\n    }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Seek(const Slice& k) {\n          iter_ = map_->lower_bound(k.ToString());\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Next",
          "args": [],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1919-1919",
          "snippet": "virtual void Next() { ++iter_; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Next() { ++iter_; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Prev",
          "args": [],
          "line": 694
        },
        "resolved": true,
        "details": {
          "function_name": "Prev",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1920-1920",
          "snippet": "virtual void Prev() { --iter_; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Prev() { --iter_; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->SeekToLast",
          "args": [],
          "line": 692
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToLast",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1909-1915",
          "snippet": "virtual void SeekToLast() {\n      if (map_->empty()) {\n        iter_ = map_->end();\n      } else {\n        iter_ = map_->find(map_->rbegin()->first);\n      }\n    }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToLast() {\n          if (map_->empty()) {\n            iter_ = map_->end();\n          } else {\n            iter_ = map_->find(map_->rbegin()->first);\n          }\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->SeekToFirst",
          "args": [],
          "line": 683
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1908-1908",
          "snippet": "virtual void SeekToFirst() { iter_ = map_->begin(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToFirst() { iter_ = map_->begin(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"a->va\""
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->NewIterator",
          "args": [
            "ReadOptions()"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReadOptions",
          "args": [],
          "line": 677
        },
        "resolved": true,
        "details": {
          "function_name": "ReadOptions",
          "container": "ReadOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "161-165",
          "snippet": "ReadOptions()\n      : verify_checksums(false),\n        fill_cache(true),\n        snapshot(NULL) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nReadOptions {\n  ReadOptions()\n        : verify_checksums(false),\n          fill_cache(true),\n          snapshot(NULL) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"a\", \"va\")"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"a\"",
            "\"va\""
          ],
          "line": 676
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, IterSingle) {\n  ASSERT_OK(Put(\"a\", \"va\"));\n  Iterator* iter = db_->NewIterator(ReadOptions());\n\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Prev();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->Seek(\"\");\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->Seek(\"a\");\n  ASSERT_EQ(IterStatus(iter), \"a->va\");\n  iter->Next();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->Seek(\"b\");\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  delete iter;\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "660-673",
    "snippet": "TEST(DBTest, IterEmpty) {\n  Iterator* iter = db_->NewIterator(ReadOptions());\n\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->Seek(\"foo\");\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  delete iter;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IterStatus",
          "args": [
            "iter"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "IterStatus",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "463-471",
          "snippet": "std::string IterStatus(Iterator* iter) {\n    std::string result;\n    if (iter->Valid()) {\n      result = iter->key().ToString() + \"->\" + iter->value().ToString();\n    } else {\n      result = \"(invalid)\";\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string IterStatus(Iterator* iter) {\n      std::string result;\n      if (iter->Valid()) {\n        result = iter->key().ToString() + \"->\" + iter->value().ToString();\n      } else {\n        result = \"(invalid)\";\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Seek",
          "args": [
            "\"foo\""
          ],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "Seek",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1916-1918",
          "snippet": "virtual void Seek(const Slice& k) {\n      iter_ = map_->lower_bound(k.ToString());\n    }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Seek(const Slice& k) {\n          iter_ = map_->lower_bound(k.ToString());\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->SeekToLast",
          "args": [],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToLast",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1909-1915",
          "snippet": "virtual void SeekToLast() {\n      if (map_->empty()) {\n        iter_ = map_->end();\n      } else {\n        iter_ = map_->find(map_->rbegin()->first);\n      }\n    }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToLast() {\n          if (map_->empty()) {\n            iter_ = map_->end();\n          } else {\n            iter_ = map_->find(map_->rbegin()->first);\n          }\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "\"(invalid)\""
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->SeekToFirst",
          "args": [],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1908-1908",
          "snippet": "virtual void SeekToFirst() { iter_ = map_->begin(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToFirst() { iter_ = map_->begin(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->NewIterator",
          "args": [
            "ReadOptions()"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReadOptions",
          "args": [],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "ReadOptions",
          "container": "ReadOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "161-165",
          "snippet": "ReadOptions()\n      : verify_checksums(false),\n        fill_cache(true),\n        snapshot(NULL) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nReadOptions {\n  ReadOptions()\n        : verify_checksums(false),\n          fill_cache(true),\n          snapshot(NULL) {\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, IterEmpty) {\n  Iterator* iter = db_->NewIterator(ReadOptions());\n\n  iter->SeekToFirst();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->SeekToLast();\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  iter->Seek(\"foo\");\n  ASSERT_EQ(IterStatus(iter), \"(invalid)\");\n\n  delete iter;\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "621-658",
    "snippet": "TEST(DBTest, GetEncountersEmptyLevel) {\n  do {\n    // Arrange for the following to happen:\n    //   * sstable A in level 0\n    //   * nothing in level 1\n    //   * sstable B in level 2\n    // Then do enough Get() calls to arrange for an automatic compaction\n    // of sstable A.  A bug would cause the compaction to be marked as\n    // occuring at level 1 (instead of the correct level 0).\n\n    // Step 1: First place sstables in levels 0 and 2\n    int compaction_count = 0;\n    while (NumTableFilesAtLevel(0) == 0 ||\n           NumTableFilesAtLevel(2) == 0) {\n      ASSERT_LE(compaction_count, 100) << \"could not fill levels 0 and 2\";\n      compaction_count++;\n      Put(\"a\", \"begin\");\n      Put(\"z\", \"end\");\n      dbfull()->TEST_CompactMemTable();\n    }\n\n    // Step 2: clear level 1 if necessary.\n    dbfull()->TEST_CompactRange(1, NULL, NULL);\n    ASSERT_EQ(NumTableFilesAtLevel(0), 1);\n    ASSERT_EQ(NumTableFilesAtLevel(1), 0);\n    ASSERT_EQ(NumTableFilesAtLevel(2), 1);\n\n    // Step 3: read a bunch of times\n    for (int i = 0; i < 1000; i++) {\n      ASSERT_EQ(\"NOT_FOUND\", Get(\"missing\"));\n    }\n\n    // Step 4: Wait for compaction to finish\n    DelayMilliseconds(1000);\n\n    ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(0)",
            "0"
          ],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NumTableFilesAtLevel",
          "args": [
            "0"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "NumTableFilesAtLevel",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "378-384",
          "snippet": "int NumTableFilesAtLevel(int level) {\n    std::string property;\n    ASSERT_TRUE(\n        db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                         &property));\n    return atoi(property.c_str());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int NumTableFilesAtLevel(int level) {\n      std::string property;\n      ASSERT_TRUE(\n          db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                           &property));\n      return atoi(property.c_str());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DelayMilliseconds",
          "args": [
            "1000"
          ],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "DelayMilliseconds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "52-54",
          "snippet": "void DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nvoid DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"NOT_FOUND\"",
            "Get(\"missing\")"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"missing\""
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(2)",
            "1"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(1)",
            "0"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "NumTableFilesAtLevel(0)",
            "1"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [
            "1",
            "NULL",
            "NULL"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"z\"",
            "\"end\""
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_LE",
          "args": [
            "compaction_count",
            "100"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, GetEncountersEmptyLevel) {\n  do {\n    // Arrange for the following to happen:\n    //   * sstable A in level 0\n    //   * nothing in level 1\n    //   * sstable B in level 2\n    // Then do enough Get() calls to arrange for an automatic compaction\n    // of sstable A.  A bug would cause the compaction to be marked as\n    // occuring at level 1 (instead of the correct level 0).\n\n    // Step 1: First place sstables in levels 0 and 2\n    int compaction_count = 0;\n    while (NumTableFilesAtLevel(0) == 0 ||\n           NumTableFilesAtLevel(2) == 0) {\n      ASSERT_LE(compaction_count, 100) << \"could not fill levels 0 and 2\";\n      compaction_count++;\n      Put(\"a\", \"begin\");\n      Put(\"z\", \"end\");\n      dbfull()->TEST_CompactMemTable();\n    }\n\n    // Step 2: clear level 1 if necessary.\n    dbfull()->TEST_CompactRange(1, NULL, NULL);\n    ASSERT_EQ(NumTableFilesAtLevel(0), 1);\n    ASSERT_EQ(NumTableFilesAtLevel(1), 0);\n    ASSERT_EQ(NumTableFilesAtLevel(2), 1);\n\n    // Step 3: read a bunch of times\n    for (int i = 0; i < 1000; i++) {\n      ASSERT_EQ(\"NOT_FOUND\", Get(\"missing\"));\n    }\n\n    // Step 4: Wait for compaction to finish\n    DelayMilliseconds(1000);\n\n    ASSERT_EQ(NumTableFilesAtLevel(0), 0);\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "606-619",
    "snippet": "TEST(DBTest, GetPicksCorrectFile) {\n  do {\n    // Arrange to have multiple files in a non-level-0 level.\n    ASSERT_OK(Put(\"a\", \"va\"));\n    Compact(\"a\", \"b\");\n    ASSERT_OK(Put(\"x\", \"vx\"));\n    Compact(\"x\", \"y\");\n    ASSERT_OK(Put(\"f\", \"vf\"));\n    Compact(\"f\", \"g\");\n    ASSERT_EQ(\"va\", Get(\"a\"));\n    ASSERT_EQ(\"vf\", Get(\"f\"));\n    ASSERT_EQ(\"vx\", Get(\"x\"));\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"vx\"",
            "Get(\"x\")"
          ],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"x\""
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"vf\"",
            "Get(\"f\")"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"va\"",
            "Get(\"a\")"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Compact",
          "args": [
            "\"f\"",
            "\"g\""
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "CompactRange",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1895-1896",
          "snippet": "virtual void CompactRange(const Slice* start, const Slice* end) {\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void CompactRange(const Slice* start, const Slice* end) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"f\", \"vf\")"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"f\"",
            "\"vf\""
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"x\", \"vx\")"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"a\", \"va\")"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, GetPicksCorrectFile) {\n  do {\n    // Arrange to have multiple files in a non-level-0 level.\n    ASSERT_OK(Put(\"a\", \"va\"));\n    Compact(\"a\", \"b\");\n    ASSERT_OK(Put(\"x\", \"vx\"));\n    Compact(\"x\", \"y\");\n    ASSERT_OK(Put(\"f\", \"vf\"));\n    Compact(\"f\", \"g\");\n    ASSERT_EQ(\"va\", Get(\"a\"));\n    ASSERT_EQ(\"vf\", Get(\"f\"));\n    ASSERT_EQ(\"vx\", Get(\"x\"));\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "594-604",
    "snippet": "TEST(DBTest, GetOrderedByLevels) {\n  do {\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    Compact(\"a\", \"z\");\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n    ASSERT_OK(Put(\"foo\", \"v2\"));\n    ASSERT_EQ(\"v2\", Get(\"foo\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"v2\", Get(\"foo\"));\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v2\"",
            "Get(\"foo\")"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\""
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v2\"",
            "Get(\"foo\")"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v2\")"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"v2\""
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"foo\")"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Compact",
          "args": [
            "\"a\"",
            "\"z\""
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "CompactRange",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1895-1896",
          "snippet": "virtual void CompactRange(const Slice* start, const Slice* end) {\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void CompactRange(const Slice* start, const Slice* end) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v1\")"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, GetOrderedByLevels) {\n  do {\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    Compact(\"a\", \"z\");\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n    ASSERT_OK(Put(\"foo\", \"v2\"));\n    ASSERT_EQ(\"v2\", Get(\"foo\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"v2\", Get(\"foo\"));\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "579-592",
    "snippet": "TEST(DBTest, GetLevel0Ordering) {\n  do {\n    // Check that we process level-0 files in correct order.  The code\n    // below generates two level-0 files where the earlier one comes\n    // before the later one in the level-0 file list since the earlier\n    // one has a smaller \"smallest\" key.\n    ASSERT_OK(Put(\"bar\", \"b\"));\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_OK(Put(\"foo\", \"v2\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"v2\", Get(\"foo\"));\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v2\"",
            "Get(\"foo\")"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\""
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v2\")"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"v2\""
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v1\")"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"bar\", \"b\")"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, GetLevel0Ordering) {\n  do {\n    // Check that we process level-0 files in correct order.  The code\n    // below generates two level-0 files where the earlier one comes\n    // before the later one in the level-0 file list since the earlier\n    // one has a smaller \"smallest\" key.\n    ASSERT_OK(Put(\"bar\", \"b\"));\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_OK(Put(\"foo\", \"v2\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"v2\", Get(\"foo\"));\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "561-577",
    "snippet": "TEST(DBTest, GetSnapshot) {\n  do {\n    // Try with both a short key and a long key\n    for (int i = 0; i < 2; i++) {\n      std::string key = (i == 0) ? std::string(\"foo\") : std::string(200, 'x');\n      ASSERT_OK(Put(key, \"v1\"));\n      const Snapshot* s1 = db_->GetSnapshot();\n      ASSERT_OK(Put(key, \"v2\"));\n      ASSERT_EQ(\"v2\", Get(key));\n      ASSERT_EQ(\"v1\", Get(key, s1));\n      dbfull()->TEST_CompactMemTable();\n      ASSERT_EQ(\"v2\", Get(key));\n      ASSERT_EQ(\"v1\", Get(key, s1));\n      db_->ReleaseSnapshot(s1);\n    }\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->ReleaseSnapshot",
          "args": [
            "s1"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSnapshot",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1868-1870",
          "snippet": "virtual void ReleaseSnapshot(const Snapshot* snapshot) {\n    delete reinterpret_cast<const ModelSnapshot*>(snapshot);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void ReleaseSnapshot(const Snapshot* snapshot) {\n      delete reinterpret_cast<const ModelSnapshot*>(snapshot);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(key, s1)"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "key",
            "s1"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "GetProperty",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1887-1889",
          "snippet": "virtual bool GetProperty(const Slice& property, std::string* value) {\n    return false;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual bool GetProperty(const Slice& property, std::string* value) {\n      return false;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v2\"",
            "Get(key)"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "key"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(key, s1)"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v2\"",
            "Get(key)"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(key, \"v2\")"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "key",
            "\"v2\""
          ],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->GetSnapshot",
          "args": [],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(key, \"v1\")"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "200",
            "'x'"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"foo\""
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, GetSnapshot) {\n  do {\n    // Try with both a short key and a long key\n    for (int i = 0; i < 2; i++) {\n      std::string key = (i == 0) ? std::string(\"foo\") : std::string(200, 'x');\n      ASSERT_OK(Put(key, \"v1\"));\n      const Snapshot* s1 = db_->GetSnapshot();\n      ASSERT_OK(Put(key, \"v2\"));\n      ASSERT_EQ(\"v2\", Get(key));\n      ASSERT_EQ(\"v1\", Get(key, s1));\n      dbfull()->TEST_CompactMemTable();\n      ASSERT_EQ(\"v2\", Get(key));\n      ASSERT_EQ(\"v1\", Get(key, s1));\n      db_->ReleaseSnapshot(s1);\n    }\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "553-559",
    "snippet": "TEST(DBTest, GetFromVersions) {\n  do {\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"foo\")"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\""
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v1\")"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"v1\""
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, GetFromVersions) {\n  do {\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    dbfull()->TEST_CompactMemTable();\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "535-551",
    "snippet": "TEST(DBTest, GetFromImmutableLayer) {\n  do {\n    Options options = CurrentOptions();\n    options.env = env_;\n    options.write_buffer_size = 100000;  // Small write buffer\n    Reopen(&options);\n\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n\n    env_->delay_data_sync_.Release_Store(env_);      // Block sync calls\n    Put(\"k1\", std::string(100000, 'x'));             // Fill memtable\n    Put(\"k2\", std::string(100000, 'y'));             // Trigger compaction\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n    env_->delay_data_sync_.Release_Store(NULL);      // Release sync calls\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "env_->delay_data_sync_.Release_Store",
          "args": [
            "NULL"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"foo\")"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\""
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"k2\"",
            "std::string(100000, 'y')"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "100000",
            "'y'"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "100000",
            "'x'"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"foo\")"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v1\")"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reopen",
          "args": [
            "&options"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, GetFromImmutableLayer) {\n  do {\n    Options options = CurrentOptions();\n    options.env = env_;\n    options.write_buffer_size = 100000;  // Small write buffer\n    Reopen(&options);\n\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n\n    env_->delay_data_sync_.Release_Store(env_);      // Block sync calls\n    Put(\"k1\", std::string(100000, 'x'));             // Fill memtable\n    Put(\"k2\", std::string(100000, 'y'));             // Trigger compaction\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n    env_->delay_data_sync_.Release_Store(NULL);      // Release sync calls\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "524-533",
    "snippet": "TEST(DBTest, PutDeleteGet) {\n  do {\n    ASSERT_OK(db_->Put(WriteOptions(), \"foo\", \"v1\"));\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n    ASSERT_OK(db_->Put(WriteOptions(), \"foo\", \"v2\"));\n    ASSERT_EQ(\"v2\", Get(\"foo\"));\n    ASSERT_OK(db_->Delete(WriteOptions(), \"foo\"));\n    ASSERT_EQ(\"NOT_FOUND\", Get(\"foo\"));\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"NOT_FOUND\"",
            "Get(\"foo\")"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\""
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "db_->Delete(WriteOptions(), \"foo\")"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->Delete",
          "args": [
            "WriteOptions()",
            "\"foo\""
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1843-1845",
          "snippet": "virtual Status Delete(const WriteOptions& o, const Slice& key) {\n    return DB::Delete(o, key);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Delete(const WriteOptions& o, const Slice& key) {\n      return DB::Delete(o, key);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WriteOptions",
          "args": [],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "WriteOptions",
          "container": "WriteOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "188-190",
          "snippet": "WriteOptions()\n      : sync(false) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nWriteOptions {\n  WriteOptions()\n        : sync(false) {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v2\"",
            "Get(\"foo\")"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "db_->Put(WriteOptions(), \"foo\", \"v2\")"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->Put",
          "args": [
            "WriteOptions()",
            "\"foo\"",
            "\"v2\""
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1840-1842",
          "snippet": "virtual Status Put(const WriteOptions& o, const Slice& k, const Slice& v) {\n    return DB::Put(o, k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Put(const WriteOptions& o, const Slice& k, const Slice& v) {\n      return DB::Put(o, k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"foo\")"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "db_->Put(WriteOptions(), \"foo\", \"v1\")"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, PutDeleteGet) {\n  do {\n    ASSERT_OK(db_->Put(WriteOptions(), \"foo\", \"v1\"));\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n    ASSERT_OK(db_->Put(WriteOptions(), \"foo\", \"v2\"));\n    ASSERT_EQ(\"v2\", Get(\"foo\"));\n    ASSERT_OK(db_->Delete(WriteOptions(), \"foo\"));\n    ASSERT_EQ(\"NOT_FOUND\", Get(\"foo\"));\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "513-522",
    "snippet": "TEST(DBTest, ReadWrite) {\n  do {\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n    ASSERT_OK(Put(\"bar\", \"v2\"));\n    ASSERT_OK(Put(\"foo\", \"v3\"));\n    ASSERT_EQ(\"v3\", Get(\"foo\"));\n    ASSERT_EQ(\"v2\", Get(\"bar\"));\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 521
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v2\"",
            "Get(\"bar\")"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"bar\""
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v3\"",
            "Get(\"foo\")"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v3\")"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "\"foo\"",
            "\"v3\""
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"bar\", \"v2\")"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"v1\"",
            "Get(\"foo\")"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "Put(\"foo\", \"v1\")"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, ReadWrite) {\n  do {\n    ASSERT_OK(Put(\"foo\", \"v1\"));\n    ASSERT_EQ(\"v1\", Get(\"foo\"));\n    ASSERT_OK(Put(\"bar\", \"v2\"));\n    ASSERT_OK(Put(\"foo\", \"v3\"));\n    ASSERT_EQ(\"v3\", Get(\"foo\"));\n    ASSERT_EQ(\"v2\", Get(\"bar\"));\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "506-511",
    "snippet": "TEST(DBTest, Empty) {\n  do {\n    ASSERT_TRUE(db_ != NULL);\n    ASSERT_EQ(\"NOT_FOUND\", Get(\"foo\"));\n  } while (ChangeOptions());\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChangeOptions",
          "args": [],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "ChangeOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "227-235",
          "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"NOT_FOUND\"",
            "Get(\"foo\")"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "\"foo\""
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "296-307",
          "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "db_ != NULL"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nTEST(DBTest, Empty) {\n  do {\n    ASSERT_TRUE(db_ != NULL);\n    ASSERT_EQ(\"NOT_FOUND\", Get(\"foo\"));\n  } while (ChangeOptions());\n}"
  },
  {
    "function_name": "RenameLDBToSST",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "488-503",
    "snippet": "int RenameLDBToSST() {\n    std::vector<std::string> filenames;\n    ASSERT_OK(env_->GetChildren(dbname_, &filenames));\n    uint64_t number;\n    FileType type;\n    int files_renamed = 0;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) && type == kTableFile) {\n        const std::string from = TableFileName(dbname_, number);\n        const std::string to = SSTTableFileName(dbname_, number);\n        ASSERT_OK(env_->RenameFile(from, to));\n        files_renamed++;\n      }\n    }\n    return files_renamed;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "env_->RenameFile(from, to)"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "env_->RenameFile",
          "args": [
            "from",
            "to"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "RenameFile",
          "container": "Win32Env",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "832-853",
          "snippet": "Status Win32Env::RenameFile( const std::string& src, const std::string& target )\n{\n    Status sRet;\n    std::string src_path = src;\n    std::wstring wsrc_path;\n\tToWidePath(ModifyPath(src_path), wsrc_path);\n\tstd::string target_path = target;\n    std::wstring wtarget_path;\n\tToWidePath(ModifyPath(target_path), wtarget_path);\n\n    if(!MoveFileW(wsrc_path.c_str(), wtarget_path.c_str() ) ){\n        DWORD err = GetLastError();\n        if(err == 0x000000b7){\n            if(!::DeleteFileW(wtarget_path.c_str() ) )\n                sRet = Status::IOError(src, \"Could not rename file.\");\n\t\t\telse if(!::MoveFileW(wsrc_path.c_str(),\n                                 wtarget_path.c_str() ) )\n                sRet = Status::IOError(src, \"Could not rename file.\");    \n        }\n    }\n    return sRet;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::RenameFile( const std::string& src, const std::string& target )\n  {\n      Status sRet;\n      std::string src_path = src;\n      std::wstring wsrc_path;\n  \tToWidePath(ModifyPath(src_path), wsrc_path);\n  \tstd::string target_path = target;\n      std::wstring wtarget_path;\n  \tToWidePath(ModifyPath(target_path), wtarget_path);\n  \n      if(!MoveFileW(wsrc_path.c_str(), wtarget_path.c_str() ) ){\n          DWORD err = GetLastError();\n          if(err == 0x000000b7){\n              if(!::DeleteFileW(wtarget_path.c_str() ) )\n                  sRet = Status::IOError(src, \"Could not rename file.\");\n  \t\t\telse if(!::MoveFileW(wsrc_path.c_str(),\n                                   wtarget_path.c_str() ) )\n                  sRet = Status::IOError(src, \"Could not rename file.\");    \n          }\n      }\n      return sRet;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSTTableFileName",
          "args": [
            "dbname_",
            "number"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "SSTTableFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename.cc",
          "lines": "42-45",
          "snippet": "std::string SSTTableFileName(const std::string& name, uint64_t number) {\n  assert(number > 0);\n  return MakeFileName(name, number, \"ldb\");\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <ctype.h>\n\nstd::string SSTTableFileName(const std::string& name, uint64_t number) {\n  assert(number > 0);\n  return MakeFileName(name, number, \"ldb\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "ParseFileName",
          "args": [
            "filenames[i]",
            "&number",
            "&type"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "ParseFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename.cc",
          "lines": "85-129",
          "snippet": "bool ParseFileName(const std::string& fname,\n                   uint64_t* number,\n                   FileType* type) {\n  Slice rest(fname);\n  if (rest == \"CURRENT\") {\n    *number = 0;\n    *type = kCurrentFile;\n  } else if (rest == \"LOCK\") {\n    *number = 0;\n    *type = kDBLockFile;\n  } else if (rest == \"LOG\" || rest == \"LOG.old\") {\n    *number = 0;\n    *type = kInfoLogFile;\n  } else if (rest.starts_with(\"MANIFEST-\")) {\n    rest.remove_prefix(strlen(\"MANIFEST-\"));\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    if (!rest.empty()) {\n      return false;\n    }\n    *type = kDescriptorFile;\n    *number = num;\n  } else {\n    // Avoid strtoull() to keep filename format independent of the\n    // current locale\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    Slice suffix = rest;\n    if (suffix == Slice(\".log\")) {\n      *type = kLogFile;\n    } else if (suffix == Slice(\".sst\") || suffix == Slice(\".ldb\")) {\n      *type = kTableFile;\n    } else if (suffix == Slice(\".dbtmp\")) {\n      *type = kTempFile;\n    } else {\n      return false;\n    }\n    *number = num;\n  }\n  return true;\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <ctype.h>\n\nbool ParseFileName(const std::string& fname,\n                   uint64_t* number,\n                   FileType* type) {\n  Slice rest(fname);\n  if (rest == \"CURRENT\") {\n    *number = 0;\n    *type = kCurrentFile;\n  } else if (rest == \"LOCK\") {\n    *number = 0;\n    *type = kDBLockFile;\n  } else if (rest == \"LOG\" || rest == \"LOG.old\") {\n    *number = 0;\n    *type = kInfoLogFile;\n  } else if (rest.starts_with(\"MANIFEST-\")) {\n    rest.remove_prefix(strlen(\"MANIFEST-\"));\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    if (!rest.empty()) {\n      return false;\n    }\n    *type = kDescriptorFile;\n    *number = num;\n  } else {\n    // Avoid strtoull() to keep filename format independent of the\n    // current locale\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    Slice suffix = rest;\n    if (suffix == Slice(\".log\")) {\n      *type = kLogFile;\n    } else if (suffix == Slice(\".sst\") || suffix == Slice(\".ldb\")) {\n      *type = kTableFile;\n    } else if (suffix == Slice(\".dbtmp\")) {\n      *type = kTempFile;\n    } else {\n      return false;\n    }\n    *number = num;\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "filenames.size",
          "args": [],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "env_->GetChildren(dbname_, &filenames)"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "env_->GetChildren",
          "args": [
            "dbname_",
            "&filenames"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "GetChildren",
          "container": "Win32Env",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "767-793",
          "snippet": "Status Win32Env::GetChildren(const std::string& dir, std::vector<std::string>* result)\n{\n    Status sRet;\n    ::WIN32_FIND_DATAW wfd;\n    std::string path = dir;\n    ModifyPath(path);\n    path += \"\\\\*.*\";\n\tstd::wstring wpath;\n\tToWidePath(path, wpath);\n\n\t::HANDLE hFind = ::FindFirstFileW(wpath.c_str() ,&wfd);\n    if(hFind && hFind != INVALID_HANDLE_VALUE){\n        BOOL hasNext = TRUE;\n        std::string child;\n        while(hasNext){\n            ToNarrowPath(wfd.cFileName, child); \n            if(child != \"..\" && child != \".\")  {\n                result->push_back(child);\n            }\n            hasNext = ::FindNextFileW(hFind,&wfd);\n        }\n        ::FindClose(hFind);\n    }\n    else\n        sRet = Status::IOError(dir,\"Could not get children.\");\n    return sRet;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::GetChildren(const std::string& dir, std::vector<std::string>* result)\n  {\n      Status sRet;\n      ::WIN32_FIND_DATAW wfd;\n      std::string path = dir;\n      ModifyPath(path);\n      path += \"\\\\*.*\";\n  \tstd::wstring wpath;\n  \tToWidePath(path, wpath);\n  \n  \t::HANDLE hFind = ::FindFirstFileW(wpath.c_str() ,&wfd);\n      if(hFind && hFind != INVALID_HANDLE_VALUE){\n          BOOL hasNext = TRUE;\n          std::string child;\n          while(hasNext){\n              ToNarrowPath(wfd.cFileName, child); \n              if(child != \"..\" && child != \".\")  {\n                  result->push_back(child);\n              }\n              hasNext = ::FindNextFileW(hFind,&wfd);\n          }\n          ::FindClose(hFind);\n      }\n      else\n          sRet = Status::IOError(dir,\"Could not get children.\");\n      return sRet;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int RenameLDBToSST() {\n      std::vector<std::string> filenames;\n      ASSERT_OK(env_->GetChildren(dbname_, &filenames));\n      uint64_t number;\n      FileType type;\n      int files_renamed = 0;\n      for (size_t i = 0; i < filenames.size(); i++) {\n        if (ParseFileName(filenames[i], &number, &type) && type == kTableFile) {\n          const std::string from = TableFileName(dbname_, number);\n          const std::string to = SSTTableFileName(dbname_, number);\n          ASSERT_OK(env_->RenameFile(from, to));\n          files_renamed++;\n        }\n      }\n      return files_renamed;\n    }\n}"
  },
  {
    "function_name": "DeleteAnSSTFile",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "473-485",
    "snippet": "bool DeleteAnSSTFile() {\n    std::vector<std::string> filenames;\n    ASSERT_OK(env_->GetChildren(dbname_, &filenames));\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) && type == kTableFile) {\n        ASSERT_OK(env_->DeleteFile(TableFileName(dbname_, number)));\n        return true;\n      }\n    }\n    return false;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "env_->DeleteFile(TableFileName(dbname_, number))"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "env_->DeleteFile",
          "args": [
            "TableFileName(dbname_, number)"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "DeleteFile",
          "container": "Win32Env",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "801-812",
          "snippet": "Status Win32Env::DeleteFile( const std::string& fname )\n{\n    Status sRet;\n    std::string path = fname;\n    std::wstring wpath;\n\tToWidePath(ModifyPath(path), wpath);\n\n    if(!::DeleteFileW(wpath.c_str())) {\n        sRet = Status::IOError(path, \"Could not delete file.\");\n    }\n    return sRet;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::DeleteFile( const std::string& fname )\n  {\n      Status sRet;\n      std::string path = fname;\n      std::wstring wpath;\n  \tToWidePath(ModifyPath(path), wpath);\n  \n      if(!::DeleteFileW(wpath.c_str())) {\n          sRet = Status::IOError(path, \"Could not delete file.\");\n      }\n      return sRet;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TableFileName",
          "args": [
            "dbname_",
            "number"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "SSTTableFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename.cc",
          "lines": "42-45",
          "snippet": "std::string SSTTableFileName(const std::string& name, uint64_t number) {\n  assert(number > 0);\n  return MakeFileName(name, number, \"ldb\");\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <ctype.h>\n\nstd::string SSTTableFileName(const std::string& name, uint64_t number) {\n  assert(number > 0);\n  return MakeFileName(name, number, \"ldb\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "ParseFileName",
          "args": [
            "filenames[i]",
            "&number",
            "&type"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "ParseFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/filename.cc",
          "lines": "85-129",
          "snippet": "bool ParseFileName(const std::string& fname,\n                   uint64_t* number,\n                   FileType* type) {\n  Slice rest(fname);\n  if (rest == \"CURRENT\") {\n    *number = 0;\n    *type = kCurrentFile;\n  } else if (rest == \"LOCK\") {\n    *number = 0;\n    *type = kDBLockFile;\n  } else if (rest == \"LOG\" || rest == \"LOG.old\") {\n    *number = 0;\n    *type = kInfoLogFile;\n  } else if (rest.starts_with(\"MANIFEST-\")) {\n    rest.remove_prefix(strlen(\"MANIFEST-\"));\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    if (!rest.empty()) {\n      return false;\n    }\n    *type = kDescriptorFile;\n    *number = num;\n  } else {\n    // Avoid strtoull() to keep filename format independent of the\n    // current locale\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    Slice suffix = rest;\n    if (suffix == Slice(\".log\")) {\n      *type = kLogFile;\n    } else if (suffix == Slice(\".sst\") || suffix == Slice(\".ldb\")) {\n      *type = kTableFile;\n    } else if (suffix == Slice(\".dbtmp\")) {\n      *type = kTempFile;\n    } else {\n      return false;\n    }\n    *number = num;\n  }\n  return true;\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/filename.h\"",
            "#include <stdio.h>",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/env.h\"\n#include \"db/dbformat.h\"\n#include \"db/filename.h\"\n#include <stdio.h>\n#include <ctype.h>\n\nbool ParseFileName(const std::string& fname,\n                   uint64_t* number,\n                   FileType* type) {\n  Slice rest(fname);\n  if (rest == \"CURRENT\") {\n    *number = 0;\n    *type = kCurrentFile;\n  } else if (rest == \"LOCK\") {\n    *number = 0;\n    *type = kDBLockFile;\n  } else if (rest == \"LOG\" || rest == \"LOG.old\") {\n    *number = 0;\n    *type = kInfoLogFile;\n  } else if (rest.starts_with(\"MANIFEST-\")) {\n    rest.remove_prefix(strlen(\"MANIFEST-\"));\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    if (!rest.empty()) {\n      return false;\n    }\n    *type = kDescriptorFile;\n    *number = num;\n  } else {\n    // Avoid strtoull() to keep filename format independent of the\n    // current locale\n    uint64_t num;\n    if (!ConsumeDecimalNumber(&rest, &num)) {\n      return false;\n    }\n    Slice suffix = rest;\n    if (suffix == Slice(\".log\")) {\n      *type = kLogFile;\n    } else if (suffix == Slice(\".sst\") || suffix == Slice(\".ldb\")) {\n      *type = kTableFile;\n    } else if (suffix == Slice(\".dbtmp\")) {\n      *type = kTempFile;\n    } else {\n      return false;\n    }\n    *number = num;\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "filenames.size",
          "args": [],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "env_->GetChildren(dbname_, &filenames)"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "env_->GetChildren",
          "args": [
            "dbname_",
            "&filenames"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "GetChildren",
          "container": "Win32Env",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "767-793",
          "snippet": "Status Win32Env::GetChildren(const std::string& dir, std::vector<std::string>* result)\n{\n    Status sRet;\n    ::WIN32_FIND_DATAW wfd;\n    std::string path = dir;\n    ModifyPath(path);\n    path += \"\\\\*.*\";\n\tstd::wstring wpath;\n\tToWidePath(path, wpath);\n\n\t::HANDLE hFind = ::FindFirstFileW(wpath.c_str() ,&wfd);\n    if(hFind && hFind != INVALID_HANDLE_VALUE){\n        BOOL hasNext = TRUE;\n        std::string child;\n        while(hasNext){\n            ToNarrowPath(wfd.cFileName, child); \n            if(child != \"..\" && child != \".\")  {\n                result->push_back(child);\n            }\n            hasNext = ::FindNextFileW(hFind,&wfd);\n        }\n        ::FindClose(hFind);\n    }\n    else\n        sRet = Status::IOError(dir,\"Could not get children.\");\n    return sRet;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::GetChildren(const std::string& dir, std::vector<std::string>* result)\n  {\n      Status sRet;\n      ::WIN32_FIND_DATAW wfd;\n      std::string path = dir;\n      ModifyPath(path);\n      path += \"\\\\*.*\";\n  \tstd::wstring wpath;\n  \tToWidePath(path, wpath);\n  \n  \t::HANDLE hFind = ::FindFirstFileW(wpath.c_str() ,&wfd);\n      if(hFind && hFind != INVALID_HANDLE_VALUE){\n          BOOL hasNext = TRUE;\n          std::string child;\n          while(hasNext){\n              ToNarrowPath(wfd.cFileName, child); \n              if(child != \"..\" && child != \".\")  {\n                  result->push_back(child);\n              }\n              hasNext = ::FindNextFileW(hFind,&wfd);\n          }\n          ::FindClose(hFind);\n      }\n      else\n          sRet = Status::IOError(dir,\"Could not get children.\");\n      return sRet;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool DeleteAnSSTFile() {\n      std::vector<std::string> filenames;\n      ASSERT_OK(env_->GetChildren(dbname_, &filenames));\n      uint64_t number;\n      FileType type;\n      for (size_t i = 0; i < filenames.size(); i++) {\n        if (ParseFileName(filenames[i], &number, &type) && type == kTableFile) {\n          ASSERT_OK(env_->DeleteFile(TableFileName(dbname_, number)));\n          return true;\n        }\n      }\n      return false;\n    }\n}"
  },
  {
    "function_name": "IterStatus",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "463-471",
    "snippet": "std::string IterStatus(Iterator* iter) {\n    std::string result;\n    if (iter->Valid()) {\n      result = iter->key().ToString() + \"->\" + iter->value().ToString();\n    } else {\n      result = \"(invalid)\";\n    }\n    return result;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->value",
          "args": [],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1922-1922",
          "snippet": "virtual Slice value() const { return iter_->second; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual Slice value() const { return iter_->second; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->key",
          "args": [],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1921-1921",
          "snippet": "virtual Slice key() const { return iter_->first; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual Slice key() const { return iter_->first; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Valid",
          "args": [],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1907-1907",
          "snippet": "virtual bool Valid() const { return iter_ != map_->end(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual bool Valid() const { return iter_ != map_->end(); }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string IterStatus(Iterator* iter) {\n      std::string result;\n      if (iter->Valid()) {\n        result = iter->key().ToString() + \"->\" + iter->value().ToString();\n      } else {\n        result = \"(invalid)\";\n      }\n      return result;\n    }\n}"
  },
  {
    "function_name": "DumpSSTableList",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "457-461",
    "snippet": "std::string DumpSSTableList() {\n    std::string property;\n    db_->GetProperty(\"leveldb.sstables\", &property);\n    return property;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db_->GetProperty",
          "args": [
            "\"leveldb.sstables\"",
            "&property"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "GetProperty",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1887-1889",
          "snippet": "virtual bool GetProperty(const Slice& property, std::string* value) {\n    return false;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual bool GetProperty(const Slice& property, std::string* value) {\n      return false;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string DumpSSTableList() {\n      std::string property;\n      db_->GetProperty(\"leveldb.sstables\", &property);\n      return property;\n    }\n}"
  },
  {
    "function_name": "DumpFileCounts",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "444-455",
    "snippet": "void DumpFileCounts(const char* label) {\n    fprintf(stderr, \"---\\n%s:\\n\", label);\n    fprintf(stderr, \"maxoverlap: %lld\\n\",\n            static_cast<long long>(\n                dbfull()->TEST_MaxNextLevelOverlappingBytes()));\n    for (int level = 0; level < config::kNumLevels; level++) {\n      int num = NumTableFilesAtLevel(level);\n      if (num > 0) {\n        fprintf(stderr, \"  level %3d : %d files\\n\", level, num);\n      }\n    }\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"  level %3d : %d files\\n\"",
            "level",
            "num"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NumTableFilesAtLevel",
          "args": [
            "level"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "NumTableFilesAtLevel",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "378-384",
          "snippet": "int NumTableFilesAtLevel(int level) {\n    std::string property;\n    ASSERT_TRUE(\n        db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                         &property));\n    return atoi(property.c_str());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int NumTableFilesAtLevel(int level) {\n      std::string property;\n      ASSERT_TRUE(\n          db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                           &property));\n      return atoi(property.c_str());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"maxoverlap: %lld\\n\"",
            "static_cast<long long>(\n                dbfull()->TEST_MaxNextLevelOverlappingBytes())"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<long long>",
          "args": [
            "dbfull()->TEST_MaxNextLevelOverlappingBytes()"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"---\\n%s:\\n\"",
            "label"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void DumpFileCounts(const char* label) {\n      fprintf(stderr, \"---\\n%s:\\n\", label);\n      fprintf(stderr, \"maxoverlap: %lld\\n\",\n              static_cast<long long>(\n                  dbfull()->TEST_MaxNextLevelOverlappingBytes()));\n      for (int level = 0; level < config::kNumLevels; level++) {\n        int num = NumTableFilesAtLevel(level);\n        if (num > 0) {\n          fprintf(stderr, \"  level %3d : %d files\\n\", level, num);\n        }\n      }\n    }\n}"
  },
  {
    "function_name": "FillLevels",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "440-442",
    "snippet": "void FillLevels(const std::string& smallest, const std::string& largest) {\n    MakeTables(config::kNumLevels, smallest, largest);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MakeTables",
          "args": [
            "config::kNumLevels",
            "smallest",
            "largest"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "MakeTables",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "430-436",
          "snippet": "void MakeTables(int n, const std::string& small, const std::string& large) {\n    for (int i = 0; i < n; i++) {\n      Put(small, \"begin\");\n      Put(large, \"end\");\n      dbfull()->TEST_CompactMemTable();\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void MakeTables(int n, const std::string& small, const std::string& large) {\n      for (int i = 0; i < n; i++) {\n        Put(small, \"begin\");\n        Put(large, \"end\");\n        dbfull()->TEST_CompactMemTable();\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void FillLevels(const std::string& smallest, const std::string& largest) {\n      MakeTables(config::kNumLevels, smallest, largest);\n    }\n}"
  },
  {
    "function_name": "MakeTables",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "430-436",
    "snippet": "void MakeTables(int n, const std::string& small, const std::string& large) {\n    for (int i = 0; i < n; i++) {\n      Put(small, \"begin\");\n      Put(large, \"end\");\n      dbfull()->TEST_CompactMemTable();\n    }\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Put",
          "args": [
            "large",
            "\"end\""
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "288-290",
          "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void MakeTables(int n, const std::string& small, const std::string& large) {\n      for (int i = 0; i < n; i++) {\n        Put(small, \"begin\");\n        Put(large, \"end\");\n        dbfull()->TEST_CompactMemTable();\n      }\n    }\n}"
  },
  {
    "function_name": "Compact",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "424-426",
    "snippet": "void Compact(const Slice& start, const Slice& limit) {\n    db_->CompactRange(&start, &limit);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db_->CompactRange",
          "args": [
            "&start",
            "&limit"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "CompactRange",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1895-1896",
          "snippet": "virtual void CompactRange(const Slice* start, const Slice* end) {\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void CompactRange(const Slice* start, const Slice* end) {\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void Compact(const Slice& start, const Slice& limit) {\n      db_->CompactRange(&start, &limit);\n    }\n}"
  },
  {
    "function_name": "Size",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "417-422",
    "snippet": "uint64_t Size(const Slice& start, const Slice& limit) {\n    Range r(start, limit);\n    uint64_t size;\n    db_->GetApproximateSizes(&r, 1, &size);\n    return size;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db_->GetApproximateSizes",
          "args": [
            "&r",
            "1",
            "&size"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "GetApproximateSizes",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1890-1894",
          "snippet": "virtual void GetApproximateSizes(const Range* r, int n, uint64_t* sizes) {\n    for (int i = 0; i < n; i++) {\n      sizes[i] = 0;\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual void GetApproximateSizes(const Range* r, int n, uint64_t* sizes) {\n      for (int i = 0; i < n; i++) {\n        sizes[i] = 0;\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  uint64_t Size(const Slice& start, const Slice& limit) {\n      Range r(start, limit);\n      uint64_t size;\n      db_->GetApproximateSizes(&r, 1, &size);\n      return size;\n    }\n}"
  },
  {
    "function_name": "CountFiles",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "411-415",
    "snippet": "int CountFiles() {\n    std::vector<std::string> files;\n    env_->GetChildren(dbname_, &files);\n    return static_cast<int>(files.size());\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "files.size()"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "files.size",
          "args": [],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "env_->GetChildren",
          "args": [
            "dbname_",
            "&files"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "GetChildren",
          "container": "Win32Env",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "767-793",
          "snippet": "Status Win32Env::GetChildren(const std::string& dir, std::vector<std::string>* result)\n{\n    Status sRet;\n    ::WIN32_FIND_DATAW wfd;\n    std::string path = dir;\n    ModifyPath(path);\n    path += \"\\\\*.*\";\n\tstd::wstring wpath;\n\tToWidePath(path, wpath);\n\n\t::HANDLE hFind = ::FindFirstFileW(wpath.c_str() ,&wfd);\n    if(hFind && hFind != INVALID_HANDLE_VALUE){\n        BOOL hasNext = TRUE;\n        std::string child;\n        while(hasNext){\n            ToNarrowPath(wfd.cFileName, child); \n            if(child != \"..\" && child != \".\")  {\n                result->push_back(child);\n            }\n            hasNext = ::FindNextFileW(hFind,&wfd);\n        }\n        ::FindClose(hFind);\n    }\n    else\n        sRet = Status::IOError(dir,\"Could not get children.\");\n    return sRet;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  Status Win32Env::GetChildren(const std::string& dir, std::vector<std::string>* result)\n  {\n      Status sRet;\n      ::WIN32_FIND_DATAW wfd;\n      std::string path = dir;\n      ModifyPath(path);\n      path += \"\\\\*.*\";\n  \tstd::wstring wpath;\n  \tToWidePath(path, wpath);\n  \n  \t::HANDLE hFind = ::FindFirstFileW(wpath.c_str() ,&wfd);\n      if(hFind && hFind != INVALID_HANDLE_VALUE){\n          BOOL hasNext = TRUE;\n          std::string child;\n          while(hasNext){\n              ToNarrowPath(wfd.cFileName, child); \n              if(child != \"..\" && child != \".\")  {\n                  result->push_back(child);\n              }\n              hasNext = ::FindNextFileW(hFind,&wfd);\n          }\n          ::FindClose(hFind);\n      }\n      else\n          sRet = Status::IOError(dir,\"Could not get children.\");\n      return sRet;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int CountFiles() {\n      std::vector<std::string> files;\n      env_->GetChildren(dbname_, &files);\n      return static_cast<int>(files.size());\n    }\n}"
  },
  {
    "function_name": "FilesPerLevel",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "395-409",
    "snippet": "std::string FilesPerLevel() {\n    std::string result;\n    int last_non_zero_offset = 0;\n    for (int level = 0; level < config::kNumLevels; level++) {\n      int f = NumTableFilesAtLevel(level);\n      char buf[100];\n      snprintf(buf, sizeof(buf), \"%s%d\", (level ? \",\" : \"\"), f);\n      result += buf;\n      if (f > 0) {\n        last_non_zero_offset = result.size();\n      }\n    }\n    result.resize(last_non_zero_offset);\n    return result;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result.resize",
          "args": [
            "last_non_zero_offset"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.size",
          "args": [],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%s%d\"",
            "(level ? \",\" : \"\")",
            "f"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NumTableFilesAtLevel",
          "args": [
            "level"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "NumTableFilesAtLevel",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "378-384",
          "snippet": "int NumTableFilesAtLevel(int level) {\n    std::string property;\n    ASSERT_TRUE(\n        db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                         &property));\n    return atoi(property.c_str());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int NumTableFilesAtLevel(int level) {\n      std::string property;\n      ASSERT_TRUE(\n          db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                           &property));\n      return atoi(property.c_str());\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string FilesPerLevel() {\n      std::string result;\n      int last_non_zero_offset = 0;\n      for (int level = 0; level < config::kNumLevels; level++) {\n        int f = NumTableFilesAtLevel(level);\n        char buf[100];\n        snprintf(buf, sizeof(buf), \"%s%d\", (level ? \",\" : \"\"), f);\n        result += buf;\n        if (f > 0) {\n          last_non_zero_offset = result.size();\n        }\n      }\n      result.resize(last_non_zero_offset);\n      return result;\n    }\n}"
  },
  {
    "function_name": "TotalTableFiles",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "386-392",
    "snippet": "int TotalTableFiles() {\n    int result = 0;\n    for (int level = 0; level < config::kNumLevels; level++) {\n      result += NumTableFilesAtLevel(level);\n    }\n    return result;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NumTableFilesAtLevel",
          "args": [
            "level"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "NumTableFilesAtLevel",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "378-384",
          "snippet": "int NumTableFilesAtLevel(int level) {\n    std::string property;\n    ASSERT_TRUE(\n        db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                         &property));\n    return atoi(property.c_str());\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int NumTableFilesAtLevel(int level) {\n      std::string property;\n      ASSERT_TRUE(\n          db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                           &property));\n      return atoi(property.c_str());\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int TotalTableFiles() {\n      int result = 0;\n      for (int level = 0; level < config::kNumLevels; level++) {\n        result += NumTableFilesAtLevel(level);\n      }\n      return result;\n    }\n}"
  },
  {
    "function_name": "NumTableFilesAtLevel",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "378-384",
    "snippet": "int NumTableFilesAtLevel(int level) {\n    std::string property;\n    ASSERT_TRUE(\n        db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                         &property));\n    return atoi(property.c_str());\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "property.c_str()"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "atoi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "292-295",
          "snippet": "inline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline int atoi(const std::string& str)\n{\n    return atoi(str.c_str());\n}"
        }
      },
      {
        "call_info": {
          "callee": "property.c_str",
          "args": [],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                         &property)"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_->GetProperty",
          "args": [
            "\"leveldb.num-files-at-level\" + NumberToString(level)",
            "&property"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "GetProperty",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1887-1889",
          "snippet": "virtual bool GetProperty(const Slice& property, std::string* value) {\n    return false;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual bool GetProperty(const Slice& property, std::string* value) {\n      return false;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "NumberToString",
          "args": [
            "level"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "NumberToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
          "lines": "36-40",
          "snippet": "std::string NumberToString(uint64_t num) {\n  std::string r;\n  AppendNumberTo(&r, num);\n  return r;\n}",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"util/logging.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nstd::string NumberToString(uint64_t num) {\n  std::string r;\n  AppendNumberTo(&r, num);\n  return r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  int NumTableFilesAtLevel(int level) {\n      std::string property;\n      ASSERT_TRUE(\n          db_->GetProperty(\"leveldb.num-files-at-level\" + NumberToString(level),\n                           &property));\n      return atoi(property.c_str());\n    }\n}"
  },
  {
    "function_name": "AllEntriesFor",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "336-376",
    "snippet": "std::string AllEntriesFor(const Slice& user_key) {\n    Iterator* iter = dbfull()->TEST_NewInternalIterator();\n    InternalKey target(user_key, kMaxSequenceNumber, kTypeValue);\n    iter->Seek(target.Encode());\n    std::string result;\n    if (!iter->status().ok()) {\n      result = iter->status().ToString();\n    } else {\n      result = \"[ \";\n      bool first = true;\n      while (iter->Valid()) {\n        ParsedInternalKey ikey;\n        if (!ParseInternalKey(iter->key(), &ikey)) {\n          result += \"CORRUPTED\";\n        } else {\n          if (last_options_.comparator->Compare(ikey.user_key, user_key) != 0) {\n            break;\n          }\n          if (!first) {\n            result += \", \";\n          }\n          first = false;\n          switch (ikey.type) {\n            case kTypeValue:\n              result += iter->value().ToString();\n              break;\n            case kTypeDeletion:\n              result += \"DEL\";\n              break;\n          }\n        }\n        iter->Next();\n      }\n      if (!first) {\n        result += \" \";\n      }\n      result += \"]\";\n    }\n    delete iter;\n    return result;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->Next",
          "args": [],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1919-1919",
          "snippet": "virtual void Next() { ++iter_; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Next() { ++iter_; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->value",
          "args": [],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1922-1922",
          "snippet": "virtual Slice value() const { return iter_->second; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual Slice value() const { return iter_->second; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "last_options_.comparator->Compare",
          "args": [
            "ikey.user_key",
            "user_key"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "Compare",
          "container": "leveldb_comparator_t",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "73-75",
          "snippet": "virtual int Compare(const Slice& a, const Slice& b) const {\n    return (*compare_)(state_, a.data(), a.size(), b.data(), b.size());\n  }",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nleveldb_comparator_t {\n  virtual int Compare(const Slice& a, const Slice& b) const {\n      return (*compare_)(state_, a.data(), a.size(), b.data(), b.size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ParseInternalKey",
          "args": [
            "iter->key()",
            "&ikey"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "ParseInternalKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "176-186",
          "snippet": "inline bool ParseInternalKey(const Slice& internal_key,\n                             ParsedInternalKey* result) {\n  const size_t n = internal_key.size();\n  if (n < 8) return false;\n  uint64_t num = DecodeFixed64(internal_key.data() + n - 8);\n  unsigned char c = num & 0xff;\n  result->sequence = num >> 8;\n  result->type = static_cast<ValueType>(c);\n  result->user_key = Slice(internal_key.data(), n - 8);\n  return (c <= static_cast<unsigned char>(kTypeValue));\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\ninline bool ParseInternalKey(const Slice& internal_key,\n                             ParsedInternalKey* result) {\n  const size_t n = internal_key.size();\n  if (n < 8) return false;\n  uint64_t num = DecodeFixed64(internal_key.data() + n - 8);\n  unsigned char c = num & 0xff;\n  result->sequence = num >> 8;\n  result->type = static_cast<ValueType>(c);\n  result->user_key = Slice(internal_key.data(), n - 8);\n  return (c <= static_cast<unsigned char>(kTypeValue));\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->key",
          "args": [],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1921-1921",
          "snippet": "virtual Slice key() const { return iter_->first; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual Slice key() const { return iter_->first; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Valid",
          "args": [],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1907-1907",
          "snippet": "virtual bool Valid() const { return iter_ != map_->end(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual bool Valid() const { return iter_ != map_->end(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->status",
          "args": [],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "status",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1923-1923",
          "snippet": "virtual Status status() const { return Status::OK(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual Status status() const { return Status::OK(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Seek",
          "args": [
            "target.Encode()"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "Seek",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1916-1918",
          "snippet": "virtual void Seek(const Slice& k) {\n      iter_ = map_->lower_bound(k.ToString());\n    }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Seek(const Slice& k) {\n          iter_ = map_->lower_bound(k.ToString());\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "target.Encode",
          "args": [],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "Encode",
          "container": "InternalKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "154-157",
          "snippet": "Slice Encode() const {\n    assert(!rep_.empty());\n    return rep_;\n  }",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\nInternalKey {\n  Slice Encode() const {\n      assert(!rep_.empty());\n      return rep_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbfull",
          "args": [],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string AllEntriesFor(const Slice& user_key) {\n      Iterator* iter = dbfull()->TEST_NewInternalIterator();\n      InternalKey target(user_key, kMaxSequenceNumber, kTypeValue);\n      iter->Seek(target.Encode());\n      std::string result;\n      if (!iter->status().ok()) {\n        result = iter->status().ToString();\n      } else {\n        result = \"[ \";\n        bool first = true;\n        while (iter->Valid()) {\n          ParsedInternalKey ikey;\n          if (!ParseInternalKey(iter->key(), &ikey)) {\n            result += \"CORRUPTED\";\n          } else {\n            if (last_options_.comparator->Compare(ikey.user_key, user_key) != 0) {\n              break;\n            }\n            if (!first) {\n              result += \", \";\n            }\n            first = false;\n            switch (ikey.type) {\n              case kTypeValue:\n                result += iter->value().ToString();\n                break;\n              case kTypeDeletion:\n                result += \"DEL\";\n                break;\n            }\n          }\n          iter->Next();\n        }\n        if (!first) {\n          result += \" \";\n        }\n        result += \"]\";\n      }\n      delete iter;\n      return result;\n    }\n}"
  },
  {
    "function_name": "Contents",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "311-334",
    "snippet": "std::string Contents() {\n    std::vector<std::string> forward;\n    std::string result;\n    Iterator* iter = db_->NewIterator(ReadOptions());\n    for (iter->SeekToFirst(); iter->Valid(); iter->Next()) {\n      std::string s = IterStatus(iter);\n      result.push_back('(');\n      result.append(s);\n      result.push_back(')');\n      forward.push_back(s);\n    }\n\n    // Check reverse iteration results are the reverse of forward results\n    size_t matched = 0;\n    for (iter->SeekToLast(); iter->Valid(); iter->Prev()) {\n      ASSERT_LT(matched, forward.size());\n      ASSERT_EQ(IterStatus(iter), forward[forward.size() - matched - 1]);\n      matched++;\n    }\n    ASSERT_EQ(matched, forward.size());\n\n    delete iter;\n    return result;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "matched",
            "forward.size()"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "forward.size",
          "args": [],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "IterStatus(iter)",
            "forward[forward.size() - matched - 1]"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IterStatus",
          "args": [
            "iter"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "IterStatus",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "463-471",
          "snippet": "std::string IterStatus(Iterator* iter) {\n    std::string result;\n    if (iter->Valid()) {\n      result = iter->key().ToString() + \"->\" + iter->value().ToString();\n    } else {\n      result = \"(invalid)\";\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string IterStatus(Iterator* iter) {\n      std::string result;\n      if (iter->Valid()) {\n        result = iter->key().ToString() + \"->\" + iter->value().ToString();\n      } else {\n        result = \"(invalid)\";\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_LT",
          "args": [
            "matched",
            "forward.size()"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Prev",
          "args": [],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "Prev",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1920-1920",
          "snippet": "virtual void Prev() { --iter_; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Prev() { --iter_; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->Valid",
          "args": [],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "Valid",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1907-1907",
          "snippet": "virtual bool Valid() const { return iter_ != map_->end(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual bool Valid() const { return iter_ != map_->end(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->SeekToLast",
          "args": [],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToLast",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1909-1915",
          "snippet": "virtual void SeekToLast() {\n      if (map_->empty()) {\n        iter_ = map_->end();\n      } else {\n        iter_ = map_->find(map_->rbegin()->first);\n      }\n    }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToLast() {\n          if (map_->empty()) {\n            iter_ = map_->end();\n          } else {\n            iter_ = map_->find(map_->rbegin()->first);\n          }\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "forward.push_back",
          "args": [
            "s"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.push_back",
          "args": [
            "')'"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.append",
          "args": [
            "s"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.push_back",
          "args": [
            "'('"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->Next",
          "args": [],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "Next",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1919-1919",
          "snippet": "virtual void Next() { ++iter_; }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void Next() { ++iter_; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iter->SeekToFirst",
          "args": [],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "SeekToFirst",
          "container": "ModelDB::ModelIter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1908-1908",
          "snippet": "virtual void SeekToFirst() { iter_ = map_->begin(); }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  ModelIter {\n    virtual void SeekToFirst() { iter_ = map_->begin(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->NewIterator",
          "args": [
            "ReadOptions()"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReadOptions",
          "args": [],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "ReadOptions",
          "container": "ReadOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "161-165",
          "snippet": "ReadOptions()\n      : verify_checksums(false),\n        fill_cache(true),\n        snapshot(NULL) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nReadOptions {\n  ReadOptions()\n        : verify_checksums(false),\n          fill_cache(true),\n          snapshot(NULL) {\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Contents() {\n      std::vector<std::string> forward;\n      std::string result;\n      Iterator* iter = db_->NewIterator(ReadOptions());\n      for (iter->SeekToFirst(); iter->Valid(); iter->Next()) {\n        std::string s = IterStatus(iter);\n        result.push_back('(');\n        result.append(s);\n        result.push_back(')');\n        forward.push_back(s);\n      }\n  \n      // Check reverse iteration results are the reverse of forward results\n      size_t matched = 0;\n      for (iter->SeekToLast(); iter->Valid(); iter->Prev()) {\n        ASSERT_LT(matched, forward.size());\n        ASSERT_EQ(IterStatus(iter), forward[forward.size() - matched - 1]);\n        matched++;\n      }\n      ASSERT_EQ(matched, forward.size());\n  \n      delete iter;\n      return result;\n    }\n}"
  },
  {
    "function_name": "Get",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "296-307",
    "snippet": "std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n    ReadOptions options;\n    options.snapshot = snapshot;\n    std::string result;\n    Status s = db_->Get(options, k, &result);\n    if (s.IsNotFound()) {\n      result = \"NOT_FOUND\";\n    } else if (!s.ok()) {\n      result = s.ToString();\n    }\n    return result;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s.ToString",
          "args": [],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CUnsignedSyncCheckpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/checkpoints.h",
          "lines": "89-98",
          "snippet": "std::string ToString() const\n    {\n        return strprintf(\n                \"CSyncCheckpoint(\\n\"\n                \"    nVersion       = %d\\n\"\n                \"    hashCheckpoint = %s\\n\"\n                \")\\n\",\n            nVersion,\n            hashCheckpoint.ToString().c_str());\n    }",
          "includes": [
            "#include \"util.h\"",
            "#include \"net.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"net.h\"\n#include <map>\n\nCUnsignedSyncCheckpoint {\n  std::string ToString() const\n      {\n          return strprintf(\n                  \"CSyncCheckpoint(\\n\"\n                  \"    nVersion       = %d\\n\"\n                  \"    hashCheckpoint = %s\\n\"\n                  \")\\n\",\n              nVersion,\n              hashCheckpoint.ToString().c_str());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.IsNotFound",
          "args": [],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "IsNotFound",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "55-55",
          "snippet": "bool IsNotFound() const { return code() == kNotFound; }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool IsNotFound() const { return code() == kNotFound; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "db_->Get",
          "args": [
            "options",
            "k",
            "&result"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1846-1850",
          "snippet": "virtual Status Get(const ReadOptions& options,\n                     const Slice& key, std::string* value) {\n    assert(false);      // Not implemented\n    return Status::NotFound(key);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Get(const ReadOptions& options,\n                       const Slice& key, std::string* value) {\n      assert(false);      // Not implemented\n      return Status::NotFound(key);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  std::string Get(const std::string& k, const Snapshot* snapshot = NULL) {\n      ReadOptions options;\n      options.snapshot = snapshot;\n      std::string result;\n      Status s = db_->Get(options, k, &result);\n      if (s.IsNotFound()) {\n        result = \"NOT_FOUND\";\n      } else if (!s.ok()) {\n        result = s.ToString();\n      }\n      return result;\n    }\n}"
  },
  {
    "function_name": "Delete",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "292-294",
    "snippet": "Status Delete(const std::string& k) {\n    return db_->Delete(WriteOptions(), k);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db_->Delete",
          "args": [
            "WriteOptions()",
            "k"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1843-1845",
          "snippet": "virtual Status Delete(const WriteOptions& o, const Slice& key) {\n    return DB::Delete(o, key);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Delete(const WriteOptions& o, const Slice& key) {\n      return DB::Delete(o, key);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WriteOptions",
          "args": [],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "WriteOptions",
          "container": "WriteOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "188-190",
          "snippet": "WriteOptions()\n      : sync(false) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nWriteOptions {\n  WriteOptions()\n        : sync(false) {\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Delete(const std::string& k) {\n      return db_->Delete(WriteOptions(), k);\n    }\n}"
  },
  {
    "function_name": "Put",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "288-290",
    "snippet": "Status Put(const std::string& k, const std::string& v) {\n    return db_->Put(WriteOptions(), k, v);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "db_->Put",
          "args": [
            "WriteOptions()",
            "k",
            "v"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "ModelDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "1840-1842",
          "snippet": "virtual Status Put(const WriteOptions& o, const Slice& k, const Slice& v) {\n    return DB::Put(o, k, v);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nModelDB {\n  virtual Status Put(const WriteOptions& o, const Slice& k, const Slice& v) {\n      return DB::Put(o, k, v);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WriteOptions",
          "args": [],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "WriteOptions",
          "container": "WriteOptions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/options.h",
          "lines": "188-190",
          "snippet": "WriteOptions()\n      : sync(false) {\n  }",
          "includes": [
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stddef.h>\n\nWriteOptions {\n  WriteOptions()\n        : sync(false) {\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status Put(const std::string& k, const std::string& v) {\n      return db_->Put(WriteOptions(), k, v);\n    }\n}"
  },
  {
    "function_name": "TryReopen",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "273-286",
    "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DB::Open",
          "args": [
            "opts",
            "dbname_",
            "&db_"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "Open",
          "container": "DB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1445-1477",
          "snippet": "Status DB::Open(const Options& options, const std::string& dbname,\n                DB** dbptr) {\n  *dbptr = NULL;\n\n  DBImpl* impl = new DBImpl(options, dbname);\n  impl->mutex_.Lock();\n  VersionEdit edit;\n  Status s = impl->Recover(&edit); // Handles create_if_missing, error_if_exists\n  if (s.ok()) {\n    uint64_t new_log_number = impl->versions_->NewFileNumber();\n    WritableFile* lfile;\n    s = options.env->NewWritableFile(LogFileName(dbname, new_log_number),\n                                     &lfile);\n    if (s.ok()) {\n      edit.SetLogNumber(new_log_number);\n      impl->logfile_ = lfile;\n      impl->logfile_number_ = new_log_number;\n      impl->log_ = new log::Writer(lfile);\n      s = impl->versions_->LogAndApply(&edit, &impl->mutex_);\n    }\n    if (s.ok()) {\n      impl->DeleteObsoleteFiles();\n      impl->MaybeScheduleCompaction();\n    }\n  }\n  impl->mutex_.Unlock();\n  if (s.ok()) {\n    *dbptr = impl;\n  } else {\n    delete impl;\n  }\n  return s;\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nDB {\n  Status DB::Open(const Options& options, const std::string& dbname,\n                  DB** dbptr) {\n    *dbptr = NULL;\n  \n    DBImpl* impl = new DBImpl(options, dbname);\n    impl->mutex_.Lock();\n    VersionEdit edit;\n    Status s = impl->Recover(&edit); // Handles create_if_missing, error_if_exists\n    if (s.ok()) {\n      uint64_t new_log_number = impl->versions_->NewFileNumber();\n      WritableFile* lfile;\n      s = options.env->NewWritableFile(LogFileName(dbname, new_log_number),\n                                       &lfile);\n      if (s.ok()) {\n        edit.SetLogNumber(new_log_number);\n        impl->logfile_ = lfile;\n        impl->logfile_number_ = new_log_number;\n        impl->log_ = new log::Writer(lfile);\n        s = impl->versions_->LogAndApply(&edit, &impl->mutex_);\n      }\n      if (s.ok()) {\n        impl->DeleteObsoleteFiles();\n        impl->MaybeScheduleCompaction();\n      }\n    }\n    impl->mutex_.Unlock();\n    if (s.ok()) {\n      *dbptr = impl;\n    } else {\n      delete impl;\n    }\n    return s;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CurrentOptions",
          "args": [],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
  },
  {
    "function_name": "DestroyAndReopen",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "266-271",
    "snippet": "void DestroyAndReopen(Options* options = NULL) {\n    delete db_;\n    db_ = NULL;\n    DestroyDB(dbname_, Options());\n    ASSERT_OK(TryReopen(options));\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "TryReopen(options)"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TryReopen",
          "args": [
            "options"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DestroyDB",
          "args": [
            "dbname_",
            "Options()"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyDB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1482-1511",
          "snippet": "Status DestroyDB(const std::string& dbname, const Options& options) {\n  Env* env = options.env;\n  std::vector<std::string> filenames;\n  // Ignore error in case directory does not exist\n  env->GetChildren(dbname, &filenames);\n  if (filenames.empty()) {\n    return Status::OK();\n  }\n\n  FileLock* lock;\n  const std::string lockname = LockFileName(dbname);\n  Status result = env->LockFile(lockname, &lock);\n  if (result.ok()) {\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) &&\n          type != kDBLockFile) {  // Lock file will be deleted at end\n        Status del = env->DeleteFile(dbname + \"/\" + filenames[i]);\n        if (result.ok() && !del.ok()) {\n          result = del;\n        }\n      }\n    }\n    env->UnlockFile(lock);  // Ignore error since state is already gone\n    env->DeleteFile(lockname);\n    env->DeleteDir(dbname);  // Ignore error in case dir contains other files\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nStatus DestroyDB(const std::string& dbname, const Options& options) {\n  Env* env = options.env;\n  std::vector<std::string> filenames;\n  // Ignore error in case directory does not exist\n  env->GetChildren(dbname, &filenames);\n  if (filenames.empty()) {\n    return Status::OK();\n  }\n\n  FileLock* lock;\n  const std::string lockname = LockFileName(dbname);\n  Status result = env->LockFile(lockname, &lock);\n  if (result.ok()) {\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) &&\n          type != kDBLockFile) {  // Lock file will be deleted at end\n        Status del = env->DeleteFile(dbname + \"/\" + filenames[i]);\n        if (result.ok() && !del.ok()) {\n          result = del;\n        }\n      }\n    }\n    env->UnlockFile(lock);  // Ignore error since state is already gone\n    env->DeleteFile(lockname);\n    env->DeleteDir(dbname);  // Ignore error in case dir contains other files\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Options",
          "args": [],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void DestroyAndReopen(Options* options = NULL) {\n      delete db_;\n      db_ = NULL;\n      DestroyDB(dbname_, Options());\n      ASSERT_OK(TryReopen(options));\n    }\n}"
  },
  {
    "function_name": "Close",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "261-264",
    "snippet": "void Close() {\n    delete db_;\n    db_ = NULL;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void Close() {\n      delete db_;\n      db_ = NULL;\n    }\n}"
  },
  {
    "function_name": "Reopen",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "257-259",
    "snippet": "void Reopen(Options* options = NULL) {\n    ASSERT_OK(TryReopen(options));\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_OK",
          "args": [
            "TryReopen(options)"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TryReopen",
          "args": [
            "options"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "TryReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "273-286",
          "snippet": "Status TryReopen(Options* options) {\n    delete db_;\n    db_ = NULL;\n    Options opts;\n    if (options != NULL) {\n      opts = *options;\n    } else {\n      opts = CurrentOptions();\n      opts.create_if_missing = true;\n    }\n    last_options_ = opts;\n\n    return DB::Open(opts, dbname_, &db_);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Status TryReopen(Options* options) {\n      delete db_;\n      db_ = NULL;\n      Options opts;\n      if (options != NULL) {\n        opts = *options;\n      } else {\n        opts = CurrentOptions();\n        opts.create_if_missing = true;\n      }\n      last_options_ = opts;\n  \n      return DB::Open(opts, dbname_, &db_);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void Reopen(Options* options = NULL) {\n      ASSERT_OK(TryReopen(options));\n    }\n}"
  },
  {
    "function_name": "CurrentOptions",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "238-251",
    "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
  },
  {
    "function_name": "ChangeOptions",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "227-235",
    "snippet": "bool ChangeOptions() {\n    option_config_++;\n    if (option_config_ >= kEnd) {\n      return false;\n    } else {\n      DestroyAndReopen();\n      return true;\n    }\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DestroyAndReopen",
          "args": [],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyAndReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "266-271",
          "snippet": "void DestroyAndReopen(Options* options = NULL) {\n    delete db_;\n    db_ = NULL;\n    DestroyDB(dbname_, Options());\n    ASSERT_OK(TryReopen(options));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void DestroyAndReopen(Options* options = NULL) {\n      delete db_;\n      db_ = NULL;\n      DestroyDB(dbname_, Options());\n      ASSERT_OK(TryReopen(options));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  bool ChangeOptions() {\n      option_config_++;\n      if (option_config_ >= kEnd) {\n        return false;\n      } else {\n        DestroyAndReopen();\n        return true;\n      }\n    }\n}"
  },
  {
    "function_name": "DBTest",
    "container": "DBTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "209-216",
    "snippet": "DBTest() : option_config_(kDefault),\n             env_(new SpecialEnv(Env::Default())) {\n    filter_policy_ = NewBloomFilterPolicy(10);\n    dbname_ = test::TmpDir() + \"/db_test\";\n    DestroyDB(dbname_, Options());\n    db_ = NULL;\n    Reopen();\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Reopen",
          "args": [],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyAndReopen",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "266-271",
          "snippet": "void DestroyAndReopen(Options* options = NULL) {\n    delete db_;\n    db_ = NULL;\n    DestroyDB(dbname_, Options());\n    ASSERT_OK(TryReopen(options));\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void DestroyAndReopen(Options* options = NULL) {\n      delete db_;\n      db_ = NULL;\n      DestroyDB(dbname_, Options());\n      ASSERT_OK(TryReopen(options));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DestroyDB",
          "args": [
            "dbname_",
            "Options()"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "DestroyDB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_impl.cc",
          "lines": "1482-1511",
          "snippet": "Status DestroyDB(const std::string& dbname, const Options& options) {\n  Env* env = options.env;\n  std::vector<std::string> filenames;\n  // Ignore error in case directory does not exist\n  env->GetChildren(dbname, &filenames);\n  if (filenames.empty()) {\n    return Status::OK();\n  }\n\n  FileLock* lock;\n  const std::string lockname = LockFileName(dbname);\n  Status result = env->LockFile(lockname, &lock);\n  if (result.ok()) {\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) &&\n          type != kDBLockFile) {  // Lock file will be deleted at end\n        Status del = env->DeleteFile(dbname + \"/\" + filenames[i]);\n        if (result.ok() && !del.ok()) {\n          result = del;\n        }\n      }\n    }\n    env->UnlockFile(lock);  // Ignore error since state is already gone\n    env->DeleteFile(lockname);\n    env->DeleteDir(dbname);  // Ignore error in case dir contains other files\n  }\n  return result;\n}",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"table/two_level_iterator.h\"",
            "#include \"table/merger.h\"",
            "#include \"table/block.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/table_cache.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/db_iter.h\"",
            "#include \"db/builder.h\"",
            "#include <vector>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <string>",
            "#include <set>",
            "#include <algorithm>",
            "#include \"db/db_impl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"table/two_level_iterator.h\"\n#include \"table/merger.h\"\n#include \"table/block.h\"\n#include \"port/port.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/table_cache.h\"\n#include \"db/memtable.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include \"db/db_iter.h\"\n#include \"db/builder.h\"\n#include <vector>\n#include <stdio.h>\n#include <stdint.h>\n#include <string>\n#include <set>\n#include <algorithm>\n#include \"db/db_impl.h\"\n\nStatus DestroyDB(const std::string& dbname, const Options& options) {\n  Env* env = options.env;\n  std::vector<std::string> filenames;\n  // Ignore error in case directory does not exist\n  env->GetChildren(dbname, &filenames);\n  if (filenames.empty()) {\n    return Status::OK();\n  }\n\n  FileLock* lock;\n  const std::string lockname = LockFileName(dbname);\n  Status result = env->LockFile(lockname, &lock);\n  if (result.ok()) {\n    uint64_t number;\n    FileType type;\n    for (size_t i = 0; i < filenames.size(); i++) {\n      if (ParseFileName(filenames[i], &number, &type) &&\n          type != kDBLockFile) {  // Lock file will be deleted at end\n        Status del = env->DeleteFile(dbname + \"/\" + filenames[i]);\n        if (result.ok() && !del.ok()) {\n          result = del;\n        }\n      }\n    }\n    env->UnlockFile(lock);  // Ignore error since state is already gone\n    env->DeleteFile(lockname);\n    env->DeleteDir(dbname);  // Ignore error in case dir contains other files\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Options",
          "args": [],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentOptions",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "238-251",
          "snippet": "Options CurrentOptions() {\n    Options options;\n    switch (option_config_) {\n      case kFilter:\n        options.filter_policy = filter_policy_;\n        break;\n      case kUncompressed:\n        options.compression = kNoCompression;\n        break;\n      default:\n        break;\n    }\n    return options;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  Options CurrentOptions() {\n      Options options;\n      switch (option_config_) {\n        case kFilter:\n          options.filter_policy = filter_policy_;\n          break;\n        case kUncompressed:\n          options.compression = kNoCompression;\n          break;\n        default:\n          break;\n      }\n      return options;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "test::TmpDir",
          "args": [],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "TmpDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "60-65",
          "snippet": "std::string TmpDir() {\n  std::string dir;\n  Status s = Env::Default()->GetTestDirectory(&dir);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  return dir;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nstd::string TmpDir() {\n  std::string dir;\n  Status s = Env::Default()->GetTestDirectory(&dir);\n  ASSERT_TRUE(s.ok()) << s.ToString();\n  return dir;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NewBloomFilterPolicy",
          "args": [
            "10"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  DBTest() : option_config_(kDefault),\n               env_(new SpecialEnv(Env::Default())) {\n      filter_policy_ = NewBloomFilterPolicy(10);\n      dbname_ = test::TmpDir() + \"/db_test\";\n      DestroyDB(dbname_, Options());\n      db_ = NULL;\n      Reopen();\n    }\n}"
  },
  {
    "function_name": "NewRandomAccessFile",
    "container": "SpecialEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "164-186",
    "snippet": "Status NewRandomAccessFile(const std::string& f, RandomAccessFile** r) {\n    class CountingFile : public RandomAccessFile {\n     private:\n      RandomAccessFile* target_;\n      AtomicCounter* counter_;\n     public:\n      CountingFile(RandomAccessFile* target, AtomicCounter* counter)\n          : target_(target), counter_(counter) {\n      }\n      virtual ~CountingFile() { delete target_; }\n      virtual Status Read(uint64_t offset, size_t n, Slice* result,\n                          char* scratch) const {\n        counter_->Increment();\n        return target_->Read(offset, n, result, scratch);\n      }\n    };\n\n    Status s = target()->NewRandomAccessFile(f, r);\n    if (s.ok() && count_random_reads_) {\n      *r = new CountingFile(*r, &random_read_counter_);\n    }\n    return s;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "target",
          "args": [
            "f",
            "r"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "target",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "target_->Read",
          "args": [
            "offset",
            "n",
            "result",
            "scratch"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "Read",
          "container": "Win32RandomAccessFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "404-417",
          "snippet": "Status Win32RandomAccessFile::Read(uint64_t offset,size_t n,Slice* result,char* scratch) const\n{\n    Status sRet;\n    OVERLAPPED ol = {0};\n    ZeroMemory(&ol,sizeof(ol));\n    ol.Offset = (DWORD)offset;\n    ol.OffsetHigh = (DWORD)(offset >> 32);\n    DWORD hasRead = 0;\n    if(!ReadFile(_hFile,scratch,n,&hasRead,&ol))\n        sRet = Status::IOError(_filename,Win32::GetLastErrSz());\n    else\n        *result = Slice(scratch,hasRead);\n    return sRet;\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32RandomAccessFile {\n  Status Win32RandomAccessFile::Read(uint64_t offset,size_t n,Slice* result,char* scratch) const\n  {\n      Status sRet;\n      OVERLAPPED ol = {0};\n      ZeroMemory(&ol,sizeof(ol));\n      ol.Offset = (DWORD)offset;\n      ol.OffsetHigh = (DWORD)(offset >> 32);\n      DWORD hasRead = 0;\n      if(!ReadFile(_hFile,scratch,n,&hasRead,&ol))\n          sRet = Status::IOError(_filename,Win32::GetLastErrSz());\n      else\n          *result = Slice(scratch,hasRead);\n      return sRet;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "counter_->Increment",
          "args": [],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "Increment",
          "container": "AtomicCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "35-37",
          "snippet": "void Increment() {\n    IncrementBy(1);\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nAtomicCounter {\n  void Increment() {\n      IncrementBy(1);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nSpecialEnv {\n  Status NewRandomAccessFile(const std::string& f, RandomAccessFile** r) {\n      class CountingFile : public RandomAccessFile {\n       private:\n        RandomAccessFile* target_;\n        AtomicCounter* counter_;\n       public:\n        CountingFile(RandomAccessFile* target, AtomicCounter* counter)\n            : target_(target), counter_(counter) {\n        }\n        virtual ~CountingFile() { delete target_; }\n        virtual Status Read(uint64_t offset, size_t n, Slice* result,\n                            char* scratch) const {\n          counter_->Increment();\n          return target_->Read(offset, n, result, scratch);\n        }\n      };\n  \n      Status s = target()->NewRandomAccessFile(f, r);\n      if (s.ok() && count_random_reads_) {\n        *r = new CountingFile(*r, &random_read_counter_);\n      }\n      return s;\n    }\n}"
  },
  {
    "function_name": "NewWritableFile",
    "container": "SpecialEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "91-162",
    "snippet": "Status NewWritableFile(const std::string& f, WritableFile** r) {\n    class DataFile : public WritableFile {\n     private:\n      SpecialEnv* env_;\n      WritableFile* base_;\n\n     public:\n      DataFile(SpecialEnv* env, WritableFile* base)\n          : env_(env),\n            base_(base) {\n      }\n      ~DataFile() { delete base_; }\n      Status Append(const Slice& data) {\n        if (env_->no_space_.Acquire_Load() != NULL) {\n          // Drop writes on the floor\n          return Status::OK();\n        } else {\n          return base_->Append(data);\n        }\n      }\n      Status Close() { return base_->Close(); }\n      Status Flush() { return base_->Flush(); }\n      Status Sync() {\n        if (env_->data_sync_error_.Acquire_Load() != NULL) {\n          return Status::IOError(\"simulated data sync error\");\n        }\n        while (env_->delay_data_sync_.Acquire_Load() != NULL) {\n          DelayMilliseconds(100);\n        }\n        return base_->Sync();\n      }\n    };\n    class ManifestFile : public WritableFile {\n     private:\n      SpecialEnv* env_;\n      WritableFile* base_;\n     public:\n      ManifestFile(SpecialEnv* env, WritableFile* b) : env_(env), base_(b) { }\n      ~ManifestFile() { delete base_; }\n      Status Append(const Slice& data) {\n        if (env_->manifest_write_error_.Acquire_Load() != NULL) {\n          return Status::IOError(\"simulated writer error\");\n        } else {\n          return base_->Append(data);\n        }\n      }\n      Status Close() { return base_->Close(); }\n      Status Flush() { return base_->Flush(); }\n      Status Sync() {\n        if (env_->manifest_sync_error_.Acquire_Load() != NULL) {\n          return Status::IOError(\"simulated sync error\");\n        } else {\n          return base_->Sync();\n        }\n      }\n    };\n\n    if (non_writable_.Acquire_Load() != NULL) {\n      return Status::IOError(\"simulated write error\");\n    }\n\n    Status s = target()->NewWritableFile(f, r);\n    if (s.ok()) {\n      if (strstr(f.c_str(), \".ldb\") != NULL ||\n          strstr(f.c_str(), \".log\") != NULL) {\n        *r = new DataFile(this, *r);\n      } else if (strstr(f.c_str(), \"MANIFEST\") != NULL) {\n        *r = new ManifestFile(this, *r);\n      }\n    }\n    return s;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "f.c_str()",
            "\"MANIFEST\""
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f.c_str",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "f.c_str()",
            "\".log\""
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f.c_str",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "f.c_str()",
            "\".ldb\""
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f.c_str",
          "args": [],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "target",
          "args": [
            "f",
            "r"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "target",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "\"simulated write error\""
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "47-49",
          "snippet": "static Status IOError(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kIOError, msg, msg2);\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status IOError(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kIOError, msg, msg2);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "non_writable_.Acquire_Load",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "base_->Sync",
          "args": [],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "Sync",
          "container": "LogTest::StringDest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "47-47",
          "snippet": "virtual Status Sync() { return Status::OK(); }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  StringDest {\n    virtual Status Sync() { return Status::OK(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "env_->manifest_sync_error_.Acquire_Load",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "base_->Flush",
          "args": [],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "Flush",
          "container": "LogTest::StringDest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "46-46",
          "snippet": "virtual Status Flush() { return Status::OK(); }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  StringDest {\n    virtual Status Flush() { return Status::OK(); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "base_->Close",
          "args": [],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "Close",
          "container": "DBTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "261-264",
          "snippet": "void Close() {\n    delete db_;\n    db_ = NULL;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nDBTest {\n  void Close() {\n      delete db_;\n      db_ = NULL;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "base_->Append",
          "args": [
            "data"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "Append",
          "container": "LogTest::StringDest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/log_test.cc",
          "lines": "48-51",
          "snippet": "virtual Status Append(const Slice& slice) {\n      contents_.append(slice.data(), slice.size());\n      return Status::OK();\n    }",
          "includes": [
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"util/crc32c.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/log_writer.h\"",
            "#include \"db/log_reader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"util/crc32c.h\"\n#include \"util/coding.h\"\n#include \"leveldb/env.h\"\n#include \"db/log_writer.h\"\n#include \"db/log_reader.h\"\n\nLogTest {\n  StringDest {\n    virtual Status Append(const Slice& slice) {\n          contents_.append(slice.data(), slice.size());\n          return Status::OK();\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "env_->manifest_write_error_.Acquire_Load",
          "args": [],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DelayMilliseconds",
          "args": [
            "100"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "DelayMilliseconds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "52-54",
          "snippet": "void DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nvoid DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}"
        }
      },
      {
        "call_info": {
          "callee": "env_->delay_data_sync_.Acquire_Load",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "env_->data_sync_error_.Acquire_Load",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "env_->no_space_.Acquire_Load",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nSpecialEnv {\n  Status NewWritableFile(const std::string& f, WritableFile** r) {\n      class DataFile : public WritableFile {\n       private:\n        SpecialEnv* env_;\n        WritableFile* base_;\n  \n       public:\n        DataFile(SpecialEnv* env, WritableFile* base)\n            : env_(env),\n              base_(base) {\n        }\n        ~DataFile() { delete base_; }\n        Status Append(const Slice& data) {\n          if (env_->no_space_.Acquire_Load() != NULL) {\n            // Drop writes on the floor\n            return Status::OK();\n          } else {\n            return base_->Append(data);\n          }\n        }\n        Status Close() { return base_->Close(); }\n        Status Flush() { return base_->Flush(); }\n        Status Sync() {\n          if (env_->data_sync_error_.Acquire_Load() != NULL) {\n            return Status::IOError(\"simulated data sync error\");\n          }\n          while (env_->delay_data_sync_.Acquire_Load() != NULL) {\n            DelayMilliseconds(100);\n          }\n          return base_->Sync();\n        }\n      };\n      class ManifestFile : public WritableFile {\n       private:\n        SpecialEnv* env_;\n        WritableFile* base_;\n       public:\n        ManifestFile(SpecialEnv* env, WritableFile* b) : env_(env), base_(b) { }\n        ~ManifestFile() { delete base_; }\n        Status Append(const Slice& data) {\n          if (env_->manifest_write_error_.Acquire_Load() != NULL) {\n            return Status::IOError(\"simulated writer error\");\n          } else {\n            return base_->Append(data);\n          }\n        }\n        Status Close() { return base_->Close(); }\n        Status Flush() { return base_->Flush(); }\n        Status Sync() {\n          if (env_->manifest_sync_error_.Acquire_Load() != NULL) {\n            return Status::IOError(\"simulated sync error\");\n          } else {\n            return base_->Sync();\n          }\n        }\n      };\n  \n      if (non_writable_.Acquire_Load() != NULL) {\n        return Status::IOError(\"simulated write error\");\n      }\n  \n      Status s = target()->NewWritableFile(f, r);\n      if (s.ok()) {\n        if (strstr(f.c_str(), \".ldb\") != NULL ||\n            strstr(f.c_str(), \".log\") != NULL) {\n          *r = new DataFile(this, *r);\n        } else if (strstr(f.c_str(), \"MANIFEST\") != NULL) {\n          *r = new ManifestFile(this, *r);\n        }\n      }\n      return s;\n    }\n}"
  },
  {
    "function_name": "SpecialEnv",
    "container": "SpecialEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "81-89",
    "snippet": "explicit SpecialEnv(Env* base) : EnvWrapper(base) {\n    delay_data_sync_.Release_Store(NULL);\n    data_sync_error_.Release_Store(NULL);\n    no_space_.Release_Store(NULL);\n    non_writable_.Release_Store(NULL);\n    count_random_reads_ = false;\n    manifest_sync_error_.Release_Store(NULL);\n    manifest_write_error_.Release_Store(NULL);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "manifest_write_error_.Release_Store",
          "args": [
            "NULL"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nSpecialEnv {\n  explicit SpecialEnv(Env* base) : EnvWrapper(base) {\n      delay_data_sync_.Release_Store(NULL);\n      data_sync_error_.Release_Store(NULL);\n      no_space_.Release_Store(NULL);\n      non_writable_.Release_Store(NULL);\n      count_random_reads_ = false;\n      manifest_sync_error_.Release_Store(NULL);\n      manifest_write_error_.Release_Store(NULL);\n    }\n}"
  },
  {
    "function_name": "DelayMilliseconds",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "52-54",
    "snippet": "void DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [
            "millis * 1000"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nvoid DelayMilliseconds(int millis) {\n  Env::Default()->SleepForMicroseconds(millis * 1000);\n}"
  },
  {
    "function_name": "Reset",
    "container": "AtomicCounter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "46-49",
    "snippet": "void Reset() {\n    MutexLock l(&mu_);\n    count_ = 0;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nAtomicCounter {\n  void Reset() {\n      MutexLock l(&mu_);\n      count_ = 0;\n    }\n}"
  },
  {
    "function_name": "Read",
    "container": "AtomicCounter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "42-45",
    "snippet": "int Read() {\n    MutexLock l(&mu_);\n    return count_;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nAtomicCounter {\n  int Read() {\n      MutexLock l(&mu_);\n      return count_;\n    }\n}"
  },
  {
    "function_name": "IncrementBy",
    "container": "AtomicCounter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "38-41",
    "snippet": "void IncrementBy(int count) {\n    MutexLock l(&mu_);\n    count_ += count;\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nAtomicCounter {\n  void IncrementBy(int count) {\n      MutexLock l(&mu_);\n      count_ += count;\n    }\n}"
  },
  {
    "function_name": "Increment",
    "container": "AtomicCounter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "35-37",
    "snippet": "void Increment() {\n    IncrementBy(1);\n  }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IncrementBy",
          "args": [
            "1"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "IncrementBy",
          "container": "AtomicCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
          "lines": "38-41",
          "snippet": "void IncrementBy(int count) {\n    MutexLock l(&mu_);\n    count_ += count;\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"util/hash.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/cache.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_set.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/db_impl.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nAtomicCounter {\n  void IncrementBy(int count) {\n      MutexLock l(&mu_);\n      count_ += count;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nAtomicCounter {\n  void Increment() {\n      IncrementBy(1);\n    }\n}"
  },
  {
    "function_name": "AtomicCounter",
    "container": "AtomicCounter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "34-34",
    "snippet": "AtomicCounter() : count_(0) { }",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nAtomicCounter {\n  AtomicCounter() : count_(0) { }\n}"
  },
  {
    "function_name": "RandomString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/db_test.cc",
    "lines": "22-26",
    "snippet": "static std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}",
    "includes": [
      "#include \"util/testutil.h\"",
      "#include \"util/testharness.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"util/hash.h\"",
      "#include \"leveldb/table.h\"",
      "#include \"leveldb/env.h\"",
      "#include \"leveldb/cache.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/version_set.h\"",
      "#include \"db/filename.h\"",
      "#include \"db/db_impl.h\"",
      "#include \"leveldb/filter_policy.h\"",
      "#include \"leveldb/db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test::RandomString",
          "args": [
            "rnd",
            "len",
            "&r"
          ],
          "line": 24
        },
        "resolved": true,
        "details": {
          "function_name": "RandomString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testutil.cc",
          "lines": "12-18",
          "snippet": "Slice RandomString(Random* rnd, int len, std::string* dst) {\n  dst->resize(len);\n  for (int i = 0; i < len; i++) {\n    (*dst)[i] = static_cast<char>(' ' + rnd->Uniform(95));   // ' ' .. '~'\n  }\n  return Slice(*dst);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"util/hash.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/cache.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_set.h\"\n#include \"db/filename.h\"\n#include \"db/db_impl.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n\nstatic std::string RandomString(Random* rnd, int len) {\n  std::string r;\n  test::RandomString(rnd, len, &r);\n  return r;\n}"
  }
]