[
  {
    "function_name": "LookupKey",
    "container": "LookupKey",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
    "lines": "121-138",
    "snippet": "LookupKey::LookupKey(const Slice& user_key, SequenceNumber s) {\n  size_t usize = user_key.size();\n  size_t needed = usize + 13;  // A conservative estimate\n  char* dst;\n  if (needed <= sizeof(space_)) {\n    dst = space_;\n  } else {\n    dst = new char[needed];\n  }\n  start_ = dst;\n  dst = EncodeVarint32(dst, usize + 8);\n  kstart_ = dst;\n  memcpy(dst, user_key.data(), usize);\n  dst += usize;\n  EncodeFixed64(dst, PackSequenceAndType(s, kValueTypeForSeek));\n  dst += 8;\n  end_ = dst;\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"port/port.h\"",
      "#include \"db/dbformat.h\"",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EncodeFixed64",
          "args": [
            "dst",
            "PackSequenceAndType(s, kValueTypeForSeek)"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeFixed64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "20-33",
          "snippet": "void EncodeFixed64(char* buf, uint64_t value) {\n  if (port::kLittleEndian) {\n    memcpy(buf, &value, sizeof(value));\n  } else {\n    buf[0] = value & 0xff;\n    buf[1] = (value >> 8) & 0xff;\n    buf[2] = (value >> 16) & 0xff;\n    buf[3] = (value >> 24) & 0xff;\n    buf[4] = (value >> 32) & 0xff;\n    buf[5] = (value >> 40) & 0xff;\n    buf[6] = (value >> 48) & 0xff;\n    buf[7] = (value >> 56) & 0xff;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid EncodeFixed64(char* buf, uint64_t value) {\n  if (port::kLittleEndian) {\n    memcpy(buf, &value, sizeof(value));\n  } else {\n    buf[0] = value & 0xff;\n    buf[1] = (value >> 8) & 0xff;\n    buf[2] = (value >> 16) & 0xff;\n    buf[3] = (value >> 24) & 0xff;\n    buf[4] = (value >> 32) & 0xff;\n    buf[5] = (value >> 40) & 0xff;\n    buf[6] = (value >> 48) & 0xff;\n    buf[7] = (value >> 56) & 0xff;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "PackSequenceAndType",
          "args": [
            "s",
            "kValueTypeForSeek"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "PackSequenceAndType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "12-16",
          "snippet": "static uint64_t PackSequenceAndType(uint64_t seq, ValueType t) {\n  assert(seq <= kMaxSequenceNumber);\n  assert(t <= kValueTypeForSeek);\n  return (seq << 8) | t;\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"port/port.h\"",
            "#include \"db/dbformat.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nstatic uint64_t PackSequenceAndType(uint64_t seq, ValueType t) {\n  assert(seq <= kMaxSequenceNumber);\n  assert(t <= kValueTypeForSeek);\n  return (seq << 8) | t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst",
            "user_key.data()",
            "usize"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "user_key.data",
          "args": [],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EncodeVarint32",
          "args": [
            "dst",
            "usize + 8"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "user_key.size",
          "args": [],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nLookupKey {\n  LookupKey::LookupKey(const Slice& user_key, SequenceNumber s) {\n    size_t usize = user_key.size();\n    size_t needed = usize + 13;  // A conservative estimate\n    char* dst;\n    if (needed <= sizeof(space_)) {\n      dst = space_;\n    } else {\n      dst = new char[needed];\n    }\n    start_ = dst;\n    dst = EncodeVarint32(dst, usize + 8);\n    kstart_ = dst;\n    memcpy(dst, user_key.data(), usize);\n    dst += usize;\n    EncodeFixed64(dst, PackSequenceAndType(s, kValueTypeForSeek));\n    dst += 8;\n    end_ = dst;\n  }\n}"
  },
  {
    "function_name": "KeyMayMatch",
    "container": "InternalFilterPolicy",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
    "lines": "117-119",
    "snippet": "bool InternalFilterPolicy::KeyMayMatch(const Slice& key, const Slice& f) const {\n  return user_policy_->KeyMayMatch(ExtractUserKey(key), f);\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"port/port.h\"",
      "#include \"db/dbformat.h\"",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "user_policy_->KeyMayMatch",
          "args": [
            "ExtractUserKey(key)",
            "f"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "KeyMayMatch",
          "container": "InternalFilterPolicy",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "117-119",
          "snippet": "bool InternalFilterPolicy::KeyMayMatch(const Slice& key, const Slice& f) const {\n  return user_policy_->KeyMayMatch(ExtractUserKey(key), f);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ExtractUserKey",
          "args": [
            "key"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "ExtractUserKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "98-101",
          "snippet": "inline Slice ExtractUserKey(const Slice& internal_key) {\n  assert(internal_key.size() >= 8);\n  return Slice(internal_key.data(), internal_key.size() - 8);\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\ninline Slice ExtractUserKey(const Slice& internal_key) {\n  assert(internal_key.size() >= 8);\n  return Slice(internal_key.data(), internal_key.size() - 8);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nInternalFilterPolicy {\n  bool InternalFilterPolicy::KeyMayMatch(const Slice& key, const Slice& f) const {\n    return user_policy_->KeyMayMatch(ExtractUserKey(key), f);\n  }\n}"
  },
  {
    "function_name": "CreateFilter",
    "container": "InternalFilterPolicy",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
    "lines": "105-115",
    "snippet": "void InternalFilterPolicy::CreateFilter(const Slice* keys, int n,\n                                        std::string* dst) const {\n  // We rely on the fact that the code in table.cc does not mind us\n  // adjusting keys[].\n  Slice* mkey = const_cast<Slice*>(keys);\n  for (int i = 0; i < n; i++) {\n    mkey[i] = ExtractUserKey(keys[i]);\n    // TODO(sanjay): Suppress dups?\n  }\n  user_policy_->CreateFilter(keys, n, dst);\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"port/port.h\"",
      "#include \"db/dbformat.h\"",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "user_policy_->CreateFilter",
          "args": [
            "keys",
            "n",
            "dst"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "CreateFilter",
          "container": "InternalFilterPolicy",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "105-115",
          "snippet": "void InternalFilterPolicy::CreateFilter(const Slice* keys, int n,\n                                        std::string* dst) const {\n  // We rely on the fact that the code in table.cc does not mind us\n  // adjusting keys[].\n  Slice* mkey = const_cast<Slice*>(keys);\n  for (int i = 0; i < n; i++) {\n    mkey[i] = ExtractUserKey(keys[i]);\n    // TODO(sanjay): Suppress dups?\n  }\n  user_policy_->CreateFilter(keys, n, dst);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ExtractUserKey",
          "args": [
            "keys[i]"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "ExtractUserKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "98-101",
          "snippet": "inline Slice ExtractUserKey(const Slice& internal_key) {\n  assert(internal_key.size() >= 8);\n  return Slice(internal_key.data(), internal_key.size() - 8);\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\ninline Slice ExtractUserKey(const Slice& internal_key) {\n  assert(internal_key.size() >= 8);\n  return Slice(internal_key.data(), internal_key.size() - 8);\n}"
        }
      },
      {
        "call_info": {
          "callee": "const_cast<Slice*>",
          "args": [
            "keys"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nInternalFilterPolicy {\n  void InternalFilterPolicy::CreateFilter(const Slice* keys, int n,\n                                          std::string* dst) const {\n    // We rely on the fact that the code in table.cc does not mind us\n    // adjusting keys[].\n    Slice* mkey = const_cast<Slice*>(keys);\n    for (int i = 0; i < n; i++) {\n      mkey[i] = ExtractUserKey(keys[i]);\n      // TODO(sanjay): Suppress dups?\n    }\n    user_policy_->CreateFilter(keys, n, dst);\n  }\n}"
  },
  {
    "function_name": "FindShortSuccessor",
    "container": "InternalKeyComparator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
    "lines": "87-99",
    "snippet": "void InternalKeyComparator::FindShortSuccessor(std::string* key) const {\n  Slice user_key = ExtractUserKey(*key);\n  std::string tmp(user_key.data(), user_key.size());\n  user_comparator_->FindShortSuccessor(&tmp);\n  if (tmp.size() < user_key.size() &&\n      user_comparator_->Compare(user_key, tmp) < 0) {\n    // User key has become shorter physically, but larger logically.\n    // Tack on the earliest possible number to the shortened user key.\n    PutFixed64(&tmp, PackSequenceAndType(kMaxSequenceNumber,kValueTypeForSeek));\n    assert(this->Compare(*key, tmp) < 0);\n    key->swap(tmp);\n  }\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"port/port.h\"",
      "#include \"db/dbformat.h\"",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "key->swap",
          "args": [
            "tmp"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "this->Compare(*key, tmp) < 0"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->Compare",
          "args": [
            "*key",
            "tmp"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "Compare",
          "container": "InternalKeyComparator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "50-66",
          "snippet": "int InternalKeyComparator::Compare(const Slice& akey, const Slice& bkey) const {\n  // Order by:\n  //    increasing user key (according to user-supplied comparator)\n  //    decreasing sequence number\n  //    decreasing type (though sequence# should be enough to disambiguate)\n  int r = user_comparator_->Compare(ExtractUserKey(akey), ExtractUserKey(bkey));\n  if (r == 0) {\n    const uint64_t anum = DecodeFixed64(akey.data() + akey.size() - 8);\n    const uint64_t bnum = DecodeFixed64(bkey.data() + bkey.size() - 8);\n    if (anum > bnum) {\n      r = -1;\n    } else if (anum < bnum) {\n      r = +1;\n    }\n  }\n  return r;\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"port/port.h\"",
            "#include \"db/dbformat.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nInternalKeyComparator {\n  int InternalKeyComparator::Compare(const Slice& akey, const Slice& bkey) const {\n    // Order by:\n    //    increasing user key (according to user-supplied comparator)\n    //    decreasing sequence number\n    //    decreasing type (though sequence# should be enough to disambiguate)\n    int r = user_comparator_->Compare(ExtractUserKey(akey), ExtractUserKey(bkey));\n    if (r == 0) {\n      const uint64_t anum = DecodeFixed64(akey.data() + akey.size() - 8);\n      const uint64_t bnum = DecodeFixed64(bkey.data() + bkey.size() - 8);\n      if (anum > bnum) {\n        r = -1;\n      } else if (anum < bnum) {\n        r = +1;\n      }\n    }\n    return r;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "PutFixed64",
          "args": [
            "&tmp",
            "PackSequenceAndType(kMaxSequenceNumber,kValueTypeForSeek)"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "PutFixed64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "41-45",
          "snippet": "void PutFixed64(std::string* dst, uint64_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed64(buf, value);\n  dst->append(buf, sizeof(buf));\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutFixed64(std::string* dst, uint64_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed64(buf, value);\n  dst->append(buf, sizeof(buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PackSequenceAndType",
          "args": [
            "kMaxSequenceNumber",
            "kValueTypeForSeek"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "PackSequenceAndType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "12-16",
          "snippet": "static uint64_t PackSequenceAndType(uint64_t seq, ValueType t) {\n  assert(seq <= kMaxSequenceNumber);\n  assert(t <= kValueTypeForSeek);\n  return (seq << 8) | t;\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"port/port.h\"",
            "#include \"db/dbformat.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nstatic uint64_t PackSequenceAndType(uint64_t seq, ValueType t) {\n  assert(seq <= kMaxSequenceNumber);\n  assert(t <= kValueTypeForSeek);\n  return (seq << 8) | t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "user_key.size",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "user_comparator_->FindShortSuccessor",
          "args": [
            "&tmp"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "FindShortSuccessor",
          "container": "InternalKeyComparator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "87-99",
          "snippet": "void InternalKeyComparator::FindShortSuccessor(std::string* key) const {\n  Slice user_key = ExtractUserKey(*key);\n  std::string tmp(user_key.data(), user_key.size());\n  user_comparator_->FindShortSuccessor(&tmp);\n  if (tmp.size() < user_key.size() &&\n      user_comparator_->Compare(user_key, tmp) < 0) {\n    // User key has become shorter physically, but larger logically.\n    // Tack on the earliest possible number to the shortened user key.\n    PutFixed64(&tmp, PackSequenceAndType(kMaxSequenceNumber,kValueTypeForSeek));\n    assert(this->Compare(*key, tmp) < 0);\n    key->swap(tmp);\n  }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "user_key.data",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ExtractUserKey",
          "args": [
            "*key"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "ExtractUserKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "98-101",
          "snippet": "inline Slice ExtractUserKey(const Slice& internal_key) {\n  assert(internal_key.size() >= 8);\n  return Slice(internal_key.data(), internal_key.size() - 8);\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\ninline Slice ExtractUserKey(const Slice& internal_key) {\n  assert(internal_key.size() >= 8);\n  return Slice(internal_key.data(), internal_key.size() - 8);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nInternalKeyComparator {\n  void InternalKeyComparator::FindShortSuccessor(std::string* key) const {\n    Slice user_key = ExtractUserKey(*key);\n    std::string tmp(user_key.data(), user_key.size());\n    user_comparator_->FindShortSuccessor(&tmp);\n    if (tmp.size() < user_key.size() &&\n        user_comparator_->Compare(user_key, tmp) < 0) {\n      // User key has become shorter physically, but larger logically.\n      // Tack on the earliest possible number to the shortened user key.\n      PutFixed64(&tmp, PackSequenceAndType(kMaxSequenceNumber,kValueTypeForSeek));\n      assert(this->Compare(*key, tmp) < 0);\n      key->swap(tmp);\n    }\n  }\n}"
  },
  {
    "function_name": "FindShortestSeparator",
    "container": "InternalKeyComparator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
    "lines": "68-85",
    "snippet": "void InternalKeyComparator::FindShortestSeparator(\n      std::string* start,\n      const Slice& limit) const {\n  // Attempt to shorten the user portion of the key\n  Slice user_start = ExtractUserKey(*start);\n  Slice user_limit = ExtractUserKey(limit);\n  std::string tmp(user_start.data(), user_start.size());\n  user_comparator_->FindShortestSeparator(&tmp, user_limit);\n  if (tmp.size() < user_start.size() &&\n      user_comparator_->Compare(user_start, tmp) < 0) {\n    // User key has become shorter physically, but larger logically.\n    // Tack on the earliest possible number to the shortened user key.\n    PutFixed64(&tmp, PackSequenceAndType(kMaxSequenceNumber,kValueTypeForSeek));\n    assert(this->Compare(*start, tmp) < 0);\n    assert(this->Compare(tmp, limit) < 0);\n    start->swap(tmp);\n  }\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"port/port.h\"",
      "#include \"db/dbformat.h\"",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "start->swap",
          "args": [
            "tmp"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "this->Compare(tmp, limit) < 0"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->Compare",
          "args": [
            "tmp",
            "limit"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "Compare",
          "container": "InternalKeyComparator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "50-66",
          "snippet": "int InternalKeyComparator::Compare(const Slice& akey, const Slice& bkey) const {\n  // Order by:\n  //    increasing user key (according to user-supplied comparator)\n  //    decreasing sequence number\n  //    decreasing type (though sequence# should be enough to disambiguate)\n  int r = user_comparator_->Compare(ExtractUserKey(akey), ExtractUserKey(bkey));\n  if (r == 0) {\n    const uint64_t anum = DecodeFixed64(akey.data() + akey.size() - 8);\n    const uint64_t bnum = DecodeFixed64(bkey.data() + bkey.size() - 8);\n    if (anum > bnum) {\n      r = -1;\n    } else if (anum < bnum) {\n      r = +1;\n    }\n  }\n  return r;\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"port/port.h\"",
            "#include \"db/dbformat.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nInternalKeyComparator {\n  int InternalKeyComparator::Compare(const Slice& akey, const Slice& bkey) const {\n    // Order by:\n    //    increasing user key (according to user-supplied comparator)\n    //    decreasing sequence number\n    //    decreasing type (though sequence# should be enough to disambiguate)\n    int r = user_comparator_->Compare(ExtractUserKey(akey), ExtractUserKey(bkey));\n    if (r == 0) {\n      const uint64_t anum = DecodeFixed64(akey.data() + akey.size() - 8);\n      const uint64_t bnum = DecodeFixed64(bkey.data() + bkey.size() - 8);\n      if (anum > bnum) {\n        r = -1;\n      } else if (anum < bnum) {\n        r = +1;\n      }\n    }\n    return r;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "this->Compare(*start, tmp) < 0"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PutFixed64",
          "args": [
            "&tmp",
            "PackSequenceAndType(kMaxSequenceNumber,kValueTypeForSeek)"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "PutFixed64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "41-45",
          "snippet": "void PutFixed64(std::string* dst, uint64_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed64(buf, value);\n  dst->append(buf, sizeof(buf));\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutFixed64(std::string* dst, uint64_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed64(buf, value);\n  dst->append(buf, sizeof(buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PackSequenceAndType",
          "args": [
            "kMaxSequenceNumber",
            "kValueTypeForSeek"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "PackSequenceAndType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "12-16",
          "snippet": "static uint64_t PackSequenceAndType(uint64_t seq, ValueType t) {\n  assert(seq <= kMaxSequenceNumber);\n  assert(t <= kValueTypeForSeek);\n  return (seq << 8) | t;\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"port/port.h\"",
            "#include \"db/dbformat.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nstatic uint64_t PackSequenceAndType(uint64_t seq, ValueType t) {\n  assert(seq <= kMaxSequenceNumber);\n  assert(t <= kValueTypeForSeek);\n  return (seq << 8) | t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "user_start.size",
          "args": [],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "user_comparator_->FindShortestSeparator",
          "args": [
            "&tmp",
            "user_limit"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "FindShortestSeparator",
          "container": "InternalKeyComparator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "68-85",
          "snippet": "void InternalKeyComparator::FindShortestSeparator(\n      std::string* start,\n      const Slice& limit) const {\n  // Attempt to shorten the user portion of the key\n  Slice user_start = ExtractUserKey(*start);\n  Slice user_limit = ExtractUserKey(limit);\n  std::string tmp(user_start.data(), user_start.size());\n  user_comparator_->FindShortestSeparator(&tmp, user_limit);\n  if (tmp.size() < user_start.size() &&\n      user_comparator_->Compare(user_start, tmp) < 0) {\n    // User key has become shorter physically, but larger logically.\n    // Tack on the earliest possible number to the shortened user key.\n    PutFixed64(&tmp, PackSequenceAndType(kMaxSequenceNumber,kValueTypeForSeek));\n    assert(this->Compare(*start, tmp) < 0);\n    assert(this->Compare(tmp, limit) < 0);\n    start->swap(tmp);\n  }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "user_start.data",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ExtractUserKey",
          "args": [
            "limit"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "ExtractUserKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "98-101",
          "snippet": "inline Slice ExtractUserKey(const Slice& internal_key) {\n  assert(internal_key.size() >= 8);\n  return Slice(internal_key.data(), internal_key.size() - 8);\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\ninline Slice ExtractUserKey(const Slice& internal_key) {\n  assert(internal_key.size() >= 8);\n  return Slice(internal_key.data(), internal_key.size() - 8);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nInternalKeyComparator {\n  void InternalKeyComparator::FindShortestSeparator(\n        std::string* start,\n        const Slice& limit) const {\n    // Attempt to shorten the user portion of the key\n    Slice user_start = ExtractUserKey(*start);\n    Slice user_limit = ExtractUserKey(limit);\n    std::string tmp(user_start.data(), user_start.size());\n    user_comparator_->FindShortestSeparator(&tmp, user_limit);\n    if (tmp.size() < user_start.size() &&\n        user_comparator_->Compare(user_start, tmp) < 0) {\n      // User key has become shorter physically, but larger logically.\n      // Tack on the earliest possible number to the shortened user key.\n      PutFixed64(&tmp, PackSequenceAndType(kMaxSequenceNumber,kValueTypeForSeek));\n      assert(this->Compare(*start, tmp) < 0);\n      assert(this->Compare(tmp, limit) < 0);\n      start->swap(tmp);\n    }\n  }\n}"
  },
  {
    "function_name": "Compare",
    "container": "InternalKeyComparator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
    "lines": "50-66",
    "snippet": "int InternalKeyComparator::Compare(const Slice& akey, const Slice& bkey) const {\n  // Order by:\n  //    increasing user key (according to user-supplied comparator)\n  //    decreasing sequence number\n  //    decreasing type (though sequence# should be enough to disambiguate)\n  int r = user_comparator_->Compare(ExtractUserKey(akey), ExtractUserKey(bkey));\n  if (r == 0) {\n    const uint64_t anum = DecodeFixed64(akey.data() + akey.size() - 8);\n    const uint64_t bnum = DecodeFixed64(bkey.data() + bkey.size() - 8);\n    if (anum > bnum) {\n      r = -1;\n    } else if (anum < bnum) {\n      r = +1;\n    }\n  }\n  return r;\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"port/port.h\"",
      "#include \"db/dbformat.h\"",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DecodeFixed64",
          "args": [
            "bkey.data() + bkey.size() - 8"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeFixed64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.h",
          "lines": "72-83",
          "snippet": "inline uint64_t DecodeFixed64(const char* ptr) {\n  if (port::kLittleEndian) {\n    // Load the raw bytes\n    uint64_t result;\n    memcpy(&result, ptr, sizeof(result));  // gcc optimizes this to a plain load\n    return result;\n  } else {\n    uint64_t lo = DecodeFixed32(ptr);\n    uint64_t hi = DecodeFixed32(ptr + 4);\n    return (hi << 32) | lo;\n  }\n}",
          "includes": [
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <string>",
            "#include <string.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include <string>\n#include <string.h>\n#include <stdint.h>\n\ninline uint64_t DecodeFixed64(const char* ptr) {\n  if (port::kLittleEndian) {\n    // Load the raw bytes\n    uint64_t result;\n    memcpy(&result, ptr, sizeof(result));  // gcc optimizes this to a plain load\n    return result;\n  } else {\n    uint64_t lo = DecodeFixed32(ptr);\n    uint64_t hi = DecodeFixed32(ptr + 4);\n    return (hi << 32) | lo;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "bkey.size",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "bkey.data",
          "args": [],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "akey.data",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "user_comparator_->Compare",
          "args": [
            "ExtractUserKey(akey)",
            "ExtractUserKey(bkey)"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "Compare",
          "container": "InternalKeyComparator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "50-66",
          "snippet": "int InternalKeyComparator::Compare(const Slice& akey, const Slice& bkey) const {\n  // Order by:\n  //    increasing user key (according to user-supplied comparator)\n  //    decreasing sequence number\n  //    decreasing type (though sequence# should be enough to disambiguate)\n  int r = user_comparator_->Compare(ExtractUserKey(akey), ExtractUserKey(bkey));\n  if (r == 0) {\n    const uint64_t anum = DecodeFixed64(akey.data() + akey.size() - 8);\n    const uint64_t bnum = DecodeFixed64(bkey.data() + bkey.size() - 8);\n    if (anum > bnum) {\n      r = -1;\n    } else if (anum < bnum) {\n      r = +1;\n    }\n  }\n  return r;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ExtractUserKey",
          "args": [
            "bkey"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "ExtractUserKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "98-101",
          "snippet": "inline Slice ExtractUserKey(const Slice& internal_key) {\n  assert(internal_key.size() >= 8);\n  return Slice(internal_key.data(), internal_key.size() - 8);\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\ninline Slice ExtractUserKey(const Slice& internal_key) {\n  assert(internal_key.size() >= 8);\n  return Slice(internal_key.data(), internal_key.size() - 8);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nInternalKeyComparator {\n  int InternalKeyComparator::Compare(const Slice& akey, const Slice& bkey) const {\n    // Order by:\n    //    increasing user key (according to user-supplied comparator)\n    //    decreasing sequence number\n    //    decreasing type (though sequence# should be enough to disambiguate)\n    int r = user_comparator_->Compare(ExtractUserKey(akey), ExtractUserKey(bkey));\n    if (r == 0) {\n      const uint64_t anum = DecodeFixed64(akey.data() + akey.size() - 8);\n      const uint64_t bnum = DecodeFixed64(bkey.data() + bkey.size() - 8);\n      if (anum > bnum) {\n        r = -1;\n      } else if (anum < bnum) {\n        r = +1;\n      }\n    }\n    return r;\n  }\n}"
  },
  {
    "function_name": "DebugString",
    "container": "InternalKey",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
    "lines": "34-44",
    "snippet": "std::string InternalKey::DebugString() const {\n  std::string result;\n  ParsedInternalKey parsed;\n  if (ParseInternalKey(rep_, &parsed)) {\n    result = parsed.DebugString();\n  } else {\n    result = \"(bad)\";\n    result.append(EscapeString(rep_));\n  }\n  return result;\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"port/port.h\"",
      "#include \"db/dbformat.h\"",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result.append",
          "args": [
            "EscapeString(rep_)"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EscapeString",
          "args": [
            "rep_"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "EscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
          "lines": "42-46",
          "snippet": "std::string EscapeString(const Slice& value) {\n  std::string r;\n  AppendEscapedStringTo(&r, value);\n  return r;\n}",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"util/logging.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nstd::string EscapeString(const Slice& value) {\n  std::string r;\n  AppendEscapedStringTo(&r, value);\n  return r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "parsed.DebugString",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "DebugString",
          "container": "InternalKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "34-44",
          "snippet": "std::string InternalKey::DebugString() const {\n  std::string result;\n  ParsedInternalKey parsed;\n  if (ParseInternalKey(rep_, &parsed)) {\n    result = parsed.DebugString();\n  } else {\n    result = \"(bad)\";\n    result.append(EscapeString(rep_));\n  }\n  return result;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ParseInternalKey",
          "args": [
            "rep_",
            "&parsed"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "ParseInternalKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.h",
          "lines": "176-186",
          "snippet": "inline bool ParseInternalKey(const Slice& internal_key,\n                             ParsedInternalKey* result) {\n  const size_t n = internal_key.size();\n  if (n < 8) return false;\n  uint64_t num = DecodeFixed64(internal_key.data() + n - 8);\n  unsigned char c = num & 0xff;\n  result->sequence = num >> 8;\n  result->type = static_cast<ValueType>(c);\n  result->user_key = Slice(internal_key.data(), n - 8);\n  return (c <= static_cast<unsigned char>(kTypeValue));\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"util/coding.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include <stdio.h>\n\ninline bool ParseInternalKey(const Slice& internal_key,\n                             ParsedInternalKey* result) {\n  const size_t n = internal_key.size();\n  if (n < 8) return false;\n  uint64_t num = DecodeFixed64(internal_key.data() + n - 8);\n  unsigned char c = num & 0xff;\n  result->sequence = num >> 8;\n  result->type = static_cast<ValueType>(c);\n  result->user_key = Slice(internal_key.data(), n - 8);\n  return (c <= static_cast<unsigned char>(kTypeValue));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nInternalKey {\n  std::string InternalKey::DebugString() const {\n    std::string result;\n    ParsedInternalKey parsed;\n    if (ParseInternalKey(rep_, &parsed)) {\n      result = parsed.DebugString();\n    } else {\n      result = \"(bad)\";\n      result.append(EscapeString(rep_));\n    }\n    return result;\n  }\n}"
  },
  {
    "function_name": "DebugString",
    "container": "ParsedInternalKey",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
    "lines": "23-32",
    "snippet": "std::string ParsedInternalKey::DebugString() const {\n  char buf[50];\n  snprintf(buf, sizeof(buf), \"' @ %llu : %d\",\n           (unsigned long long) sequence,\n           int(type));\n  std::string result = \"'\";\n  result += EscapeString(user_key.ToString());\n  result += buf;\n  return result;\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"port/port.h\"",
      "#include \"db/dbformat.h\"",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EscapeString",
          "args": [
            "user_key.ToString()"
          ],
          "line": 29
        },
        "resolved": true,
        "details": {
          "function_name": "EscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/logging.cc",
          "lines": "42-46",
          "snippet": "std::string EscapeString(const Slice& value) {\n  std::string r;\n  AppendEscapedStringTo(&r, value);\n  return r;\n}",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"util/logging.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"util/logging.h\"\n\nstd::string EscapeString(const Slice& value) {\n  std::string r;\n  AppendEscapedStringTo(&r, value);\n  return r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "user_key.ToString",
          "args": [],
          "line": 29
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"' @ %llu : %d\"",
            "(unsigned long long) sequence",
            "int(type)"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "int",
          "args": [
            "type"
          ],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "VersionEditPrinter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/leveldb_main.cc",
          "lines": "110-118",
          "snippet": "static void VersionEditPrinter(Slice record) {\n  VersionEdit edit;\n  Status s = edit.DecodeFrom(record);\n  if (!s.ok()) {\n    printf(\"%s\\n\", s.ToString().c_str());\n    return;\n  }\n  printf(\"%s\", edit.DebugString().c_str());\n}",
          "includes": [
            "#include \"util/logging.h\"",
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/table.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/version_edit.h\"",
            "#include \"db/log_reader.h\"",
            "#include \"db/filename.h\"",
            "#include \"db/dbformat.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/logging.h\"\n#include \"leveldb/write_batch.h\"\n#include \"leveldb/table.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/version_edit.h\"\n#include \"db/log_reader.h\"\n#include \"db/filename.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nstatic void VersionEditPrinter(Slice record) {\n  VersionEdit edit;\n  Status s = edit.DecodeFrom(record);\n  if (!s.ok()) {\n    printf(\"%s\\n\", s.ToString().c_str());\n    return;\n  }\n  printf(\"%s\", edit.DebugString().c_str());\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nParsedInternalKey {\n  std::string ParsedInternalKey::DebugString() const {\n    char buf[50];\n    snprintf(buf, sizeof(buf), \"' @ %llu : %d\",\n             (unsigned long long) sequence,\n             int(type));\n    std::string result = \"'\";\n    result += EscapeString(user_key.ToString());\n    result += buf;\n    return result;\n  }\n}"
  },
  {
    "function_name": "AppendInternalKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
    "lines": "18-21",
    "snippet": "void AppendInternalKey(std::string* result, const ParsedInternalKey& key) {\n  result->append(key.user_key.data(), key.user_key.size());\n  PutFixed64(result, PackSequenceAndType(key.sequence, key.type));\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"port/port.h\"",
      "#include \"db/dbformat.h\"",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PutFixed64",
          "args": [
            "result",
            "PackSequenceAndType(key.sequence, key.type)"
          ],
          "line": 20
        },
        "resolved": true,
        "details": {
          "function_name": "PutFixed64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "41-45",
          "snippet": "void PutFixed64(std::string* dst, uint64_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed64(buf, value);\n  dst->append(buf, sizeof(buf));\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutFixed64(std::string* dst, uint64_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed64(buf, value);\n  dst->append(buf, sizeof(buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PackSequenceAndType",
          "args": [
            "key.sequence",
            "key.type"
          ],
          "line": 20
        },
        "resolved": true,
        "details": {
          "function_name": "PackSequenceAndType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
          "lines": "12-16",
          "snippet": "static uint64_t PackSequenceAndType(uint64_t seq, ValueType t) {\n  assert(seq <= kMaxSequenceNumber);\n  assert(t <= kValueTypeForSeek);\n  return (seq << 8) | t;\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"port/port.h\"",
            "#include \"db/dbformat.h\"",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nstatic uint64_t PackSequenceAndType(uint64_t seq, ValueType t) {\n  assert(seq <= kMaxSequenceNumber);\n  assert(t <= kValueTypeForSeek);\n  return (seq << 8) | t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "result->append",
          "args": [
            "key.user_key.data()",
            "key.user_key.size()"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.user_key.size",
          "args": [],
          "line": 19
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "key.user_key.data",
          "args": [],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nvoid AppendInternalKey(std::string* result, const ParsedInternalKey& key) {\n  result->append(key.user_key.data(), key.user_key.size());\n  PutFixed64(result, PackSequenceAndType(key.sequence, key.type));\n}"
  },
  {
    "function_name": "PackSequenceAndType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/dbformat.cc",
    "lines": "12-16",
    "snippet": "static uint64_t PackSequenceAndType(uint64_t seq, ValueType t) {\n  assert(seq <= kMaxSequenceNumber);\n  assert(t <= kValueTypeForSeek);\n  return (seq << 8) | t;\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"port/port.h\"",
      "#include \"db/dbformat.h\"",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "t <= kValueTypeForSeek"
          ],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "seq <= kMaxSequenceNumber"
          ],
          "line": 13
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"port/port.h\"\n#include \"db/dbformat.h\"\n#include <stdio.h>\n\nstatic uint64_t PackSequenceAndType(uint64_t seq, ValueType t) {\n  assert(seq <= kMaxSequenceNumber);\n  assert(t <= kValueTypeForSeek);\n  return (seq << 8) | t;\n}"
  }
]