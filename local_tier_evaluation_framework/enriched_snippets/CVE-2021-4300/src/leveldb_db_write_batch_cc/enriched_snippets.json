[
  {
    "function_name": "Append",
    "container": "WriteBatchInternal",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "141-145",
    "snippet": "void WriteBatchInternal::Append(WriteBatch* dst, const WriteBatch* src) {\n  SetCount(dst, Count(dst) + Count(src));\n  assert(src->rep_.size() >= kHeader);\n  dst->rep_.append(src->rep_.data() + kHeader, src->rep_.size() - kHeader);\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dst->rep_.append",
          "args": [
            "src->rep_.data() + kHeader",
            "src->rep_.size() - kHeader"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src->rep_.size",
          "args": [],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "src->rep_.data",
          "args": [],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "src->rep_.size() >= kHeader"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetCount",
          "args": [
            "dst",
            "Count(dst) + Count(src)"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "SetCount",
          "container": "WriteBatchInternal",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "86-88",
          "snippet": "void WriteBatchInternal::SetCount(WriteBatch* b, int n) {\n  EncodeFixed32(&b->rep_[8], n);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  void WriteBatchInternal::SetCount(WriteBatch* b, int n) {\n    EncodeFixed32(&b->rep_[8], n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Count",
          "args": [
            "src"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "Count",
          "container": "WriteBatchInternal",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "82-84",
          "snippet": "int WriteBatchInternal::Count(const WriteBatch* b) {\n  return DecodeFixed32(b->rep_.data() + 8);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  int WriteBatchInternal::Count(const WriteBatch* b) {\n    return DecodeFixed32(b->rep_.data() + 8);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  void WriteBatchInternal::Append(WriteBatch* dst, const WriteBatch* src) {\n    SetCount(dst, Count(dst) + Count(src));\n    assert(src->rep_.size() >= kHeader);\n    dst->rep_.append(src->rep_.data() + kHeader, src->rep_.size() - kHeader);\n  }\n}"
  },
  {
    "function_name": "SetContents",
    "container": "WriteBatchInternal",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "136-139",
    "snippet": "void WriteBatchInternal::SetContents(WriteBatch* b, const Slice& contents) {\n  assert(contents.size() >= kHeader);\n  b->rep_.assign(contents.data(), contents.size());\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b->rep_.assign",
          "args": [
            "contents.data()",
            "contents.size()"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "contents.size",
          "args": [],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "contents.data",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "contents.size() >= kHeader"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  void WriteBatchInternal::SetContents(WriteBatch* b, const Slice& contents) {\n    assert(contents.size() >= kHeader);\n    b->rep_.assign(contents.data(), contents.size());\n  }\n}"
  },
  {
    "function_name": "InsertInto",
    "container": "WriteBatchInternal",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "128-134",
    "snippet": "Status WriteBatchInternal::InsertInto(const WriteBatch* b,\n                                      MemTable* memtable) {\n  MemTableInserter inserter;\n  inserter.sequence_ = WriteBatchInternal::Sequence(b);\n  inserter.mem_ = memtable;\n  return b->Iterate(&inserter);\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b->Iterate",
          "args": [
            "&inserter"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "Iterate",
          "container": "WriteBatch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "42-80",
          "snippet": "Status WriteBatch::Iterate(Handler* handler) const {\n  Slice input(rep_);\n  if (input.size() < kHeader) {\n    return Status::Corruption(\"malformed WriteBatch (too small)\");\n  }\n\n  input.remove_prefix(kHeader);\n  Slice key, value;\n  int found = 0;\n  while (!input.empty()) {\n    found++;\n    char tag = input[0];\n    input.remove_prefix(1);\n    switch (tag) {\n      case kTypeValue:\n        if (GetLengthPrefixedSlice(&input, &key) &&\n            GetLengthPrefixedSlice(&input, &value)) {\n          handler->Put(key, value);\n        } else {\n          return Status::Corruption(\"bad WriteBatch Put\");\n        }\n        break;\n      case kTypeDeletion:\n        if (GetLengthPrefixedSlice(&input, &key)) {\n          handler->Delete(key);\n        } else {\n          return Status::Corruption(\"bad WriteBatch Delete\");\n        }\n        break;\n      default:\n        return Status::Corruption(\"unknown WriteBatch tag\");\n    }\n  }\n  if (found != WriteBatchInternal::Count(this)) {\n    return Status::Corruption(\"WriteBatch has wrong count\");\n  } else {\n    return Status::OK();\n  }\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatch {\n  Status WriteBatch::Iterate(Handler* handler) const {\n    Slice input(rep_);\n    if (input.size() < kHeader) {\n      return Status::Corruption(\"malformed WriteBatch (too small)\");\n    }\n  \n    input.remove_prefix(kHeader);\n    Slice key, value;\n    int found = 0;\n    while (!input.empty()) {\n      found++;\n      char tag = input[0];\n      input.remove_prefix(1);\n      switch (tag) {\n        case kTypeValue:\n          if (GetLengthPrefixedSlice(&input, &key) &&\n              GetLengthPrefixedSlice(&input, &value)) {\n            handler->Put(key, value);\n          } else {\n            return Status::Corruption(\"bad WriteBatch Put\");\n          }\n          break;\n        case kTypeDeletion:\n          if (GetLengthPrefixedSlice(&input, &key)) {\n            handler->Delete(key);\n          } else {\n            return Status::Corruption(\"bad WriteBatch Delete\");\n          }\n          break;\n        default:\n          return Status::Corruption(\"unknown WriteBatch tag\");\n      }\n    }\n    if (found != WriteBatchInternal::Count(this)) {\n      return Status::Corruption(\"WriteBatch has wrong count\");\n    } else {\n      return Status::OK();\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WriteBatchInternal::Sequence",
          "args": [
            "b"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "Sequence",
          "container": "WriteBatchInternal",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "90-92",
          "snippet": "SequenceNumber WriteBatchInternal::Sequence(const WriteBatch* b) {\n  return SequenceNumber(DecodeFixed64(b->rep_.data()));\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  SequenceNumber WriteBatchInternal::Sequence(const WriteBatch* b) {\n    return SequenceNumber(DecodeFixed64(b->rep_.data()));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  Status WriteBatchInternal::InsertInto(const WriteBatch* b,\n                                        MemTable* memtable) {\n    MemTableInserter inserter;\n    inserter.sequence_ = WriteBatchInternal::Sequence(b);\n    inserter.mem_ = memtable;\n    return b->Iterate(&inserter);\n  }\n}"
  },
  {
    "function_name": "Delete",
    "container": "MemTableInserter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "121-124",
    "snippet": "virtual void Delete(const Slice& key) {\n    mem_->Add(sequence_, kTypeDeletion, key, Slice());\n    sequence_++;\n  }",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_->Add",
          "args": [
            "sequence_",
            "kTypeDeletion",
            "key",
            "Slice()"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "MemTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/memtable.cc",
          "lines": "82-106",
          "snippet": "void MemTable::Add(SequenceNumber s, ValueType type,\n                   const Slice& key,\n                   const Slice& value) {\n  // Format of an entry is concatenation of:\n  //  key_size     : varint32 of internal_key.size()\n  //  key bytes    : char[internal_key.size()]\n  //  value_size   : varint32 of value.size()\n  //  value bytes  : char[value.size()]\n  size_t key_size = key.size();\n  size_t val_size = value.size();\n  size_t internal_key_size = key_size + 8;\n  const size_t encoded_len =\n      VarintLength(internal_key_size) + internal_key_size +\n      VarintLength(val_size) + val_size;\n  char* buf = arena_.Allocate(encoded_len);\n  char* p = EncodeVarint32(buf, internal_key_size);\n  memcpy(p, key.data(), key_size);\n  p += key_size;\n  EncodeFixed64(p, (s << 8) | type);\n  p += 8;\n  p = EncodeVarint32(p, val_size);\n  memcpy(p, value.data(), val_size);\n  assert((p + val_size) - buf == encoded_len);\n  table_.Insert(buf);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/memtable.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/comparator.h\"\n#include \"db/dbformat.h\"\n#include \"db/memtable.h\"\n\nMemTable {\n  void MemTable::Add(SequenceNumber s, ValueType type,\n                     const Slice& key,\n                     const Slice& value) {\n    // Format of an entry is concatenation of:\n    //  key_size     : varint32 of internal_key.size()\n    //  key bytes    : char[internal_key.size()]\n    //  value_size   : varint32 of value.size()\n    //  value bytes  : char[value.size()]\n    size_t key_size = key.size();\n    size_t val_size = value.size();\n    size_t internal_key_size = key_size + 8;\n    const size_t encoded_len =\n        VarintLength(internal_key_size) + internal_key_size +\n        VarintLength(val_size) + val_size;\n    char* buf = arena_.Allocate(encoded_len);\n    char* p = EncodeVarint32(buf, internal_key_size);\n    memcpy(p, key.data(), key_size);\n    p += key_size;\n    EncodeFixed64(p, (s << 8) | type);\n    p += 8;\n    p = EncodeVarint32(p, val_size);\n    memcpy(p, value.data(), val_size);\n    assert((p + val_size) - buf == encoded_len);\n    table_.Insert(buf);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "66-66",
          "snippet": "std::string ToString() const { return std::string(data_, size_); }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  std::string ToString() const { return std::string(data_, size_); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nMemTableInserter {\n  virtual void Delete(const Slice& key) {\n      mem_->Add(sequence_, kTypeDeletion, key, Slice());\n      sequence_++;\n    }\n}"
  },
  {
    "function_name": "Put",
    "container": "MemTableInserter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "117-120",
    "snippet": "virtual void Put(const Slice& key, const Slice& value) {\n    mem_->Add(sequence_, kTypeValue, key, value);\n    sequence_++;\n  }",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_->Add",
          "args": [
            "sequence_",
            "kTypeValue",
            "key",
            "value"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "Add",
          "container": "MemTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/memtable.cc",
          "lines": "82-106",
          "snippet": "void MemTable::Add(SequenceNumber s, ValueType type,\n                   const Slice& key,\n                   const Slice& value) {\n  // Format of an entry is concatenation of:\n  //  key_size     : varint32 of internal_key.size()\n  //  key bytes    : char[internal_key.size()]\n  //  value_size   : varint32 of value.size()\n  //  value bytes  : char[value.size()]\n  size_t key_size = key.size();\n  size_t val_size = value.size();\n  size_t internal_key_size = key_size + 8;\n  const size_t encoded_len =\n      VarintLength(internal_key_size) + internal_key_size +\n      VarintLength(val_size) + val_size;\n  char* buf = arena_.Allocate(encoded_len);\n  char* p = EncodeVarint32(buf, internal_key_size);\n  memcpy(p, key.data(), key_size);\n  p += key_size;\n  EncodeFixed64(p, (s << 8) | type);\n  p += 8;\n  p = EncodeVarint32(p, val_size);\n  memcpy(p, value.data(), val_size);\n  assert((p + val_size) - buf == encoded_len);\n  table_.Insert(buf);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"db/memtable.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/comparator.h\"\n#include \"db/dbformat.h\"\n#include \"db/memtable.h\"\n\nMemTable {\n  void MemTable::Add(SequenceNumber s, ValueType type,\n                     const Slice& key,\n                     const Slice& value) {\n    // Format of an entry is concatenation of:\n    //  key_size     : varint32 of internal_key.size()\n    //  key bytes    : char[internal_key.size()]\n    //  value_size   : varint32 of value.size()\n    //  value bytes  : char[value.size()]\n    size_t key_size = key.size();\n    size_t val_size = value.size();\n    size_t internal_key_size = key_size + 8;\n    const size_t encoded_len =\n        VarintLength(internal_key_size) + internal_key_size +\n        VarintLength(val_size) + val_size;\n    char* buf = arena_.Allocate(encoded_len);\n    char* p = EncodeVarint32(buf, internal_key_size);\n    memcpy(p, key.data(), key_size);\n    p += key_size;\n    EncodeFixed64(p, (s << 8) | type);\n    p += 8;\n    p = EncodeVarint32(p, val_size);\n    memcpy(p, value.data(), val_size);\n    assert((p + val_size) - buf == encoded_len);\n    table_.Insert(buf);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nMemTableInserter {\n  virtual void Put(const Slice& key, const Slice& value) {\n      mem_->Add(sequence_, kTypeValue, key, value);\n      sequence_++;\n    }\n}"
  },
  {
    "function_name": "Delete",
    "container": "WriteBatch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "105-109",
    "snippet": "void WriteBatch::Delete(const Slice& key) {\n  WriteBatchInternal::SetCount(this, WriteBatchInternal::Count(this) + 1);\n  rep_.push_back(static_cast<char>(kTypeDeletion));\n  PutLengthPrefixedSlice(&rep_, key);\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PutLengthPrefixedSlice",
          "args": [
            "&rep_",
            "key"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "PutLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "98-101",
          "snippet": "void PutLengthPrefixedSlice(std::string* dst, const Slice& value) {\n  PutVarint32(dst, value.size());\n  dst->append(value.data(), value.size());\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutLengthPrefixedSlice(std::string* dst, const Slice& value) {\n  PutVarint32(dst, value.size());\n  dst->append(value.data(), value.size());\n}"
        }
      },
      {
        "call_info": {
          "callee": "rep_.push_back",
          "args": [
            "static_cast<char>(kTypeDeletion)"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<char>",
          "args": [
            "kTypeDeletion"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WriteBatchInternal::SetCount",
          "args": [
            "this",
            "WriteBatchInternal::Count(this) + 1"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "SetCount",
          "container": "WriteBatchInternal",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "86-88",
          "snippet": "void WriteBatchInternal::SetCount(WriteBatch* b, int n) {\n  EncodeFixed32(&b->rep_[8], n);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  void WriteBatchInternal::SetCount(WriteBatch* b, int n) {\n    EncodeFixed32(&b->rep_[8], n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WriteBatchInternal::Count",
          "args": [
            "this"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "Count",
          "container": "WriteBatchInternal",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "82-84",
          "snippet": "int WriteBatchInternal::Count(const WriteBatch* b) {\n  return DecodeFixed32(b->rep_.data() + 8);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  int WriteBatchInternal::Count(const WriteBatch* b) {\n    return DecodeFixed32(b->rep_.data() + 8);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatch {\n  void WriteBatch::Delete(const Slice& key) {\n    WriteBatchInternal::SetCount(this, WriteBatchInternal::Count(this) + 1);\n    rep_.push_back(static_cast<char>(kTypeDeletion));\n    PutLengthPrefixedSlice(&rep_, key);\n  }\n}"
  },
  {
    "function_name": "Put",
    "container": "WriteBatch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "98-103",
    "snippet": "void WriteBatch::Put(const Slice& key, const Slice& value) {\n  WriteBatchInternal::SetCount(this, WriteBatchInternal::Count(this) + 1);\n  rep_.push_back(static_cast<char>(kTypeValue));\n  PutLengthPrefixedSlice(&rep_, key);\n  PutLengthPrefixedSlice(&rep_, value);\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PutLengthPrefixedSlice",
          "args": [
            "&rep_",
            "value"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "PutLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "98-101",
          "snippet": "void PutLengthPrefixedSlice(std::string* dst, const Slice& value) {\n  PutVarint32(dst, value.size());\n  dst->append(value.data(), value.size());\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutLengthPrefixedSlice(std::string* dst, const Slice& value) {\n  PutVarint32(dst, value.size());\n  dst->append(value.data(), value.size());\n}"
        }
      },
      {
        "call_info": {
          "callee": "rep_.push_back",
          "args": [
            "static_cast<char>(kTypeValue)"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<char>",
          "args": [
            "kTypeValue"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WriteBatchInternal::SetCount",
          "args": [
            "this",
            "WriteBatchInternal::Count(this) + 1"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "SetCount",
          "container": "WriteBatchInternal",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "86-88",
          "snippet": "void WriteBatchInternal::SetCount(WriteBatch* b, int n) {\n  EncodeFixed32(&b->rep_[8], n);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  void WriteBatchInternal::SetCount(WriteBatch* b, int n) {\n    EncodeFixed32(&b->rep_[8], n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WriteBatchInternal::Count",
          "args": [
            "this"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "Count",
          "container": "WriteBatchInternal",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "82-84",
          "snippet": "int WriteBatchInternal::Count(const WriteBatch* b) {\n  return DecodeFixed32(b->rep_.data() + 8);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  int WriteBatchInternal::Count(const WriteBatch* b) {\n    return DecodeFixed32(b->rep_.data() + 8);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatch {\n  void WriteBatch::Put(const Slice& key, const Slice& value) {\n    WriteBatchInternal::SetCount(this, WriteBatchInternal::Count(this) + 1);\n    rep_.push_back(static_cast<char>(kTypeValue));\n    PutLengthPrefixedSlice(&rep_, key);\n    PutLengthPrefixedSlice(&rep_, value);\n  }\n}"
  },
  {
    "function_name": "SetSequence",
    "container": "WriteBatchInternal",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "94-96",
    "snippet": "void WriteBatchInternal::SetSequence(WriteBatch* b, SequenceNumber seq) {\n  EncodeFixed64(&b->rep_[0], seq);\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EncodeFixed64",
          "args": [
            "&b->rep_[0]",
            "seq"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeFixed64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "20-33",
          "snippet": "void EncodeFixed64(char* buf, uint64_t value) {\n  if (port::kLittleEndian) {\n    memcpy(buf, &value, sizeof(value));\n  } else {\n    buf[0] = value & 0xff;\n    buf[1] = (value >> 8) & 0xff;\n    buf[2] = (value >> 16) & 0xff;\n    buf[3] = (value >> 24) & 0xff;\n    buf[4] = (value >> 32) & 0xff;\n    buf[5] = (value >> 40) & 0xff;\n    buf[6] = (value >> 48) & 0xff;\n    buf[7] = (value >> 56) & 0xff;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid EncodeFixed64(char* buf, uint64_t value) {\n  if (port::kLittleEndian) {\n    memcpy(buf, &value, sizeof(value));\n  } else {\n    buf[0] = value & 0xff;\n    buf[1] = (value >> 8) & 0xff;\n    buf[2] = (value >> 16) & 0xff;\n    buf[3] = (value >> 24) & 0xff;\n    buf[4] = (value >> 32) & 0xff;\n    buf[5] = (value >> 40) & 0xff;\n    buf[6] = (value >> 48) & 0xff;\n    buf[7] = (value >> 56) & 0xff;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  void WriteBatchInternal::SetSequence(WriteBatch* b, SequenceNumber seq) {\n    EncodeFixed64(&b->rep_[0], seq);\n  }\n}"
  },
  {
    "function_name": "Sequence",
    "container": "WriteBatchInternal",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "90-92",
    "snippet": "SequenceNumber WriteBatchInternal::Sequence(const WriteBatch* b) {\n  return SequenceNumber(DecodeFixed64(b->rep_.data()));\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SequenceNumber",
          "args": [
            "DecodeFixed64(b->rep_.data())"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DecodeFixed64",
          "args": [
            "b->rep_.data()"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeFixed64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.h",
          "lines": "72-83",
          "snippet": "inline uint64_t DecodeFixed64(const char* ptr) {\n  if (port::kLittleEndian) {\n    // Load the raw bytes\n    uint64_t result;\n    memcpy(&result, ptr, sizeof(result));  // gcc optimizes this to a plain load\n    return result;\n  } else {\n    uint64_t lo = DecodeFixed32(ptr);\n    uint64_t hi = DecodeFixed32(ptr + 4);\n    return (hi << 32) | lo;\n  }\n}",
          "includes": [
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <string>",
            "#include <string.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include <string>\n#include <string.h>\n#include <stdint.h>\n\ninline uint64_t DecodeFixed64(const char* ptr) {\n  if (port::kLittleEndian) {\n    // Load the raw bytes\n    uint64_t result;\n    memcpy(&result, ptr, sizeof(result));  // gcc optimizes this to a plain load\n    return result;\n  } else {\n    uint64_t lo = DecodeFixed32(ptr);\n    uint64_t hi = DecodeFixed32(ptr + 4);\n    return (hi << 32) | lo;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "b->rep_.data",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  SequenceNumber WriteBatchInternal::Sequence(const WriteBatch* b) {\n    return SequenceNumber(DecodeFixed64(b->rep_.data()));\n  }\n}"
  },
  {
    "function_name": "SetCount",
    "container": "WriteBatchInternal",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "86-88",
    "snippet": "void WriteBatchInternal::SetCount(WriteBatch* b, int n) {\n  EncodeFixed32(&b->rep_[8], n);\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EncodeFixed32",
          "args": [
            "&b->rep_[8]",
            "n"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeFixed32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "9-18",
          "snippet": "void EncodeFixed32(char* buf, uint32_t value) {\n  if (port::kLittleEndian) {\n    memcpy(buf, &value, sizeof(value));\n  } else {\n    buf[0] = value & 0xff;\n    buf[1] = (value >> 8) & 0xff;\n    buf[2] = (value >> 16) & 0xff;\n    buf[3] = (value >> 24) & 0xff;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid EncodeFixed32(char* buf, uint32_t value) {\n  if (port::kLittleEndian) {\n    memcpy(buf, &value, sizeof(value));\n  } else {\n    buf[0] = value & 0xff;\n    buf[1] = (value >> 8) & 0xff;\n    buf[2] = (value >> 16) & 0xff;\n    buf[3] = (value >> 24) & 0xff;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  void WriteBatchInternal::SetCount(WriteBatch* b, int n) {\n    EncodeFixed32(&b->rep_[8], n);\n  }\n}"
  },
  {
    "function_name": "Count",
    "container": "WriteBatchInternal",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "82-84",
    "snippet": "int WriteBatchInternal::Count(const WriteBatch* b) {\n  return DecodeFixed32(b->rep_.data() + 8);\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DecodeFixed32",
          "args": [
            "b->rep_.data() + 8"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeFixed32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.h",
          "lines": "58-70",
          "snippet": "inline uint32_t DecodeFixed32(const char* ptr) {\n  if (port::kLittleEndian) {\n    // Load the raw bytes\n    uint32_t result;\n    memcpy(&result, ptr, sizeof(result));  // gcc optimizes this to a plain load\n    return result;\n  } else {\n    return ((static_cast<uint32_t>(static_cast<unsigned char>(ptr[0])))\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[1])) << 8)\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[2])) << 16)\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[3])) << 24));\n  }\n}",
          "includes": [
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <string>",
            "#include <string.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include <string>\n#include <string.h>\n#include <stdint.h>\n\ninline uint32_t DecodeFixed32(const char* ptr) {\n  if (port::kLittleEndian) {\n    // Load the raw bytes\n    uint32_t result;\n    memcpy(&result, ptr, sizeof(result));  // gcc optimizes this to a plain load\n    return result;\n  } else {\n    return ((static_cast<uint32_t>(static_cast<unsigned char>(ptr[0])))\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[1])) << 8)\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[2])) << 16)\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[3])) << 24));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "b->rep_.data",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  int WriteBatchInternal::Count(const WriteBatch* b) {\n    return DecodeFixed32(b->rep_.data() + 8);\n  }\n}"
  },
  {
    "function_name": "Iterate",
    "container": "WriteBatch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "42-80",
    "snippet": "Status WriteBatch::Iterate(Handler* handler) const {\n  Slice input(rep_);\n  if (input.size() < kHeader) {\n    return Status::Corruption(\"malformed WriteBatch (too small)\");\n  }\n\n  input.remove_prefix(kHeader);\n  Slice key, value;\n  int found = 0;\n  while (!input.empty()) {\n    found++;\n    char tag = input[0];\n    input.remove_prefix(1);\n    switch (tag) {\n      case kTypeValue:\n        if (GetLengthPrefixedSlice(&input, &key) &&\n            GetLengthPrefixedSlice(&input, &value)) {\n          handler->Put(key, value);\n        } else {\n          return Status::Corruption(\"bad WriteBatch Put\");\n        }\n        break;\n      case kTypeDeletion:\n        if (GetLengthPrefixedSlice(&input, &key)) {\n          handler->Delete(key);\n        } else {\n          return Status::Corruption(\"bad WriteBatch Delete\");\n        }\n        break;\n      default:\n        return Status::Corruption(\"unknown WriteBatch tag\");\n    }\n  }\n  if (found != WriteBatchInternal::Count(this)) {\n    return Status::Corruption(\"WriteBatch has wrong count\");\n  } else {\n    return Status::OK();\n  }\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Status::Corruption",
          "args": [
            "\"WriteBatch has wrong count\""
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "Corruption",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "38-40",
          "snippet": "static Status Corruption(const Slice& msg, const Slice& msg2 = Slice()) {\n    return Status(kCorruption, msg, msg2);\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status Corruption(const Slice& msg, const Slice& msg2 = Slice()) {\n      return Status(kCorruption, msg, msg2);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WriteBatchInternal::Count",
          "args": [
            "this"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "Count",
          "container": "WriteBatchInternal",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "82-84",
          "snippet": "int WriteBatchInternal::Count(const WriteBatch* b) {\n  return DecodeFixed32(b->rep_.data() + 8);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatchInternal {\n  int WriteBatchInternal::Count(const WriteBatch* b) {\n    return DecodeFixed32(b->rep_.data() + 8);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "handler->Delete",
          "args": [
            "key"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "Delete",
          "container": "MemTableInserter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "121-124",
          "snippet": "virtual void Delete(const Slice& key) {\n    mem_->Add(sequence_, kTypeDeletion, key, Slice());\n    sequence_++;\n  }",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nMemTableInserter {\n  virtual void Delete(const Slice& key) {\n      mem_->Add(sequence_, kTypeDeletion, key, Slice());\n      sequence_++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLengthPrefixedSlice",
          "args": [
            "&input",
            "&key"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "handler->Put",
          "args": [
            "key",
            "value"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "MemTableInserter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "117-120",
          "snippet": "virtual void Put(const Slice& key, const Slice& value) {\n    mem_->Add(sequence_, kTypeValue, key, value);\n    sequence_++;\n  }",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nMemTableInserter {\n  virtual void Put(const Slice& key, const Slice& value) {\n      mem_->Add(sequence_, kTypeValue, key, value);\n      sequence_++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "input.remove_prefix",
          "args": [
            "1"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "remove_prefix",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "59-63",
          "snippet": "void remove_prefix(size_t n) {\n    assert(n <= size());\n    data_ += n;\n    size_ -= n;\n  }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  void remove_prefix(size_t n) {\n      assert(n <= size());\n      data_ += n;\n      size_ -= n;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "input.empty",
          "args": [],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "SnapshotList",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/snapshot.h",
          "lines": "37-37",
          "snippet": "bool empty() const { return list_.next_ == &list_; }",
          "includes": [
            "#include \"leveldb/db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/db.h\"\n\nSnapshotList {\n  bool empty() const { return list_.next_ == &list_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "input.size",
          "args": [],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatch {\n  Status WriteBatch::Iterate(Handler* handler) const {\n    Slice input(rep_);\n    if (input.size() < kHeader) {\n      return Status::Corruption(\"malformed WriteBatch (too small)\");\n    }\n  \n    input.remove_prefix(kHeader);\n    Slice key, value;\n    int found = 0;\n    while (!input.empty()) {\n      found++;\n      char tag = input[0];\n      input.remove_prefix(1);\n      switch (tag) {\n        case kTypeValue:\n          if (GetLengthPrefixedSlice(&input, &key) &&\n              GetLengthPrefixedSlice(&input, &value)) {\n            handler->Put(key, value);\n          } else {\n            return Status::Corruption(\"bad WriteBatch Put\");\n          }\n          break;\n        case kTypeDeletion:\n          if (GetLengthPrefixedSlice(&input, &key)) {\n            handler->Delete(key);\n          } else {\n            return Status::Corruption(\"bad WriteBatch Delete\");\n          }\n          break;\n        default:\n          return Status::Corruption(\"unknown WriteBatch tag\");\n      }\n    }\n    if (found != WriteBatchInternal::Count(this)) {\n      return Status::Corruption(\"WriteBatch has wrong count\");\n    } else {\n      return Status::OK();\n    }\n  }\n}"
  },
  {
    "function_name": "Clear",
    "container": "WriteBatch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "37-40",
    "snippet": "void WriteBatch::Clear() {\n  rep_.clear();\n  rep_.resize(kHeader);\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rep_.resize",
          "args": [
            "kHeader"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rep_.clear",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatch {\n  void WriteBatch::Clear() {\n    rep_.clear();\n    rep_.resize(kHeader);\n  }\n}"
  },
  {
    "function_name": "~Handler",
    "container": "WriteBatch::Handler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "35-35",
    "snippet": "WriteBatch::Handler::~Handler() { }",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatch {\n  Handler {\n    WriteBatch::Handler::~Handler() { }\n  }\n}"
  },
  {
    "function_name": "~WriteBatch",
    "container": "WriteBatch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "33-33",
    "snippet": "WriteBatch::~WriteBatch() { }",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatch {\n  WriteBatch::~WriteBatch() { }\n}"
  },
  {
    "function_name": "WriteBatch",
    "container": "WriteBatch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
    "lines": "29-31",
    "snippet": "WriteBatch::WriteBatch() {\n  Clear();\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"db/write_batch_internal.h\"",
      "#include \"db/memtable.h\"",
      "#include \"db/dbformat.h\"",
      "#include \"leveldb/db.h\"",
      "#include \"leveldb/write_batch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Clear",
          "args": [],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "Clear",
          "container": "WriteBatch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/write_batch.cc",
          "lines": "37-40",
          "snippet": "void WriteBatch::Clear() {\n  rep_.clear();\n  rep_.resize(kHeader);\n}",
          "includes": [
            "#include \"util/coding.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/write_batch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatch {\n  void WriteBatch::Clear() {\n    rep_.clear();\n    rep_.resize(kHeader);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/write_batch.h\"\n\nWriteBatch {\n  WriteBatch::WriteBatch() {\n    Clear();\n  }\n}"
  }
]