[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_test.cc",
    "lines": "102-104",
    "snippet": "int main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "leveldb::test::RunAllTests",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "RunAllTests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "36-58",
          "snippet": "int RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n\nint main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_test.cc",
    "lines": "81-98",
    "snippet": "TEST(EnvPosixTest, StartThread) {\n  State state;\n  state.val = 0;\n  state.num_running = 3;\n  for (int i = 0; i < 3; i++) {\n    env_->StartThread(&ThreadBody, &state);\n  }\n  while (true) {\n    state.mu.Lock();\n    int num = state.num_running;\n    state.mu.Unlock();\n    if (num == 0) {\n      break;\n    }\n    Env::Default()->SleepForMicroseconds(kDelayMicros);\n  }\n  ASSERT_EQ(state.val, 3);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "state.val",
            "3"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [
            "kDelayMicros"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "state.mu.Unlock",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "Unlock",
          "container": "Mutex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "60-63",
          "snippet": "void Mutex::Unlock() {\n  assert(cs_);\n  ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Unlock() {\n    assert(cs_);\n    ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "state.mu.Lock",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "Lock",
          "container": "CCryptoKeyStore",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/keystore.cpp",
          "lines": "76-88",
          "snippet": "bool CCryptoKeyStore::Lock()\n{\n    if (!SetCrypted())\n        return false;\n\n    {\n        LOCK(cs_KeyStore);\n        vMasterKey.clear();\n    }\n\n    NotifyStatusChanged(this);\n    return true;\n}",
          "includes": [
            "#include \"script.h\"",
            "#include \"keystore.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"keystore.h\"\n\nCCryptoKeyStore {\n  bool CCryptoKeyStore::Lock()\n  {\n      if (!SetCrypted())\n          return false;\n  \n      {\n          LOCK(cs_KeyStore);\n          vMasterKey.clear();\n      }\n  \n      NotifyStatusChanged(this);\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "env_->StartThread",
          "args": [
            "&ThreadBody",
            "&state"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "StartThread",
          "container": "Win32Env",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "885-888",
          "snippet": "void Win32Env::StartThread( void (*function)(void* arg), void* arg )\n{\n    ::_beginthread(function,0,arg);\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  void Win32Env::StartThread( void (*function)(void* arg), void* arg )\n  {\n      ::_beginthread(function,0,arg);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n\nTEST(EnvPosixTest, StartThread) {\n  State state;\n  state.val = 0;\n  state.num_running = 3;\n  for (int i = 0; i < 3; i++) {\n    env_->StartThread(&ThreadBody, &state);\n  }\n  while (true) {\n    state.mu.Lock();\n    int num = state.num_running;\n    state.mu.Unlock();\n    if (num == 0) {\n      break;\n    }\n    Env::Default()->SleepForMicroseconds(kDelayMicros);\n  }\n  ASSERT_EQ(state.val, 3);\n}"
  },
  {
    "function_name": "ThreadBody",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_test.cc",
    "lines": "73-79",
    "snippet": "static void ThreadBody(void* arg) {\n  State* s = reinterpret_cast<State*>(arg);\n  s->mu.Lock();\n  s->val += 1;\n  s->num_running -= 1;\n  s->mu.Unlock();\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s->mu.Unlock",
          "args": [],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "Unlock",
          "container": "Mutex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/port_win.cc",
          "lines": "60-63",
          "snippet": "void Mutex::Unlock() {\n  assert(cs_);\n  ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n}",
          "includes": [
            "#include <cassert>",
            "#include <windows.h>",
            "#include \"port/port_win.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include <windows.h>\n#include \"port/port_win.h\"\n\nMutex {\n  void Mutex::Unlock() {\n    assert(cs_);\n    ::LeaveCriticalSection(static_cast<CRITICAL_SECTION *>(cs_));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s->mu.Lock",
          "args": [],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "Lock",
          "container": "CCryptoKeyStore",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/keystore.cpp",
          "lines": "76-88",
          "snippet": "bool CCryptoKeyStore::Lock()\n{\n    if (!SetCrypted())\n        return false;\n\n    {\n        LOCK(cs_KeyStore);\n        vMasterKey.clear();\n    }\n\n    NotifyStatusChanged(this);\n    return true;\n}",
          "includes": [
            "#include \"script.h\"",
            "#include \"keystore.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"keystore.h\"\n\nCCryptoKeyStore {\n  bool CCryptoKeyStore::Lock()\n  {\n      if (!SetCrypted())\n          return false;\n  \n      {\n          LOCK(cs_KeyStore);\n          vMasterKey.clear();\n      }\n  \n      NotifyStatusChanged(this);\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<State*>",
          "args": [
            "arg"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n\nstatic void ThreadBody(void* arg) {\n  State* s = reinterpret_cast<State*>(arg);\n  s->mu.Lock();\n  s->val += 1;\n  s->num_running -= 1;\n  s->mu.Unlock();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_test.cc",
    "lines": "35-65",
    "snippet": "TEST(EnvPosixTest, RunMany) {\n  port::AtomicPointer last_id (NULL);\n\n  struct CB {\n    port::AtomicPointer* last_id_ptr;   // Pointer to shared slot\n    uintptr_t id;             // Order# for the execution of this callback\n\n    CB(port::AtomicPointer* p, int i) : last_id_ptr(p), id(i) { }\n\n    static void Run(void* v) {\n      CB* cb = reinterpret_cast<CB*>(v);\n      void* cur = cb->last_id_ptr->NoBarrier_Load();\n      ASSERT_EQ(cb->id-1, reinterpret_cast<uintptr_t>(cur));\n      cb->last_id_ptr->Release_Store(reinterpret_cast<void*>(cb->id));\n    }\n  };\n\n  // Schedule in different order than start time\n  CB cb1(&last_id, 1);\n  CB cb2(&last_id, 2);\n  CB cb3(&last_id, 3);\n  CB cb4(&last_id, 4);\n  env_->Schedule(&CB::Run, &cb1);\n  env_->Schedule(&CB::Run, &cb2);\n  env_->Schedule(&CB::Run, &cb3);\n  env_->Schedule(&CB::Run, &cb4);\n\n  Env::Default()->SleepForMicroseconds(kDelayMicros);\n  void* cur = last_id.Acquire_Load();\n  ASSERT_EQ(4, reinterpret_cast<uintptr_t>(cur));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "4",
            "reinterpret_cast<uintptr_t>(cur)"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<uintptr_t>",
          "args": [
            "cur"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "last_id.Acquire_Load",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [
            "kDelayMicros"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "env_->Schedule",
          "args": [
            "&CB::Run",
            "&cb4"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "Schedule",
          "container": "Win32Env",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "878-883",
          "snippet": "void Win32Env::Schedule( void (*function)(void* arg), void* arg )\n{\n    QueueUserWorkItem(Win32::WorkItemWrapperProc,\n                      new Win32::WorkItemWrapper(function,arg),\n                      WT_EXECUTEDEFAULT);\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  void Win32Env::Schedule( void (*function)(void* arg), void* arg )\n  {\n      QueueUserWorkItem(Win32::WorkItemWrapperProc,\n                        new Win32::WorkItemWrapper(function,arg),\n                        WT_EXECUTEDEFAULT);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cb->last_id_ptr->Release_Store",
          "args": [
            "reinterpret_cast<void*>(cb->id)"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<void*>",
          "args": [
            "cb->id"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "cb->id-1",
            "reinterpret_cast<uintptr_t>(cur)"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<uintptr_t>",
          "args": [
            "cur"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cb->last_id_ptr->NoBarrier_Load",
          "args": [],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<CB*>",
          "args": [
            "v"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n\nTEST(EnvPosixTest, RunMany) {\n  port::AtomicPointer last_id (NULL);\n\n  struct CB {\n    port::AtomicPointer* last_id_ptr;   // Pointer to shared slot\n    uintptr_t id;             // Order# for the execution of this callback\n\n    CB(port::AtomicPointer* p, int i) : last_id_ptr(p), id(i) { }\n\n    static void Run(void* v) {\n      CB* cb = reinterpret_cast<CB*>(v);\n      void* cur = cb->last_id_ptr->NoBarrier_Load();\n      ASSERT_EQ(cb->id-1, reinterpret_cast<uintptr_t>(cur));\n      cb->last_id_ptr->Release_Store(reinterpret_cast<void*>(cb->id));\n    }\n  };\n\n  // Schedule in different order than start time\n  CB cb1(&last_id, 1);\n  CB cb2(&last_id, 2);\n  CB cb3(&last_id, 3);\n  CB cb4(&last_id, 4);\n  env_->Schedule(&CB::Run, &cb1);\n  env_->Schedule(&CB::Run, &cb2);\n  env_->Schedule(&CB::Run, &cb3);\n  env_->Schedule(&CB::Run, &cb4);\n\n  Env::Default()->SleepForMicroseconds(kDelayMicros);\n  void* cur = last_id.Acquire_Load();\n  ASSERT_EQ(4, reinterpret_cast<uintptr_t>(cur));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_test.cc",
    "lines": "28-33",
    "snippet": "TEST(EnvPosixTest, RunImmediately) {\n  port::AtomicPointer called (NULL);\n  env_->Schedule(&SetBool, &called);\n  Env::Default()->SleepForMicroseconds(kDelayMicros);\n  ASSERT_TRUE(called.NoBarrier_Load() != NULL);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "called.NoBarrier_Load() != NULL"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "called.NoBarrier_Load",
          "args": [],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [
            "kDelayMicros"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "env_->Schedule",
          "args": [
            "&SetBool",
            "&called"
          ],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "Schedule",
          "container": "Win32Env",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_win.cc",
          "lines": "878-883",
          "snippet": "void Win32Env::Schedule( void (*function)(void* arg), void* arg )\n{\n    QueueUserWorkItem(Win32::WorkItemWrapperProc,\n                      new Win32::WorkItemWrapper(function,arg),\n                      WT_EXECUTEDEFAULT);\n}",
          "includes": [
            "#include <algorithm>",
            "#include <io.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <cstring>",
            "#include <process.h>",
            "#include <shlwapi.h>",
            "#include \"util/logging.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/env.h\"",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <io.h>\n#include <errno.h>\n#include <stdio.h>\n#include <cstring>\n#include <process.h>\n#include <shlwapi.h>\n#include \"util/logging.h\"\n#include \"leveldb/slice.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n#include <map>\n\nWin32Env {\n  void Win32Env::Schedule( void (*function)(void* arg), void* arg )\n  {\n      QueueUserWorkItem(Win32::WorkItemWrapperProc,\n                        new Win32::WorkItemWrapper(function,arg),\n                        WT_EXECUTEDEFAULT);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n\nTEST(EnvPosixTest, RunImmediately) {\n  port::AtomicPointer called (NULL);\n  env_->Schedule(&SetBool, &called);\n  Env::Default()->SleepForMicroseconds(kDelayMicros);\n  ASSERT_TRUE(called.NoBarrier_Load() != NULL);\n}"
  },
  {
    "function_name": "SetBool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_test.cc",
    "lines": "24-26",
    "snippet": "static void SetBool(void* ptr) {\n  reinterpret_cast<port::AtomicPointer*>(ptr)->NoBarrier_Store(ptr);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reinterpret_cast<port::AtomicPointer*>",
          "args": [
            "ptr"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<port::AtomicPointer*>",
          "args": [
            "ptr"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n\nstatic void SetBool(void* ptr) {\n  reinterpret_cast<port::AtomicPointer*>(ptr)->NoBarrier_Store(ptr);\n}"
  },
  {
    "function_name": "EnvPosixTest",
    "container": "EnvPosixTest",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_test.cc",
    "lines": "21-21",
    "snippet": "EnvPosixTest() : env_(Env::Default()) { }",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/env.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"port/port.h\"\n#include \"leveldb/env.h\"\n\nEnvPosixTest {\n  EnvPosixTest() : env_(Env::Default()) { }\n}"
  }
]