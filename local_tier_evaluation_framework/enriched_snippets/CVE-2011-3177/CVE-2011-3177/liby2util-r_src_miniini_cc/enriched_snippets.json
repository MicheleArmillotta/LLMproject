[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/miniini.cc",
    "lines": "62-76",
    "snippet": "int main() {\n    inifile i = miniini(\"/etc/samba/smb.conf\");\n    // inifile i = miniini(\"f.conf\");\n\n    inifile::const_iterator it = i.begin();\n    for(; it != i.end(); ++it) {\n\tprintf(\"[%s]\\n\", it->first.c_str());\n\tinisection is = it->second;\n\tinisection::const_iterator itt = is.begin();\n\tfor(; itt != is.end(); ++itt)\n\t    printf(\"%s = %s\\n\", itt->first.c_str(), itt->second.c_str());\n    }\n\n    return 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include \"y2util/miniini.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s = %s\\n\"",
            "itt->first.c_str()",
            "itt->second.c_str()"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itt->second.c_str",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "itt->first.c_str",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is.end",
          "args": [],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "194-198",
          "snippet": "YCPListRep::const_iterator\nYCPListRep::end() const\n{\n    return elements.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  YCPListRep::const_iterator\n  YCPListRep::end() const\n  {\n      return elements.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "is.begin",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "187-191",
          "snippet": "YCPListRep::const_iterator\nYCPListRep::begin() const\n{\n    return elements.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  YCPListRep::const_iterator\n  YCPListRep::begin() const\n  {\n      return elements.begin();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"[%s]\\n\"",
            "it->first.c_str()"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it->first.c_str",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "miniini",
          "args": [
            "\"/etc/samba/smb.conf\""
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "miniini",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/miniini.cc",
          "lines": "22-59",
          "snippet": "inifile miniini(const char *file) {\n\n    inifile ret;\n\n    FILE *in = fopen(file, \"r\");\n    if(in == NULL) return ret;\n\n    char line[MAXLINE], *c;\n    char section[MAXLINE], *key;\n\n    while(fgets(line, MAXLINE, in) != NULL) {\n\tc = cutblanks(line);\n\tswitch(*c) {\n\t    /* comments */\n\t    case 0:\n\t    case '#':\n\t    case ';':\n\t    case '/':\n\t\tcontinue;\n\t    /* sections */\n\t    case '[':\n\t\t*c++;\n\t\tc[strlen(c) - 1] = 0;\n\t\tstrncpy(section, cutblanks(c), MAXLINE);\n\t\tbreak;\n\t    /* keys and values */\n\t    default:\n\t\tkey = strchr(c, '=');\n\t\tif(!key) break;\n\t\t*key++ = 0;\n\t\tret[section][cutblanks(c)] = cutblanks(key);\n\t\tbreak;\n\t}\n    }\n\n    fclose(in);\n    return ret;\n}",
          "includes": [
            "#include <string.h>",
            "#include \"y2util/miniini.h\""
          ],
          "macros_used": [
            "#define MAXLINE 1024"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"y2util/miniini.h\"\n\n#define MAXLINE 1024\n\ninifile miniini(const char *file) {\n\n    inifile ret;\n\n    FILE *in = fopen(file, \"r\");\n    if(in == NULL) return ret;\n\n    char line[MAXLINE], *c;\n    char section[MAXLINE], *key;\n\n    while(fgets(line, MAXLINE, in) != NULL) {\n\tc = cutblanks(line);\n\tswitch(*c) {\n\t    /* comments */\n\t    case 0:\n\t    case '#':\n\t    case ';':\n\t    case '/':\n\t\tcontinue;\n\t    /* sections */\n\t    case '[':\n\t\t*c++;\n\t\tc[strlen(c) - 1] = 0;\n\t\tstrncpy(section, cutblanks(c), MAXLINE);\n\t\tbreak;\n\t    /* keys and values */\n\t    default:\n\t\tkey = strchr(c, '=');\n\t\tif(!key) break;\n\t\t*key++ = 0;\n\t\tret[section][cutblanks(c)] = cutblanks(key);\n\t\tbreak;\n\t}\n    }\n\n    fclose(in);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"y2util/miniini.h\"\n\nint main() {\n    inifile i = miniini(\"/etc/samba/smb.conf\");\n    // inifile i = miniini(\"f.conf\");\n\n    inifile::const_iterator it = i.begin();\n    for(; it != i.end(); ++it) {\n\tprintf(\"[%s]\\n\", it->first.c_str());\n\tinisection is = it->second;\n\tinisection::const_iterator itt = is.begin();\n\tfor(; itt != is.end(); ++itt)\n\t    printf(\"%s = %s\\n\", itt->first.c_str(), itt->second.c_str());\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "miniini",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/miniini.cc",
    "lines": "22-59",
    "snippet": "inifile miniini(const char *file) {\n\n    inifile ret;\n\n    FILE *in = fopen(file, \"r\");\n    if(in == NULL) return ret;\n\n    char line[MAXLINE], *c;\n    char section[MAXLINE], *key;\n\n    while(fgets(line, MAXLINE, in) != NULL) {\n\tc = cutblanks(line);\n\tswitch(*c) {\n\t    /* comments */\n\t    case 0:\n\t    case '#':\n\t    case ';':\n\t    case '/':\n\t\tcontinue;\n\t    /* sections */\n\t    case '[':\n\t\t*c++;\n\t\tc[strlen(c) - 1] = 0;\n\t\tstrncpy(section, cutblanks(c), MAXLINE);\n\t\tbreak;\n\t    /* keys and values */\n\t    default:\n\t\tkey = strchr(c, '=');\n\t\tif(!key) break;\n\t\t*key++ = 0;\n\t\tret[section][cutblanks(c)] = cutblanks(key);\n\t\tbreak;\n\t}\n    }\n\n    fclose(in);\n    return ret;\n}",
    "includes": [
      "#include <string.h>",
      "#include \"y2util/miniini.h\""
    ],
    "macros_used": [
      "#define MAXLINE 1024"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "in"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cutblanks",
          "args": [
            "key"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cutblanks",
          "args": [
            "c"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "c",
            "'='"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "section",
            "cutblanks(c)",
            "MAXLINE"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cutblanks",
          "args": [
            "c"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "c"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cutblanks",
          "args": [
            "line"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fgets",
          "args": [
            "line",
            "MAXLINE",
            "in"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "file",
            "\"r\""
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"y2util/miniini.h\"\n\n#define MAXLINE 1024\n\ninifile miniini(const char *file) {\n\n    inifile ret;\n\n    FILE *in = fopen(file, \"r\");\n    if(in == NULL) return ret;\n\n    char line[MAXLINE], *c;\n    char section[MAXLINE], *key;\n\n    while(fgets(line, MAXLINE, in) != NULL) {\n\tc = cutblanks(line);\n\tswitch(*c) {\n\t    /* comments */\n\t    case 0:\n\t    case '#':\n\t    case ';':\n\t    case '/':\n\t\tcontinue;\n\t    /* sections */\n\t    case '[':\n\t\t*c++;\n\t\tc[strlen(c) - 1] = 0;\n\t\tstrncpy(section, cutblanks(c), MAXLINE);\n\t\tbreak;\n\t    /* keys and values */\n\t    default:\n\t\tkey = strchr(c, '=');\n\t\tif(!key) break;\n\t\t*key++ = 0;\n\t\tret[section][cutblanks(c)] = cutblanks(key);\n\t\tbreak;\n\t}\n    }\n\n    fclose(in);\n    return ret;\n}"
  }
]