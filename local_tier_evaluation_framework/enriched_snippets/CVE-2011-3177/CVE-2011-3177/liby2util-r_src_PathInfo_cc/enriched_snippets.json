[
  {
    "function_name": "zipType",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "718-739",
    "snippet": "PathInfo::ZIP_TYPE PathInfo::zipType( const Pathname & file )\n{\n  ZIP_TYPE ret = ZT_NONE;\n\n  int fd = open( file.asString().c_str(), O_RDONLY );\n\n  if ( fd != -1 ) {\n    const int magicSize = 3;\n    unsigned char magic[magicSize];\n    memset( magic, 0, magicSize );\n    if ( read( fd, magic, magicSize ) == magicSize ) {\n      if ( magic[0] == 0037 && magic[1] == 0213 ) {\n\tret = ZT_GZ;\n      } else if ( magic[0] == 'B' && magic[1] == 'Z' && magic[2] == 'h' ) {\n\tret = ZT_BZ2;\n      }\n    }\n    close( fd );\n  }\n\n  return ret;\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "fd",
            "magic",
            "magicSize"
          ],
          "line": 728
        },
        "resolved": true,
        "details": {
          "function_name": "readdir",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "477-506",
          "snippet": "int PathInfo::readdir( std::list<std::string> & retlist,\n\t\t       const Pathname & path, bool dots )\n{\n  retlist.clear();\n\n  DBG << \"readdir \" << path << ' ';\n\n  DIR * dir = ::opendir( path.asString().c_str() );\n  if ( ! dir ) {\n    return _Log_Result( errno );\n  }\n\n  struct dirent *entry;\n  while ( (entry = ::readdir( dir )) != 0 ) {\n\n    if ( entry->d_name[0] == '.' ) {\n      if ( !dots )\n\tcontinue;\n      if ( entry->d_name[1] == '\\0'\n\t   || (    entry->d_name[1] == '.'\n\t\t&& entry->d_name[2] == '\\0' ) )\n\tcontinue;\n    }\n    retlist.push_back( entry->d_name );\n  }\n\n  ::closedir( dir );\n\n  return _Log_Result( 0 );\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::readdir( std::list<std::string> & retlist,\n  \t\t       const Pathname & path, bool dots )\n  {\n    retlist.clear();\n  \n    DBG << \"readdir \" << path << ' ';\n  \n    DIR * dir = ::opendir( path.asString().c_str() );\n    if ( ! dir ) {\n      return _Log_Result( errno );\n    }\n  \n    struct dirent *entry;\n    while ( (entry = ::readdir( dir )) != 0 ) {\n  \n      if ( entry->d_name[0] == '.' ) {\n        if ( !dots )\n  \tcontinue;\n        if ( entry->d_name[1] == '\\0'\n  \t   || (    entry->d_name[1] == '.'\n  \t\t&& entry->d_name[2] == '\\0' ) )\n  \tcontinue;\n      }\n      retlist.push_back( entry->d_name );\n    }\n  \n    ::closedir( dir );\n  \n    return _Log_Result( 0 );\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "magic",
            "0",
            "magicSize"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "file.asString().c_str()",
            "O_RDONLY"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file.asString",
          "args": [],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  PathInfo::ZIP_TYPE PathInfo::zipType( const Pathname & file )\n  {\n    ZIP_TYPE ret = ZT_NONE;\n  \n    int fd = open( file.asString().c_str(), O_RDONLY );\n  \n    if ( fd != -1 ) {\n      const int magicSize = 3;\n      unsigned char magic[magicSize];\n      memset( magic, 0, magicSize );\n      if ( read( fd, magic, magicSize ) == magicSize ) {\n        if ( magic[0] == 0037 && magic[1] == 0213 ) {\n  \tret = ZT_GZ;\n        } else if ( magic[0] == 'B' && magic[1] == 'Z' && magic[2] == 'h' ) {\n  \tret = ZT_BZ2;\n        }\n      }\n      close( fd );\n    }\n  \n    return ret;\n  }\n}"
  },
  {
    "function_name": "chmod",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "703-710",
    "snippet": "int PathInfo::chmod( const Pathname & path, mode_t mode )\n{\n  DBG << \"chmod \" << path << ' ' << stringutil::octstring( mode );\n  if ( ::chmod( path.asString().c_str(), mode ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "0"
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "_Log_Result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "272-278",
          "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "::chmod",
          "args": [
            "path.asString().c_str()",
            "mode"
          ],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "chmod",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "703-710",
          "snippet": "int PathInfo::chmod( const Pathname & path, mode_t mode )\n{\n  DBG << \"chmod \" << path << ' ' << stringutil::octstring( mode );\n  if ( ::chmod( path.asString().c_str(), mode ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "path.asString",
          "args": [],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "stringutil::octstring",
          "args": [
            "mode"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "octstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/stringutil.h",
          "lines": "152-152",
          "snippet": "inline std::string octstring( unsigned long long n, int w = 0 ) { return form( \"%#0*llo\",  w, n ); }",
          "includes": [
            "#include <list>",
            "#include <string>",
            "#include <vector>",
            "#include <iosfwd>",
            "#include <cstdlib>",
            "#include <cstdarg>",
            "#include <cstdio>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <string>\n#include <vector>\n#include <iosfwd>\n#include <cstdlib>\n#include <cstdarg>\n#include <cstdio>\n\ninline std::string octstring( unsigned long long n, int w = 0 ) { return form( \"%#0*llo\",  w, n ); }"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::chmod( const Pathname & path, mode_t mode )\n  {\n    DBG << \"chmod \" << path << ' ' << stringutil::octstring( mode );\n    if ( ::chmod( path.asString().c_str(), mode ) == -1 ) {\n      return _Log_Result( errno );\n    }\n    return _Log_Result( 0 );\n  }\n}"
  },
  {
    "function_name": "erase",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "683-695",
    "snippet": "int PathInfo::erase( const Pathname & path )\n{\n  int res = 0;\n  PathInfo p( path, LSTAT );\n  if ( p.isExist() )\n    {\n      if ( p.isDir() )\n        res = PathInfo::recursive_rmdir( path );\n      else\n        res = PathInfo::unlink( path );\n    }\n  return res;\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PathInfo::unlink",
          "args": [
            "path"
          ],
          "line": 692
        },
        "resolved": true,
        "details": {
          "function_name": "unlink",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "541-548",
          "snippet": "int PathInfo::unlink( const Pathname & path )\n{\n  DBG << \"unlink \" << path;\n  if ( ::unlink( path.asString().c_str() ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::unlink( const Pathname & path )\n  {\n    DBG << \"unlink \" << path;\n    if ( ::unlink( path.asString().c_str() ) == -1 ) {\n      return _Log_Result( errno );\n    }\n    return _Log_Result( 0 );\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "PathInfo::recursive_rmdir",
          "args": [
            "path"
          ],
          "line": 690
        },
        "resolved": true,
        "details": {
          "function_name": "recursive_rmdir",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "365-393",
          "snippet": "int PathInfo::recursive_rmdir( const Pathname & path )\n{\n  DBG << \"recursive_rmdir \" << path << ' ';\n  PathInfo p( path );\n\n  if ( !p.isExist() ) {\n    return _Log_Result( 0 );\n  }\n\n  if ( !p.isDir() ) {\n    return _Log_Result( ENOTDIR );\n  }\n\n  const char *const argv[] = {\n    \"/bin/rm\",\n    \"-rf\",\n    \"--preserve-root\",\n    \"--\",\n    path.asString().c_str(),\n    NULL\n  };\n\n  ExternalProgram prog( argv, ExternalProgram::Stderr_To_Stdout );\n  for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n    DBG << \"  \" << output;\n  }\n  int ret = prog.close();\n  return _Log_Result( ret, \"returned\" );\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::recursive_rmdir( const Pathname & path )\n  {\n    DBG << \"recursive_rmdir \" << path << ' ';\n    PathInfo p( path );\n  \n    if ( !p.isExist() ) {\n      return _Log_Result( 0 );\n    }\n  \n    if ( !p.isDir() ) {\n      return _Log_Result( ENOTDIR );\n    }\n  \n    const char *const argv[] = {\n      \"/bin/rm\",\n      \"-rf\",\n      \"--preserve-root\",\n      \"--\",\n      path.asString().c_str(),\n      NULL\n    };\n  \n    ExternalProgram prog( argv, ExternalProgram::Stderr_To_Stdout );\n    for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n      DBG << \"  \" << output;\n    }\n    int ret = prog.close();\n    return _Log_Result( ret, \"returned\" );\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p.isDir",
          "args": [],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "isDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "389-389",
          "snippet": "bool   isDir ()  const { return S_ISDIR( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isDir ()  const { return S_ISDIR( _mode ); }"
        }
      },
      {
        "call_info": {
          "callee": "p.isExist",
          "args": [],
          "line": 687
        },
        "resolved": true,
        "details": {
          "function_name": "isExist",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "109-109",
          "snippet": "bool   isExist() const { return !error_i; }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nPathInfo {\n  bool   isExist() const { return !error_i; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::erase( const Pathname & path )\n  {\n    int res = 0;\n    PathInfo p( path, LSTAT );\n    if ( p.isExist() )\n      {\n        if ( p.isDir() )\n          res = PathInfo::recursive_rmdir( path );\n        else\n          res = PathInfo::unlink( path );\n      }\n    return res;\n  }\n}"
  },
  {
    "function_name": "copy_file2dir",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "646-673",
    "snippet": "int PathInfo::copy_file2dir( const Pathname & file, const Pathname & dest )\n{\n  DBG << \"copy_file2dir \" << file << \" -> \" << dest << ' ';\n\n  PathInfo sp( file );\n  if ( !sp.isFile() ) {\n    return _Log_Result( EINVAL );\n  }\n\n  PathInfo dp( dest );\n  if ( !dp.isDir() ) {\n    return _Log_Result( ENOTDIR );\n  }\n\n  const char *const argv[] = {\n    \"/bin/cp\",\n    \"--\",\n    file.asString().c_str(),\n    dest.asString().c_str(),\n    NULL\n  };\n  ExternalProgram prog( argv, ExternalProgram::Stderr_To_Stdout );\n  for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n    DBG << \"  \" << output;\n  }\n  int ret = prog.close();\n  return _Log_Result( ret, \"returned\" );\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "ret",
            "\"returned\""
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prog.close",
          "args": [],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "close",
          "container": "ExternalProgram",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/ExternalProgram.cc",
          "lines": "325-351",
          "snippet": "int\nExternalProgram::close()\n{\n    if (pid > 0)\n    {\n\tExternalDataSource::close();\n\t// Wait for child to exit\n\tint ret;\n        int status = 0;\n\tdo\n\t{\n\t    ret = waitpid(pid, &status, 0);\n\t}\n\twhile (ret == -1 && errno == EINTR);\n\n\tif (ret != -1)\n\t{\n\t    status = checkStatus( status );\n\t}\n        pid = -1;\n        return status;\n    }\n    else\n    {\n        return _exitStatus;\n    }\n}",
          "includes": [
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <cstring> // strsignal",
            "#include <termios.h> // tcsetattr()",
            "#include <stdlib.h> // setenv",
            "#include <pty.h> // openpty",
            "#include <fcntl.h>",
            "#include <sys/wait.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <signal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/ExternalProgram.h>\n#include <y2util/Y2SLog.h>\n#include <cstring> // strsignal\n#include <termios.h> // tcsetattr()\n#include <stdlib.h> // setenv\n#include <pty.h> // openpty\n#include <fcntl.h>\n#include <sys/wait.h>\n#include <unistd.h>\n#include <errno.h>\n#include <signal.h>\n\nExternalProgram {\n  int\n  ExternalProgram::close()\n  {\n      if (pid > 0)\n      {\n  \tExternalDataSource::close();\n  \t// Wait for child to exit\n  \tint ret;\n          int status = 0;\n  \tdo\n  \t{\n  \t    ret = waitpid(pid, &status, 0);\n  \t}\n  \twhile (ret == -1 && errno == EINTR);\n  \n  \tif (ret != -1)\n  \t{\n  \t    status = checkStatus( status );\n  \t}\n          pid = -1;\n          return status;\n      }\n      else\n      {\n          return _exitStatus;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "prog.receiveLine",
          "args": [],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "receiveLine",
          "container": "ExternalDataSource",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/ExternalDataSource.cc",
          "lines": "143-156",
          "snippet": "string\nExternalDataSource::receiveLine()\n{\n    if (inputfile)\n    {\n\tssize_t nread = getline (&linebuffer, &linebuffer_size, inputfile);\n\tif (nread == -1)\n\t    return \"\";\n\telse\n\t    return string (linebuffer, nread);\n    }\n    else\n\treturn \"\";\n}",
          "includes": [
            "#include <y2util/ExternalDataSource.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <sys/wait.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <signal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/ExternalDataSource.h>\n#include <y2util/Y2SLog.h>\n#include <string>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <sys/wait.h>\n#include <unistd.h>\n#include <errno.h>\n#include <signal.h>\n\nExternalDataSource {\n  string\n  ExternalDataSource::receiveLine()\n  {\n      if (inputfile)\n      {\n  \tssize_t nread = getline (&linebuffer, &linebuffer_size, inputfile);\n  \tif (nread == -1)\n  \t    return \"\";\n  \telse\n  \t    return string (linebuffer, nread);\n      }\n      else\n  \treturn \"\";\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.length",
          "args": [],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dest.asString",
          "args": [],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "ENOTDIR"
          ],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "_Log_Result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "272-278",
          "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dp.isDir",
          "args": [],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "isDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "389-389",
          "snippet": "bool   isDir ()  const { return S_ISDIR( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isDir ()  const { return S_ISDIR( _mode ); }"
        }
      },
      {
        "call_info": {
          "callee": "sp.isFile",
          "args": [],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "isFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "388-388",
          "snippet": "bool   isFile()  const { return S_ISREG( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isFile()  const { return S_ISREG( _mode ); }"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::copy_file2dir( const Pathname & file, const Pathname & dest )\n  {\n    DBG << \"copy_file2dir \" << file << \" -> \" << dest << ' ';\n  \n    PathInfo sp( file );\n    if ( !sp.isFile() ) {\n      return _Log_Result( EINVAL );\n    }\n  \n    PathInfo dp( dest );\n    if ( !dp.isDir() ) {\n      return _Log_Result( ENOTDIR );\n    }\n  \n    const char *const argv[] = {\n      \"/bin/cp\",\n      \"--\",\n      file.asString().c_str(),\n      dest.asString().c_str(),\n      NULL\n    };\n    ExternalProgram prog( argv, ExternalProgram::Stderr_To_Stdout );\n    for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n      DBG << \"  \" << output;\n    }\n    int ret = prog.close();\n    return _Log_Result( ret, \"returned\" );\n  }\n}"
  },
  {
    "function_name": "hardlink",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "629-636",
    "snippet": "int PathInfo::hardlink( const Pathname & oldpath, const Pathname & newpath )\n{\n  DBG << \"hardlink \" << newpath << \" -> \" << oldpath;\n  if ( ::link( oldpath.asString().c_str(), newpath.asString().c_str() ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "0"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "_Log_Result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "272-278",
          "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "::link",
          "args": [
            "oldpath.asString().c_str()",
            "newpath.asString().c_str()"
          ],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "hardlink",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "629-636",
          "snippet": "int PathInfo::hardlink( const Pathname & oldpath, const Pathname & newpath )\n{\n  DBG << \"hardlink \" << newpath << \" -> \" << oldpath;\n  if ( ::link( oldpath.asString().c_str(), newpath.asString().c_str() ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "newpath.asString",
          "args": [],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::hardlink( const Pathname & oldpath, const Pathname & newpath )\n  {\n    DBG << \"hardlink \" << newpath << \" -> \" << oldpath;\n    if ( ::link( oldpath.asString().c_str(), newpath.asString().c_str() ) == -1 ) {\n      return _Log_Result( errno );\n    }\n    return _Log_Result( 0 );\n  }\n}"
  },
  {
    "function_name": "symlink",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "612-619",
    "snippet": "int PathInfo::symlink( const Pathname & oldpath, const Pathname & newpath )\n{\n  DBG << \"symlink \" << newpath << \" -> \" << oldpath;\n  if ( ::symlink( oldpath.asString().c_str(), newpath.asString().c_str() ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "0"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "_Log_Result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "272-278",
          "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "::symlink",
          "args": [
            "oldpath.asString().c_str()",
            "newpath.asString().c_str()"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "symlink",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "612-619",
          "snippet": "int PathInfo::symlink( const Pathname & oldpath, const Pathname & newpath )\n{\n  DBG << \"symlink \" << newpath << \" -> \" << oldpath;\n  if ( ::symlink( oldpath.asString().c_str(), newpath.asString().c_str() ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "newpath.asString",
          "args": [],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::symlink( const Pathname & oldpath, const Pathname & newpath )\n  {\n    DBG << \"symlink \" << newpath << \" -> \" << oldpath;\n    if ( ::symlink( oldpath.asString().c_str(), newpath.asString().c_str() ) == -1 ) {\n      return _Log_Result( errno );\n    }\n    return _Log_Result( 0 );\n  }\n}"
  },
  {
    "function_name": "copy",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "575-602",
    "snippet": "int PathInfo::copy( const Pathname & file, const Pathname & dest )\n{\n  DBG << \"copy \" << file << \" -> \" << dest << ' ';\n\n  PathInfo sp( file );\n  if ( !sp.isFile() ) {\n    return _Log_Result( EINVAL );\n  }\n\n  PathInfo dp( dest );\n  if ( dp.isDir() ) {\n    return _Log_Result( EISDIR );\n  }\n\n  const char *const argv[] = {\n    \"/bin/cp\",\n    \"--\",\n    file.asString().c_str(),\n    dest.asString().c_str(),\n    NULL\n  };\n  ExternalProgram prog( argv, ExternalProgram::Stderr_To_Stdout );\n  for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n    DBG << \"  \" << output;\n  }\n  int ret = prog.close();\n  return _Log_Result( ret, \"returned\" );\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "ret",
            "\"returned\""
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prog.close",
          "args": [],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "close",
          "container": "ExternalProgram",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/ExternalProgram.cc",
          "lines": "325-351",
          "snippet": "int\nExternalProgram::close()\n{\n    if (pid > 0)\n    {\n\tExternalDataSource::close();\n\t// Wait for child to exit\n\tint ret;\n        int status = 0;\n\tdo\n\t{\n\t    ret = waitpid(pid, &status, 0);\n\t}\n\twhile (ret == -1 && errno == EINTR);\n\n\tif (ret != -1)\n\t{\n\t    status = checkStatus( status );\n\t}\n        pid = -1;\n        return status;\n    }\n    else\n    {\n        return _exitStatus;\n    }\n}",
          "includes": [
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <cstring> // strsignal",
            "#include <termios.h> // tcsetattr()",
            "#include <stdlib.h> // setenv",
            "#include <pty.h> // openpty",
            "#include <fcntl.h>",
            "#include <sys/wait.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <signal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/ExternalProgram.h>\n#include <y2util/Y2SLog.h>\n#include <cstring> // strsignal\n#include <termios.h> // tcsetattr()\n#include <stdlib.h> // setenv\n#include <pty.h> // openpty\n#include <fcntl.h>\n#include <sys/wait.h>\n#include <unistd.h>\n#include <errno.h>\n#include <signal.h>\n\nExternalProgram {\n  int\n  ExternalProgram::close()\n  {\n      if (pid > 0)\n      {\n  \tExternalDataSource::close();\n  \t// Wait for child to exit\n  \tint ret;\n          int status = 0;\n  \tdo\n  \t{\n  \t    ret = waitpid(pid, &status, 0);\n  \t}\n  \twhile (ret == -1 && errno == EINTR);\n  \n  \tif (ret != -1)\n  \t{\n  \t    status = checkStatus( status );\n  \t}\n          pid = -1;\n          return status;\n      }\n      else\n      {\n          return _exitStatus;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "prog.receiveLine",
          "args": [],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "receiveLine",
          "container": "ExternalDataSource",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/ExternalDataSource.cc",
          "lines": "143-156",
          "snippet": "string\nExternalDataSource::receiveLine()\n{\n    if (inputfile)\n    {\n\tssize_t nread = getline (&linebuffer, &linebuffer_size, inputfile);\n\tif (nread == -1)\n\t    return \"\";\n\telse\n\t    return string (linebuffer, nread);\n    }\n    else\n\treturn \"\";\n}",
          "includes": [
            "#include <y2util/ExternalDataSource.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <sys/wait.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <signal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/ExternalDataSource.h>\n#include <y2util/Y2SLog.h>\n#include <string>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <sys/wait.h>\n#include <unistd.h>\n#include <errno.h>\n#include <signal.h>\n\nExternalDataSource {\n  string\n  ExternalDataSource::receiveLine()\n  {\n      if (inputfile)\n      {\n  \tssize_t nread = getline (&linebuffer, &linebuffer_size, inputfile);\n  \tif (nread == -1)\n  \t    return \"\";\n  \telse\n  \t    return string (linebuffer, nread);\n      }\n      else\n  \treturn \"\";\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.length",
          "args": [],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dest.asString",
          "args": [],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "EISDIR"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "_Log_Result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "272-278",
          "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dp.isDir",
          "args": [],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "isDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "389-389",
          "snippet": "bool   isDir ()  const { return S_ISDIR( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isDir ()  const { return S_ISDIR( _mode ); }"
        }
      },
      {
        "call_info": {
          "callee": "sp.isFile",
          "args": [],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "isFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "388-388",
          "snippet": "bool   isFile()  const { return S_ISREG( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isFile()  const { return S_ISREG( _mode ); }"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::copy( const Pathname & file, const Pathname & dest )\n  {\n    DBG << \"copy \" << file << \" -> \" << dest << ' ';\n  \n    PathInfo sp( file );\n    if ( !sp.isFile() ) {\n      return _Log_Result( EINVAL );\n    }\n  \n    PathInfo dp( dest );\n    if ( dp.isDir() ) {\n      return _Log_Result( EISDIR );\n    }\n  \n    const char *const argv[] = {\n      \"/bin/cp\",\n      \"--\",\n      file.asString().c_str(),\n      dest.asString().c_str(),\n      NULL\n    };\n    ExternalProgram prog( argv, ExternalProgram::Stderr_To_Stdout );\n    for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n      DBG << \"  \" << output;\n    }\n    int ret = prog.close();\n    return _Log_Result( ret, \"returned\" );\n  }\n}"
  },
  {
    "function_name": "rename",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "558-565",
    "snippet": "int PathInfo::rename( const Pathname & oldpath, const Pathname & newpath )\n{\n  DBG << \"rename \" << oldpath << \" -> \" << newpath;\n  if ( ::rename( oldpath.asString().c_str(), newpath.asString().c_str() ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "0"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "_Log_Result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "272-278",
          "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "::rename",
          "args": [
            "oldpath.asString().c_str()",
            "newpath.asString().c_str()"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "rename",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "558-565",
          "snippet": "int PathInfo::rename( const Pathname & oldpath, const Pathname & newpath )\n{\n  DBG << \"rename \" << oldpath << \" -> \" << newpath;\n  if ( ::rename( oldpath.asString().c_str(), newpath.asString().c_str() ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "newpath.asString",
          "args": [],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::rename( const Pathname & oldpath, const Pathname & newpath )\n  {\n    DBG << \"rename \" << oldpath << \" -> \" << newpath;\n    if ( ::rename( oldpath.asString().c_str(), newpath.asString().c_str() ) == -1 ) {\n      return _Log_Result( errno );\n    }\n    return _Log_Result( 0 );\n  }\n}"
  },
  {
    "function_name": "unlink",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "541-548",
    "snippet": "int PathInfo::unlink( const Pathname & path )\n{\n  DBG << \"unlink \" << path;\n  if ( ::unlink( path.asString().c_str() ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "0"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "_Log_Result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "272-278",
          "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "::unlink",
          "args": [
            "path.asString().c_str()"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "unlink",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "541-548",
          "snippet": "int PathInfo::unlink( const Pathname & path )\n{\n  DBG << \"unlink \" << path;\n  if ( ::unlink( path.asString().c_str() ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "path.asString",
          "args": [],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::unlink( const Pathname & path )\n  {\n    DBG << \"unlink \" << path;\n    if ( ::unlink( path.asString().c_str() ) == -1 ) {\n      return _Log_Result( errno );\n    }\n    return _Log_Result( 0 );\n  }\n}"
  },
  {
    "function_name": "readdir",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "515-531",
    "snippet": "int PathInfo::readdir( dircontent & retlist, const Pathname & path,\n\t\t       bool dots, Mode statmode )\n{\n  retlist.clear();\n\n  list<string> content;\n  int res = readdir( content, path, dots );\n\n  if ( !res ) {\n    for ( list<string>::const_iterator it = content.begin(); it != content.end(); ++it ) {\n      PathInfo p( path + *it, statmode );\n      retlist.push_back( direntry( *it, p.fileType() ) );\n    }\n  }\n\n  return res;\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "retlist.push_back",
          "args": [
            "direntry( *it, p.fileType() )"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "push_back",
          "container": "LogTail",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/y2log.cc",
          "lines": "649-652",
          "snippet": "void LogTail::push_back (const Data &d)\n{\n    m_impl->push_back (d);\n}",
          "includes": [
            "#include <syslog.h>",
            "#include \"y2util/PathInfo.h\"",
            "#include \"y2util/stringutil.h\"",
            "#include \"y2util/miniini.h\"",
            "#include \"y2util/y2log.h\"",
            "#include <list>",
            "#include <limits>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <pwd.h>",
            "#include <malloc.h>",
            "#include <fcntl.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <syslog.h>\n#include \"y2util/PathInfo.h\"\n#include \"y2util/stringutil.h\"\n#include \"y2util/miniini.h\"\n#include \"y2util/y2log.h\"\n#include <list>\n#include <limits>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <pwd.h>\n#include <malloc.h>\n#include <fcntl.h>\n#include <errno.h>\n\nLogTail {\n  void LogTail::push_back (const Data &d)\n  {\n      m_impl->push_back (d);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "direntry",
          "args": [
            "*it",
            "p.fileType()"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p.fileType",
          "args": [],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "fileType",
          "container": "PathInfo::stat_mode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "212-230",
          "snippet": "PathInfo::file_type PathInfo::stat_mode::fileType() const\n{\n  if ( isFile() )\n    return T_FILE;\n  if ( isDir() )\n    return T_DIR;\n  if ( isLink() )\n    return T_LINK;\n  if ( isChr() )\n    return T_CHARDEV;\n  if ( isBlk() )\n    return T_BLOCKDEV;\n  if ( isFifo() )\n    return T_FIFO;\n  if ( isSock() )\n    return T_SOCKET ;\n\n  return NOT_AVAIL;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  stat_mode {\n    PathInfo::file_type PathInfo::stat_mode::fileType() const\n    {\n      if ( isFile() )\n        return T_FILE;\n      if ( isDir() )\n        return T_DIR;\n      if ( isLink() )\n        return T_LINK;\n      if ( isChr() )\n        return T_CHARDEV;\n      if ( isBlk() )\n        return T_BLOCKDEV;\n      if ( isFifo() )\n        return T_FIFO;\n      if ( isSock() )\n        return T_SOCKET ;\n    \n      return NOT_AVAIL;\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "content.end",
          "args": [],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "content.begin",
          "args": [],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readdir",
          "args": [
            "content",
            "path",
            "dots"
          ],
          "line": 521
        },
        "resolved": true,
        "details": {
          "function_name": "readdir",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "477-506",
          "snippet": "int PathInfo::readdir( std::list<std::string> & retlist,\n\t\t       const Pathname & path, bool dots )\n{\n  retlist.clear();\n\n  DBG << \"readdir \" << path << ' ';\n\n  DIR * dir = ::opendir( path.asString().c_str() );\n  if ( ! dir ) {\n    return _Log_Result( errno );\n  }\n\n  struct dirent *entry;\n  while ( (entry = ::readdir( dir )) != 0 ) {\n\n    if ( entry->d_name[0] == '.' ) {\n      if ( !dots )\n\tcontinue;\n      if ( entry->d_name[1] == '\\0'\n\t   || (    entry->d_name[1] == '.'\n\t\t&& entry->d_name[2] == '\\0' ) )\n\tcontinue;\n    }\n    retlist.push_back( entry->d_name );\n  }\n\n  ::closedir( dir );\n\n  return _Log_Result( 0 );\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "retlist.clear",
          "args": [],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "461-461",
          "snippet": "void clear() { _devino.clear(); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nvoid clear() { _devino.clear(); }"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::readdir( dircontent & retlist, const Pathname & path,\n  \t\t       bool dots, Mode statmode )\n  {\n    retlist.clear();\n  \n    list<string> content;\n    int res = readdir( content, path, dots );\n  \n    if ( !res ) {\n      for ( list<string>::const_iterator it = content.begin(); it != content.end(); ++it ) {\n        PathInfo p( path + *it, statmode );\n        retlist.push_back( direntry( *it, p.fileType() ) );\n      }\n    }\n  \n    return res;\n  }\n}"
  },
  {
    "function_name": "readdir",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "477-506",
    "snippet": "int PathInfo::readdir( std::list<std::string> & retlist,\n\t\t       const Pathname & path, bool dots )\n{\n  retlist.clear();\n\n  DBG << \"readdir \" << path << ' ';\n\n  DIR * dir = ::opendir( path.asString().c_str() );\n  if ( ! dir ) {\n    return _Log_Result( errno );\n  }\n\n  struct dirent *entry;\n  while ( (entry = ::readdir( dir )) != 0 ) {\n\n    if ( entry->d_name[0] == '.' ) {\n      if ( !dots )\n\tcontinue;\n      if ( entry->d_name[1] == '\\0'\n\t   || (    entry->d_name[1] == '.'\n\t\t&& entry->d_name[2] == '\\0' ) )\n\tcontinue;\n    }\n    retlist.push_back( entry->d_name );\n  }\n\n  ::closedir( dir );\n\n  return _Log_Result( 0 );\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "0"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "_Log_Result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "272-278",
          "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "::closedir",
          "args": [
            "dir"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "retlist.push_back",
          "args": [
            "entry->d_name"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "push_back",
          "container": "LogTail",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/y2log.cc",
          "lines": "649-652",
          "snippet": "void LogTail::push_back (const Data &d)\n{\n    m_impl->push_back (d);\n}",
          "includes": [
            "#include <syslog.h>",
            "#include \"y2util/PathInfo.h\"",
            "#include \"y2util/stringutil.h\"",
            "#include \"y2util/miniini.h\"",
            "#include \"y2util/y2log.h\"",
            "#include <list>",
            "#include <limits>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <pwd.h>",
            "#include <malloc.h>",
            "#include <fcntl.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <syslog.h>\n#include \"y2util/PathInfo.h\"\n#include \"y2util/stringutil.h\"\n#include \"y2util/miniini.h\"\n#include \"y2util/y2log.h\"\n#include <list>\n#include <limits>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <pwd.h>\n#include <malloc.h>\n#include <fcntl.h>\n#include <errno.h>\n\nLogTail {\n  void LogTail::push_back (const Data &d)\n  {\n      m_impl->push_back (d);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "::readdir",
          "args": [
            "dir"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::opendir",
          "args": [
            "path.asString().c_str()"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.asString",
          "args": [],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "retlist.clear",
          "args": [],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "461-461",
          "snippet": "void clear() { _devino.clear(); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nvoid clear() { _devino.clear(); }"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::readdir( std::list<std::string> & retlist,\n  \t\t       const Pathname & path, bool dots )\n  {\n    retlist.clear();\n  \n    DBG << \"readdir \" << path << ' ';\n  \n    DIR * dir = ::opendir( path.asString().c_str() );\n    if ( ! dir ) {\n      return _Log_Result( errno );\n    }\n  \n    struct dirent *entry;\n    while ( (entry = ::readdir( dir )) != 0 ) {\n  \n      if ( entry->d_name[0] == '.' ) {\n        if ( !dots )\n  \tcontinue;\n        if ( entry->d_name[1] == '\\0'\n  \t   || (    entry->d_name[1] == '.'\n  \t\t&& entry->d_name[2] == '\\0' ) )\n  \tcontinue;\n      }\n      retlist.push_back( entry->d_name );\n    }\n  \n    ::closedir( dir );\n  \n    return _Log_Result( 0 );\n  }\n}"
  },
  {
    "function_name": "copy_dir",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "433-467",
    "snippet": "int PathInfo::copy_dir( const Pathname & srcpath, const Pathname & destpath )\n{\n  DBG << \"copy_dir \" << srcpath << \" -> \" << destpath << ' ';\n\n  PathInfo sp( srcpath );\n  if ( !sp.isDir() ) {\n    return _Log_Result( ENOTDIR );\n  }\n\n  PathInfo dp( destpath );\n  if ( !dp.isDir() ) {\n    return _Log_Result( ENOTDIR );\n  }\n\n  PathInfo tp( destpath + srcpath.basename() );\n  if ( tp.isExist() ) {\n    return _Log_Result( EEXIST );\n  }\n\n\n  const char *const argv[] = {\n    \"/bin/cp\",\n    \"-dR\",\n    \"--\",\n    srcpath.asString().c_str(),\n    destpath.asString().c_str(),\n    NULL\n  };\n  ExternalProgram prog( argv, ExternalProgram::Stderr_To_Stdout );\n  for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n    DBG << \"  \" << output;\n  }\n  int ret = prog.close();\n  return _Log_Result( ret, \"returned\" );\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "ret",
            "\"returned\""
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prog.close",
          "args": [],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "close",
          "container": "ExternalProgram",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/ExternalProgram.cc",
          "lines": "325-351",
          "snippet": "int\nExternalProgram::close()\n{\n    if (pid > 0)\n    {\n\tExternalDataSource::close();\n\t// Wait for child to exit\n\tint ret;\n        int status = 0;\n\tdo\n\t{\n\t    ret = waitpid(pid, &status, 0);\n\t}\n\twhile (ret == -1 && errno == EINTR);\n\n\tif (ret != -1)\n\t{\n\t    status = checkStatus( status );\n\t}\n        pid = -1;\n        return status;\n    }\n    else\n    {\n        return _exitStatus;\n    }\n}",
          "includes": [
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <cstring> // strsignal",
            "#include <termios.h> // tcsetattr()",
            "#include <stdlib.h> // setenv",
            "#include <pty.h> // openpty",
            "#include <fcntl.h>",
            "#include <sys/wait.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <signal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/ExternalProgram.h>\n#include <y2util/Y2SLog.h>\n#include <cstring> // strsignal\n#include <termios.h> // tcsetattr()\n#include <stdlib.h> // setenv\n#include <pty.h> // openpty\n#include <fcntl.h>\n#include <sys/wait.h>\n#include <unistd.h>\n#include <errno.h>\n#include <signal.h>\n\nExternalProgram {\n  int\n  ExternalProgram::close()\n  {\n      if (pid > 0)\n      {\n  \tExternalDataSource::close();\n  \t// Wait for child to exit\n  \tint ret;\n          int status = 0;\n  \tdo\n  \t{\n  \t    ret = waitpid(pid, &status, 0);\n  \t}\n  \twhile (ret == -1 && errno == EINTR);\n  \n  \tif (ret != -1)\n  \t{\n  \t    status = checkStatus( status );\n  \t}\n          pid = -1;\n          return status;\n      }\n      else\n      {\n          return _exitStatus;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "prog.receiveLine",
          "args": [],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "receiveLine",
          "container": "ExternalDataSource",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/ExternalDataSource.cc",
          "lines": "143-156",
          "snippet": "string\nExternalDataSource::receiveLine()\n{\n    if (inputfile)\n    {\n\tssize_t nread = getline (&linebuffer, &linebuffer_size, inputfile);\n\tif (nread == -1)\n\t    return \"\";\n\telse\n\t    return string (linebuffer, nread);\n    }\n    else\n\treturn \"\";\n}",
          "includes": [
            "#include <y2util/ExternalDataSource.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <sys/wait.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <signal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/ExternalDataSource.h>\n#include <y2util/Y2SLog.h>\n#include <string>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <sys/wait.h>\n#include <unistd.h>\n#include <errno.h>\n#include <signal.h>\n\nExternalDataSource {\n  string\n  ExternalDataSource::receiveLine()\n  {\n      if (inputfile)\n      {\n  \tssize_t nread = getline (&linebuffer, &linebuffer_size, inputfile);\n  \tif (nread == -1)\n  \t    return \"\";\n  \telse\n  \t    return string (linebuffer, nread);\n      }\n      else\n  \treturn \"\";\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.length",
          "args": [],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "destpath.asString",
          "args": [],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "EEXIST"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "_Log_Result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "272-278",
          "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "tp.isExist",
          "args": [],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "isExist",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "109-109",
          "snippet": "bool   isExist() const { return !error_i; }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nPathInfo {\n  bool   isExist() const { return !error_i; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "srcpath.basename",
          "args": [],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "basename",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "71-71",
          "snippet": "std::string basename()      const { return basename( *this ); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  std::string basename()      const { return basename( *this ); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dp.isDir",
          "args": [],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "isDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "389-389",
          "snippet": "bool   isDir ()  const { return S_ISDIR( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isDir ()  const { return S_ISDIR( _mode ); }"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::copy_dir( const Pathname & srcpath, const Pathname & destpath )\n  {\n    DBG << \"copy_dir \" << srcpath << \" -> \" << destpath << ' ';\n  \n    PathInfo sp( srcpath );\n    if ( !sp.isDir() ) {\n      return _Log_Result( ENOTDIR );\n    }\n  \n    PathInfo dp( destpath );\n    if ( !dp.isDir() ) {\n      return _Log_Result( ENOTDIR );\n    }\n  \n    PathInfo tp( destpath + srcpath.basename() );\n    if ( tp.isExist() ) {\n      return _Log_Result( EEXIST );\n    }\n  \n  \n    const char *const argv[] = {\n      \"/bin/cp\",\n      \"-dR\",\n      \"--\",\n      srcpath.asString().c_str(),\n      destpath.asString().c_str(),\n      NULL\n    };\n    ExternalProgram prog( argv, ExternalProgram::Stderr_To_Stdout );\n    for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n      DBG << \"  \" << output;\n    }\n    int ret = prog.close();\n    return _Log_Result( ret, \"returned\" );\n  }\n}"
  },
  {
    "function_name": "clean_dir",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "403-423",
    "snippet": "int PathInfo::clean_dir( const Pathname & path )\n{\n  DBG << \"clean_dir \" << path << ' ';\n  PathInfo p( path );\n\n  if ( !p.isExist() ) {\n    return _Log_Result( 0 );\n  }\n\n  if ( !p.isDir() ) {\n    return _Log_Result( ENOTDIR );\n  }\n\n  string cmd( stringutil::form( \"cd '%s' && rm -rf --preserve-root -- *\", path.asString().c_str() ) );\n  ExternalProgram prog( cmd, ExternalProgram::Stderr_To_Stdout );\n  for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n    DBG << \"  \" << output;\n  }\n  int ret = prog.close();\n  return _Log_Result( ret, \"returned\" );\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "ret",
            "\"returned\""
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prog.close",
          "args": [],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "close",
          "container": "ExternalProgram",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/ExternalProgram.cc",
          "lines": "325-351",
          "snippet": "int\nExternalProgram::close()\n{\n    if (pid > 0)\n    {\n\tExternalDataSource::close();\n\t// Wait for child to exit\n\tint ret;\n        int status = 0;\n\tdo\n\t{\n\t    ret = waitpid(pid, &status, 0);\n\t}\n\twhile (ret == -1 && errno == EINTR);\n\n\tif (ret != -1)\n\t{\n\t    status = checkStatus( status );\n\t}\n        pid = -1;\n        return status;\n    }\n    else\n    {\n        return _exitStatus;\n    }\n}",
          "includes": [
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <cstring> // strsignal",
            "#include <termios.h> // tcsetattr()",
            "#include <stdlib.h> // setenv",
            "#include <pty.h> // openpty",
            "#include <fcntl.h>",
            "#include <sys/wait.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <signal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/ExternalProgram.h>\n#include <y2util/Y2SLog.h>\n#include <cstring> // strsignal\n#include <termios.h> // tcsetattr()\n#include <stdlib.h> // setenv\n#include <pty.h> // openpty\n#include <fcntl.h>\n#include <sys/wait.h>\n#include <unistd.h>\n#include <errno.h>\n#include <signal.h>\n\nExternalProgram {\n  int\n  ExternalProgram::close()\n  {\n      if (pid > 0)\n      {\n  \tExternalDataSource::close();\n  \t// Wait for child to exit\n  \tint ret;\n          int status = 0;\n  \tdo\n  \t{\n  \t    ret = waitpid(pid, &status, 0);\n  \t}\n  \twhile (ret == -1 && errno == EINTR);\n  \n  \tif (ret != -1)\n  \t{\n  \t    status = checkStatus( status );\n  \t}\n          pid = -1;\n          return status;\n      }\n      else\n      {\n          return _exitStatus;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "prog.receiveLine",
          "args": [],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "receiveLine",
          "container": "ExternalDataSource",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/ExternalDataSource.cc",
          "lines": "143-156",
          "snippet": "string\nExternalDataSource::receiveLine()\n{\n    if (inputfile)\n    {\n\tssize_t nread = getline (&linebuffer, &linebuffer_size, inputfile);\n\tif (nread == -1)\n\t    return \"\";\n\telse\n\t    return string (linebuffer, nread);\n    }\n    else\n\treturn \"\";\n}",
          "includes": [
            "#include <y2util/ExternalDataSource.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <sys/wait.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <signal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/ExternalDataSource.h>\n#include <y2util/Y2SLog.h>\n#include <string>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <sys/wait.h>\n#include <unistd.h>\n#include <errno.h>\n#include <signal.h>\n\nExternalDataSource {\n  string\n  ExternalDataSource::receiveLine()\n  {\n      if (inputfile)\n      {\n  \tssize_t nread = getline (&linebuffer, &linebuffer_size, inputfile);\n  \tif (nread == -1)\n  \t    return \"\";\n  \telse\n  \t    return string (linebuffer, nread);\n      }\n      else\n  \treturn \"\";\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.length",
          "args": [],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "stringutil::form",
          "args": [
            "\"cd '%s' && rm -rf --preserve-root -- *\"",
            "path.asString().c_str()"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.asString",
          "args": [],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "ENOTDIR"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "_Log_Result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "272-278",
          "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p.isDir",
          "args": [],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "isDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "389-389",
          "snippet": "bool   isDir ()  const { return S_ISDIR( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isDir ()  const { return S_ISDIR( _mode ); }"
        }
      },
      {
        "call_info": {
          "callee": "p.isExist",
          "args": [],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "isExist",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "109-109",
          "snippet": "bool   isExist() const { return !error_i; }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nPathInfo {\n  bool   isExist() const { return !error_i; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::clean_dir( const Pathname & path )\n  {\n    DBG << \"clean_dir \" << path << ' ';\n    PathInfo p( path );\n  \n    if ( !p.isExist() ) {\n      return _Log_Result( 0 );\n    }\n  \n    if ( !p.isDir() ) {\n      return _Log_Result( ENOTDIR );\n    }\n  \n    string cmd( stringutil::form( \"cd '%s' && rm -rf --preserve-root -- *\", path.asString().c_str() ) );\n    ExternalProgram prog( cmd, ExternalProgram::Stderr_To_Stdout );\n    for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n      DBG << \"  \" << output;\n    }\n    int ret = prog.close();\n    return _Log_Result( ret, \"returned\" );\n  }\n}"
  },
  {
    "function_name": "recursive_rmdir",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "365-393",
    "snippet": "int PathInfo::recursive_rmdir( const Pathname & path )\n{\n  DBG << \"recursive_rmdir \" << path << ' ';\n  PathInfo p( path );\n\n  if ( !p.isExist() ) {\n    return _Log_Result( 0 );\n  }\n\n  if ( !p.isDir() ) {\n    return _Log_Result( ENOTDIR );\n  }\n\n  const char *const argv[] = {\n    \"/bin/rm\",\n    \"-rf\",\n    \"--preserve-root\",\n    \"--\",\n    path.asString().c_str(),\n    NULL\n  };\n\n  ExternalProgram prog( argv, ExternalProgram::Stderr_To_Stdout );\n  for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n    DBG << \"  \" << output;\n  }\n  int ret = prog.close();\n  return _Log_Result( ret, \"returned\" );\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "ret",
            "\"returned\""
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prog.close",
          "args": [],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "close",
          "container": "ExternalProgram",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/ExternalProgram.cc",
          "lines": "325-351",
          "snippet": "int\nExternalProgram::close()\n{\n    if (pid > 0)\n    {\n\tExternalDataSource::close();\n\t// Wait for child to exit\n\tint ret;\n        int status = 0;\n\tdo\n\t{\n\t    ret = waitpid(pid, &status, 0);\n\t}\n\twhile (ret == -1 && errno == EINTR);\n\n\tif (ret != -1)\n\t{\n\t    status = checkStatus( status );\n\t}\n        pid = -1;\n        return status;\n    }\n    else\n    {\n        return _exitStatus;\n    }\n}",
          "includes": [
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <cstring> // strsignal",
            "#include <termios.h> // tcsetattr()",
            "#include <stdlib.h> // setenv",
            "#include <pty.h> // openpty",
            "#include <fcntl.h>",
            "#include <sys/wait.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <signal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/ExternalProgram.h>\n#include <y2util/Y2SLog.h>\n#include <cstring> // strsignal\n#include <termios.h> // tcsetattr()\n#include <stdlib.h> // setenv\n#include <pty.h> // openpty\n#include <fcntl.h>\n#include <sys/wait.h>\n#include <unistd.h>\n#include <errno.h>\n#include <signal.h>\n\nExternalProgram {\n  int\n  ExternalProgram::close()\n  {\n      if (pid > 0)\n      {\n  \tExternalDataSource::close();\n  \t// Wait for child to exit\n  \tint ret;\n          int status = 0;\n  \tdo\n  \t{\n  \t    ret = waitpid(pid, &status, 0);\n  \t}\n  \twhile (ret == -1 && errno == EINTR);\n  \n  \tif (ret != -1)\n  \t{\n  \t    status = checkStatus( status );\n  \t}\n          pid = -1;\n          return status;\n      }\n      else\n      {\n          return _exitStatus;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "prog.receiveLine",
          "args": [],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "receiveLine",
          "container": "ExternalDataSource",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/ExternalDataSource.cc",
          "lines": "143-156",
          "snippet": "string\nExternalDataSource::receiveLine()\n{\n    if (inputfile)\n    {\n\tssize_t nread = getline (&linebuffer, &linebuffer_size, inputfile);\n\tif (nread == -1)\n\t    return \"\";\n\telse\n\t    return string (linebuffer, nread);\n    }\n    else\n\treturn \"\";\n}",
          "includes": [
            "#include <y2util/ExternalDataSource.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <sys/wait.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <signal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/ExternalDataSource.h>\n#include <y2util/Y2SLog.h>\n#include <string>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <sys/wait.h>\n#include <unistd.h>\n#include <errno.h>\n#include <signal.h>\n\nExternalDataSource {\n  string\n  ExternalDataSource::receiveLine()\n  {\n      if (inputfile)\n      {\n  \tssize_t nread = getline (&linebuffer, &linebuffer_size, inputfile);\n  \tif (nread == -1)\n  \t    return \"\";\n  \telse\n  \t    return string (linebuffer, nread);\n      }\n      else\n  \treturn \"\";\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.length",
          "args": [],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path.asString",
          "args": [],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "ENOTDIR"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "_Log_Result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "272-278",
          "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p.isDir",
          "args": [],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "isDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "389-389",
          "snippet": "bool   isDir ()  const { return S_ISDIR( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isDir ()  const { return S_ISDIR( _mode ); }"
        }
      },
      {
        "call_info": {
          "callee": "p.isExist",
          "args": [],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "isExist",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "109-109",
          "snippet": "bool   isExist() const { return !error_i; }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nPathInfo {\n  bool   isExist() const { return !error_i; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::recursive_rmdir( const Pathname & path )\n  {\n    DBG << \"recursive_rmdir \" << path << ' ';\n    PathInfo p( path );\n  \n    if ( !p.isExist() ) {\n      return _Log_Result( 0 );\n    }\n  \n    if ( !p.isDir() ) {\n      return _Log_Result( ENOTDIR );\n    }\n  \n    const char *const argv[] = {\n      \"/bin/rm\",\n      \"-rf\",\n      \"--preserve-root\",\n      \"--\",\n      path.asString().c_str(),\n      NULL\n    };\n  \n    ExternalProgram prog( argv, ExternalProgram::Stderr_To_Stdout );\n    for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n      DBG << \"  \" << output;\n    }\n    int ret = prog.close();\n    return _Log_Result( ret, \"returned\" );\n  }\n}"
  },
  {
    "function_name": "rmdir",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "348-355",
    "snippet": "int PathInfo::rmdir( const Pathname & path )\n{\n  DBG << \"rmdir \" << path;\n  if ( ::rmdir( path.asString().c_str() ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "0"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "_Log_Result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "272-278",
          "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "::rmdir",
          "args": [
            "path.asString().c_str()"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "recursive_rmdir",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "365-393",
          "snippet": "int PathInfo::recursive_rmdir( const Pathname & path )\n{\n  DBG << \"recursive_rmdir \" << path << ' ';\n  PathInfo p( path );\n\n  if ( !p.isExist() ) {\n    return _Log_Result( 0 );\n  }\n\n  if ( !p.isDir() ) {\n    return _Log_Result( ENOTDIR );\n  }\n\n  const char *const argv[] = {\n    \"/bin/rm\",\n    \"-rf\",\n    \"--preserve-root\",\n    \"--\",\n    path.asString().c_str(),\n    NULL\n  };\n\n  ExternalProgram prog( argv, ExternalProgram::Stderr_To_Stdout );\n  for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n    DBG << \"  \" << output;\n  }\n  int ret = prog.close();\n  return _Log_Result( ret, \"returned\" );\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::recursive_rmdir( const Pathname & path )\n  {\n    DBG << \"recursive_rmdir \" << path << ' ';\n    PathInfo p( path );\n  \n    if ( !p.isExist() ) {\n      return _Log_Result( 0 );\n    }\n  \n    if ( !p.isDir() ) {\n      return _Log_Result( ENOTDIR );\n    }\n  \n    const char *const argv[] = {\n      \"/bin/rm\",\n      \"-rf\",\n      \"--preserve-root\",\n      \"--\",\n      path.asString().c_str(),\n      NULL\n    };\n  \n    ExternalProgram prog( argv, ExternalProgram::Stderr_To_Stdout );\n    for ( string output( prog.receiveLine() ); output.length(); output = prog.receiveLine() ) {\n      DBG << \"  \" << output;\n    }\n    int ret = prog.close();\n    return _Log_Result( ret, \"returned\" );\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path.asString",
          "args": [],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::rmdir( const Pathname & path )\n  {\n    DBG << \"rmdir \" << path;\n    if ( ::rmdir( path.asString().c_str() ) == -1 ) {\n      return _Log_Result( errno );\n    }\n    return _Log_Result( 0 );\n  }\n}"
  },
  {
    "function_name": "assert_dir",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "305-338",
    "snippet": "int PathInfo::assert_dir( const Pathname & path, unsigned mode )\n{\n    string::size_type pos, lastpos = 0;\n    string spath = path.asString()+\"/\";\n    int ret = 0;\n\n    if(path.empty())\n\treturn ENOENT;\n\n    // skip ./\n    if(path.relative())\n\tlastpos=2;\n    // skip /\n    else\n\tlastpos=1;\n\n//    DBG << \"about to create \" << spath << endl;\n    while((pos = spath.find('/',lastpos)) != string::npos )\n    {\n\tstring dir = spath.substr(0,pos);\n\tret = ::mkdir(dir.c_str(), mode);\n\tif(ret == -1)\n\t{\n\t    // ignore errors about already existing directorys\n\t    if(errno == EEXIST)\n\t\tret=0;\n\t    else\n\t\tret=errno;\n\t}\n//\tDBG << \"creating directory \" << dir << (ret?\" failed\":\" succeeded\") << endl;\n\tlastpos = pos+1;\n    }\n    return ret;\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::mkdir",
          "args": [
            "dir.c_str()",
            "mode"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "mkdir",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "288-295",
          "snippet": "int PathInfo::mkdir( const Pathname & path, unsigned mode )\n{\n  DBG << \"mkdir \" << path << ' ' << stringutil::octstring( mode );\n  if ( ::mkdir( path.asString().c_str(), mode ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::mkdir( const Pathname & path, unsigned mode )\n  {\n    DBG << \"mkdir \" << path << ' ' << stringutil::octstring( mode );\n    if ( ::mkdir( path.asString().c_str(), mode ) == -1 ) {\n      return _Log_Result( errno );\n    }\n    return _Log_Result( 0 );\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dir.c_str",
          "args": [],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spath.substr",
          "args": [
            "0",
            "pos"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spath.find",
          "args": [
            "'/'",
            "lastpos"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "YCPPathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "287-321",
          "snippet": "string\nYCPPathSearch::find (Kind kind, const string& name)\n{\n    if (name[0] == '.'\n\t&& name[1] == '/')\n    {\n\tif (access (name.c_str(), R_OK) == 0)\n\t{\n\t    return name;\n\t}\n\treturn \"\";\n    }\n\n    initialize ();\n\n    std::list<string>& kindList = searchList[kind];\n    std::list<string>::iterator i = kindList.begin (), e = kindList.end ();\n    while (i != e)\n    {\n\tstring pathname = completeFilename (*i + '/' + name);\n\ty2debug (\"trying %s\", pathname.c_str ());\n\tif (access (pathname.c_str(), R_OK) == 0)\n\t{\n\t    y2debug (\"... success\");\n\t    // FIXME: this check is different for clients and for modules - see findy2\n\t    if( searchPrefixWarn && *i != kindList.back () ) {\n\t\ty2warning( \"Using special search prefix '%s' for '%s'\", i->c_str(), pathname.c_str() );\n\t    }\n\t    return pathname;\n\t}\n\n\t++i;\n    }\n    return \"\";\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool Y2PathSearch::searchPrefixWarn = true;",
            "std::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nbool Y2PathSearch::searchPrefixWarn = true;\nstd::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];\n\nYCPPathSearch {\n  string\n  YCPPathSearch::find (Kind kind, const string& name)\n  {\n      if (name[0] == '.'\n  \t&& name[1] == '/')\n      {\n  \tif (access (name.c_str(), R_OK) == 0)\n  \t{\n  \t    return name;\n  \t}\n  \treturn \"\";\n      }\n  \n      initialize ();\n  \n      std::list<string>& kindList = searchList[kind];\n      std::list<string>::iterator i = kindList.begin (), e = kindList.end ();\n      while (i != e)\n      {\n  \tstring pathname = completeFilename (*i + '/' + name);\n  \ty2debug (\"trying %s\", pathname.c_str ());\n  \tif (access (pathname.c_str(), R_OK) == 0)\n  \t{\n  \t    y2debug (\"... success\");\n  \t    // FIXME: this check is different for clients and for modules - see findy2\n  \t    if( searchPrefixWarn && *i != kindList.back () ) {\n  \t\ty2warning( \"Using special search prefix '%s' for '%s'\", i->c_str(), pathname.c_str() );\n  \t    }\n  \t    return pathname;\n  \t}\n  \n  \t++i;\n      }\n      return \"\";\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path.relative",
          "args": [],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "relative",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "68-68",
          "snippet": "bool relative() const { return !empty() && name_t[prfx_i] != '/'; }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool relative() const { return !empty() && name_t[prfx_i] != '/'; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path.empty",
          "args": [],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path.asString",
          "args": [],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::assert_dir( const Pathname & path, unsigned mode )\n  {\n      string::size_type pos, lastpos = 0;\n      string spath = path.asString()+\"/\";\n      int ret = 0;\n  \n      if(path.empty())\n  \treturn ENOENT;\n  \n      // skip ./\n      if(path.relative())\n  \tlastpos=2;\n      // skip /\n      else\n  \tlastpos=1;\n  \n  //    DBG << \"about to create \" << spath << endl;\n      while((pos = spath.find('/',lastpos)) != string::npos )\n      {\n  \tstring dir = spath.substr(0,pos);\n  \tret = ::mkdir(dir.c_str(), mode);\n  \tif(ret == -1)\n  \t{\n  \t    // ignore errors about already existing directorys\n  \t    if(errno == EEXIST)\n  \t\tret=0;\n  \t    else\n  \t\tret=errno;\n  \t}\n  //\tDBG << \"creating directory \" << dir << (ret?\" failed\":\" succeeded\") << endl;\n  \tlastpos = pos+1;\n      }\n      return ret;\n  }\n}"
  },
  {
    "function_name": "mkdir",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "288-295",
    "snippet": "int PathInfo::mkdir( const Pathname & path, unsigned mode )\n{\n  DBG << \"mkdir \" << path << ' ' << stringutil::octstring( mode );\n  if ( ::mkdir( path.asString().c_str(), mode ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_Log_Result",
          "args": [
            "0"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "_Log_Result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "272-278",
          "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "::mkdir",
          "args": [
            "path.asString().c_str()",
            "mode"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "mkdir",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "288-295",
          "snippet": "int PathInfo::mkdir( const Pathname & path, unsigned mode )\n{\n  DBG << \"mkdir \" << path << ' ' << stringutil::octstring( mode );\n  if ( ::mkdir( path.asString().c_str(), mode ) == -1 ) {\n    return _Log_Result( errno );\n  }\n  return _Log_Result( 0 );\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "path.asString",
          "args": [],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "stringutil::octstring",
          "args": [
            "mode"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "octstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/stringutil.h",
          "lines": "152-152",
          "snippet": "inline std::string octstring( unsigned long long n, int w = 0 ) { return form( \"%#0*llo\",  w, n ); }",
          "includes": [
            "#include <list>",
            "#include <string>",
            "#include <vector>",
            "#include <iosfwd>",
            "#include <cstdlib>",
            "#include <cstdarg>",
            "#include <cstdio>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <string>\n#include <vector>\n#include <iosfwd>\n#include <cstdlib>\n#include <cstdarg>\n#include <cstdio>\n\ninline std::string octstring( unsigned long long n, int w = 0 ) { return form( \"%#0*llo\",  w, n ); }"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::mkdir( const Pathname & path, unsigned mode )\n  {\n    DBG << \"mkdir \" << path << ' ' << stringutil::octstring( mode );\n    if ( ::mkdir( path.asString().c_str(), mode ) == -1 ) {\n      return _Log_Result( errno );\n    }\n    return _Log_Result( 0 );\n  }\n}"
  },
  {
    "function_name": "_Log_Result",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "272-278",
    "snippet": "inline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\ninline int _Log_Result( const int res, const char * rclass = \"errno\" )\n{\n  if ( res )\n    DBG << \" FAILED: \" << rclass << \" \" << res;\n  DBG << endl;\n  return res;\n}"
  },
  {
    "function_name": "fileType",
    "container": "PathInfo::stat_mode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "212-230",
    "snippet": "PathInfo::file_type PathInfo::stat_mode::fileType() const\n{\n  if ( isFile() )\n    return T_FILE;\n  if ( isDir() )\n    return T_DIR;\n  if ( isLink() )\n    return T_LINK;\n  if ( isChr() )\n    return T_CHARDEV;\n  if ( isBlk() )\n    return T_BLOCKDEV;\n  if ( isFifo() )\n    return T_FIFO;\n  if ( isSock() )\n    return T_SOCKET ;\n\n  return NOT_AVAIL;\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "isSock",
          "args": [],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "isSock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "394-394",
          "snippet": "bool   isSock()  const { return S_ISSOCK( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isSock()  const { return S_ISSOCK( _mode ); }"
        }
      },
      {
        "call_info": {
          "callee": "isFifo",
          "args": [],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "isFifo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "393-393",
          "snippet": "bool   isFifo()  const { return S_ISFIFO( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isFifo()  const { return S_ISFIFO( _mode ); }"
        }
      },
      {
        "call_info": {
          "callee": "isBlk",
          "args": [],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "isBlk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "392-392",
          "snippet": "bool   isBlk()   const { return S_ISBLK( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isBlk()   const { return S_ISBLK( _mode ); }"
        }
      },
      {
        "call_info": {
          "callee": "isChr",
          "args": [],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "isChr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "391-391",
          "snippet": "bool   isChr()   const { return S_ISCHR( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isChr()   const { return S_ISCHR( _mode ); }"
        }
      },
      {
        "call_info": {
          "callee": "isLink",
          "args": [],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "isLink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "390-390",
          "snippet": "bool   isLink()  const { return S_ISLNK( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isLink()  const { return S_ISLNK( _mode ); }"
        }
      },
      {
        "call_info": {
          "callee": "isDir",
          "args": [],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "isDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "389-389",
          "snippet": "bool   isDir ()  const { return S_ISDIR( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isDir ()  const { return S_ISDIR( _mode ); }"
        }
      },
      {
        "call_info": {
          "callee": "isFile",
          "args": [],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "isFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "388-388",
          "snippet": "bool   isFile()  const { return S_ISREG( _mode ); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool   isFile()  const { return S_ISREG( _mode ); }"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  stat_mode {\n    PathInfo::file_type PathInfo::stat_mode::fileType() const\n    {\n      if ( isFile() )\n        return T_FILE;\n      if ( isDir() )\n        return T_DIR;\n      if ( isLink() )\n        return T_LINK;\n      if ( isChr() )\n        return T_CHARDEV;\n      if ( isBlk() )\n        return T_BLOCKDEV;\n      if ( isFifo() )\n        return T_FIFO;\n      if ( isSock() )\n        return T_SOCKET ;\n    \n      return NOT_AVAIL;\n    }\n  }\n}"
  },
  {
    "function_name": "userMay",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "141-151",
    "snippet": "mode_t PathInfo::userMay() const\n{\n  if ( !isExist() )\n    return 0;\n  if ( owner() == getuid() ) {\n    return( uperm()/0100 );\n  } else if ( group() == getgid() ) {\n    return( gperm()/010 );\n  }\n  return operm();\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "operm",
          "args": [],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "operm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "419-419",
          "snippet": "mode_t operm()   const { return (_mode & S_IRWXO); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nmode_t operm()   const { return (_mode & S_IRWXO); }"
        }
      },
      {
        "call_info": {
          "callee": "gperm",
          "args": [],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "gperm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "418-418",
          "snippet": "mode_t gperm()   const { return (_mode & S_IRWXG); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nmode_t gperm()   const { return (_mode & S_IRWXG); }"
        }
      },
      {
        "call_info": {
          "callee": "getgid",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "group",
          "args": [],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "group",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "126-126",
          "snippet": "gid_t  group()   const { return isExist() ? statbuf_C.st_gid : 0; }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nPathInfo {\n  gid_t  group()   const { return isExist() ? statbuf_C.st_gid : 0; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "uperm",
          "args": [],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "uperm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "417-417",
          "snippet": "mode_t uperm()   const { return (_mode & S_IRWXU); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nmode_t uperm()   const { return (_mode & S_IRWXU); }"
        }
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "owner",
          "args": [],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "owner",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "125-125",
          "snippet": "uid_t  owner()   const { return isExist() ? statbuf_C.st_uid : 0; }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nPathInfo {\n  uid_t  owner()   const { return isExist() ? statbuf_C.st_uid : 0; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isExist",
          "args": [],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "isExist",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "109-109",
          "snippet": "bool   isExist() const { return !error_i; }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nPathInfo {\n  bool   isExist() const { return !error_i; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  mode_t PathInfo::userMay() const\n  {\n    if ( !isExist() )\n      return 0;\n    if ( owner() == getuid() ) {\n      return( uperm()/0100 );\n    } else if ( group() == getgid() ) {\n      return( gperm()/010 );\n    }\n    return operm();\n  }\n}"
  },
  {
    "function_name": "fileType",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "126-131",
    "snippet": "PathInfo::file_type PathInfo::fileType() const\n{\n  if ( isExist() )\n    return stat_mode( st_mode() ).fileType();\n  return NOT_EXIST;\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stat_mode",
          "args": [],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "fileType",
          "container": "PathInfo::stat_mode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "212-230",
          "snippet": "PathInfo::file_type PathInfo::stat_mode::fileType() const\n{\n  if ( isFile() )\n    return T_FILE;\n  if ( isDir() )\n    return T_DIR;\n  if ( isLink() )\n    return T_LINK;\n  if ( isChr() )\n    return T_CHARDEV;\n  if ( isBlk() )\n    return T_BLOCKDEV;\n  if ( isFifo() )\n    return T_FIFO;\n  if ( isSock() )\n    return T_SOCKET ;\n\n  return NOT_AVAIL;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  stat_mode {\n    PathInfo::file_type PathInfo::stat_mode::fileType() const\n    {\n      if ( isFile() )\n        return T_FILE;\n      if ( isDir() )\n        return T_DIR;\n      if ( isLink() )\n        return T_LINK;\n      if ( isChr() )\n        return T_CHARDEV;\n      if ( isBlk() )\n        return T_BLOCKDEV;\n      if ( isFifo() )\n        return T_FIFO;\n      if ( isSock() )\n        return T_SOCKET ;\n    \n      return NOT_AVAIL;\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "stat_mode",
          "args": [
            "st_mode()"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st_mode",
          "args": [],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "st_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "425-425",
          "snippet": "mode_t st_mode() const { return _mode; }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nmode_t st_mode() const { return _mode; }"
        }
      },
      {
        "call_info": {
          "callee": "isExist",
          "args": [],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "isExist",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "109-109",
          "snippet": "bool   isExist() const { return !error_i; }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nPathInfo {\n  bool   isExist() const { return !error_i; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  PathInfo::file_type PathInfo::fileType() const\n  {\n    if ( isExist() )\n      return stat_mode( st_mode() ).fileType();\n    return NOT_EXIST;\n  }\n}"
  },
  {
    "function_name": "operator()",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "101-118",
    "snippet": "bool PathInfo::operator()()\n{\n  if ( path_t.empty() ) {\n    error_i = -1;\n  } else {\n    switch ( mode_e ) {\n    case STAT:\n      error_i = ::stat( path_t.asString().c_str(), &statbuf_C );\n      break;\n    case LSTAT:\n      error_i = ::lstat( path_t.asString().c_str(), &statbuf_C );\n      break;\n    }\n    if ( error_i == -1 )\n      error_i = errno;\n  }\n  return !error_i;\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::lstat",
          "args": [
            "path_t.asString().c_str()",
            "&statbuf_C"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path_t.asString",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "::stat",
          "args": [
            "path_t.asString().c_str()",
            "&statbuf_C"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path_t.empty",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  bool PathInfo::operator()()\n  {\n    if ( path_t.empty() ) {\n      error_i = -1;\n    } else {\n      switch ( mode_e ) {\n      case STAT:\n        error_i = ::stat( path_t.asString().c_str(), &statbuf_C );\n        break;\n      case LSTAT:\n        error_i = ::lstat( path_t.asString().c_str(), &statbuf_C );\n        break;\n      }\n      if ( error_i == -1 )\n        error_i = errno;\n    }\n    return !error_i;\n  }\n}"
  },
  {
    "function_name": "~PathInfo",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "89-91",
    "snippet": "PathInfo::~PathInfo()\n{\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  PathInfo::~PathInfo()\n  {\n  }\n}"
  },
  {
    "function_name": "PathInfo",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "73-79",
    "snippet": "PathInfo::PathInfo( const char * path, Mode initial )\n    : path_t( path )\n    , mode_e( initial )\n    , error_i( -1 )\n{\n  operator()();\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  PathInfo::PathInfo( const char * path, Mode initial )\n      : path_t( path )\n      , mode_e( initial )\n      , error_i( -1 )\n  {\n    operator()();\n  }\n}"
  },
  {
    "function_name": "PathInfo",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "57-63",
    "snippet": "PathInfo::PathInfo( const string & path, Mode initial )\n    : path_t( path )\n    , mode_e( initial )\n    , error_i( -1 )\n{\n  operator()();\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  PathInfo::PathInfo( const string & path, Mode initial )\n      : path_t( path )\n      , mode_e( initial )\n      , error_i( -1 )\n  {\n    operator()();\n  }\n}"
  },
  {
    "function_name": "PathInfo",
    "container": "PathInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
    "lines": "41-47",
    "snippet": "PathInfo::PathInfo( const Pathname & path, Mode initial )\n    : path_t( path )\n    , mode_e( initial )\n    , error_i( -1 )\n{\n  operator()();\n}",
    "includes": [
      "#include <y2util/PathInfo.h>",
      "#include <y2util/ExternalProgram.h>",
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iomanip>",
      "#include <fstream>",
      "#include <iostream>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  PathInfo::PathInfo( const Pathname & path, Mode initial )\n      : path_t( path )\n      , mode_e( initial )\n      , error_i( -1 )\n  {\n    operator()();\n  }\n}"
  }
]