[
  {
    "function_name": "YCPFloat",
    "container": "YCPFloat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPFloat.cc",
    "lines": "119-122",
    "snippet": "YCPFloat::YCPFloat (bytecodeistream & str)\n    : YCPValue (new YCPFloatRep (fromStream (str).c_str()))\n{\n}",
    "includes": [
      "#include \"ycp/Xmlcode.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPFloat.h\"",
      "#include \"ycp/y2log.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fromStream",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fromStream",
          "args": [
            "str"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "fromStream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPFloat.cc",
          "lines": "111-117",
          "snippet": "static const string\nfromStream (bytecodeistream & str)\n{\n    string v;\n    Bytecode::readString (str, v);\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/y2log.h\"",
            "#include <ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/y2log.h\"\n#include <ctype.h>\n\nstatic const string\nfromStream (bytecodeistream & str)\n{\n    string v;\n    Bytecode::readString (str, v);\n    return v;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/y2log.h\"\n#include <ctype.h>\n\nYCPFloat {\n  YCPFloat::YCPFloat (bytecodeistream & str)\n      : YCPValue (new YCPFloatRep (fromStream (str).c_str()))\n  {\n  }\n}"
  },
  {
    "function_name": "fromStream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPFloat.cc",
    "lines": "111-117",
    "snippet": "static const string\nfromStream (bytecodeistream & str)\n{\n    string v;\n    Bytecode::readString (str, v);\n    return v;\n}",
    "includes": [
      "#include \"ycp/Xmlcode.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPFloat.h\"",
      "#include \"ycp/y2log.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Bytecode::readString",
          "args": [
            "str",
            "v"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "readString",
          "container": "Bytecode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Bytecode.cc",
          "lines": "229-247",
          "snippet": "bool\nBytecode::readString (bytecodeistream & streamref, string & stringref)\n{\n    bool ret = false;\n    stringref.erase();\n    u_int32_t len = readInt32 (streamref);\n    if (len > 0)\n    {\n\tchar *buf = new char [len+1];\n\tif (streamref.read (buf, len))\n\t{\n\t    buf[len] = 0;\n\t    stringref = string (buf);\n\t    ret = true;\n\t}\n\tdelete [] buf;\n    }\n    return ret;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <string.h>",
            "#include <errno.h>",
            "#include <fstream>",
            "#include \"ycp/pathsearch.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2/Y2Namespace.h\"",
            "#include \"ycp/YBlock.h\"",
            "#include \"ycp/YStatement.h\"",
            "#include \"ycp/YExpression.h\"",
            "#include \"ycp/YCode.h\"",
            "#include \"YCP.h\"",
            "#include \"ycp/Bytecode.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <string.h>\n#include <errno.h>\n#include <fstream>\n#include \"ycp/pathsearch.h\"\n#include \"ycp/y2log.h\"\n#include \"y2/Y2Namespace.h\"\n#include \"ycp/YBlock.h\"\n#include \"ycp/YStatement.h\"\n#include \"ycp/YExpression.h\"\n#include \"ycp/YCode.h\"\n#include \"YCP.h\"\n#include \"ycp/Bytecode.h\"\n\nBytecode {\n  bool\n  Bytecode::readString (bytecodeistream & streamref, string & stringref)\n  {\n      bool ret = false;\n      stringref.erase();\n      u_int32_t len = readInt32 (streamref);\n      if (len > 0)\n      {\n  \tchar *buf = new char [len+1];\n  \tif (streamref.read (buf, len))\n  \t{\n  \t    buf[len] = 0;\n  \t    stringref = string (buf);\n  \t    ret = true;\n  \t}\n  \tdelete [] buf;\n      }\n      return ret;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/y2log.h\"\n#include <ctype.h>\n\nstatic const string\nfromStream (bytecodeistream & str)\n{\n    string v;\n    Bytecode::readString (str, v);\n    return v;\n}"
  },
  {
    "function_name": "valuetype",
    "container": "YCPFloatRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPFloat.cc",
    "lines": "87-91",
    "snippet": "YCPValueType\nYCPFloatRep::valuetype() const\n{\n    return YT_FLOAT;\n}",
    "includes": [
      "#include \"ycp/Xmlcode.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPFloat.h\"",
      "#include \"ycp/y2log.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/y2log.h\"\n#include <ctype.h>\n\nYCPFloatRep {\n  YCPValueType\n  YCPFloatRep::valuetype() const\n  {\n      return YT_FLOAT;\n  }\n}"
  },
  {
    "function_name": "toString",
    "container": "YCPFloatRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPFloat.cc",
    "lines": "70-84",
    "snippet": "string\nYCPFloatRep::toString() const\n{\n    char s[64];\n    if ((v == (long)v)\t\t\t\t// force decimal point for integer value range\n\t&& (v < 100000))\n    {\n\tsnprintf (s, 64, \"%g.\", v);\n    }\n    else\n    {\n\tsnprintf (s, 64, \"%g\", v);\n    }\n    return string(s);\n}",
    "includes": [
      "#include \"ycp/Xmlcode.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPFloat.h\"",
      "#include \"ycp/y2log.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "string",
          "args": [
            "s"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "compare_op_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YExpression.cc",
          "lines": "435-450",
          "snippet": "static string\ncompare_op_string( YECompare::c_op op )\n{\n    switch (op)\n    {\n\tcase YECompare::C_EQ:  return \"==\"; break;\n\tcase YECompare::C_NEQ: return \"!=\"; break;\n\tcase YECompare::C_LT:  return \"<\";  break;\n\tcase YECompare::C_GE:  return \">=\"; break;\n\tcase YECompare::C_LE:  return \"<=\"; break;\n\tcase YECompare::C_GT:  return \">\";  break;\n\tdefault:\n\t\tbreak;\n    }\n    return \"?compare?\";\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/SymbolTable.h\"",
            "#include \"ycp/YExpression.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YBlock.h\"",
            "#include \"ycp/YStatement.h\"",
            "#include \"ycp/StaticDeclaration.h\"",
            "#include \"ycp/y2log.h\"",
            "#include <libintl.h>\t// for dngettext"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/SymbolTable.h\"\n#include \"ycp/YExpression.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YBlock.h\"\n#include \"ycp/YStatement.h\"\n#include \"ycp/StaticDeclaration.h\"\n#include \"ycp/y2log.h\"\n#include <libintl.h>\t// for dngettext\n\nstatic string\ncompare_op_string( YECompare::c_op op )\n{\n    switch (op)\n    {\n\tcase YECompare::C_EQ:  return \"==\"; break;\n\tcase YECompare::C_NEQ: return \"!=\"; break;\n\tcase YECompare::C_LT:  return \"<\";  break;\n\tcase YECompare::C_GE:  return \">=\"; break;\n\tcase YECompare::C_LE:  return \"<=\"; break;\n\tcase YECompare::C_GT:  return \">\";  break;\n\tdefault:\n\t\tbreak;\n    }\n    return \"?compare?\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "s",
            "64",
            "\"%g\"",
            "v"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "s",
            "64",
            "\"%g.\"",
            "v"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/y2log.h\"\n#include <ctype.h>\n\nYCPFloatRep {\n  string\n  YCPFloatRep::toString() const\n  {\n      char s[64];\n      if ((v == (long)v)\t\t\t\t// force decimal point for integer value range\n  \t&& (v < 100000))\n      {\n  \tsnprintf (s, 64, \"%g.\", v);\n      }\n      else\n      {\n  \tsnprintf (s, 64, \"%g\", v);\n      }\n      return string(s);\n  }\n}"
  },
  {
    "function_name": "compare",
    "container": "YCPFloatRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPFloat.cc",
    "lines": "62-67",
    "snippet": "YCPOrder\nYCPFloatRep::compare(const YCPFloat& f) const\n{\n    if (v == f->v) return YO_EQUAL;\n    else return v < f->v ? YO_LESS : YO_GREATER;\n}",
    "includes": [
      "#include \"ycp/Xmlcode.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPFloat.h\"",
      "#include \"ycp/y2log.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/y2log.h\"\n#include <ctype.h>\n\nYCPFloatRep {\n  YCPOrder\n  YCPFloatRep::compare(const YCPFloat& f) const\n  {\n      if (v == f->v) return YO_EQUAL;\n      else return v < f->v ? YO_LESS : YO_GREATER;\n  }\n}"
  },
  {
    "function_name": "value",
    "container": "YCPFloatRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPFloat.cc",
    "lines": "55-59",
    "snippet": "double\nYCPFloatRep::value() const\n{\n    return v;\n}",
    "includes": [
      "#include \"ycp/Xmlcode.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPFloat.h\"",
      "#include \"ycp/y2log.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/y2log.h\"\n#include <ctype.h>\n\nYCPFloatRep {\n  double\n  YCPFloatRep::value() const\n  {\n      return v;\n  }\n}"
  },
  {
    "function_name": "YCPFloatRep",
    "container": "YCPFloatRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPFloat.cc",
    "lines": "35-52",
    "snippet": "YCPFloatRep::YCPFloatRep(const char *r)\n{\n    char *endptr = NULL;\n\n    // first try HEX and OCT --> \"-0x000b\", \"-000010\", ...\n    v = (double) strtol(r, &endptr, 0);\n\n    if ((*endptr == '.' && isdigit(*(endptr+1))                      )||\n\t(*endptr == 'e' && isdigit(*(endptr+1))                      )||\n\t(*endptr == 'e' && *(endptr+1) == '-' && isdigit(*(endptr+2)))||\n\t(*endptr == 'e' && *(endptr+1) == '+' && isdigit(*(endptr+2)))||\n\t(*endptr == 'E' && isdigit(*(endptr+1))                      )||\n\t(*endptr == 'E' && *(endptr+1) == '-' && isdigit(*(endptr+2)))||\n\t(*endptr == 'E' && *(endptr+1) == '+' && isdigit(*(endptr+2)))   )   // real float  \n    {\n\tv = atof(r);   // use default\n    }\n}",
    "includes": [
      "#include \"ycp/Xmlcode.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPFloat.h\"",
      "#include \"ycp/y2log.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atof",
          "args": [
            "r"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*(endptr+2)"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*(endptr+2)"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*(endptr+1)"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*(endptr+2)"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*(endptr+2)"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*(endptr+1)"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*(endptr+1)"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "r",
            "&endptr",
            "0"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/y2log.h\"\n#include <ctype.h>\n\nYCPFloatRep {\n  YCPFloatRep::YCPFloatRep(const char *r)\n  {\n      char *endptr = NULL;\n  \n      // first try HEX and OCT --> \"-0x000b\", \"-000010\", ...\n      v = (double) strtol(r, &endptr, 0);\n  \n      if ((*endptr == '.' && isdigit(*(endptr+1))                      )||\n  \t(*endptr == 'e' && isdigit(*(endptr+1))                      )||\n  \t(*endptr == 'e' && *(endptr+1) == '-' && isdigit(*(endptr+2)))||\n  \t(*endptr == 'e' && *(endptr+1) == '+' && isdigit(*(endptr+2)))||\n  \t(*endptr == 'E' && isdigit(*(endptr+1))                      )||\n  \t(*endptr == 'E' && *(endptr+1) == '-' && isdigit(*(endptr+2)))||\n  \t(*endptr == 'E' && *(endptr+1) == '+' && isdigit(*(endptr+2)))   )   // real float  \n      {\n  \tv = atof(r);   // use default\n      }\n  }\n}"
  },
  {
    "function_name": "YCPFloatRep",
    "container": "YCPFloatRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPFloat.cc",
    "lines": "29-32",
    "snippet": "YCPFloatRep::YCPFloatRep(double v)\n    : v(v)\n{\n}",
    "includes": [
      "#include \"ycp/Xmlcode.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPFloat.h\"",
      "#include \"ycp/y2log.h\"",
      "#include <ctype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/y2log.h\"\n#include <ctype.h>\n\nYCPFloatRep {\n  YCPFloatRep::YCPFloatRep(double v)\n      : v(v)\n  {\n  }\n}"
  }
]