[
  {
    "function_name": "start_and_check",
    "container": "WFMSubAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/WFMSubAgent.cc",
    "lines": "79-111",
    "snippet": "bool\nWFMSubAgent::start_and_check (bool check_version, int* error)\n{\n    if (!start ())\n    {\n\t*error = -1;\n\treturn false;\n    }\n\n    YCPValue q1 = YCPTerm (\"SuSEVersion\");\n    YCPValue q2 = YCPVoid ();\n\n    YCPValue a = my_comp->evaluate (check_version ? q1 : q2);\n\n    if (a.isNull ())\n    {\n\t*error = -1;\n\treturn false;\n    }\n\n    if (check_version)\n    {\n\ty2debug (\"SuSEVersion \\\"%s\\\" %s\", SUSEVERSION, a->toString ().c_str ());\n\n\tif (!a->isString () || a->asString ()->value () != SUSEVERSION)\n\t{\n\t    *error = -2;\n\t    return false;\n\t}\n    }\n\n    return true;\n}",
    "includes": [
      "#include <WFMSubAgent.h>",
      "#include \"../../scr/src/StdioSCRAgent.h\"",
      "#include <scr/SCRAgent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a->asString",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "a->isString",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "isString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "65-65",
          "snippet": "bool YCPValueRep::isString()      const { return valuetype() == YT_STRING; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isString()      const { return valuetype() == YT_STRING; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"SuSEVersion \\\"%s\\\" %s\"",
            "SUSEVERSION",
            "a->toString ().c_str ()"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "a->toString",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "a.isNull",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "my_comp->evaluate",
          "args": [
            "check_version ? q1 : q2"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate",
          "container": "Y2SystemNamespace",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2SystemNamespace.cc",
          "lines": "73-80",
          "snippet": "YCPValue\nY2SystemNamespace::evaluate (bool cse) \n{\n    // run the local constructor\n    m_local_ns->evaluate (cse);\n\n    return YCPVoid ();\n}",
          "includes": [
            "#include \"ycp/SymbolTable.h\"",
            "#include \"Y2SystemFunction.h\"",
            "#include \"Y2SystemNamespace.h\"",
            "#include \"Y2StdioFunction.h\"",
            "#include <y2/Y2ProgramComponent.h>",
            "#include <ycp/YCPString.h>",
            "#include <ycp/YCPVoid.h>",
            "#include <ycp/SymbolTable.h>",
            "#include <y2util/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"Y2SystemFunction.h\"\n#include \"Y2SystemNamespace.h\"\n#include \"Y2StdioFunction.h\"\n#include <y2/Y2ProgramComponent.h>\n#include <ycp/YCPString.h>\n#include <ycp/YCPVoid.h>\n#include <ycp/SymbolTable.h>\n#include <y2util/y2log.h>\n\nY2SystemNamespace {\n  YCPValue\n  Y2SystemNamespace::evaluate (bool cse) \n  {\n      // run the local constructor\n      m_local_ns->evaluate (cse);\n  \n      return YCPVoid ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPVoid",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "YCPVoid",
          "container": "YCPVoid",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPVoid.cc",
          "lines": "72-75",
          "snippet": "YCPVoid::YCPVoid ()\n    : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n{\n}",
          "includes": [
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "YCPVoid* YCPVoid::nil = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/y2log.h\"\n\nYCPVoid* YCPVoid::nil = NULL;\n\nYCPVoid {\n  YCPVoid::YCPVoid ()\n      : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPTerm",
          "args": [
            "\"SuSEVersion\""
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "YCPTerm",
          "container": "YCPTerm",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "178-194",
          "snippet": "YCPTerm::YCPTerm (bytecodeistream & str)\n    : YCPValue (YCPTerm(\"no-name-so-far\"))\n{\n    string s;\n    if (Bytecode::readString (str, s))\n    {\n\tYCPList list (str);\n\tif (!list.isNull())\n\t{\n\t    (const_cast<YCPTermRep*>(static_cast<const YCPTermRep*>(element)))->setName(s);\n\t    for (int i = 0 ; i < list->size () ; i++)\n\t    {\n\t\t(const_cast<YCPTermRep*>(static_cast<const YCPTermRep*>(element)))->add (list->value (i));\n\t    }\n\t}\n    }\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTerm {\n  YCPTerm::YCPTerm (bytecodeistream & str)\n      : YCPValue (YCPTerm(\"no-name-so-far\"))\n  {\n      string s;\n      if (Bytecode::readString (str, s))\n      {\n  \tYCPList list (str);\n  \tif (!list.isNull())\n  \t{\n  \t    (const_cast<YCPTermRep*>(static_cast<const YCPTermRep*>(element)))->setName(s);\n  \t    for (int i = 0 ; i < list->size () ; i++)\n  \t    {\n  \t\t(const_cast<YCPTermRep*>(static_cast<const YCPTermRep*>(element)))->add (list->value (i));\n  \t    }\n  \t}\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "start",
          "args": [],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "start",
          "container": "WFMSubAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/WFMSubAgent.cc",
          "lines": "53-76",
          "snippet": "bool\nWFMSubAgent::start ()\n{\n    if (!my_comp)\n    {\n\ty2debug (\"Creating SubAgent: %d %s\", my_handle, my_name.c_str ());\n\tmy_comp = Y2ComponentBroker::createServer (my_name.c_str ());\n\n\tif (!my_comp)\n\t{\n\t    ycp2error (\"Can't create component '%s'\", my_name.c_str ());\n\t}\n\telse\n\t{\n\t    if (my_comp->getSCRAgent () == NULL)\n\t    {\n\t\t// the component does not have a SCR agent, better try to push over stdio\n\t\tmy_agent = new StdioSCRAgent (my_comp);\n\t    }\n\t}\n    }\n\n    return my_comp != 0;\n}",
          "includes": [
            "#include <WFMSubAgent.h>",
            "#include \"../../scr/src/StdioSCRAgent.h\"",
            "#include <scr/SCRAgent.h>",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <WFMSubAgent.h>\n#include \"../../scr/src/StdioSCRAgent.h\"\n#include <scr/SCRAgent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/y2log.h>\n\nWFMSubAgent {\n  bool\n  WFMSubAgent::start ()\n  {\n      if (!my_comp)\n      {\n  \ty2debug (\"Creating SubAgent: %d %s\", my_handle, my_name.c_str ());\n  \tmy_comp = Y2ComponentBroker::createServer (my_name.c_str ());\n  \n  \tif (!my_comp)\n  \t{\n  \t    ycp2error (\"Can't create component '%s'\", my_name.c_str ());\n  \t}\n  \telse\n  \t{\n  \t    if (my_comp->getSCRAgent () == NULL)\n  \t    {\n  \t\t// the component does not have a SCR agent, better try to push over stdio\n  \t\tmy_agent = new StdioSCRAgent (my_comp);\n  \t    }\n  \t}\n      }\n  \n      return my_comp != 0;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <WFMSubAgent.h>\n#include \"../../scr/src/StdioSCRAgent.h\"\n#include <scr/SCRAgent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/y2log.h>\n\nWFMSubAgent {\n  bool\n  WFMSubAgent::start_and_check (bool check_version, int* error)\n  {\n      if (!start ())\n      {\n  \t*error = -1;\n  \treturn false;\n      }\n  \n      YCPValue q1 = YCPTerm (\"SuSEVersion\");\n      YCPValue q2 = YCPVoid ();\n  \n      YCPValue a = my_comp->evaluate (check_version ? q1 : q2);\n  \n      if (a.isNull ())\n      {\n  \t*error = -1;\n  \treturn false;\n      }\n  \n      if (check_version)\n      {\n  \ty2debug (\"SuSEVersion \\\"%s\\\" %s\", SUSEVERSION, a->toString ().c_str ());\n  \n  \tif (!a->isString () || a->asString ()->value () != SUSEVERSION)\n  \t{\n  \t    *error = -2;\n  \t    return false;\n  \t}\n      }\n  \n      return true;\n  }\n}"
  },
  {
    "function_name": "start",
    "container": "WFMSubAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/WFMSubAgent.cc",
    "lines": "53-76",
    "snippet": "bool\nWFMSubAgent::start ()\n{\n    if (!my_comp)\n    {\n\ty2debug (\"Creating SubAgent: %d %s\", my_handle, my_name.c_str ());\n\tmy_comp = Y2ComponentBroker::createServer (my_name.c_str ());\n\n\tif (!my_comp)\n\t{\n\t    ycp2error (\"Can't create component '%s'\", my_name.c_str ());\n\t}\n\telse\n\t{\n\t    if (my_comp->getSCRAgent () == NULL)\n\t    {\n\t\t// the component does not have a SCR agent, better try to push over stdio\n\t\tmy_agent = new StdioSCRAgent (my_comp);\n\t    }\n\t}\n    }\n\n    return my_comp != 0;\n}",
    "includes": [
      "#include <WFMSubAgent.h>",
      "#include \"../../scr/src/StdioSCRAgent.h\"",
      "#include <scr/SCRAgent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "my_comp->getSCRAgent",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"Can't create component '%s'\"",
            "my_name.c_str ()"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "my_name.c_str",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Y2ComponentBroker::createServer",
          "args": [
            "my_name.c_str ()"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "my_name.c_str",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Creating SubAgent: %d %s\"",
            "my_handle",
            "my_name.c_str ()"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "my_name.c_str",
          "args": [],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <WFMSubAgent.h>\n#include \"../../scr/src/StdioSCRAgent.h\"\n#include <scr/SCRAgent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/y2log.h>\n\nWFMSubAgent {\n  bool\n  WFMSubAgent::start ()\n  {\n      if (!my_comp)\n      {\n  \ty2debug (\"Creating SubAgent: %d %s\", my_handle, my_name.c_str ());\n  \tmy_comp = Y2ComponentBroker::createServer (my_name.c_str ());\n  \n  \tif (!my_comp)\n  \t{\n  \t    ycp2error (\"Can't create component '%s'\", my_name.c_str ());\n  \t}\n  \telse\n  \t{\n  \t    if (my_comp->getSCRAgent () == NULL)\n  \t    {\n  \t\t// the component does not have a SCR agent, better try to push over stdio\n  \t\tmy_agent = new StdioSCRAgent (my_comp);\n  \t    }\n  \t}\n      }\n  \n      return my_comp != 0;\n  }\n}"
  },
  {
    "function_name": "~WFMSubAgent",
    "container": "WFMSubAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/WFMSubAgent.cc",
    "lines": "37-50",
    "snippet": "WFMSubAgent::~WFMSubAgent ()\n{\n    if (my_comp)\n    {\n\ty2milestone (\"Deleting SubAgent: %d %s\", my_handle, my_name.c_str ());\n\tmy_comp->result (YCPVoid ());\t// tell server to terminate\n\tdelete my_comp;\n    }\n\n    if (my_agent)\n    {\n\tdelete my_agent;\n    }\n}",
    "includes": [
      "#include <WFMSubAgent.h>",
      "#include \"../../scr/src/StdioSCRAgent.h\"",
      "#include <scr/SCRAgent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "my_comp->result",
          "args": [
            "YCPVoid ()"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "result",
          "container": "Y2ProgramComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2ProgramComponent.cc",
          "lines": "141-163",
          "snippet": "void Y2ProgramComponent::result(const YCPValue& result)\n{\n    // It may be, that no evaluate() call has been issued at all\n    // before the call to this function(). This is likely to happen\n    // in the context of the SCR. For each MountAgent() all it\n    // creates the component that handles the certain path. But\n    // if it may well be that some paths are not used in one\n    // run of YaST2. In that case no evaluate() for that agent\n    // has been issued. Therefore at this point the external\n    // program may not have been started after all. So we need\n    // to check, if it's running.\n    \n    if (pid != -1)\n    {\n\tYCPTerm resultterm(\"result\");\n\tresultterm->add(result);\n\tsendToExternal(resultterm);\n\n        y2milestone (\"Sending result: %s\", resultterm->toString ().c_str ());\n\n\tterminateExternalProgram();\n    }\n}",
          "includes": [
            "#include <y2util/ExternalProgram.h>",
            "#include <ycp/YCPCode.h>",
            "#include <ycp/YCPVoid.h>",
            "#include <ycp/YCPTerm.h>",
            "#include <ycp/y2log.h>",
            "#include <ycp/Parser.h>",
            "#include \"Y2ProgramComponent.h\"",
            "#include <sys/wait.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/ExternalProgram.h>\n#include <ycp/YCPCode.h>\n#include <ycp/YCPVoid.h>\n#include <ycp/YCPTerm.h>\n#include <ycp/y2log.h>\n#include <ycp/Parser.h>\n#include \"Y2ProgramComponent.h\"\n#include <sys/wait.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <string.h>\n#include <signal.h>\n#include <unistd.h>\n#include <stdio.h>\n\nY2ProgramComponent {\n  void Y2ProgramComponent::result(const YCPValue& result)\n  {\n      // It may be, that no evaluate() call has been issued at all\n      // before the call to this function(). This is likely to happen\n      // in the context of the SCR. For each MountAgent() all it\n      // creates the component that handles the certain path. But\n      // if it may well be that some paths are not used in one\n      // run of YaST2. In that case no evaluate() for that agent\n      // has been issued. Therefore at this point the external\n      // program may not have been started after all. So we need\n      // to check, if it's running.\n      \n      if (pid != -1)\n      {\n  \tYCPTerm resultterm(\"result\");\n  \tresultterm->add(result);\n  \tsendToExternal(resultterm);\n  \n          y2milestone (\"Sending result: %s\", resultterm->toString ().c_str ());\n  \n  \tterminateExternalProgram();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPVoid",
          "args": [],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "YCPVoid",
          "container": "YCPVoid",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPVoid.cc",
          "lines": "72-75",
          "snippet": "YCPVoid::YCPVoid ()\n    : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n{\n}",
          "includes": [
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "YCPVoid* YCPVoid::nil = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/y2log.h\"\n\nYCPVoid* YCPVoid::nil = NULL;\n\nYCPVoid {\n  YCPVoid::YCPVoid ()\n      : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2milestone",
          "args": [
            "\"Deleting SubAgent: %d %s\"",
            "my_handle",
            "my_name.c_str ()"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "my_name.c_str",
          "args": [],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <WFMSubAgent.h>\n#include \"../../scr/src/StdioSCRAgent.h\"\n#include <scr/SCRAgent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/y2log.h>\n\nWFMSubAgent {\n  WFMSubAgent::~WFMSubAgent ()\n  {\n      if (my_comp)\n      {\n  \ty2milestone (\"Deleting SubAgent: %d %s\", my_handle, my_name.c_str ());\n  \tmy_comp->result (YCPVoid ());\t// tell server to terminate\n  \tdelete my_comp;\n      }\n  \n      if (my_agent)\n      {\n  \tdelete my_agent;\n      }\n  }\n}"
  },
  {
    "function_name": "WFMSubAgent",
    "container": "WFMSubAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/WFMSubAgent.cc",
    "lines": "28-34",
    "snippet": "WFMSubAgent::WFMSubAgent (const string& name, int handle)\n    : my_name (name),\n      my_handle (handle),\n      my_comp (0),\n      my_agent (0)\n{\n}",
    "includes": [
      "#include <WFMSubAgent.h>",
      "#include \"../../scr/src/StdioSCRAgent.h\"",
      "#include <scr/SCRAgent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <WFMSubAgent.h>\n#include \"../../scr/src/StdioSCRAgent.h\"\n#include <scr/SCRAgent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/y2log.h>\n\nWFMSubAgent {\n  WFMSubAgent::WFMSubAgent (const string& name, int handle)\n      : my_name (name),\n        my_handle (handle),\n        my_comp (0),\n        my_agent (0)\n  {\n  }\n}"
  }
]