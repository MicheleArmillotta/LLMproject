[
  {
    "function_name": "closeAll(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "232-243",
    "snippet": "nt Process::closeAll()\n{\n    if (!stderr_output)\n    {\n\t// close stderr pipe\n\t::fclose(stderr_output);\n\n\tstderr_output = NULL;\n    }\n\n    return ExternalProgram::close();\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xternalProgram::close(",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ":fclose(",
          "args": [
            "tderr_output)"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  nt Process::closeAll()\n  {\n      if (!stderr_output)\n      {\n  \t// close stderr pipe\n  \t::fclose(stderr_output);\n  \n  \tstderr_output = NULL;\n      }\n  \n      return ExternalProgram::close();\n  }\n}"
  },
  {
    "function_name": "create_stderr_pipes(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "212-230",
    "snippet": "nt Process::create_stderr_pipes()\n{\n    int stderr_pipes[2];\n\n    // create a pair of pipes\n    if (pipe(stderr_pipes) != 0)\n    {\n\t// return current stderr\n\treturn 2;\n    }\n\n    // set the stderr pipe to non-blocking mode\n    UnblockFD(stderr_pipes[0]);\n\n    stderr_output = ::fdopen(stderr_pipes[0], \"r\");\n\n    // return fd for writing\n    return stderr_pipes[1];\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": ":fdopen(",
          "args": [
            "tderr_pipes[0],",
            "r\")"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nblockFD(",
          "args": [
            "tderr_pipes[0])"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "nblockFD(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
          "lines": "189-209",
          "snippet": "oid UnblockFD(int fd)\n{\n    // get the current flags\n    int flags = ::fcntl(fd,F_GETFL);\n\n    if (flags == -1)\n    {\n\tERR << strerror(errno) << std::endl; return;\n    }\n\n    // set the non-blocking flag\n    flags = flags | O_NONBLOCK;\n\n    // set the updated flags\n    flags = ::fcntl(fd,F_SETFL,flags);\n\n    if (flags == -1)\n    {\n\tERR << strerror(errno) << std::endl; return;\n    }\n}",
          "includes": [
            "include <y2util/Y2SLog.h>",
            "include <cstring>\n#",
            "include <errno.h>\n#",
            "include <fcntl.h>\n#",
            "include <signal.h>\n#",
            "include \"y2util/Process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\noid UnblockFD(int fd)\n{\n    // get the current flags\n    int flags = ::fcntl(fd,F_GETFL);\n\n    if (flags == -1)\n    {\n\tERR << strerror(errno) << std::endl; return;\n    }\n\n    // set the non-blocking flag\n    flags = flags | O_NONBLOCK;\n\n    // set the updated flags\n    flags = ::fcntl(fd,F_SETFL,flags);\n\n    if (flags == -1)\n    {\n\tERR << strerror(errno) << std::endl; return;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ipe(",
          "args": [
            "tderr_pipes)"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  nt Process::create_stderr_pipes()\n  {\n      int stderr_pipes[2];\n  \n      // create a pair of pipes\n      if (pipe(stderr_pipes) != 0)\n      {\n  \t// return current stderr\n  \treturn 2;\n      }\n  \n      // set the stderr pipe to non-blocking mode\n      UnblockFD(stderr_pipes[0]);\n  \n      stderr_output = ::fdopen(stderr_pipes[0], \"r\");\n  \n      // return fd for writing\n      return stderr_pipes[1];\n  }\n}"
  },
  {
    "function_name": "nblockFD(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "189-209",
    "snippet": "oid UnblockFD(int fd)\n{\n    // get the current flags\n    int flags = ::fcntl(fd,F_GETFL);\n\n    if (flags == -1)\n    {\n\tERR << strerror(errno) << std::endl; return;\n    }\n\n    // set the non-blocking flag\n    flags = flags | O_NONBLOCK;\n\n    // set the updated flags\n    flags = ::fcntl(fd,F_SETFL,flags);\n\n    if (flags == -1)\n    {\n\tERR << strerror(errno) << std::endl; return;\n    }\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "trerror(",
          "args": [
            "rrno)"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ":fcntl(",
          "args": [
            "d,",
            "_SETFL,",
            "lags)"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trerror(",
          "args": [
            "rrno)"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ":fcntl(",
          "args": [
            "d,",
            "_GETFL)"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\noid UnblockFD(int fd)\n{\n    // get the current flags\n    int flags = ::fcntl(fd,F_GETFL);\n\n    if (flags == -1)\n    {\n\tERR << strerror(errno) << std::endl; return;\n    }\n\n    // set the non-blocking flag\n    flags = flags | O_NONBLOCK;\n\n    // set the updated flags\n    flags = ::fcntl(fd,F_SETFL,flags);\n\n    if (flags == -1)\n    {\n\tERR << strerror(errno) << std::endl; return;\n    }\n}"
  },
  {
    "function_name": "readErr(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "175-186",
    "snippet": "td::string Process::readErr()\n{\n    // read from stderr to the buffer\n    readStderrToBuffer();\n\n    // return the buffer and clear it \n    std::string ret(stderr_buffer);\n\n    stderr_buffer.clear();\n\n    return ret;\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tderr_buffer.clear",
          "args": [],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "461-461",
          "snippet": "void clear() { _devino.clear(); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nvoid clear() { _devino.clear(); }"
        }
      },
      {
        "call_info": {
          "callee": "eadStderrToBuffer(",
          "args": [],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "readStderrToBuffer(",
          "container": "rocess",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
          "lines": "116-138",
          "snippet": "oid Process::readStderrToBuffer()\n{\n    if (!stderr_output)\n    {\n\tERR << \"stderr output is not open!\" << std::endl;\n\treturn;\n    }\n\n    const int b_size = 4096;\n    char buffer[b_size];\n    int len;\n\n    do\n    {\n\tlen = ::fread(buffer, 1, b_size, stderr_output);\n\n\tif (len > 0)\n\t{\n\t    stderr_buffer.append(buffer, len);\n\t}\n    }\n    while(len == b_size);\n}",
          "includes": [
            "include <y2util/Y2SLog.h>",
            "include <cstring>\n#",
            "include <errno.h>\n#",
            "include <fcntl.h>\n#",
            "include <signal.h>\n#",
            "include \"y2util/Process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  oid Process::readStderrToBuffer()\n  {\n      if (!stderr_output)\n      {\n  \tERR << \"stderr output is not open!\" << std::endl;\n  \treturn;\n      }\n  \n      const int b_size = 4096;\n      char buffer[b_size];\n      int len;\n  \n      do\n      {\n  \tlen = ::fread(buffer, 1, b_size, stderr_output);\n  \n  \tif (len > 0)\n  \t{\n  \t    stderr_buffer.append(buffer, len);\n  \t}\n      }\n      while(len == b_size);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  td::string Process::readErr()\n  {\n      // read from stderr to the buffer\n      readStderrToBuffer();\n  \n      // return the buffer and clear it \n      std::string ret(stderr_buffer);\n  \n      stderr_buffer.clear();\n  \n      return ret;\n  }\n}"
  },
  {
    "function_name": "readErrLine(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "167-172",
    "snippet": "td::string Process::readErrLine()\n{\n    readStderrToBuffer();\n\n    return GetLineFromBuffer(stderr_buffer);\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "etLineFromBuffer(",
          "args": [
            "tderr_buffer)"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "GetLineFromBuffer(",
          "container": "rocess",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
          "lines": "141-158",
          "snippet": "td::string Process::GetLineFromBuffer(std::string &buffer)\n{\n    // find end of the first line\n    std::string::size_type line_pos = buffer.find(\"\\n\");\n\n    // a line found?\n    if (line_pos != std::string::npos)\n    {\n\t// remove the line from bufer and return it\n\tstd::string ret(buffer, 0, line_pos + 1);\n\tbuffer.erase(0, line_pos + 1);\n\n\treturn ret;\n    }\n\n    // no new line, return empty string\n    return std::string();\n}",
          "includes": [
            "include <y2util/Y2SLog.h>",
            "include <cstring>\n#",
            "include <errno.h>\n#",
            "include <fcntl.h>\n#",
            "include <signal.h>\n#",
            "include \"y2util/Process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  td::string Process::GetLineFromBuffer(std::string &buffer)\n  {\n      // find end of the first line\n      std::string::size_type line_pos = buffer.find(\"\\n\");\n  \n      // a line found?\n      if (line_pos != std::string::npos)\n      {\n  \t// remove the line from bufer and return it\n  \tstd::string ret(buffer, 0, line_pos + 1);\n  \tbuffer.erase(0, line_pos + 1);\n  \n  \treturn ret;\n      }\n  \n      // no new line, return empty string\n      return std::string();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eadStderrToBuffer(",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "readStderrToBuffer(",
          "container": "rocess",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
          "lines": "116-138",
          "snippet": "oid Process::readStderrToBuffer()\n{\n    if (!stderr_output)\n    {\n\tERR << \"stderr output is not open!\" << std::endl;\n\treturn;\n    }\n\n    const int b_size = 4096;\n    char buffer[b_size];\n    int len;\n\n    do\n    {\n\tlen = ::fread(buffer, 1, b_size, stderr_output);\n\n\tif (len > 0)\n\t{\n\t    stderr_buffer.append(buffer, len);\n\t}\n    }\n    while(len == b_size);\n}",
          "includes": [
            "include <y2util/Y2SLog.h>",
            "include <cstring>\n#",
            "include <errno.h>\n#",
            "include <fcntl.h>\n#",
            "include <signal.h>\n#",
            "include \"y2util/Process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  oid Process::readStderrToBuffer()\n  {\n      if (!stderr_output)\n      {\n  \tERR << \"stderr output is not open!\" << std::endl;\n  \treturn;\n      }\n  \n      const int b_size = 4096;\n      char buffer[b_size];\n      int len;\n  \n      do\n      {\n  \tlen = ::fread(buffer, 1, b_size, stderr_output);\n  \n  \tif (len > 0)\n  \t{\n  \t    stderr_buffer.append(buffer, len);\n  \t}\n      }\n      while(len == b_size);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  td::string Process::readErrLine()\n  {\n      readStderrToBuffer();\n  \n      return GetLineFromBuffer(stderr_buffer);\n  }\n}"
  },
  {
    "function_name": "IsAnyLineInBuffer(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "161-164",
    "snippet": "ool Process::IsAnyLineInBuffer(const std::string &buffer)\n{\n    return buffer.empty();\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "uffer.empty",
          "args": [],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  ool Process::IsAnyLineInBuffer(const std::string &buffer)\n  {\n      return buffer.empty();\n  }\n}"
  },
  {
    "function_name": "GetLineFromBuffer(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "141-158",
    "snippet": "td::string Process::GetLineFromBuffer(std::string &buffer)\n{\n    // find end of the first line\n    std::string::size_type line_pos = buffer.find(\"\\n\");\n\n    // a line found?\n    if (line_pos != std::string::npos)\n    {\n\t// remove the line from bufer and return it\n\tstd::string ret(buffer, 0, line_pos + 1);\n\tbuffer.erase(0, line_pos + 1);\n\n\treturn ret;\n    }\n\n    // no new line, return empty string\n    return std::string();\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "td::string(",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uffer.erase",
          "args": [
            ",",
            "ine_pos + 1)"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uffer.find",
          "args": [
            "\\n\")"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  td::string Process::GetLineFromBuffer(std::string &buffer)\n  {\n      // find end of the first line\n      std::string::size_type line_pos = buffer.find(\"\\n\");\n  \n      // a line found?\n      if (line_pos != std::string::npos)\n      {\n  \t// remove the line from bufer and return it\n  \tstd::string ret(buffer, 0, line_pos + 1);\n  \tbuffer.erase(0, line_pos + 1);\n  \n  \treturn ret;\n      }\n  \n      // no new line, return empty string\n      return std::string();\n  }\n}"
  },
  {
    "function_name": "readStderrToBuffer(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "116-138",
    "snippet": "oid Process::readStderrToBuffer()\n{\n    if (!stderr_output)\n    {\n\tERR << \"stderr output is not open!\" << std::endl;\n\treturn;\n    }\n\n    const int b_size = 4096;\n    char buffer[b_size];\n    int len;\n\n    do\n    {\n\tlen = ::fread(buffer, 1, b_size, stderr_output);\n\n\tif (len > 0)\n\t{\n\t    stderr_buffer.append(buffer, len);\n\t}\n    }\n    while(len == b_size);\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tderr_buffer.append",
          "args": [
            "uffer,",
            "en)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ":fread(",
          "args": [
            "uffer,",
            ",",
            "_size,",
            "tderr_output)"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  oid Process::readStderrToBuffer()\n  {\n      if (!stderr_output)\n      {\n  \tERR << \"stderr output is not open!\" << std::endl;\n  \treturn;\n      }\n  \n      const int b_size = 4096;\n      char buffer[b_size];\n      int len;\n  \n      do\n      {\n  \tlen = ::fread(buffer, 1, b_size, stderr_output);\n  \n  \tif (len > 0)\n  \t{\n  \t    stderr_buffer.append(buffer, len);\n  \t}\n      }\n      while(len == b_size);\n  }\n}"
  },
  {
    "function_name": "read(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "104-113",
    "snippet": "td::string Process::read()\n{\n    readStdoutToBuffer();\n\n    std::string ret(stdout_buffer);\n\n    stdout_buffer.clear();\n\n    return ret;\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tdout_buffer.clear",
          "args": [],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "461-461",
          "snippet": "void clear() { _devino.clear(); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nvoid clear() { _devino.clear(); }"
        }
      },
      {
        "call_info": {
          "callee": "eadStdoutToBuffer(",
          "args": [],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "readStdoutToBuffer(",
          "container": "rocess",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
          "lines": "89-101",
          "snippet": "oid Process::readStdoutToBuffer()\n{\n    const size_t b_size = 4096;\n    char buffer[b_size];\n    size_t read;\n\n    do\n    {\n\tread = receive(buffer, b_size);\n\tstdout_buffer.append(buffer, read);\n    }\n    while(read == b_size);\n}",
          "includes": [
            "include <y2util/Y2SLog.h>",
            "include <cstring>\n#",
            "include <errno.h>\n#",
            "include <fcntl.h>\n#",
            "include <signal.h>\n#",
            "include \"y2util/Process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  oid Process::readStdoutToBuffer()\n  {\n      const size_t b_size = 4096;\n      char buffer[b_size];\n      size_t read;\n  \n      do\n      {\n  \tread = receive(buffer, b_size);\n  \tstdout_buffer.append(buffer, read);\n      }\n      while(read == b_size);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  td::string Process::read()\n  {\n      readStdoutToBuffer();\n  \n      std::string ret(stdout_buffer);\n  \n      stdout_buffer.clear();\n  \n      return ret;\n  }\n}"
  },
  {
    "function_name": "readStdoutToBuffer(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "89-101",
    "snippet": "oid Process::readStdoutToBuffer()\n{\n    const size_t b_size = 4096;\n    char buffer[b_size];\n    size_t read;\n\n    do\n    {\n\tread = receive(buffer, b_size);\n\tstdout_buffer.append(buffer, read);\n    }\n    while(read == b_size);\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tdout_buffer.append",
          "args": [
            "uffer,",
            "ead)"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eceive(",
          "args": [
            "uffer,",
            "_size)"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  oid Process::readStdoutToBuffer()\n  {\n      const size_t b_size = 4096;\n      char buffer[b_size];\n      size_t read;\n  \n      do\n      {\n  \tread = receive(buffer, b_size);\n  \tstdout_buffer.append(buffer, read);\n      }\n      while(read == b_size);\n  }\n}"
  },
  {
    "function_name": "anyLineInStdout(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "82-87",
    "snippet": "ool Process::anyLineInStdout()\n{\n    BufferNewStdoutLines();\n\n    return IsAnyLineInBuffer(stdout_buffer);\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sAnyLineInBuffer(",
          "args": [
            "tdout_buffer)"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "IsAnyLineInBuffer(",
          "container": "rocess",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
          "lines": "161-164",
          "snippet": "ool Process::IsAnyLineInBuffer(const std::string &buffer)\n{\n    return buffer.empty();\n}",
          "includes": [
            "include <y2util/Y2SLog.h>",
            "include <cstring>\n#",
            "include <errno.h>\n#",
            "include <fcntl.h>\n#",
            "include <signal.h>\n#",
            "include \"y2util/Process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  ool Process::IsAnyLineInBuffer(const std::string &buffer)\n  {\n      return buffer.empty();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ufferNewStdoutLines(",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  ool Process::anyLineInStdout()\n  {\n      BufferNewStdoutLines();\n  \n      return IsAnyLineInBuffer(stdout_buffer);\n  }\n}"
  },
  {
    "function_name": "readLine(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "74-79",
    "snippet": "td::string Process::readLine()\n{\n    BufferNewStdoutLines();\n\n    return GetLineFromBuffer(stdout_buffer);\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "etLineFromBuffer(",
          "args": [
            "tdout_buffer)"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "GetLineFromBuffer(",
          "container": "rocess",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
          "lines": "141-158",
          "snippet": "td::string Process::GetLineFromBuffer(std::string &buffer)\n{\n    // find end of the first line\n    std::string::size_type line_pos = buffer.find(\"\\n\");\n\n    // a line found?\n    if (line_pos != std::string::npos)\n    {\n\t// remove the line from bufer and return it\n\tstd::string ret(buffer, 0, line_pos + 1);\n\tbuffer.erase(0, line_pos + 1);\n\n\treturn ret;\n    }\n\n    // no new line, return empty string\n    return std::string();\n}",
          "includes": [
            "include <y2util/Y2SLog.h>",
            "include <cstring>\n#",
            "include <errno.h>\n#",
            "include <fcntl.h>\n#",
            "include <signal.h>\n#",
            "include \"y2util/Process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  td::string Process::GetLineFromBuffer(std::string &buffer)\n  {\n      // find end of the first line\n      std::string::size_type line_pos = buffer.find(\"\\n\");\n  \n      // a line found?\n      if (line_pos != std::string::npos)\n      {\n  \t// remove the line from bufer and return it\n  \tstd::string ret(buffer, 0, line_pos + 1);\n  \tbuffer.erase(0, line_pos + 1);\n  \n  \treturn ret;\n      }\n  \n      // no new line, return empty string\n      return std::string();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ufferNewStdoutLines(",
          "args": [],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  td::string Process::readLine()\n  {\n      BufferNewStdoutLines();\n  \n      return GetLineFromBuffer(stdout_buffer);\n  }\n}"
  },
  {
    "function_name": "BufferNewStdoutLines",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "67-71",
    "snippet": "oid Process::BufferNewStdoutLines ()\n{\n    const std::string new_output = receiveUpto('\\n');\n    stdout_buffer += new_output;\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eceiveUpto(",
          "args": [
            "\\n')"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  oid Process::BufferNewStdoutLines ()\n  {\n      const std::string new_output = receiveUpto('\\n');\n      stdout_buffer += new_output;\n  }\n}"
  },
  {
    "function_name": "kill(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "62-65",
    "snippet": "ool Process::kill()\n{\n    return ExternalProgram::kill();\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xternalProgram::kill(",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "kill(",
          "container": "rocess",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
          "lines": "62-65",
          "snippet": "ool Process::kill()\n{\n    return ExternalProgram::kill();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  ool Process::kill()\n  {\n      return ExternalProgram::kill();\n  }\n}"
  },
  {
    "function_name": "kill(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "51-59",
    "snippet": "ool Process::kill(int sig)\n{\n    if (getpid() > 0)\n    {\n\treturn ::kill(getpid(), sig) == 0;\n    }\n\n    return false;\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": ":kill(",
          "args": [
            "etpid(),",
            "ig)"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etpid(",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etpid(",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  ool Process::kill(int sig)\n  {\n      if (getpid() > 0)\n      {\n  \treturn ::kill(getpid(), sig) == 0;\n      }\n  \n      return false;\n  }\n}"
  },
  {
    "function_name": "~Process(",
    "container": "rocess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
    "lines": "41-48",
    "snippet": "rocess::~Process()\n{\n    if (running())\n    {\n\tMIL << \"Terminating running process '\" << getpid() << \"'...\" << std::endl;\n\tkill();\n    }\n}",
    "includes": [
      "include <y2util/Y2SLog.h>",
      "include <cstring>\n#",
      "include <errno.h>\n#",
      "include <fcntl.h>\n#",
      "include <signal.h>\n#",
      "include \"y2util/Process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ill(",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "kill(",
          "container": "rocess",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Process.cc",
          "lines": "62-65",
          "snippet": "ool Process::kill()\n{\n    return ExternalProgram::kill();\n}",
          "includes": [
            "include <y2util/Y2SLog.h>",
            "include <cstring>\n#",
            "include <errno.h>\n#",
            "include <fcntl.h>\n#",
            "include <signal.h>\n#",
            "include \"y2util/Process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  ool Process::kill()\n  {\n      return ExternalProgram::kill();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "etpid(",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unning(",
          "args": [],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <y2util/Y2SLog.h>\ninclude <cstring>\n#\ninclude <errno.h>\n#\ninclude <fcntl.h>\n#\ninclude <signal.h>\n#\ninclude \"y2util/Process.h\"\n\nrocess {\n  rocess::~Process()\n  {\n      if (running())\n      {\n  \tMIL << \"Terminating running process '\" << getpid() << \"'...\" << std::endl;\n  \tkill();\n      }\n  }\n}"
  }
]