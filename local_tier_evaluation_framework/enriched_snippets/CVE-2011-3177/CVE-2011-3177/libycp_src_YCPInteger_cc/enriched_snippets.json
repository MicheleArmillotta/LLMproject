[
  {
    "function_name": "YCPInteger",
    "container": "YCPInteger",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
    "lines": "142-145",
    "snippet": "YCPInteger::YCPInteger (bytecodeistream & str)\n    : YCPValue (new YCPIntegerRep (fromStream (str)))\n{\n}",
    "includes": [
      "#include \"ycp/ExecutionEnvironment.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPInteger.h\"",
      "#include \"ycp/y2log.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fromStream",
          "args": [
            "str"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "fromStream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
          "lines": "123-140",
          "snippet": "static long long fromStream (bytecodeistream & str)\n{\n    char c;\n    long long ll = 0LL;\n    if (!str.get (c))\n\treturn ll;\n\n    while (c-- > 0)\n    {\n\tchar v;\n\tif (!str.get (v))\n\t    break;\n\n\tlong long lc = (unsigned char)v;\n\tll |= (lc << (sizeof (long long) - c - 1) * 8);\n    }\n    return ll;\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nstatic long long fromStream (bytecodeistream & str)\n{\n    char c;\n    long long ll = 0LL;\n    if (!str.get (c))\n\treturn ll;\n\n    while (c-- > 0)\n    {\n\tchar v;\n\tif (!str.get (v))\n\t    break;\n\n\tlong long lc = (unsigned char)v;\n\tll |= (lc << (sizeof (long long) - c - 1) * 8);\n    }\n    return ll;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nYCPInteger {\n  YCPInteger::YCPInteger (bytecodeistream & str)\n      : YCPValue (new YCPIntegerRep (fromStream (str)))\n  {\n  }\n}"
  },
  {
    "function_name": "fromStream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
    "lines": "123-140",
    "snippet": "static long long fromStream (bytecodeistream & str)\n{\n    char c;\n    long long ll = 0LL;\n    if (!str.get (c))\n\treturn ll;\n\n    while (c-- > 0)\n    {\n\tchar v;\n\tif (!str.get (v))\n\t    break;\n\n\tlong long lc = (unsigned char)v;\n\tll |= (lc << (sizeof (long long) - c - 1) * 8);\n    }\n    return ll;\n}",
    "includes": [
      "#include \"ycp/ExecutionEnvironment.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPInteger.h\"",
      "#include \"ycp/y2log.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "str.get",
          "args": [
            "v"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.get",
          "args": [
            "c"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nstatic long long fromStream (bytecodeistream & str)\n{\n    char c;\n    long long ll = 0LL;\n    if (!str.get (c))\n\treturn ll;\n\n    while (c-- > 0)\n    {\n\tchar v;\n\tif (!str.get (v))\n\t    break;\n\n\tlong long lc = (unsigned char)v;\n\tll |= (lc << (sizeof (long long) - c - 1) * 8);\n    }\n    return ll;\n}"
  },
  {
    "function_name": "valuetype",
    "container": "YCPIntegerRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
    "lines": "89-93",
    "snippet": "YCPValueType\nYCPIntegerRep::valuetype() const\n{\n    return YT_INTEGER;\n}",
    "includes": [
      "#include \"ycp/ExecutionEnvironment.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPInteger.h\"",
      "#include \"ycp/y2log.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nYCPIntegerRep {\n  YCPValueType\n  YCPIntegerRep::valuetype() const\n  {\n      return YT_INTEGER;\n  }\n}"
  },
  {
    "function_name": "toString",
    "container": "YCPIntegerRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
    "lines": "80-86",
    "snippet": "string\nYCPIntegerRep::toString() const\n{\n    char s[64];\n    snprintf (s, 64, \"%Ld\", v);\n    return string(s);\n}",
    "includes": [
      "#include \"ycp/ExecutionEnvironment.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPInteger.h\"",
      "#include \"ycp/y2log.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "string",
          "args": [
            "s"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "compare_op_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YExpression.cc",
          "lines": "435-450",
          "snippet": "static string\ncompare_op_string( YECompare::c_op op )\n{\n    switch (op)\n    {\n\tcase YECompare::C_EQ:  return \"==\"; break;\n\tcase YECompare::C_NEQ: return \"!=\"; break;\n\tcase YECompare::C_LT:  return \"<\";  break;\n\tcase YECompare::C_GE:  return \">=\"; break;\n\tcase YECompare::C_LE:  return \"<=\"; break;\n\tcase YECompare::C_GT:  return \">\";  break;\n\tdefault:\n\t\tbreak;\n    }\n    return \"?compare?\";\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/SymbolTable.h\"",
            "#include \"ycp/YExpression.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YBlock.h\"",
            "#include \"ycp/YStatement.h\"",
            "#include \"ycp/StaticDeclaration.h\"",
            "#include \"ycp/y2log.h\"",
            "#include <libintl.h>\t// for dngettext"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/SymbolTable.h\"\n#include \"ycp/YExpression.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YBlock.h\"\n#include \"ycp/YStatement.h\"\n#include \"ycp/StaticDeclaration.h\"\n#include \"ycp/y2log.h\"\n#include <libintl.h>\t// for dngettext\n\nstatic string\ncompare_op_string( YECompare::c_op op )\n{\n    switch (op)\n    {\n\tcase YECompare::C_EQ:  return \"==\"; break;\n\tcase YECompare::C_NEQ: return \"!=\"; break;\n\tcase YECompare::C_LT:  return \"<\";  break;\n\tcase YECompare::C_GE:  return \">=\"; break;\n\tcase YECompare::C_LE:  return \"<=\"; break;\n\tcase YECompare::C_GT:  return \">\";  break;\n\tdefault:\n\t\tbreak;\n    }\n    return \"?compare?\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "s",
            "64",
            "\"%Ld\"",
            "v"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nYCPIntegerRep {\n  string\n  YCPIntegerRep::toString() const\n  {\n      char s[64];\n      snprintf (s, 64, \"%Ld\", v);\n      return string(s);\n  }\n}"
  },
  {
    "function_name": "compare",
    "container": "YCPIntegerRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
    "lines": "72-77",
    "snippet": "YCPOrder\nYCPIntegerRep::compare(const YCPInteger& i) const\n{\n    if (v == i->v) return YO_EQUAL;\n    else return v < i->v ? YO_LESS : YO_GREATER;\n}",
    "includes": [
      "#include \"ycp/ExecutionEnvironment.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPInteger.h\"",
      "#include \"ycp/y2log.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nYCPIntegerRep {\n  YCPOrder\n  YCPIntegerRep::compare(const YCPInteger& i) const\n  {\n      if (v == i->v) return YO_EQUAL;\n      else return v < i->v ? YO_LESS : YO_GREATER;\n  }\n}"
  },
  {
    "function_name": "value",
    "container": "YCPIntegerRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
    "lines": "65-69",
    "snippet": "long long\nYCPIntegerRep::value() const\n{\n    return v;\n}",
    "includes": [
      "#include \"ycp/ExecutionEnvironment.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPInteger.h\"",
      "#include \"ycp/y2log.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nYCPIntegerRep {\n  long long\n  YCPIntegerRep::value() const\n  {\n      return v;\n  }\n}"
  },
  {
    "function_name": "YCPIntegerRep",
    "container": "YCPIntegerRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
    "lines": "36-62",
    "snippet": "YCPIntegerRep::YCPIntegerRep(const char *r, bool *valid)\n{\n    \n    int converted;\n    if (r && r[0] == '0')\n    {\n\tif (r[1] == 'x')\n\t    converted = sscanf(r, \"%Lx\", &v);\n\telse\n\t    converted = sscanf(r, \"%Lo\", &v);\n    }\n    else\n    {\n\tconverted = sscanf(r, \"%Ld\", &v);\n    }\n\n    if (valid != NULL)\t\t\t// return validity of passed value, if wanted\n    {\n\t*valid = (converted == 1);\n    }\n\n    if (converted != 1)\n    {\n        ycp2warning (ee.filename().c_str(), ee.linenumber(), \"Cannot convert '%s' to an integer\", r);\n        v = 0;\n    }\n}",
    "includes": [
      "#include \"ycp/ExecutionEnvironment.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPInteger.h\"",
      "#include \"ycp/y2log.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "extern ExecutionEnvironment ee;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ycp2warning",
          "args": [
            "ee.filename().c_str()",
            "ee.linenumber()",
            "\"Cannot convert '%s' to an integer\"",
            "r"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ee.linenumber",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "linenumber",
          "container": "ExecutionEnvironment",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/ExecutionEnvironment.cc",
          "lines": "41-45",
          "snippet": "int\nExecutionEnvironment::linenumber () const\n{\n    return m_linenumber;\n}",
          "includes": [
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/YStatement.h\"",
            "#include \"ycp/ExecutionEnvironment.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/y2log.h\"\n#include \"ycp/YStatement.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n\nExecutionEnvironment {\n  int\n  ExecutionEnvironment::linenumber () const\n  {\n      return m_linenumber;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ee.filename",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "filename",
          "container": "Scanner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
          "lines": "335-339",
          "snippet": "string\nScanner::filename () const\n{\n    return m_filename;\n}",
          "includes": [
            "#include \"ycp/SymbolTable.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Scanner.h\"",
            "#include <errno.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  string\n  Scanner::filename () const\n  {\n      return m_filename;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "r",
            "\"%Ld\"",
            "&v"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "r",
            "\"%Lo\"",
            "&v"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "r",
            "\"%Lx\"",
            "&v"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nextern ExecutionEnvironment ee;\n\nYCPIntegerRep {\n  YCPIntegerRep::YCPIntegerRep(const char *r, bool *valid)\n  {\n      \n      int converted;\n      if (r && r[0] == '0')\n      {\n  \tif (r[1] == 'x')\n  \t    converted = sscanf(r, \"%Lx\", &v);\n  \telse\n  \t    converted = sscanf(r, \"%Lo\", &v);\n      }\n      else\n      {\n  \tconverted = sscanf(r, \"%Ld\", &v);\n      }\n  \n      if (valid != NULL)\t\t\t// return validity of passed value, if wanted\n      {\n  \t*valid = (converted == 1);\n      }\n  \n      if (converted != 1)\n      {\n          ycp2warning (ee.filename().c_str(), ee.linenumber(), \"Cannot convert '%s' to an integer\", r);\n          v = 0;\n      }\n  }\n}"
  },
  {
    "function_name": "YCPIntegerRep",
    "container": "YCPIntegerRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
    "lines": "30-33",
    "snippet": "YCPIntegerRep::YCPIntegerRep(long long v)\n    : v(v)\n{\n}",
    "includes": [
      "#include \"ycp/ExecutionEnvironment.h\"",
      "#include \"ycp/Bytecode.h\"",
      "#include \"ycp/YCPInteger.h\"",
      "#include \"ycp/y2log.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nYCPIntegerRep {\n  YCPIntegerRep::YCPIntegerRep(long long v)\n      : v(v)\n  {\n  }\n}"
  }
]