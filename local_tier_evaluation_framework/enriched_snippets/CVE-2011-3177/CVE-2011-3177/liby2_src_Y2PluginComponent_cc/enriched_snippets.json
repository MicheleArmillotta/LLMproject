[
  {
    "function_name": "loadPlugin",
    "container": "Y2PluginComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
    "lines": "206-294",
    "snippet": "bool\nY2PluginComponent::loadPlugin (const char* name_space)\n{\n    if (handle)\n    {\n\treturn false;\n    }\n\n    y2debug (\"loadPlugin (%s), namespace (%s)\", filename.c_str(), name_space ?\n     name_space : \"nil\");\n\n    // it's too late to the change the malloc implementation\n    setenv (\"QT_FAST_MALLOC\", \"0\", 1);\n    setenv (\"KDE_MALLOC\", \"0\", 1);\n\n    // First dlopen the library.\n\n    // Note: Calls the global contructors in the library. That's the reason\n    // why we have to stop registry at the ComponentBroker. Otherwise, a second\n    // use of the plugin wouldn't use the PluginComponent and unloading would\n    // lead to a crash.\n\n#ifdef MEASURE_SPEED\n    double t1 = exact_time ();\n#endif\n    // RTLD_GLOBAL is needed (at least) for alsa 0.9 lib\n    handle = dlopen (filename.c_str(), RTLD_LAZY | RTLD_GLOBAL);\n#ifdef MEASURE_SPEED\n    double t2 = exact_time ();\n    y2milestone (\"loaded plugin %s in %fs\", filename.c_str(), t2 - t1);\n#endif\n    if (!handle)\n    {\n\ty2error (\"error loading plugin %s: %s\", filename.c_str(), dlerror());\n\treturn false;\n    }\n\n    // Locate the global y2cc.\n\n    Y2ComponentCreator* y2cc = 0;\n\n    for (int num = -1; ; num++)\n    {\n\ty2cc = locateSym (num);\n\t\n\ty2debug (\"Component creator located; %p\", y2cc);\n\n\tif (!y2cc && num == -1)\t\t// that's ok\n\t{\n\t    continue;\n\t}\n\n\tif (!y2cc)\t\t\t// that's bad\n\t{\n\t    break;\n\t}\n\t\n\t// let's try to lookup namespace if we are asked for it\n\tif (name_space != NULL)\n\t{\n\t    y2debug (\"Trying component creator to create namespace %s\", name_space);\n\t    comp = y2cc->provideNamespace (name_space);\n\t    return comp != NULL;\n\t}\n\n\tif (is_server == y2cc->isServerCreator())\t// perhaps that's it\n\t{\n\t    comp = y2cc->create (component_name.c_str());\t// try it\n\n\t    y2debug (\"Y2PluginComponent @ %p created server '%s' @ %p\",\n\t\t     this, component_name.c_str(), comp);\n\n\t    if (comp)\t\t// success\n\t    {\n\t\tif (argc > 0)\n\t\t{\n\t\t    comp->setServerOptions (argc, argv);\n\t\t}\n\t\treturn true;\n\t    }\n\t}\n\n    }\n\n    y2error (\"error loading plugin %s: can't locate componentcreator or \"\n\t     \"componentcreator can't create component\", filename.c_str());\n\n    return false;\n}",
    "includes": [
      "#include <ycp/YCPVoid.h>",
      "#include \"Y2PluginComponent.h\"",
      "#include <ycp/y2log.h>",
      "#include <sys/time.h>",
      "#include <dlfcn.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"error loading plugin %s: can't locate componentcreator or \"\n\t     \"componentcreator can't create component\"",
            "filename.c_str()"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "comp->setServerOptions",
          "args": [
            "argc",
            "argv"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "setServerOptions",
          "container": "Y2PluginComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
          "lines": "83-93",
          "snippet": "void\nY2PluginComponent::setServerOptions (int argc, char** argv)\n{\n    this->argc = argc;\n    this->argv = argv;\n    \n    if (comp)\n    {\n\tcomp->setServerOptions (argc, argv);\n    }\n}",
          "includes": [
            "#include <ycp/YCPVoid.h>",
            "#include \"Y2PluginComponent.h\"",
            "#include <ycp/y2log.h>",
            "#include <sys/time.h>",
            "#include <dlfcn.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nY2PluginComponent {\n  void\n  Y2PluginComponent::setServerOptions (int argc, char** argv)\n  {\n      this->argc = argc;\n      this->argv = argv;\n      \n      if (comp)\n      {\n  \tcomp->setServerOptions (argc, argv);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Y2PluginComponent @ %p created server '%s' @ %p\"",
            "this",
            "component_name.c_str()",
            "comp"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "component_name.c_str",
          "args": [],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2cc->create",
          "args": [
            "component_name.c_str()"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "component_name.c_str",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2cc->isServerCreator",
          "args": [],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "isServerCreator",
          "container": "Y2CCStdio",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2CCStdio.cc",
          "lines": "38-41",
          "snippet": "bool Y2CCStdio::isServerCreator () const\n{\n    return creates_servers;\n}",
          "includes": [
            "#include <ycp/y2log.h>",
            "#include \"Y2StdioComponent.h\"",
            "#include \"Y2CCStdio.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ycp/y2log.h>\n#include \"Y2StdioComponent.h\"\n#include \"Y2CCStdio.h\"\n\nY2CCStdio {\n  bool Y2CCStdio::isServerCreator () const\n  {\n      return creates_servers;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2cc->provideNamespace",
          "args": [
            "name_space"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Trying component creator to create namespace %s\"",
            "name_space"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Component creator located; %p\"",
            "y2cc"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locateSym",
          "args": [
            "num"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"error loading plugin %s: %s\"",
            "filename.c_str()",
            "dlerror()"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlerror",
          "args": [],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2milestone",
          "args": [
            "\"loaded plugin %s in %fs\"",
            "filename.c_str()",
            "t2 - t1"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exact_time",
          "args": [],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "exact_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
          "lines": "196-202",
          "snippet": "static double\nexact_time ()\n{\n    timeval time;\n    gettimeofday (&time, 0);\n    return (double) (time.tv_sec + 1.0e-6 * (double)(time.tv_usec));\n}",
          "includes": [
            "#include <ycp/YCPVoid.h>",
            "#include \"Y2PluginComponent.h\"",
            "#include <ycp/y2log.h>",
            "#include <sys/time.h>",
            "#include <dlfcn.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nstatic double\nexact_time ()\n{\n    timeval time;\n    gettimeofday (&time, 0);\n    return (double) (time.tv_sec + 1.0e-6 * (double)(time.tv_usec));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlopen",
          "args": [
            "filename.c_str()",
            "RTLD_LAZY | RTLD_GLOBAL"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setenv",
          "args": [
            "\"KDE_MALLOC\"",
            "\"0\"",
            "1"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setenv",
          "args": [
            "\"QT_FAST_MALLOC\"",
            "\"0\"",
            "1"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"loadPlugin (%s), namespace (%s)\"",
            "filename.c_str()",
            "name_space ?\n     name_space : \"nil\""
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nY2PluginComponent {\n  bool\n  Y2PluginComponent::loadPlugin (const char* name_space)\n  {\n      if (handle)\n      {\n  \treturn false;\n      }\n  \n      y2debug (\"loadPlugin (%s), namespace (%s)\", filename.c_str(), name_space ?\n       name_space : \"nil\");\n  \n      // it's too late to the change the malloc implementation\n      setenv (\"QT_FAST_MALLOC\", \"0\", 1);\n      setenv (\"KDE_MALLOC\", \"0\", 1);\n  \n      // First dlopen the library.\n  \n      // Note: Calls the global contructors in the library. That's the reason\n      // why we have to stop registry at the ComponentBroker. Otherwise, a second\n      // use of the plugin wouldn't use the PluginComponent and unloading would\n      // lead to a crash.\n  \n  #ifdef MEASURE_SPEED\n      double t1 = exact_time ();\n  #endif\n      // RTLD_GLOBAL is needed (at least) for alsa 0.9 lib\n      handle = dlopen (filename.c_str(), RTLD_LAZY | RTLD_GLOBAL);\n  #ifdef MEASURE_SPEED\n      double t2 = exact_time ();\n      y2milestone (\"loaded plugin %s in %fs\", filename.c_str(), t2 - t1);\n  #endif\n      if (!handle)\n      {\n  \ty2error (\"error loading plugin %s: %s\", filename.c_str(), dlerror());\n  \treturn false;\n      }\n  \n      // Locate the global y2cc.\n  \n      Y2ComponentCreator* y2cc = 0;\n  \n      for (int num = -1; ; num++)\n      {\n  \ty2cc = locateSym (num);\n  \t\n  \ty2debug (\"Component creator located; %p\", y2cc);\n  \n  \tif (!y2cc && num == -1)\t\t// that's ok\n  \t{\n  \t    continue;\n  \t}\n  \n  \tif (!y2cc)\t\t\t// that's bad\n  \t{\n  \t    break;\n  \t}\n  \t\n  \t// let's try to lookup namespace if we are asked for it\n  \tif (name_space != NULL)\n  \t{\n  \t    y2debug (\"Trying component creator to create namespace %s\", name_space);\n  \t    comp = y2cc->provideNamespace (name_space);\n  \t    return comp != NULL;\n  \t}\n  \n  \tif (is_server == y2cc->isServerCreator())\t// perhaps that's it\n  \t{\n  \t    comp = y2cc->create (component_name.c_str());\t// try it\n  \n  \t    y2debug (\"Y2PluginComponent @ %p created server '%s' @ %p\",\n  \t\t     this, component_name.c_str(), comp);\n  \n  \t    if (comp)\t\t// success\n  \t    {\n  \t\tif (argc > 0)\n  \t\t{\n  \t\t    comp->setServerOptions (argc, argv);\n  \t\t}\n  \t\treturn true;\n  \t    }\n  \t}\n  \n      }\n  \n      y2error (\"error loading plugin %s: can't locate componentcreator or \"\n  \t     \"componentcreator can't create component\", filename.c_str());\n  \n      return false;\n  }\n}"
  },
  {
    "function_name": "exact_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
    "lines": "196-202",
    "snippet": "static double\nexact_time ()\n{\n    timeval time;\n    gettimeofday (&time, 0);\n    return (double) (time.tv_sec + 1.0e-6 * (double)(time.tv_usec));\n}",
    "includes": [
      "#include <ycp/YCPVoid.h>",
      "#include \"Y2PluginComponent.h\"",
      "#include <ycp/y2log.h>",
      "#include <sys/time.h>",
      "#include <dlfcn.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gettimeofday",
          "args": [
            "&time",
            "0"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nstatic double\nexact_time ()\n{\n    timeval time;\n    gettimeofday (&time, 0);\n    return (double) (time.tv_sec + 1.0e-6 * (double)(time.tv_usec));\n}"
  },
  {
    "function_name": "doActualWork",
    "container": "Y2PluginComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
    "lines": "177-192",
    "snippet": "YCPValue\nY2PluginComponent::doActualWork (const YCPList& arglist,\n\t\t\t\t Y2Component* user_interface)\n{\n    if (!handle)\n    {\n\tloadPlugin ();\n    }\n\n    if (!comp)\n    {\n\treturn YCPVoid ();\n    }\n\n    return comp->doActualWork (arglist, user_interface);\n}",
    "includes": [
      "#include <ycp/YCPVoid.h>",
      "#include \"Y2PluginComponent.h\"",
      "#include <ycp/y2log.h>",
      "#include <sys/time.h>",
      "#include <dlfcn.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "comp->doActualWork",
          "args": [
            "arglist",
            "user_interface"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "doActualWork",
          "container": "Y2PluginComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
          "lines": "177-192",
          "snippet": "YCPValue\nY2PluginComponent::doActualWork (const YCPList& arglist,\n\t\t\t\t Y2Component* user_interface)\n{\n    if (!handle)\n    {\n\tloadPlugin ();\n    }\n\n    if (!comp)\n    {\n\treturn YCPVoid ();\n    }\n\n    return comp->doActualWork (arglist, user_interface);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "YCPVoid",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "YCPVoid",
          "container": "YCPVoid",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPVoid.cc",
          "lines": "72-75",
          "snippet": "YCPVoid::YCPVoid ()\n    : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n{\n}",
          "includes": [
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "YCPVoid* YCPVoid::nil = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/y2log.h\"\n\nYCPVoid* YCPVoid::nil = NULL;\n\nYCPVoid {\n  YCPVoid::YCPVoid ()\n      : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "loadPlugin",
          "args": [],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nY2PluginComponent {\n  YCPValue\n  Y2PluginComponent::doActualWork (const YCPList& arglist,\n  \t\t\t\t Y2Component* user_interface)\n  {\n      if (!handle)\n      {\n  \tloadPlugin ();\n      }\n  \n      if (!comp)\n      {\n  \treturn YCPVoid ();\n      }\n  \n      return comp->doActualWork (arglist, user_interface);\n  }\n}"
  },
  {
    "function_name": "name",
    "container": "Y2PluginComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
    "lines": "168-174",
    "snippet": "string\nY2PluginComponent::name () const\n{\n    // Note: It is also be possible to call the name function of\n    // the Y2Component.\n    return component_name;\n}",
    "includes": [
      "#include <ycp/YCPVoid.h>",
      "#include \"Y2PluginComponent.h\"",
      "#include <ycp/y2log.h>",
      "#include <sys/time.h>",
      "#include <dlfcn.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nY2PluginComponent {\n  string\n  Y2PluginComponent::name () const\n  {\n      // Note: It is also be possible to call the name function of\n      // the Y2Component.\n      return component_name;\n  }\n}"
  },
  {
    "function_name": "result",
    "container": "Y2PluginComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
    "lines": "148-165",
    "snippet": "void\nY2PluginComponent::result (const YCPValue& result)\n{\n    if (comp)\n    {\n\tcomp->result (result);\n\tdelete comp;\n\tcomp = 0;\n    }\n\n    if (handle)\n    {\n\tdlclose (handle);\n\thandle = 0;\n    }\n\n    return;\n}",
    "includes": [
      "#include <ycp/YCPVoid.h>",
      "#include \"Y2PluginComponent.h\"",
      "#include <ycp/y2log.h>",
      "#include <sys/time.h>",
      "#include <dlfcn.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlclose",
          "args": [
            "handle"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "comp->result",
          "args": [
            "result"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "result",
          "container": "Y2PluginComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
          "lines": "148-165",
          "snippet": "void\nY2PluginComponent::result (const YCPValue& result)\n{\n    if (comp)\n    {\n\tcomp->result (result);\n\tdelete comp;\n\tcomp = 0;\n    }\n\n    if (handle)\n    {\n\tdlclose (handle);\n\thandle = 0;\n    }\n\n    return;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nY2PluginComponent {\n  void\n  Y2PluginComponent::result (const YCPValue& result)\n  {\n      if (comp)\n      {\n  \tcomp->result (result);\n  \tdelete comp;\n  \tcomp = 0;\n      }\n  \n      if (handle)\n      {\n  \tdlclose (handle);\n  \thandle = 0;\n      }\n  \n      return;\n  }\n}"
  },
  {
    "function_name": "evaluate",
    "container": "Y2PluginComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
    "lines": "96-111",
    "snippet": "YCPValue\nY2PluginComponent::evaluate (const YCPValue& command)\n{\n    if (!handle)\n    {\n\tloadPlugin ();\n    }\n\n    if (!comp)\n    {\n\ty2error (\"Error loading plugin for %s\", component_name.c_str ());\n\treturn YCPNull ();\n    }\n\n    return comp->evaluate (command);\n}",
    "includes": [
      "#include <ycp/YCPVoid.h>",
      "#include \"Y2PluginComponent.h\"",
      "#include <ycp/y2log.h>",
      "#include <sys/time.h>",
      "#include <dlfcn.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "comp->evaluate",
          "args": [
            "command"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate",
          "container": "Y2PluginComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
          "lines": "96-111",
          "snippet": "YCPValue\nY2PluginComponent::evaluate (const YCPValue& command)\n{\n    if (!handle)\n    {\n\tloadPlugin ();\n    }\n\n    if (!comp)\n    {\n\ty2error (\"Error loading plugin for %s\", component_name.c_str ());\n\treturn YCPNull ();\n    }\n\n    return comp->evaluate (command);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Error loading plugin for %s\"",
            "component_name.c_str ()"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "component_name.c_str",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loadPlugin",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nY2PluginComponent {\n  YCPValue\n  Y2PluginComponent::evaluate (const YCPValue& command)\n  {\n      if (!handle)\n      {\n  \tloadPlugin ();\n      }\n  \n      if (!comp)\n      {\n  \ty2error (\"Error loading plugin for %s\", component_name.c_str ());\n  \treturn YCPNull ();\n      }\n  \n      return comp->evaluate (command);\n  }\n}"
  },
  {
    "function_name": "setServerOptions",
    "container": "Y2PluginComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
    "lines": "83-93",
    "snippet": "void\nY2PluginComponent::setServerOptions (int argc, char** argv)\n{\n    this->argc = argc;\n    this->argv = argv;\n    \n    if (comp)\n    {\n\tcomp->setServerOptions (argc, argv);\n    }\n}",
    "includes": [
      "#include <ycp/YCPVoid.h>",
      "#include \"Y2PluginComponent.h\"",
      "#include <ycp/y2log.h>",
      "#include <sys/time.h>",
      "#include <dlfcn.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "comp->setServerOptions",
          "args": [
            "argc",
            "argv"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "setServerOptions",
          "container": "Y2PluginComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
          "lines": "83-93",
          "snippet": "void\nY2PluginComponent::setServerOptions (int argc, char** argv)\n{\n    this->argc = argc;\n    this->argv = argv;\n    \n    if (comp)\n    {\n\tcomp->setServerOptions (argc, argv);\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nY2PluginComponent {\n  void\n  Y2PluginComponent::setServerOptions (int argc, char** argv)\n  {\n      this->argc = argc;\n      this->argv = argv;\n      \n      if (comp)\n      {\n  \tcomp->setServerOptions (argc, argv);\n      }\n  }\n}"
  },
  {
    "function_name": "~Y2PluginComponent",
    "container": "Y2PluginComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
    "lines": "68-80",
    "snippet": "Y2PluginComponent::~Y2PluginComponent ()\n{\n    if (comp)\n    {\n\tcomp->result (YCPVoid ());\n\tdelete comp;\n    }\n\n    if (handle)\n    {\n\tdlclose (handle);\n    }\n}",
    "includes": [
      "#include <ycp/YCPVoid.h>",
      "#include \"Y2PluginComponent.h\"",
      "#include <ycp/y2log.h>",
      "#include <sys/time.h>",
      "#include <dlfcn.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlclose",
          "args": [
            "handle"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "comp->result",
          "args": [
            "YCPVoid ()"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "result",
          "container": "Y2PluginComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
          "lines": "148-165",
          "snippet": "void\nY2PluginComponent::result (const YCPValue& result)\n{\n    if (comp)\n    {\n\tcomp->result (result);\n\tdelete comp;\n\tcomp = 0;\n    }\n\n    if (handle)\n    {\n\tdlclose (handle);\n\thandle = 0;\n    }\n\n    return;\n}",
          "includes": [
            "#include <ycp/YCPVoid.h>",
            "#include \"Y2PluginComponent.h\"",
            "#include <ycp/y2log.h>",
            "#include <sys/time.h>",
            "#include <dlfcn.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nY2PluginComponent {\n  void\n  Y2PluginComponent::result (const YCPValue& result)\n  {\n      if (comp)\n      {\n  \tcomp->result (result);\n  \tdelete comp;\n  \tcomp = 0;\n      }\n  \n      if (handle)\n      {\n  \tdlclose (handle);\n  \thandle = 0;\n      }\n  \n      return;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPVoid",
          "args": [],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "YCPVoid",
          "container": "YCPVoid",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPVoid.cc",
          "lines": "72-75",
          "snippet": "YCPVoid::YCPVoid ()\n    : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n{\n}",
          "includes": [
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "YCPVoid* YCPVoid::nil = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/y2log.h\"\n\nYCPVoid* YCPVoid::nil = NULL;\n\nYCPVoid {\n  YCPVoid::YCPVoid ()\n      : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n  {\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nY2PluginComponent {\n  Y2PluginComponent::~Y2PluginComponent ()\n  {\n      if (comp)\n      {\n  \tcomp->result (YCPVoid ());\n  \tdelete comp;\n      }\n  \n      if (handle)\n      {\n  \tdlclose (handle);\n      }\n  }\n}"
  },
  {
    "function_name": "Y2PluginComponent",
    "container": "Y2PluginComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
    "lines": "51-65",
    "snippet": "Y2PluginComponent::Y2PluginComponent (string filename, const char* creator_name,\n\t\t\t\t      const char* component_name, const char* name_space)\n    : is_server (true),\n      filename (filename),\n      creator_name (creator_name),\n      component_name (component_name),\n      argc (0),\n      argv (0),\n      level (0),\n      handle (0),\n      comp (0)\n{\n    // load the plugin right-away now, there will be no evaluate prior builtins!!!\n    loadPlugin(name_space);\n}",
    "includes": [
      "#include <ycp/YCPVoid.h>",
      "#include \"Y2PluginComponent.h\"",
      "#include <ycp/y2log.h>",
      "#include <sys/time.h>",
      "#include <dlfcn.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "loadPlugin",
          "args": [
            "name_space"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "loadPlugin",
          "container": "Y2PluginComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
          "lines": "206-294",
          "snippet": "bool\nY2PluginComponent::loadPlugin (const char* name_space)\n{\n    if (handle)\n    {\n\treturn false;\n    }\n\n    y2debug (\"loadPlugin (%s), namespace (%s)\", filename.c_str(), name_space ?\n     name_space : \"nil\");\n\n    // it's too late to the change the malloc implementation\n    setenv (\"QT_FAST_MALLOC\", \"0\", 1);\n    setenv (\"KDE_MALLOC\", \"0\", 1);\n\n    // First dlopen the library.\n\n    // Note: Calls the global contructors in the library. That's the reason\n    // why we have to stop registry at the ComponentBroker. Otherwise, a second\n    // use of the plugin wouldn't use the PluginComponent and unloading would\n    // lead to a crash.\n\n#ifdef MEASURE_SPEED\n    double t1 = exact_time ();\n#endif\n    // RTLD_GLOBAL is needed (at least) for alsa 0.9 lib\n    handle = dlopen (filename.c_str(), RTLD_LAZY | RTLD_GLOBAL);\n#ifdef MEASURE_SPEED\n    double t2 = exact_time ();\n    y2milestone (\"loaded plugin %s in %fs\", filename.c_str(), t2 - t1);\n#endif\n    if (!handle)\n    {\n\ty2error (\"error loading plugin %s: %s\", filename.c_str(), dlerror());\n\treturn false;\n    }\n\n    // Locate the global y2cc.\n\n    Y2ComponentCreator* y2cc = 0;\n\n    for (int num = -1; ; num++)\n    {\n\ty2cc = locateSym (num);\n\t\n\ty2debug (\"Component creator located; %p\", y2cc);\n\n\tif (!y2cc && num == -1)\t\t// that's ok\n\t{\n\t    continue;\n\t}\n\n\tif (!y2cc)\t\t\t// that's bad\n\t{\n\t    break;\n\t}\n\t\n\t// let's try to lookup namespace if we are asked for it\n\tif (name_space != NULL)\n\t{\n\t    y2debug (\"Trying component creator to create namespace %s\", name_space);\n\t    comp = y2cc->provideNamespace (name_space);\n\t    return comp != NULL;\n\t}\n\n\tif (is_server == y2cc->isServerCreator())\t// perhaps that's it\n\t{\n\t    comp = y2cc->create (component_name.c_str());\t// try it\n\n\t    y2debug (\"Y2PluginComponent @ %p created server '%s' @ %p\",\n\t\t     this, component_name.c_str(), comp);\n\n\t    if (comp)\t\t// success\n\t    {\n\t\tif (argc > 0)\n\t\t{\n\t\t    comp->setServerOptions (argc, argv);\n\t\t}\n\t\treturn true;\n\t    }\n\t}\n\n    }\n\n    y2error (\"error loading plugin %s: can't locate componentcreator or \"\n\t     \"componentcreator can't create component\", filename.c_str());\n\n    return false;\n}",
          "includes": [
            "#include <ycp/YCPVoid.h>",
            "#include \"Y2PluginComponent.h\"",
            "#include <ycp/y2log.h>",
            "#include <sys/time.h>",
            "#include <dlfcn.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nY2PluginComponent {\n  bool\n  Y2PluginComponent::loadPlugin (const char* name_space)\n  {\n      if (handle)\n      {\n  \treturn false;\n      }\n  \n      y2debug (\"loadPlugin (%s), namespace (%s)\", filename.c_str(), name_space ?\n       name_space : \"nil\");\n  \n      // it's too late to the change the malloc implementation\n      setenv (\"QT_FAST_MALLOC\", \"0\", 1);\n      setenv (\"KDE_MALLOC\", \"0\", 1);\n  \n      // First dlopen the library.\n  \n      // Note: Calls the global contructors in the library. That's the reason\n      // why we have to stop registry at the ComponentBroker. Otherwise, a second\n      // use of the plugin wouldn't use the PluginComponent and unloading would\n      // lead to a crash.\n  \n  #ifdef MEASURE_SPEED\n      double t1 = exact_time ();\n  #endif\n      // RTLD_GLOBAL is needed (at least) for alsa 0.9 lib\n      handle = dlopen (filename.c_str(), RTLD_LAZY | RTLD_GLOBAL);\n  #ifdef MEASURE_SPEED\n      double t2 = exact_time ();\n      y2milestone (\"loaded plugin %s in %fs\", filename.c_str(), t2 - t1);\n  #endif\n      if (!handle)\n      {\n  \ty2error (\"error loading plugin %s: %s\", filename.c_str(), dlerror());\n  \treturn false;\n      }\n  \n      // Locate the global y2cc.\n  \n      Y2ComponentCreator* y2cc = 0;\n  \n      for (int num = -1; ; num++)\n      {\n  \ty2cc = locateSym (num);\n  \t\n  \ty2debug (\"Component creator located; %p\", y2cc);\n  \n  \tif (!y2cc && num == -1)\t\t// that's ok\n  \t{\n  \t    continue;\n  \t}\n  \n  \tif (!y2cc)\t\t\t// that's bad\n  \t{\n  \t    break;\n  \t}\n  \t\n  \t// let's try to lookup namespace if we are asked for it\n  \tif (name_space != NULL)\n  \t{\n  \t    y2debug (\"Trying component creator to create namespace %s\", name_space);\n  \t    comp = y2cc->provideNamespace (name_space);\n  \t    return comp != NULL;\n  \t}\n  \n  \tif (is_server == y2cc->isServerCreator())\t// perhaps that's it\n  \t{\n  \t    comp = y2cc->create (component_name.c_str());\t// try it\n  \n  \t    y2debug (\"Y2PluginComponent @ %p created server '%s' @ %p\",\n  \t\t     this, component_name.c_str(), comp);\n  \n  \t    if (comp)\t\t// success\n  \t    {\n  \t\tif (argc > 0)\n  \t\t{\n  \t\t    comp->setServerOptions (argc, argv);\n  \t\t}\n  \t\treturn true;\n  \t    }\n  \t}\n  \n      }\n  \n      y2error (\"error loading plugin %s: can't locate componentcreator or \"\n  \t     \"componentcreator can't create component\", filename.c_str());\n  \n      return false;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nY2PluginComponent {\n  Y2PluginComponent::Y2PluginComponent (string filename, const char* creator_name,\n  \t\t\t\t      const char* component_name, const char* name_space)\n      : is_server (true),\n        filename (filename),\n        creator_name (creator_name),\n        component_name (component_name),\n        argc (0),\n        argv (0),\n        level (0),\n        handle (0),\n        comp (0)\n  {\n      // load the plugin right-away now, there will be no evaluate prior builtins!!!\n      loadPlugin(name_space);\n  }\n}"
  },
  {
    "function_name": "Y2PluginComponent",
    "container": "Y2PluginComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2PluginComponent.cc",
    "lines": "33-48",
    "snippet": "Y2PluginComponent::Y2PluginComponent (bool is_server, string filename,\n\t\t\t\t      const char* creator_name,\n\t\t\t\t      const char* component_name, int level)\n    : is_server (is_server),\n      filename (filename),\n      creator_name (creator_name),\n      component_name (component_name),\n      argc (0),\n      argv (0),\n      level (level),\n      handle (0),\n      comp (0)\n{\n    // load the plugin right-away now, there will be no evaluate prior builtins!!!\n    loadPlugin();\n}",
    "includes": [
      "#include <ycp/YCPVoid.h>",
      "#include \"Y2PluginComponent.h\"",
      "#include <ycp/y2log.h>",
      "#include <sys/time.h>",
      "#include <dlfcn.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "loadPlugin",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ycp/YCPVoid.h>\n#include \"Y2PluginComponent.h\"\n#include <ycp/y2log.h>\n#include <sys/time.h>\n#include <dlfcn.h>\n#include <stdio.h>\n\nY2PluginComponent {\n  Y2PluginComponent::Y2PluginComponent (bool is_server, string filename,\n  \t\t\t\t      const char* creator_name,\n  \t\t\t\t      const char* component_name, int level)\n      : is_server (is_server),\n        filename (filename),\n        creator_name (creator_name),\n        component_name (component_name),\n        argc (0),\n        argv (0),\n        level (level),\n        handle (0),\n        comp (0)\n  {\n      // load the plugin right-away now, there will be no evaluate prior builtins!!!\n      loadPlugin();\n  }\n}"
  }
]