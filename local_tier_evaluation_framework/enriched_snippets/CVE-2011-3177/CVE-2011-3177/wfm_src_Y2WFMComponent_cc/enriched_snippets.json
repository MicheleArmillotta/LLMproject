[
  {
    "function_name": "setupComponent",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "784-790",
    "snippet": "void Y2WFMComponent::setupComponent (string cn, string fn,\n\t\t\t\t      const YCPValue& sc)\n{\n    script = sc;\n    client_name = cn;\n    fullname = fn;\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  void Y2WFMComponent::setupComponent (string cn, string fn,\n  \t\t\t\t      const YCPValue& sc)\n  {\n      script = sc;\n      client_name = cn;\n      fullname = fn;\n  }\n}"
  },
  {
    "function_name": "CallFunction",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "689-741",
    "snippet": "YCPValue\nY2WFMComponent::CallFunction (const YCPString& client, const YCPList& args)\n{\n    /**\n     * @builtin call\n     * @short Executes a YCP client or a Y2 client component.\n     * @param string name client name\n     * @param list arguments list of arguments\n     *\n     * @description\n     * This implies * that the called YCP code has full access to\n     * all module status in the currently running YaST.\n     *\n     * The modulename is temporarily changed to the name of the\n     * called script or a component.\n     *\n     * In the example, WFM looks for the file YAST2HOME/clients/inst_mouse.ycp\n     * and executes it. If the client is not found, a Y2 client component\n     * is tried to be created.\n     *\n     * @usage call (\"inst_mouse\", [true, false]) -> ....\n     * @return any\n     */\n\n    string new_modulename = client->value ();\n\n    // try loading a client via Y2ComponentBroker\n    Y2Component* client_comp = Y2ComponentBroker::createClient (new_modulename.c_str ());\n    if (client_comp)\n    {\n\tstring filename = ee.filename ();\n\tint linenumber = ee.linenumber ();\n\tycp2milestone (filename.c_str(), linenumber,\n\t\t       \"Calling YaST client %s\", new_modulename.c_str ());\n\tycp2debug (filename.c_str(), linenumber,\n\t\t       \"(arguments: %s)\", args->toString ().c_str ());\n\tYCPValue result = client_comp->doActualWork (args, NULL);\n\tee.setFilename (filename);\n\tee.setLinenumber (linenumber);\n\tycp2milestone (filename.c_str(), linenumber, \"Called YaST client returned.\");\n\t// some clients return plaintext secrets #248300\n\tycp2debug (filename.c_str(), linenumber,\n\t\t       \"Called YaST client returned: %s\", result.isNull () ? \"nil\" : result->toString ().c_str ());\n\treturn result;\n\n    }\n    else\n    {\n\t// no help\n\tycp2error (\"Can't find YCP client component %s: %s\", new_modulename.c_str(), strerror (errno));\n\treturn YCPNull ();\n    }\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern ExecutionEnvironment ee;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"Can't find YCP client component %s: %s\"",
            "new_modulename.c_str()",
            "strerror (errno)"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_modulename.c_str",
          "args": [],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2debug",
          "args": [
            "filename.c_str()",
            "linenumber",
            "\"Called YaST client returned: %s\"",
            "result.isNull () ? \"nil\" : result->toString ().c_str ()"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result->toString",
          "args": [],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.isNull",
          "args": [],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2milestone",
          "args": [
            "filename.c_str()",
            "linenumber",
            "\"Called YaST client returned.\""
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ee.setLinenumber",
          "args": [
            "linenumber"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "setLinenumber",
          "container": "ExecutionEnvironment",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/ExecutionEnvironment.cc",
          "lines": "48-52",
          "snippet": "void\nExecutionEnvironment::setLinenumber (int line)\n{\n    m_linenumber = line;\n}",
          "includes": [
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/YStatement.h\"",
            "#include \"ycp/ExecutionEnvironment.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/y2log.h\"\n#include \"ycp/YStatement.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n\nExecutionEnvironment {\n  void\n  ExecutionEnvironment::setLinenumber (int line)\n  {\n      m_linenumber = line;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ee.setFilename",
          "args": [
            "filename"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "setFilename",
          "container": "YCPDebugger",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPDebugger.cc",
          "lines": "87-96",
          "snippet": "void\nYCPDebugger::setFilename (const char *filename)\n{\n    y2debug (\"setFilename (%s)\\n\", filename);\n    if (filename)\n    {\n\tm_filename = filename;\n    }\n    return;\n}",
          "includes": [
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCode.h\"",
            "#include \"ycp/YCPDebugger.h\"",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netdb.h>",
            "#include <netinet/in.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/y2log.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCode.h\"\n#include \"ycp/YCPDebugger.h\"\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netdb.h>\n#include <netinet/in.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n\nYCPDebugger {\n  void\n  YCPDebugger::setFilename (const char *filename)\n  {\n      y2debug (\"setFilename (%s)\\n\", filename);\n      if (filename)\n      {\n  \tm_filename = filename;\n      }\n      return;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "client_comp->doActualWork",
          "args": [
            "args",
            "NULL"
          ],
          "line": 725
        },
        "resolved": true,
        "details": {
          "function_name": "doActualWork",
          "container": "Y2WFMComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
          "lines": "135-209",
          "snippet": "YCPValue\nY2WFMComponent::doActualWork (const YCPList& arglist, Y2Component *displayserver)\n{\n    y2debug( \"Starting evaluation\" );\n    \n    bool debugger = false;\n    YCPList client_arglist = arglist;\n    \n    // hack: look only at the last entry, if it's debugger or not\n    if (arglist->size () > 0)\n    {\n\tYCPValue last = arglist->value (arglist->size ()-1);\n\tif (last->isSymbol () && last->asSymbol()->symbol() == \"debugger\")\n\t{\n\t    y2debug (\"Enabling debugger\");\n\t    debugger = true;\n\n\t    // remove the flag from the arguments\n\t    client_arglist->remove (arglist->size ()-1);\n\t}\n    }\n\n    // Prepare the arguments. It has the form [script, [clientargs...]]\n    YCPList wfm_arglist;\n    wfm_arglist->add(script);\n    wfm_arglist->add(YCPString(name()));\n    wfm_arglist->add (YCPString (fullname));\n    wfm_arglist->add(client_arglist);\n\n    // store the old arguments and module name to preserve reentrancy\n    YCPList old_arguments = argumentlist;\n    string old_modulename = modulename;\n\n    // wfm always gets three arguments:\n    // 0: any script:        script to execute\n    // 1: string modulename: name of the module to realize\n    // 2: list arglist:      arguments for that module\n\n    YCPValue script = YCPVoid();\n    modulename = \"unknown\";\n    string current_file = \"unknown\";\n    YCPList  args_for_the_script;\n\n    if (wfm_arglist->size() != 4\n\t|| !wfm_arglist->value(1)->isString()\n\t|| !wfm_arglist->value(2)->isString()\n\t|| !wfm_arglist->value(3)->isList())\n    {\n\ty2error (\"Incorrect arguments %s\", wfm_arglist->toString().c_str());\n    }\n    else\n    {\n\tscript\t\t    = wfm_arglist->value(0);\n\tmodulename\t    = wfm_arglist->value(1)->asString()->value();\n\tcurrent_file\t    = wfm_arglist->value(2)->asString()->value();\n\targumentlist\t    = wfm_arglist->value(3)->asList();\n    }\n\n    y2debug (\"Script is: %s\", script->toString().c_str());\n\n    y2debug (\"Y2WFMComponent @ %p, displayserver @ %p\", this, displayserver);\n    \n    if (debugger)\n\tscript = YCPCode ((YCodePtr)new YBreakpoint (script->asCode ()->code (), \"code start\"));\n\n    YCPValue v = script->asCode ()->evaluate ();\n\n    y2debug( \"Evaluation finished\" );\n\n    // restore the old arguments and module name to preserve reentrancy\n    argumentlist = old_arguments;\n    modulename = old_modulename;\n\n    return v;\n}",
          "includes": [
            "#include \"Y2SystemNamespace.h\"",
            "#include \"Y2WFMComponent.h\"",
            "#include <scr/SCR.h>",
            "#include <scr/SCRAgent.h>",
            "#include <ycp/YBreakpoint.h>",
            "#include <ycp/YBlock.h>",
            "#include <ycp/Bytecode.h>",
            "#include <ycp/Parser.h>",
            "#include <ycp/ExecutionEnvironment.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <y2/Y2ProgramComponent.h>",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <algorithm>",
            "#include <errno.h>",
            "#include <locale.h>",
            "#include <langinfo.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPValue\n  Y2WFMComponent::doActualWork (const YCPList& arglist, Y2Component *displayserver)\n  {\n      y2debug( \"Starting evaluation\" );\n      \n      bool debugger = false;\n      YCPList client_arglist = arglist;\n      \n      // hack: look only at the last entry, if it's debugger or not\n      if (arglist->size () > 0)\n      {\n  \tYCPValue last = arglist->value (arglist->size ()-1);\n  \tif (last->isSymbol () && last->asSymbol()->symbol() == \"debugger\")\n  \t{\n  \t    y2debug (\"Enabling debugger\");\n  \t    debugger = true;\n  \n  \t    // remove the flag from the arguments\n  \t    client_arglist->remove (arglist->size ()-1);\n  \t}\n      }\n  \n      // Prepare the arguments. It has the form [script, [clientargs...]]\n      YCPList wfm_arglist;\n      wfm_arglist->add(script);\n      wfm_arglist->add(YCPString(name()));\n      wfm_arglist->add (YCPString (fullname));\n      wfm_arglist->add(client_arglist);\n  \n      // store the old arguments and module name to preserve reentrancy\n      YCPList old_arguments = argumentlist;\n      string old_modulename = modulename;\n  \n      // wfm always gets three arguments:\n      // 0: any script:        script to execute\n      // 1: string modulename: name of the module to realize\n      // 2: list arglist:      arguments for that module\n  \n      YCPValue script = YCPVoid();\n      modulename = \"unknown\";\n      string current_file = \"unknown\";\n      YCPList  args_for_the_script;\n  \n      if (wfm_arglist->size() != 4\n  \t|| !wfm_arglist->value(1)->isString()\n  \t|| !wfm_arglist->value(2)->isString()\n  \t|| !wfm_arglist->value(3)->isList())\n      {\n  \ty2error (\"Incorrect arguments %s\", wfm_arglist->toString().c_str());\n      }\n      else\n      {\n  \tscript\t\t    = wfm_arglist->value(0);\n  \tmodulename\t    = wfm_arglist->value(1)->asString()->value();\n  \tcurrent_file\t    = wfm_arglist->value(2)->asString()->value();\n  \targumentlist\t    = wfm_arglist->value(3)->asList();\n      }\n  \n      y2debug (\"Script is: %s\", script->toString().c_str());\n  \n      y2debug (\"Y2WFMComponent @ %p, displayserver @ %p\", this, displayserver);\n      \n      if (debugger)\n  \tscript = YCPCode ((YCodePtr)new YBreakpoint (script->asCode ()->code (), \"code start\"));\n  \n      YCPValue v = script->asCode ()->evaluate ();\n  \n      y2debug( \"Evaluation finished\" );\n  \n      // restore the old arguments and module name to preserve reentrancy\n      argumentlist = old_arguments;\n      modulename = old_modulename;\n  \n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ycp2debug",
          "args": [
            "filename.c_str()",
            "linenumber",
            "\"(arguments: %s)\"",
            "args->toString ().c_str ()"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2milestone",
          "args": [
            "filename.c_str()",
            "linenumber",
            "\"Calling YaST client %s\"",
            "new_modulename.c_str ()"
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_modulename.c_str",
          "args": [],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ee.linenumber",
          "args": [],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "linenumber",
          "container": "ExecutionEnvironment",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/ExecutionEnvironment.cc",
          "lines": "41-45",
          "snippet": "int\nExecutionEnvironment::linenumber () const\n{\n    return m_linenumber;\n}",
          "includes": [
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/YStatement.h\"",
            "#include \"ycp/ExecutionEnvironment.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/y2log.h\"\n#include \"ycp/YStatement.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n\nExecutionEnvironment {\n  int\n  ExecutionEnvironment::linenumber () const\n  {\n      return m_linenumber;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ee.filename",
          "args": [],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "filename",
          "container": "Y2SystemNamespace",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2SystemNamespace.cc",
          "lines": "67-71",
          "snippet": "const string\nY2SystemNamespace::filename () const\n{\n    return \"NO FILE\";\n}",
          "includes": [
            "#include \"ycp/SymbolTable.h\"",
            "#include \"Y2SystemFunction.h\"",
            "#include \"Y2SystemNamespace.h\"",
            "#include \"Y2StdioFunction.h\"",
            "#include <y2/Y2ProgramComponent.h>",
            "#include <ycp/YCPString.h>",
            "#include <ycp/YCPVoid.h>",
            "#include <ycp/SymbolTable.h>",
            "#include <y2util/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"Y2SystemFunction.h\"\n#include \"Y2SystemNamespace.h\"\n#include \"Y2StdioFunction.h\"\n#include <y2/Y2ProgramComponent.h>\n#include <ycp/YCPString.h>\n#include <ycp/YCPVoid.h>\n#include <ycp/SymbolTable.h>\n#include <y2util/y2log.h>\n\nY2SystemNamespace {\n  const string\n  Y2SystemNamespace::filename () const\n  {\n      return \"NO FILE\";\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Y2ComponentBroker::createClient",
          "args": [
            "new_modulename.c_str ()"
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_modulename.c_str",
          "args": [],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "client->value",
          "args": [],
          "line": 713
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nextern ExecutionEnvironment ee;\n\nY2WFMComponent {\n  YCPValue\n  Y2WFMComponent::CallFunction (const YCPString& client, const YCPList& args)\n  {\n      /**\n       * @builtin call\n       * @short Executes a YCP client or a Y2 client component.\n       * @param string name client name\n       * @param list arguments list of arguments\n       *\n       * @description\n       * This implies * that the called YCP code has full access to\n       * all module status in the currently running YaST.\n       *\n       * The modulename is temporarily changed to the name of the\n       * called script or a component.\n       *\n       * In the example, WFM looks for the file YAST2HOME/clients/inst_mouse.ycp\n       * and executes it. If the client is not found, a Y2 client component\n       * is tried to be created.\n       *\n       * @usage call (\"inst_mouse\", [true, false]) -> ....\n       * @return any\n       */\n  \n      string new_modulename = client->value ();\n  \n      // try loading a client via Y2ComponentBroker\n      Y2Component* client_comp = Y2ComponentBroker::createClient (new_modulename.c_str ());\n      if (client_comp)\n      {\n  \tstring filename = ee.filename ();\n  \tint linenumber = ee.linenumber ();\n  \tycp2milestone (filename.c_str(), linenumber,\n  \t\t       \"Calling YaST client %s\", new_modulename.c_str ());\n  \tycp2debug (filename.c_str(), linenumber,\n  \t\t       \"(arguments: %s)\", args->toString ().c_str ());\n  \tYCPValue result = client_comp->doActualWork (args, NULL);\n  \tee.setFilename (filename);\n  \tee.setLinenumber (linenumber);\n  \tycp2milestone (filename.c_str(), linenumber, \"Called YaST client returned.\");\n  \t// some clients return plaintext secrets #248300\n  \tycp2debug (filename.c_str(), linenumber,\n  \t\t       \"Called YaST client returned: %s\", result.isNull () ? \"nil\" : result->toString ().c_str ());\n  \treturn result;\n  \n      }\n      else\n      {\n  \t// no help\n  \tycp2error (\"Can't find YCP client component %s: %s\", new_modulename.c_str(), strerror (errno));\n  \treturn YCPNull ();\n      }\n  }\n}"
  },
  {
    "function_name": "ClientExists",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "651-687",
    "snippet": "YCPBoolean\nY2WFMComponent::ClientExists (const YCPString& client)\n{\n    /**\n     * @builtin ClientExists\n     * @short Checks whether a YCP client exists\n     * @param string name client name\n     *\n     * @description\n     * This is similar to 'call' or 'CallFunction' but client is only\n     * checked for existence and not executed. If client exists\n     * 'true' is returned, otherwise 'false'.\n     *\n     * @usage ClientExists (\"inst_mouse\") -> true\n     * @usage ClientExists (\"missing_client\") -> false\n     * @return boolean whether client exists\n     */\n\n    string new_modulename = client->value ();\n\n    if (client.isNull() || new_modulename == \"\")\n    {\n\ty2error (\"Client name not defined %s\", new_modulename.c_str());\n\treturn YCPBoolean (false);\n    }\n\n    // try loading a client via Y2ComponentBroker\n    Y2Component* client_comp = Y2ComponentBroker::createClient (new_modulename.c_str ());\n    if (client_comp)\n    {\n\treturn YCPBoolean (true);\n    }\n    else\n    {\n\treturn YCPBoolean (false);\n    }\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPBoolean",
          "args": [
            "false"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "YCPBoolean",
          "container": "YCPBoolean",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPBoolean.cc",
          "lines": "99-107",
          "snippet": "YCPBoolean::YCPBoolean (bytecodeistream & str)\n    : YCPValue (*(\n\tBytecode::readBool (str) ? \n\ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n\t:\n\tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n    ))\n{\n}",
          "includes": [
            "#include \"Xmlcode.h\"",
            "#include \"Bytecode.h\"",
            "#include \"YCPBoolean.h\"",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "YCPBoolean* YCPBoolean::trueboolean = NULL;",
            "YCPBoolean* YCPBoolean::falseboolean = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPBoolean.h\"\n#include <ycp/y2log.h>\n\nYCPBoolean* YCPBoolean::trueboolean = NULL;\nYCPBoolean* YCPBoolean::falseboolean = NULL;\n\nYCPBoolean {\n  YCPBoolean::YCPBoolean (bytecodeistream & str)\n      : YCPValue (*(\n  \tBytecode::readBool (str) ? \n  \ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n  \t:\n  \tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n      ))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Y2ComponentBroker::createClient",
          "args": [
            "new_modulename.c_str ()"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_modulename.c_str",
          "args": [],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Client name not defined %s\"",
            "new_modulename.c_str()"
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_modulename.c_str",
          "args": [],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "client.isNull",
          "args": [],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "client->value",
          "args": [],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPBoolean\n  Y2WFMComponent::ClientExists (const YCPString& client)\n  {\n      /**\n       * @builtin ClientExists\n       * @short Checks whether a YCP client exists\n       * @param string name client name\n       *\n       * @description\n       * This is similar to 'call' or 'CallFunction' but client is only\n       * checked for existence and not executed. If client exists\n       * 'true' is returned, otherwise 'false'.\n       *\n       * @usage ClientExists (\"inst_mouse\") -> true\n       * @usage ClientExists (\"missing_client\") -> false\n       * @return boolean whether client exists\n       */\n  \n      string new_modulename = client->value ();\n  \n      if (client.isNull() || new_modulename == \"\")\n      {\n  \ty2error (\"Client name not defined %s\", new_modulename.c_str());\n  \treturn YCPBoolean (false);\n      }\n  \n      // try loading a client via Y2ComponentBroker\n      Y2Component* client_comp = Y2ComponentBroker::createClient (new_modulename.c_str ());\n      if (client_comp)\n      {\n  \treturn YCPBoolean (true);\n      }\n      else\n      {\n  \treturn YCPBoolean (false);\n      }\n  }\n}"
  },
  {
    "function_name": "Execute",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "619-648",
    "snippet": "YCPValue\nY2WFMComponent::Execute (const YCPPath &path, const YCPValue &arg1)\n{\n    /**\n     * @builtin Execute\n     * @short Special interface to the system agent. Not for general use.\n     * @param path path Path\n     * @optarg any options\n     * @return any\n     * @description\n     * WFM::Execute (.local.foo, ... ) works like SCR::Execute (.target.foo, ...)\n     * but in the inst-sys rather than on the system being installed.\n     * It only works for paths starting with .local\n     */\n\n    if (!local.start ())\n        return YCPVoid ();\n\n    // strip leading .local from path\n\n    if (path->length () < 2)\n        return YCPError (\"Too short path for WFM::Execute\");\n\n    if (path->component_str (0) != \"local\")\n        return YCPError (\"Path not '.local' in WFM::Execute\");\n\n    YCPPath p = path->at (1);\n\n    return local.agent ()->Execute (p, arg1);\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "local.agent",
          "args": [
            "p",
            "arg1"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local.agent",
          "args": [],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->at",
          "args": [
            "1"
          ],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "at",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "142-149",
          "snippet": "YCPPath\nYCPPathRep::at(long index) const\n{\n    YCPPath postfix;\n    for (int i=index; i<length(); i++)\n\tpostfix->append(components[i]);\n    return postfix;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  YCPPath\n  YCPPathRep::at(long index) const\n  {\n      YCPPath postfix;\n      for (int i=index; i<length(); i++)\n  \tpostfix->append(components[i]);\n      return postfix;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPError",
          "args": [
            "\"Path not '.local' in WFM::Execute\""
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->component_str",
          "args": [
            "0"
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPError",
          "args": [
            "\"Too short path for WFM::Execute\""
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->length",
          "args": [],
          "line": 639
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPVoid",
          "args": [],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "YCPVoid",
          "container": "YCPVoid",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPVoid.cc",
          "lines": "72-75",
          "snippet": "YCPVoid::YCPVoid ()\n    : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n{\n}",
          "includes": [
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "YCPVoid* YCPVoid::nil = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/y2log.h\"\n\nYCPVoid* YCPVoid::nil = NULL;\n\nYCPVoid {\n  YCPVoid::YCPVoid ()\n      : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "local.start",
          "args": [],
          "line": 634
        },
        "resolved": true,
        "details": {
          "function_name": "start",
          "container": "WFMSubAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/WFMSubAgent.cc",
          "lines": "53-76",
          "snippet": "bool\nWFMSubAgent::start ()\n{\n    if (!my_comp)\n    {\n\ty2debug (\"Creating SubAgent: %d %s\", my_handle, my_name.c_str ());\n\tmy_comp = Y2ComponentBroker::createServer (my_name.c_str ());\n\n\tif (!my_comp)\n\t{\n\t    ycp2error (\"Can't create component '%s'\", my_name.c_str ());\n\t}\n\telse\n\t{\n\t    if (my_comp->getSCRAgent () == NULL)\n\t    {\n\t\t// the component does not have a SCR agent, better try to push over stdio\n\t\tmy_agent = new StdioSCRAgent (my_comp);\n\t    }\n\t}\n    }\n\n    return my_comp != 0;\n}",
          "includes": [
            "#include <WFMSubAgent.h>",
            "#include \"../../scr/src/StdioSCRAgent.h\"",
            "#include <scr/SCRAgent.h>",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <WFMSubAgent.h>\n#include \"../../scr/src/StdioSCRAgent.h\"\n#include <scr/SCRAgent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/y2log.h>\n\nWFMSubAgent {\n  bool\n  WFMSubAgent::start ()\n  {\n      if (!my_comp)\n      {\n  \ty2debug (\"Creating SubAgent: %d %s\", my_handle, my_name.c_str ());\n  \tmy_comp = Y2ComponentBroker::createServer (my_name.c_str ());\n  \n  \tif (!my_comp)\n  \t{\n  \t    ycp2error (\"Can't create component '%s'\", my_name.c_str ());\n  \t}\n  \telse\n  \t{\n  \t    if (my_comp->getSCRAgent () == NULL)\n  \t    {\n  \t\t// the component does not have a SCR agent, better try to push over stdio\n  \t\tmy_agent = new StdioSCRAgent (my_comp);\n  \t    }\n  \t}\n      }\n  \n      return my_comp != 0;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPValue\n  Y2WFMComponent::Execute (const YCPPath &path, const YCPValue &arg1)\n  {\n      /**\n       * @builtin Execute\n       * @short Special interface to the system agent. Not for general use.\n       * @param path path Path\n       * @optarg any options\n       * @return any\n       * @description\n       * WFM::Execute (.local.foo, ... ) works like SCR::Execute (.target.foo, ...)\n       * but in the inst-sys rather than on the system being installed.\n       * It only works for paths starting with .local\n       */\n  \n      if (!local.start ())\n          return YCPVoid ();\n  \n      // strip leading .local from path\n  \n      if (path->length () < 2)\n          return YCPError (\"Too short path for WFM::Execute\");\n  \n      if (path->component_str (0) != \"local\")\n          return YCPError (\"Path not '.local' in WFM::Execute\");\n  \n      YCPPath p = path->at (1);\n  \n      return local.agent ()->Execute (p, arg1);\n  }\n}"
  },
  {
    "function_name": "Write",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "587-616",
    "snippet": "YCPValue\nY2WFMComponent::Write (const YCPPath &path, const YCPValue &arg1, const YCPValue &arg2)\n{\n    /**\n     * @builtin Write\n     * @short Special interface to the system agent. Not for general use.\n     * @param path path Path\n     * @optarg any options\n     * @return boolean\n     * @description\n     * WFM::Write (.local.foo, ... ) works like SCR::Write (.target.foo, ...)\n     * but in the inst-sys rather than on the system being installed.\n     * It only works for paths starting with .local\n     */\n\n    if (!local.start ())\n        return YCPVoid ();\n\n    // strip leading .local from path\n\n    if (path->length () < 2)\n        return YCPError (\"Too short path for WFM::Write\");\n\n    if (path->component_str (0) != \"local\")\n        return YCPError (\"Path not '.local' in WFM::Write\");\n\n    YCPPath p = path->at (1);\n\n    return local.agent ()->Write (p, arg1, arg2);\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "local.agent",
          "args": [
            "p",
            "arg1",
            "arg2"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local.agent",
          "args": [],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->at",
          "args": [
            "1"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "at",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "142-149",
          "snippet": "YCPPath\nYCPPathRep::at(long index) const\n{\n    YCPPath postfix;\n    for (int i=index; i<length(); i++)\n\tpostfix->append(components[i]);\n    return postfix;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  YCPPath\n  YCPPathRep::at(long index) const\n  {\n      YCPPath postfix;\n      for (int i=index; i<length(); i++)\n  \tpostfix->append(components[i]);\n      return postfix;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPError",
          "args": [
            "\"Path not '.local' in WFM::Write\""
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->component_str",
          "args": [
            "0"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPError",
          "args": [
            "\"Too short path for WFM::Write\""
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->length",
          "args": [],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPVoid",
          "args": [],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "YCPVoid",
          "container": "YCPVoid",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPVoid.cc",
          "lines": "72-75",
          "snippet": "YCPVoid::YCPVoid ()\n    : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n{\n}",
          "includes": [
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "YCPVoid* YCPVoid::nil = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/y2log.h\"\n\nYCPVoid* YCPVoid::nil = NULL;\n\nYCPVoid {\n  YCPVoid::YCPVoid ()\n      : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "local.start",
          "args": [],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "start",
          "container": "WFMSubAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/WFMSubAgent.cc",
          "lines": "53-76",
          "snippet": "bool\nWFMSubAgent::start ()\n{\n    if (!my_comp)\n    {\n\ty2debug (\"Creating SubAgent: %d %s\", my_handle, my_name.c_str ());\n\tmy_comp = Y2ComponentBroker::createServer (my_name.c_str ());\n\n\tif (!my_comp)\n\t{\n\t    ycp2error (\"Can't create component '%s'\", my_name.c_str ());\n\t}\n\telse\n\t{\n\t    if (my_comp->getSCRAgent () == NULL)\n\t    {\n\t\t// the component does not have a SCR agent, better try to push over stdio\n\t\tmy_agent = new StdioSCRAgent (my_comp);\n\t    }\n\t}\n    }\n\n    return my_comp != 0;\n}",
          "includes": [
            "#include <WFMSubAgent.h>",
            "#include \"../../scr/src/StdioSCRAgent.h\"",
            "#include <scr/SCRAgent.h>",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <WFMSubAgent.h>\n#include \"../../scr/src/StdioSCRAgent.h\"\n#include <scr/SCRAgent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/y2log.h>\n\nWFMSubAgent {\n  bool\n  WFMSubAgent::start ()\n  {\n      if (!my_comp)\n      {\n  \ty2debug (\"Creating SubAgent: %d %s\", my_handle, my_name.c_str ());\n  \tmy_comp = Y2ComponentBroker::createServer (my_name.c_str ());\n  \n  \tif (!my_comp)\n  \t{\n  \t    ycp2error (\"Can't create component '%s'\", my_name.c_str ());\n  \t}\n  \telse\n  \t{\n  \t    if (my_comp->getSCRAgent () == NULL)\n  \t    {\n  \t\t// the component does not have a SCR agent, better try to push over stdio\n  \t\tmy_agent = new StdioSCRAgent (my_comp);\n  \t    }\n  \t}\n      }\n  \n      return my_comp != 0;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPValue\n  Y2WFMComponent::Write (const YCPPath &path, const YCPValue &arg1, const YCPValue &arg2)\n  {\n      /**\n       * @builtin Write\n       * @short Special interface to the system agent. Not for general use.\n       * @param path path Path\n       * @optarg any options\n       * @return boolean\n       * @description\n       * WFM::Write (.local.foo, ... ) works like SCR::Write (.target.foo, ...)\n       * but in the inst-sys rather than on the system being installed.\n       * It only works for paths starting with .local\n       */\n  \n      if (!local.start ())\n          return YCPVoid ();\n  \n      // strip leading .local from path\n  \n      if (path->length () < 2)\n          return YCPError (\"Too short path for WFM::Write\");\n  \n      if (path->component_str (0) != \"local\")\n          return YCPError (\"Path not '.local' in WFM::Write\");\n  \n      YCPPath p = path->at (1);\n  \n      return local.agent ()->Write (p, arg1, arg2);\n  }\n}"
  },
  {
    "function_name": "Read",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "548-584",
    "snippet": "YCPValue\nY2WFMComponent::Read (const YCPPath &path, const YCPValue& arg)\n{\n    /**\n     * @builtin Read\n     * @short Special interface to the system agent. Not for general use.\n     * @param path path Path\n     * @optarg any options\n     * @return any\n     * @description\n     * WFM::Read (.local.foo, ... ) works like SCR::Read (.target.foo, ...)\n     * but in the inst-sys rather than on the system being installed.\n     * It only works for paths starting with .local\n     */\n\n    if (!local.start ())\n        return YCPVoid ();\n\n    // strip leading .local from path\n\n    if (path->length () < 2)\n        return YCPError (\"Too short path for WFM::Read\");\n\n    if (path->component_str (0) != \"local\")\n        return YCPError (\"Path not '.local' in WFM::Read\");\n\n    YCPPath p = path->at (1);\n\n    if (arg.isNull ())\n    {\n        return local.agent ()->Read (p);\n    }\n    else\n    {\n        return local.agent ()->Read (p, arg);\n    }\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "local.agent",
          "args": [
            "p",
            "arg"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local.agent",
          "args": [],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local.agent",
          "args": [
            "p"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local.agent",
          "args": [],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arg.isNull",
          "args": [],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->at",
          "args": [
            "1"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "at",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "142-149",
          "snippet": "YCPPath\nYCPPathRep::at(long index) const\n{\n    YCPPath postfix;\n    for (int i=index; i<length(); i++)\n\tpostfix->append(components[i]);\n    return postfix;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  YCPPath\n  YCPPathRep::at(long index) const\n  {\n      YCPPath postfix;\n      for (int i=index; i<length(); i++)\n  \tpostfix->append(components[i]);\n      return postfix;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPError",
          "args": [
            "\"Path not '.local' in WFM::Read\""
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->component_str",
          "args": [
            "0"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPError",
          "args": [
            "\"Too short path for WFM::Read\""
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->length",
          "args": [],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPVoid",
          "args": [],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "YCPVoid",
          "container": "YCPVoid",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPVoid.cc",
          "lines": "72-75",
          "snippet": "YCPVoid::YCPVoid ()\n    : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n{\n}",
          "includes": [
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "YCPVoid* YCPVoid::nil = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/y2log.h\"\n\nYCPVoid* YCPVoid::nil = NULL;\n\nYCPVoid {\n  YCPVoid::YCPVoid ()\n      : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "local.start",
          "args": [],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "start",
          "container": "WFMSubAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/WFMSubAgent.cc",
          "lines": "53-76",
          "snippet": "bool\nWFMSubAgent::start ()\n{\n    if (!my_comp)\n    {\n\ty2debug (\"Creating SubAgent: %d %s\", my_handle, my_name.c_str ());\n\tmy_comp = Y2ComponentBroker::createServer (my_name.c_str ());\n\n\tif (!my_comp)\n\t{\n\t    ycp2error (\"Can't create component '%s'\", my_name.c_str ());\n\t}\n\telse\n\t{\n\t    if (my_comp->getSCRAgent () == NULL)\n\t    {\n\t\t// the component does not have a SCR agent, better try to push over stdio\n\t\tmy_agent = new StdioSCRAgent (my_comp);\n\t    }\n\t}\n    }\n\n    return my_comp != 0;\n}",
          "includes": [
            "#include <WFMSubAgent.h>",
            "#include \"../../scr/src/StdioSCRAgent.h\"",
            "#include <scr/SCRAgent.h>",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <WFMSubAgent.h>\n#include \"../../scr/src/StdioSCRAgent.h\"\n#include <scr/SCRAgent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/y2log.h>\n\nWFMSubAgent {\n  bool\n  WFMSubAgent::start ()\n  {\n      if (!my_comp)\n      {\n  \ty2debug (\"Creating SubAgent: %d %s\", my_handle, my_name.c_str ());\n  \tmy_comp = Y2ComponentBroker::createServer (my_name.c_str ());\n  \n  \tif (!my_comp)\n  \t{\n  \t    ycp2error (\"Can't create component '%s'\", my_name.c_str ());\n  \t}\n  \telse\n  \t{\n  \t    if (my_comp->getSCRAgent () == NULL)\n  \t    {\n  \t\t// the component does not have a SCR agent, better try to push over stdio\n  \t\tmy_agent = new StdioSCRAgent (my_comp);\n  \t    }\n  \t}\n      }\n  \n      return my_comp != 0;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPValue\n  Y2WFMComponent::Read (const YCPPath &path, const YCPValue& arg)\n  {\n      /**\n       * @builtin Read\n       * @short Special interface to the system agent. Not for general use.\n       * @param path path Path\n       * @optarg any options\n       * @return any\n       * @description\n       * WFM::Read (.local.foo, ... ) works like SCR::Read (.target.foo, ...)\n       * but in the inst-sys rather than on the system being installed.\n       * It only works for paths starting with .local\n       */\n  \n      if (!local.start ())\n          return YCPVoid ();\n  \n      // strip leading .local from path\n  \n      if (path->length () < 2)\n          return YCPError (\"Too short path for WFM::Read\");\n  \n      if (path->component_str (0) != \"local\")\n          return YCPError (\"Path not '.local' in WFM::Read\");\n  \n      YCPPath p = path->at (1);\n  \n      if (arg.isNull ())\n      {\n          return local.agent ()->Read (p);\n      }\n      else\n      {\n          return local.agent ()->Read (p, arg);\n      }\n  }\n}"
  },
  {
    "function_name": "SetLanguage",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "476-545",
    "snippet": "YCPString\nY2WFMComponent::SetLanguage (const YCPString& language, const YCPString& encoding)\n{\n    /**\n     * @builtin SetLanguage\n     * @short Selects the language for translate()\n     * @param string language\n     * @optarg string encoding\n     * @usage SetLanguage(\"de_DE\", \"UTF-8\") -> \"\"\n     * @usage SetLanguage(\"de_DE@euro\") -> \"ISO-8859-15\"\n     *\n     * @description\n     * The \"<proposed encoding>\" is the output of 'nl_langinfo (CODESET)'\n     * and only given if SetLanguage() is called with a single argument.\n     *\n     * @return string proposed encoding\n     * have fun\n     *\n     */\n\n    string proposedEncoding;\n\n    currentLanguage = language->value ();\n\n    if (! encoding.isNull ())\n    {\n\tsystemEncoding = encoding->value();\n\ty2milestone( \"SET encoding to: %s\", systemEncoding.c_str() );\n    }\n    else\n    {\n\t// get current LC_CTYPE\n\tstring locale = setlocale( LC_CTYPE, NULL );\n\n        // prepare for nl_langinfo (set LC_CTYPE)\n\tsetlocale ( LC_CTYPE, currentLanguage.c_str());\n\n\t// get the proposed encoding from nl_langinfo()\n\tproposedEncoding = nl_langinfo (CODESET);\n\tif (proposedEncoding.empty())\n\t{\n\t    y2warning (\"nl_langinfo returns empty encoding for %s\", currentLanguage.c_str());\n\t}\n\telse\n\t{\n\t    systemEncoding = proposedEncoding;\n\t}\n\n\ty2milestone ( \"GET encoding for %s:  %s\", currentLanguage.c_str(), proposedEncoding.c_str() );\n\n\t// reset LC_CTYPE !!! (for ncurses)\n\tsetlocale( LC_CTYPE, locale.c_str() );\n    }\n\n    setlocale (LC_NUMERIC, \"C\");       // always format numbers with \".\"\n\n    /* Change language. see info:gettext: */\n    setenv (\"LANGUAGE\", currentLanguage.c_str(), 1);\n\n    /* Make change known.  */\n    {\n        extern int _nl_msg_cat_cntr;\n        ++_nl_msg_cat_cntr;\n    }\n\n    // FIXME: should be ycp2debug\n    y2debug ( \"WFM SetLanguage(\\\"%s\\\"), Encoding(\\\"%s\\\")\",\n\t       currentLanguage.c_str(), systemEncoding.c_str());\n    return YCPString (proposedEncoding);\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "proposedEncoding"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"WFM SetLanguage(\\\"%s\\\"), Encoding(\\\"%s\\\")\"",
            "currentLanguage.c_str()",
            "systemEncoding.c_str()"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "systemEncoding.c_str",
          "args": [],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentLanguage.c_str",
          "args": [],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setenv",
          "args": [
            "\"LANGUAGE\"",
            "currentLanguage.c_str()",
            "1"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentLanguage.c_str",
          "args": [],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setlocale",
          "args": [
            "LC_NUMERIC",
            "\"C\""
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setlocale",
          "args": [
            "LC_CTYPE",
            "locale.c_str()"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locale.c_str",
          "args": [],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2milestone",
          "args": [
            "\"GET encoding for %s:  %s\"",
            "currentLanguage.c_str()",
            "proposedEncoding.c_str()"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proposedEncoding.c_str",
          "args": [],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentLanguage.c_str",
          "args": [],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2warning",
          "args": [
            "\"nl_langinfo returns empty encoding for %s\"",
            "currentLanguage.c_str()"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentLanguage.c_str",
          "args": [],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proposedEncoding.empty",
          "args": [],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "nl_langinfo",
          "args": [
            "CODESET"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setlocale",
          "args": [
            "LC_CTYPE",
            "currentLanguage.c_str()"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentLanguage.c_str",
          "args": [],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setlocale",
          "args": [
            "LC_CTYPE",
            "NULL"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2milestone",
          "args": [
            "\"SET encoding to: %s\"",
            "systemEncoding.c_str()"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "systemEncoding.c_str",
          "args": [],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encoding->value",
          "args": [],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "encoding.isNull",
          "args": [],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPString\n  Y2WFMComponent::SetLanguage (const YCPString& language, const YCPString& encoding)\n  {\n      /**\n       * @builtin SetLanguage\n       * @short Selects the language for translate()\n       * @param string language\n       * @optarg string encoding\n       * @usage SetLanguage(\"de_DE\", \"UTF-8\") -> \"\"\n       * @usage SetLanguage(\"de_DE@euro\") -> \"ISO-8859-15\"\n       *\n       * @description\n       * The \"<proposed encoding>\" is the output of 'nl_langinfo (CODESET)'\n       * and only given if SetLanguage() is called with a single argument.\n       *\n       * @return string proposed encoding\n       * have fun\n       *\n       */\n  \n      string proposedEncoding;\n  \n      currentLanguage = language->value ();\n  \n      if (! encoding.isNull ())\n      {\n  \tsystemEncoding = encoding->value();\n  \ty2milestone( \"SET encoding to: %s\", systemEncoding.c_str() );\n      }\n      else\n      {\n  \t// get current LC_CTYPE\n  \tstring locale = setlocale( LC_CTYPE, NULL );\n  \n          // prepare for nl_langinfo (set LC_CTYPE)\n  \tsetlocale ( LC_CTYPE, currentLanguage.c_str());\n  \n  \t// get the proposed encoding from nl_langinfo()\n  \tproposedEncoding = nl_langinfo (CODESET);\n  \tif (proposedEncoding.empty())\n  \t{\n  \t    y2warning (\"nl_langinfo returns empty encoding for %s\", currentLanguage.c_str());\n  \t}\n  \telse\n  \t{\n  \t    systemEncoding = proposedEncoding;\n  \t}\n  \n  \ty2milestone ( \"GET encoding for %s:  %s\", currentLanguage.c_str(), proposedEncoding.c_str() );\n  \n  \t// reset LC_CTYPE !!! (for ncurses)\n  \tsetlocale( LC_CTYPE, locale.c_str() );\n      }\n  \n      setlocale (LC_NUMERIC, \"C\");       // always format numbers with \".\"\n  \n      /* Change language. see info:gettext: */\n      setenv (\"LANGUAGE\", currentLanguage.c_str(), 1);\n  \n      /* Make change known.  */\n      {\n          extern int _nl_msg_cat_cntr;\n          ++_nl_msg_cat_cntr;\n      }\n  \n      // FIXME: should be ycp2debug\n      y2debug ( \"WFM SetLanguage(\\\"%s\\\"), Encoding(\\\"%s\\\")\",\n  \t       currentLanguage.c_str(), systemEncoding.c_str());\n      return YCPString (proposedEncoding);\n  }\n}"
  },
  {
    "function_name": "GetEnvironmentEncoding",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "464-473",
    "snippet": "YCPString\nY2WFMComponent::GetEnvironmentEncoding ()\n{\n    /**\n     * @builtin GetEnvironmentEncoding\n     * @short Returns the encoding code of the environment where YaST is started\n     * @return string encoding code of the environment\n     */\n    return YCPString(environmentEncoding);\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "environmentEncoding"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPString\n  Y2WFMComponent::GetEnvironmentEncoding ()\n  {\n      /**\n       * @builtin GetEnvironmentEncoding\n       * @short Returns the encoding code of the environment where YaST is started\n       * @return string encoding code of the environment\n       */\n      return YCPString(environmentEncoding);\n  }\n}"
  },
  {
    "function_name": "GetEncoding",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "451-461",
    "snippet": "YCPString\nY2WFMComponent::GetEncoding () const\n{\n    /**\n     * @builtin GetEncoding\n     * @short Returns the current encoding code\n     * @return string Encoding\n     */\n\n    return YCPString(systemEncoding);\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "systemEncoding"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPString\n  Y2WFMComponent::GetEncoding () const\n  {\n      /**\n       * @builtin GetEncoding\n       * @short Returns the current encoding code\n       * @return string Encoding\n       */\n  \n      return YCPString(systemEncoding);\n  }\n}"
  },
  {
    "function_name": "GetLanguage",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "438-448",
    "snippet": "YCPString\nY2WFMComponent::GetLanguage () const\n{\n    /**\n     * @builtin GetLanguage\n     * @short Returns the current language code (without modifiers !)\n     * @return string Language\n     */\n\n    return YCPString(currentLanguage);\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "currentLanguage"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPString\n  Y2WFMComponent::GetLanguage () const\n  {\n      /**\n       * @builtin GetLanguage\n       * @short Returns the current language code (without modifiers !)\n       * @return string Language\n       */\n  \n      return YCPString(currentLanguage);\n  }\n}"
  },
  {
    "function_name": "Args",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "397-435",
    "snippet": "YCPValue\nY2WFMComponent::Args (const YCPInteger& i) const\n{\n    /**\n     * @builtin Args\n     * @short Returns the arguments with which the module was called.\n     * @description\n     * The result is a list whose\n     * arguments are the module's arguments. If the module\n     * was called with <tt>CallFunction(\"my_mod\", [17,true])</tt>,\n     * <tt>Args()</tt> will return <tt>[ 17, true ]</tt>.\n     *\n     * @return list List of arguments\n     */\n\n    if (i.isNull ())\n    {\n\treturn argumentlist;\n    }\n    else\n    {\n\tYCPList arglist = argumentlist;\n\tlong long index = i->value ();\n\tif (index < 0)\n\t{\n\t    return YCPError (\"Invalid negative index to Args(). Only values >= 0 are allowed\");\n\t}\n\telse if (index < arglist->size())\n\t{\n\t    return arglist->value (index);\n\t}\n\telse\n\t{\n\t    return YCPError (\"Index to Args() larger than number of available arguments.\");\n\t}\n    }\n\n    return YCPNull();\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPError",
          "args": [
            "\"Index to Args() larger than number of available arguments.\""
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arglist->value",
          "args": [
            "index"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "arglist->size",
          "args": [],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPError",
          "args": [
            "\"Invalid negative index to Args(). Only values >= 0 are allowed\""
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->value",
          "args": [],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i.isNull",
          "args": [],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPValue\n  Y2WFMComponent::Args (const YCPInteger& i) const\n  {\n      /**\n       * @builtin Args\n       * @short Returns the arguments with which the module was called.\n       * @description\n       * The result is a list whose\n       * arguments are the module's arguments. If the module\n       * was called with <tt>CallFunction(\"my_mod\", [17,true])</tt>,\n       * <tt>Args()</tt> will return <tt>[ 17, true ]</tt>.\n       *\n       * @return list List of arguments\n       */\n  \n      if (i.isNull ())\n      {\n  \treturn argumentlist;\n      }\n      else\n      {\n  \tYCPList arglist = argumentlist;\n  \tlong long index = i->value ();\n  \tif (index < 0)\n  \t{\n  \t    return YCPError (\"Invalid negative index to Args(). Only values >= 0 are allowed\");\n  \t}\n  \telse if (index < arglist->size())\n  \t{\n  \t    return arglist->value (index);\n  \t}\n  \telse\n  \t{\n  \t    return YCPError (\"Index to Args() larger than number of available arguments.\");\n  \t}\n      }\n  \n      return YCPNull();\n  }\n}"
  },
  {
    "function_name": "SCRGetDefault",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "384-394",
    "snippet": "YCPInteger\nY2WFMComponent::SCRGetDefault () const\n{\n    /**\n     * @builtin SCRGetDefault\n     * @short Gets the default scr instance.\n     * @return integer Default SCR handle\n     */\n\n    return YCPInteger (default_handle);\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPInteger",
          "args": [
            "default_handle"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "YCPInteger",
          "container": "YCPInteger",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
          "lines": "142-145",
          "snippet": "YCPInteger::YCPInteger (bytecodeistream & str)\n    : YCPValue (new YCPIntegerRep (fromStream (str)))\n{\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nYCPInteger {\n  YCPInteger::YCPInteger (bytecodeistream & str)\n      : YCPValue (new YCPIntegerRep (fromStream (str)))\n  {\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPInteger\n  Y2WFMComponent::SCRGetDefault () const\n  {\n      /**\n       * @builtin SCRGetDefault\n       * @short Gets the default scr instance.\n       * @return integer Default SCR handle\n       */\n  \n      return YCPInteger (default_handle);\n  }\n}"
  },
  {
    "function_name": "SCRSetDefault",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "346-381",
    "snippet": "void\nY2WFMComponent::SCRSetDefault (const YCPInteger &handle)\n{\n    /**\n     * @builtin SCRSetDefault\n     * @short Sets the default scr instance.\n     * @param integer handle SCR handle\n     * @return void\n     */\n\n    y2milestone (\"Setting default SCR: %s\", handle->toString ().c_str ());\n\n    default_handle = handle->value ();\n    WFMSubAgents::iterator it = find_handle (default_handle);\n    if (it != scrs.end ())\n    {\n\tif ((*it)->agent ())\n\t{\n\t    (*it)->agent ()->setAsCurrentSCR ();\n\n\t    bool remote = (*it)->comp ()->remote ();\n\n\t    for ( SystemNamespaces::iterator ns = system_namespaces.begin ();\n\t\t    ns != system_namespaces.end (); ns ++ )\n\t    {\n\t\ty2milestone (\"Redirecting system namespace '%s' via '%s'\"\n\t\t    , (*ns)->name ().c_str (), (*it)->comp ()->name ().c_str ());\n\n\t\tif (remote)\n\t\t    (*ns)->useRemote (dynamic_cast<Y2ProgramComponent*>((*it)->comp ()));\n\t\telse\n\t\t    (*ns)->useLocal ();\n\t    }\n\t}\n    }\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dynamic_cast<Y2ProgramComponent*>((*it)->comp ())"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dynamic_cast<Y2ProgramComponent*>",
          "args": [
            "(*it)->comp ()"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2milestone",
          "args": [
            "\"Redirecting system namespace '%s' via '%s'\"",
            "(*ns)->name ().c_str ()",
            "(*it)->comp ()->name ().c_str ()"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "system_namespaces.end",
          "args": [],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "system_namespaces.begin",
          "args": [],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_handle",
          "args": [
            "default_handle"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "find_handle",
          "container": "Y2WFMComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
          "lines": "212-222",
          "snippet": "Y2WFMComponent::WFMSubAgents::iterator\nY2WFMComponent::find_handle (int handle)\n{\n    WFMSubAgents::iterator it = std::lower_bound (scrs.begin (), scrs.end (),\n                                                  handle, wfmsubagent_less);\n\n    if (it != scrs.end () && (*it)->get_handle () == handle)\n        return it;\n\n    return scrs.end ();\n}",
          "includes": [
            "#include \"Y2SystemNamespace.h\"",
            "#include \"Y2WFMComponent.h\"",
            "#include <scr/SCR.h>",
            "#include <scr/SCRAgent.h>",
            "#include <ycp/YBreakpoint.h>",
            "#include <ycp/YBlock.h>",
            "#include <ycp/Bytecode.h>",
            "#include <ycp/Parser.h>",
            "#include <ycp/ExecutionEnvironment.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <y2/Y2ProgramComponent.h>",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <algorithm>",
            "#include <errno.h>",
            "#include <locale.h>",
            "#include <langinfo.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  Y2WFMComponent::WFMSubAgents::iterator\n  Y2WFMComponent::find_handle (int handle)\n  {\n      WFMSubAgents::iterator it = std::lower_bound (scrs.begin (), scrs.end (),\n                                                    handle, wfmsubagent_less);\n  \n      if (it != scrs.end () && (*it)->get_handle () == handle)\n          return it;\n  \n      return scrs.end ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "handle->value",
          "args": [],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2milestone",
          "args": [
            "\"Setting default SCR: %s\"",
            "handle->toString ().c_str ()"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "handle->toString",
          "args": [],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  void\n  Y2WFMComponent::SCRSetDefault (const YCPInteger &handle)\n  {\n      /**\n       * @builtin SCRSetDefault\n       * @short Sets the default scr instance.\n       * @param integer handle SCR handle\n       * @return void\n       */\n  \n      y2milestone (\"Setting default SCR: %s\", handle->toString ().c_str ());\n  \n      default_handle = handle->value ();\n      WFMSubAgents::iterator it = find_handle (default_handle);\n      if (it != scrs.end ())\n      {\n  \tif ((*it)->agent ())\n  \t{\n  \t    (*it)->agent ()->setAsCurrentSCR ();\n  \n  \t    bool remote = (*it)->comp ()->remote ();\n  \n  \t    for ( SystemNamespaces::iterator ns = system_namespaces.begin ();\n  \t\t    ns != system_namespaces.end (); ns ++ )\n  \t    {\n  \t\ty2milestone (\"Redirecting system namespace '%s' via '%s'\"\n  \t\t    , (*ns)->name ().c_str (), (*it)->comp ()->name ().c_str ());\n  \n  \t\tif (remote)\n  \t\t    (*ns)->useRemote (dynamic_cast<Y2ProgramComponent*>((*it)->comp ()));\n  \t\telse\n  \t\t    (*ns)->useLocal ();\n  \t    }\n  \t}\n      }\n  }\n}"
  },
  {
    "function_name": "SCRGetName",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "330-343",
    "snippet": "YCPString\nY2WFMComponent::SCRGetName (const YCPInteger &h)\n{\n    /**\n     * @builtin SCRGetName\n     * @short Get the name of a scr instance.\n     * @param integer handle SCR handle\n     * @return string Name\n     */\n\n    int handle = h->value ();\n    WFMSubAgents::iterator it = find_handle (handle);\n    return YCPString (it != scrs.end () ? (*it)->get_name () : \"\");\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "it != scrs.end () ? (*it)->get_name () : \"\""
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scrs.end",
          "args": [],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_handle",
          "args": [
            "handle"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "find_handle",
          "container": "Y2WFMComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
          "lines": "212-222",
          "snippet": "Y2WFMComponent::WFMSubAgents::iterator\nY2WFMComponent::find_handle (int handle)\n{\n    WFMSubAgents::iterator it = std::lower_bound (scrs.begin (), scrs.end (),\n                                                  handle, wfmsubagent_less);\n\n    if (it != scrs.end () && (*it)->get_handle () == handle)\n        return it;\n\n    return scrs.end ();\n}",
          "includes": [
            "#include \"Y2SystemNamespace.h\"",
            "#include \"Y2WFMComponent.h\"",
            "#include <scr/SCR.h>",
            "#include <scr/SCRAgent.h>",
            "#include <ycp/YBreakpoint.h>",
            "#include <ycp/YBlock.h>",
            "#include <ycp/Bytecode.h>",
            "#include <ycp/Parser.h>",
            "#include <ycp/ExecutionEnvironment.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <y2/Y2ProgramComponent.h>",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <algorithm>",
            "#include <errno.h>",
            "#include <locale.h>",
            "#include <langinfo.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  Y2WFMComponent::WFMSubAgents::iterator\n  Y2WFMComponent::find_handle (int handle)\n  {\n      WFMSubAgents::iterator it = std::lower_bound (scrs.begin (), scrs.end (),\n                                                    handle, wfmsubagent_less);\n  \n      if (it != scrs.end () && (*it)->get_handle () == handle)\n          return it;\n  \n      return scrs.end ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "h->value",
          "args": [],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPString\n  Y2WFMComponent::SCRGetName (const YCPInteger &h)\n  {\n      /**\n       * @builtin SCRGetName\n       * @short Get the name of a scr instance.\n       * @param integer handle SCR handle\n       * @return string Name\n       */\n  \n      int handle = h->value ();\n      WFMSubAgents::iterator it = find_handle (handle);\n      return YCPString (it != scrs.end () ? (*it)->get_name () : \"\");\n  }\n}"
  },
  {
    "function_name": "SCRClose",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "283-327",
    "snippet": "void\nY2WFMComponent::SCRClose (const YCPInteger& h)\n{\n    /**\n     * @builtin SCRClose\n     * @short Closes a scr instance.\n     * @param integer handle  SCR handle\n     * @return void\n     */\n\n    int handle = h->value ();\n    WFMSubAgents::iterator it = find_handle (handle);\n\n    if (it == scrs.end ())\n    {\n\t// invalid handle\n\tycperror (\"Trying to close undefined handle '%d'\", handle);\n\treturn;\n    }\n\n    // if it was the default one, try to handle the situation gracefully\n    if (handle == default_handle)\n    {\n\tdefault_handle = -1;\n\tycpmilestone (\"There is no default SCR set now\");\n\t// SCR::instance () is set to NULL by the SCRAgent destructor\n\n\tfor ( SystemNamespaces::iterator ns = system_namespaces.begin ();\n\t\tns != system_namespaces.end (); ns ++ )\n\t{\n\t    y2milestone (\"Redirecting system namespace '%s' to local\"\n\t\t, (*ns)->name ().c_str ());\n\n\t    (*ns)->useLocal ();\n\t}\n\n    }\n\n    WFMSubAgent* agent = (*it);\n\n    scrs.erase (it);\n    delete agent;\n\n    ycpmilestone (\"SCR handle %d closed\", handle);\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ycpmilestone",
          "args": [
            "\"SCR handle %d closed\"",
            "handle"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scrs.erase",
          "args": [
            "it"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "683-695",
          "snippet": "int PathInfo::erase( const Pathname & path )\n{\n  int res = 0;\n  PathInfo p( path, LSTAT );\n  if ( p.isExist() )\n    {\n      if ( p.isDir() )\n        res = PathInfo::recursive_rmdir( path );\n      else\n        res = PathInfo::unlink( path );\n    }\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::erase( const Pathname & path )\n  {\n    int res = 0;\n    PathInfo p( path, LSTAT );\n    if ( p.isExist() )\n      {\n        if ( p.isDir() )\n          res = PathInfo::recursive_rmdir( path );\n        else\n          res = PathInfo::unlink( path );\n      }\n    return res;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2milestone",
          "args": [
            "\"Redirecting system namespace '%s' to local\"",
            "(*ns)->name ().c_str ()"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "system_namespaces.end",
          "args": [],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "system_namespaces.begin",
          "args": [],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ycpmilestone",
          "args": [
            "\"There is no default SCR set now\""
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycperror",
          "args": [
            "\"Trying to close undefined handle '%d'\"",
            "handle"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_handle",
          "args": [
            "handle"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "find_handle",
          "container": "Y2WFMComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
          "lines": "212-222",
          "snippet": "Y2WFMComponent::WFMSubAgents::iterator\nY2WFMComponent::find_handle (int handle)\n{\n    WFMSubAgents::iterator it = std::lower_bound (scrs.begin (), scrs.end (),\n                                                  handle, wfmsubagent_less);\n\n    if (it != scrs.end () && (*it)->get_handle () == handle)\n        return it;\n\n    return scrs.end ();\n}",
          "includes": [
            "#include \"Y2SystemNamespace.h\"",
            "#include \"Y2WFMComponent.h\"",
            "#include <scr/SCR.h>",
            "#include <scr/SCRAgent.h>",
            "#include <ycp/YBreakpoint.h>",
            "#include <ycp/YBlock.h>",
            "#include <ycp/Bytecode.h>",
            "#include <ycp/Parser.h>",
            "#include <ycp/ExecutionEnvironment.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <y2/Y2ProgramComponent.h>",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <algorithm>",
            "#include <errno.h>",
            "#include <locale.h>",
            "#include <langinfo.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  Y2WFMComponent::WFMSubAgents::iterator\n  Y2WFMComponent::find_handle (int handle)\n  {\n      WFMSubAgents::iterator it = std::lower_bound (scrs.begin (), scrs.end (),\n                                                    handle, wfmsubagent_less);\n  \n      if (it != scrs.end () && (*it)->get_handle () == handle)\n          return it;\n  \n      return scrs.end ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "h->value",
          "args": [],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  void\n  Y2WFMComponent::SCRClose (const YCPInteger& h)\n  {\n      /**\n       * @builtin SCRClose\n       * @short Closes a scr instance.\n       * @param integer handle  SCR handle\n       * @return void\n       */\n  \n      int handle = h->value ();\n      WFMSubAgents::iterator it = find_handle (handle);\n  \n      if (it == scrs.end ())\n      {\n  \t// invalid handle\n  \tycperror (\"Trying to close undefined handle '%d'\", handle);\n  \treturn;\n      }\n  \n      // if it was the default one, try to handle the situation gracefully\n      if (handle == default_handle)\n      {\n  \tdefault_handle = -1;\n  \tycpmilestone (\"There is no default SCR set now\");\n  \t// SCR::instance () is set to NULL by the SCRAgent destructor\n  \n  \tfor ( SystemNamespaces::iterator ns = system_namespaces.begin ();\n  \t\tns != system_namespaces.end (); ns ++ )\n  \t{\n  \t    y2milestone (\"Redirecting system namespace '%s' to local\"\n  \t\t, (*ns)->name ().c_str ());\n  \n  \t    (*ns)->useLocal ();\n  \t}\n  \n      }\n  \n      WFMSubAgent* agent = (*it);\n  \n      scrs.erase (it);\n      delete agent;\n  \n      ycpmilestone (\"SCR handle %d closed\", handle);\n  }\n}"
  },
  {
    "function_name": "SCROpen",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "243-280",
    "snippet": "YCPInteger\nY2WFMComponent::SCROpen (const YCPString& scrname, const YCPBoolean &checkversion)\n{\n    /**\n     * @builtin SCROpen\n     * @short Create a new scr instance.\n     *\n     * @description\n     *\n     * Creates a new scr instance. The name must be a valid y2component name\n     * (e.g. \"scr\", \"chroot=/mnt:scr\"). The component is created immediately.\n     * The parameter check_version determines whether the SuSE Version should\n     * be checked. On error a negative value is returned.\n     *\n     * @param string name a valid y2component name\n     * @param boolean check_version determines whether the SuSE Version should be\n     * checked\n     * @return integer On error a negative value is returned.\n     */\n\n    string name = scrname->value ();\n    bool check_version = checkversion->value ();\n\n    int handle = handle_cnt++;\n\n    WFMSubAgent* agent = new WFMSubAgent (name, handle);\n\n    int error;\n    if (!agent->start_and_check (check_version, &error))\n    {\n\ty2error (\"SCROpen '%s' failed: %d\", name.c_str (), error);\n\tdelete agent;\n\treturn YCPInteger (error);\n    }\n\n    scrs.push_back (agent);\n    return YCPInteger (handle);\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPInteger",
          "args": [
            "handle"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "YCPInteger",
          "container": "YCPInteger",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
          "lines": "142-145",
          "snippet": "YCPInteger::YCPInteger (bytecodeistream & str)\n    : YCPValue (new YCPIntegerRep (fromStream (str)))\n{\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nYCPInteger {\n  YCPInteger::YCPInteger (bytecodeistream & str)\n      : YCPValue (new YCPIntegerRep (fromStream (str)))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "scrs.push_back",
          "args": [
            "agent"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "push_back",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "70-74",
          "snippet": "void\nYCPListRep::push_back(const YCPValue& value)\n{\n    elements.push_back(value);\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  void\n  YCPListRep::push_back(const YCPValue& value)\n  {\n      elements.push_back(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"SCROpen '%s' failed: %d\"",
            "name.c_str ()",
            "error"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.c_str",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agent->start_and_check",
          "args": [
            "check_version",
            "&error"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "start_and_check",
          "container": "WFMSubAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/WFMSubAgent.cc",
          "lines": "79-111",
          "snippet": "bool\nWFMSubAgent::start_and_check (bool check_version, int* error)\n{\n    if (!start ())\n    {\n\t*error = -1;\n\treturn false;\n    }\n\n    YCPValue q1 = YCPTerm (\"SuSEVersion\");\n    YCPValue q2 = YCPVoid ();\n\n    YCPValue a = my_comp->evaluate (check_version ? q1 : q2);\n\n    if (a.isNull ())\n    {\n\t*error = -1;\n\treturn false;\n    }\n\n    if (check_version)\n    {\n\ty2debug (\"SuSEVersion \\\"%s\\\" %s\", SUSEVERSION, a->toString ().c_str ());\n\n\tif (!a->isString () || a->asString ()->value () != SUSEVERSION)\n\t{\n\t    *error = -2;\n\t    return false;\n\t}\n    }\n\n    return true;\n}",
          "includes": [
            "#include <WFMSubAgent.h>",
            "#include \"../../scr/src/StdioSCRAgent.h\"",
            "#include <scr/SCRAgent.h>",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <WFMSubAgent.h>\n#include \"../../scr/src/StdioSCRAgent.h\"\n#include <scr/SCRAgent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/y2log.h>\n\nWFMSubAgent {\n  bool\n  WFMSubAgent::start_and_check (bool check_version, int* error)\n  {\n      if (!start ())\n      {\n  \t*error = -1;\n  \treturn false;\n      }\n  \n      YCPValue q1 = YCPTerm (\"SuSEVersion\");\n      YCPValue q2 = YCPVoid ();\n  \n      YCPValue a = my_comp->evaluate (check_version ? q1 : q2);\n  \n      if (a.isNull ())\n      {\n  \t*error = -1;\n  \treturn false;\n      }\n  \n      if (check_version)\n      {\n  \ty2debug (\"SuSEVersion \\\"%s\\\" %s\", SUSEVERSION, a->toString ().c_str ());\n  \n  \tif (!a->isString () || a->asString ()->value () != SUSEVERSION)\n  \t{\n  \t    *error = -2;\n  \t    return false;\n  \t}\n      }\n  \n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkversion->value",
          "args": [],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPInteger\n  Y2WFMComponent::SCROpen (const YCPString& scrname, const YCPBoolean &checkversion)\n  {\n      /**\n       * @builtin SCROpen\n       * @short Create a new scr instance.\n       *\n       * @description\n       *\n       * Creates a new scr instance. The name must be a valid y2component name\n       * (e.g. \"scr\", \"chroot=/mnt:scr\"). The component is created immediately.\n       * The parameter check_version determines whether the SuSE Version should\n       * be checked. On error a negative value is returned.\n       *\n       * @param string name a valid y2component name\n       * @param boolean check_version determines whether the SuSE Version should be\n       * checked\n       * @return integer On error a negative value is returned.\n       */\n  \n      string name = scrname->value ();\n      bool check_version = checkversion->value ();\n  \n      int handle = handle_cnt++;\n  \n      WFMSubAgent* agent = new WFMSubAgent (name, handle);\n  \n      int error;\n      if (!agent->start_and_check (check_version, &error))\n      {\n  \ty2error (\"SCROpen '%s' failed: %d\", name.c_str (), error);\n  \tdelete agent;\n  \treturn YCPInteger (error);\n      }\n  \n      scrs.push_back (agent);\n      return YCPInteger (handle);\n  }\n}"
  },
  {
    "function_name": "find_handle",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "212-222",
    "snippet": "Y2WFMComponent::WFMSubAgents::iterator\nY2WFMComponent::find_handle (int handle)\n{\n    WFMSubAgents::iterator it = std::lower_bound (scrs.begin (), scrs.end (),\n                                                  handle, wfmsubagent_less);\n\n    if (it != scrs.end () && (*it)->get_handle () == handle)\n        return it;\n\n    return scrs.end ();\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scrs.end",
          "args": [],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::lower_bound",
          "args": [
            "scrs.begin ()",
            "scrs.end ()",
            "handle",
            "wfmsubagent_less"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scrs.begin",
          "args": [],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  Y2WFMComponent::WFMSubAgents::iterator\n  Y2WFMComponent::find_handle (int handle)\n  {\n      WFMSubAgents::iterator it = std::lower_bound (scrs.begin (), scrs.end (),\n                                                    handle, wfmsubagent_less);\n  \n      if (it != scrs.end () && (*it)->get_handle () == handle)\n          return it;\n  \n      return scrs.end ();\n  }\n}"
  },
  {
    "function_name": "doActualWork",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "135-209",
    "snippet": "YCPValue\nY2WFMComponent::doActualWork (const YCPList& arglist, Y2Component *displayserver)\n{\n    y2debug( \"Starting evaluation\" );\n    \n    bool debugger = false;\n    YCPList client_arglist = arglist;\n    \n    // hack: look only at the last entry, if it's debugger or not\n    if (arglist->size () > 0)\n    {\n\tYCPValue last = arglist->value (arglist->size ()-1);\n\tif (last->isSymbol () && last->asSymbol()->symbol() == \"debugger\")\n\t{\n\t    y2debug (\"Enabling debugger\");\n\t    debugger = true;\n\n\t    // remove the flag from the arguments\n\t    client_arglist->remove (arglist->size ()-1);\n\t}\n    }\n\n    // Prepare the arguments. It has the form [script, [clientargs...]]\n    YCPList wfm_arglist;\n    wfm_arglist->add(script);\n    wfm_arglist->add(YCPString(name()));\n    wfm_arglist->add (YCPString (fullname));\n    wfm_arglist->add(client_arglist);\n\n    // store the old arguments and module name to preserve reentrancy\n    YCPList old_arguments = argumentlist;\n    string old_modulename = modulename;\n\n    // wfm always gets three arguments:\n    // 0: any script:        script to execute\n    // 1: string modulename: name of the module to realize\n    // 2: list arglist:      arguments for that module\n\n    YCPValue script = YCPVoid();\n    modulename = \"unknown\";\n    string current_file = \"unknown\";\n    YCPList  args_for_the_script;\n\n    if (wfm_arglist->size() != 4\n\t|| !wfm_arglist->value(1)->isString()\n\t|| !wfm_arglist->value(2)->isString()\n\t|| !wfm_arglist->value(3)->isList())\n    {\n\ty2error (\"Incorrect arguments %s\", wfm_arglist->toString().c_str());\n    }\n    else\n    {\n\tscript\t\t    = wfm_arglist->value(0);\n\tmodulename\t    = wfm_arglist->value(1)->asString()->value();\n\tcurrent_file\t    = wfm_arglist->value(2)->asString()->value();\n\targumentlist\t    = wfm_arglist->value(3)->asList();\n    }\n\n    y2debug (\"Script is: %s\", script->toString().c_str());\n\n    y2debug (\"Y2WFMComponent @ %p, displayserver @ %p\", this, displayserver);\n    \n    if (debugger)\n\tscript = YCPCode ((YCodePtr)new YBreakpoint (script->asCode ()->code (), \"code start\"));\n\n    YCPValue v = script->asCode ()->evaluate ();\n\n    y2debug( \"Evaluation finished\" );\n\n    // restore the old arguments and module name to preserve reentrancy\n    argumentlist = old_arguments;\n    modulename = old_modulename;\n\n    return v;\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Evaluation finished\""
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "script->asCode",
          "args": [],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "asCode",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "215-225",
          "snippet": "YCPCode\nYCPValueRep::asCode() const\n{\n    if (!isCode())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Code !\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPCode (static_cast<const YCPCodeRep*>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPCode\n  YCPValueRep::asCode() const\n  {\n      if (!isCode())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Code !\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPCode (static_cast<const YCPCodeRep*>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPCode",
          "args": [
            "(YCodePtr)new YBreakpoint (script->asCode ()->code (), \"code start\")"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "YCPCode",
          "container": "YCPCode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPCode.cc",
          "lines": "103-107",
          "snippet": "YCPCode::YCPCode (bytecodeistream & str)\n    : YCPValue (YCPCode())\n{\n    (const_cast<YCPCodeRep*>(static_cast<const YCPCodeRep*>(element)))->m_code = Bytecode::readCode (str);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPCode {\n  YCPCode::YCPCode (bytecodeistream & str)\n      : YCPValue (YCPCode())\n  {\n      (const_cast<YCPCodeRep*>(static_cast<const YCPCodeRep*>(element)))->m_code = Bytecode::readCode (str);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Y2WFMComponent @ %p, displayserver @ %p\"",
            "this",
            "displayserver"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Script is: %s\"",
            "script->toString().c_str()"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "script->toString",
          "args": [],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wfm_arglist->value",
          "args": [],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wfm_arglist->value",
          "args": [
            "3"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Incorrect arguments %s\"",
            "wfm_arglist->toString().c_str()"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wfm_arglist->size",
          "args": [],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPVoid",
          "args": [],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "YCPVoid",
          "container": "YCPVoid",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPVoid.cc",
          "lines": "72-75",
          "snippet": "YCPVoid::YCPVoid ()\n    : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n{\n}",
          "includes": [
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "YCPVoid* YCPVoid::nil = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/y2log.h\"\n\nYCPVoid* YCPVoid::nil = NULL;\n\nYCPVoid {\n  YCPVoid::YCPVoid ()\n      : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wfm_arglist->add",
          "args": [
            "client_arglist"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "fullname"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "name",
          "args": [],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "name",
          "container": "Y2WFMComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
          "lines": "106-110",
          "snippet": "string\nY2WFMComponent::name () const\n{\n    return \"wfm\";\n}",
          "includes": [
            "#include \"Y2SystemNamespace.h\"",
            "#include \"Y2WFMComponent.h\"",
            "#include <scr/SCR.h>",
            "#include <scr/SCRAgent.h>",
            "#include <ycp/YBreakpoint.h>",
            "#include <ycp/YBlock.h>",
            "#include <ycp/Bytecode.h>",
            "#include <ycp/Parser.h>",
            "#include <ycp/ExecutionEnvironment.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <y2/Y2ProgramComponent.h>",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <algorithm>",
            "#include <errno.h>",
            "#include <locale.h>",
            "#include <langinfo.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  string\n  Y2WFMComponent::name () const\n  {\n      return \"wfm\";\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "client_arglist->remove",
          "args": [
            "arglist->size ()-1"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "remove",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "104-113",
          "snippet": "void YCPMapRep::remove(const YCPValue& key)\n{\n    if (!key->isString() && !key->isInteger() && !key->isSymbol())\n    {\n        ycp2error (\"Only integer, string, or symbol constant allowed as key in map\");\n        return;\n    }\n\n    stl_map.erase (key);\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  void YCPMapRep::remove(const YCPValue& key)\n  {\n      if (!key->isString() && !key->isInteger() && !key->isSymbol())\n      {\n          ycp2error (\"Only integer, string, or symbol constant allowed as key in map\");\n          return;\n      }\n  \n      stl_map.erase (key);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Enabling debugger\""
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "last->asSymbol",
          "args": [],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "asSymbol",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "167-177",
          "snippet": "YCPSymbol\nYCPValueRep::asSymbol() const\n{\n    if (!isSymbol())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Symbol!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPSymbol (static_cast<const YCPSymbolRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPSymbol\n  YCPValueRep::asSymbol() const\n  {\n      if (!isSymbol())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Symbol!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPSymbol (static_cast<const YCPSymbolRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "last->isSymbol",
          "args": [],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "isSymbol",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "68-68",
          "snippet": "bool YCPValueRep::isSymbol()      const { return valuetype() == YT_SYMBOL; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isSymbol()      const { return valuetype() == YT_SYMBOL; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Starting evaluation\""
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  YCPValue\n  Y2WFMComponent::doActualWork (const YCPList& arglist, Y2Component *displayserver)\n  {\n      y2debug( \"Starting evaluation\" );\n      \n      bool debugger = false;\n      YCPList client_arglist = arglist;\n      \n      // hack: look only at the last entry, if it's debugger or not\n      if (arglist->size () > 0)\n      {\n  \tYCPValue last = arglist->value (arglist->size ()-1);\n  \tif (last->isSymbol () && last->asSymbol()->symbol() == \"debugger\")\n  \t{\n  \t    y2debug (\"Enabling debugger\");\n  \t    debugger = true;\n  \n  \t    // remove the flag from the arguments\n  \t    client_arglist->remove (arglist->size ()-1);\n  \t}\n      }\n  \n      // Prepare the arguments. It has the form [script, [clientargs...]]\n      YCPList wfm_arglist;\n      wfm_arglist->add(script);\n      wfm_arglist->add(YCPString(name()));\n      wfm_arglist->add (YCPString (fullname));\n      wfm_arglist->add(client_arglist);\n  \n      // store the old arguments and module name to preserve reentrancy\n      YCPList old_arguments = argumentlist;\n      string old_modulename = modulename;\n  \n      // wfm always gets three arguments:\n      // 0: any script:        script to execute\n      // 1: string modulename: name of the module to realize\n      // 2: list arglist:      arguments for that module\n  \n      YCPValue script = YCPVoid();\n      modulename = \"unknown\";\n      string current_file = \"unknown\";\n      YCPList  args_for_the_script;\n  \n      if (wfm_arglist->size() != 4\n  \t|| !wfm_arglist->value(1)->isString()\n  \t|| !wfm_arglist->value(2)->isString()\n  \t|| !wfm_arglist->value(3)->isList())\n      {\n  \ty2error (\"Incorrect arguments %s\", wfm_arglist->toString().c_str());\n      }\n      else\n      {\n  \tscript\t\t    = wfm_arglist->value(0);\n  \tmodulename\t    = wfm_arglist->value(1)->asString()->value();\n  \tcurrent_file\t    = wfm_arglist->value(2)->asString()->value();\n  \targumentlist\t    = wfm_arglist->value(3)->asList();\n      }\n  \n      y2debug (\"Script is: %s\", script->toString().c_str());\n  \n      y2debug (\"Y2WFMComponent @ %p, displayserver @ %p\", this, displayserver);\n      \n      if (debugger)\n  \tscript = YCPCode ((YCodePtr)new YBreakpoint (script->asCode ()->code (), \"code start\"));\n  \n      YCPValue v = script->asCode ()->evaluate ();\n  \n      y2debug( \"Evaluation finished\" );\n  \n      // restore the old arguments and module name to preserve reentrancy\n      argumentlist = old_arguments;\n      modulename = old_modulename;\n  \n      return v;\n  }\n}"
  },
  {
    "function_name": "createDefaultSCR",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "113-133",
    "snippet": "bool Y2WFMComponent::createDefaultSCR ()\n{\n    // first, initialize builtin declarations if needed\n    if (! SCR::registered)\n    {\n\tSCR scr;\n    }\n\n    // create default scr\n    WFMSubAgent* scr = new WFMSubAgent (\"scr\", 0);\n\n    if (!scr->start ()) {\n\treturn false;\n    }\n\n    scrs.push_back (scr);\n    default_handle = 0;\n    scr->agent()->setAsCurrentSCR();\n\n    return true;\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scr->agent",
          "args": [],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scr->agent",
          "args": [],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scrs.push_back",
          "args": [
            "scr"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "push_back",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "70-74",
          "snippet": "void\nYCPListRep::push_back(const YCPValue& value)\n{\n    elements.push_back(value);\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  void\n  YCPListRep::push_back(const YCPValue& value)\n  {\n      elements.push_back(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "scr->start",
          "args": [],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "start",
          "container": "WFMSubAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/WFMSubAgent.cc",
          "lines": "53-76",
          "snippet": "bool\nWFMSubAgent::start ()\n{\n    if (!my_comp)\n    {\n\ty2debug (\"Creating SubAgent: %d %s\", my_handle, my_name.c_str ());\n\tmy_comp = Y2ComponentBroker::createServer (my_name.c_str ());\n\n\tif (!my_comp)\n\t{\n\t    ycp2error (\"Can't create component '%s'\", my_name.c_str ());\n\t}\n\telse\n\t{\n\t    if (my_comp->getSCRAgent () == NULL)\n\t    {\n\t\t// the component does not have a SCR agent, better try to push over stdio\n\t\tmy_agent = new StdioSCRAgent (my_comp);\n\t    }\n\t}\n    }\n\n    return my_comp != 0;\n}",
          "includes": [
            "#include <WFMSubAgent.h>",
            "#include \"../../scr/src/StdioSCRAgent.h\"",
            "#include <scr/SCRAgent.h>",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <WFMSubAgent.h>\n#include \"../../scr/src/StdioSCRAgent.h\"\n#include <scr/SCRAgent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/y2log.h>\n\nWFMSubAgent {\n  bool\n  WFMSubAgent::start ()\n  {\n      if (!my_comp)\n      {\n  \ty2debug (\"Creating SubAgent: %d %s\", my_handle, my_name.c_str ());\n  \tmy_comp = Y2ComponentBroker::createServer (my_name.c_str ());\n  \n  \tif (!my_comp)\n  \t{\n  \t    ycp2error (\"Can't create component '%s'\", my_name.c_str ());\n  \t}\n  \telse\n  \t{\n  \t    if (my_comp->getSCRAgent () == NULL)\n  \t    {\n  \t\t// the component does not have a SCR agent, better try to push over stdio\n  \t\tmy_agent = new StdioSCRAgent (my_comp);\n  \t    }\n  \t}\n      }\n  \n      return my_comp != 0;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  bool Y2WFMComponent::createDefaultSCR ()\n  {\n      // first, initialize builtin declarations if needed\n      if (! SCR::registered)\n      {\n  \tSCR scr;\n      }\n  \n      // create default scr\n      WFMSubAgent* scr = new WFMSubAgent (\"scr\", 0);\n  \n      if (!scr->start ()) {\n  \treturn false;\n      }\n  \n      scrs.push_back (scr);\n      default_handle = 0;\n      scr->agent()->setAsCurrentSCR();\n  \n      return true;\n  }\n}"
  },
  {
    "function_name": "name",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "106-110",
    "snippet": "string\nY2WFMComponent::name () const\n{\n    return \"wfm\";\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  string\n  Y2WFMComponent::name () const\n  {\n      return \"wfm\";\n  }\n}"
  },
  {
    "function_name": "~Y2WFMComponent",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "93-103",
    "snippet": "Y2WFMComponent::~Y2WFMComponent ()\n{\n    // delete all SCRs\n    for (WFMSubAgents::iterator it = scrs.begin (); it != scrs.end (); it++)\n        delete *it;\n\n    if (current_wfm == this)\n    {\n\tcurrent_wfm = NULL;\n    }\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "Y2WFMComponent* Y2WFMComponent::current_wfm = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "scrs.end",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "scrs.begin",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent* Y2WFMComponent::current_wfm = 0;\n\nY2WFMComponent {\n  Y2WFMComponent::~Y2WFMComponent ()\n  {\n      // delete all SCRs\n      for (WFMSubAgents::iterator it = scrs.begin (); it != scrs.end (); it++)\n          delete *it;\n  \n      if (current_wfm == this)\n      {\n  \tcurrent_wfm = NULL;\n      }\n  }\n}"
  },
  {
    "function_name": "Y2WFMComponent",
    "container": "Y2WFMComponent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
    "lines": "48-90",
    "snippet": "Y2WFMComponent::Y2WFMComponent ():\n      handle_cnt (1),\n      local (\"ag_system\", -1),\n      modulename (\"\"),\n      argumentlist (YCPList()),\nscript (YCPNull()),\n      client_name (\"\"),\n      fullname (\"\")\n{\n    y2debug (\"Initialized Y2WFMComponent instance\");\n\n    // pre-init language\n    const char* lang = get_env_lang ();\n    if (lang)\n    {\n        YCPList args;\n        args->add (YCPString (lang));\n\n        // set locale according to the language setting\n        setlocale (LC_ALL, \"\");\n        // get encoding of the environment where yast is started\n        environmentEncoding = nl_langinfo (CODESET);\n\n        SetLanguage (YCPString (lang));\n    }\n\n    // initialize SCR and builtins, so it is enough to create the instance of\n    // WFM to get builtins work - used by perl bindings (#37338)\n\n    createDefaultSCR ();\n\n    if (scrs.empty ())\n    {\n\t// problems with creation of default SCR in constructor\n\treturn;\n    }\n\n    if (! current_wfm)\n    {\n\t// if there is wfm already, it will handle the WFM builtins!\n\tcurrent_wfm = this;\n    }\n}",
    "includes": [
      "#include \"Y2SystemNamespace.h\"",
      "#include \"Y2WFMComponent.h\"",
      "#include <scr/SCR.h>",
      "#include <scr/SCRAgent.h>",
      "#include <ycp/YBreakpoint.h>",
      "#include <ycp/YBlock.h>",
      "#include <ycp/Bytecode.h>",
      "#include <ycp/Parser.h>",
      "#include <ycp/ExecutionEnvironment.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <y2/Y2ProgramComponent.h>",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <algorithm>",
      "#include <errno.h>",
      "#include <locale.h>",
      "#include <langinfo.h>",
      "#include <libintl.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "Y2WFMComponent* Y2WFMComponent::current_wfm = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "scrs.empty",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "createDefaultSCR",
          "args": [],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "createDefaultSCR",
          "container": "Y2WFMComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/Y2WFMComponent.cc",
          "lines": "113-133",
          "snippet": "bool Y2WFMComponent::createDefaultSCR ()\n{\n    // first, initialize builtin declarations if needed\n    if (! SCR::registered)\n    {\n\tSCR scr;\n    }\n\n    // create default scr\n    WFMSubAgent* scr = new WFMSubAgent (\"scr\", 0);\n\n    if (!scr->start ()) {\n\treturn false;\n    }\n\n    scrs.push_back (scr);\n    default_handle = 0;\n    scr->agent()->setAsCurrentSCR();\n\n    return true;\n}",
          "includes": [
            "#include \"Y2SystemNamespace.h\"",
            "#include \"Y2WFMComponent.h\"",
            "#include <scr/SCR.h>",
            "#include <scr/SCRAgent.h>",
            "#include <ycp/YBreakpoint.h>",
            "#include <ycp/YBlock.h>",
            "#include <ycp/Bytecode.h>",
            "#include <ycp/Parser.h>",
            "#include <ycp/ExecutionEnvironment.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <y2/Y2ProgramComponent.h>",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <algorithm>",
            "#include <errno.h>",
            "#include <locale.h>",
            "#include <langinfo.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent {\n  bool Y2WFMComponent::createDefaultSCR ()\n  {\n      // first, initialize builtin declarations if needed\n      if (! SCR::registered)\n      {\n  \tSCR scr;\n      }\n  \n      // create default scr\n      WFMSubAgent* scr = new WFMSubAgent (\"scr\", 0);\n  \n      if (!scr->start ()) {\n  \treturn false;\n      }\n  \n      scrs.push_back (scr);\n      default_handle = 0;\n      scr->agent()->setAsCurrentSCR();\n  \n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetLanguage",
          "args": [
            "YCPString (lang)"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "WFMSetLanguage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/wfm/src/WFM.cc",
          "lines": "122-126",
          "snippet": "static YCPString\nWFMSetLanguage (const YCPString& language)\n{\n    return Y2WFMComponent::instance ()->SetLanguage (language);\n}",
          "includes": [
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/StaticDeclaration.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"Y2WFMComponent.h\"",
            "#include \"WFM.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/y2log.h\"\n#include \"ycp/StaticDeclaration.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"Y2WFMComponent.h\"\n#include \"WFM.h\"\n\nstatic YCPString\nWFMSetLanguage (const YCPString& language)\n{\n    return Y2WFMComponent::instance ()->SetLanguage (language);\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "lang"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "nl_langinfo",
          "args": [
            "CODESET"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setlocale",
          "args": [
            "LC_ALL",
            "\"\""
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args->add",
          "args": [
            "YCPString (lang)"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_env_lang",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Initialized Y2WFMComponent instance\""
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPList",
          "args": [],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "commaList",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "254-265",
          "snippet": "string\nYCPListRep::commaList() const\n{\n    string ret;\n\n    for (unsigned index = 0; index < elements.size(); index++)\n    {\n\tif (index != 0) ret += \", \";\n\tret += elements[index].isNull() ? \"(null)\" : elements[index]->toString();\n    }\n    return ret;\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  string\n  YCPListRep::commaList() const\n  {\n      string ret;\n  \n      for (unsigned index = 0; index < elements.size(); index++)\n      {\n  \tif (index != 0) ret += \", \";\n  \tret += elements[index].isNull() ? \"(null)\" : elements[index]->toString();\n      }\n      return ret;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Y2SystemNamespace.h\"\n#include \"Y2WFMComponent.h\"\n#include <scr/SCR.h>\n#include <scr/SCRAgent.h>\n#include <ycp/YBreakpoint.h>\n#include <ycp/YBlock.h>\n#include <ycp/Bytecode.h>\n#include <ycp/Parser.h>\n#include <ycp/ExecutionEnvironment.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <y2/Y2ProgramComponent.h>\n#include <y2/Y2ComponentBroker.h>\n#include <algorithm>\n#include <errno.h>\n#include <locale.h>\n#include <langinfo.h>\n#include <libintl.h>\n\nY2WFMComponent* Y2WFMComponent::current_wfm = 0;\n\nY2WFMComponent {\n  Y2WFMComponent::Y2WFMComponent ():\n        handle_cnt (1),\n        local (\"ag_system\", -1),\n        modulename (\"\"),\n        argumentlist (YCPList()),\n  script (YCPNull()),\n        client_name (\"\"),\n        fullname (\"\")\n  {\n      y2debug (\"Initialized Y2WFMComponent instance\");\n  \n      // pre-init language\n      const char* lang = get_env_lang ();\n      if (lang)\n      {\n          YCPList args;\n          args->add (YCPString (lang));\n  \n          // set locale according to the language setting\n          setlocale (LC_ALL, \"\");\n          // get encoding of the environment where yast is started\n          environmentEncoding = nl_langinfo (CODESET);\n  \n          SetLanguage (YCPString (lang));\n      }\n  \n      // initialize SCR and builtins, so it is enough to create the instance of\n      // WFM to get builtins work - used by perl bindings (#37338)\n  \n      createDefaultSCR ();\n  \n      if (scrs.empty ())\n      {\n  \t// problems with creation of default SCR in constructor\n  \treturn;\n      }\n  \n      if (! current_wfm)\n      {\n  \t// if there is wfm already, it will handle the WFM builtins!\n  \tcurrent_wfm = this;\n      }\n  }\n}"
  }
]