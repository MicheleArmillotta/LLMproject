[
  {
    "function_name": "closeInput",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "367-381",
    "snippet": "void\nScanner::closeInput ()\n{\n    // reading from an open file\n    if (m_inputFile)\n    {\n\tfclose (m_inputFile);\n    }\n\n    // reading from a file descriptor\n    else if (m_inputFd >= 0)\n    {\n\tclose (m_inputFd);\n    }\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "m_inputFd"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "m_inputFile"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  void\n  Scanner::closeInput ()\n  {\n      // reading from an open file\n      if (m_inputFile)\n      {\n  \tfclose (m_inputFile);\n      }\n  \n      // reading from a file descriptor\n      else if (m_inputFd >= 0)\n      {\n  \tclose (m_inputFd);\n      }\n  }\n}"
  },
  {
    "function_name": "filename",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "335-339",
    "snippet": "string\nScanner::filename () const\n{\n    return m_filename;\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  string\n  Scanner::filename () const\n  {\n      return m_filename;\n  }\n}"
  },
  {
    "function_name": "lineNumber",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "328-332",
    "snippet": "int\nScanner::lineNumber () const\n{\n    return m_lineNumber;\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  int\n  Scanner::lineNumber () const\n  {\n      return m_lineNumber;\n  }\n}"
  },
  {
    "function_name": "scannedType",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "321-325",
    "snippet": "constTypePtr\nScanner::scannedType () const\n{\n    return m_scannedType;\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  constTypePtr\n  Scanner::scannedType () const\n  {\n      return m_scannedType;\n  }\n}"
  },
  {
    "function_name": "scannedValue",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "314-318",
    "snippet": "tokenValue\nScanner::scannedValue () const\n{\n    return m_scannedValue;\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  tokenValue\n  Scanner::scannedValue () const\n  {\n      return m_scannedValue;\n  }\n}"
  },
  {
    "function_name": "setScannedToken",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "306-311",
    "snippet": "void\nScanner::setScannedToken (const tokenValue & value, constTypePtr type)\n{\n    m_scannedValue = value;\n    m_scannedType = type;\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  void\n  Scanner::setScannedToken (const tokenValue & value, constTypePtr type)\n  {\n      m_scannedValue = value;\n      m_scannedType = type;\n  }\n}"
  },
  {
    "function_name": "warning",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "299-303",
    "snippet": "void\nScanner::warning (string warning_message)\n{\n    logWarning (\"%s\", m_lineNumber, warning_message.c_str());\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "logWarning",
          "args": [
            "\"%s\"",
            "m_lineNumber",
            "warning_message.c_str()"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "warning_message.c_str",
          "args": [],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  void\n  Scanner::warning (string warning_message)\n  {\n      logWarning (\"%s\", m_lineNumber, warning_message.c_str());\n  }\n}"
  },
  {
    "function_name": "error",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "292-296",
    "snippet": "void\nScanner::error (string error_message)\n{\n    logError (\"%s\", m_lineNumber, error_message.c_str());\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "logError",
          "args": [
            "\"%s\"",
            "m_lineNumber",
            "error_message.c_str()"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error_message.c_str",
          "args": [],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  void\n  Scanner::error (string error_message)\n  {\n      logError (\"%s\", m_lineNumber, error_message.c_str());\n  }\n}"
  },
  {
    "function_name": "logWarning",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "271-289",
    "snippet": "void\nScanner::logWarning (const char *loginfo, int lineno, ...)\n{\n    char logtext[4096];\n\n    // Prepare info text\n\n    va_list ap;\n    va_start (ap, lineno);\n    vsnprintf (logtext, 4095, loginfo, ap);\n    va_end (ap);\n\n    const char *filename;\n    if (lineno == 0)\t\tfilename = \"<builtin>\";\n    else if (m_filename.empty())filename = \"YCP stream\";\n    else\t\t\tfilename = m_filename.c_str();\n\n    syn2warning (filename, lineno, \"Warning: %s\", logtext);\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syn2warning",
          "args": [
            "filename",
            "lineno",
            "\"Warning: %s\"",
            "logtext"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_filename.c_str",
          "args": [],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_filename.empty",
          "args": [],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsnprintf",
          "args": [
            "logtext",
            "4095",
            "loginfo",
            "ap"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "lineno"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  void\n  Scanner::logWarning (const char *loginfo, int lineno, ...)\n  {\n      char logtext[4096];\n  \n      // Prepare info text\n  \n      va_list ap;\n      va_start (ap, lineno);\n      vsnprintf (logtext, 4095, loginfo, ap);\n      va_end (ap);\n  \n      const char *filename;\n      if (lineno == 0)\t\tfilename = \"<builtin>\";\n      else if (m_filename.empty())filename = \"YCP stream\";\n      else\t\t\tfilename = m_filename.c_str();\n  \n      syn2warning (filename, lineno, \"Warning: %s\", logtext);\n  }\n}"
  },
  {
    "function_name": "logError",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "249-268",
    "snippet": "void\nScanner::logError (const char *loginfo, int lineno, ...)\n{\n    char logtext[4096];\n\n    // Prepare info text\n\n    va_list ap;\n    va_start (ap, lineno);\n    vsnprintf (logtext, 4095, loginfo, ap);\n    va_end (ap);\n\n    const char *filename;\n    if (lineno == 0)\t\tfilename = \"<builtin>\";\n    else if (m_filename.empty())filename = \"YCP stream\";\n    else\t\t\tfilename = m_filename.c_str();\n\n    syn2error(filename, lineno, \"%s\\n\", logtext);\n    return;\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syn2error",
          "args": [
            "filename",
            "lineno",
            "\"%s\\n\"",
            "logtext"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_filename.c_str",
          "args": [],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_filename.empty",
          "args": [],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsnprintf",
          "args": [
            "logtext",
            "4095",
            "loginfo",
            "ap"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "lineno"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  void\n  Scanner::logError (const char *loginfo, int lineno, ...)\n  {\n      char logtext[4096];\n  \n      // Prepare info text\n  \n      va_list ap;\n      va_start (ap, lineno);\n      vsnprintf (logtext, 4095, loginfo, ap);\n      va_end (ap);\n  \n      const char *filename;\n      if (lineno == 0)\t\tfilename = \"<builtin>\";\n      else if (m_filename.empty())filename = \"YCP stream\";\n      else\t\t\tfilename = m_filename.c_str();\n  \n      syn2error(filename, lineno, \"%s\\n\", logtext);\n      return;\n  }\n}"
  },
  {
    "function_name": "LexerError",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "242-246",
    "snippet": "void\nScanner::LexerError (const char* msg)\n{\n    logError(\"%s\", 0, msg);\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "logError",
          "args": [
            "\"%s\"",
            "0",
            "msg"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  void\n  Scanner::LexerError (const char* msg)\n  {\n      logError(\"%s\", 0, msg);\n  }\n}"
  },
  {
    "function_name": "LexerInput",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "183-239",
    "snippet": "int\nScanner::LexerInput (char* buf, int maxnum)\n{\n    // reading from a buffer\n\n    if (m_inputBuffer)\n    {\n\tif (m_buffered)\n\t{\n\t    size_t len = strlen (m_inputBuffer);\n\t    size_t size = (len <= (size_t)maxnum) ? len : maxnum;\n\t    memcpy (buf, m_inputBuffer, size);\n\t    m_inputBuffer += size;\n\t    return size;\n\t}\n\telse if (*m_inputBuffer)\n\t{\n\t    *buf = *m_inputBuffer++;\n\t    return 1;\n\t}\n\telse\n\t{\n\t    return 0;\n\t}\n    }\n\n    // reading from an open file\n\n    else if (m_inputFile)\n    {\n\treturn fread (buf, 1, m_buffered ? maxnum : 1, m_inputFile);\n    }\n\n    // reading from a file descriptor\n\n    else if (m_inputFd >= 0)\n    {\n\tssize_t read_bytes;\n\tdo {\n\t    read_bytes = read (m_inputFd, buf, m_buffered ? maxnum : 1);\n\t} while (read_bytes == -1 &&\n\t\t\t(errno == EINTR || errno == ERESTART)); // bnc#434253\n\n\tif (read_bytes >= 0)\n\t    return read_bytes;\n\telse\n\t    return 0;\n    }\n\n    // no input established\n\n    else\n    {\n\ty2internal (\"LexerInput without input defined\");\n\treturn 0;\n    }\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2internal",
          "args": [
            "\"LexerInput without input defined\""
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "m_inputFd",
            "buf",
            "m_buffered ? maxnum : 1"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "read_loop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/y2crypt.cc",
          "lines": "25-50",
          "snippet": "static int\nread_loop (int fd, char* buffer, int count)\n{\n    int offset, block;\n\n    offset = 0;\n    while (count > 0)\n    {\n\tblock = read (fd, &buffer[offset], count);\n\n\tif (block < 0)\n\t{\n\t    if (errno == EINTR)\n\t\tcontinue;\n\t    return block;\n\t}\n\n\tif (!block)\n\t    return offset;\n\n\toffset += block;\n\tcount -= block;\n    }\n\n    return offset;\n}",
          "includes": [
            "#include \"y2crypt.h\"",
            "#include \"y2log.h\"",
            "#include <xcrypt.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"y2crypt.h\"\n#include \"y2log.h\"\n#include <xcrypt.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int\nread_loop (int fd, char* buffer, int count)\n{\n    int offset, block;\n\n    offset = 0;\n    while (count > 0)\n    {\n\tblock = read (fd, &buffer[offset], count);\n\n\tif (block < 0)\n\t{\n\t    if (errno == EINTR)\n\t\tcontinue;\n\t    return block;\n\t}\n\n\tif (!block)\n\t    return offset;\n\n\toffset += block;\n\tcount -= block;\n    }\n\n    return offset;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fread",
          "args": [
            "buf",
            "1",
            "m_buffered ? maxnum : 1",
            "m_inputFile"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "m_inputBuffer",
            "size"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "m_inputBuffer"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  int\n  Scanner::LexerInput (char* buf, int maxnum)\n  {\n      // reading from a buffer\n  \n      if (m_inputBuffer)\n      {\n  \tif (m_buffered)\n  \t{\n  \t    size_t len = strlen (m_inputBuffer);\n  \t    size_t size = (len <= (size_t)maxnum) ? len : maxnum;\n  \t    memcpy (buf, m_inputBuffer, size);\n  \t    m_inputBuffer += size;\n  \t    return size;\n  \t}\n  \telse if (*m_inputBuffer)\n  \t{\n  \t    *buf = *m_inputBuffer++;\n  \t    return 1;\n  \t}\n  \telse\n  \t{\n  \t    return 0;\n  \t}\n      }\n  \n      // reading from an open file\n  \n      else if (m_inputFile)\n      {\n  \treturn fread (buf, 1, m_buffered ? maxnum : 1, m_inputFile);\n      }\n  \n      // reading from a file descriptor\n  \n      else if (m_inputFd >= 0)\n      {\n  \tssize_t read_bytes;\n  \tdo {\n  \t    read_bytes = read (m_inputFd, buf, m_buffered ? maxnum : 1);\n  \t} while (read_bytes == -1 &&\n  \t\t\t(errno == EINTR || errno == ERESTART)); // bnc#434253\n  \n  \tif (read_bytes >= 0)\n  \t    return read_bytes;\n  \telse\n  \t    return 0;\n      }\n  \n      // no input established\n  \n      else\n      {\n  \ty2internal (\"LexerInput without input defined\");\n  \treturn 0;\n      }\n  }\n}"
  },
  {
    "function_name": "initTables",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "135-163",
    "snippet": "void\nScanner::initTables (SymbolTable *globalTable, SymbolTable *localTable)\n{\n    if (globalTable != 0)\n    {\n\tm_owningGlobal = false;\n\tm_globalTable = globalTable;\n    }\n    else if (m_globalTable == 0)\n    {\n\tm_owningGlobal = true;\n\tm_globalTable = new SymbolTable (-1);\n\ty2debug (\"m_globalTable %p\", m_globalTable);\n    }\n\n    if (localTable != 0)\n    {\n\tm_owningLocal = false;\n\tm_localTable = localTable;\n    }\n    else if (m_localTable == 0)\n    {\n\tm_owningLocal = true;\n\tm_localTable = new SymbolTable (-1);\n\ty2debug (\"m_localTable %p\", m_localTable);\n    }\n\n    return;\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"m_localTable %p\"",
            "m_localTable"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"m_globalTable %p\"",
            "m_globalTable"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  void\n  Scanner::initTables (SymbolTable *globalTable, SymbolTable *localTable)\n  {\n      if (globalTable != 0)\n      {\n  \tm_owningGlobal = false;\n  \tm_globalTable = globalTable;\n      }\n      else if (m_globalTable == 0)\n      {\n  \tm_owningGlobal = true;\n  \tm_globalTable = new SymbolTable (-1);\n  \ty2debug (\"m_globalTable %p\", m_globalTable);\n      }\n  \n      if (localTable != 0)\n      {\n  \tm_owningLocal = false;\n  \tm_localTable = localTable;\n      }\n      else if (m_localTable == 0)\n      {\n  \tm_owningLocal = true;\n  \tm_localTable = new SymbolTable (-1);\n  \ty2debug (\"m_localTable %p\", m_localTable);\n      }\n  \n      return;\n  }\n}"
  },
  {
    "function_name": "setBuffered",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "128-132",
    "snippet": "void\nScanner::setBuffered ()\n{\n    m_buffered = true;\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  void\n  Scanner::setBuffered ()\n  {\n      m_buffered = true;\n  }\n}"
  },
  {
    "function_name": "~Scanner",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "112-125",
    "snippet": "Scanner::~Scanner ()\n{\n    if (m_scandataBuffer != 0)\n\tfree (m_scandataBuffer);\n\n    if (m_owningGlobal)\n    {\n\tdelete (m_globalTable);\n    }\n    if (m_owningLocal)\n    {\n\tdelete (m_localTable);\n    }\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "m_scandataBuffer"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  Scanner::~Scanner ()\n  {\n      if (m_scandataBuffer != 0)\n  \tfree (m_scandataBuffer);\n  \n      if (m_owningGlobal)\n      {\n  \tdelete (m_globalTable);\n      }\n      if (m_owningLocal)\n      {\n  \tdelete (m_localTable);\n      }\n  }\n}"
  },
  {
    "function_name": "Scanner",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "91-109",
    "snippet": "Scanner::Scanner (int input_fd, const char *fname)\n    : m_filename (fname ? fname : \"\")\n    , m_inputBuffer (0)\n    , m_inputFile (0)\n    , m_inputFd (input_fd)\n    , m_scannedType (Type::Unspec)\n    , m_lineNumber (1)\n    , m_scandataBuffer (0)\n    , m_scandataBufferSize (0)\n    , m_buffered (false)\n    , m_globalTable (0)\n    , m_localTable (0)\n    , m_owningGlobal (false)\n    , m_owningLocal (false)\n{\n    m_scannedValue.sval = 0;\n    builtinTable = static_declarations.symbolTable();\n    y2debug( \"Scanner setting builtinTable to %p\", builtinTable );\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern SymbolTable* builtinTable;",
      "extern StaticDeclaration static_declarations;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Scanner setting builtinTable to %p\"",
            "builtinTable"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_declarations.symbolTable",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nextern SymbolTable* builtinTable;\nextern StaticDeclaration static_declarations;\n\nScanner {\n  Scanner::Scanner (int input_fd, const char *fname)\n      : m_filename (fname ? fname : \"\")\n      , m_inputBuffer (0)\n      , m_inputFile (0)\n      , m_inputFd (input_fd)\n      , m_scannedType (Type::Unspec)\n      , m_lineNumber (1)\n      , m_scandataBuffer (0)\n      , m_scandataBufferSize (0)\n      , m_buffered (false)\n      , m_globalTable (0)\n      , m_localTable (0)\n      , m_owningGlobal (false)\n      , m_owningLocal (false)\n  {\n      m_scannedValue.sval = 0;\n      builtinTable = static_declarations.symbolTable();\n      y2debug( \"Scanner setting builtinTable to %p\", builtinTable );\n  }\n}"
  },
  {
    "function_name": "Scanner",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "70-88",
    "snippet": "Scanner::Scanner (const char *inputbuffer)\n    : m_filename (\"\")\n    , m_inputBuffer (inputbuffer)\n    , m_inputFile (0)\n    , m_inputFd (-1)\n    , m_scannedType (Type::Unspec)\n    , m_lineNumber (1)\n    , m_scandataBuffer (0)\n    , m_scandataBufferSize (0)\n    , m_buffered (false)\n    , m_globalTable (0)\n    , m_localTable (0)\n    , m_owningGlobal (false)\n    , m_owningLocal (false)\n{\n    m_scannedValue.val = 0;\n    builtinTable = static_declarations.symbolTable();\n    y2debug( \"Scanner setting builtinTable to %p\", builtinTable );\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern SymbolTable* builtinTable;",
      "extern StaticDeclaration static_declarations;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Scanner setting builtinTable to %p\"",
            "builtinTable"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_declarations.symbolTable",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nextern SymbolTable* builtinTable;\nextern StaticDeclaration static_declarations;\n\nScanner {\n  Scanner::Scanner (const char *inputbuffer)\n      : m_filename (\"\")\n      , m_inputBuffer (inputbuffer)\n      , m_inputFile (0)\n      , m_inputFd (-1)\n      , m_scannedType (Type::Unspec)\n      , m_lineNumber (1)\n      , m_scandataBuffer (0)\n      , m_scandataBufferSize (0)\n      , m_buffered (false)\n      , m_globalTable (0)\n      , m_localTable (0)\n      , m_owningGlobal (false)\n      , m_owningLocal (false)\n  {\n      m_scannedValue.val = 0;\n      builtinTable = static_declarations.symbolTable();\n      y2debug( \"Scanner setting builtinTable to %p\", builtinTable );\n  }\n}"
  },
  {
    "function_name": "Scanner",
    "container": "Scanner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
    "lines": "49-67",
    "snippet": "Scanner::Scanner (FILE *inputfile, const char *fname)\n    : m_filename (fname ? fname : \"\")\n    , m_inputBuffer (0)\n    , m_inputFile (inputfile)\n    , m_inputFd (-1)\n    , m_scannedType (Type::Unspec)\n    , m_lineNumber (1)\n    , m_scandataBuffer (0)\n    , m_scandataBufferSize (0)\n    , m_buffered (false)\n    , m_globalTable (0)\n    , m_localTable (0)\n    , m_owningGlobal (false)\n    , m_owningLocal (false)\n{\n    m_scannedValue.val = 0;\n    builtinTable = static_declarations.symbolTable();\n    y2debug( \"Scanner setting builtinTable to %p\", builtinTable );\n}",
    "includes": [
      "#include \"ycp/SymbolTable.h\"",
      "#include \"ycp/y2log.h\"",
      "#include \"ycp/Scanner.h\"",
      "#include <errno.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern SymbolTable* builtinTable;",
      "extern StaticDeclaration static_declarations;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Scanner setting builtinTable to %p\"",
            "builtinTable"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_declarations.symbolTable",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nextern SymbolTable* builtinTable;\nextern StaticDeclaration static_declarations;\n\nScanner {\n  Scanner::Scanner (FILE *inputfile, const char *fname)\n      : m_filename (fname ? fname : \"\")\n      , m_inputBuffer (0)\n      , m_inputFile (inputfile)\n      , m_inputFd (-1)\n      , m_scannedType (Type::Unspec)\n      , m_lineNumber (1)\n      , m_scandataBuffer (0)\n      , m_scandataBufferSize (0)\n      , m_buffered (false)\n      , m_globalTable (0)\n      , m_localTable (0)\n      , m_owningGlobal (false)\n      , m_owningLocal (false)\n  {\n      m_scannedValue.val = 0;\n      builtinTable = static_declarations.symbolTable();\n      y2debug( \"Scanner setting builtinTable to %p\", builtinTable );\n  }\n}"
  }
]