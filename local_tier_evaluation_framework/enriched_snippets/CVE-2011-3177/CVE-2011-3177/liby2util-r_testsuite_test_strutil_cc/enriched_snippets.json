[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/testsuite/test_strutil.cc",
    "lines": "37-67",
    "snippet": "int main()\n{\n  set_log_filename(\"-\");\n  DBG << \"START\" << endl;\n\n  chkul( \"\" );\n  chkul( \"aBcDeF\" );\n\n  chktr( \"\" );\n  chktr( \" \\t \\n \" );\n  chktr( \"a  aa\" );\n  chktr( \" a  aa   \" );\n\n  chksp( \"\" );\n  chksp( \":\" );\n  chksp( \"a\" );\n  chksp( \"::a\" );\n  chksp( \"::a::\" );\n  chksp( \"::a::b:c::\" );\n\n  chksp( \"\", true );\n  chksp( \":\", true  );\n  chksp( \"a\", true  );\n  chksp( \":a\", true  );\n  chksp( \"a:\", true  );\n  chksp( \":a:\", true  );\n\n\n  DBG << \"==================================\" << endl;\n  return 0;\n}",
    "includes": [
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "chksp",
          "args": [
            "\":a:\"",
            "true"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chksp",
          "args": [
            "\"a:\"",
            "true"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chksp",
          "args": [
            "\":a\"",
            "true"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chksp",
          "args": [
            "\"a\"",
            "true"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chksp",
          "args": [
            "\":\"",
            "true"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chksp",
          "args": [
            "\"\"",
            "true"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chksp",
          "args": [
            "\"::a::b:c::\""
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "chksp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/testsuite/test_strutil.cc",
          "lines": "8-22",
          "snippet": "void chksp( const std::string & line_r,\n\t    const bool          singlesep_r = false,\n\t    const std::string & sep_t       = \":\" ) {\n  std::vector<std::string> words_r;\n  unsigned n = split( line_r, words_r, sep_t, singlesep_r );\n  SEC << '\"' << line_r << '\"'\n    << \"\\t-> words \" << n << \"\\t\";\n  if ( words_r.size() ) {\n    SEC << \"|\";\n    for ( unsigned i = 0; i < words_r.size(); ++i ) {\n      SEC << words_r[i] << \"|\";\n    }\n  }\n  SEC << endl;\n}",
          "includes": [
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iostream>\n\nvoid chksp( const std::string & line_r,\n\t    const bool          singlesep_r = false,\n\t    const std::string & sep_t       = \":\" ) {\n  std::vector<std::string> words_r;\n  unsigned n = split( line_r, words_r, sep_t, singlesep_r );\n  SEC << '\"' << line_r << '\"'\n    << \"\\t-> words \" << n << \"\\t\";\n  if ( words_r.size() ) {\n    SEC << \"|\";\n    for ( unsigned i = 0; i < words_r.size(); ++i ) {\n      SEC << words_r[i] << \"|\";\n    }\n  }\n  SEC << endl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "chktr",
          "args": [
            "\" a  aa   \""
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "chktr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/testsuite/test_strutil.cc",
          "lines": "24-29",
          "snippet": "void chktr( const std::string & line_r ) {\n  MIL << \"->\" << '\"' << line_r << '\"' << endl;\n  MIL << \" l\" << '\"' << ltrim(line_r) << '\"' << endl;\n  MIL << \" r\" << '\"' << rtrim(line_r) << '\"' << endl;\n  MIL << \" t\" << '\"' <<  trim(line_r) << '\"' << endl;\n}",
          "includes": [
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iostream>\n\nvoid chktr( const std::string & line_r ) {\n  MIL << \"->\" << '\"' << line_r << '\"' << endl;\n  MIL << \" l\" << '\"' << ltrim(line_r) << '\"' << endl;\n  MIL << \" r\" << '\"' << rtrim(line_r) << '\"' << endl;\n  MIL << \" t\" << '\"' <<  trim(line_r) << '\"' << endl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "chkul",
          "args": [
            "\"aBcDeF\""
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "chkul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/testsuite/test_strutil.cc",
          "lines": "31-35",
          "snippet": "void chkul( const std::string & line_r ) {\n  MIL << \"->\" << '\"' << line_r << '\"' << endl;\n  MIL << \" l\" << '\"' << toLower(line_r) << '\"' << endl;\n  MIL << \" u\" << '\"' << toUpper(line_r) << '\"' << endl;\n}",
          "includes": [
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iostream>\n\nvoid chkul( const std::string & line_r ) {\n  MIL << \"->\" << '\"' << line_r << '\"' << endl;\n  MIL << \" l\" << '\"' << toLower(line_r) << '\"' << endl;\n  MIL << \" u\" << '\"' << toUpper(line_r) << '\"' << endl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_log_filename",
          "args": [
            "\"-\""
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "set_log_filename",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/y2changes.cc",
          "lines": "188-240",
          "snippet": "static void set_log_filename (string fname)\n{\n    did_set_logname = true;\n\n    if(log_to_syslog) openlog(\"yast2\", LOG_PID, LOG_DAEMON);\n    if(!log_to_file) return;\n\n    struct passwd *pw = getpwuid( geteuid() );\n    const char *filename = fname.c_str();\n\n    char *env_maxlogsize = getenv(Y2CHANGES_VAR_SIZE);\n    if ( env_maxlogsize ) {\n      stringutil::strtonum( env_maxlogsize, maxlogsize );\n      // prevent overflow (#156149)\n      const off_t limit = std::numeric_limits<off_t>::max();\n      const off_t limit_k = limit / 1024;\n      if (maxlogsize <= limit_k)\n\t  maxlogsize *= 1024;\n      else\n\t  maxlogsize = limit;\n    } else \n      maxlogsize = Y2CHANGES_MAXSIZE;\n\n    char *env_maxlognum = getenv(Y2CHANGES_VAR_NUM);\n    maxlognum = env_maxlognum ? atoi(env_maxlognum) : Y2CHANGES_MAXNUM;\n\n    /* Assign logfile name */\n\n    if ((filename == 0) || (*filename == 0))\n    {\t\t/* No filename --> use defaults */\n\tif (geteuid()) {\t\t\t/* Non root */\n\t    if (!pw)\n\t    {\n\t\tfprintf( Y2CHANGES_STDERR,\n\t\t\t \"Cannot read pwd entry of user id %d. Logfile will be '%s'.\\n\",\n\t\t\t geteuid(), Y2CHANGES_FALLBACK );\n\n\t\tlogname = Y2CHANGES_FALLBACK;\n\t    }\n\t    else\n\t    {\n\t\t// never freed\n\t\tchar * my_logname = (char *)malloc (strlen (pw->pw_dir) + strlen (Y2CHANGES_USER) + 1);\n\t\tstrcpy (my_logname, pw->pw_dir);\n\t\tlogname = strcat (my_logname, Y2CHANGES_USER);\n\t    }\n\t}\n\telse\t\t    /* Root */\n\t    logname = Y2CHANGES_ROOT;\n    }\n    else\n\tlogname = strdup (filename);  /* Explicit assignment */\n}",
          "includes": [
            "#include <syslog.h>",
            "#include \"y2util/PathInfo.h\"",
            "#include \"y2util/stringutil.h\"",
            "#include \"y2util/y2changes.h\"",
            "#include <list>",
            "#include <limits>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <pwd.h>",
            "#include <malloc.h>",
            "#include <fcntl.h>",
            "#include <errno.h>"
          ],
          "macros_used": [
            "#define Y2CHANGES_VAR_NUM\t\"Y2MAXLOGNUM\"",
            "#define Y2CHANGES_VAR_SIZE\t\"Y2MAXLOGSIZE\"",
            "#define Y2CHANGES_FALLBACK\t\"/y2changes\"",
            "#define Y2CHANGES_USER\t\"/.y2changes\"\t\t/* Relative to $HOME */",
            "#define Y2CHANGES_ROOT\tLOGDIR \"/y2changes\"",
            "#define Y2CHANGES_MAXNUM\t10\t\t\t/* Maximum logfiles number */",
            "#define Y2CHANGES_MAXSIZE\t10* 1024 * 1024\t\t/* Maximal logfile size */"
          ],
          "globals_used": [
            "static bool did_set_logname = false;",
            "static const char *logname;",
            "static off_t maxlogsize;",
            "static int   maxlognum;",
            "static bool log_to_file = true;",
            "static bool log_to_syslog = false;",
            "static FILE *Y2CHANGES_STDERR = stderr;",
            "static void shift_log_files(string filename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <syslog.h>\n#include \"y2util/PathInfo.h\"\n#include \"y2util/stringutil.h\"\n#include \"y2util/y2changes.h\"\n#include <list>\n#include <limits>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <pwd.h>\n#include <malloc.h>\n#include <fcntl.h>\n#include <errno.h>\n\n#define Y2CHANGES_VAR_NUM\t\"Y2MAXLOGNUM\"\n#define Y2CHANGES_VAR_SIZE\t\"Y2MAXLOGSIZE\"\n#define Y2CHANGES_FALLBACK\t\"/y2changes\"\n#define Y2CHANGES_USER\t\"/.y2changes\"\t\t/* Relative to $HOME */\n#define Y2CHANGES_ROOT\tLOGDIR \"/y2changes\"\n#define Y2CHANGES_MAXNUM\t10\t\t\t/* Maximum logfiles number */\n#define Y2CHANGES_MAXSIZE\t10* 1024 * 1024\t\t/* Maximal logfile size */\n\nstatic bool did_set_logname = false;\nstatic const char *logname;\nstatic off_t maxlogsize;\nstatic int   maxlognum;\nstatic bool log_to_file = true;\nstatic bool log_to_syslog = false;\nstatic FILE *Y2CHANGES_STDERR = stderr;\nstatic void shift_log_files(string filename);\n\nstatic void set_log_filename (string fname)\n{\n    did_set_logname = true;\n\n    if(log_to_syslog) openlog(\"yast2\", LOG_PID, LOG_DAEMON);\n    if(!log_to_file) return;\n\n    struct passwd *pw = getpwuid( geteuid() );\n    const char *filename = fname.c_str();\n\n    char *env_maxlogsize = getenv(Y2CHANGES_VAR_SIZE);\n    if ( env_maxlogsize ) {\n      stringutil::strtonum( env_maxlogsize, maxlogsize );\n      // prevent overflow (#156149)\n      const off_t limit = std::numeric_limits<off_t>::max();\n      const off_t limit_k = limit / 1024;\n      if (maxlogsize <= limit_k)\n\t  maxlogsize *= 1024;\n      else\n\t  maxlogsize = limit;\n    } else \n      maxlogsize = Y2CHANGES_MAXSIZE;\n\n    char *env_maxlognum = getenv(Y2CHANGES_VAR_NUM);\n    maxlognum = env_maxlognum ? atoi(env_maxlognum) : Y2CHANGES_MAXNUM;\n\n    /* Assign logfile name */\n\n    if ((filename == 0) || (*filename == 0))\n    {\t\t/* No filename --> use defaults */\n\tif (geteuid()) {\t\t\t/* Non root */\n\t    if (!pw)\n\t    {\n\t\tfprintf( Y2CHANGES_STDERR,\n\t\t\t \"Cannot read pwd entry of user id %d. Logfile will be '%s'.\\n\",\n\t\t\t geteuid(), Y2CHANGES_FALLBACK );\n\n\t\tlogname = Y2CHANGES_FALLBACK;\n\t    }\n\t    else\n\t    {\n\t\t// never freed\n\t\tchar * my_logname = (char *)malloc (strlen (pw->pw_dir) + strlen (Y2CHANGES_USER) + 1);\n\t\tstrcpy (my_logname, pw->pw_dir);\n\t\tlogname = strcat (my_logname, Y2CHANGES_USER);\n\t    }\n\t}\n\telse\t\t    /* Root */\n\t    logname = Y2CHANGES_ROOT;\n    }\n    else\n\tlogname = strdup (filename);  /* Explicit assignment */\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iostream>\n\nint main()\n{\n  set_log_filename(\"-\");\n  DBG << \"START\" << endl;\n\n  chkul( \"\" );\n  chkul( \"aBcDeF\" );\n\n  chktr( \"\" );\n  chktr( \" \\t \\n \" );\n  chktr( \"a  aa\" );\n  chktr( \" a  aa   \" );\n\n  chksp( \"\" );\n  chksp( \":\" );\n  chksp( \"a\" );\n  chksp( \"::a\" );\n  chksp( \"::a::\" );\n  chksp( \"::a::b:c::\" );\n\n  chksp( \"\", true );\n  chksp( \":\", true  );\n  chksp( \"a\", true  );\n  chksp( \":a\", true  );\n  chksp( \"a:\", true  );\n  chksp( \":a:\", true  );\n\n\n  DBG << \"==================================\" << endl;\n  return 0;\n}"
  },
  {
    "function_name": "chkul",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/testsuite/test_strutil.cc",
    "lines": "31-35",
    "snippet": "void chkul( const std::string & line_r ) {\n  MIL << \"->\" << '\"' << line_r << '\"' << endl;\n  MIL << \" l\" << '\"' << toLower(line_r) << '\"' << endl;\n  MIL << \" u\" << '\"' << toUpper(line_r) << '\"' << endl;\n}",
    "includes": [
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "toUpper",
          "args": [
            "line_r"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "toUpper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/stringutil.cc",
          "lines": "248-259",
          "snippet": "std::string toUpper( const std::string & s )\n{\n  if ( s.empty() )\n    return s;\n\n  string ret( s );\n  for ( string::size_type i = 0; i < ret.length(); ++i ) {\n    if ( islower( ret[i] ) )\n      ret[i] = static_cast<char>(toupper( ret[i] ));\n  }\n  return ret;\n}",
          "includes": [
            "#include <y2util/stringutil.h>",
            "#include <fstream>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/stringutil.h>\n#include <fstream>\n#include <iostream>\n\nstd::string toUpper( const std::string & s )\n{\n  if ( s.empty() )\n    return s;\n\n  string ret( s );\n  for ( string::size_type i = 0; i < ret.length(); ++i ) {\n    if ( islower( ret[i] ) )\n      ret[i] = static_cast<char>(toupper( ret[i] ));\n  }\n  return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "toLower",
          "args": [
            "line_r"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "toLower",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/stringutil.cc",
          "lines": "227-238",
          "snippet": "std::string toLower( const std::string & s )\n{\n  if ( s.empty() )\n    return s;\n\n  string ret( s );\n  for ( string::size_type i = 0; i < ret.length(); ++i ) {\n    if ( isupper( ret[i] ) )\n      ret[i] = static_cast<char>(tolower( ret[i] ));\n  }\n  return ret;\n}",
          "includes": [
            "#include <y2util/stringutil.h>",
            "#include <fstream>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/stringutil.h>\n#include <fstream>\n#include <iostream>\n\nstd::string toLower( const std::string & s )\n{\n  if ( s.empty() )\n    return s;\n\n  string ret( s );\n  for ( string::size_type i = 0; i < ret.length(); ++i ) {\n    if ( isupper( ret[i] ) )\n      ret[i] = static_cast<char>(tolower( ret[i] ));\n  }\n  return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iostream>\n\nvoid chkul( const std::string & line_r ) {\n  MIL << \"->\" << '\"' << line_r << '\"' << endl;\n  MIL << \" l\" << '\"' << toLower(line_r) << '\"' << endl;\n  MIL << \" u\" << '\"' << toUpper(line_r) << '\"' << endl;\n}"
  },
  {
    "function_name": "chktr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/testsuite/test_strutil.cc",
    "lines": "24-29",
    "snippet": "void chktr( const std::string & line_r ) {\n  MIL << \"->\" << '\"' << line_r << '\"' << endl;\n  MIL << \" l\" << '\"' << ltrim(line_r) << '\"' << endl;\n  MIL << \" r\" << '\"' << rtrim(line_r) << '\"' << endl;\n  MIL << \" t\" << '\"' <<  trim(line_r) << '\"' << endl;\n}",
    "includes": [
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "trim",
          "args": [
            "line_r"
          ],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "rtrim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/stringutil.cc",
          "lines": "207-217",
          "snippet": "std::string rtrim( const std::string & s )\n{\n  if ( s.empty() )\n    return s;\n\n  string::size_type p = s.find_last_not_of( \" \\t\\n\" );\n  if ( p == string::npos )\n    return \"\";\n\n  return s.substr( 0, p+1 );\n}",
          "includes": [
            "#include <y2util/stringutil.h>",
            "#include <fstream>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/stringutil.h>\n#include <fstream>\n#include <iostream>\n\nstd::string rtrim( const std::string & s )\n{\n  if ( s.empty() )\n    return s;\n\n  string::size_type p = s.find_last_not_of( \" \\t\\n\" );\n  if ( p == string::npos )\n    return \"\";\n\n  return s.substr( 0, p+1 );\n}"
        }
      },
      {
        "call_info": {
          "callee": "ltrim",
          "args": [
            "line_r"
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "ltrim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/stringutil.cc",
          "lines": "187-197",
          "snippet": "std::string ltrim( const std::string & s )\n{\n  if ( s.empty() )\n    return s;\n\n  string::size_type p = s.find_first_not_of( \" \\t\\n\" );\n  if ( p == string::npos )\n    return \"\";\n\n  return s.substr( p );\n}",
          "includes": [
            "#include <y2util/stringutil.h>",
            "#include <fstream>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/stringutil.h>\n#include <fstream>\n#include <iostream>\n\nstd::string ltrim( const std::string & s )\n{\n  if ( s.empty() )\n    return s;\n\n  string::size_type p = s.find_first_not_of( \" \\t\\n\" );\n  if ( p == string::npos )\n    return \"\";\n\n  return s.substr( p );\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iostream>\n\nvoid chktr( const std::string & line_r ) {\n  MIL << \"->\" << '\"' << line_r << '\"' << endl;\n  MIL << \" l\" << '\"' << ltrim(line_r) << '\"' << endl;\n  MIL << \" r\" << '\"' << rtrim(line_r) << '\"' << endl;\n  MIL << \" t\" << '\"' <<  trim(line_r) << '\"' << endl;\n}"
  },
  {
    "function_name": "chksp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/testsuite/test_strutil.cc",
    "lines": "8-22",
    "snippet": "void chksp( const std::string & line_r,\n\t    const bool          singlesep_r = false,\n\t    const std::string & sep_t       = \":\" ) {\n  std::vector<std::string> words_r;\n  unsigned n = split( line_r, words_r, sep_t, singlesep_r );\n  SEC << '\"' << line_r << '\"'\n    << \"\\t-> words \" << n << \"\\t\";\n  if ( words_r.size() ) {\n    SEC << \"|\";\n    for ( unsigned i = 0; i < words_r.size(); ++i ) {\n      SEC << words_r[i] << \"|\";\n    }\n  }\n  SEC << endl;\n}",
    "includes": [
      "#include <y2util/stringutil.h>",
      "#include <y2util/Y2SLog.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "words_r.size",
          "args": [],
          "line": 17
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "split",
          "args": [
            "line_r",
            "words_r",
            "sep_t",
            "singlesep_r"
          ],
          "line": 12
        },
        "resolved": true,
        "details": {
          "function_name": "split",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPDebugger.cc",
          "lines": "279-302",
          "snippet": "static int\nsplit (const string &in, int n, string *out, const char *delim)\n{\n    char buffer [in.length () + 1];\n    strcpy (buffer, in.c_str ());\n    char *tmp = buffer;\n\n    int i = 0;\n\n    while (true) {\n\n\tchar *t = strsep (&tmp, delim);\n\n\tif (t == NULL)\n\t    return i;\n\n\tif (*t != '\\0') {\n\t    out[i++] = t;\n\t    if (i == n)\n\t\treturn i;\n\t}\n\n    }\n}",
          "includes": [
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCode.h\"",
            "#include \"ycp/YCPDebugger.h\"",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netdb.h>",
            "#include <netinet/in.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/y2log.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCode.h\"\n#include \"ycp/YCPDebugger.h\"\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netdb.h>\n#include <netinet/in.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n\nstatic int\nsplit (const string &in, int n, string *out, const char *delim)\n{\n    char buffer [in.length () + 1];\n    strcpy (buffer, in.c_str ());\n    char *tmp = buffer;\n\n    int i = 0;\n\n    while (true) {\n\n\tchar *t = strsep (&tmp, delim);\n\n\tif (t == NULL)\n\t    return i;\n\n\tif (*t != '\\0') {\n\t    out[i++] = t;\n\t    if (i == n)\n\t\treturn i;\n\t}\n\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iostream>\n\nvoid chksp( const std::string & line_r,\n\t    const bool          singlesep_r = false,\n\t    const std::string & sep_t       = \":\" ) {\n  std::vector<std::string> words_r;\n  unsigned n = split( line_r, words_r, sep_t, singlesep_r );\n  SEC << '\"' << line_r << '\"'\n    << \"\\t-> words \" << n << \"\\t\";\n  if ( words_r.size() ) {\n    SEC << \"|\";\n    for ( unsigned i = 0; i < words_r.size(); ++i ) {\n      SEC << words_r[i] << \"|\";\n    }\n  }\n  SEC << endl;\n}"
  }
]