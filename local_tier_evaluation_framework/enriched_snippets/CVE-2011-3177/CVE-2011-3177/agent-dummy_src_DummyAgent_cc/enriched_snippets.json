[
  {
    "function_name": "checkPath",
    "container": "DummyAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-dummy/src/DummyAgent.cc",
    "lines": "223-250",
    "snippet": "YCPValue DummyAgent::checkPath (const YCPPath& path, const YCPMap& map, const YCPValue& defaultVal)\n{\n    y2debug(\"checkPath (%s, %s, %s)\", path->toString().c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n\n    if (path->isRoot())\n        return defaultVal;\n\n    /* try to access map element as path */\n    YCPValue v = map->value(path->at (0));\n\n    /* path access failed, try as string */\n    if (v.isNull()) {\n        v = map->value (YCPString (path->component_str (0)));\n        if (v.isNull()) {\n            y2warning(\"Default value: no key '%s' in %s (%s)\", path->component_str (0).c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n            return defaultVal;\n        }\n    }\n\n    /* path is longer, recursive call */\n    if ((path->length() > 1)\n        && (v->isMap())) {\n        YCPPath subpath = path;\n        return checkPath (subpath->select (path->at (1))->asPath(), v->asMap(), defaultVal);\n    }\n\n    return v;\n}",
    "includes": [
      "#include \"DummyAgent.h\"",
      "#include <ycp/y2log.h>",
      "#include <YCP.h>",
      "#include <string>",
      "#include <sys/types.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkPath",
          "args": [
            "subpath->select (path->at (1))->asPath()",
            "v->asMap()",
            "defaultVal"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "checkPath",
          "container": "DummyAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-dummy/src/DummyAgent.cc",
          "lines": "223-250",
          "snippet": "YCPValue DummyAgent::checkPath (const YCPPath& path, const YCPMap& map, const YCPValue& defaultVal)\n{\n    y2debug(\"checkPath (%s, %s, %s)\", path->toString().c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n\n    if (path->isRoot())\n        return defaultVal;\n\n    /* try to access map element as path */\n    YCPValue v = map->value(path->at (0));\n\n    /* path access failed, try as string */\n    if (v.isNull()) {\n        v = map->value (YCPString (path->component_str (0)));\n        if (v.isNull()) {\n            y2warning(\"Default value: no key '%s' in %s (%s)\", path->component_str (0).c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n            return defaultVal;\n        }\n    }\n\n    /* path is longer, recursive call */\n    if ((path->length() > 1)\n        && (v->isMap())) {\n        YCPPath subpath = path;\n        return checkPath (subpath->select (path->at (1))->asPath(), v->asMap(), defaultVal);\n    }\n\n    return v;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "v->asMap",
          "args": [],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "asMap",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "203-213",
          "snippet": "YCPMap\nYCPValueRep::asMap() const\n{\n    if (!isMap())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Map!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPMap (static_cast<const YCPMapRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPMap\n  YCPValueRep::asMap() const\n  {\n      if (!isMap())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Map!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPMap (static_cast<const YCPMapRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "subpath->select",
          "args": [],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "subpath->select",
          "args": [
            "path->at (1)"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "select",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "116-121",
          "snippet": "YCPValue\nYCPPathRep::select(const YCPValue& val)\n{\n    return val; \n    // TODO: do real operation\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  YCPValue\n  YCPPathRep::select(const YCPValue& val)\n  {\n      return val; \n      // TODO: do real operation\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path->at",
          "args": [
            "1"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "at",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "142-149",
          "snippet": "YCPPath\nYCPPathRep::at(long index) const\n{\n    YCPPath postfix;\n    for (int i=index; i<length(); i++)\n\tpostfix->append(components[i]);\n    return postfix;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  YCPPath\n  YCPPathRep::at(long index) const\n  {\n      YCPPath postfix;\n      for (int i=index; i<length(); i++)\n  \tpostfix->append(components[i]);\n      return postfix;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v->isMap",
          "args": [],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "isMap",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "71-71",
          "snippet": "bool YCPValueRep::isMap()         const { return valuetype() == YT_MAP; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isMap()         const { return valuetype() == YT_MAP; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path->length",
          "args": [],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2warning",
          "args": [
            "\"Default value: no key '%s' in %s (%s)\"",
            "path->component_str (0).c_str()",
            "map->toString().c_str()",
            "defaultVal->toString().c_str()"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultVal->toString",
          "args": [],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path->component_str",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->component_str",
          "args": [
            "0"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v.isNull",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map->value",
          "args": [
            "YCPString (path->component_str (0))"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "path->component_str (0)"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "v.isNull",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->isRoot",
          "args": [],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "isRoot",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "83-87",
          "snippet": "bool\nYCPPathRep::isRoot() const\n{\n    return components.empty();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  bool\n  YCPPathRep::isRoot() const\n  {\n      return components.empty();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"checkPath (%s, %s, %s)\"",
            "path->toString().c_str()",
            "map->toString().c_str()",
            "defaultVal->toString().c_str()"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"DummyAgent.h\"\n#include <ycp/y2log.h>\n#include <YCP.h>\n#include <string>\n#include <sys/types.h>\n#include <stdio.h>\n\nDummyAgent {\n  YCPValue DummyAgent::checkPath (const YCPPath& path, const YCPMap& map, const YCPValue& defaultVal)\n  {\n      y2debug(\"checkPath (%s, %s, %s)\", path->toString().c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n  \n      if (path->isRoot())\n          return defaultVal;\n  \n      /* try to access map element as path */\n      YCPValue v = map->value(path->at (0));\n  \n      /* path access failed, try as string */\n      if (v.isNull()) {\n          v = map->value (YCPString (path->component_str (0)));\n          if (v.isNull()) {\n              y2warning(\"Default value: no key '%s' in %s (%s)\", path->component_str (0).c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n              return defaultVal;\n          }\n      }\n  \n      /* path is longer, recursive call */\n      if ((path->length() > 1)\n          && (v->isMap())) {\n          YCPPath subpath = path;\n          return checkPath (subpath->select (path->at (1))->asPath(), v->asMap(), defaultVal);\n      }\n  \n      return v;\n  }\n}"
  },
  {
    "function_name": "otherCommand",
    "container": "DummyAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-dummy/src/DummyAgent.cc",
    "lines": "148-218",
    "snippet": "YCPValue DummyAgent::otherCommand(const YCPTerm& term)\n{\n    // y2debug(\"otherCommand(%s)\",term->toString().c_str());\n    string sym = term->name();\n\n    if (sym == \"DataMap\")\n    {\n\tswitch (term->size())\n\t{\n\t    case 4:\n\n\t\tif ( term->value(2)->isMap() )\n\t\t{\n\t\t    execList->add( term->value(2)->asMap() );\n\t\t}\n\t\telse if ( term->value(2)->isList() )\n\t\t{\n\t\t    execList = term->value(2)->asList();\n\t\t}\n\t\telse\n\t\t{\n\t\t    y2error(\"DataMap() expects map,[map,[map,]]value\");\n\t\t    return YCPNull();\n\t\t}\n\n\t    case 3:\n\n\t\tif ( term->value(1)->isMap() )\n\t\t{\n\t\t    writeList->add( term->value(1)->asMap() );\n\t\t}\n\t\telse if ( term->value(1)->isList() )\n\t\t{\n\t\t    writeList = term->value(1)->asList();\n\t\t}\n\t\telse\n\t\t{\n\t\t    y2error(\"DataMap() expects map,[map,[map,]]value\");\n\t\t    return YCPNull();\n\t\t}\n\n\t    case 2:\n\n\t\tif (term->value(0)->isMap())\n\t\t{\n\t\t    readList->add( term->value(0)->asMap() );\n\t\t}\n\t\telse if (term->value(0)->isList())\n\t\t{\n\t\t    readList = term->value(0)->asList();\n\t\t}\n\t\telse\n\t\t{\n\t\t    y2error(\"DataMap() expects map,[map,[map,]]value\");\n\t\t    return YCPNull();\n\t\t}\n\n\t\tbreak;\n\n\t    default:\n\t\ty2error(\"DataMap() expects map|list,[map|list,[map|list,]]value\");\n\t\treturn YCPNull();\n\t}\n\n\tdefaultValue = term->value (term->size () - 1);\n\treturn YCPVoid();\n    }\n\n    y2error(\"unknown command to DummyAgent\");\n    return YCPNull();\n}",
    "includes": [
      "#include \"DummyAgent.h\"",
      "#include <ycp/y2log.h>",
      "#include <YCP.h>",
      "#include <string>",
      "#include <sys/types.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"unknown command to DummyAgent\""
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPVoid",
          "args": [],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "YCPVoid",
          "container": "YCPVoid",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPVoid.cc",
          "lines": "72-75",
          "snippet": "YCPVoid::YCPVoid ()\n    : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n{\n}",
          "includes": [
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "YCPVoid* YCPVoid::nil = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/y2log.h\"\n\nYCPVoid* YCPVoid::nil = NULL;\n\nYCPVoid {\n  YCPVoid::YCPVoid ()\n      : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "term->value",
          "args": [
            "term->size () - 1"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "term->size",
          "args": [],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"DataMap() expects map|list,[map|list,[map|list,]]value\""
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"DataMap() expects map,[map,[map,]]value\""
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "term->value",
          "args": [],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readList->add",
          "args": [
            "term->value(0)->asMap()"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"DataMap() expects map,[map,[map,]]value\""
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"DataMap() expects map,[map,[map,]]value\""
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "term->name",
          "args": [],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "name",
          "container": "Y2AgentComp",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libscr/src/include/scr/Y2AgentComponent.h",
          "lines": "44-44",
          "snippet": "string name () const { return my_name; }",
          "includes": [
            "#include <ycp/YCPTerm.h>",
            "#include <ycp/YCPVoid.h>",
            "#include <ycp/YCPCode.h>",
            "#include <y2/Y2Component.h>",
            "#include <ycp/YCPTerm.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ycp/YCPTerm.h>\n#include <ycp/YCPVoid.h>\n#include <ycp/YCPCode.h>\n#include <y2/Y2Component.h>\n#include <ycp/YCPTerm.h>\n#include <ycp/y2log.h>\n\nY2AgentComp {\n  string name () const { return my_name; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"DummyAgent.h\"\n#include <ycp/y2log.h>\n#include <YCP.h>\n#include <string>\n#include <sys/types.h>\n#include <stdio.h>\n\nDummyAgent {\n  YCPValue DummyAgent::otherCommand(const YCPTerm& term)\n  {\n      // y2debug(\"otherCommand(%s)\",term->toString().c_str());\n      string sym = term->name();\n  \n      if (sym == \"DataMap\")\n      {\n  \tswitch (term->size())\n  \t{\n  \t    case 4:\n  \n  \t\tif ( term->value(2)->isMap() )\n  \t\t{\n  \t\t    execList->add( term->value(2)->asMap() );\n  \t\t}\n  \t\telse if ( term->value(2)->isList() )\n  \t\t{\n  \t\t    execList = term->value(2)->asList();\n  \t\t}\n  \t\telse\n  \t\t{\n  \t\t    y2error(\"DataMap() expects map,[map,[map,]]value\");\n  \t\t    return YCPNull();\n  \t\t}\n  \n  \t    case 3:\n  \n  \t\tif ( term->value(1)->isMap() )\n  \t\t{\n  \t\t    writeList->add( term->value(1)->asMap() );\n  \t\t}\n  \t\telse if ( term->value(1)->isList() )\n  \t\t{\n  \t\t    writeList = term->value(1)->asList();\n  \t\t}\n  \t\telse\n  \t\t{\n  \t\t    y2error(\"DataMap() expects map,[map,[map,]]value\");\n  \t\t    return YCPNull();\n  \t\t}\n  \n  \t    case 2:\n  \n  \t\tif (term->value(0)->isMap())\n  \t\t{\n  \t\t    readList->add( term->value(0)->asMap() );\n  \t\t}\n  \t\telse if (term->value(0)->isList())\n  \t\t{\n  \t\t    readList = term->value(0)->asList();\n  \t\t}\n  \t\telse\n  \t\t{\n  \t\t    y2error(\"DataMap() expects map,[map,[map,]]value\");\n  \t\t    return YCPNull();\n  \t\t}\n  \n  \t\tbreak;\n  \n  \t    default:\n  \t\ty2error(\"DataMap() expects map|list,[map|list,[map|list,]]value\");\n  \t\treturn YCPNull();\n  \t}\n  \n  \tdefaultValue = term->value (term->size () - 1);\n  \treturn YCPVoid();\n      }\n  \n      y2error(\"unknown command to DummyAgent\");\n      return YCPNull();\n  }\n}"
  },
  {
    "function_name": "Dir",
    "container": "DummyAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-dummy/src/DummyAgent.cc",
    "lines": "122-143",
    "snippet": "YCPList DummyAgent::Dir(const YCPPath& path)\n{\n    YCPList l;\n\n    if (!readList.isNull() && !readList->isEmpty())\n    {\n\tYCPValue v = checkPath(path, (readList->value(readCalls))->asMap(), defaultValue);\n\tif (v->isMap ())\n\t{\n\t    YCPMap::const_iterator it = v->asMap()->begin();\n\t    for(;it!=v->asMap()->end();it++)\n\t    {\n\t\tl->add (it->first);\n\t    }\n\t}\n    }\n\n    ycpdebug(\"%sDir\t%s: %s\", DUMMY_LOG_STRING,\n\t    path->toString().c_str(), l->toString ().c_str ());\n\n    return l;\n}",
    "includes": [
      "#include \"DummyAgent.h\"",
      "#include <ycp/y2log.h>",
      "#include <YCP.h>",
      "#include <string>",
      "#include <sys/types.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define DUMMY_LOG_STRING \"LOGTHIS_SECRET_314 \""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ycpdebug",
          "args": [
            "\"%sDir\t%s: %s\"",
            "DUMMY_LOG_STRING",
            "path->toString().c_str()",
            "l->toString ().c_str ()"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l->toString",
          "args": [],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YCPSymbolRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPSymbol.cc",
          "lines": "62-66",
          "snippet": "string\nYCPSymbolRep::toString() const\n{\n    return string(\"`\") + v.asString();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/y2log.h\"\n\nYCPSymbolRep {\n  string\n  YCPSymbolRep::toString() const\n  {\n      return string(\"`\") + v.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path->toString",
          "args": [],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "l->add",
          "args": [
            "it->first"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v->asMap",
          "args": [],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "asMap",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "203-213",
          "snippet": "YCPMap\nYCPValueRep::asMap() const\n{\n    if (!isMap())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Map!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPMap (static_cast<const YCPMapRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPMap\n  YCPValueRep::asMap() const\n  {\n      if (!isMap())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Map!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPMap (static_cast<const YCPMapRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v->isMap",
          "args": [],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "isMap",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "71-71",
          "snippet": "bool YCPValueRep::isMap()         const { return valuetype() == YT_MAP; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isMap()         const { return valuetype() == YT_MAP; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkPath",
          "args": [
            "path",
            "(readList->value(readCalls))->asMap()",
            "defaultValue"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "checkPath",
          "container": "DummyAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-dummy/src/DummyAgent.cc",
          "lines": "223-250",
          "snippet": "YCPValue DummyAgent::checkPath (const YCPPath& path, const YCPMap& map, const YCPValue& defaultVal)\n{\n    y2debug(\"checkPath (%s, %s, %s)\", path->toString().c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n\n    if (path->isRoot())\n        return defaultVal;\n\n    /* try to access map element as path */\n    YCPValue v = map->value(path->at (0));\n\n    /* path access failed, try as string */\n    if (v.isNull()) {\n        v = map->value (YCPString (path->component_str (0)));\n        if (v.isNull()) {\n            y2warning(\"Default value: no key '%s' in %s (%s)\", path->component_str (0).c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n            return defaultVal;\n        }\n    }\n\n    /* path is longer, recursive call */\n    if ((path->length() > 1)\n        && (v->isMap())) {\n        YCPPath subpath = path;\n        return checkPath (subpath->select (path->at (1))->asPath(), v->asMap(), defaultVal);\n    }\n\n    return v;\n}",
          "includes": [
            "#include \"DummyAgent.h\"",
            "#include <ycp/y2log.h>",
            "#include <YCP.h>",
            "#include <string>",
            "#include <sys/types.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"DummyAgent.h\"\n#include <ycp/y2log.h>\n#include <YCP.h>\n#include <string>\n#include <sys/types.h>\n#include <stdio.h>\n\nDummyAgent {\n  YCPValue DummyAgent::checkPath (const YCPPath& path, const YCPMap& map, const YCPValue& defaultVal)\n  {\n      y2debug(\"checkPath (%s, %s, %s)\", path->toString().c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n  \n      if (path->isRoot())\n          return defaultVal;\n  \n      /* try to access map element as path */\n      YCPValue v = map->value(path->at (0));\n  \n      /* path access failed, try as string */\n      if (v.isNull()) {\n          v = map->value (YCPString (path->component_str (0)));\n          if (v.isNull()) {\n              y2warning(\"Default value: no key '%s' in %s (%s)\", path->component_str (0).c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n              return defaultVal;\n          }\n      }\n  \n      /* path is longer, recursive call */\n      if ((path->length() > 1)\n          && (v->isMap())) {\n          YCPPath subpath = path;\n          return checkPath (subpath->select (path->at (1))->asPath(), v->asMap(), defaultVal);\n      }\n  \n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readList->value",
          "args": [
            "readCalls"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readList->isEmpty",
          "args": [],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "isEmpty",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "101-105",
          "snippet": "bool\nYCPTermRep::isEmpty() const\n{\n  return l->isEmpty();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  bool\n  YCPTermRep::isEmpty() const\n  {\n    return l->isEmpty();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readList.isNull",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"DummyAgent.h\"\n#include <ycp/y2log.h>\n#include <YCP.h>\n#include <string>\n#include <sys/types.h>\n#include <stdio.h>\n\n#define DUMMY_LOG_STRING \"LOGTHIS_SECRET_314 \"\n\nDummyAgent {\n  YCPList DummyAgent::Dir(const YCPPath& path)\n  {\n      YCPList l;\n  \n      if (!readList.isNull() && !readList->isEmpty())\n      {\n  \tYCPValue v = checkPath(path, (readList->value(readCalls))->asMap(), defaultValue);\n  \tif (v->isMap ())\n  \t{\n  \t    YCPMap::const_iterator it = v->asMap()->begin();\n  \t    for(;it!=v->asMap()->end();it++)\n  \t    {\n  \t\tl->add (it->first);\n  \t    }\n  \t}\n      }\n  \n      ycpdebug(\"%sDir\t%s: %s\", DUMMY_LOG_STRING,\n  \t    path->toString().c_str(), l->toString ().c_str ());\n  \n      return l;\n  }\n}"
  },
  {
    "function_name": "Execute",
    "container": "DummyAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-dummy/src/DummyAgent.cc",
    "lines": "93-116",
    "snippet": "YCPValue\nDummyAgent::Execute (const YCPPath& path, const YCPValue& value,\n\t\t     const YCPValue& arg)\n{\n    YCPInteger deflt((long long int)0);\n    YCPValue v = YCPNull();\n\n    if ( !execList.isNull() && !execList->isEmpty() )\n    {\n\tv = checkPath(path, (execList->value(execCalls))->asMap(), deflt);\n\texecCalls = ( execCalls + 1 ) % execList->size();\n    }\n    else\n    {\n\tv = checkPath(path, defaultMap, deflt);\n    }\n    \n    ycpdebug(\"%sExecute\t%s\", DUMMY_LOG_STRING,\n\t    (path->toString() + \" \" + value->toString() +\n\t\t\t      (arg.isNull()?\"\":(\" \"+arg->toString())) +\n\t\t\t      (v.isNull()?\"\":(\" \"+v->toString())) ).c_str());\n\n    return v;\n}",
    "includes": [
      "#include \"DummyAgent.h\"",
      "#include <ycp/y2log.h>",
      "#include <YCP.h>",
      "#include <string>",
      "#include <sys/types.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define DUMMY_LOG_STRING \"LOGTHIS_SECRET_314 \""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ycpdebug",
          "args": [
            "\"%sExecute\t%s\"",
            "DUMMY_LOG_STRING",
            "(path->toString() + \" \" + value->toString() +\n\t\t\t      (arg.isNull()?\"\":(\" \"+arg->toString())) +\n\t\t\t      (v.isNull()?\"\":(\" \"+v->toString())) ).c_str()"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v->toString",
          "args": [],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v.isNull",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arg.isNull",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkPath",
          "args": [
            "path",
            "defaultMap",
            "deflt"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "checkPath",
          "container": "DummyAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-dummy/src/DummyAgent.cc",
          "lines": "223-250",
          "snippet": "YCPValue DummyAgent::checkPath (const YCPPath& path, const YCPMap& map, const YCPValue& defaultVal)\n{\n    y2debug(\"checkPath (%s, %s, %s)\", path->toString().c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n\n    if (path->isRoot())\n        return defaultVal;\n\n    /* try to access map element as path */\n    YCPValue v = map->value(path->at (0));\n\n    /* path access failed, try as string */\n    if (v.isNull()) {\n        v = map->value (YCPString (path->component_str (0)));\n        if (v.isNull()) {\n            y2warning(\"Default value: no key '%s' in %s (%s)\", path->component_str (0).c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n            return defaultVal;\n        }\n    }\n\n    /* path is longer, recursive call */\n    if ((path->length() > 1)\n        && (v->isMap())) {\n        YCPPath subpath = path;\n        return checkPath (subpath->select (path->at (1))->asPath(), v->asMap(), defaultVal);\n    }\n\n    return v;\n}",
          "includes": [
            "#include \"DummyAgent.h\"",
            "#include <ycp/y2log.h>",
            "#include <YCP.h>",
            "#include <string>",
            "#include <sys/types.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"DummyAgent.h\"\n#include <ycp/y2log.h>\n#include <YCP.h>\n#include <string>\n#include <sys/types.h>\n#include <stdio.h>\n\nDummyAgent {\n  YCPValue DummyAgent::checkPath (const YCPPath& path, const YCPMap& map, const YCPValue& defaultVal)\n  {\n      y2debug(\"checkPath (%s, %s, %s)\", path->toString().c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n  \n      if (path->isRoot())\n          return defaultVal;\n  \n      /* try to access map element as path */\n      YCPValue v = map->value(path->at (0));\n  \n      /* path access failed, try as string */\n      if (v.isNull()) {\n          v = map->value (YCPString (path->component_str (0)));\n          if (v.isNull()) {\n              y2warning(\"Default value: no key '%s' in %s (%s)\", path->component_str (0).c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n              return defaultVal;\n          }\n      }\n  \n      /* path is longer, recursive call */\n      if ((path->length() > 1)\n          && (v->isMap())) {\n          YCPPath subpath = path;\n          return checkPath (subpath->select (path->at (1))->asPath(), v->asMap(), defaultVal);\n      }\n  \n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "execList->size",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "execList->value",
          "args": [
            "execCalls"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "execList->isEmpty",
          "args": [],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "isEmpty",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "101-105",
          "snippet": "bool\nYCPTermRep::isEmpty() const\n{\n  return l->isEmpty();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  bool\n  YCPTermRep::isEmpty() const\n  {\n    return l->isEmpty();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "execList.isNull",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"DummyAgent.h\"\n#include <ycp/y2log.h>\n#include <YCP.h>\n#include <string>\n#include <sys/types.h>\n#include <stdio.h>\n\n#define DUMMY_LOG_STRING \"LOGTHIS_SECRET_314 \"\n\nDummyAgent {\n  YCPValue\n  DummyAgent::Execute (const YCPPath& path, const YCPValue& value,\n  \t\t     const YCPValue& arg)\n  {\n      YCPInteger deflt((long long int)0);\n      YCPValue v = YCPNull();\n  \n      if ( !execList.isNull() && !execList->isEmpty() )\n      {\n  \tv = checkPath(path, (execList->value(execCalls))->asMap(), deflt);\n  \texecCalls = ( execCalls + 1 ) % execList->size();\n      }\n      else\n      {\n  \tv = checkPath(path, defaultMap, deflt);\n      }\n      \n      ycpdebug(\"%sExecute\t%s\", DUMMY_LOG_STRING,\n  \t    (path->toString() + \" \" + value->toString() +\n  \t\t\t      (arg.isNull()?\"\":(\" \"+arg->toString())) +\n  \t\t\t      (v.isNull()?\"\":(\" \"+v->toString())) ).c_str());\n  \n      return v;\n  }\n}"
  },
  {
    "function_name": "Write",
    "container": "DummyAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-dummy/src/DummyAgent.cc",
    "lines": "64-87",
    "snippet": "YCPBoolean\nDummyAgent::Write (const YCPPath& path, const YCPValue& value,\n\t\t   const YCPValue& arg)\n{\n    YCPBoolean deflt (true);\n    YCPValue v = YCPNull();\n\n    if ( !writeList.isNull() && !writeList->isEmpty() )\n    {\n\tv = checkPath(path, (writeList->value(writeCalls))->asMap(), deflt);\n\twriteCalls = ( writeCalls + 1 ) % writeList->size();\n    }\n    else\n    {\n\tv = checkPath(path, defaultMap, deflt);\n    }\n\n    ycpdebug(\"%sWrite\t%s\", DUMMY_LOG_STRING,\n\t    (path->toString() + \" \" + value->toString() +\n\t\t\t      (arg.isNull()?\"\":(\" \"+arg->toString())) +\n\t\t\t      (v.isNull()?\"\":(\" \"+v->toString())) ).c_str());\n\n    return v.isNull () ? YCPNull () : v->asBoolean ();\n}",
    "includes": [
      "#include \"DummyAgent.h\"",
      "#include <ycp/y2log.h>",
      "#include <YCP.h>",
      "#include <string>",
      "#include <sys/types.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define DUMMY_LOG_STRING \"LOGTHIS_SECRET_314 \""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "v->asBoolean",
          "args": [],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "asBoolean",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "94-104",
          "snippet": "YCPBoolean\nYCPValueRep::asBoolean() const\n{\n    if (!isBoolean())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Boolean!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPBoolean (static_cast<const YCPBooleanRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPBoolean\n  YCPValueRep::asBoolean() const\n  {\n      if (!isBoolean())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Boolean!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPBoolean (static_cast<const YCPBooleanRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.isNull",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycpdebug",
          "args": [
            "\"%sWrite\t%s\"",
            "DUMMY_LOG_STRING",
            "(path->toString() + \" \" + value->toString() +\n\t\t\t      (arg.isNull()?\"\":(\" \"+arg->toString())) +\n\t\t\t      (v.isNull()?\"\":(\" \"+v->toString())) ).c_str()"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v->toString",
          "args": [],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v.isNull",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arg.isNull",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkPath",
          "args": [
            "path",
            "defaultMap",
            "deflt"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "checkPath",
          "container": "DummyAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-dummy/src/DummyAgent.cc",
          "lines": "223-250",
          "snippet": "YCPValue DummyAgent::checkPath (const YCPPath& path, const YCPMap& map, const YCPValue& defaultVal)\n{\n    y2debug(\"checkPath (%s, %s, %s)\", path->toString().c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n\n    if (path->isRoot())\n        return defaultVal;\n\n    /* try to access map element as path */\n    YCPValue v = map->value(path->at (0));\n\n    /* path access failed, try as string */\n    if (v.isNull()) {\n        v = map->value (YCPString (path->component_str (0)));\n        if (v.isNull()) {\n            y2warning(\"Default value: no key '%s' in %s (%s)\", path->component_str (0).c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n            return defaultVal;\n        }\n    }\n\n    /* path is longer, recursive call */\n    if ((path->length() > 1)\n        && (v->isMap())) {\n        YCPPath subpath = path;\n        return checkPath (subpath->select (path->at (1))->asPath(), v->asMap(), defaultVal);\n    }\n\n    return v;\n}",
          "includes": [
            "#include \"DummyAgent.h\"",
            "#include <ycp/y2log.h>",
            "#include <YCP.h>",
            "#include <string>",
            "#include <sys/types.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"DummyAgent.h\"\n#include <ycp/y2log.h>\n#include <YCP.h>\n#include <string>\n#include <sys/types.h>\n#include <stdio.h>\n\nDummyAgent {\n  YCPValue DummyAgent::checkPath (const YCPPath& path, const YCPMap& map, const YCPValue& defaultVal)\n  {\n      y2debug(\"checkPath (%s, %s, %s)\", path->toString().c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n  \n      if (path->isRoot())\n          return defaultVal;\n  \n      /* try to access map element as path */\n      YCPValue v = map->value(path->at (0));\n  \n      /* path access failed, try as string */\n      if (v.isNull()) {\n          v = map->value (YCPString (path->component_str (0)));\n          if (v.isNull()) {\n              y2warning(\"Default value: no key '%s' in %s (%s)\", path->component_str (0).c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n              return defaultVal;\n          }\n      }\n  \n      /* path is longer, recursive call */\n      if ((path->length() > 1)\n          && (v->isMap())) {\n          YCPPath subpath = path;\n          return checkPath (subpath->select (path->at (1))->asPath(), v->asMap(), defaultVal);\n      }\n  \n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeList->size",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writeList->value",
          "args": [
            "writeCalls"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeList->isEmpty",
          "args": [],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "isEmpty",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "101-105",
          "snippet": "bool\nYCPTermRep::isEmpty() const\n{\n  return l->isEmpty();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  bool\n  YCPTermRep::isEmpty() const\n  {\n    return l->isEmpty();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeList.isNull",
          "args": [],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"DummyAgent.h\"\n#include <ycp/y2log.h>\n#include <YCP.h>\n#include <string>\n#include <sys/types.h>\n#include <stdio.h>\n\n#define DUMMY_LOG_STRING \"LOGTHIS_SECRET_314 \"\n\nDummyAgent {\n  YCPBoolean\n  DummyAgent::Write (const YCPPath& path, const YCPValue& value,\n  \t\t   const YCPValue& arg)\n  {\n      YCPBoolean deflt (true);\n      YCPValue v = YCPNull();\n  \n      if ( !writeList.isNull() && !writeList->isEmpty() )\n      {\n  \tv = checkPath(path, (writeList->value(writeCalls))->asMap(), deflt);\n  \twriteCalls = ( writeCalls + 1 ) % writeList->size();\n      }\n      else\n      {\n  \tv = checkPath(path, defaultMap, deflt);\n      }\n  \n      ycpdebug(\"%sWrite\t%s\", DUMMY_LOG_STRING,\n  \t    (path->toString() + \" \" + value->toString() +\n  \t\t\t      (arg.isNull()?\"\":(\" \"+arg->toString())) +\n  \t\t\t      (v.isNull()?\"\":(\" \"+v->toString())) ).c_str());\n  \n      return v.isNull () ? YCPNull () : v->asBoolean ();\n  }\n}"
  },
  {
    "function_name": "Read",
    "container": "DummyAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-dummy/src/DummyAgent.cc",
    "lines": "37-58",
    "snippet": "YCPValue\nDummyAgent::Read (const YCPPath& path, const YCPValue& arg , const YCPValue&)\n{\n    YCPValue deflt = YCPVoid ();\n    YCPValue v = YCPNull ();\n\n    if (!readList.isNull() && !readList->isEmpty())\n    {\n\tv = checkPath (path, (readList->value(readCalls))->asMap(), defaultValue);\n\treadCalls = ( readCalls + 1 ) % readList->size();\n    }\n    else\n    {\n\tv = checkPath(path, defaultMap, deflt);\n    }\n\n    ycpdebug(\"%sRead\t%s\", DUMMY_LOG_STRING,\n\t    (path->toString() + (arg.isNull()?\"\":(\" \"+arg->toString())) +\n\t\t\t      (v.isNull()?\"\":(\" \"+v->toString())) ).c_str());\n\n    return v;\n}",
    "includes": [
      "#include \"DummyAgent.h\"",
      "#include <ycp/y2log.h>",
      "#include <YCP.h>",
      "#include <string>",
      "#include <sys/types.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define DUMMY_LOG_STRING \"LOGTHIS_SECRET_314 \""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ycpdebug",
          "args": [
            "\"%sRead\t%s\"",
            "DUMMY_LOG_STRING",
            "(path->toString() + (arg.isNull()?\"\":(\" \"+arg->toString())) +\n\t\t\t      (v.isNull()?\"\":(\" \"+v->toString())) ).c_str()"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v->toString",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v.isNull",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arg.isNull",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkPath",
          "args": [
            "path",
            "defaultMap",
            "deflt"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "checkPath",
          "container": "DummyAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-dummy/src/DummyAgent.cc",
          "lines": "223-250",
          "snippet": "YCPValue DummyAgent::checkPath (const YCPPath& path, const YCPMap& map, const YCPValue& defaultVal)\n{\n    y2debug(\"checkPath (%s, %s, %s)\", path->toString().c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n\n    if (path->isRoot())\n        return defaultVal;\n\n    /* try to access map element as path */\n    YCPValue v = map->value(path->at (0));\n\n    /* path access failed, try as string */\n    if (v.isNull()) {\n        v = map->value (YCPString (path->component_str (0)));\n        if (v.isNull()) {\n            y2warning(\"Default value: no key '%s' in %s (%s)\", path->component_str (0).c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n            return defaultVal;\n        }\n    }\n\n    /* path is longer, recursive call */\n    if ((path->length() > 1)\n        && (v->isMap())) {\n        YCPPath subpath = path;\n        return checkPath (subpath->select (path->at (1))->asPath(), v->asMap(), defaultVal);\n    }\n\n    return v;\n}",
          "includes": [
            "#include \"DummyAgent.h\"",
            "#include <ycp/y2log.h>",
            "#include <YCP.h>",
            "#include <string>",
            "#include <sys/types.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"DummyAgent.h\"\n#include <ycp/y2log.h>\n#include <YCP.h>\n#include <string>\n#include <sys/types.h>\n#include <stdio.h>\n\nDummyAgent {\n  YCPValue DummyAgent::checkPath (const YCPPath& path, const YCPMap& map, const YCPValue& defaultVal)\n  {\n      y2debug(\"checkPath (%s, %s, %s)\", path->toString().c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n  \n      if (path->isRoot())\n          return defaultVal;\n  \n      /* try to access map element as path */\n      YCPValue v = map->value(path->at (0));\n  \n      /* path access failed, try as string */\n      if (v.isNull()) {\n          v = map->value (YCPString (path->component_str (0)));\n          if (v.isNull()) {\n              y2warning(\"Default value: no key '%s' in %s (%s)\", path->component_str (0).c_str(), map->toString().c_str(), defaultVal->toString().c_str());\n              return defaultVal;\n          }\n      }\n  \n      /* path is longer, recursive call */\n      if ((path->length() > 1)\n          && (v->isMap())) {\n          YCPPath subpath = path;\n          return checkPath (subpath->select (path->at (1))->asPath(), v->asMap(), defaultVal);\n      }\n  \n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readList->size",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readList->value",
          "args": [
            "readCalls"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readList->isEmpty",
          "args": [],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "isEmpty",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "101-105",
          "snippet": "bool\nYCPTermRep::isEmpty() const\n{\n  return l->isEmpty();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  bool\n  YCPTermRep::isEmpty() const\n  {\n    return l->isEmpty();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readList.isNull",
          "args": [],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPVoid",
          "args": [],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "YCPVoid",
          "container": "YCPVoid",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPVoid.cc",
          "lines": "72-75",
          "snippet": "YCPVoid::YCPVoid ()\n    : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n{\n}",
          "includes": [
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "YCPVoid* YCPVoid::nil = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/y2log.h\"\n\nYCPVoid* YCPVoid::nil = NULL;\n\nYCPVoid {\n  YCPVoid::YCPVoid ()\n      : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n  {\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"DummyAgent.h\"\n#include <ycp/y2log.h>\n#include <YCP.h>\n#include <string>\n#include <sys/types.h>\n#include <stdio.h>\n\n#define DUMMY_LOG_STRING \"LOGTHIS_SECRET_314 \"\n\nDummyAgent {\n  YCPValue\n  DummyAgent::Read (const YCPPath& path, const YCPValue& arg , const YCPValue&)\n  {\n      YCPValue deflt = YCPVoid ();\n      YCPValue v = YCPNull ();\n  \n      if (!readList.isNull() && !readList->isEmpty())\n      {\n  \tv = checkPath (path, (readList->value(readCalls))->asMap(), defaultValue);\n  \treadCalls = ( readCalls + 1 ) % readList->size();\n      }\n      else\n      {\n  \tv = checkPath(path, defaultMap, deflt);\n      }\n  \n      ycpdebug(\"%sRead\t%s\", DUMMY_LOG_STRING,\n  \t    (path->toString() + (arg.isNull()?\"\":(\" \"+arg->toString())) +\n  \t\t\t      (v.isNull()?\"\":(\" \"+v->toString())) ).c_str());\n  \n      return v;\n  }\n}"
  },
  {
    "function_name": "DummyAgent",
    "container": "DummyAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-dummy/src/DummyAgent.cc",
    "lines": "28-32",
    "snippet": "DummyAgent::DummyAgent ()\n    : defaultValue (YCPNull ()),\n      readCalls(0), writeCalls(0), execCalls(0)\n{\n}",
    "includes": [
      "#include \"DummyAgent.h\"",
      "#include <ycp/y2log.h>",
      "#include <YCP.h>",
      "#include <string>",
      "#include <sys/types.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"DummyAgent.h\"\n#include <ycp/y2log.h>\n#include <YCP.h>\n#include <string>\n#include <sys/types.h>\n#include <stdio.h>\n\nDummyAgent {\n  DummyAgent::DummyAgent ()\n      : defaultValue (YCPNull ()),\n        readCalls(0), writeCalls(0), execCalls(0)\n  {\n  }\n}"
  }
]