[
  {
    "function_name": "initializeLists",
    "container": "Y2ComponentBroker",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2ComponentBroker.cc",
    "lines": "199-206",
    "snippet": "void Y2ComponentBroker::initializeLists ()\n{\n    if (creators[0] == 0) {\n\tfor (int order=0; order<MAX_ORDER; order++) {\n\t    creators[order] = new vector<const Y2ComponentCreator *>;\n\t}\n    }\n}",
    "includes": [
      "#include <y2util/y2log.h>",
      "#include <ycp/pathsearch.h>",
      "#include \"Y2ComponentCreator.h\"",
      "#include \"Y2ComponentBroker.h\"",
      "#include <dlfcn.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "vector<const Y2ComponentCreator *> *Y2ComponentBroker::creators[Y2ComponentBroker::MAX_ORDER]\n= { 0, 0, 0, 0, 0 };"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <y2util/y2log.h>\n#include <ycp/pathsearch.h>\n#include \"Y2ComponentCreator.h\"\n#include \"Y2ComponentBroker.h\"\n#include <dlfcn.h>\n#include <stdio.h>\n\nvector<const Y2ComponentCreator *> *Y2ComponentBroker::creators[Y2ComponentBroker::MAX_ORDER]\n= { 0, 0, 0, 0, 0 };\n\nY2ComponentBroker {\n  void Y2ComponentBroker::initializeLists ()\n  {\n      if (creators[0] == 0) {\n  \tfor (int order=0; order<MAX_ORDER; order++) {\n  \t    creators[order] = new vector<const Y2ComponentCreator *>;\n  \t}\n      }\n  }\n}"
  },
  {
    "function_name": "registerNamespaceException",
    "container": "Y2ComponentBroker",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2ComponentBroker.cc",
    "lines": "183-196",
    "snippet": "bool Y2ComponentBroker::registerNamespaceException(const char* name_space, const char* component_name)\n{\n    map<const char*, const Y2Component*, ltstr>::iterator ci = namespaces.find (name_space);\n    if ( ci != namespaces.end () )\n    {\n        const Y2Component *c = ci->second;\n        y2error (\"namespace %s already instantiated by %p\", name_space, c );\n        return false;\n    }\n\n    namespace_exceptions.insert ( std::pair<string,string>(name_space,component_name) );\n    \n    return true;\n}",
    "includes": [
      "#include <y2util/y2log.h>",
      "#include <ycp/pathsearch.h>",
      "#include \"Y2ComponentCreator.h\"",
      "#include \"Y2ComponentBroker.h\"",
      "#include <dlfcn.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "map<const char*, const Y2Component*, Y2ComponentBroker::ltstr> Y2ComponentBroker::namespaces;",
      "map<string, string> Y2ComponentBroker::namespace_exceptions;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "namespace_exceptions.insert",
          "args": [
            "std::pair<string,string>(name_space,component_name)"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::pair<string,string>",
          "args": [
            "name_space",
            "component_name"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"namespace %s already instantiated by %p\"",
            "name_space",
            "c"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "namespaces.end",
          "args": [],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "namespaces.find",
          "args": [
            "name_space"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <y2util/y2log.h>\n#include <ycp/pathsearch.h>\n#include \"Y2ComponentCreator.h\"\n#include \"Y2ComponentBroker.h\"\n#include <dlfcn.h>\n#include <stdio.h>\n\nmap<const char*, const Y2Component*, Y2ComponentBroker::ltstr> Y2ComponentBroker::namespaces;\nmap<string, string> Y2ComponentBroker::namespace_exceptions;\n\nY2ComponentBroker {\n  bool Y2ComponentBroker::registerNamespaceException(const char* name_space, const char* component_name)\n  {\n      map<const char*, const Y2Component*, ltstr>::iterator ci = namespaces.find (name_space);\n      if ( ci != namespaces.end () )\n      {\n          const Y2Component *c = ci->second;\n          y2error (\"namespace %s already instantiated by %p\", name_space, c );\n          return false;\n      }\n  \n      namespace_exceptions.insert ( std::pair<string,string>(name_space,component_name) );\n      \n      return true;\n  }\n}"
  },
  {
    "function_name": "registerComponentCreator",
    "container": "Y2ComponentBroker",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2ComponentBroker.cc",
    "lines": "40-58",
    "snippet": "void Y2ComponentBroker::registerComponentCreator(const Y2ComponentCreator *c, order_t order, bool force)\n{\n    initializeLists();\n\n    // The \"force\" flag is needed by the UI component creator: It resides in a\n    // plug-in (libpy2UI), so it can register itself only when that plug-in is\n    // loaded, by which time registration is already closed. While stopping\n    // registration might make sense for most plug-ins, in this special case it\n    // does not: The UI component creator can create the \"UI\" name space as\n    // well as the \"qt\", \"ncurses\", \"gtk\" UI servers.\n    //\n    // 2008-02-18 sh@suse.de\n    \n    if (!stop_register || force)\n    {\n\t// y2debug( \"Registering component creator at %p - force: %d\", c, (int) force );\n        creators[order]->push_back(c);\n    }\n}",
    "includes": [
      "#include <y2util/y2log.h>",
      "#include <ycp/pathsearch.h>",
      "#include \"Y2ComponentCreator.h\"",
      "#include \"Y2ComponentBroker.h\"",
      "#include <dlfcn.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "vector<const Y2ComponentCreator *> *Y2ComponentBroker::creators[Y2ComponentBroker::MAX_ORDER]\n= { 0, 0, 0, 0, 0 };",
      "bool Y2ComponentBroker::stop_register = false;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "creators[order]->push_back",
          "args": [
            "c"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "push_back",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "70-74",
          "snippet": "void\nYCPListRep::push_back(const YCPValue& value)\n{\n    elements.push_back(value);\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  void\n  YCPListRep::push_back(const YCPValue& value)\n  {\n      elements.push_back(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initializeLists",
          "args": [],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "initializeLists",
          "container": "Y2ComponentBroker",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2/src/Y2ComponentBroker.cc",
          "lines": "199-206",
          "snippet": "void Y2ComponentBroker::initializeLists ()\n{\n    if (creators[0] == 0) {\n\tfor (int order=0; order<MAX_ORDER; order++) {\n\t    creators[order] = new vector<const Y2ComponentCreator *>;\n\t}\n    }\n}",
          "includes": [
            "#include <y2util/y2log.h>",
            "#include <ycp/pathsearch.h>",
            "#include \"Y2ComponentCreator.h\"",
            "#include \"Y2ComponentBroker.h\"",
            "#include <dlfcn.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<const Y2ComponentCreator *> *Y2ComponentBroker::creators[Y2ComponentBroker::MAX_ORDER]\n= { 0, 0, 0, 0, 0 };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/y2log.h>\n#include <ycp/pathsearch.h>\n#include \"Y2ComponentCreator.h\"\n#include \"Y2ComponentBroker.h\"\n#include <dlfcn.h>\n#include <stdio.h>\n\nvector<const Y2ComponentCreator *> *Y2ComponentBroker::creators[Y2ComponentBroker::MAX_ORDER]\n= { 0, 0, 0, 0, 0 };\n\nY2ComponentBroker {\n  void Y2ComponentBroker::initializeLists ()\n  {\n      if (creators[0] == 0) {\n  \tfor (int order=0; order<MAX_ORDER; order++) {\n  \t    creators[order] = new vector<const Y2ComponentCreator *>;\n  \t}\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/y2log.h>\n#include <ycp/pathsearch.h>\n#include \"Y2ComponentCreator.h\"\n#include \"Y2ComponentBroker.h\"\n#include <dlfcn.h>\n#include <stdio.h>\n\nvector<const Y2ComponentCreator *> *Y2ComponentBroker::creators[Y2ComponentBroker::MAX_ORDER]\n= { 0, 0, 0, 0, 0 };\nbool Y2ComponentBroker::stop_register = false;\n\nY2ComponentBroker {\n  void Y2ComponentBroker::registerComponentCreator(const Y2ComponentCreator *c, order_t order, bool force)\n  {\n      initializeLists();\n  \n      // The \"force\" flag is needed by the UI component creator: It resides in a\n      // plug-in (libpy2UI), so it can register itself only when that plug-in is\n      // loaded, by which time registration is already closed. While stopping\n      // registration might make sense for most plug-ins, in this special case it\n      // does not: The UI component creator can create the \"UI\" name space as\n      // well as the \"qt\", \"ncurses\", \"gtk\" UI servers.\n      //\n      // 2008-02-18 sh@suse.de\n      \n      if (!stop_register || force)\n      {\n  \t// y2debug( \"Registering component creator at %p - force: %d\", c, (int) force );\n          creators[order]->push_back(c);\n      }\n  }\n}"
  }
]