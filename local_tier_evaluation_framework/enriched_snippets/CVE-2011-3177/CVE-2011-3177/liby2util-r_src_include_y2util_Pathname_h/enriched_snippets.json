[
  {
    "function_name": "equal",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "86-86",
    "snippet": "bool            equal( const Pathname & r ) const { return equal( *this, r ); }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "equal",
          "args": [
            "*this",
            "r"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "equal",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
          "lines": "277-280",
          "snippet": "bool Pathname::equal( const Pathname & l, const Pathname & r )\n{\n  return l.asString() == r.asString();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool            equal( const Pathname & r ) const { return equal( *this, r ); }\n}"
  },
  {
    "function_name": "extend",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "83-83",
    "snippet": "Pathname        extend( const std::string & r ) const { return extend( *this, r ); }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "extend",
          "args": [
            "*this",
            "r"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "extend",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
          "lines": "264-267",
          "snippet": "Pathname Pathname::extend( const Pathname & l, const string & r )\n{\n  return l.asString() + r;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  Pathname        extend( const std::string & r ) const { return extend( *this, r ); }\n}"
  },
  {
    "function_name": "cat",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "80-80",
    "snippet": "Pathname        cat( const Pathname & r ) const { return cat( *this, r ); }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cat",
          "args": [
            "*this",
            "r"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "cat",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
          "lines": "243-254",
          "snippet": "Pathname Pathname::cat( const Pathname & name_tv, const Pathname & add_tv )\n{\n  if ( add_tv.empty() )\n    return name_tv;\n  if ( name_tv.empty() )\n    return add_tv;\n\n  string ret_ti( add_tv.asString() );\n  ret_ti.replace( 0, add_tv.prfx_i, \"/\" );\n\n  return name_tv.asString() + ret_ti;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  Pathname        cat( const Pathname & r ) const { return cat( *this, r ); }\n}"
  },
  {
    "function_name": "relativename",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "78-78",
    "snippet": "static Pathname    relativename( const Pathname & name_tv ) { return name_tv.absolute() ? cat( \".\", name_tv ) : name_tv; }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cat",
          "args": [
            "\".\"",
            "name_tv"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "cat",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
          "lines": "243-254",
          "snippet": "Pathname Pathname::cat( const Pathname & name_tv, const Pathname & add_tv )\n{\n  if ( add_tv.empty() )\n    return name_tv;\n  if ( name_tv.empty() )\n    return add_tv;\n\n  string ret_ti( add_tv.asString() );\n  ret_ti.replace( 0, add_tv.prfx_i, \"/\" );\n\n  return name_tv.asString() + ret_ti;\n}",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nPathname {\n  Pathname Pathname::cat( const Pathname & name_tv, const Pathname & add_tv )\n  {\n    if ( add_tv.empty() )\n      return name_tv;\n    if ( name_tv.empty() )\n      return add_tv;\n  \n    string ret_ti( add_tv.asString() );\n    ret_ti.replace( 0, add_tv.prfx_i, \"/\" );\n  \n    return name_tv.asString() + ret_ti;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "name_tv.absolute",
          "args": [],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "absolute",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "67-67",
          "snippet": "bool absolute() const { return !empty() && name_t[prfx_i] == '/'; }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool absolute() const { return !empty() && name_t[prfx_i] == '/'; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  static Pathname    relativename( const Pathname & name_tv ) { return name_tv.absolute() ? cat( \".\", name_tv ) : name_tv; }\n}"
  },
  {
    "function_name": "absolutename",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "77-77",
    "snippet": "static Pathname    absolutename( const Pathname & name_tv ) { return name_tv.relative() ? cat( \"/\", name_tv ) : name_tv; }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cat",
          "args": [
            "\"/\"",
            "name_tv"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "cat",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
          "lines": "243-254",
          "snippet": "Pathname Pathname::cat( const Pathname & name_tv, const Pathname & add_tv )\n{\n  if ( add_tv.empty() )\n    return name_tv;\n  if ( name_tv.empty() )\n    return add_tv;\n\n  string ret_ti( add_tv.asString() );\n  ret_ti.replace( 0, add_tv.prfx_i, \"/\" );\n\n  return name_tv.asString() + ret_ti;\n}",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nPathname {\n  Pathname Pathname::cat( const Pathname & name_tv, const Pathname & add_tv )\n  {\n    if ( add_tv.empty() )\n      return name_tv;\n    if ( name_tv.empty() )\n      return add_tv;\n  \n    string ret_ti( add_tv.asString() );\n    ret_ti.replace( 0, add_tv.prfx_i, \"/\" );\n  \n    return name_tv.asString() + ret_ti;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "name_tv.relative",
          "args": [],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "relative",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "68-68",
          "snippet": "bool relative() const { return !empty() && name_t[prfx_i] != '/'; }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool relative() const { return !empty() && name_t[prfx_i] != '/'; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  static Pathname    absolutename( const Pathname & name_tv ) { return name_tv.relative() ? cat( \"/\", name_tv ) : name_tv; }\n}"
  },
  {
    "function_name": "relativename",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "73-73",
    "snippet": "Pathname    relativename()  const { return relativename( *this ); }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "relativename",
          "args": [
            "*this"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "relativename",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "78-78",
          "snippet": "static Pathname    relativename( const Pathname & name_tv ) { return name_tv.absolute() ? cat( \".\", name_tv ) : name_tv; }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  Pathname    relativename()  const { return relativename( *this ); }\n}"
  },
  {
    "function_name": "absolutename",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "72-72",
    "snippet": "Pathname    absolutename()  const { return absolutename( *this ); }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "absolutename",
          "args": [
            "*this"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "absolutename",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "77-77",
          "snippet": "static Pathname    absolutename( const Pathname & name_tv ) { return name_tv.relative() ? cat( \"/\", name_tv ) : name_tv; }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  Pathname    absolutename()  const { return absolutename( *this ); }\n}"
  },
  {
    "function_name": "basename",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "71-71",
    "snippet": "std::string basename()      const { return basename( *this ); }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "basename",
          "args": [
            "*this"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "basename",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
          "lines": "220-233",
          "snippet": "string Pathname::basename( const Pathname & name_tv )\n{\n  if ( name_tv.empty() )\n    return \"\";\n\n  string ret_t( name_tv.asString() );\n  ret_t.erase( 0, name_tv.prfx_i );\n  string::size_type idx = ret_t.find_last_of( '/' );\n  if ( idx != string::npos ) {\n    ret_t.erase( 0, idx+1 );\n  }\n\n  return ret_t;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  std::string basename()      const { return basename( *this ); }\n}"
  },
  {
    "function_name": "dirname",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "70-70",
    "snippet": "Pathname    dirname()       const { return dirname( *this ); }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dirname",
          "args": [
            "*this"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "dirname",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
          "lines": "191-210",
          "snippet": "Pathname Pathname::dirname( const Pathname & name_tv )\n{\n  if ( name_tv.empty() )\n    return \"\";\n\n  Pathname ret_t( name_tv );\n  string::size_type idx = ret_t.name_t.find_last_of( '/' );\n\n  if ( idx == string::npos ) {\n    ret_t.name_t.erase( ret_t.prfx_i );\n    ret_t.name_t += \".\";\n  } else if ( idx == ret_t.prfx_i ) {\n    ret_t.name_t.erase( ret_t.prfx_i );\n    ret_t.name_t += \"/\";\n  } else {\n    ret_t.name_t.erase( idx );\n  }\n\n  return ret_t;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  Pathname    dirname()       const { return dirname( *this ); }\n}"
  },
  {
    "function_name": "relative",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "68-68",
    "snippet": "bool relative() const { return !empty() && name_t[prfx_i] != '/'; }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "empty",
          "args": [],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool relative() const { return !empty() && name_t[prfx_i] != '/'; }\n}"
  },
  {
    "function_name": "absolute",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "67-67",
    "snippet": "bool absolute() const { return !empty() && name_t[prfx_i] == '/'; }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "empty",
          "args": [],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool absolute() const { return !empty() && name_t[prfx_i] == '/'; }\n}"
  },
  {
    "function_name": "empty",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "66-66",
    "snippet": "bool empty()    const { return !name_t.size(); }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "name_t.size",
          "args": [],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "178-178",
          "snippet": "off_t         size()    const { return isExist() ? statbuf_C.st_size : 0; }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nPathInfo {\n  off_t         size()    const { return isExist() ? statbuf_C.st_size : 0; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
  },
  {
    "function_name": "Pathname",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "57-59",
    "snippet": "Pathname( const char * name_tv ) {\n      _assign( name_tv ? name_tv : \"\" );\n    }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_assign",
          "args": [
            "name_tv ? name_tv : \"\""
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "_assign",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
          "lines": "128-181",
          "snippet": "void Pathname::_assign( const string & name_tv )\n{\n  prfx_i = 0;\n  name_t = name_tv;\n\n  if ( name_t.empty() )\n    return;\n\n  string   Tprfx;\n  DirStack Stack_Ci;\n\n  char *       Buf_aci    = new char[name_tv.length() + 1];\n  char *       W_pci      = Buf_aci;\n  const char * R_pci      = name_tv.c_str();\n\n  // check for prefix\n  if (    name_t.length() >= 2\n       && name_t[1] == ':'\n       && (    ( 'a' <= name_t[0] && name_t[0] <= 'z' )\n\t    || ( 'A' <= name_t[0] && name_t[0] <= 'Z' ) ) ) {\n    Tprfx  = name_t.substr( 0, 2 );\n    prfx_i = 2;\n    R_pci += 2;\n  }\n\n  // rel or abs path\n  if ( *R_pci == '/' || *R_pci == '\\\\' ) {\n    Stack_Ci.Push( \"\" );\n    ++R_pci;\n  } else {\n    Stack_Ci.Push( \".\" );\n  }\n\n  do {\n    switch ( *R_pci ) {\n    case '/':\n    case '\\\\':\n    case '\\0':\n      if ( W_pci != Buf_aci ) {\n\t*W_pci = '\\0';\n\tW_pci = Buf_aci;\n\tStack_Ci.Push( Buf_aci );\n      }\n      break;\n\n    default:\n      *W_pci++ = *R_pci;\n      break;\n    }\n  } while( *R_pci++ );\n\n  delete[] Buf_aci;\n  name_t = Tprfx + Stack_Ci.str();\n}",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nPathname {\n  void Pathname::_assign( const string & name_tv )\n  {\n    prfx_i = 0;\n    name_t = name_tv;\n  \n    if ( name_t.empty() )\n      return;\n  \n    string   Tprfx;\n    DirStack Stack_Ci;\n  \n    char *       Buf_aci    = new char[name_tv.length() + 1];\n    char *       W_pci      = Buf_aci;\n    const char * R_pci      = name_tv.c_str();\n  \n    // check for prefix\n    if (    name_t.length() >= 2\n         && name_t[1] == ':'\n         && (    ( 'a' <= name_t[0] && name_t[0] <= 'z' )\n  \t    || ( 'A' <= name_t[0] && name_t[0] <= 'Z' ) ) ) {\n      Tprfx  = name_t.substr( 0, 2 );\n      prfx_i = 2;\n      R_pci += 2;\n    }\n  \n    // rel or abs path\n    if ( *R_pci == '/' || *R_pci == '\\\\' ) {\n      Stack_Ci.Push( \"\" );\n      ++R_pci;\n    } else {\n      Stack_Ci.Push( \".\" );\n    }\n  \n    do {\n      switch ( *R_pci ) {\n      case '/':\n      case '\\\\':\n      case '\\0':\n        if ( W_pci != Buf_aci ) {\n  \t*W_pci = '\\0';\n  \tW_pci = Buf_aci;\n  \tStack_Ci.Push( Buf_aci );\n        }\n        break;\n  \n      default:\n        *W_pci++ = *R_pci;\n        break;\n      }\n    } while( *R_pci++ );\n  \n    delete[] Buf_aci;\n    name_t = Tprfx + Stack_Ci.str();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  Pathname( const char * name_tv ) {\n        _assign( name_tv ? name_tv : \"\" );\n      }\n}"
  },
  {
    "function_name": "Pathname",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "54-56",
    "snippet": "Pathname( const std::string & name_tv ) {\n      _assign( name_tv );\n    }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_assign",
          "args": [
            "name_tv"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "_assign",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
          "lines": "128-181",
          "snippet": "void Pathname::_assign( const string & name_tv )\n{\n  prfx_i = 0;\n  name_t = name_tv;\n\n  if ( name_t.empty() )\n    return;\n\n  string   Tprfx;\n  DirStack Stack_Ci;\n\n  char *       Buf_aci    = new char[name_tv.length() + 1];\n  char *       W_pci      = Buf_aci;\n  const char * R_pci      = name_tv.c_str();\n\n  // check for prefix\n  if (    name_t.length() >= 2\n       && name_t[1] == ':'\n       && (    ( 'a' <= name_t[0] && name_t[0] <= 'z' )\n\t    || ( 'A' <= name_t[0] && name_t[0] <= 'Z' ) ) ) {\n    Tprfx  = name_t.substr( 0, 2 );\n    prfx_i = 2;\n    R_pci += 2;\n  }\n\n  // rel or abs path\n  if ( *R_pci == '/' || *R_pci == '\\\\' ) {\n    Stack_Ci.Push( \"\" );\n    ++R_pci;\n  } else {\n    Stack_Ci.Push( \".\" );\n  }\n\n  do {\n    switch ( *R_pci ) {\n    case '/':\n    case '\\\\':\n    case '\\0':\n      if ( W_pci != Buf_aci ) {\n\t*W_pci = '\\0';\n\tW_pci = Buf_aci;\n\tStack_Ci.Push( Buf_aci );\n      }\n      break;\n\n    default:\n      *W_pci++ = *R_pci;\n      break;\n    }\n  } while( *R_pci++ );\n\n  delete[] Buf_aci;\n  name_t = Tprfx + Stack_Ci.str();\n}",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nPathname {\n  void Pathname::_assign( const string & name_tv )\n  {\n    prfx_i = 0;\n    name_t = name_tv;\n  \n    if ( name_t.empty() )\n      return;\n  \n    string   Tprfx;\n    DirStack Stack_Ci;\n  \n    char *       Buf_aci    = new char[name_tv.length() + 1];\n    char *       W_pci      = Buf_aci;\n    const char * R_pci      = name_tv.c_str();\n  \n    // check for prefix\n    if (    name_t.length() >= 2\n         && name_t[1] == ':'\n         && (    ( 'a' <= name_t[0] && name_t[0] <= 'z' )\n  \t    || ( 'A' <= name_t[0] && name_t[0] <= 'Z' ) ) ) {\n      Tprfx  = name_t.substr( 0, 2 );\n      prfx_i = 2;\n      R_pci += 2;\n    }\n  \n    // rel or abs path\n    if ( *R_pci == '/' || *R_pci == '\\\\' ) {\n      Stack_Ci.Push( \"\" );\n      ++R_pci;\n    } else {\n      Stack_Ci.Push( \".\" );\n    }\n  \n    do {\n      switch ( *R_pci ) {\n      case '/':\n      case '\\\\':\n      case '\\0':\n        if ( W_pci != Buf_aci ) {\n  \t*W_pci = '\\0';\n  \tW_pci = Buf_aci;\n  \tStack_Ci.Push( Buf_aci );\n        }\n        break;\n  \n      default:\n        *W_pci++ = *R_pci;\n        break;\n      }\n    } while( *R_pci++ );\n  \n    delete[] Buf_aci;\n    name_t = Tprfx + Stack_Ci.str();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  Pathname( const std::string & name_tv ) {\n        _assign( name_tv );\n      }\n}"
  },
  {
    "function_name": "Pathname",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "50-53",
    "snippet": "Pathname( const Pathname & path_tv ) {\n      prfx_i = path_tv.prfx_i;\n      name_t = path_tv.name_t;\n    }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  Pathname( const Pathname & path_tv ) {\n        prfx_i = path_tv.prfx_i;\n        name_t = path_tv.name_t;\n      }\n}"
  },
  {
    "function_name": "Pathname",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
    "lines": "46-49",
    "snippet": "Pathname() {\n      prfx_i = 0;\n      name_t = \"\";\n    }",
    "includes": [
      "#include <string>",
      "#include <iosfwd>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  Pathname() {\n        prfx_i = 0;\n        name_t = \"\";\n      }\n}"
  }
]