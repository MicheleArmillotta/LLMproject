[
  {
    "function_name": "equal",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
    "lines": "277-280",
    "snippet": "bool Pathname::equal( const Pathname & l, const Pathname & r )\n{\n  return l.asString() == r.asString();\n}",
    "includes": [
      "#include <y2util/Pathname.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "r.asString",
          "args": [],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nPathname {\n  bool Pathname::equal( const Pathname & l, const Pathname & r )\n  {\n    return l.asString() == r.asString();\n  }\n}"
  },
  {
    "function_name": "extend",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
    "lines": "264-267",
    "snippet": "Pathname Pathname::extend( const Pathname & l, const string & r )\n{\n  return l.asString() + r;\n}",
    "includes": [
      "#include <y2util/Pathname.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "l.asString",
          "args": [],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nPathname {\n  Pathname Pathname::extend( const Pathname & l, const string & r )\n  {\n    return l.asString() + r;\n  }\n}"
  },
  {
    "function_name": "cat",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
    "lines": "243-254",
    "snippet": "Pathname Pathname::cat( const Pathname & name_tv, const Pathname & add_tv )\n{\n  if ( add_tv.empty() )\n    return name_tv;\n  if ( name_tv.empty() )\n    return add_tv;\n\n  string ret_ti( add_tv.asString() );\n  ret_ti.replace( 0, add_tv.prfx_i, \"/\" );\n\n  return name_tv.asString() + ret_ti;\n}",
    "includes": [
      "#include <y2util/Pathname.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "name_tv.asString",
          "args": [],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ret_ti.replace",
          "args": [
            "0",
            "add_tv.prfx_i",
            "\"/\""
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name_tv.empty",
          "args": [],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nPathname {\n  Pathname Pathname::cat( const Pathname & name_tv, const Pathname & add_tv )\n  {\n    if ( add_tv.empty() )\n      return name_tv;\n    if ( name_tv.empty() )\n      return add_tv;\n  \n    string ret_ti( add_tv.asString() );\n    ret_ti.replace( 0, add_tv.prfx_i, \"/\" );\n  \n    return name_tv.asString() + ret_ti;\n  }\n}"
  },
  {
    "function_name": "basename",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
    "lines": "220-233",
    "snippet": "string Pathname::basename( const Pathname & name_tv )\n{\n  if ( name_tv.empty() )\n    return \"\";\n\n  string ret_t( name_tv.asString() );\n  ret_t.erase( 0, name_tv.prfx_i );\n  string::size_type idx = ret_t.find_last_of( '/' );\n  if ( idx != string::npos ) {\n    ret_t.erase( 0, idx+1 );\n  }\n\n  return ret_t;\n}",
    "includes": [
      "#include <y2util/Pathname.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ret_t.erase",
          "args": [
            "0",
            "idx+1"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ret_t.find_last_of",
          "args": [
            "'/'"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ret_t.erase",
          "args": [
            "0",
            "name_tv.prfx_i"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name_tv.asString",
          "args": [],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "name_tv.empty",
          "args": [],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nPathname {\n  string Pathname::basename( const Pathname & name_tv )\n  {\n    if ( name_tv.empty() )\n      return \"\";\n  \n    string ret_t( name_tv.asString() );\n    ret_t.erase( 0, name_tv.prfx_i );\n    string::size_type idx = ret_t.find_last_of( '/' );\n    if ( idx != string::npos ) {\n      ret_t.erase( 0, idx+1 );\n    }\n  \n    return ret_t;\n  }\n}"
  },
  {
    "function_name": "dirname",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
    "lines": "191-210",
    "snippet": "Pathname Pathname::dirname( const Pathname & name_tv )\n{\n  if ( name_tv.empty() )\n    return \"\";\n\n  Pathname ret_t( name_tv );\n  string::size_type idx = ret_t.name_t.find_last_of( '/' );\n\n  if ( idx == string::npos ) {\n    ret_t.name_t.erase( ret_t.prfx_i );\n    ret_t.name_t += \".\";\n  } else if ( idx == ret_t.prfx_i ) {\n    ret_t.name_t.erase( ret_t.prfx_i );\n    ret_t.name_t += \"/\";\n  } else {\n    ret_t.name_t.erase( idx );\n  }\n\n  return ret_t;\n}",
    "includes": [
      "#include <y2util/Pathname.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ret_t.name_t.erase",
          "args": [
            "idx"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "683-695",
          "snippet": "int PathInfo::erase( const Pathname & path )\n{\n  int res = 0;\n  PathInfo p( path, LSTAT );\n  if ( p.isExist() )\n    {\n      if ( p.isDir() )\n        res = PathInfo::recursive_rmdir( path );\n      else\n        res = PathInfo::unlink( path );\n    }\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::erase( const Pathname & path )\n  {\n    int res = 0;\n    PathInfo p( path, LSTAT );\n    if ( p.isExist() )\n      {\n        if ( p.isDir() )\n          res = PathInfo::recursive_rmdir( path );\n        else\n          res = PathInfo::unlink( path );\n      }\n    return res;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ret_t.name_t.find_last_of",
          "args": [
            "'/'"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name_tv.empty",
          "args": [],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nPathname {\n  Pathname Pathname::dirname( const Pathname & name_tv )\n  {\n    if ( name_tv.empty() )\n      return \"\";\n  \n    Pathname ret_t( name_tv );\n    string::size_type idx = ret_t.name_t.find_last_of( '/' );\n  \n    if ( idx == string::npos ) {\n      ret_t.name_t.erase( ret_t.prfx_i );\n      ret_t.name_t += \".\";\n    } else if ( idx == ret_t.prfx_i ) {\n      ret_t.name_t.erase( ret_t.prfx_i );\n      ret_t.name_t += \"/\";\n    } else {\n      ret_t.name_t.erase( idx );\n    }\n  \n    return ret_t;\n  }\n}"
  },
  {
    "function_name": "_assign",
    "container": "Pathname",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
    "lines": "128-181",
    "snippet": "void Pathname::_assign( const string & name_tv )\n{\n  prfx_i = 0;\n  name_t = name_tv;\n\n  if ( name_t.empty() )\n    return;\n\n  string   Tprfx;\n  DirStack Stack_Ci;\n\n  char *       Buf_aci    = new char[name_tv.length() + 1];\n  char *       W_pci      = Buf_aci;\n  const char * R_pci      = name_tv.c_str();\n\n  // check for prefix\n  if (    name_t.length() >= 2\n       && name_t[1] == ':'\n       && (    ( 'a' <= name_t[0] && name_t[0] <= 'z' )\n\t    || ( 'A' <= name_t[0] && name_t[0] <= 'Z' ) ) ) {\n    Tprfx  = name_t.substr( 0, 2 );\n    prfx_i = 2;\n    R_pci += 2;\n  }\n\n  // rel or abs path\n  if ( *R_pci == '/' || *R_pci == '\\\\' ) {\n    Stack_Ci.Push( \"\" );\n    ++R_pci;\n  } else {\n    Stack_Ci.Push( \".\" );\n  }\n\n  do {\n    switch ( *R_pci ) {\n    case '/':\n    case '\\\\':\n    case '\\0':\n      if ( W_pci != Buf_aci ) {\n\t*W_pci = '\\0';\n\tW_pci = Buf_aci;\n\tStack_Ci.Push( Buf_aci );\n      }\n      break;\n\n    default:\n      *W_pci++ = *R_pci;\n      break;\n    }\n  } while( *R_pci++ );\n\n  delete[] Buf_aci;\n  name_t = Tprfx + Stack_Ci.str();\n}",
    "includes": [
      "#include <y2util/Pathname.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Stack_Ci.str",
          "args": [],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": "DirStack",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
          "lines": "102-114",
          "snippet": "string str() {\n      if ( !bot )\n\treturn \"\";\n      string ret;\n      for ( Dir * d = bot; d; d = d->up ) {\n\tif ( d != bot )\n\t  ret += \"/\";\n\tret += d->name;\n      }\n      if ( ret.empty() )\n\treturn \"/\";\n      return ret;\n    }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nDirStack {\n  string str() {\n        if ( !bot )\n  \treturn \"\";\n        string ret;\n        for ( Dir * d = bot; d; d = d->up ) {\n  \tif ( d != bot )\n  \t  ret += \"/\";\n  \tret += d->name;\n        }\n        if ( ret.empty() )\n  \treturn \"/\";\n        return ret;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Stack_Ci.Push",
          "args": [
            "Buf_aci"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "Push",
          "container": "DirStack",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
          "lines": "76-100",
          "snippet": "void Push( const string & n ) {\n      if ( n.empty() || n == \".\" ) { // '.' or '/' only for bot\n\tif ( bot )\n\t  return;\n      } else if ( n == \"..\" && top ) {\n\tif ( top->name == \"\" )          // \"/..\"        ==> \"/\"\n\t  return;\n\n\tif ( top->name != \".\" && top->name != \"..\" ) {      // \"somedir/..\" ==> \"\"\n\t  Pop();\n\t  return;\n\t}\n\t// \"../..\" \"./..\" stays\n      }\n\n      Dir * d = new Dir( n );\n      if ( !top )\n\ttop = bot = d;\n      else {\n\ttop->up = d;\n\td->dn = top;\n\td->up = 0;\n\ttop = d;\n      }\n    }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nDirStack {\n  void Push( const string & n ) {\n        if ( n.empty() || n == \".\" ) { // '.' or '/' only for bot\n  \tif ( bot )\n  \t  return;\n        } else if ( n == \"..\" && top ) {\n  \tif ( top->name == \"\" )          // \"/..\"        ==> \"/\"\n  \t  return;\n  \n  \tif ( top->name != \".\" && top->name != \"..\" ) {      // \"somedir/..\" ==> \"\"\n  \t  Pop();\n  \t  return;\n  \t}\n  \t// \"../..\" \"./..\" stays\n        }\n  \n        Dir * d = new Dir( n );\n        if ( !top )\n  \ttop = bot = d;\n        else {\n  \ttop->up = d;\n  \td->dn = top;\n  \td->up = 0;\n  \ttop = d;\n        }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "name_t.substr",
          "args": [
            "0",
            "2"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name_t.length",
          "args": [],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "name_tv.c_str",
          "args": [],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name_t.empty",
          "args": [],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nPathname {\n  void Pathname::_assign( const string & name_tv )\n  {\n    prfx_i = 0;\n    name_t = name_tv;\n  \n    if ( name_t.empty() )\n      return;\n  \n    string   Tprfx;\n    DirStack Stack_Ci;\n  \n    char *       Buf_aci    = new char[name_tv.length() + 1];\n    char *       W_pci      = Buf_aci;\n    const char * R_pci      = name_tv.c_str();\n  \n    // check for prefix\n    if (    name_t.length() >= 2\n         && name_t[1] == ':'\n         && (    ( 'a' <= name_t[0] && name_t[0] <= 'z' )\n  \t    || ( 'A' <= name_t[0] && name_t[0] <= 'Z' ) ) ) {\n      Tprfx  = name_t.substr( 0, 2 );\n      prfx_i = 2;\n      R_pci += 2;\n    }\n  \n    // rel or abs path\n    if ( *R_pci == '/' || *R_pci == '\\\\' ) {\n      Stack_Ci.Push( \"\" );\n      ++R_pci;\n    } else {\n      Stack_Ci.Push( \".\" );\n    }\n  \n    do {\n      switch ( *R_pci ) {\n      case '/':\n      case '\\\\':\n      case '\\0':\n        if ( W_pci != Buf_aci ) {\n  \t*W_pci = '\\0';\n  \tW_pci = Buf_aci;\n  \tStack_Ci.Push( Buf_aci );\n        }\n        break;\n  \n      default:\n        *W_pci++ = *R_pci;\n        break;\n      }\n    } while( *R_pci++ );\n  \n    delete[] Buf_aci;\n    name_t = Tprfx + Stack_Ci.str();\n  }\n}"
  },
  {
    "function_name": "str",
    "container": "DirStack",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
    "lines": "102-114",
    "snippet": "string str() {\n      if ( !bot )\n\treturn \"\";\n      string ret;\n      for ( Dir * d = bot; d; d = d->up ) {\n\tif ( d != bot )\n\t  ret += \"/\";\n\tret += d->name;\n      }\n      if ( ret.empty() )\n\treturn \"/\";\n      return ret;\n    }",
    "includes": [
      "#include <y2util/Pathname.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ret.empty",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nDirStack {\n  string str() {\n        if ( !bot )\n  \treturn \"\";\n        string ret;\n        for ( Dir * d = bot; d; d = d->up ) {\n  \tif ( d != bot )\n  \t  ret += \"/\";\n  \tret += d->name;\n        }\n        if ( ret.empty() )\n  \treturn \"/\";\n        return ret;\n      }\n}"
  },
  {
    "function_name": "Push",
    "container": "DirStack",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
    "lines": "76-100",
    "snippet": "void Push( const string & n ) {\n      if ( n.empty() || n == \".\" ) { // '.' or '/' only for bot\n\tif ( bot )\n\t  return;\n      } else if ( n == \"..\" && top ) {\n\tif ( top->name == \"\" )          // \"/..\"        ==> \"/\"\n\t  return;\n\n\tif ( top->name != \".\" && top->name != \"..\" ) {      // \"somedir/..\" ==> \"\"\n\t  Pop();\n\t  return;\n\t}\n\t// \"../..\" \"./..\" stays\n      }\n\n      Dir * d = new Dir( n );\n      if ( !top )\n\ttop = bot = d;\n      else {\n\ttop->up = d;\n\td->dn = top;\n\td->up = 0;\n\ttop = d;\n      }\n    }",
    "includes": [
      "#include <y2util/Pathname.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Pop",
          "args": [],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "Pop",
          "container": "DirStack",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
          "lines": "56-66",
          "snippet": "void Pop() {\n    if ( !top )\n      return;\n    top = top->dn;\n    if ( top )\n      delete top->up;\n    else {\n      delete bot;\n      bot = 0;\n    }\n  }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nDirStack {\n  void Pop() {\n      if ( !top )\n        return;\n      top = top->dn;\n      if ( top )\n        delete top->up;\n      else {\n        delete bot;\n        bot = 0;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "n.empty",
          "args": [],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nDirStack {\n  void Push( const string & n ) {\n        if ( n.empty() || n == \".\" ) { // '.' or '/' only for bot\n  \tif ( bot )\n  \t  return;\n        } else if ( n == \"..\" && top ) {\n  \tif ( top->name == \"\" )          // \"/..\"        ==> \"/\"\n  \t  return;\n  \n  \tif ( top->name != \".\" && top->name != \"..\" ) {      // \"somedir/..\" ==> \"\"\n  \t  Pop();\n  \t  return;\n  \t}\n  \t// \"../..\" \"./..\" stays\n        }\n  \n        Dir * d = new Dir( n );\n        if ( !top )\n  \ttop = bot = d;\n        else {\n  \ttop->up = d;\n  \td->dn = top;\n  \td->up = 0;\n  \ttop = d;\n        }\n      }\n}"
  },
  {
    "function_name": "DirStack",
    "container": "DirStack",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
    "lines": "70-70",
    "snippet": "DirStack() { top = bot = 0; }",
    "includes": [
      "#include <y2util/Pathname.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nDirStack {\n  DirStack() { top = bot = 0; }\n}"
  },
  {
    "function_name": "Pop",
    "container": "DirStack",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
    "lines": "56-66",
    "snippet": "void Pop() {\n    if ( !top )\n      return;\n    top = top->dn;\n    if ( top )\n      delete top->up;\n    else {\n      delete bot;\n      bot = 0;\n    }\n  }",
    "includes": [
      "#include <y2util/Pathname.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nDirStack {\n  void Pop() {\n      if ( !top )\n        return;\n      top = top->dn;\n      if ( top )\n        delete top->up;\n      else {\n        delete bot;\n        bot = 0;\n      }\n    }\n}"
  },
  {
    "function_name": "Dir",
    "container": "DirStack::Dir",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/Pathname.cc",
    "lines": "40-43",
    "snippet": "Dir( const string & n = \"\" ) {\n      name = n;\n      up = dn = 0;\n    }",
    "includes": [
      "#include <y2util/Pathname.h>",
      "#include <iostream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <y2util/Pathname.h>\n#include <iostream>\n\nDirStack {\n  Dir {\n    Dir( const string & n = \"\" ) {\n          name = n;\n          up = dn = 0;\n        }\n  }\n}"
  }
]