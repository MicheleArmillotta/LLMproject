[
  {
    "function_name": "Read",
    "container": "Y2AgentComp<Agent>",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libscr/src/include/scr/Y2AgentComponent.h",
    "lines": "180-184",
    "snippet": "YCPValue Y2AgentComp<Agent>::Read (const YCPPath &path)\n{\n    y2error( \"Y2AgentComp::Read\" );\n    return getSCRAgent()->Read (path);\n}",
    "includes": [
      "#include <ycp/YCPTerm.h>",
      "#include <ycp/YCPVoid.h>",
      "#include <ycp/YCPCode.h>",
      "#include <y2/Y2Component.h>",
      "#include <ycp/YCPTerm.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [
            "path"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Y2AgentComp::Read\""
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ycp/YCPTerm.h>\n#include <ycp/YCPVoid.h>\n#include <ycp/YCPCode.h>\n#include <y2/Y2Component.h>\n#include <ycp/YCPTerm.h>\n#include <ycp/y2log.h>\n\nY2AgentComp<Agent> {\n  YCPValue Y2AgentComp<Agent>::Read (const YCPPath &path)\n  {\n      y2error( \"Y2AgentComp::Read\" );\n      return getSCRAgent()->Read (path);\n  }\n}"
  },
  {
    "function_name": "evaluate",
    "container": "Y2AgentComp<Agent>",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libscr/src/include/scr/Y2AgentComponent.h",
    "lines": "91-166",
    "snippet": "YCPValue\nY2AgentComp<Agent>::evaluate (const YCPValue& v)\n{\n    y2debug (\"evaluate (%s)\", v->toString ().c_str ());\n\n    if (!agent)\n\tgetSCRAgent ();\n\n    y2debug (\"Going to evaluate %s\", v->toString ().c_str ());\n\t\n    YCPValue value = v;\n    if (value->isCode ())\n    {\n\tYCodePtr c = v->asCode ()->code ();\n\n\t\n\tif ( c->kind () != YCode::yeTerm)\n\t{\n\t    y2milestone (\"Evaluating an expression, not SCR builtin\");\n\t    value = value->asCode ()->evaluate ();\n\t    return value;\n\t}\n\n\tvalue = value->asCode ()->evaluate ();\n    }\n\t\n    if (value.isNull () || value->isVoid ())\n\treturn value;\n\n    y2debug (\"After code evaluation: %s\", value->toString ().c_str ());\n\n    if( value->isTerm () ) {\n\tYCPTerm term = value ->asTerm ();\n\tstring command = term->name ();\n\tYCPList args = term->args ();\n\n\t// evaluate the term in native functions\n\tif( command == \"Read\" ) {\n\t    return getSCRAgent ()-> Read (args->value (0)->asPath (), args->size() > 1 ? args->value (1) : YCPNull ()) ;\n\t}\n\telse if( command == \"Write\" ) {\n\t    return getSCRAgent ()-> Write (args->value (0)->asPath (), args->value (1), args->size () > 2 ? args->value (2) : YCPNull ()) ;\n\t}\n\telse if( command == \"Dir\" ) {\n\t    return getSCRAgent ()-> Dir (args->value (0)->asPath ()) ;\n\t}\n\telse if( command == \"Error\" ) {\n\t    return getSCRAgent ()-> Error (args->value (0)->asPath ()) ;\n\t}\n\telse if( command == \"Execute\" ) {\n\t    y2debug( \"Execute, arg size is %d\", args->size() );\n\t    switch( args->size() ) {\n\t\tcase 1:\n\t\t    return getSCRAgent ()-> Execute (args->value (0)->asPath ()) ;\n\t\tcase 2:\n\t\t    return getSCRAgent ()-> Execute (args->value (0)->asPath (), args->value (1)) ;\n\t\tdefault:\n\t\t    return getSCRAgent ()-> Execute (args->value (0)->asPath (), args->value (1), args->value (2)) ;\n\t    }\n\t}\n\telse {\n\t    y2debug( \"Passing term to otherCommand\" );\n\t    return getSCRAgent ()-> otherCommand (term);\n\t}\n    }\n#if 0\n    if( value->isCode () ) {\n\ty2debug( \"Passing (evaluated) code to otherCommand\" );\n\treturn getSCRAgent ()-> otherCommand (value->asCode ()->evaluate ()->asTerm ());\n    }\n#endif\n\n    y2error( \"Unhandled value (%s): %s\", value->valuetype_str (), value->toString ().c_str () );\n\n    return YCPVoid();\n}",
    "includes": [
      "#include <ycp/YCPTerm.h>",
      "#include <ycp/YCPVoid.h>",
      "#include <ycp/YCPCode.h>",
      "#include <y2/Y2Component.h>",
      "#include <ycp/YCPTerm.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPVoid",
          "args": [],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "YCPVoid",
          "container": "YCPVoid",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPVoid.cc",
          "lines": "72-75",
          "snippet": "YCPVoid::YCPVoid ()\n    : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n{\n}",
          "includes": [
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "YCPVoid* YCPVoid::nil = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/y2log.h\"\n\nYCPVoid* YCPVoid::nil = NULL;\n\nYCPVoid {\n  YCPVoid::YCPVoid ()\n      : YCPValue( *(nil ? nil : (nil = new YCPVoid (new YCPVoidRep()) )))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Unhandled value (%s): %s\"",
            "value->valuetype_str ()",
            "value->toString ().c_str ()"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value->toString",
          "args": [],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value->valuetype_str",
          "args": [],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [
            "value->asCode ()->evaluate ()->asTerm ()"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value->asCode",
          "args": [],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "asCode",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "215-225",
          "snippet": "YCPCode\nYCPValueRep::asCode() const\n{\n    if (!isCode())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Code !\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPCode (static_cast<const YCPCodeRep*>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPCode\n  YCPValueRep::asCode() const\n  {\n      if (!isCode())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Code !\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPCode (static_cast<const YCPCodeRep*>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Passing (evaluated) code to otherCommand\""
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value->isCode",
          "args": [],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "isCode",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "72-72",
          "snippet": "bool YCPValueRep::isCode()\t  const { return valuetype() == YT_CODE; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isCode()\t  const { return valuetype() == YT_CODE; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [
            "term"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Passing term to otherCommand\""
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [
            "args->value (0)->asPath ()",
            "args->value (1)",
            "args->value (2)"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args->value",
          "args": [
            "2"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "args->value",
          "args": [],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [
            "args->value (0)->asPath ()",
            "args->value (1)"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [
            "args->value (0)->asPath ()"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args->size",
          "args": [],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Execute, arg size is %d\"",
            "args->size()"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [
            "args->value (0)->asPath ()"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [
            "args->value (0)->asPath ()"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [
            "args->value (0)->asPath ()",
            "args->value (1)",
            "args->size () > 2 ? args->value (2) : YCPNull ()"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [
            "args->value (0)->asPath ()",
            "args->size() > 1 ? args->value (1) : YCPNull ()"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "term->args",
          "args": [],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "args",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "58-62",
          "snippet": "YCPList\nYCPTermRep::args() const\n{\n    return l;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPList\n  YCPTermRep::args() const\n  {\n      return l;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "term->name",
          "args": [],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "name",
          "container": "Y2AgentComp",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libscr/src/include/scr/Y2AgentComponent.h",
          "lines": "44-44",
          "snippet": "string name () const { return my_name; }",
          "includes": [
            "#include <ycp/YCPTerm.h>",
            "#include <ycp/YCPVoid.h>",
            "#include <ycp/YCPCode.h>",
            "#include <y2/Y2Component.h>",
            "#include <ycp/YCPTerm.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ycp/YCPTerm.h>\n#include <ycp/YCPVoid.h>\n#include <ycp/YCPCode.h>\n#include <y2/Y2Component.h>\n#include <ycp/YCPTerm.h>\n#include <ycp/y2log.h>\n\nY2AgentComp {\n  string name () const { return my_name; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value ->asTerm",
          "args": [],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "asTerm",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "191-201",
          "snippet": "YCPTerm\nYCPValueRep::asTerm() const\n{\n    if (!isTerm())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Term!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPTerm (static_cast<const YCPTermRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPTerm\n  YCPValueRep::asTerm() const\n  {\n      if (!isTerm())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Term!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPTerm (static_cast<const YCPTermRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value->isTerm",
          "args": [],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "isTerm",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "70-70",
          "snippet": "bool YCPValueRep::isTerm()        const { return valuetype() == YT_TERM; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isTerm()        const { return valuetype() == YT_TERM; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"After code evaluation: %s\"",
            "value->toString ().c_str ()"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value->isVoid",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "isVoid",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "60-61",
          "snippet": "bool YCPValueRep::isVoid()        const { return valuetype() == YT_VOID \n\t\t\t\t\t\t|| valuetype() == YT_RETURN; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isVoid()        const { return valuetype() == YT_VOID \n  \t\t\t\t\t\t|| valuetype() == YT_RETURN; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.isNull",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2milestone",
          "args": [
            "\"Evaluating an expression, not SCR builtin\""
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->kind",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "kind",
          "container": "YEFunctionPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/include/ycp/YExpression.h",
          "lines": "499-499",
          "snippet": "virtual ykind kind () const { return yeFunctionPointer; }",
          "includes": [
            "#include \"y2/Y2Function.h\"",
            "#include \"ycp/YCode.h\"",
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"y2/Y2Function.h\"\n#include \"ycp/YCode.h\"\n#include <string>\n#include <iosfwd>\n\nYEFunctionPointer {\n  virtual ykind kind () const { return yeFunctionPointer; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Going to evaluate %s\"",
            "v->toString ().c_str ()"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSCRAgent",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"evaluate (%s)\"",
            "v->toString ().c_str ()"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ycp/YCPTerm.h>\n#include <ycp/YCPVoid.h>\n#include <ycp/YCPCode.h>\n#include <y2/Y2Component.h>\n#include <ycp/YCPTerm.h>\n#include <ycp/y2log.h>\n\nY2AgentComp<Agent> {\n  YCPValue\n  Y2AgentComp<Agent>::evaluate (const YCPValue& v)\n  {\n      y2debug (\"evaluate (%s)\", v->toString ().c_str ());\n  \n      if (!agent)\n  \tgetSCRAgent ();\n  \n      y2debug (\"Going to evaluate %s\", v->toString ().c_str ());\n  \t\n      YCPValue value = v;\n      if (value->isCode ())\n      {\n  \tYCodePtr c = v->asCode ()->code ();\n  \n  \t\n  \tif ( c->kind () != YCode::yeTerm)\n  \t{\n  \t    y2milestone (\"Evaluating an expression, not SCR builtin\");\n  \t    value = value->asCode ()->evaluate ();\n  \t    return value;\n  \t}\n  \n  \tvalue = value->asCode ()->evaluate ();\n      }\n  \t\n      if (value.isNull () || value->isVoid ())\n  \treturn value;\n  \n      y2debug (\"After code evaluation: %s\", value->toString ().c_str ());\n  \n      if( value->isTerm () ) {\n  \tYCPTerm term = value ->asTerm ();\n  \tstring command = term->name ();\n  \tYCPList args = term->args ();\n  \n  \t// evaluate the term in native functions\n  \tif( command == \"Read\" ) {\n  \t    return getSCRAgent ()-> Read (args->value (0)->asPath (), args->size() > 1 ? args->value (1) : YCPNull ()) ;\n  \t}\n  \telse if( command == \"Write\" ) {\n  \t    return getSCRAgent ()-> Write (args->value (0)->asPath (), args->value (1), args->size () > 2 ? args->value (2) : YCPNull ()) ;\n  \t}\n  \telse if( command == \"Dir\" ) {\n  \t    return getSCRAgent ()-> Dir (args->value (0)->asPath ()) ;\n  \t}\n  \telse if( command == \"Error\" ) {\n  \t    return getSCRAgent ()-> Error (args->value (0)->asPath ()) ;\n  \t}\n  \telse if( command == \"Execute\" ) {\n  \t    y2debug( \"Execute, arg size is %d\", args->size() );\n  \t    switch( args->size() ) {\n  \t\tcase 1:\n  \t\t    return getSCRAgent ()-> Execute (args->value (0)->asPath ()) ;\n  \t\tcase 2:\n  \t\t    return getSCRAgent ()-> Execute (args->value (0)->asPath (), args->value (1)) ;\n  \t\tdefault:\n  \t\t    return getSCRAgent ()-> Execute (args->value (0)->asPath (), args->value (1), args->value (2)) ;\n  \t    }\n  \t}\n  \telse {\n  \t    y2debug( \"Passing term to otherCommand\" );\n  \t    return getSCRAgent ()-> otherCommand (term);\n  \t}\n      }\n  #if 0\n      if( value->isCode () ) {\n  \ty2debug( \"Passing (evaluated) code to otherCommand\" );\n  \treturn getSCRAgent ()-> otherCommand (value->asCode ()->evaluate ()->asTerm ());\n      }\n  #endif\n  \n      y2error( \"Unhandled value (%s): %s\", value->valuetype_str (), value->toString ().c_str () );\n  \n      return YCPVoid();\n  }\n}"
  },
  {
    "function_name": "~Y2AgentComp",
    "container": "Y2AgentComp<Agent>",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libscr/src/include/scr/Y2AgentComponent.h",
    "lines": "82-88",
    "snippet": "Y2AgentComp<Agent>::~Y2AgentComp ()\n{\n    if (agent)\n    {\n        delete agent;\n    }\n}",
    "includes": [
      "#include <ycp/YCPTerm.h>",
      "#include <ycp/YCPVoid.h>",
      "#include <ycp/YCPCode.h>",
      "#include <y2/Y2Component.h>",
      "#include <ycp/YCPTerm.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <ycp/YCPTerm.h>\n#include <ycp/YCPVoid.h>\n#include <ycp/YCPCode.h>\n#include <y2/Y2Component.h>\n#include <ycp/YCPTerm.h>\n#include <ycp/y2log.h>\n\nY2AgentComp<Agent> {\n  Y2AgentComp<Agent>::~Y2AgentComp ()\n  {\n      if (agent)\n      {\n          delete agent;\n      }\n  }\n}"
  },
  {
    "function_name": "Y2AgentComp",
    "container": "Y2AgentComp<Agent>",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libscr/src/include/scr/Y2AgentComponent.h",
    "lines": "74-78",
    "snippet": "Y2AgentComp<Agent>::Y2AgentComp (const char* my_name)\n    : my_name (my_name),\n      agent (0)\n{\n}",
    "includes": [
      "#include <ycp/YCPTerm.h>",
      "#include <ycp/YCPVoid.h>",
      "#include <ycp/YCPCode.h>",
      "#include <y2/Y2Component.h>",
      "#include <ycp/YCPTerm.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <ycp/YCPTerm.h>\n#include <ycp/YCPVoid.h>\n#include <ycp/YCPCode.h>\n#include <y2/Y2Component.h>\n#include <ycp/YCPTerm.h>\n#include <ycp/y2log.h>\n\nY2AgentComp<Agent> {\n  Y2AgentComp<Agent>::Y2AgentComp (const char* my_name)\n      : my_name (my_name),\n        agent (0)\n  {\n  }\n}"
  },
  {
    "function_name": "name",
    "container": "Y2AgentComp",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libscr/src/include/scr/Y2AgentComponent.h",
    "lines": "44-44",
    "snippet": "string name () const { return my_name; }",
    "includes": [
      "#include <ycp/YCPTerm.h>",
      "#include <ycp/YCPVoid.h>",
      "#include <ycp/YCPCode.h>",
      "#include <y2/Y2Component.h>",
      "#include <ycp/YCPTerm.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <ycp/YCPTerm.h>\n#include <ycp/YCPVoid.h>\n#include <ycp/YCPCode.h>\n#include <y2/Y2Component.h>\n#include <ycp/YCPTerm.h>\n#include <ycp/y2log.h>\n\nY2AgentComp {\n  string name () const { return my_name; }\n}"
  }
]