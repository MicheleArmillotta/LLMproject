[
  {
    "function_name": "findByPath",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "623-634",
    "snippet": "ScriptingAgent::SubAgents::iterator\nScriptingAgent::findByPath (const YCPPath &path)\n{\n    SubAgents::iterator agent = std::lower_bound (agents.begin (),\n\t\t\t\t\t\t  agents.end (),\n\t\t\t\t\t\t  path);\n\n    if (agent != agents.end () && (*agent)->get_path ()->equal (path))\n\treturn agent;\n\n    return agents.end ();\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "agents.end",
          "args": [],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "path"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::lower_bound",
          "args": [
            "agents.begin ()",
            "agents.end ()",
            "path"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agents.begin",
          "args": [],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  ScriptingAgent::SubAgents::iterator\n  ScriptingAgent::findByPath (const YCPPath &path)\n  {\n      SubAgents::iterator agent = std::lower_bound (agents.begin (),\n  \t\t\t\t\t\t  agents.end (),\n  \t\t\t\t\t\t  path);\n  \n      if (agent != agents.end () && (*agent)->get_path ()->equal (path))\n  \treturn agent;\n  \n      return agents.end ();\n  }\n}"
  },
  {
    "function_name": "executeSubagentCommand",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "579-620",
    "snippet": "YCPValue\nScriptingAgent::executeSubagentCommand (const char *command,\n\t\t\t\t\tconst YCPPath &path,\n\t\t\t\t\tconst YCPValue &arg,\n\t\t\t\t\tconst YCPValue &optpar)\n{\n    y2debug( \"ScriptingAgent::executeSubagentCommand: %s\", command );\n    y2debug( \"path: %s\", path->toString ().c_str ());\n    y2debug( \"arg: %s\", arg.isNull() ? \"null\" : arg->toString().c_str ());\n    y2debug( \"opt: %s\", optpar.isNull() ? \"null\" : optpar->toString().c_str ());\n\n    SubAgents::const_iterator agent = findAndRegisterSubagent (path);\n    if (agent == agents.end ()) {\n\tbool cmd_is_dir = strcmp (command, \"Dir\") == 0;\n\t// Special case to have the possibility of Dir (.sysconfig) or similar...\n\tif (cmd_is_dir)\n\t{\n\t    return dirSubagents (path);\n\t}\n\t// if all fails:\n\treturn YCPError (\"Couldn't find an agent to handle '\" +\n\t\t\t path->toString () + \"'\");\n    }\n\n    (*agent)->mount (this);\n\n    if (!(*agent)->get_comp ())\n    {\n\tycp2error (\"Couldn't mount agent to handle '%s'\", path->toString().c_str ());\n\treturn YCPNull ();\n    }\n    \n    YCPTerm commandterm (command);\n    commandterm->add (path->at ((*agent)->get_path ()->length ())); // relative path\n\n    if (!arg.isNull ())\n\tcommandterm->add (arg);\n    if (!optpar.isNull ())\n\tcommandterm->add (optpar);\n\n    return (*agent)->get_comp ()->evaluate (commandterm);\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "commandterm"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "commandterm->add",
          "args": [
            "optpar"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "optpar.isNull",
          "args": [],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arg.isNull",
          "args": [],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->at",
          "args": [
            "(*agent)->get_path ()->length ()"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "at",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "142-149",
          "snippet": "YCPPath\nYCPPathRep::at(long index) const\n{\n    YCPPath postfix;\n    for (int i=index; i<length(); i++)\n\tpostfix->append(components[i]);\n    return postfix;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  YCPPath\n  YCPPathRep::at(long index) const\n  {\n      YCPPath postfix;\n      for (int i=index; i<length(); i++)\n  \tpostfix->append(components[i]);\n      return postfix;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"Couldn't mount agent to handle '%s'\"",
            "path->toString().c_str ()"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->toString",
          "args": [],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "this"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPError",
          "args": [
            "\"Couldn't find an agent to handle '\" +\n\t\t\t path->toString () + \"'\""
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirSubagents",
          "args": [
            "path"
          ],
          "line": 596
        },
        "resolved": true,
        "details": {
          "function_name": "dirSubagents",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "499-518",
          "snippet": "YCPList\nScriptingAgent::dirSubagents (const YCPPath &path)\n{\n    const long path_length = path->length ();\n    YCPList dir_list = YCPList ();\n\n    for (SubAgents::const_iterator it = agents.begin ();\n\t it != agents.end (); ++it)\n    {\n\tYCPPath it_path = (*it)->get_path ();\n\tif (path->isPrefixOf (it_path))\n\t{\n\t    YCPString str = YCPString (it_path->component_str (path_length));\n\t    const int size = dir_list->size ();\n\t    if (size == 0 || !dir_list->value (size - 1)->equal (str))\n\t\tdir_list->add (str);\n\t}\n    }\n    return dir_list;\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPList\n  ScriptingAgent::dirSubagents (const YCPPath &path)\n  {\n      const long path_length = path->length ();\n      YCPList dir_list = YCPList ();\n  \n      for (SubAgents::const_iterator it = agents.begin ();\n  \t it != agents.end (); ++it)\n      {\n  \tYCPPath it_path = (*it)->get_path ();\n  \tif (path->isPrefixOf (it_path))\n  \t{\n  \t    YCPString str = YCPString (it_path->component_str (path_length));\n  \t    const int size = dir_list->size ();\n  \t    if (size == 0 || !dir_list->value (size - 1)->equal (str))\n  \t\tdir_list->add (str);\n  \t}\n      }\n      return dir_list;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "command",
            "\"Dir\""
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agents.end",
          "args": [],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "findAndRegisterSubagent",
          "args": [
            "path"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "findAndRegisterSubagent",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "553-577",
          "snippet": "ScriptingAgent::SubAgents::const_iterator\nScriptingAgent::findAndRegisterSubagent (const YCPPath &path)\n{\n    SubAgents::const_iterator agent = findSubagent (path);\n    if (agent != agents.end ())\n\treturn agent;\n\n    // no such agent registered.\n    // try registering by guessing its scr file name\n\n    // i = 0 gives the root path. we may need some caching after all for \".scr\"\n    int i;\n    for (i = path->length(); i >= 0; --i) {\n\ttryRegister (path->prefix (i));\n\n\tagent = findSubagent (path); // retry\n\tif (agent != agents.end ())\n\t    return agent;\n    }\n\n    // guess did not work. register all.\n    if (! done_sweep)\n\tSweep ();\n    return findSubagent (path);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  ScriptingAgent::SubAgents::const_iterator\n  ScriptingAgent::findAndRegisterSubagent (const YCPPath &path)\n  {\n      SubAgents::const_iterator agent = findSubagent (path);\n      if (agent != agents.end ())\n  \treturn agent;\n  \n      // no such agent registered.\n      // try registering by guessing its scr file name\n  \n      // i = 0 gives the root path. we may need some caching after all for \".scr\"\n      int i;\n      for (i = path->length(); i >= 0; --i) {\n  \ttryRegister (path->prefix (i));\n  \n  \tagent = findSubagent (path); // retry\n  \tif (agent != agents.end ())\n  \t    return agent;\n      }\n  \n      // guess did not work. register all.\n      if (! done_sweep)\n  \tSweep ();\n      return findSubagent (path);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"opt: %s\"",
            "optpar.isNull() ? \"null\" : optpar->toString().c_str ()"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "optpar.isNull",
          "args": [],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"arg: %s\"",
            "arg.isNull() ? \"null\" : arg->toString().c_str ()"
          ],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arg.isNull",
          "args": [],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"path: %s\"",
            "path->toString ().c_str ()"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"ScriptingAgent::executeSubagentCommand: %s\"",
            "command"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPValue\n  ScriptingAgent::executeSubagentCommand (const char *command,\n  \t\t\t\t\tconst YCPPath &path,\n  \t\t\t\t\tconst YCPValue &arg,\n  \t\t\t\t\tconst YCPValue &optpar)\n  {\n      y2debug( \"ScriptingAgent::executeSubagentCommand: %s\", command );\n      y2debug( \"path: %s\", path->toString ().c_str ());\n      y2debug( \"arg: %s\", arg.isNull() ? \"null\" : arg->toString().c_str ());\n      y2debug( \"opt: %s\", optpar.isNull() ? \"null\" : optpar->toString().c_str ());\n  \n      SubAgents::const_iterator agent = findAndRegisterSubagent (path);\n      if (agent == agents.end ()) {\n  \tbool cmd_is_dir = strcmp (command, \"Dir\") == 0;\n  \t// Special case to have the possibility of Dir (.sysconfig) or similar...\n  \tif (cmd_is_dir)\n  \t{\n  \t    return dirSubagents (path);\n  \t}\n  \t// if all fails:\n  \treturn YCPError (\"Couldn't find an agent to handle '\" +\n  \t\t\t path->toString () + \"'\");\n      }\n  \n      (*agent)->mount (this);\n  \n      if (!(*agent)->get_comp ())\n      {\n  \tycp2error (\"Couldn't mount agent to handle '%s'\", path->toString().c_str ());\n  \treturn YCPNull ();\n      }\n      \n      YCPTerm commandterm (command);\n      commandterm->add (path->at ((*agent)->get_path ()->length ())); // relative path\n  \n      if (!arg.isNull ())\n  \tcommandterm->add (arg);\n      if (!optpar.isNull ())\n  \tcommandterm->add (optpar);\n  \n      return (*agent)->get_comp ()->evaluate (commandterm);\n  }\n}"
  },
  {
    "function_name": "findAndRegisterSubagent",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "553-577",
    "snippet": "ScriptingAgent::SubAgents::const_iterator\nScriptingAgent::findAndRegisterSubagent (const YCPPath &path)\n{\n    SubAgents::const_iterator agent = findSubagent (path);\n    if (agent != agents.end ())\n\treturn agent;\n\n    // no such agent registered.\n    // try registering by guessing its scr file name\n\n    // i = 0 gives the root path. we may need some caching after all for \".scr\"\n    int i;\n    for (i = path->length(); i >= 0; --i) {\n\ttryRegister (path->prefix (i));\n\n\tagent = findSubagent (path); // retry\n\tif (agent != agents.end ())\n\t    return agent;\n    }\n\n    // guess did not work. register all.\n    if (! done_sweep)\n\tSweep ();\n    return findSubagent (path);\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "findSubagent",
          "args": [
            "path"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "findSubagent",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "532-550",
          "snippet": "ScriptingAgent::SubAgents::const_iterator\nScriptingAgent::findSubagent (const YCPPath &path)\n{\n    // The list of agents is sorted. So we can simply take the first\n    // that does match.\n    SubAgents::const_iterator agent = agents.end ();\n\n    // known bug: doesn't work with const_reverse_iterator\n    for (SubAgents::reverse_iterator it = agents.rbegin ();\n\t it != agents.rend (); ++it)\n    {\n\tif ((*it)->get_path ()->isPrefixOf (path))\n\t{\n\t    agent = it.base () - 1;\t// convert reverse_iterator to iterator\n\t    break;\n\t}\n    }\n    return agent;\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  ScriptingAgent::SubAgents::const_iterator\n  ScriptingAgent::findSubagent (const YCPPath &path)\n  {\n      // The list of agents is sorted. So we can simply take the first\n      // that does match.\n      SubAgents::const_iterator agent = agents.end ();\n  \n      // known bug: doesn't work with const_reverse_iterator\n      for (SubAgents::reverse_iterator it = agents.rbegin ();\n  \t it != agents.rend (); ++it)\n      {\n  \tif ((*it)->get_path ()->isPrefixOf (path))\n  \t{\n  \t    agent = it.base () - 1;\t// convert reverse_iterator to iterator\n  \t    break;\n  \t}\n      }\n      return agent;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Sweep",
          "args": [],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "Sweep",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "427-440",
          "snippet": "void\nScriptingAgent::Sweep ()\n{\n    extern ExecutionEnvironment ee;\n    ycp2warning (ee.filename().c_str(), ee.linenumber(), \"Scripting agent sweeping\");\n    for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n\t level++)\n    {\n\tstring dir = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n\ty2debug( \"Scripting agent searching SCRs in %s\", dir.c_str() );\n\tparseConfigFiles (dir);\n    }\n    done_sweep = true;\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::Sweep ()\n  {\n      extern ExecutionEnvironment ee;\n      ycp2warning (ee.filename().c_str(), ee.linenumber(), \"Scripting agent sweeping\");\n      for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n  \t level++)\n      {\n  \tstring dir = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n  \ty2debug( \"Scripting agent searching SCRs in %s\", dir.c_str() );\n  \tparseConfigFiles (dir);\n      }\n      done_sweep = true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "agents.end",
          "args": [],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tryRegister",
          "args": [
            "path->prefix (i)"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "tryRegister",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "467-497",
          "snippet": "void\nScriptingAgent::tryRegister (const YCPPath &path)\n{\n    // .foo.bar.baz becomes foo_bar_baz.scr\n    string basename = tr (path->toString().substr(1), '.', '_') + \".scr\";\n\n    list<RegistrationDir>::iterator\n\ti = registration_dirs.begin(),\n\te = registration_dirs.end();\n    for (; i != e; ++i) {\n\tRegistrationDir & rd = *i;\n\tstruct stat st;\n\tif (stat (rd.name.c_str(), &st) != 0) {\n\t    y2debug (\"Can't read dir %s: %m\", rd.name.c_str ());\n\t}\n\telse {\n\t    // COBE, this caching logic is bogus\n\t    //if (rd.last_changed < st.st_mtime) {\n\t\t// change detected!\n\t\t//rd.last_changed = st.st_mtime;\n\t\t//y2milestone (\"Agent registration: %s last changed at %s\",\n\t    //     rd.name.c_str(), ctime (&rd.last_changed));\n\t\tstring fname = rd.name + '/' + basename;\n\t\tstruct stat st;\n\t\tif (stat (fname.c_str (), &st) == 0) {\n\t\t    parseSingleConfigFile (fname);\n\t\t    break;\t// found\n\t\t}\n\t}\n    }\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::tryRegister (const YCPPath &path)\n  {\n      // .foo.bar.baz becomes foo_bar_baz.scr\n      string basename = tr (path->toString().substr(1), '.', '_') + \".scr\";\n  \n      list<RegistrationDir>::iterator\n  \ti = registration_dirs.begin(),\n  \te = registration_dirs.end();\n      for (; i != e; ++i) {\n  \tRegistrationDir & rd = *i;\n  \tstruct stat st;\n  \tif (stat (rd.name.c_str(), &st) != 0) {\n  \t    y2debug (\"Can't read dir %s: %m\", rd.name.c_str ());\n  \t}\n  \telse {\n  \t    // COBE, this caching logic is bogus\n  \t    //if (rd.last_changed < st.st_mtime) {\n  \t\t// change detected!\n  \t\t//rd.last_changed = st.st_mtime;\n  \t\t//y2milestone (\"Agent registration: %s last changed at %s\",\n  \t    //     rd.name.c_str(), ctime (&rd.last_changed));\n  \t\tstring fname = rd.name + '/' + basename;\n  \t\tstruct stat st;\n  \t\tif (stat (fname.c_str (), &st) == 0) {\n  \t\t    parseSingleConfigFile (fname);\n  \t\t    break;\t// found\n  \t\t}\n  \t}\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path->prefix",
          "args": [
            "i"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "prefix",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "151-158",
          "snippet": "YCPPath\nYCPPathRep::prefix(long index) const\n{\n    YCPPath ret;\n    for (int i = 0; i < index; ++i)\n\tret->append(components[i]);\n    return ret;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  YCPPath\n  YCPPathRep::prefix(long index) const\n  {\n      YCPPath ret;\n      for (int i = 0; i < index; ++i)\n  \tret->append(components[i]);\n      return ret;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path->length",
          "args": [],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  ScriptingAgent::SubAgents::const_iterator\n  ScriptingAgent::findAndRegisterSubagent (const YCPPath &path)\n  {\n      SubAgents::const_iterator agent = findSubagent (path);\n      if (agent != agents.end ())\n  \treturn agent;\n  \n      // no such agent registered.\n      // try registering by guessing its scr file name\n  \n      // i = 0 gives the root path. we may need some caching after all for \".scr\"\n      int i;\n      for (i = path->length(); i >= 0; --i) {\n  \ttryRegister (path->prefix (i));\n  \n  \tagent = findSubagent (path); // retry\n  \tif (agent != agents.end ())\n  \t    return agent;\n      }\n  \n      // guess did not work. register all.\n      if (! done_sweep)\n  \tSweep ();\n      return findSubagent (path);\n  }\n}"
  },
  {
    "function_name": "findSubagent",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "532-550",
    "snippet": "ScriptingAgent::SubAgents::const_iterator\nScriptingAgent::findSubagent (const YCPPath &path)\n{\n    // The list of agents is sorted. So we can simply take the first\n    // that does match.\n    SubAgents::const_iterator agent = agents.end ();\n\n    // known bug: doesn't work with const_reverse_iterator\n    for (SubAgents::reverse_iterator it = agents.rbegin ();\n\t it != agents.rend (); ++it)\n    {\n\tif ((*it)->get_path ()->isPrefixOf (path))\n\t{\n\t    agent = it.base () - 1;\t// convert reverse_iterator to iterator\n\t    break;\n\t}\n    }\n    return agent;\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "it.base",
          "args": [],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "path"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agents.rend",
          "args": [],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agents.rbegin",
          "args": [],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agents.end",
          "args": [],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  ScriptingAgent::SubAgents::const_iterator\n  ScriptingAgent::findSubagent (const YCPPath &path)\n  {\n      // The list of agents is sorted. So we can simply take the first\n      // that does match.\n      SubAgents::const_iterator agent = agents.end ();\n  \n      // known bug: doesn't work with const_reverse_iterator\n      for (SubAgents::reverse_iterator it = agents.rbegin ();\n  \t it != agents.rend (); ++it)\n      {\n  \tif ((*it)->get_path ()->isPrefixOf (path))\n  \t{\n  \t    agent = it.base () - 1;\t// convert reverse_iterator to iterator\n  \t    break;\n  \t}\n      }\n      return agent;\n  }\n}"
  },
  {
    "function_name": "dirSubagents",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "499-518",
    "snippet": "YCPList\nScriptingAgent::dirSubagents (const YCPPath &path)\n{\n    const long path_length = path->length ();\n    YCPList dir_list = YCPList ();\n\n    for (SubAgents::const_iterator it = agents.begin ();\n\t it != agents.end (); ++it)\n    {\n\tYCPPath it_path = (*it)->get_path ();\n\tif (path->isPrefixOf (it_path))\n\t{\n\t    YCPString str = YCPString (it_path->component_str (path_length));\n\t    const int size = dir_list->size ();\n\t    if (size == 0 || !dir_list->value (size - 1)->equal (str))\n\t\tdir_list->add (str);\n\t}\n    }\n    return dir_list;\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dir_list->add",
          "args": [
            "str"
          ],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dir_list->value",
          "args": [
            "str"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dir_list->size",
          "args": [],
          "line": 512
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "it_path->component_str (path_length)"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "it_path->component_str",
          "args": [
            "path_length"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path->isPrefixOf",
          "args": [
            "it_path"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "isPrefixOf",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "131-139",
          "snippet": "bool\nYCPPathRep::isPrefixOf(const YCPPath& path) const\n{\n    if (length() > path->length()) return false;\n\n    for (int c=0; c<length(); c++)\n\tif (component_str(c) != path->component_str(c)) return false;\n    return true;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  bool\n  YCPPathRep::isPrefixOf(const YCPPath& path) const\n  {\n      if (length() > path->length()) return false;\n  \n      for (int c=0; c<length(); c++)\n  \tif (component_str(c) != path->component_str(c)) return false;\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agents.end",
          "args": [],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "agents.begin",
          "args": [],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPList",
          "args": [],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "commaList",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "254-265",
          "snippet": "string\nYCPListRep::commaList() const\n{\n    string ret;\n\n    for (unsigned index = 0; index < elements.size(); index++)\n    {\n\tif (index != 0) ret += \", \";\n\tret += elements[index].isNull() ? \"(null)\" : elements[index]->toString();\n    }\n    return ret;\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  string\n  YCPListRep::commaList() const\n  {\n      string ret;\n  \n      for (unsigned index = 0; index < elements.size(); index++)\n      {\n  \tif (index != 0) ret += \", \";\n  \tret += elements[index].isNull() ? \"(null)\" : elements[index]->toString();\n      }\n      return ret;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path->length",
          "args": [],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPList\n  ScriptingAgent::dirSubagents (const YCPPath &path)\n  {\n      const long path_length = path->length ();\n      YCPList dir_list = YCPList ();\n  \n      for (SubAgents::const_iterator it = agents.begin ();\n  \t it != agents.end (); ++it)\n      {\n  \tYCPPath it_path = (*it)->get_path ();\n  \tif (path->isPrefixOf (it_path))\n  \t{\n  \t    YCPString str = YCPString (it_path->component_str (path_length));\n  \t    const int size = dir_list->size ();\n  \t    if (size == 0 || !dir_list->value (size - 1)->equal (str))\n  \t\tdir_list->add (str);\n  \t}\n      }\n      return dir_list;\n  }\n}"
  },
  {
    "function_name": "tryRegister",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "467-497",
    "snippet": "void\nScriptingAgent::tryRegister (const YCPPath &path)\n{\n    // .foo.bar.baz becomes foo_bar_baz.scr\n    string basename = tr (path->toString().substr(1), '.', '_') + \".scr\";\n\n    list<RegistrationDir>::iterator\n\ti = registration_dirs.begin(),\n\te = registration_dirs.end();\n    for (; i != e; ++i) {\n\tRegistrationDir & rd = *i;\n\tstruct stat st;\n\tif (stat (rd.name.c_str(), &st) != 0) {\n\t    y2debug (\"Can't read dir %s: %m\", rd.name.c_str ());\n\t}\n\telse {\n\t    // COBE, this caching logic is bogus\n\t    //if (rd.last_changed < st.st_mtime) {\n\t\t// change detected!\n\t\t//rd.last_changed = st.st_mtime;\n\t\t//y2milestone (\"Agent registration: %s last changed at %s\",\n\t    //     rd.name.c_str(), ctime (&rd.last_changed));\n\t\tstring fname = rd.name + '/' + basename;\n\t\tstruct stat st;\n\t\tif (stat (fname.c_str (), &st) == 0) {\n\t\t    parseSingleConfigFile (fname);\n\t\t    break;\t// found\n\t\t}\n\t}\n    }\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parseSingleConfigFile",
          "args": [
            "fname"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "parseSingleConfigFile",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "128-181",
          "snippet": "void\nScriptingAgent::parseSingleConfigFile (const string &filename)\n{\n    struct stat st;\n    if (stat (filename.c_str (), &st) != 0)\n    {\n\ty2debug (\"Can't read dir entry file %s: %m\", filename.c_str ());\n\treturn;\n    }\n\n    if (!S_ISREG (st.st_mode) && !S_ISLNK (st.st_mode))\n\treturn;\n\n    FILE *file = fopen (filename.c_str (), \"r\");\n    if (!file)\n    {\n\ty2debug (\"Can't open %s for reading: %m\", filename.c_str ());\n\treturn;\n    }\n\n    const int size = 250;\n    char line[size];\n\n    while (fgets (line, size, file))\n    {\n\t// delete last char (newline)\n\tconst int l = strlen (line);\n\tif (l > 0)\n\t    line[l - 1] = '\\0';\n\n\tif (line[0] == '.')\n\t{\n\t    YCPPath path (line);\n\t    SubAgents::iterator agent = findByPath (path);\n\t    if (agent != agents.end ())\n\t    {\n\t\t// TODO promote more debugs to errors or warnings\n    \t\ty2warning (\"Ignoring re-registration of path '%s'\", path->toString ().c_str ());\n\t\t// possible alternative: do not ignore\n\t\t// - ok if the agent was not used yet (not mounted yet)\n\t\t// - umount if mounted??\n\t    }\n\t    else\n\t    {\n\t\t// posible optimization:\n\t\t// dont reparse the file\n\t\tRegisterAgent (path, YCPString (filename));\n\t    }\n\t    break;\n\t}\n    }\n\n    fclose (file);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::parseSingleConfigFile (const string &filename)\n  {\n      struct stat st;\n      if (stat (filename.c_str (), &st) != 0)\n      {\n  \ty2debug (\"Can't read dir entry file %s: %m\", filename.c_str ());\n  \treturn;\n      }\n  \n      if (!S_ISREG (st.st_mode) && !S_ISLNK (st.st_mode))\n  \treturn;\n  \n      FILE *file = fopen (filename.c_str (), \"r\");\n      if (!file)\n      {\n  \ty2debug (\"Can't open %s for reading: %m\", filename.c_str ());\n  \treturn;\n      }\n  \n      const int size = 250;\n      char line[size];\n  \n      while (fgets (line, size, file))\n      {\n  \t// delete last char (newline)\n  \tconst int l = strlen (line);\n  \tif (l > 0)\n  \t    line[l - 1] = '\\0';\n  \n  \tif (line[0] == '.')\n  \t{\n  \t    YCPPath path (line);\n  \t    SubAgents::iterator agent = findByPath (path);\n  \t    if (agent != agents.end ())\n  \t    {\n  \t\t// TODO promote more debugs to errors or warnings\n      \t\ty2warning (\"Ignoring re-registration of path '%s'\", path->toString ().c_str ());\n  \t\t// possible alternative: do not ignore\n  \t\t// - ok if the agent was not used yet (not mounted yet)\n  \t\t// - umount if mounted??\n  \t    }\n  \t    else\n  \t    {\n  \t\t// posible optimization:\n  \t\t// dont reparse the file\n  \t\tRegisterAgent (path, YCPString (filename));\n  \t    }\n  \t    break;\n  \t}\n      }\n  \n      fclose (file);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "fname.c_str ()",
            "&st"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Can't read dir %s: %m\"",
            "rd.name.c_str ()"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rd.name.c_str",
          "args": [],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "rd.name.c_str()",
            "&st"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rd.name.c_str",
          "args": [],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "registration_dirs.end",
          "args": [],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "registration_dirs.begin",
          "args": [],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "path->toString().substr(1)",
            "'.'",
            "'_'"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "tr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "452-464",
          "snippet": "static\nstring\ntr (const string & s, char a, char b)\n{\n    char * sc = strdup (s.c_str ());\n    for (char * p = sc; *p; ++p) {\n\tif (*p == a)\n\t    *p = b;\n    }\n    string ret = sc;\n    free (sc);\n    return ret;\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nstatic\nstring\ntr (const string & s, char a, char b)\n{\n    char * sc = strdup (s.c_str ());\n    for (char * p = sc; *p; ++p) {\n\tif (*p == a)\n\t    *p = b;\n    }\n    string ret = sc;\n    free (sc);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "path->toString",
          "args": [
            "1"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YSymbolEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YSymbolEntry.cc",
          "lines": "158-232",
          "snippet": "string \nYSymbolEntry::toString (bool with_type) const\n{\n    string s = (with_type && m_global) ? \"global \" : \"\";\n#if DO_DEBUG\n    y2debug (\"YSymbolEntry::toString %p: name '%s'\", this, m_name.asString().c_str());\n    y2debug (\"YSymbolEntry::toString %p: with_type %d, cat %s, name '%s'\", this, with_type, catString().c_str(), m_name.asString().c_str());\n#endif\n    switch (m_category)\n    {\n\tcase c_variable:\n\tcase c_reference:\n\tcase c_function:\n#if DO_DEBUG\n\t    y2debug (\"m_namespace %p[%s], m_global %d, with_type %d\", m_namespace, m_namespace ? m_namespace->name().c_str() : \"\", m_global, with_type);\n#endif\n\tcase c_builtin:\n\t{\n\t    if (with_type)\n\t    {\n\t\tconstFunctionTypePtr ftype = m_type;\n\t\ts += (((m_category == c_variable)||(m_category ==c_reference)) ? m_type->toString() : ftype->returnType()->toString()) + \" \";\n\t\tif (m_global\n\t\t    && m_namespace != 0\n\t\t    && !m_namespace->name().empty())\n\t\t{\n\t\t    s += (m_namespace->name() + \"::\");\n\t\t}\n\t\ts += m_name.asString();\n\t\tif ((m_category == c_builtin)\n\t\t    && (m_payload.m_decl != 0))\n\t\t{\n\t\t    s += \"(\" + m_payload.m_decl->type->toString() + \")\";\n\t\t}\n\t\telse if ((m_category == c_function)\n\t\t\t && (m_code != 0))\n\t\t{\n\t\t    s += ((YFunctionPtr)m_code)->toStringDeclaration();\n\t\t}\n\t\treturn s;\n\t    }\n\t    else\n\t    {\n\t\tstring s = string ((m_global && (m_namespace!=0)) ? (m_namespace->name() + \"::\") : \"\") + m_name.asString();\n\t\treturn s;\n\t    }\n\t}\n\tbreak;\n\tcase c_typedef:\n\t{\n\t    return s + catString() + \" \" + m_type->toString() + \" \" + m_name.asString() + \";\";\n\t}\n\tbreak;\n\tcase c_const:\n\t{\n\t    return s + m_type->toString() + \" \" + m_name.asString();\n\t}\n\tbreak;\n\tcase c_namespace:\n\tcase c_self:\n\tcase c_filename:\n\tcase c_predefined:\n\t{\n\t    return s + catString() + \" '\" + m_name.asString() + \"'\";\n\t}\n\tbreak;\n\tdefault:\n\t{\n\t    return SymbolEntry::toString (with_type);\n\t}\n\tbreak;\n    }\n\n    return \"?SymbolEntry?\";\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/StaticDeclaration.h\"",
            "#include \"ycp/SymbolTable.h\"",
            "#include \"y2/SymbolEntry.h\"",
            "#include \"ycp/y2log.h\"",
            "#include <string>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define DO_DEBUG 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/StaticDeclaration.h\"\n#include \"ycp/SymbolTable.h\"\n#include \"y2/SymbolEntry.h\"\n#include \"ycp/y2log.h\"\n#include <string>\n#include <stdio.h>\n\n#define DO_DEBUG 0\n\nYSymbolEntry {\n  string \n  YSymbolEntry::toString (bool with_type) const\n  {\n      string s = (with_type && m_global) ? \"global \" : \"\";\n  #if DO_DEBUG\n      y2debug (\"YSymbolEntry::toString %p: name '%s'\", this, m_name.asString().c_str());\n      y2debug (\"YSymbolEntry::toString %p: with_type %d, cat %s, name '%s'\", this, with_type, catString().c_str(), m_name.asString().c_str());\n  #endif\n      switch (m_category)\n      {\n  \tcase c_variable:\n  \tcase c_reference:\n  \tcase c_function:\n  #if DO_DEBUG\n  \t    y2debug (\"m_namespace %p[%s], m_global %d, with_type %d\", m_namespace, m_namespace ? m_namespace->name().c_str() : \"\", m_global, with_type);\n  #endif\n  \tcase c_builtin:\n  \t{\n  \t    if (with_type)\n  \t    {\n  \t\tconstFunctionTypePtr ftype = m_type;\n  \t\ts += (((m_category == c_variable)||(m_category ==c_reference)) ? m_type->toString() : ftype->returnType()->toString()) + \" \";\n  \t\tif (m_global\n  \t\t    && m_namespace != 0\n  \t\t    && !m_namespace->name().empty())\n  \t\t{\n  \t\t    s += (m_namespace->name() + \"::\");\n  \t\t}\n  \t\ts += m_name.asString();\n  \t\tif ((m_category == c_builtin)\n  \t\t    && (m_payload.m_decl != 0))\n  \t\t{\n  \t\t    s += \"(\" + m_payload.m_decl->type->toString() + \")\";\n  \t\t}\n  \t\telse if ((m_category == c_function)\n  \t\t\t && (m_code != 0))\n  \t\t{\n  \t\t    s += ((YFunctionPtr)m_code)->toStringDeclaration();\n  \t\t}\n  \t\treturn s;\n  \t    }\n  \t    else\n  \t    {\n  \t\tstring s = string ((m_global && (m_namespace!=0)) ? (m_namespace->name() + \"::\") : \"\") + m_name.asString();\n  \t\treturn s;\n  \t    }\n  \t}\n  \tbreak;\n  \tcase c_typedef:\n  \t{\n  \t    return s + catString() + \" \" + m_type->toString() + \" \" + m_name.asString() + \";\";\n  \t}\n  \tbreak;\n  \tcase c_const:\n  \t{\n  \t    return s + m_type->toString() + \" \" + m_name.asString();\n  \t}\n  \tbreak;\n  \tcase c_namespace:\n  \tcase c_self:\n  \tcase c_filename:\n  \tcase c_predefined:\n  \t{\n  \t    return s + catString() + \" '\" + m_name.asString() + \"'\";\n  \t}\n  \tbreak;\n  \tdefault:\n  \t{\n  \t    return SymbolEntry::toString (with_type);\n  \t}\n  \tbreak;\n      }\n  \n      return \"?SymbolEntry?\";\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path->toString",
          "args": [],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::tryRegister (const YCPPath &path)\n  {\n      // .foo.bar.baz becomes foo_bar_baz.scr\n      string basename = tr (path->toString().substr(1), '.', '_') + \".scr\";\n  \n      list<RegistrationDir>::iterator\n  \ti = registration_dirs.begin(),\n  \te = registration_dirs.end();\n      for (; i != e; ++i) {\n  \tRegistrationDir & rd = *i;\n  \tstruct stat st;\n  \tif (stat (rd.name.c_str(), &st) != 0) {\n  \t    y2debug (\"Can't read dir %s: %m\", rd.name.c_str ());\n  \t}\n  \telse {\n  \t    // COBE, this caching logic is bogus\n  \t    //if (rd.last_changed < st.st_mtime) {\n  \t\t// change detected!\n  \t\t//rd.last_changed = st.st_mtime;\n  \t\t//y2milestone (\"Agent registration: %s last changed at %s\",\n  \t    //     rd.name.c_str(), ctime (&rd.last_changed));\n  \t\tstring fname = rd.name + '/' + basename;\n  \t\tstruct stat st;\n  \t\tif (stat (fname.c_str (), &st) == 0) {\n  \t\t    parseSingleConfigFile (fname);\n  \t\t    break;\t// found\n  \t\t}\n  \t}\n      }\n  }\n}"
  },
  {
    "function_name": "tr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "452-464",
    "snippet": "static\nstring\ntr (const string & s, char a, char b)\n{\n    char * sc = strdup (s.c_str ());\n    for (char * p = sc; *p; ++p) {\n\tif (*p == a)\n\t    *p = b;\n    }\n    string ret = sc;\n    free (sc);\n    return ret;\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "sc"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "s.c_str ()"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.c_str",
          "args": [],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nstatic\nstring\ntr (const string & s, char a, char b)\n{\n    char * sc = strdup (s.c_str ());\n    for (char * p = sc; *p; ++p) {\n\tif (*p == a)\n\t    *p = b;\n    }\n    string ret = sc;\n    free (sc);\n    return ret;\n}"
  },
  {
    "function_name": "RegisterNewAgents",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "444-449",
    "snippet": "YCPBoolean\nScriptingAgent::RegisterNewAgents ()\n{\n    Sweep ();\n    return YCPBoolean (true);\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPBoolean",
          "args": [
            "true"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "YCPBoolean",
          "container": "YCPBoolean",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPBoolean.cc",
          "lines": "99-107",
          "snippet": "YCPBoolean::YCPBoolean (bytecodeistream & str)\n    : YCPValue (*(\n\tBytecode::readBool (str) ? \n\ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n\t:\n\tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n    ))\n{\n}",
          "includes": [
            "#include \"Xmlcode.h\"",
            "#include \"Bytecode.h\"",
            "#include \"YCPBoolean.h\"",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "YCPBoolean* YCPBoolean::trueboolean = NULL;",
            "YCPBoolean* YCPBoolean::falseboolean = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPBoolean.h\"\n#include <ycp/y2log.h>\n\nYCPBoolean* YCPBoolean::trueboolean = NULL;\nYCPBoolean* YCPBoolean::falseboolean = NULL;\n\nYCPBoolean {\n  YCPBoolean::YCPBoolean (bytecodeistream & str)\n      : YCPValue (*(\n  \tBytecode::readBool (str) ? \n  \ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n  \t:\n  \tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n      ))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Sweep",
          "args": [],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "Sweep",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "427-440",
          "snippet": "void\nScriptingAgent::Sweep ()\n{\n    extern ExecutionEnvironment ee;\n    ycp2warning (ee.filename().c_str(), ee.linenumber(), \"Scripting agent sweeping\");\n    for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n\t level++)\n    {\n\tstring dir = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n\ty2debug( \"Scripting agent searching SCRs in %s\", dir.c_str() );\n\tparseConfigFiles (dir);\n    }\n    done_sweep = true;\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::Sweep ()\n  {\n      extern ExecutionEnvironment ee;\n      ycp2warning (ee.filename().c_str(), ee.linenumber(), \"Scripting agent sweeping\");\n      for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n  \t level++)\n      {\n  \tstring dir = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n  \ty2debug( \"Scripting agent searching SCRs in %s\", dir.c_str() );\n  \tparseConfigFiles (dir);\n      }\n      done_sweep = true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPBoolean\n  ScriptingAgent::RegisterNewAgents ()\n  {\n      Sweep ();\n      return YCPBoolean (true);\n  }\n}"
  },
  {
    "function_name": "Sweep",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "427-440",
    "snippet": "void\nScriptingAgent::Sweep ()\n{\n    extern ExecutionEnvironment ee;\n    ycp2warning (ee.filename().c_str(), ee.linenumber(), \"Scripting agent sweeping\");\n    for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n\t level++)\n    {\n\tstring dir = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n\ty2debug( \"Scripting agent searching SCRs in %s\", dir.c_str() );\n\tparseConfigFiles (dir);\n    }\n    done_sweep = true;\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parseConfigFiles",
          "args": [
            "dir"
          ],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "parseConfigFiles",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "83-125",
          "snippet": "void\nScriptingAgent::parseConfigFiles (const string &directory)\n{\n    y2debug (\"Y2SCRComponent::parseConfigFiles (%s)\", directory.c_str ());\n\n    DIR *dir = opendir (directory.c_str ());\n    if (!dir)\n    {\n\ty2debug (\"Can't open directory %s for reading: %m\", directory.c_str ());\n\treturn;\n    }\n\n    struct dirent *entry;\n    // Access the files in inode order, hopefully this reduces disk seeks\n    // Use a list and sort it (or not).\n    // typedef map<ino_t, string> sorted_names_t;\n    typedef list<pair<ino_t, string> > sorted_names_t;\n    sorted_names_t sorted_names;\n    while ((entry = readdir (dir)))\n    {\n\tchar *n = entry->d_name;\n\t// Read only *.scr files. For example TRANS.TBL makes problems\n\tif (strlen (n) <= 4 ||\n\t    strcmp (n + strlen (n) - 4, \".scr\"))\n\t    continue;\n\n\t// sorted_names[entry->d_ino] = n;\n\tsorted_names.push_back (make_pair (entry->d_ino, string(n)));\n    }\n\n    closedir (dir);\n\n    // TODO cache\n    if (!getenv (\"Y2SCRNOSORT\"))\n\tsorted_names.sort(less_than_inodes);\n\n    sorted_names_t::iterator i = sorted_names.begin (), e = sorted_names.end ();\n    for (; i != e; ++i)\n    {\n\tconst string filename = directory + \"/\" + i->second;\n\tparseSingleConfigFile (filename);\n    }\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::parseConfigFiles (const string &directory)\n  {\n      y2debug (\"Y2SCRComponent::parseConfigFiles (%s)\", directory.c_str ());\n  \n      DIR *dir = opendir (directory.c_str ());\n      if (!dir)\n      {\n  \ty2debug (\"Can't open directory %s for reading: %m\", directory.c_str ());\n  \treturn;\n      }\n  \n      struct dirent *entry;\n      // Access the files in inode order, hopefully this reduces disk seeks\n      // Use a list and sort it (or not).\n      // typedef map<ino_t, string> sorted_names_t;\n      typedef list<pair<ino_t, string> > sorted_names_t;\n      sorted_names_t sorted_names;\n      while ((entry = readdir (dir)))\n      {\n  \tchar *n = entry->d_name;\n  \t// Read only *.scr files. For example TRANS.TBL makes problems\n  \tif (strlen (n) <= 4 ||\n  \t    strcmp (n + strlen (n) - 4, \".scr\"))\n  \t    continue;\n  \n  \t// sorted_names[entry->d_ino] = n;\n  \tsorted_names.push_back (make_pair (entry->d_ino, string(n)));\n      }\n  \n      closedir (dir);\n  \n      // TODO cache\n      if (!getenv (\"Y2SCRNOSORT\"))\n  \tsorted_names.sort(less_than_inodes);\n  \n      sorted_names_t::iterator i = sorted_names.begin (), e = sorted_names.end ();\n      for (; i != e; ++i)\n      {\n  \tconst string filename = directory + \"/\" + i->second;\n  \tparseSingleConfigFile (filename);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Scripting agent searching SCRs in %s\"",
            "dir.c_str()"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dir.c_str",
          "args": [],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Y2PathSearch::searchPath",
          "args": [
            "Y2PathSearch::GENERIC",
            "level"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "searchPath",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "93-128",
          "snippet": "string\nY2PathSearch::searchPath (WHAT what, int level)\n{\n    initializePaths();\n\n    int levels = paths.size();\n\n    switch (what)\n    {\n\tcase EXECCOMP:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn EXECCOMPDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level];\n\t    }\n\tbreak;\n\n\tcase PLUGIN:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn PLUGINDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level] + \"/plugin\";\n\t    }\n\tbreak;\n\n\tdefault:\n\tbreak;\n    }\n    return paths[level];\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<string> Y2PathSearch::paths;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  string\n  Y2PathSearch::searchPath (WHAT what, int level)\n  {\n      initializePaths();\n  \n      int levels = paths.size();\n  \n      switch (what)\n      {\n  \tcase EXECCOMP:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn EXECCOMPDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level];\n  \t    }\n  \tbreak;\n  \n  \tcase PLUGIN:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn PLUGINDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level] + \"/plugin\";\n  \t    }\n  \tbreak;\n  \n  \tdefault:\n  \tbreak;\n      }\n      return paths[level];\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Y2PathSearch::numberOfComponentLevels",
          "args": [],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "numberOfComponentLevels",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "85-90",
          "snippet": "int\nY2PathSearch::numberOfComponentLevels()\n{\n    initializePaths();\n    return paths.size();\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<string> Y2PathSearch::paths;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  int\n  Y2PathSearch::numberOfComponentLevels()\n  {\n      initializePaths();\n      return paths.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ycp2warning",
          "args": [
            "ee.filename().c_str()",
            "ee.linenumber()",
            "\"Scripting agent sweeping\""
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ee.linenumber",
          "args": [],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "linenumber",
          "container": "ExecutionEnvironment",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/ExecutionEnvironment.cc",
          "lines": "41-45",
          "snippet": "int\nExecutionEnvironment::linenumber () const\n{\n    return m_linenumber;\n}",
          "includes": [
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/YStatement.h\"",
            "#include \"ycp/ExecutionEnvironment.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/y2log.h\"\n#include \"ycp/YStatement.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n\nExecutionEnvironment {\n  int\n  ExecutionEnvironment::linenumber () const\n  {\n      return m_linenumber;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ee.filename",
          "args": [],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "filename",
          "container": "Scanner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Scanner.cc",
          "lines": "335-339",
          "snippet": "string\nScanner::filename () const\n{\n    return m_filename;\n}",
          "includes": [
            "#include \"ycp/SymbolTable.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Scanner.h\"",
            "#include <errno.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/SymbolTable.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Scanner.h\"\n#include <errno.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string>\n\nScanner {\n  string\n  Scanner::filename () const\n  {\n      return m_filename;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::Sweep ()\n  {\n      extern ExecutionEnvironment ee;\n      ycp2warning (ee.filename().c_str(), ee.linenumber(), \"Scripting agent sweeping\");\n      for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n  \t level++)\n      {\n  \tstring dir = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n  \ty2debug( \"Scripting agent searching SCRs in %s\", dir.c_str() );\n  \tparseConfigFiles (dir);\n      }\n      done_sweep = true;\n  }\n}"
  },
  {
    "function_name": "UnmountAllAgents",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "415-424",
    "snippet": "YCPValue\nScriptingAgent::UnmountAllAgents ()\n{\n    for (SubAgents::const_iterator agent = agents.begin ();\n\t agent != agents.end (); agent++)\n    {\n\t(*agent)->unmount ();\n    }\n    return YCPBoolean (true);\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPBoolean",
          "args": [
            "true"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "YCPBoolean",
          "container": "YCPBoolean",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPBoolean.cc",
          "lines": "99-107",
          "snippet": "YCPBoolean::YCPBoolean (bytecodeistream & str)\n    : YCPValue (*(\n\tBytecode::readBool (str) ? \n\ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n\t:\n\tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n    ))\n{\n}",
          "includes": [
            "#include \"Xmlcode.h\"",
            "#include \"Bytecode.h\"",
            "#include \"YCPBoolean.h\"",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "YCPBoolean* YCPBoolean::trueboolean = NULL;",
            "YCPBoolean* YCPBoolean::falseboolean = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPBoolean.h\"\n#include <ycp/y2log.h>\n\nYCPBoolean* YCPBoolean::trueboolean = NULL;\nYCPBoolean* YCPBoolean::falseboolean = NULL;\n\nYCPBoolean {\n  YCPBoolean::YCPBoolean (bytecodeistream & str)\n      : YCPValue (*(\n  \tBytecode::readBool (str) ? \n  \ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n  \t:\n  \tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n      ))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agents.end",
          "args": [],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "agents.begin",
          "args": [],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPValue\n  ScriptingAgent::UnmountAllAgents ()\n  {\n      for (SubAgents::const_iterator agent = agents.begin ();\n  \t agent != agents.end (); agent++)\n      {\n  \t(*agent)->unmount ();\n      }\n      return YCPBoolean (true);\n  }\n}"
  },
  {
    "function_name": "UnmountAgent",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "402-412",
    "snippet": "YCPBoolean\nScriptingAgent::UnmountAgent (const YCPPath &path)\n{\n    SubAgents::iterator agent = findByPath (path);\n    if (agent == agents.end () || (*agent)->get_comp () == 0)\n    {\n\treturn YCPBoolean (false);\n    }\n    (*agent)->unmount ();\n    return YCPBoolean (true);\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPBoolean",
          "args": [
            "true"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "YCPBoolean",
          "container": "YCPBoolean",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPBoolean.cc",
          "lines": "99-107",
          "snippet": "YCPBoolean::YCPBoolean (bytecodeistream & str)\n    : YCPValue (*(\n\tBytecode::readBool (str) ? \n\ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n\t:\n\tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n    ))\n{\n}",
          "includes": [
            "#include \"Xmlcode.h\"",
            "#include \"Bytecode.h\"",
            "#include \"YCPBoolean.h\"",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "YCPBoolean* YCPBoolean::trueboolean = NULL;",
            "YCPBoolean* YCPBoolean::falseboolean = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPBoolean.h\"\n#include <ycp/y2log.h>\n\nYCPBoolean* YCPBoolean::trueboolean = NULL;\nYCPBoolean* YCPBoolean::falseboolean = NULL;\n\nYCPBoolean {\n  YCPBoolean::YCPBoolean (bytecodeistream & str)\n      : YCPValue (*(\n  \tBytecode::readBool (str) ? \n  \ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n  \t:\n  \tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n      ))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agents.end",
          "args": [],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "findByPath",
          "args": [
            "path"
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "findByPath",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "623-634",
          "snippet": "ScriptingAgent::SubAgents::iterator\nScriptingAgent::findByPath (const YCPPath &path)\n{\n    SubAgents::iterator agent = std::lower_bound (agents.begin (),\n\t\t\t\t\t\t  agents.end (),\n\t\t\t\t\t\t  path);\n\n    if (agent != agents.end () && (*agent)->get_path ()->equal (path))\n\treturn agent;\n\n    return agents.end ();\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  ScriptingAgent::SubAgents::iterator\n  ScriptingAgent::findByPath (const YCPPath &path)\n  {\n      SubAgents::iterator agent = std::lower_bound (agents.begin (),\n  \t\t\t\t\t\t  agents.end (),\n  \t\t\t\t\t\t  path);\n  \n      if (agent != agents.end () && (*agent)->get_path ()->equal (path))\n  \treturn agent;\n  \n      return agents.end ();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPBoolean\n  ScriptingAgent::UnmountAgent (const YCPPath &path)\n  {\n      SubAgents::iterator agent = findByPath (path);\n      if (agent == agents.end () || (*agent)->get_comp () == 0)\n      {\n  \treturn YCPBoolean (false);\n      }\n      (*agent)->unmount ();\n      return YCPBoolean (true);\n  }\n}"
  },
  {
    "function_name": "MountAllAgents",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "385-399",
    "snippet": "YCPValue\nScriptingAgent::MountAllAgents ()\n{\n    YCPValue v = YCPNull();\n    for (SubAgents::const_iterator agent = agents.begin ();\n         agent != agents.end (); agent++)\n    {\n\tv = (*agent)->mount (this);\n\tif (v.isNull ())\n\t{\n\t    return v;\n\t}\n    }\n    return YCPBoolean (true);\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPBoolean",
          "args": [
            "true"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "YCPBoolean",
          "container": "YCPBoolean",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPBoolean.cc",
          "lines": "99-107",
          "snippet": "YCPBoolean::YCPBoolean (bytecodeistream & str)\n    : YCPValue (*(\n\tBytecode::readBool (str) ? \n\ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n\t:\n\tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n    ))\n{\n}",
          "includes": [
            "#include \"Xmlcode.h\"",
            "#include \"Bytecode.h\"",
            "#include \"YCPBoolean.h\"",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "YCPBoolean* YCPBoolean::trueboolean = NULL;",
            "YCPBoolean* YCPBoolean::falseboolean = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPBoolean.h\"\n#include <ycp/y2log.h>\n\nYCPBoolean* YCPBoolean::trueboolean = NULL;\nYCPBoolean* YCPBoolean::falseboolean = NULL;\n\nYCPBoolean {\n  YCPBoolean::YCPBoolean (bytecodeistream & str)\n      : YCPValue (*(\n  \tBytecode::readBool (str) ? \n  \ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n  \t:\n  \tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n      ))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v.isNull",
          "args": [],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "this"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agents.end",
          "args": [],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "agents.begin",
          "args": [],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPValue\n  ScriptingAgent::MountAllAgents ()\n  {\n      YCPValue v = YCPNull();\n      for (SubAgents::const_iterator agent = agents.begin ();\n           agent != agents.end (); agent++)\n      {\n  \tv = (*agent)->mount (this);\n  \tif (v.isNull ())\n  \t{\n  \t    return v;\n  \t}\n      }\n      return YCPBoolean (true);\n  }\n}"
  },
  {
    "function_name": "MountAgent",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "371-381",
    "snippet": "YCPValue\nScriptingAgent::MountAgent (const YCPPath &path)\n{\n    SubAgents::iterator agent = findByPath (path);\n    if (agent == agents.end ())\n    {\n\treturn YCPError (\"Path '\" + path->toString() + \"' not registered\",\n\t\t\t YCPBoolean (false));\n    }\n    return (*agent)->mount (this);\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "this"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPError",
          "args": [
            "\"Path '\" + path->toString() + \"' not registered\"",
            "YCPBoolean (false)"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "YCPError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "317-321",
          "snippet": "YCPValue YCPError (string message, const YCPValue & ret)\n{\n    ycp2error (\"%s\", message.c_str ());\n    return ret;\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValue YCPError (string message, const YCPValue & ret)\n{\n    ycp2error (\"%s\", message.c_str ());\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPBoolean",
          "args": [
            "false"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "YCPBoolean",
          "container": "YCPBoolean",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPBoolean.cc",
          "lines": "99-107",
          "snippet": "YCPBoolean::YCPBoolean (bytecodeistream & str)\n    : YCPValue (*(\n\tBytecode::readBool (str) ? \n\ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n\t:\n\tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n    ))\n{\n}",
          "includes": [
            "#include \"Xmlcode.h\"",
            "#include \"Bytecode.h\"",
            "#include \"YCPBoolean.h\"",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "YCPBoolean* YCPBoolean::trueboolean = NULL;",
            "YCPBoolean* YCPBoolean::falseboolean = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPBoolean.h\"\n#include <ycp/y2log.h>\n\nYCPBoolean* YCPBoolean::trueboolean = NULL;\nYCPBoolean* YCPBoolean::falseboolean = NULL;\n\nYCPBoolean {\n  YCPBoolean::YCPBoolean (bytecodeistream & str)\n      : YCPValue (*(\n  \tBytecode::readBool (str) ? \n  \ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n  \t:\n  \tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n      ))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path->toString",
          "args": [],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "agents.end",
          "args": [],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "findByPath",
          "args": [
            "path"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "findByPath",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "623-634",
          "snippet": "ScriptingAgent::SubAgents::iterator\nScriptingAgent::findByPath (const YCPPath &path)\n{\n    SubAgents::iterator agent = std::lower_bound (agents.begin (),\n\t\t\t\t\t\t  agents.end (),\n\t\t\t\t\t\t  path);\n\n    if (agent != agents.end () && (*agent)->get_path ()->equal (path))\n\treturn agent;\n\n    return agents.end ();\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  ScriptingAgent::SubAgents::iterator\n  ScriptingAgent::findByPath (const YCPPath &path)\n  {\n      SubAgents::iterator agent = std::lower_bound (agents.begin (),\n  \t\t\t\t\t\t  agents.end (),\n  \t\t\t\t\t\t  path);\n  \n      if (agent != agents.end () && (*agent)->get_path ()->equal (path))\n  \treturn agent;\n  \n      return agents.end ();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPValue\n  ScriptingAgent::MountAgent (const YCPPath &path)\n  {\n      SubAgents::iterator agent = findByPath (path);\n      if (agent == agents.end ())\n      {\n  \treturn YCPError (\"Path '\" + path->toString() + \"' not registered\",\n  \t\t\t YCPBoolean (false));\n      }\n      return (*agent)->mount (this);\n  }\n}"
  },
  {
    "function_name": "UnregisterAllAgents",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "352-367",
    "snippet": "YCPBoolean\nScriptingAgent::UnregisterAllAgents ()\n{\n    // an automatic sweep would undo this call.\n    // use RegisterNewAgents if you want that.\n    done_sweep = true;\n    for (SubAgents::iterator agent = agents.begin (); agent != agents.end ();\n\t ++agent)\n    {\n\ty2debug (\"Path '%s' unregistered\",\n\t\t (*agent)->get_path ()->toString ().c_str ());\n        delete *agent;\n    }\n    agents.clear ();\n    return YCPBoolean (true);\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPBoolean",
          "args": [
            "true"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "YCPBoolean",
          "container": "YCPBoolean",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPBoolean.cc",
          "lines": "99-107",
          "snippet": "YCPBoolean::YCPBoolean (bytecodeistream & str)\n    : YCPValue (*(\n\tBytecode::readBool (str) ? \n\ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n\t:\n\tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n    ))\n{\n}",
          "includes": [
            "#include \"Xmlcode.h\"",
            "#include \"Bytecode.h\"",
            "#include \"YCPBoolean.h\"",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "YCPBoolean* YCPBoolean::trueboolean = NULL;",
            "YCPBoolean* YCPBoolean::falseboolean = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPBoolean.h\"\n#include <ycp/y2log.h>\n\nYCPBoolean* YCPBoolean::trueboolean = NULL;\nYCPBoolean* YCPBoolean::falseboolean = NULL;\n\nYCPBoolean {\n  YCPBoolean::YCPBoolean (bytecodeistream & str)\n      : YCPValue (*(\n  \tBytecode::readBool (str) ? \n  \ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n  \t:\n  \tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n      ))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "agents.clear",
          "args": [],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "461-461",
          "snippet": "void clear() { _devino.clear(); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nvoid clear() { _devino.clear(); }"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Path '%s' unregistered\"",
            "(*agent)->get_path ()->toString ().c_str ()"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agents.end",
          "args": [],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "agents.begin",
          "args": [],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPBoolean\n  ScriptingAgent::UnregisterAllAgents ()\n  {\n      // an automatic sweep would undo this call.\n      // use RegisterNewAgents if you want that.\n      done_sweep = true;\n      for (SubAgents::iterator agent = agents.begin (); agent != agents.end ();\n  \t ++agent)\n      {\n  \ty2debug (\"Path '%s' unregistered\",\n  \t\t (*agent)->get_path ()->toString ().c_str ());\n          delete *agent;\n      }\n      agents.clear ();\n      return YCPBoolean (true);\n  }\n}"
  },
  {
    "function_name": "UnregisterAgent",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "333-349",
    "snippet": "YCPBoolean\nScriptingAgent::UnregisterAgent (const YCPPath &path)\n{\n    // done_sweep appears wrong, bnc#365116\n\n    SubAgents::iterator agent = findByPath (path);\n    if (agent == agents.end ())\n    {\n\ty2debug (\"Path '%s' is not registered\", path->toString ().c_str ());\n\treturn YCPBoolean (false);\n    }\n\n    y2debug (\"Path '%s' unregistered\", path->toString ().c_str ());\n    delete *agent;\n    agents.erase (agent);\n    return YCPBoolean (true);\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPBoolean",
          "args": [
            "true"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "YCPBoolean",
          "container": "YCPBoolean",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPBoolean.cc",
          "lines": "99-107",
          "snippet": "YCPBoolean::YCPBoolean (bytecodeistream & str)\n    : YCPValue (*(\n\tBytecode::readBool (str) ? \n\ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n\t:\n\tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n    ))\n{\n}",
          "includes": [
            "#include \"Xmlcode.h\"",
            "#include \"Bytecode.h\"",
            "#include \"YCPBoolean.h\"",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "YCPBoolean* YCPBoolean::trueboolean = NULL;",
            "YCPBoolean* YCPBoolean::falseboolean = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPBoolean.h\"\n#include <ycp/y2log.h>\n\nYCPBoolean* YCPBoolean::trueboolean = NULL;\nYCPBoolean* YCPBoolean::falseboolean = NULL;\n\nYCPBoolean {\n  YCPBoolean::YCPBoolean (bytecodeistream & str)\n      : YCPValue (*(\n  \tBytecode::readBool (str) ? \n  \ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n  \t:\n  \tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n      ))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "agents.erase",
          "args": [
            "agent"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "683-695",
          "snippet": "int PathInfo::erase( const Pathname & path )\n{\n  int res = 0;\n  PathInfo p( path, LSTAT );\n  if ( p.isExist() )\n    {\n      if ( p.isDir() )\n        res = PathInfo::recursive_rmdir( path );\n      else\n        res = PathInfo::unlink( path );\n    }\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::erase( const Pathname & path )\n  {\n    int res = 0;\n    PathInfo p( path, LSTAT );\n    if ( p.isExist() )\n      {\n        if ( p.isDir() )\n          res = PathInfo::recursive_rmdir( path );\n        else\n          res = PathInfo::unlink( path );\n      }\n    return res;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Path '%s' unregistered\"",
            "path->toString ().c_str ()"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->toString",
          "args": [],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Path '%s' is not registered\"",
            "path->toString ().c_str ()"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agents.end",
          "args": [],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "findByPath",
          "args": [
            "path"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "findByPath",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "623-634",
          "snippet": "ScriptingAgent::SubAgents::iterator\nScriptingAgent::findByPath (const YCPPath &path)\n{\n    SubAgents::iterator agent = std::lower_bound (agents.begin (),\n\t\t\t\t\t\t  agents.end (),\n\t\t\t\t\t\t  path);\n\n    if (agent != agents.end () && (*agent)->get_path ()->equal (path))\n\treturn agent;\n\n    return agents.end ();\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  ScriptingAgent::SubAgents::iterator\n  ScriptingAgent::findByPath (const YCPPath &path)\n  {\n      SubAgents::iterator agent = std::lower_bound (agents.begin (),\n  \t\t\t\t\t\t  agents.end (),\n  \t\t\t\t\t\t  path);\n  \n      if (agent != agents.end () && (*agent)->get_path ()->equal (path))\n  \treturn agent;\n  \n      return agents.end ();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPBoolean\n  ScriptingAgent::UnregisterAgent (const YCPPath &path)\n  {\n      // done_sweep appears wrong, bnc#365116\n  \n      SubAgents::iterator agent = findByPath (path);\n      if (agent == agents.end ())\n      {\n  \ty2debug (\"Path '%s' is not registered\", path->toString ().c_str ());\n  \treturn YCPBoolean (false);\n      }\n  \n      y2debug (\"Path '%s' unregistered\", path->toString ().c_str ());\n      delete *agent;\n      agents.erase (agent);\n      return YCPBoolean (true);\n  }\n}"
  },
  {
    "function_name": "RegisterAgent",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "310-330",
    "snippet": "YCPBoolean\nScriptingAgent::RegisterAgent (const YCPPath &path, const YCPValue &value)\n{\n    SubAgents::iterator agent = findByPath (path);\n    if (agent == agents.end ())\n    {\n\ty2debug (\"Path '%s' registered\", path->toString ().c_str ());\n    }\n    else\n    {\n\tycp2warning (\"\", 0, \"Path '%s' newly registered\", path->toString ().c_str ());\n\tdelete *agent;\n\tagents.erase (agent);\n    }\n\n    // insert into ordered vector\n    agents.insert (std::lower_bound (agents.begin (), agents.end (), path),\n\t\t   new SCRSubAgent (path, value));\n\n    return YCPBoolean (true);\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPBoolean",
          "args": [
            "true"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "YCPBoolean",
          "container": "YCPBoolean",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPBoolean.cc",
          "lines": "99-107",
          "snippet": "YCPBoolean::YCPBoolean (bytecodeistream & str)\n    : YCPValue (*(\n\tBytecode::readBool (str) ? \n\ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n\t:\n\tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n    ))\n{\n}",
          "includes": [
            "#include \"Xmlcode.h\"",
            "#include \"Bytecode.h\"",
            "#include \"YCPBoolean.h\"",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "YCPBoolean* YCPBoolean::trueboolean = NULL;",
            "YCPBoolean* YCPBoolean::falseboolean = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPBoolean.h\"\n#include <ycp/y2log.h>\n\nYCPBoolean* YCPBoolean::trueboolean = NULL;\nYCPBoolean* YCPBoolean::falseboolean = NULL;\n\nYCPBoolean {\n  YCPBoolean::YCPBoolean (bytecodeistream & str)\n      : YCPValue (*(\n  \tBytecode::readBool (str) ? \n  \ttrueboolean ? trueboolean : (trueboolean = new YCPBoolean (new YCPBooleanRep (true)) )\n  \t:\n  \tfalseboolean ? falseboolean : (falseboolean = new YCPBoolean (new YCPBooleanRep (false)) )\n      ))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "agents.insert",
          "args": [
            "std::lower_bound (agents.begin (), agents.end (), path)",
            "new SCRSubAgent (path, value)"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "468-470",
          "snippet": "bool insert( const dev_t & dev_r, const ino_t & ino_r ) {\n      return _devino[dev_r].insert( ino_r ).second;\n    }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nbool insert( const dev_t & dev_r, const ino_t & ino_r ) {\n      return _devino[dev_r].insert( ino_r ).second;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "std::lower_bound",
          "args": [
            "agents.begin ()",
            "agents.end ()",
            "path"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agents.end",
          "args": [],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "agents.begin",
          "args": [],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "agents.erase",
          "args": [
            "agent"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "683-695",
          "snippet": "int PathInfo::erase( const Pathname & path )\n{\n  int res = 0;\n  PathInfo p( path, LSTAT );\n  if ( p.isExist() )\n    {\n      if ( p.isDir() )\n        res = PathInfo::recursive_rmdir( path );\n      else\n        res = PathInfo::unlink( path );\n    }\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::erase( const Pathname & path )\n  {\n    int res = 0;\n    PathInfo p( path, LSTAT );\n    if ( p.isExist() )\n      {\n        if ( p.isDir() )\n          res = PathInfo::recursive_rmdir( path );\n        else\n          res = PathInfo::unlink( path );\n      }\n    return res;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ycp2warning",
          "args": [
            "\"\"",
            "0",
            "\"Path '%s' newly registered\"",
            "path->toString ().c_str ()"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->toString",
          "args": [],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Path '%s' registered\"",
            "path->toString ().c_str ()"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "findByPath",
          "args": [
            "path"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "findByPath",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "623-634",
          "snippet": "ScriptingAgent::SubAgents::iterator\nScriptingAgent::findByPath (const YCPPath &path)\n{\n    SubAgents::iterator agent = std::lower_bound (agents.begin (),\n\t\t\t\t\t\t  agents.end (),\n\t\t\t\t\t\t  path);\n\n    if (agent != agents.end () && (*agent)->get_path ()->equal (path))\n\treturn agent;\n\n    return agents.end ();\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  ScriptingAgent::SubAgents::iterator\n  ScriptingAgent::findByPath (const YCPPath &path)\n  {\n      SubAgents::iterator agent = std::lower_bound (agents.begin (),\n  \t\t\t\t\t\t  agents.end (),\n  \t\t\t\t\t\t  path);\n  \n      if (agent != agents.end () && (*agent)->get_path ()->equal (path))\n  \treturn agent;\n  \n      return agents.end ();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPBoolean\n  ScriptingAgent::RegisterAgent (const YCPPath &path, const YCPValue &value)\n  {\n      SubAgents::iterator agent = findByPath (path);\n      if (agent == agents.end ())\n      {\n  \ty2debug (\"Path '%s' registered\", path->toString ().c_str ());\n      }\n      else\n      {\n  \tycp2warning (\"\", 0, \"Path '%s' newly registered\", path->toString ().c_str ());\n  \tdelete *agent;\n  \tagents.erase (agent);\n      }\n  \n      // insert into ordered vector\n      agents.insert (std::lower_bound (agents.begin (), agents.end (), path),\n  \t\t   new SCRSubAgent (path, value));\n  \n      return YCPBoolean (true);\n  }\n}"
  },
  {
    "function_name": "otherCommand",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "265-307",
    "snippet": "YCPValue\nScriptingAgent::otherCommand (const YCPTerm &term)\n{\n    // FIXME: convert to proper builtins\n    const string sym = term->name ();\n\n    if (sym == \"MountAgent\"\n\t     && term->size () == 1\n\t     && term->value (0)->isPath ())\n    {\n\treturn MountAgent (term->value (0)->asPath ());\n    }\n    else if (sym == \"MountAllAgents\"\n\t     && term->size () == 0)\n    {\n\treturn MountAllAgents ();\n    }\n    else if (sym == \"UnmountAllAgents\"\n\t     && term->size () == 0)\n    {\n\treturn UnmountAllAgents ();\n    }\n    else if (sym == \"RegisterAgent\"\n\t     && term->size () == 2\n\t     && term->value (0)->isPath ())\n    {\n\treturn RegisterAgent (term->value (0)->asPath (), term->value (1));\n    }\n    else if (sym == \"UnregisterAgent\"\n\t     && term->size () == 1\n\t     && term->value (0)->isPath ())\n    {\n\treturn UnregisterAgent (term->value (0)->asPath ());\n    }\n    else if (sym == \"YaST2Version\" || sym == \"SuSEVersion\")\n    {\n\t// SuSEVersion is the older name (for historic reasons)\n\t// yes: ignore all arguments\n\treturn YCPString (SUSEVERSION);\n    }\n\n    return YCPNull ();\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "SUSEVERSION"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "UnregisterAgent",
          "args": [
            "term->value (0)->asPath ()"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "UnregisterAgent",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "333-349",
          "snippet": "YCPBoolean\nScriptingAgent::UnregisterAgent (const YCPPath &path)\n{\n    // done_sweep appears wrong, bnc#365116\n\n    SubAgents::iterator agent = findByPath (path);\n    if (agent == agents.end ())\n    {\n\ty2debug (\"Path '%s' is not registered\", path->toString ().c_str ());\n\treturn YCPBoolean (false);\n    }\n\n    y2debug (\"Path '%s' unregistered\", path->toString ().c_str ());\n    delete *agent;\n    agents.erase (agent);\n    return YCPBoolean (true);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPBoolean\n  ScriptingAgent::UnregisterAgent (const YCPPath &path)\n  {\n      // done_sweep appears wrong, bnc#365116\n  \n      SubAgents::iterator agent = findByPath (path);\n      if (agent == agents.end ())\n      {\n  \ty2debug (\"Path '%s' is not registered\", path->toString ().c_str ());\n  \treturn YCPBoolean (false);\n      }\n  \n      y2debug (\"Path '%s' unregistered\", path->toString ().c_str ());\n      delete *agent;\n      agents.erase (agent);\n      return YCPBoolean (true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "term->value",
          "args": [],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "term->value",
          "args": [
            "0"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "term->size",
          "args": [],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "RegisterAgent",
          "args": [
            "term->value (0)->asPath ()",
            "term->value (1)"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "RegisterAgent",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "310-330",
          "snippet": "YCPBoolean\nScriptingAgent::RegisterAgent (const YCPPath &path, const YCPValue &value)\n{\n    SubAgents::iterator agent = findByPath (path);\n    if (agent == agents.end ())\n    {\n\ty2debug (\"Path '%s' registered\", path->toString ().c_str ());\n    }\n    else\n    {\n\tycp2warning (\"\", 0, \"Path '%s' newly registered\", path->toString ().c_str ());\n\tdelete *agent;\n\tagents.erase (agent);\n    }\n\n    // insert into ordered vector\n    agents.insert (std::lower_bound (agents.begin (), agents.end (), path),\n\t\t   new SCRSubAgent (path, value));\n\n    return YCPBoolean (true);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPBoolean\n  ScriptingAgent::RegisterAgent (const YCPPath &path, const YCPValue &value)\n  {\n      SubAgents::iterator agent = findByPath (path);\n      if (agent == agents.end ())\n      {\n  \ty2debug (\"Path '%s' registered\", path->toString ().c_str ());\n      }\n      else\n      {\n  \tycp2warning (\"\", 0, \"Path '%s' newly registered\", path->toString ().c_str ());\n  \tdelete *agent;\n  \tagents.erase (agent);\n      }\n  \n      // insert into ordered vector\n      agents.insert (std::lower_bound (agents.begin (), agents.end (), path),\n  \t\t   new SCRSubAgent (path, value));\n  \n      return YCPBoolean (true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "UnmountAllAgents",
          "args": [],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "UnmountAllAgents",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "415-424",
          "snippet": "YCPValue\nScriptingAgent::UnmountAllAgents ()\n{\n    for (SubAgents::const_iterator agent = agents.begin ();\n\t agent != agents.end (); agent++)\n    {\n\t(*agent)->unmount ();\n    }\n    return YCPBoolean (true);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPValue\n  ScriptingAgent::UnmountAllAgents ()\n  {\n      for (SubAgents::const_iterator agent = agents.begin ();\n  \t agent != agents.end (); agent++)\n      {\n  \t(*agent)->unmount ();\n      }\n      return YCPBoolean (true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MountAllAgents",
          "args": [],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "MountAllAgents",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "385-399",
          "snippet": "YCPValue\nScriptingAgent::MountAllAgents ()\n{\n    YCPValue v = YCPNull();\n    for (SubAgents::const_iterator agent = agents.begin ();\n         agent != agents.end (); agent++)\n    {\n\tv = (*agent)->mount (this);\n\tif (v.isNull ())\n\t{\n\t    return v;\n\t}\n    }\n    return YCPBoolean (true);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPValue\n  ScriptingAgent::MountAllAgents ()\n  {\n      YCPValue v = YCPNull();\n      for (SubAgents::const_iterator agent = agents.begin ();\n           agent != agents.end (); agent++)\n      {\n  \tv = (*agent)->mount (this);\n  \tif (v.isNull ())\n  \t{\n  \t    return v;\n  \t}\n      }\n      return YCPBoolean (true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MountAgent",
          "args": [
            "term->value (0)->asPath ()"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "MountAgent",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "371-381",
          "snippet": "YCPValue\nScriptingAgent::MountAgent (const YCPPath &path)\n{\n    SubAgents::iterator agent = findByPath (path);\n    if (agent == agents.end ())\n    {\n\treturn YCPError (\"Path '\" + path->toString() + \"' not registered\",\n\t\t\t YCPBoolean (false));\n    }\n    return (*agent)->mount (this);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPValue\n  ScriptingAgent::MountAgent (const YCPPath &path)\n  {\n      SubAgents::iterator agent = findByPath (path);\n      if (agent == agents.end ())\n      {\n  \treturn YCPError (\"Path '\" + path->toString() + \"' not registered\",\n  \t\t\t YCPBoolean (false));\n      }\n      return (*agent)->mount (this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "term->name",
          "args": [],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "name",
          "container": "Y2AgentComp",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libscr/src/include/scr/Y2AgentComponent.h",
          "lines": "44-44",
          "snippet": "string name () const { return my_name; }",
          "includes": [
            "#include <ycp/YCPTerm.h>",
            "#include <ycp/YCPVoid.h>",
            "#include <ycp/YCPCode.h>",
            "#include <y2/Y2Component.h>",
            "#include <ycp/YCPTerm.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ycp/YCPTerm.h>\n#include <ycp/YCPVoid.h>\n#include <ycp/YCPCode.h>\n#include <y2/Y2Component.h>\n#include <ycp/YCPTerm.h>\n#include <ycp/y2log.h>\n\nY2AgentComp {\n  string name () const { return my_name; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPValue\n  ScriptingAgent::otherCommand (const YCPTerm &term)\n  {\n      // FIXME: convert to proper builtins\n      const string sym = term->name ();\n  \n      if (sym == \"MountAgent\"\n  \t     && term->size () == 1\n  \t     && term->value (0)->isPath ())\n      {\n  \treturn MountAgent (term->value (0)->asPath ());\n      }\n      else if (sym == \"MountAllAgents\"\n  \t     && term->size () == 0)\n      {\n  \treturn MountAllAgents ();\n      }\n      else if (sym == \"UnmountAllAgents\"\n  \t     && term->size () == 0)\n      {\n  \treturn UnmountAllAgents ();\n      }\n      else if (sym == \"RegisterAgent\"\n  \t     && term->size () == 2\n  \t     && term->value (0)->isPath ())\n      {\n  \treturn RegisterAgent (term->value (0)->asPath (), term->value (1));\n      }\n      else if (sym == \"UnregisterAgent\"\n  \t     && term->size () == 1\n  \t     && term->value (0)->isPath ())\n      {\n  \treturn UnregisterAgent (term->value (0)->asPath ());\n      }\n      else if (sym == \"YaST2Version\" || sym == \"SuSEVersion\")\n      {\n  \t// SuSEVersion is the older name (for historic reasons)\n  \t// yes: ignore all arguments\n  \treturn YCPString (SUSEVERSION);\n      }\n  \n      return YCPNull ();\n  }\n}"
  },
  {
    "function_name": "Error",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "248-263",
    "snippet": "YCPMap\nScriptingAgent::Error (const YCPPath &path)\n{\n    YCPValue v = executeSubagentCommand (\"Error\", path);\n    if (v.isNull())\n    {\n\tycp2error (\"SCR::Error() failed\");\n\treturn YCPNull ();\n    }\n    if (!v->isMap ())\n    {\n\tycp2error (\"SCR::Error() did not return a map\");\n\treturn YCPNull ();\n    }\n    return v->asMap ();\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "v->asMap",
          "args": [],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "asMap",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "203-213",
          "snippet": "YCPMap\nYCPValueRep::asMap() const\n{\n    if (!isMap())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Map!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPMap (static_cast<const YCPMapRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPMap\n  YCPValueRep::asMap() const\n  {\n      if (!isMap())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Map!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPMap (static_cast<const YCPMapRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"SCR::Error() did not return a map\""
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v->isMap",
          "args": [],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "isMap",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "71-71",
          "snippet": "bool YCPValueRep::isMap()         const { return valuetype() == YT_MAP; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isMap()         const { return valuetype() == YT_MAP; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"SCR::Error() failed\""
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.isNull",
          "args": [],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "executeSubagentCommand",
          "args": [
            "\"Error\"",
            "path"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPMap\n  ScriptingAgent::Error (const YCPPath &path)\n  {\n      YCPValue v = executeSubagentCommand (\"Error\", path);\n      if (v.isNull())\n      {\n  \tycp2error (\"SCR::Error() failed\");\n  \treturn YCPNull ();\n      }\n      if (!v->isMap ())\n      {\n  \tycp2error (\"SCR::Error() did not return a map\");\n  \treturn YCPNull ();\n      }\n      return v->asMap ();\n  }\n}"
  },
  {
    "function_name": "Execute",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "235-246",
    "snippet": "YCPValue\nScriptingAgent::Execute (const YCPPath &path, const YCPValue &value,\n\t\t\t const YCPValue &arg)\n{\n    y2debug( \"This is ScriptingAgent::Execute\" );\n    YCPValue v =  executeSubagentCommand (\"Execute\", path, value, arg);\n    if (v.isNull())\n    {\n\tycp2error (\"SCR::Execute() failed\");\n    }\n    return v;\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"SCR::Execute() failed\""
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.isNull",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "executeSubagentCommand",
          "args": [
            "\"Execute\"",
            "path",
            "value",
            "arg"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "executeSubagentCommand",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "579-620",
          "snippet": "YCPValue\nScriptingAgent::executeSubagentCommand (const char *command,\n\t\t\t\t\tconst YCPPath &path,\n\t\t\t\t\tconst YCPValue &arg,\n\t\t\t\t\tconst YCPValue &optpar)\n{\n    y2debug( \"ScriptingAgent::executeSubagentCommand: %s\", command );\n    y2debug( \"path: %s\", path->toString ().c_str ());\n    y2debug( \"arg: %s\", arg.isNull() ? \"null\" : arg->toString().c_str ());\n    y2debug( \"opt: %s\", optpar.isNull() ? \"null\" : optpar->toString().c_str ());\n\n    SubAgents::const_iterator agent = findAndRegisterSubagent (path);\n    if (agent == agents.end ()) {\n\tbool cmd_is_dir = strcmp (command, \"Dir\") == 0;\n\t// Special case to have the possibility of Dir (.sysconfig) or similar...\n\tif (cmd_is_dir)\n\t{\n\t    return dirSubagents (path);\n\t}\n\t// if all fails:\n\treturn YCPError (\"Couldn't find an agent to handle '\" +\n\t\t\t path->toString () + \"'\");\n    }\n\n    (*agent)->mount (this);\n\n    if (!(*agent)->get_comp ())\n    {\n\tycp2error (\"Couldn't mount agent to handle '%s'\", path->toString().c_str ());\n\treturn YCPNull ();\n    }\n    \n    YCPTerm commandterm (command);\n    commandterm->add (path->at ((*agent)->get_path ()->length ())); // relative path\n\n    if (!arg.isNull ())\n\tcommandterm->add (arg);\n    if (!optpar.isNull ())\n\tcommandterm->add (optpar);\n\n    return (*agent)->get_comp ()->evaluate (commandterm);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPValue\n  ScriptingAgent::executeSubagentCommand (const char *command,\n  \t\t\t\t\tconst YCPPath &path,\n  \t\t\t\t\tconst YCPValue &arg,\n  \t\t\t\t\tconst YCPValue &optpar)\n  {\n      y2debug( \"ScriptingAgent::executeSubagentCommand: %s\", command );\n      y2debug( \"path: %s\", path->toString ().c_str ());\n      y2debug( \"arg: %s\", arg.isNull() ? \"null\" : arg->toString().c_str ());\n      y2debug( \"opt: %s\", optpar.isNull() ? \"null\" : optpar->toString().c_str ());\n  \n      SubAgents::const_iterator agent = findAndRegisterSubagent (path);\n      if (agent == agents.end ()) {\n  \tbool cmd_is_dir = strcmp (command, \"Dir\") == 0;\n  \t// Special case to have the possibility of Dir (.sysconfig) or similar...\n  \tif (cmd_is_dir)\n  \t{\n  \t    return dirSubagents (path);\n  \t}\n  \t// if all fails:\n  \treturn YCPError (\"Couldn't find an agent to handle '\" +\n  \t\t\t path->toString () + \"'\");\n      }\n  \n      (*agent)->mount (this);\n  \n      if (!(*agent)->get_comp ())\n      {\n  \tycp2error (\"Couldn't mount agent to handle '%s'\", path->toString().c_str ());\n  \treturn YCPNull ();\n      }\n      \n      YCPTerm commandterm (command);\n      commandterm->add (path->at ((*agent)->get_path ()->length ())); // relative path\n  \n      if (!arg.isNull ())\n  \tcommandterm->add (arg);\n      if (!optpar.isNull ())\n  \tcommandterm->add (optpar);\n  \n      return (*agent)->get_comp ()->evaluate (commandterm);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"This is ScriptingAgent::Execute\""
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPValue\n  ScriptingAgent::Execute (const YCPPath &path, const YCPValue &value,\n  \t\t\t const YCPValue &arg)\n  {\n      y2debug( \"This is ScriptingAgent::Execute\" );\n      YCPValue v =  executeSubagentCommand (\"Execute\", path, value, arg);\n      if (v.isNull())\n      {\n  \tycp2error (\"SCR::Execute() failed\");\n      }\n      return v;\n  }\n}"
  },
  {
    "function_name": "Dir",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "217-232",
    "snippet": "YCPList\nScriptingAgent::Dir (const YCPPath &path)\n{\n    YCPValue v = executeSubagentCommand (\"Dir\", path);\n    if (v.isNull())\n    {\n\tycp2error (\"SCR::Dir() failed\");\n\treturn YCPNull ();\n    }\n    if (!v->isList ())\n    {\n\tycp2error (\"SCR::Dir() did not return a list\");\n\treturn YCPNull ();\n    }\n    return v->asList ();\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "v->asList",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "asList",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "179-189",
          "snippet": "YCPList\nYCPValueRep::asList() const\n{\n    if (!isList())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not List!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPList (static_cast<const YCPListRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPList\n  YCPValueRep::asList() const\n  {\n      if (!isList())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not List!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPList (static_cast<const YCPListRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"SCR::Dir() did not return a list\""
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v->isList",
          "args": [],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "isList",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "69-69",
          "snippet": "bool YCPValueRep::isList()        const { return valuetype() == YT_LIST; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isList()        const { return valuetype() == YT_LIST; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"SCR::Dir() failed\""
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.isNull",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "executeSubagentCommand",
          "args": [
            "\"Dir\"",
            "path"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPList\n  ScriptingAgent::Dir (const YCPPath &path)\n  {\n      YCPValue v = executeSubagentCommand (\"Dir\", path);\n      if (v.isNull())\n      {\n  \tycp2error (\"SCR::Dir() failed\");\n  \treturn YCPNull ();\n      }\n      if (!v->isList ())\n      {\n  \tycp2error (\"SCR::Dir() did not return a list\");\n  \treturn YCPNull ();\n      }\n      return v->asList ();\n  }\n}"
  },
  {
    "function_name": "Write",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "198-214",
    "snippet": "YCPBoolean\nScriptingAgent::Write (const YCPPath &path, const YCPValue &value,\n\t\t       const YCPValue &arg)\n{\n    YCPValue v = executeSubagentCommand (\"Write\", path, value, arg);\n    if (v.isNull())\n    {\n\tycp2error (\"SCR::Write() failed\");\n\treturn YCPNull ();\n    }\n    if (!v->isBoolean ())\n    {\n\tycp2error (\"SCR::Write() did not return a boolean\");\n\treturn YCPNull ();\n    }\n    return v->asBoolean ();\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "v->asBoolean",
          "args": [],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "asBoolean",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "94-104",
          "snippet": "YCPBoolean\nYCPValueRep::asBoolean() const\n{\n    if (!isBoolean())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Boolean!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPBoolean (static_cast<const YCPBooleanRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPBoolean\n  YCPValueRep::asBoolean() const\n  {\n      if (!isBoolean())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Boolean!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPBoolean (static_cast<const YCPBooleanRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"SCR::Write() did not return a boolean\""
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v->isBoolean",
          "args": [],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "isBoolean",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "62-62",
          "snippet": "bool YCPValueRep::isBoolean()     const { return valuetype() == YT_BOOLEAN; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isBoolean()     const { return valuetype() == YT_BOOLEAN; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"SCR::Write() failed\""
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.isNull",
          "args": [],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "executeSubagentCommand",
          "args": [
            "\"Write\"",
            "path",
            "value",
            "arg"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "executeSubagentCommand",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "579-620",
          "snippet": "YCPValue\nScriptingAgent::executeSubagentCommand (const char *command,\n\t\t\t\t\tconst YCPPath &path,\n\t\t\t\t\tconst YCPValue &arg,\n\t\t\t\t\tconst YCPValue &optpar)\n{\n    y2debug( \"ScriptingAgent::executeSubagentCommand: %s\", command );\n    y2debug( \"path: %s\", path->toString ().c_str ());\n    y2debug( \"arg: %s\", arg.isNull() ? \"null\" : arg->toString().c_str ());\n    y2debug( \"opt: %s\", optpar.isNull() ? \"null\" : optpar->toString().c_str ());\n\n    SubAgents::const_iterator agent = findAndRegisterSubagent (path);\n    if (agent == agents.end ()) {\n\tbool cmd_is_dir = strcmp (command, \"Dir\") == 0;\n\t// Special case to have the possibility of Dir (.sysconfig) or similar...\n\tif (cmd_is_dir)\n\t{\n\t    return dirSubagents (path);\n\t}\n\t// if all fails:\n\treturn YCPError (\"Couldn't find an agent to handle '\" +\n\t\t\t path->toString () + \"'\");\n    }\n\n    (*agent)->mount (this);\n\n    if (!(*agent)->get_comp ())\n    {\n\tycp2error (\"Couldn't mount agent to handle '%s'\", path->toString().c_str ());\n\treturn YCPNull ();\n    }\n    \n    YCPTerm commandterm (command);\n    commandterm->add (path->at ((*agent)->get_path ()->length ())); // relative path\n\n    if (!arg.isNull ())\n\tcommandterm->add (arg);\n    if (!optpar.isNull ())\n\tcommandterm->add (optpar);\n\n    return (*agent)->get_comp ()->evaluate (commandterm);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPValue\n  ScriptingAgent::executeSubagentCommand (const char *command,\n  \t\t\t\t\tconst YCPPath &path,\n  \t\t\t\t\tconst YCPValue &arg,\n  \t\t\t\t\tconst YCPValue &optpar)\n  {\n      y2debug( \"ScriptingAgent::executeSubagentCommand: %s\", command );\n      y2debug( \"path: %s\", path->toString ().c_str ());\n      y2debug( \"arg: %s\", arg.isNull() ? \"null\" : arg->toString().c_str ());\n      y2debug( \"opt: %s\", optpar.isNull() ? \"null\" : optpar->toString().c_str ());\n  \n      SubAgents::const_iterator agent = findAndRegisterSubagent (path);\n      if (agent == agents.end ()) {\n  \tbool cmd_is_dir = strcmp (command, \"Dir\") == 0;\n  \t// Special case to have the possibility of Dir (.sysconfig) or similar...\n  \tif (cmd_is_dir)\n  \t{\n  \t    return dirSubagents (path);\n  \t}\n  \t// if all fails:\n  \treturn YCPError (\"Couldn't find an agent to handle '\" +\n  \t\t\t path->toString () + \"'\");\n      }\n  \n      (*agent)->mount (this);\n  \n      if (!(*agent)->get_comp ())\n      {\n  \tycp2error (\"Couldn't mount agent to handle '%s'\", path->toString().c_str ());\n  \treturn YCPNull ();\n      }\n      \n      YCPTerm commandterm (command);\n      commandterm->add (path->at ((*agent)->get_path ()->length ())); // relative path\n  \n      if (!arg.isNull ())\n  \tcommandterm->add (arg);\n      if (!optpar.isNull ())\n  \tcommandterm->add (optpar);\n  \n      return (*agent)->get_comp ()->evaluate (commandterm);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPBoolean\n  ScriptingAgent::Write (const YCPPath &path, const YCPValue &value,\n  \t\t       const YCPValue &arg)\n  {\n      YCPValue v = executeSubagentCommand (\"Write\", path, value, arg);\n      if (v.isNull())\n      {\n  \tycp2error (\"SCR::Write() failed\");\n  \treturn YCPNull ();\n      }\n      if (!v->isBoolean ())\n      {\n  \tycp2error (\"SCR::Write() did not return a boolean\");\n  \treturn YCPNull ();\n      }\n      return v->asBoolean ();\n  }\n}"
  },
  {
    "function_name": "Read",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "184-195",
    "snippet": "YCPValue\nScriptingAgent::Read (const YCPPath &path, const YCPValue &arg, const YCPValue &opt)\n{\n    y2debug( \"This is ScriptingAgent(%p)::Read\", this );\n    y2debug( \"opt: %s\", opt.isNull() ? \"null\" : opt->toString().c_str ());\n    YCPValue v = executeSubagentCommand (\"Read\", path, arg, opt);\n    if (v.isNull())\n    {\n\tycp2error (\"SCR::Read() failed\");\n    }\n    return v;\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"SCR::Read() failed\""
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.isNull",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "executeSubagentCommand",
          "args": [
            "\"Read\"",
            "path",
            "arg",
            "opt"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "executeSubagentCommand",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "579-620",
          "snippet": "YCPValue\nScriptingAgent::executeSubagentCommand (const char *command,\n\t\t\t\t\tconst YCPPath &path,\n\t\t\t\t\tconst YCPValue &arg,\n\t\t\t\t\tconst YCPValue &optpar)\n{\n    y2debug( \"ScriptingAgent::executeSubagentCommand: %s\", command );\n    y2debug( \"path: %s\", path->toString ().c_str ());\n    y2debug( \"arg: %s\", arg.isNull() ? \"null\" : arg->toString().c_str ());\n    y2debug( \"opt: %s\", optpar.isNull() ? \"null\" : optpar->toString().c_str ());\n\n    SubAgents::const_iterator agent = findAndRegisterSubagent (path);\n    if (agent == agents.end ()) {\n\tbool cmd_is_dir = strcmp (command, \"Dir\") == 0;\n\t// Special case to have the possibility of Dir (.sysconfig) or similar...\n\tif (cmd_is_dir)\n\t{\n\t    return dirSubagents (path);\n\t}\n\t// if all fails:\n\treturn YCPError (\"Couldn't find an agent to handle '\" +\n\t\t\t path->toString () + \"'\");\n    }\n\n    (*agent)->mount (this);\n\n    if (!(*agent)->get_comp ())\n    {\n\tycp2error (\"Couldn't mount agent to handle '%s'\", path->toString().c_str ());\n\treturn YCPNull ();\n    }\n    \n    YCPTerm commandterm (command);\n    commandterm->add (path->at ((*agent)->get_path ()->length ())); // relative path\n\n    if (!arg.isNull ())\n\tcommandterm->add (arg);\n    if (!optpar.isNull ())\n\tcommandterm->add (optpar);\n\n    return (*agent)->get_comp ()->evaluate (commandterm);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPValue\n  ScriptingAgent::executeSubagentCommand (const char *command,\n  \t\t\t\t\tconst YCPPath &path,\n  \t\t\t\t\tconst YCPValue &arg,\n  \t\t\t\t\tconst YCPValue &optpar)\n  {\n      y2debug( \"ScriptingAgent::executeSubagentCommand: %s\", command );\n      y2debug( \"path: %s\", path->toString ().c_str ());\n      y2debug( \"arg: %s\", arg.isNull() ? \"null\" : arg->toString().c_str ());\n      y2debug( \"opt: %s\", optpar.isNull() ? \"null\" : optpar->toString().c_str ());\n  \n      SubAgents::const_iterator agent = findAndRegisterSubagent (path);\n      if (agent == agents.end ()) {\n  \tbool cmd_is_dir = strcmp (command, \"Dir\") == 0;\n  \t// Special case to have the possibility of Dir (.sysconfig) or similar...\n  \tif (cmd_is_dir)\n  \t{\n  \t    return dirSubagents (path);\n  \t}\n  \t// if all fails:\n  \treturn YCPError (\"Couldn't find an agent to handle '\" +\n  \t\t\t path->toString () + \"'\");\n      }\n  \n      (*agent)->mount (this);\n  \n      if (!(*agent)->get_comp ())\n      {\n  \tycp2error (\"Couldn't mount agent to handle '%s'\", path->toString().c_str ());\n  \treturn YCPNull ();\n      }\n      \n      YCPTerm commandterm (command);\n      commandterm->add (path->at ((*agent)->get_path ()->length ())); // relative path\n  \n      if (!arg.isNull ())\n  \tcommandterm->add (arg);\n      if (!optpar.isNull ())\n  \tcommandterm->add (optpar);\n  \n      return (*agent)->get_comp ()->evaluate (commandterm);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"opt: %s\"",
            "opt.isNull() ? \"null\" : opt->toString().c_str ()"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opt->toString",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "opt.isNull",
          "args": [],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"This is ScriptingAgent(%p)::Read\"",
            "this"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPValue\n  ScriptingAgent::Read (const YCPPath &path, const YCPValue &arg, const YCPValue &opt)\n  {\n      y2debug( \"This is ScriptingAgent(%p)::Read\", this );\n      y2debug( \"opt: %s\", opt.isNull() ? \"null\" : opt->toString().c_str ());\n      YCPValue v = executeSubagentCommand (\"Read\", path, arg, opt);\n      if (v.isNull())\n      {\n  \tycp2error (\"SCR::Read() failed\");\n      }\n      return v;\n  }\n}"
  },
  {
    "function_name": "parseSingleConfigFile",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "128-181",
    "snippet": "void\nScriptingAgent::parseSingleConfigFile (const string &filename)\n{\n    struct stat st;\n    if (stat (filename.c_str (), &st) != 0)\n    {\n\ty2debug (\"Can't read dir entry file %s: %m\", filename.c_str ());\n\treturn;\n    }\n\n    if (!S_ISREG (st.st_mode) && !S_ISLNK (st.st_mode))\n\treturn;\n\n    FILE *file = fopen (filename.c_str (), \"r\");\n    if (!file)\n    {\n\ty2debug (\"Can't open %s for reading: %m\", filename.c_str ());\n\treturn;\n    }\n\n    const int size = 250;\n    char line[size];\n\n    while (fgets (line, size, file))\n    {\n\t// delete last char (newline)\n\tconst int l = strlen (line);\n\tif (l > 0)\n\t    line[l - 1] = '\\0';\n\n\tif (line[0] == '.')\n\t{\n\t    YCPPath path (line);\n\t    SubAgents::iterator agent = findByPath (path);\n\t    if (agent != agents.end ())\n\t    {\n\t\t// TODO promote more debugs to errors or warnings\n    \t\ty2warning (\"Ignoring re-registration of path '%s'\", path->toString ().c_str ());\n\t\t// possible alternative: do not ignore\n\t\t// - ok if the agent was not used yet (not mounted yet)\n\t\t// - umount if mounted??\n\t    }\n\t    else\n\t    {\n\t\t// posible optimization:\n\t\t// dont reparse the file\n\t\tRegisterAgent (path, YCPString (filename));\n\t    }\n\t    break;\n\t}\n    }\n\n    fclose (file);\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "file"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RegisterAgent",
          "args": [
            "path",
            "YCPString (filename)"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "RegisterAgent",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "310-330",
          "snippet": "YCPBoolean\nScriptingAgent::RegisterAgent (const YCPPath &path, const YCPValue &value)\n{\n    SubAgents::iterator agent = findByPath (path);\n    if (agent == agents.end ())\n    {\n\ty2debug (\"Path '%s' registered\", path->toString ().c_str ());\n    }\n    else\n    {\n\tycp2warning (\"\", 0, \"Path '%s' newly registered\", path->toString ().c_str ());\n\tdelete *agent;\n\tagents.erase (agent);\n    }\n\n    // insert into ordered vector\n    agents.insert (std::lower_bound (agents.begin (), agents.end (), path),\n\t\t   new SCRSubAgent (path, value));\n\n    return YCPBoolean (true);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPBoolean\n  ScriptingAgent::RegisterAgent (const YCPPath &path, const YCPValue &value)\n  {\n      SubAgents::iterator agent = findByPath (path);\n      if (agent == agents.end ())\n      {\n  \ty2debug (\"Path '%s' registered\", path->toString ().c_str ());\n      }\n      else\n      {\n  \tycp2warning (\"\", 0, \"Path '%s' newly registered\", path->toString ().c_str ());\n  \tdelete *agent;\n  \tagents.erase (agent);\n      }\n  \n      // insert into ordered vector\n      agents.insert (std::lower_bound (agents.begin (), agents.end (), path),\n  \t\t   new SCRSubAgent (path, value));\n  \n      return YCPBoolean (true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "filename"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2warning",
          "args": [
            "\"Ignoring re-registration of path '%s'\"",
            "path->toString ().c_str ()"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path->toString",
          "args": [],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "agents.end",
          "args": [],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "findByPath",
          "args": [
            "path"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "findByPath",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "623-634",
          "snippet": "ScriptingAgent::SubAgents::iterator\nScriptingAgent::findByPath (const YCPPath &path)\n{\n    SubAgents::iterator agent = std::lower_bound (agents.begin (),\n\t\t\t\t\t\t  agents.end (),\n\t\t\t\t\t\t  path);\n\n    if (agent != agents.end () && (*agent)->get_path ()->equal (path))\n\treturn agent;\n\n    return agents.end ();\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  ScriptingAgent::SubAgents::iterator\n  ScriptingAgent::findByPath (const YCPPath &path)\n  {\n      SubAgents::iterator agent = std::lower_bound (agents.begin (),\n  \t\t\t\t\t\t  agents.end (),\n  \t\t\t\t\t\t  path);\n  \n      if (agent != agents.end () && (*agent)->get_path ()->equal (path))\n  \treturn agent;\n  \n      return agents.end ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "line"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fgets",
          "args": [
            "line",
            "size",
            "file"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Can't open %s for reading: %m\"",
            "filename.c_str ()"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "filename.c_str ()",
            "\"r\""
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "st.st_mode"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "st.st_mode"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Can't read dir entry file %s: %m\"",
            "filename.c_str ()"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "filename.c_str ()",
            "&st"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::parseSingleConfigFile (const string &filename)\n  {\n      struct stat st;\n      if (stat (filename.c_str (), &st) != 0)\n      {\n  \ty2debug (\"Can't read dir entry file %s: %m\", filename.c_str ());\n  \treturn;\n      }\n  \n      if (!S_ISREG (st.st_mode) && !S_ISLNK (st.st_mode))\n  \treturn;\n  \n      FILE *file = fopen (filename.c_str (), \"r\");\n      if (!file)\n      {\n  \ty2debug (\"Can't open %s for reading: %m\", filename.c_str ());\n  \treturn;\n      }\n  \n      const int size = 250;\n      char line[size];\n  \n      while (fgets (line, size, file))\n      {\n  \t// delete last char (newline)\n  \tconst int l = strlen (line);\n  \tif (l > 0)\n  \t    line[l - 1] = '\\0';\n  \n  \tif (line[0] == '.')\n  \t{\n  \t    YCPPath path (line);\n  \t    SubAgents::iterator agent = findByPath (path);\n  \t    if (agent != agents.end ())\n  \t    {\n  \t\t// TODO promote more debugs to errors or warnings\n      \t\ty2warning (\"Ignoring re-registration of path '%s'\", path->toString ().c_str ());\n  \t\t// possible alternative: do not ignore\n  \t\t// - ok if the agent was not used yet (not mounted yet)\n  \t\t// - umount if mounted??\n  \t    }\n  \t    else\n  \t    {\n  \t\t// posible optimization:\n  \t\t// dont reparse the file\n  \t\tRegisterAgent (path, YCPString (filename));\n  \t    }\n  \t    break;\n  \t}\n      }\n  \n      fclose (file);\n  }\n}"
  },
  {
    "function_name": "parseConfigFiles",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "83-125",
    "snippet": "void\nScriptingAgent::parseConfigFiles (const string &directory)\n{\n    y2debug (\"Y2SCRComponent::parseConfigFiles (%s)\", directory.c_str ());\n\n    DIR *dir = opendir (directory.c_str ());\n    if (!dir)\n    {\n\ty2debug (\"Can't open directory %s for reading: %m\", directory.c_str ());\n\treturn;\n    }\n\n    struct dirent *entry;\n    // Access the files in inode order, hopefully this reduces disk seeks\n    // Use a list and sort it (or not).\n    // typedef map<ino_t, string> sorted_names_t;\n    typedef list<pair<ino_t, string> > sorted_names_t;\n    sorted_names_t sorted_names;\n    while ((entry = readdir (dir)))\n    {\n\tchar *n = entry->d_name;\n\t// Read only *.scr files. For example TRANS.TBL makes problems\n\tif (strlen (n) <= 4 ||\n\t    strcmp (n + strlen (n) - 4, \".scr\"))\n\t    continue;\n\n\t// sorted_names[entry->d_ino] = n;\n\tsorted_names.push_back (make_pair (entry->d_ino, string(n)));\n    }\n\n    closedir (dir);\n\n    // TODO cache\n    if (!getenv (\"Y2SCRNOSORT\"))\n\tsorted_names.sort(less_than_inodes);\n\n    sorted_names_t::iterator i = sorted_names.begin (), e = sorted_names.end ();\n    for (; i != e; ++i)\n    {\n\tconst string filename = directory + \"/\" + i->second;\n\tparseSingleConfigFile (filename);\n    }\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parseSingleConfigFile",
          "args": [
            "filename"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "parseSingleConfigFile",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "128-181",
          "snippet": "void\nScriptingAgent::parseSingleConfigFile (const string &filename)\n{\n    struct stat st;\n    if (stat (filename.c_str (), &st) != 0)\n    {\n\ty2debug (\"Can't read dir entry file %s: %m\", filename.c_str ());\n\treturn;\n    }\n\n    if (!S_ISREG (st.st_mode) && !S_ISLNK (st.st_mode))\n\treturn;\n\n    FILE *file = fopen (filename.c_str (), \"r\");\n    if (!file)\n    {\n\ty2debug (\"Can't open %s for reading: %m\", filename.c_str ());\n\treturn;\n    }\n\n    const int size = 250;\n    char line[size];\n\n    while (fgets (line, size, file))\n    {\n\t// delete last char (newline)\n\tconst int l = strlen (line);\n\tif (l > 0)\n\t    line[l - 1] = '\\0';\n\n\tif (line[0] == '.')\n\t{\n\t    YCPPath path (line);\n\t    SubAgents::iterator agent = findByPath (path);\n\t    if (agent != agents.end ())\n\t    {\n\t\t// TODO promote more debugs to errors or warnings\n    \t\ty2warning (\"Ignoring re-registration of path '%s'\", path->toString ().c_str ());\n\t\t// possible alternative: do not ignore\n\t\t// - ok if the agent was not used yet (not mounted yet)\n\t\t// - umount if mounted??\n\t    }\n\t    else\n\t    {\n\t\t// posible optimization:\n\t\t// dont reparse the file\n\t\tRegisterAgent (path, YCPString (filename));\n\t    }\n\t    break;\n\t}\n    }\n\n    fclose (file);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::parseSingleConfigFile (const string &filename)\n  {\n      struct stat st;\n      if (stat (filename.c_str (), &st) != 0)\n      {\n  \ty2debug (\"Can't read dir entry file %s: %m\", filename.c_str ());\n  \treturn;\n      }\n  \n      if (!S_ISREG (st.st_mode) && !S_ISLNK (st.st_mode))\n  \treturn;\n  \n      FILE *file = fopen (filename.c_str (), \"r\");\n      if (!file)\n      {\n  \ty2debug (\"Can't open %s for reading: %m\", filename.c_str ());\n  \treturn;\n      }\n  \n      const int size = 250;\n      char line[size];\n  \n      while (fgets (line, size, file))\n      {\n  \t// delete last char (newline)\n  \tconst int l = strlen (line);\n  \tif (l > 0)\n  \t    line[l - 1] = '\\0';\n  \n  \tif (line[0] == '.')\n  \t{\n  \t    YCPPath path (line);\n  \t    SubAgents::iterator agent = findByPath (path);\n  \t    if (agent != agents.end ())\n  \t    {\n  \t\t// TODO promote more debugs to errors or warnings\n      \t\ty2warning (\"Ignoring re-registration of path '%s'\", path->toString ().c_str ());\n  \t\t// possible alternative: do not ignore\n  \t\t// - ok if the agent was not used yet (not mounted yet)\n  \t\t// - umount if mounted??\n  \t    }\n  \t    else\n  \t    {\n  \t\t// posible optimization:\n  \t\t// dont reparse the file\n  \t\tRegisterAgent (path, YCPString (filename));\n  \t    }\n  \t    break;\n  \t}\n      }\n  \n      fclose (file);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sorted_names.end",
          "args": [],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sorted_names.begin",
          "args": [],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sorted_names.sort",
          "args": [
            "less_than_inodes"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"Y2SCRNOSORT\""
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "closedir",
          "args": [
            "dir"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sorted_names.push_back",
          "args": [
            "make_pair (entry->d_ino, string(n))"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "push_back",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "70-74",
          "snippet": "void\nYCPListRep::push_back(const YCPValue& value)\n{\n    elements.push_back(value);\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  void\n  YCPListRep::push_back(const YCPValue& value)\n  {\n      elements.push_back(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_pair",
          "args": [
            "entry->d_ino",
            "string(n)"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "string",
          "args": [
            "n"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "29-37",
          "snippet": "string to_string (const YCPValue&v)\n{\n    string s;\n    if (v->isString ())\n\ts = v->asString ()->value ();\n    else\n\ts = v->toString ();\n    return s;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nstring to_string (const YCPValue&v)\n{\n    string s;\n    if (v->isString ())\n\ts = v->asString ()->value ();\n    else\n\ts = v->toString ();\n    return s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "n + strlen (n) - 4",
            "\".scr\""
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "n"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "n"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readdir",
          "args": [
            "dir"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Can't open directory %s for reading: %m\"",
            "directory.c_str ()"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "directory.c_str",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opendir",
          "args": [
            "directory.c_str ()"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "directory.c_str",
          "args": [],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Y2SCRComponent::parseConfigFiles (%s)\"",
            "directory.c_str ()"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "directory.c_str",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::parseConfigFiles (const string &directory)\n  {\n      y2debug (\"Y2SCRComponent::parseConfigFiles (%s)\", directory.c_str ());\n  \n      DIR *dir = opendir (directory.c_str ());\n      if (!dir)\n      {\n  \ty2debug (\"Can't open directory %s for reading: %m\", directory.c_str ());\n  \treturn;\n      }\n  \n      struct dirent *entry;\n      // Access the files in inode order, hopefully this reduces disk seeks\n      // Use a list and sort it (or not).\n      // typedef map<ino_t, string> sorted_names_t;\n      typedef list<pair<ino_t, string> > sorted_names_t;\n      sorted_names_t sorted_names;\n      while ((entry = readdir (dir)))\n      {\n  \tchar *n = entry->d_name;\n  \t// Read only *.scr files. For example TRANS.TBL makes problems\n  \tif (strlen (n) <= 4 ||\n  \t    strcmp (n + strlen (n) - 4, \".scr\"))\n  \t    continue;\n  \n  \t// sorted_names[entry->d_ino] = n;\n  \tsorted_names.push_back (make_pair (entry->d_ino, string(n)));\n      }\n  \n      closedir (dir);\n  \n      // TODO cache\n      if (!getenv (\"Y2SCRNOSORT\"))\n  \tsorted_names.sort(less_than_inodes);\n  \n      sorted_names_t::iterator i = sorted_names.begin (), e = sorted_names.end ();\n      for (; i != e; ++i)\n      {\n  \tconst string filename = directory + \"/\" + i->second;\n  \tparseSingleConfigFile (filename);\n      }\n  }\n}"
  },
  {
    "function_name": "less_than_inodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "77-81",
    "snippet": "bool less_than_inodes (const pair<ino_t, string>& a,\n\t\t       const pair<ino_t, string>& b)\n{\n    return a.first < b.first;\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nbool less_than_inodes (const pair<ino_t, string>& a,\n\t\t       const pair<ino_t, string>& b)\n{\n    return a.first < b.first;\n}"
  },
  {
    "function_name": "~ScriptingAgent",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "72-75",
    "snippet": "ScriptingAgent::~ScriptingAgent ()\n{\n    UnregisterAllAgents ();\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "UnregisterAllAgents",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "UnregisterAllAgents",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "352-367",
          "snippet": "YCPBoolean\nScriptingAgent::UnregisterAllAgents ()\n{\n    // an automatic sweep would undo this call.\n    // use RegisterNewAgents if you want that.\n    done_sweep = true;\n    for (SubAgents::iterator agent = agents.begin (); agent != agents.end ();\n\t ++agent)\n    {\n\ty2debug (\"Path '%s' unregistered\",\n\t\t (*agent)->get_path ()->toString ().c_str ());\n        delete *agent;\n    }\n    agents.clear ();\n    return YCPBoolean (true);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  YCPBoolean\n  ScriptingAgent::UnregisterAllAgents ()\n  {\n      // an automatic sweep would undo this call.\n      // use RegisterNewAgents if you want that.\n      done_sweep = true;\n      for (SubAgents::iterator agent = agents.begin (); agent != agents.end ();\n  \t ++agent)\n      {\n  \ty2debug (\"Path '%s' unregistered\",\n  \t\t (*agent)->get_path ()->toString ().c_str ());\n          delete *agent;\n      }\n      agents.clear ();\n      return YCPBoolean (true);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  ScriptingAgent::~ScriptingAgent ()\n  {\n      UnregisterAllAgents ();\n  }\n}"
  },
  {
    "function_name": "InitRegDirs",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "47-69",
    "snippet": "void\nScriptingAgent::InitRegDirs ()\n{\n    for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n\t level++)\n    {\n\tRegistrationDir rd;\n\trd.last_changed = 0;\t// very old\n\trd.name = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n\ty2debug( \"Scripting agent searching SCRs in %s\", rd.name.c_str() );\n//\tparseConfigFiles (rd.name);\n\t\n\tstruct stat st;\n\tif (stat (rd.name.c_str(), &st) != 0) {\n\t    y2debug (\"Can't read dir %s: %m\", rd.name.c_str ());\n\t}\n\telse {\n\t    y2debug (\"Agent registration: %s last changed at %s\",\n\t\t\t rd.name.c_str(), ctime (&rd.last_changed));\n\t    registration_dirs.push_back (rd);\n\t}\n    }\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "registration_dirs.push_back",
          "args": [
            "rd"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "push_back",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "70-74",
          "snippet": "void\nYCPListRep::push_back(const YCPValue& value)\n{\n    elements.push_back(value);\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  void\n  YCPListRep::push_back(const YCPValue& value)\n  {\n      elements.push_back(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Agent registration: %s last changed at %s\"",
            "rd.name.c_str()",
            "ctime (&rd.last_changed)"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ctime",
          "args": [
            "&rd.last_changed"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rd.name.c_str",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Can't read dir %s: %m\"",
            "rd.name.c_str ()"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rd.name.c_str",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "rd.name.c_str()",
            "&st"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rd.name.c_str",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Scripting agent searching SCRs in %s\"",
            "rd.name.c_str()"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rd.name.c_str",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Y2PathSearch::searchPath",
          "args": [
            "Y2PathSearch::GENERIC",
            "level"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "searchPath",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "93-128",
          "snippet": "string\nY2PathSearch::searchPath (WHAT what, int level)\n{\n    initializePaths();\n\n    int levels = paths.size();\n\n    switch (what)\n    {\n\tcase EXECCOMP:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn EXECCOMPDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level];\n\t    }\n\tbreak;\n\n\tcase PLUGIN:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn PLUGINDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level] + \"/plugin\";\n\t    }\n\tbreak;\n\n\tdefault:\n\tbreak;\n    }\n    return paths[level];\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<string> Y2PathSearch::paths;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  string\n  Y2PathSearch::searchPath (WHAT what, int level)\n  {\n      initializePaths();\n  \n      int levels = paths.size();\n  \n      switch (what)\n      {\n  \tcase EXECCOMP:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn EXECCOMPDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level];\n  \t    }\n  \tbreak;\n  \n  \tcase PLUGIN:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn PLUGINDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level] + \"/plugin\";\n  \t    }\n  \tbreak;\n  \n  \tdefault:\n  \tbreak;\n      }\n      return paths[level];\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Y2PathSearch::numberOfComponentLevels",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "numberOfComponentLevels",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "85-90",
          "snippet": "int\nY2PathSearch::numberOfComponentLevels()\n{\n    initializePaths();\n    return paths.size();\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<string> Y2PathSearch::paths;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  int\n  Y2PathSearch::numberOfComponentLevels()\n  {\n      initializePaths();\n      return paths.size();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::InitRegDirs ()\n  {\n      for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n  \t level++)\n      {\n  \tRegistrationDir rd;\n  \trd.last_changed = 0;\t// very old\n  \trd.name = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n  \ty2debug( \"Scripting agent searching SCRs in %s\", rd.name.c_str() );\n  //\tparseConfigFiles (rd.name);\n  \t\n  \tstruct stat st;\n  \tif (stat (rd.name.c_str(), &st) != 0) {\n  \t    y2debug (\"Can't read dir %s: %m\", rd.name.c_str ());\n  \t}\n  \telse {\n  \t    y2debug (\"Agent registration: %s last changed at %s\",\n  \t\t\t rd.name.c_str(), ctime (&rd.last_changed));\n  \t    registration_dirs.push_back (rd);\n  \t}\n      }\n  }\n}"
  },
  {
    "function_name": "ScriptingAgent",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "38-45",
    "snippet": "ScriptingAgent::ScriptingAgent (const string& file)\n    : done_sweep (false)\n{\n    InitRegDirs ();\n    y2debug( \"Scripting agent using only SCR %s\", file.c_str () );\n    \n    parseSingleConfigFile (file);\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parseSingleConfigFile",
          "args": [
            "file"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "parseSingleConfigFile",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "128-181",
          "snippet": "void\nScriptingAgent::parseSingleConfigFile (const string &filename)\n{\n    struct stat st;\n    if (stat (filename.c_str (), &st) != 0)\n    {\n\ty2debug (\"Can't read dir entry file %s: %m\", filename.c_str ());\n\treturn;\n    }\n\n    if (!S_ISREG (st.st_mode) && !S_ISLNK (st.st_mode))\n\treturn;\n\n    FILE *file = fopen (filename.c_str (), \"r\");\n    if (!file)\n    {\n\ty2debug (\"Can't open %s for reading: %m\", filename.c_str ());\n\treturn;\n    }\n\n    const int size = 250;\n    char line[size];\n\n    while (fgets (line, size, file))\n    {\n\t// delete last char (newline)\n\tconst int l = strlen (line);\n\tif (l > 0)\n\t    line[l - 1] = '\\0';\n\n\tif (line[0] == '.')\n\t{\n\t    YCPPath path (line);\n\t    SubAgents::iterator agent = findByPath (path);\n\t    if (agent != agents.end ())\n\t    {\n\t\t// TODO promote more debugs to errors or warnings\n    \t\ty2warning (\"Ignoring re-registration of path '%s'\", path->toString ().c_str ());\n\t\t// possible alternative: do not ignore\n\t\t// - ok if the agent was not used yet (not mounted yet)\n\t\t// - umount if mounted??\n\t    }\n\t    else\n\t    {\n\t\t// posible optimization:\n\t\t// dont reparse the file\n\t\tRegisterAgent (path, YCPString (filename));\n\t    }\n\t    break;\n\t}\n    }\n\n    fclose (file);\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::parseSingleConfigFile (const string &filename)\n  {\n      struct stat st;\n      if (stat (filename.c_str (), &st) != 0)\n      {\n  \ty2debug (\"Can't read dir entry file %s: %m\", filename.c_str ());\n  \treturn;\n      }\n  \n      if (!S_ISREG (st.st_mode) && !S_ISLNK (st.st_mode))\n  \treturn;\n  \n      FILE *file = fopen (filename.c_str (), \"r\");\n      if (!file)\n      {\n  \ty2debug (\"Can't open %s for reading: %m\", filename.c_str ());\n  \treturn;\n      }\n  \n      const int size = 250;\n      char line[size];\n  \n      while (fgets (line, size, file))\n      {\n  \t// delete last char (newline)\n  \tconst int l = strlen (line);\n  \tif (l > 0)\n  \t    line[l - 1] = '\\0';\n  \n  \tif (line[0] == '.')\n  \t{\n  \t    YCPPath path (line);\n  \t    SubAgents::iterator agent = findByPath (path);\n  \t    if (agent != agents.end ())\n  \t    {\n  \t\t// TODO promote more debugs to errors or warnings\n      \t\ty2warning (\"Ignoring re-registration of path '%s'\", path->toString ().c_str ());\n  \t\t// possible alternative: do not ignore\n  \t\t// - ok if the agent was not used yet (not mounted yet)\n  \t\t// - umount if mounted??\n  \t    }\n  \t    else\n  \t    {\n  \t\t// posible optimization:\n  \t\t// dont reparse the file\n  \t\tRegisterAgent (path, YCPString (filename));\n  \t    }\n  \t    break;\n  \t}\n      }\n  \n      fclose (file);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Scripting agent using only SCR %s\"",
            "file.c_str ()"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file.c_str",
          "args": [],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InitRegDirs",
          "args": [],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "InitRegDirs",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "47-69",
          "snippet": "void\nScriptingAgent::InitRegDirs ()\n{\n    for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n\t level++)\n    {\n\tRegistrationDir rd;\n\trd.last_changed = 0;\t// very old\n\trd.name = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n\ty2debug( \"Scripting agent searching SCRs in %s\", rd.name.c_str() );\n//\tparseConfigFiles (rd.name);\n\t\n\tstruct stat st;\n\tif (stat (rd.name.c_str(), &st) != 0) {\n\t    y2debug (\"Can't read dir %s: %m\", rd.name.c_str ());\n\t}\n\telse {\n\t    y2debug (\"Agent registration: %s last changed at %s\",\n\t\t\t rd.name.c_str(), ctime (&rd.last_changed));\n\t    registration_dirs.push_back (rd);\n\t}\n    }\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::InitRegDirs ()\n  {\n      for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n  \t level++)\n      {\n  \tRegistrationDir rd;\n  \trd.last_changed = 0;\t// very old\n  \trd.name = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n  \ty2debug( \"Scripting agent searching SCRs in %s\", rd.name.c_str() );\n  //\tparseConfigFiles (rd.name);\n  \t\n  \tstruct stat st;\n  \tif (stat (rd.name.c_str(), &st) != 0) {\n  \t    y2debug (\"Can't read dir %s: %m\", rd.name.c_str ());\n  \t}\n  \telse {\n  \t    y2debug (\"Agent registration: %s last changed at %s\",\n  \t\t\t rd.name.c_str(), ctime (&rd.last_changed));\n  \t    registration_dirs.push_back (rd);\n  \t}\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  ScriptingAgent::ScriptingAgent (const string& file)\n      : done_sweep (false)\n  {\n      InitRegDirs ();\n      y2debug( \"Scripting agent using only SCR %s\", file.c_str () );\n      \n      parseSingleConfigFile (file);\n  }\n}"
  },
  {
    "function_name": "ScriptingAgent",
    "container": "ScriptingAgent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
    "lines": "28-35",
    "snippet": "ScriptingAgent::ScriptingAgent ()\n    : done_sweep (false)\n{\n    InitRegDirs ();\n    // to test the old behavior\n    if (getenv (\"Y2SCRSWEEP\"))\n\tSweep ();\n}",
    "includes": [
      "#include \"ScriptingAgent.h\"",
      "#include <y2/Y2ComponentBroker.h>",
      "#include <ycp/pathsearch.h>",
      "#include <ycp/y2log.h>",
      "#include <algorithm>",
      "#include <sys/stat.h>",
      "#include <dirent.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Sweep",
          "args": [],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "Sweep",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "427-440",
          "snippet": "void\nScriptingAgent::Sweep ()\n{\n    extern ExecutionEnvironment ee;\n    ycp2warning (ee.filename().c_str(), ee.linenumber(), \"Scripting agent sweeping\");\n    for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n\t level++)\n    {\n\tstring dir = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n\ty2debug( \"Scripting agent searching SCRs in %s\", dir.c_str() );\n\tparseConfigFiles (dir);\n    }\n    done_sweep = true;\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::Sweep ()\n  {\n      extern ExecutionEnvironment ee;\n      ycp2warning (ee.filename().c_str(), ee.linenumber(), \"Scripting agent sweeping\");\n      for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n  \t level++)\n      {\n  \tstring dir = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n  \ty2debug( \"Scripting agent searching SCRs in %s\", dir.c_str() );\n  \tparseConfigFiles (dir);\n      }\n      done_sweep = true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"Y2SCRSWEEP\""
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InitRegDirs",
          "args": [],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "InitRegDirs",
          "container": "ScriptingAgent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/scr/src/ScriptingAgent.cc",
          "lines": "47-69",
          "snippet": "void\nScriptingAgent::InitRegDirs ()\n{\n    for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n\t level++)\n    {\n\tRegistrationDir rd;\n\trd.last_changed = 0;\t// very old\n\trd.name = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n\ty2debug( \"Scripting agent searching SCRs in %s\", rd.name.c_str() );\n//\tparseConfigFiles (rd.name);\n\t\n\tstruct stat st;\n\tif (stat (rd.name.c_str(), &st) != 0) {\n\t    y2debug (\"Can't read dir %s: %m\", rd.name.c_str ());\n\t}\n\telse {\n\t    y2debug (\"Agent registration: %s last changed at %s\",\n\t\t\t rd.name.c_str(), ctime (&rd.last_changed));\n\t    registration_dirs.push_back (rd);\n\t}\n    }\n}",
          "includes": [
            "#include \"ScriptingAgent.h\"",
            "#include <y2/Y2ComponentBroker.h>",
            "#include <ycp/pathsearch.h>",
            "#include <ycp/y2log.h>",
            "#include <algorithm>",
            "#include <sys/stat.h>",
            "#include <dirent.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  void\n  ScriptingAgent::InitRegDirs ()\n  {\n      for (int level = 0; level < Y2PathSearch::numberOfComponentLevels ();\n  \t level++)\n      {\n  \tRegistrationDir rd;\n  \trd.last_changed = 0;\t// very old\n  \trd.name = Y2PathSearch::searchPath (Y2PathSearch::GENERIC, level) + \"/scrconf\";\n  \ty2debug( \"Scripting agent searching SCRs in %s\", rd.name.c_str() );\n  //\tparseConfigFiles (rd.name);\n  \t\n  \tstruct stat st;\n  \tif (stat (rd.name.c_str(), &st) != 0) {\n  \t    y2debug (\"Can't read dir %s: %m\", rd.name.c_str ());\n  \t}\n  \telse {\n  \t    y2debug (\"Agent registration: %s last changed at %s\",\n  \t\t\t rd.name.c_str(), ctime (&rd.last_changed));\n  \t    registration_dirs.push_back (rd);\n  \t}\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ScriptingAgent.h\"\n#include <y2/Y2ComponentBroker.h>\n#include <ycp/pathsearch.h>\n#include <ycp/y2log.h>\n#include <algorithm>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <string.h>\n#include <stdio.h>\n#include <errno.h>\n\nScriptingAgent {\n  ScriptingAgent::ScriptingAgent ()\n      : done_sweep (false)\n  {\n      InitRegDirs ();\n      // to test the old behavior\n      if (getenv (\"Y2SCRSWEEP\"))\n  \tSweep ();\n  }\n}"
  }
]