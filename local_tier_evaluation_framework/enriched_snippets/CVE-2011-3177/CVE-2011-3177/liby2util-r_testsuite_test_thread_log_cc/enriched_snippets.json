[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/testsuite/test_thread_log.cc",
    "lines": "25-46",
    "snippet": "int main (int argc, char *argv[])\n{\n   pthread_t threads[NUM_THREADS];\n\n   // enable collecting y2debug messages\n   setenv(\"Y2DEBUGONCRASH\", \"1\", 1 /*overwrite*/);\n   ticks = argc>1? atoi(argv[1]): 1000;\n   int rc;\n   intptr_t t;\n   for(t=1; t<=NUM_THREADS; t++){\n      printf(\"In main: creating thread %p\\n\", (void*)t);\n      rc = pthread_create(&threads[t-1], NULL, PrintHello, (void *)t);\n  \n      if (rc){\n         printf(\"ERROR; return code from pthread_create() is %d\\n\", rc);\n\t return 1;\n      }\n   }\n   pthread_exit(NULL);\n   // if the bug exists, the program crashes before it can exit succesfully\n   return 0;\n}",
    "includes": [
      "#include <y2util/y2log.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>"
    ],
    "macros_used": [
      "#define NUM_THREADS     5"
    ],
    "globals_used": [
      "int ticks;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_exit",
          "args": [
            "NULL"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ERROR; return code from pthread_create() is %d\\n\"",
            "rc"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_create",
          "args": [
            "&threads[t-1]",
            "NULL",
            "PrintHello",
            "(void *)t"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"In main: creating thread %p\\n\"",
            "(void*)t"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "argv[1]"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setenv",
          "args": [
            "\"Y2DEBUGONCRASH\"",
            "\"1\"",
            "1/*overwrite*/"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <y2util/y2log.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n\n#define NUM_THREADS     5\n\nint ticks;\n\nint main (int argc, char *argv[])\n{\n   pthread_t threads[NUM_THREADS];\n\n   // enable collecting y2debug messages\n   setenv(\"Y2DEBUGONCRASH\", \"1\", 1 /*overwrite*/);\n   ticks = argc>1? atoi(argv[1]): 1000;\n   int rc;\n   intptr_t t;\n   for(t=1; t<=NUM_THREADS; t++){\n      printf(\"In main: creating thread %p\\n\", (void*)t);\n      rc = pthread_create(&threads[t-1], NULL, PrintHello, (void *)t);\n  \n      if (rc){\n         printf(\"ERROR; return code from pthread_create() is %d\\n\", rc);\n\t return 1;\n      }\n   }\n   pthread_exit(NULL);\n   // if the bug exists, the program crashes before it can exit succesfully\n   return 0;\n}"
  }
]