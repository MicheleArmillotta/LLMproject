[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/testsuite/testscope.cc",
    "lines": "26-106",
    "snippet": "int\nmain (int argc, const char *argv[])\n{\n    YCPScope scope;\n\n    string name = \"toplevel\";\n    string nextname = \"sublevel\";\n    scope.openScope ();\n\n    const string symname = \"i\";\n    const YCPDeclaration symdecl = YCPDeclType (YT_INTEGER);\n    YCPValue symvalue = YCPInteger (42);\n    YCPValue newvalue = YCPInteger (13);\n    YCPList dumparg = YCPList();\n    dumparg->add (symvalue);\n\n    scope.declareSymbol (symname, symdecl, symvalue, false);\n\n    if (!scope.symbolDeclared (symname))\n    {\n\tprintf (\"Not declared\\n\");\n    }\nprintf (\"first dump\\n\"); fflush (stdout);\n    scope.dumpScope (dumparg);\n\n    if (symvalue->compare (scope.lookupValue (symname, \"\")) != YO_EQUAL)\n    {\n\tprintf (\"Bad value\\n\");\n    }\n\n    if (symdecl->compare (scope.lookupDeclaration (symname)) != YO_EQUAL)\n    {\n\tprintf (\"Bad declaration\\n\");\n    }\n\n    // subscope\n\n    scope.openScope ();\n    scope.declareSymbol (symname, symdecl, newvalue, false);\n\n    if (!scope.symbolDeclared (symname))\n    {\n\tprintf (\"Not declared\\n\");\n    }\nprintf (\"second dump\\n\"); fflush (stdout);\n    scope.dumpScope (dumparg);\n\n    if (newvalue->compare (scope.lookupValue (symname, \"\")) != YO_EQUAL)\n    {\n\tprintf (\"Bad sub value\\n\");\n    }\n\n    if (symdecl->compare (scope.lookupDeclaration (symname)) != YO_EQUAL)\n    {\n\tprintf (\"Bad sub declaration\\n\");\n    }\n\n    scope.assignSymbol (symname, newvalue);\n    if (newvalue->compare (scope.lookupValue (symname, \"\")) != YO_EQUAL)\n    {\n\tprintf (\"Bad newvalue\\n\");\n    }\nprintf (\"Closing subscope\\n\");\n    scope.closeScope();\n\n    if (symvalue->compare (scope.lookupValue (symname, \"\")) != YO_EQUAL)\n    {\n\tprintf (\"Bad value\\n\");\n    }\n\nprintf (\"remove toplevel i\\n\");\n    scope.removeSymbol (symname);\n\n    if (scope.symbolDeclared (symname))\n    {\n\tprintf (\"Still declared\\n\");\n    }\n\n    scope.closeScope();\n    return 0;\n}",
    "includes": [
      "#include <ycp/y2log.h>",
      "#include <ycp/YCPScope.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scope.closeScope",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Still declared\\n\""
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.symbolDeclared",
          "args": [
            "symname"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.removeSymbol",
          "args": [
            "symname"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"remove toplevel i\\n\""
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Bad value\\n\""
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "symvalue->compare",
          "args": [
            "scope.lookupValue (symname, \"\")"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "compare",
          "container": "YCPSymbolRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPSymbol.cc",
          "lines": "54-59",
          "snippet": "YCPOrder\nYCPSymbolRep::compare(const YCPSymbol& s) const\n{\n    if (v == s->v) return YO_EQUAL;\n    else return v < s->v ? YO_LESS : YO_GREATER;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/y2log.h\"\n\nYCPSymbolRep {\n  YCPOrder\n  YCPSymbolRep::compare(const YCPSymbol& s) const\n  {\n      if (v == s->v) return YO_EQUAL;\n      else return v < s->v ? YO_LESS : YO_GREATER;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "scope.lookupValue",
          "args": [
            "symname",
            "\"\""
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.closeScope",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Closing subscope\\n\""
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Bad newvalue\\n\""
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.lookupValue",
          "args": [
            "symname",
            "\"\""
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.assignSymbol",
          "args": [
            "symname",
            "newvalue"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Bad sub declaration\\n\""
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.lookupDeclaration",
          "args": [
            "symname"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Bad sub value\\n\""
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.lookupValue",
          "args": [
            "symname",
            "\"\""
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.dumpScope",
          "args": [
            "dumparg"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "stdout"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"second dump\\n\""
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Not declared\\n\""
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.symbolDeclared",
          "args": [
            "symname"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.declareSymbol",
          "args": [
            "symname",
            "symdecl",
            "newvalue",
            "false"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.openScope",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Bad declaration\\n\""
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.lookupDeclaration",
          "args": [
            "symname"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Bad value\\n\""
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.lookupValue",
          "args": [
            "symname",
            "\"\""
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.dumpScope",
          "args": [
            "dumparg"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "stdout"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"first dump\\n\""
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Not declared\\n\""
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.symbolDeclared",
          "args": [
            "symname"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.declareSymbol",
          "args": [
            "symname",
            "symdecl",
            "symvalue",
            "false"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dumparg->add",
          "args": [
            "symvalue"
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPList",
          "args": [],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "commaList",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "254-265",
          "snippet": "string\nYCPListRep::commaList() const\n{\n    string ret;\n\n    for (unsigned index = 0; index < elements.size(); index++)\n    {\n\tif (index != 0) ret += \", \";\n\tret += elements[index].isNull() ? \"(null)\" : elements[index]->toString();\n    }\n    return ret;\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  string\n  YCPListRep::commaList() const\n  {\n      string ret;\n  \n      for (unsigned index = 0; index < elements.size(); index++)\n      {\n  \tif (index != 0) ret += \", \";\n  \tret += elements[index].isNull() ? \"(null)\" : elements[index]->toString();\n      }\n      return ret;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPInteger",
          "args": [
            "13"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "YCPInteger",
          "container": "YCPInteger",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
          "lines": "142-145",
          "snippet": "YCPInteger::YCPInteger (bytecodeistream & str)\n    : YCPValue (new YCPIntegerRep (fromStream (str)))\n{\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nYCPInteger {\n  YCPInteger::YCPInteger (bytecodeistream & str)\n      : YCPValue (new YCPIntegerRep (fromStream (str)))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPDeclType",
          "args": [
            "YT_INTEGER"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.openScope",
          "args": [],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ycp/y2log.h>\n#include <ycp/YCPScope.h>\n#include <stdio.h>\n\nint\nmain (int argc, const char *argv[])\n{\n    YCPScope scope;\n\n    string name = \"toplevel\";\n    string nextname = \"sublevel\";\n    scope.openScope ();\n\n    const string symname = \"i\";\n    const YCPDeclaration symdecl = YCPDeclType (YT_INTEGER);\n    YCPValue symvalue = YCPInteger (42);\n    YCPValue newvalue = YCPInteger (13);\n    YCPList dumparg = YCPList();\n    dumparg->add (symvalue);\n\n    scope.declareSymbol (symname, symdecl, symvalue, false);\n\n    if (!scope.symbolDeclared (symname))\n    {\n\tprintf (\"Not declared\\n\");\n    }\nprintf (\"first dump\\n\"); fflush (stdout);\n    scope.dumpScope (dumparg);\n\n    if (symvalue->compare (scope.lookupValue (symname, \"\")) != YO_EQUAL)\n    {\n\tprintf (\"Bad value\\n\");\n    }\n\n    if (symdecl->compare (scope.lookupDeclaration (symname)) != YO_EQUAL)\n    {\n\tprintf (\"Bad declaration\\n\");\n    }\n\n    // subscope\n\n    scope.openScope ();\n    scope.declareSymbol (symname, symdecl, newvalue, false);\n\n    if (!scope.symbolDeclared (symname))\n    {\n\tprintf (\"Not declared\\n\");\n    }\nprintf (\"second dump\\n\"); fflush (stdout);\n    scope.dumpScope (dumparg);\n\n    if (newvalue->compare (scope.lookupValue (symname, \"\")) != YO_EQUAL)\n    {\n\tprintf (\"Bad sub value\\n\");\n    }\n\n    if (symdecl->compare (scope.lookupDeclaration (symname)) != YO_EQUAL)\n    {\n\tprintf (\"Bad sub declaration\\n\");\n    }\n\n    scope.assignSymbol (symname, newvalue);\n    if (newvalue->compare (scope.lookupValue (symname, \"\")) != YO_EQUAL)\n    {\n\tprintf (\"Bad newvalue\\n\");\n    }\nprintf (\"Closing subscope\\n\");\n    scope.closeScope();\n\n    if (symvalue->compare (scope.lookupValue (symname, \"\")) != YO_EQUAL)\n    {\n\tprintf (\"Bad value\\n\");\n    }\n\nprintf (\"remove toplevel i\\n\");\n    scope.removeSymbol (symname);\n\n    if (scope.symbolDeclared (symname))\n    {\n\tprintf (\"Still declared\\n\");\n    }\n\n    scope.closeScope();\n    return 0;\n}"
  }
]