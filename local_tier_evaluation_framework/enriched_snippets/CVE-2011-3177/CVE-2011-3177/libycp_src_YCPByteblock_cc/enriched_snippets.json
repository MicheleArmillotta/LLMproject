[
  {
    "function_name": "YCPByteblock",
    "container": "YCPByteblock",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPByteblock.cc",
    "lines": "161-164",
    "snippet": "YCPByteblock::YCPByteblock (bytecodeistream & str)\n    : YCPValue (new YCPByteblockRep (str, fromStream (str)))\n{\n}",
    "includes": [
      "#include \"Xmlcode.h\"",
      "#include \"Bytecode.h\"",
      "#include \"YCPByteblock.h\"",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fromStream",
          "args": [
            "str"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "fromStream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPByteblock.cc",
          "lines": "149-158",
          "snippet": "static int\nfromStream (bytecodeistream & str)\n{\n    u_int32_t len = Bytecode::readInt32 (str);\n    if (str.good())\n    {\n\treturn len;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"Xmlcode.h\"",
            "#include \"Bytecode.h\"",
            "#include \"YCPByteblock.h\"",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPByteblock.h\"\n#include <ycp/y2log.h>\n\nstatic int\nfromStream (bytecodeistream & str)\n{\n    u_int32_t len = Bytecode::readInt32 (str);\n    if (str.good())\n    {\n\treturn len;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPByteblock.h\"\n#include <ycp/y2log.h>\n\nYCPByteblock {\n  YCPByteblock::YCPByteblock (bytecodeistream & str)\n      : YCPValue (new YCPByteblockRep (str, fromStream (str)))\n  {\n  }\n}"
  },
  {
    "function_name": "fromStream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPByteblock.cc",
    "lines": "149-158",
    "snippet": "static int\nfromStream (bytecodeistream & str)\n{\n    u_int32_t len = Bytecode::readInt32 (str);\n    if (str.good())\n    {\n\treturn len;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"Xmlcode.h\"",
      "#include \"Bytecode.h\"",
      "#include \"YCPByteblock.h\"",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "str.good",
          "args": [],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Bytecode::readInt32",
          "args": [
            "str"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "readInt32",
          "container": "Bytecode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/Bytecode.cc",
          "lines": "189-213",
          "snippet": "u_int32_t\nBytecode::readInt32 (bytecodeistream & str)\n{\n//    char c;\n//    str.get (c);\n//    if (c != 4)\n//    {\n//\treturn false;\n//    }\n\n    char v[5];\n\n    str.read (v, 5);\n    if (v[0] != 4)\n    {\n\treturn false;\n    }\n\n    u_int32_t cv, value = 0;\n    cv = (unsigned char)v[1]; value = cv;\n    cv = (unsigned char)v[2]; cv <<= 8; value |= cv;\n    cv = (unsigned char)v[3]; cv <<= 16; value |= cv;\n    cv = (unsigned char)v[4]; cv <<= 24; value |= cv;\n    return value;\n}",
          "includes": [
            "#include <ctype.h>",
            "#include <string.h>",
            "#include <errno.h>",
            "#include <fstream>",
            "#include \"ycp/pathsearch.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2/Y2Namespace.h\"",
            "#include \"ycp/YBlock.h\"",
            "#include \"ycp/YStatement.h\"",
            "#include \"ycp/YExpression.h\"",
            "#include \"ycp/YCode.h\"",
            "#include \"YCP.h\"",
            "#include \"ycp/Bytecode.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include <string.h>\n#include <errno.h>\n#include <fstream>\n#include \"ycp/pathsearch.h\"\n#include \"ycp/y2log.h\"\n#include \"y2/Y2Namespace.h\"\n#include \"ycp/YBlock.h\"\n#include \"ycp/YStatement.h\"\n#include \"ycp/YExpression.h\"\n#include \"ycp/YCode.h\"\n#include \"YCP.h\"\n#include \"ycp/Bytecode.h\"\n\nBytecode {\n  u_int32_t\n  Bytecode::readInt32 (bytecodeistream & str)\n  {\n  //    char c;\n  //    str.get (c);\n  //    if (c != 4)\n  //    {\n  //\treturn false;\n  //    }\n  \n      char v[5];\n  \n      str.read (v, 5);\n      if (v[0] != 4)\n      {\n  \treturn false;\n      }\n  \n      u_int32_t cv, value = 0;\n      cv = (unsigned char)v[1]; value = cv;\n      cv = (unsigned char)v[2]; cv <<= 8; value |= cv;\n      cv = (unsigned char)v[3]; cv <<= 16; value |= cv;\n      cv = (unsigned char)v[4]; cv <<= 24; value |= cv;\n      return value;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPByteblock.h\"\n#include <ycp/y2log.h>\n\nstatic int\nfromStream (bytecodeistream & str)\n{\n    u_int32_t len = Bytecode::readInt32 (str);\n    if (str.good())\n    {\n\treturn len;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "valuetype",
    "container": "YCPByteblockRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPByteblock.cc",
    "lines": "123-127",
    "snippet": "YCPValueType\nYCPByteblockRep::valuetype() const\n{\n    return YT_BYTEBLOCK;\n}",
    "includes": [
      "#include \"Xmlcode.h\"",
      "#include \"Bytecode.h\"",
      "#include \"YCPByteblock.h\"",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPByteblock.h\"\n#include <ycp/y2log.h>\n\nYCPByteblockRep {\n  YCPValueType\n  YCPByteblockRep::valuetype() const\n  {\n      return YT_BYTEBLOCK;\n  }\n}"
  },
  {
    "function_name": "toString",
    "container": "YCPByteblockRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPByteblock.cc",
    "lines": "92-120",
    "snippet": "string\nYCPByteblockRep::toString() const\n{\n    // Actually we do not separate the parts by newlines but by spaces.\n    // It is because external agents want every command on a single line.\n    // (Yes, they are stupid.)\n    const long bytes_per_line = 32L;\n    char line[bytes_per_line * 2 + 1];\n\n    string ret = \"#[\";\n    // avoid reallocation, we know the exact size beforehand\n    ret.reserve (2 +\n\t\t (len / bytes_per_line) * (bytes_per_line * 2 + 1) +\n\t\t (len % bytes_per_line) * (bytes_per_line * 2) +\n\t\t 1);\n    for (long i = 0; i < len; i += bytes_per_line)\n    {\n\tint bytes_this_line = min (bytes_per_line, len-i);\n\tfor (int j = 0; j < bytes_this_line; j++) {\n\t    line[j*2]   = tohex (bytes[i+j] >> 4);\n\t    line[j*2+1] = tohex (bytes[i+j] & 0x0f);\n\t}\n\tline[bytes_this_line * 2]=0;\n\tret += line;\n\tif (bytes_this_line == bytes_per_line) ret += \" \";\n    }\n    ret += \"]\";\n    return ret;\n}",
    "includes": [
      "#include \"Xmlcode.h\"",
      "#include \"Bytecode.h\"",
      "#include \"YCPByteblock.h\"",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tohex",
          "args": [
            "bytes[i+j] & 0x0f"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "tohex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPByteblock.cc",
          "lines": "84-89",
          "snippet": "inline char\ntohex(int n)\n{\n    if (n < 10) return n + '0';\n    else return n - 10 + 'A';\n}",
          "includes": [
            "#include \"Xmlcode.h\"",
            "#include \"Bytecode.h\"",
            "#include \"YCPByteblock.h\"",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPByteblock.h\"\n#include <ycp/y2log.h>\n\ninline char\ntohex(int n)\n{\n    if (n < 10) return n + '0';\n    else return n - 10 + 'A';\n}"
        }
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "bytes_per_line",
            "len-i"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "i_minus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPBuiltinInteger.cc",
          "lines": "51-67",
          "snippet": "static YCPValue\ni_minus (const YCPInteger &i1, const YCPInteger &i2)\n{\n    /**\n     * @operator integer i1 - integer i2 -> integer\n     * Subtraction of integers.\n     *\n     * Example: <pre>\n     * 1 - 2 -> -1\n     * </pre>\n     */\n\n    if (i1.isNull () || i2.isNull ())\n\treturn YCPNull ();\n\n    return YCPInteger (i1->value() - i2->value());\n}",
          "includes": [
            "#include \"y2log.h\"",
            "#include \"ycp/StaticDeclaration.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBuiltinInteger.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"y2log.h\"\n#include \"ycp/StaticDeclaration.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBuiltinInteger.h\"\n\nstatic YCPValue\ni_minus (const YCPInteger &i1, const YCPInteger &i2)\n{\n    /**\n     * @operator integer i1 - integer i2 -> integer\n     * Subtraction of integers.\n     *\n     * Example: <pre>\n     * 1 - 2 -> -1\n     * </pre>\n     */\n\n    if (i1.isNull () || i2.isNull ())\n\treturn YCPNull ();\n\n    return YCPInteger (i1->value() - i2->value());\n}"
        }
      },
      {
        "call_info": {
          "callee": "ret.reserve",
          "args": [
            "2 +\n\t\t (len / bytes_per_line) * (bytes_per_line * 2 + 1) +\n\t\t (len % bytes_per_line) * (bytes_per_line * 2) +\n\t\t 1"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "117-121",
          "snippet": "void\nYCPTermRep::reserve (int size)\n{\n    l->reserve (size);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::reserve (int size)\n  {\n      l->reserve (size);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPByteblock.h\"\n#include <ycp/y2log.h>\n\nYCPByteblockRep {\n  string\n  YCPByteblockRep::toString() const\n  {\n      // Actually we do not separate the parts by newlines but by spaces.\n      // It is because external agents want every command on a single line.\n      // (Yes, they are stupid.)\n      const long bytes_per_line = 32L;\n      char line[bytes_per_line * 2 + 1];\n  \n      string ret = \"#[\";\n      // avoid reallocation, we know the exact size beforehand\n      ret.reserve (2 +\n  \t\t (len / bytes_per_line) * (bytes_per_line * 2 + 1) +\n  \t\t (len % bytes_per_line) * (bytes_per_line * 2) +\n  \t\t 1);\n      for (long i = 0; i < len; i += bytes_per_line)\n      {\n  \tint bytes_this_line = min (bytes_per_line, len-i);\n  \tfor (int j = 0; j < bytes_this_line; j++) {\n  \t    line[j*2]   = tohex (bytes[i+j] >> 4);\n  \t    line[j*2+1] = tohex (bytes[i+j] & 0x0f);\n  \t}\n  \tline[bytes_this_line * 2]=0;\n  \tret += line;\n  \tif (bytes_this_line == bytes_per_line) ret += \" \";\n      }\n      ret += \"]\";\n      return ret;\n  }\n}"
  },
  {
    "function_name": "tohex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPByteblock.cc",
    "lines": "84-89",
    "snippet": "inline char\ntohex(int n)\n{\n    if (n < 10) return n + '0';\n    else return n - 10 + 'A';\n}",
    "includes": [
      "#include \"Xmlcode.h\"",
      "#include \"Bytecode.h\"",
      "#include \"YCPByteblock.h\"",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPByteblock.h\"\n#include <ycp/y2log.h>\n\ninline char\ntohex(int n)\n{\n    if (n < 10) return n + '0';\n    else return n - 10 + 'A';\n}"
  },
  {
    "function_name": "compare",
    "container": "YCPByteblockRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPByteblock.cc",
    "lines": "67-81",
    "snippet": "YCPOrder\nYCPByteblockRep::compare (const YCPByteblock& s) const\n{\n    // first compare sizes, than content. This is no lexical order.\n\n    if      (len < s->len) return YO_LESS;\n    else if (len > s->len) return YO_GREATER;\n    else {\n\tfor (long i=0; i<len; i++) {\n\t    if      (bytes[i] < s->bytes[i]) return YO_LESS;\n\t    else if (bytes[i] > s->bytes[i]) return YO_GREATER;\n\t}\n\treturn YO_EQUAL;\n    }\n}",
    "includes": [
      "#include \"Xmlcode.h\"",
      "#include \"Bytecode.h\"",
      "#include \"YCPByteblock.h\"",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPByteblock.h\"\n#include <ycp/y2log.h>\n\nYCPByteblockRep {\n  YCPOrder\n  YCPByteblockRep::compare (const YCPByteblock& s) const\n  {\n      // first compare sizes, than content. This is no lexical order.\n  \n      if      (len < s->len) return YO_LESS;\n      else if (len > s->len) return YO_GREATER;\n      else {\n  \tfor (long i=0; i<len; i++) {\n  \t    if      (bytes[i] < s->bytes[i]) return YO_LESS;\n  \t    else if (bytes[i] > s->bytes[i]) return YO_GREATER;\n  \t}\n  \treturn YO_EQUAL;\n      }\n  }\n}"
  },
  {
    "function_name": "size",
    "container": "YCPByteblockRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPByteblock.cc",
    "lines": "59-63",
    "snippet": "long\nYCPByteblockRep::size() const\n{\n    return len;\n}",
    "includes": [
      "#include \"Xmlcode.h\"",
      "#include \"Bytecode.h\"",
      "#include \"YCPByteblock.h\"",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPByteblock.h\"\n#include <ycp/y2log.h>\n\nYCPByteblockRep {\n  long\n  YCPByteblockRep::size() const\n  {\n      return len;\n  }\n}"
  },
  {
    "function_name": "~YCPByteblockRep",
    "container": "YCPByteblockRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPByteblock.cc",
    "lines": "46-49",
    "snippet": "YCPByteblockRep::~YCPByteblockRep()\n{\n    delete[] bytes;\n}",
    "includes": [
      "#include \"Xmlcode.h\"",
      "#include \"Bytecode.h\"",
      "#include \"YCPByteblock.h\"",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPByteblock.h\"\n#include <ycp/y2log.h>\n\nYCPByteblockRep {\n  YCPByteblockRep::~YCPByteblockRep()\n  {\n      delete[] bytes;\n  }\n}"
  },
  {
    "function_name": "YCPByteblockRep",
    "container": "YCPByteblockRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPByteblock.cc",
    "lines": "38-43",
    "snippet": "YCPByteblockRep::YCPByteblockRep (bytecodeistream & str, long len)\n    : len (len)\n{\n    bytes = new unsigned char [len];\n    str.read ((char *)bytes, len);\n}",
    "includes": [
      "#include \"Xmlcode.h\"",
      "#include \"Bytecode.h\"",
      "#include \"YCPByteblock.h\"",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "str.read",
          "args": [
            "(char *)bytes",
            "len"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPByteblock.h\"\n#include <ycp/y2log.h>\n\nYCPByteblockRep {\n  YCPByteblockRep::YCPByteblockRep (bytecodeistream & str, long len)\n      : len (len)\n  {\n      bytes = new unsigned char [len];\n      str.read ((char *)bytes, len);\n  }\n}"
  },
  {
    "function_name": "YCPByteblockRep",
    "container": "YCPByteblockRep",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPByteblock.cc",
    "lines": "30-35",
    "snippet": "YCPByteblockRep::YCPByteblockRep (const unsigned char *b, long len)\n    : len (len)\n{\n    bytes = new unsigned char [len];\n    memcpy (const_cast<unsigned char *>(bytes), b, len);\n}",
    "includes": [
      "#include \"Xmlcode.h\"",
      "#include \"Bytecode.h\"",
      "#include \"YCPByteblock.h\"",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "const_cast<unsigned char *>(bytes)",
            "b",
            "len"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<unsigned char *>",
          "args": [
            "bytes"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPByteblock.h\"\n#include <ycp/y2log.h>\n\nYCPByteblockRep {\n  YCPByteblockRep::YCPByteblockRep (const unsigned char *b, long len)\n      : len (len)\n  {\n      bytes = new unsigned char [len];\n      memcpy (const_cast<unsigned char *>(bytes), b, len);\n  }\n}"
  }
]